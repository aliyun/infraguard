// Code generated by policy-gen. DO NOT EDIT.
package policy

import (
	"github.com/aliyun/infraguard/pkg/models"
)

func init() {
	EmbeddedIndex = &models.PolicyIndex{
		Rules:      make(map[string]*models.Rule),
		Packs:      make(map[string]*models.Pack),
		LibModules: make(map[string]string),
	}

	EmbeddedIndex.LibModules["aliyun/lib/helpers.rego"] = "# Package for InfraGuard helper functions\n# These functions are built-in to InfraGuard and available in all policy files\n# Usage: import data.infraguard.helpers\npackage infraguard.helpers\n\nimport rego.v1\n\n# ============================================================================\n# Value Checking Helpers\n# ============================================================================\n\n# Check if a value is true (handles string \"true\" as well)\nis_true(v) if {\n\tv == true\n}\n\nis_true(v) if {\n\tv == \"true\"\n}\n\n# Check if a value is false (handles string \"false\" as well)\nis_false(v) if {\n\tv == false\n}\n\nis_false(v) if {\n\tv == \"false\"\n}\n\n# Check if a value is in a list\nincludes(list, elem) if {\n\tlist[_] == elem\n}\n\n# ============================================================================\n# Network Helpers\n# ============================================================================\n\n# Check if CIDR is public IPv4 (0.0.0.0/0)\nis_public_cidr(cidr) if {\n\tcidr == \"0.0.0.0/0\"\n}\n\n# Check if CIDR is public IPv6 (::/0)\nis_public_cidr(cidr) if {\n\tcidr == \"::/0\"\n}\n\n# Private IPv4 CIDR ranges (RFC 1918 and others)\nprivate_cidrs := [\n\t\"10.0.0.0/8\", # Class A private\n\t\"172.16.0.0/12\", # Class B private\n\t\"192.168.0.0/16\", # Class C private\n\t\"127.0.0.0/8\", # Loopback\n\t\"169.254.0.0/16\", # Link-local\n\t\"100.64.0.0/10\", # Carrier-grade NAT\n]\n\n# Check if a CIDR/IP is within private ranges (not public internet)\n# Returns true if the CIDR is private (not routable on public internet)\nis_private_cidr(cidr) if {\n\tsome private_range in private_cidrs\n\tnet.cidr_contains(private_range, cidr)\n}\n\n# Check if a CIDR/IP is a public internet address\n# Returns true if the CIDR contains public internet IPs\nis_internet_cidr(cidr) if {\n\t# First check if it's a valid CIDR format (has /)\n\tcontains(cidr, \"/\")\n\n\t# If it's 0.0.0.0/0 or ::/0, it includes public internet\n\tis_public_cidr(cidr)\n}\n\nis_internet_cidr(cidr) if {\n\t# Check if it contains public internet IPs (not in any private range)\n\tcontains(cidr, \"/\")\n\tnot is_private_cidr(cidr)\n\tnot is_public_cidr(cidr)\n}\n\nis_internet_cidr(cidr) if {\n\t# Handle single IP address (no CIDR notation)\n\tnot contains(cidr, \"/\")\n\n\t# Add /32 suffix and check\n\tcidr_with_mask := concat(\"/\", [cidr, \"32\"])\n\tnot is_private_cidr(cidr_with_mask)\n}\n\n# ============================================================================\n# Port Helpers\n# ============================================================================\n\n# Parse port range string (e.g., \"22/22\", \"1/65535\", \"-1/-1\") into [start, end]\nparse_port_range(port_range) := [start, end] if {\n\tparts := split(port_range, \"/\")\n\tcount(parts) == 2\n\tstart := to_number(parts[0])\n\tend := to_number(parts[1])\n}\n\n# Check if a specific port is within a port range\nport_in_range(port, port_range) if {\n\t[start, end] := parse_port_range(port_range)\n\tstart != -1\n\tend != -1\n\tport >= start\n\tport <= end\n}\n\n# Check if port range is all ports (-1/-1)\nis_all_ports(port_range) if {\n\tport_range == \"-1/-1\"\n}\n\n# ============================================================================\n# Resource Helpers\n# ============================================================================\n\n# Get all resources of a specific type as a map (name -> resource)\nresources_by_type(resource_type) := resources if {\n\tresources := {name: resource |\n\t\tsome name, resource in input.Resources\n\t\tresource.Type == resource_type\n\t}\n}\n\n# Get all resources of multiple types as a map (name -> resource)\nresources_by_types(resource_types) := resources if {\n\tresources := {name: resource |\n\t\tsome name, resource in input.Resources\n\t\tresource.Type in resource_types\n\t}\n}\n\n# Get all resource names of a specific type\nresource_names_by_type(resource_type) := [name |\n\tsome name, res in input.Resources\n\tres.Type == resource_type\n]\n\n# Count resources of a specific type\ncount_resources_by_type(resource_type) := count(resources_by_type(resource_type))\n\n# Check if a resource type exists in the template\nresource_exists(resource_type) if {\n\tcount_resources_by_type(resource_type) > 0\n}\n\n# Check if a resource type does NOT exist in the template\nresource_not_exists(resource_type) if {\n\tcount_resources_by_type(resource_type) == 0\n}\n\n# ============================================================================\n# Property Helpers\n# ============================================================================\n\n# Check if property exists and is not null\nhas_property(resource, prop) if {\n\tresource.Properties[prop] != null\n}\n\n# Get property with default value\nget_property(resource, prop, default_value) := value if {\n\thas_property(resource, prop)\n\tvalue := resource.Properties[prop]\n} else := default_value\n\n# ============================================================================\n# Reference Helpers\n# ============================================================================\n\n# Resolve a value (handles Ref)\n# If v is {\"Ref\": \"Name\"}, returns \"Name\"\n# Otherwise returns v\nresolve_ref(v) := name if {\n\tis_object(v)\n\tname := v.Ref\n} else := v\n\n# Check if a value refers to a specific resource (by logical ID)\n# target_id is the Logical ID of the resource\nis_referencing(val, target_id) if {\n\tresolve_ref(val) == target_id\n}\n\n# Resolve Fn::GetAtt reference\n# If v is {\"Fn::GetAtt\": [\"ResourceName\", \"PropertyName\"]}, returns \"ResourceName\"\n# Otherwise returns v\nresolve_get_att(v) := name if {\n\tis_object(v)\n\tname := v[\"Fn::GetAtt\"][0]\n} else := v\n\n# Check if a value is a Fn::GetAtt reference to a specific resource\n# target_id is the Logical ID of the resource\nis_get_att_referencing(val, target_id) if {\n\tresolve_get_att(val) == target_id\n}\n\n# Check if a value matches a resource's identity (Logical ID or its name property)\n# resource_id is the Logical ID of the resource\n# name_prop is the property name that contains the actual resource name (e.g., \"UserName\")\nmatches_resource_id(val, resource_id, name_prop) if {\n\tis_referencing(val, resource_id)\n}\n\nmatches_resource_id(val, resource_id, name_prop) if {\n\tres := input.Resources[resource_id]\n\tactual_name := get_property(res, name_prop, resource_id)\n\tval == actual_name\n}\n\n# Check if a resource is referenced by another resource's property\n# target_id: Logical ID of the resource to check if it's referenced\n# ref_resource_type: Type of resource that might reference it (e.g., \"ALIYUN::ECS::DiskAttachment\")\n# property_path: Property path to check, supports paths like [\"DiskId\"]\nis_referenced_by_property(target_id, ref_resource_type, property_path) if {\n\tsome name, ref_resource in resources_by_type(ref_resource_type)\n\tcount(property_path) == 1\n\tprop := property_path[0]\n\thas_property(ref_resource, prop)\n\tprop_value := ref_resource.Properties[prop]\n\tis_referencing(prop_value, target_id)\n}\n\nis_referenced_by_property(target_id, ref_resource_type, property_path) if {\n\tsome name, ref_resource in resources_by_type(ref_resource_type)\n\tcount(property_path) == 1\n\tprop := property_path[0]\n\thas_property(ref_resource, prop)\n\tprop_value := ref_resource.Properties[prop]\n\tis_get_att_referencing(prop_value, target_id)\n}\n\n# ============================================================================\n# Tag Helpers\n# ============================================================================\n\n# Get tags from resource, handling different tag property names\n# Different resources may use different property names for tags:\n# - Most resources: \"Tags\" (array of {Key, Value})\n# - Some resources: \"Tag\" (single object or array)\n# - OSS Bucket: \"Tags\" (array of {Key, Value})\nget_resource_tags(resource) := tags if {\n\t# Standard Tags property (array of {Key, Value})\n\thas_property(resource, \"Tags\")\n\ttags := resource.Properties.Tags\n\tis_array(tags)\n\tcount(tags) > 0\n}\n\nget_resource_tags(resource) := tags if {\n\t# Alternative Tag property (array of {Key, Value})\n\thas_property(resource, \"Tag\")\n\ttags := resource.Properties.Tag\n\tis_array(tags)\n\tcount(tags) > 0\n}\n\n# Check if resource has any tags\nhas_tags(resource) if {\n\tget_resource_tags(resource) != null\n}\n\n# Check if resource has a specific tag key\nhas_tag_key(resource, tag_key) if {\n\ttags := get_resource_tags(resource)\n\tsome tag in tags\n\ttag.Key == tag_key\n}\n\n# Get tag value by key\nget_tag_value(resource, tag_key) := tag.Value if {\n\ttags := get_resource_tags(resource)\n\tsome tag in tags\n\ttag.Key == tag_key\n}\n\n# Check if resource has a specific tag key-value pair\nhas_tag_key_value(resource, tag_key, tag_value) if {\n\ttags := get_resource_tags(resource)\n\tsome tag in tags\n\ttag.Key == tag_key\n\ttag.Value == tag_value\n}\n\n# Check if resource has a specific tag key-value pair (supports wildcards)\n# tag_value_pattern can contain * and ? wildcards\n# * matches any sequence of characters\n# ? matches any single character\nmatches_tag_value(resource, tag_key, tag_value_pattern) if {\n\tactual_value := get_tag_value(resource, tag_key)\n\n\t# Use regex matching for wildcard support\n\t# Convert * to .* and ? to . for regex\n\tregex_pattern := replace_wildcards(tag_value_pattern)\n\tregex.match(regex_pattern, actual_value)\n}\n\n# Convert wildcard pattern to regex pattern\n# * -> .*\n# ? -> .\nreplace_wildcards(pattern) := regex if {\n\t# Replace * with .* and ? with .\n\tregex := replace(replace(pattern, \"*\", \".*\"), \"?\", \".\")\n}\n\n# Check if resource has all specified tags\n# required_tags is an array of tag objects with Key and Value\nhas_all_tags(resource, required_tags) if {\n\t# Check that all required tags exist and match\n\tcount(required_tags) == count([tag |\n\t\tsome tag in required_tags\n\t\thas_tag_key_value(resource, tag.Key, tag.Value)\n\t])\n}\n\n# Check if resource has at least one of the specified tags\n# tag_patterns is an array of tag objects with Key and Value (supports wildcards in Value)\nhas_any_tag(resource, tag_patterns) if {\n\tsome tag in tag_patterns\n\tmatches_tag_value(resource, tag.Key, tag.Value)\n}\n"

	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-encryption-enabled", Name: models.I18nString{"de": "ACK-Cluster Secret-Verschlüsselung aktiviert", "en": "ACK Cluster Secret Encryption Enabled", "es": "Cifrado de Secret del Cluster ACK Habilitado", "fr": "Chiffrement Secret du Cluster ACK Activé", "ja": "ACK クラスタの Secret 暗号化が有効", "pt": "Criptografia de Secret do Cluster ACK Habilitada", "zh": "ACK 集群配置 Secret 的落盘加密"}, Severity: "medium", Description: models.I18nString{"de": "ACK Pro-Cluster sollten Secret-Verschlüsselung im Ruhezustand mit KMS aktiviert haben.", "en": "ACK Pro clusters should have Secret encryption at rest enabled using KMS.", "es": "Los clústeres ACK Pro deben tener cifrado de Secret en reposo habilitado usando KMS.", "fr": "Les clusters ACK Pro doivent avoir le chiffrement Secret au repos activé avec KMS.", "ja": "ACK Pro クラスタは KMS を使用して Secret の保存時暗号化を有効にする必要があります。", "pt": "Clusters ACK Pro devem ter criptografia de Secret em repouso habilitada usando KMS.", "zh": "ACK 集群配置 Secret 的落盘加密，视为合规。非专业托管版集群视为不适用。"}, Reason: models.I18nString{"de": "Der ACK Pro-Cluster hat keine Secret-Verschlüsselung im Ruhezustand aktiviert.", "en": "The ACK Pro cluster does not have Secret encryption at rest enabled.", "es": "El clúster ACK Pro no tiene cifrado de Secret en reposo habilitado.", "fr": "Le cluster ACK Pro n'a pas le chiffrement Secret au repos activé.", "ja": "ACK Pro クラスタで Secret の保存時暗号化が有効になっていません。", "pt": "O cluster ACK Pro não tem criptografia de Secret em repouso habilitada.", "zh": "ACK 专业版集群未开启 Secret 落盘加密。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Secret-Verschlüsselung, indem Sie EncryptionProviderKey angeben.", "en": "Enable Secret encryption by specifying EncryptionProviderKey.", "es": "Habilite el cifrado de Secret especificando EncryptionProviderKey.", "fr": "Activez le chiffrement Secret en spécifiant EncryptionProviderKey.", "ja": "EncryptionProviderKey を指定して Secret 暗号化を有効にします。", "pt": "Habilite a criptografia de Secret especificando EncryptionProviderKey.", "zh": "通过指定 EncryptionProviderKey 开启 Secret 加密。"}, ResourceTypes: []string{"ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-encryption-enabled.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_encryption_enabled", Content: "package infraguard.rules.aliyun.ack_cluster_encryption_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ack-cluster-encryption-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ACK Cluster Secret Encryption Enabled\",\n\t\t\"zh\": \"ACK 集群配置 Secret 的落盘加密\",\n\t\t\"ja\": \"ACK クラスタの Secret 暗号化が有効\",\n\t\t\"de\": \"ACK-Cluster Secret-Verschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado de Secret del Cluster ACK Habilitado\",\n\t\t\"fr\": \"Chiffrement Secret du Cluster ACK Activé\",\n\t\t\"pt\": \"Criptografia de Secret do Cluster ACK Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ACK Pro clusters should have Secret encryption at rest enabled using KMS.\",\n\t\t\"zh\": \"ACK 集群配置 Secret 的落盘加密，视为合规。非专业托管版集群视为不适用。\",\n\t\t\"ja\": \"ACK Pro クラスタは KMS を使用して Secret の保存時暗号化を有効にする必要があります。\",\n\t\t\"de\": \"ACK Pro-Cluster sollten Secret-Verschlüsselung im Ruhezustand mit KMS aktiviert haben.\",\n\t\t\"es\": \"Los clústeres ACK Pro deben tener cifrado de Secret en reposo habilitado usando KMS.\",\n\t\t\"fr\": \"Les clusters ACK Pro doivent avoir le chiffrement Secret au repos activé avec KMS.\",\n\t\t\"pt\": \"Clusters ACK Pro devem ter criptografia de Secret em repouso habilitada usando KMS.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ACK Pro cluster does not have Secret encryption at rest enabled.\",\n\t\t\"zh\": \"ACK 专业版集群未开启 Secret 落盘加密。\",\n\t\t\"ja\": \"ACK Pro クラスタで Secret の保存時暗号化が有効になっていません。\",\n\t\t\"de\": \"Der ACK Pro-Cluster hat keine Secret-Verschlüsselung im Ruhezustand aktiviert.\",\n\t\t\"es\": \"El clúster ACK Pro no tiene cifrado de Secret en reposo habilitado.\",\n\t\t\"fr\": \"Le cluster ACK Pro n'a pas le chiffrement Secret au repos activé.\",\n\t\t\"pt\": \"O cluster ACK Pro não tem criptografia de Secret em repouso habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable Secret encryption by specifying EncryptionProviderKey.\",\n\t\t\"zh\": \"通过指定 EncryptionProviderKey 开启 Secret 加密。\",\n\t\t\"ja\": \"EncryptionProviderKey を指定して Secret 暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Secret-Verschlüsselung, indem Sie EncryptionProviderKey angeben.\",\n\t\t\"es\": \"Habilite el cifrado de Secret especificando EncryptionProviderKey.\",\n\t\t\"fr\": \"Activez le chiffrement Secret en spécifiant EncryptionProviderKey.\",\n\t\t\"pt\": \"Habilite a criptografia de Secret especificando EncryptionProviderKey.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CS::ManagedKubernetesCluster\"]\n}\n\n# Check if cluster is ACK Pro\nis_ack_pro(resource) if {\n\thelpers.get_property(resource, \"ClusterSpec\", \"\") == \"ack.pro.small\"\n}\n\n# Check if encryption is enabled\nis_encryption_enabled(resource) if {\n\thelpers.has_property(resource, \"EncryptionProviderKey\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tis_ack_pro(resource)\n\tnot is_encryption_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EncryptionProviderKey\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-inspect-kubelet-version-outdate-check", Name: models.I18nString{"de": "ACK Kubelet Versionsprüfung", "en": "ACK Kubelet Version Check", "es": "Verificación de Versión de Kubelet ACK", "fr": "Vérification de Version Kubelet ACK", "ja": "ACK Kubelet バージョンチェック", "pt": "Verificação de Versão do Kubelet ACK", "zh": "ACK 巡检：Kubelet 版本过时检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die Kubelet-Version im ACK-Cluster auf dem neuesten Stand ist.", "en": "Ensures the Kubelet version in the ACK cluster is up to date.", "es": "Garantiza que la versión de Kubelet en el clúster ACK esté actualizada.", "fr": "Garantit que la version Kubelet dans le cluster ACK est à jour.", "ja": "ACK クラスタ内の Kubelet バージョンが最新であることを確認します。", "pt": "Garante que a versão do Kubelet no cluster ACK esteja atualizada.", "zh": "确保 ACK 集群中的 Kubelet 版本是最新的。"}, Reason: models.I18nString{"de": "Veraltete Kubelet-Versionen können Sicherheitslücken oder Kompatibilitätsprobleme enthalten.", "en": "Outdated Kubelet versions may contain security vulnerabilities or compatibility issues.", "es": "Las versiones obsoletas de Kubelet pueden contener vulnerabilidades de seguridad o problemas de compatibilidad.", "fr": "Les versions obsolètes de Kubelet peuvent contenir des vulnérabilités de sécurité ou des problèmes de compatibilité.", "ja": "古い Kubelet バージョンには、セキュリティの脆弱性や互換性の問題が含まれている可能性があります。", "pt": "Versões desatualizadas do Kubelet podem conter vulnerabilidades de segurança ou problemas de compatibilidade.", "zh": "过时的 Kubelet 版本可能包含安全漏洞或兼容性问题。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie die Kubelet-Version der Worker-Knoten.", "en": "Upgrade the Kubelet version of the worker nodes.", "es": "Actualice la versión de Kubelet de los nodos trabajadores.", "fr": "Mettez à niveau la version Kubelet des nœuds de travail.", "ja": "ワーカーノードの Kubelet バージョンをアップグレードします。", "pt": "Atualize a versão do Kubelet dos nós de trabalho.", "zh": "升级工作节点的 Kubelet 版本。"}, ResourceTypes: []string{"ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-inspect-kubelet-version-outdate-check.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_inspect_kubelet_version_outdate_check", Content: "package infraguard.rules.aliyun.ack_cluster_inspect_kubelet_version_outdate_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ack-cluster-inspect-kubelet-version-outdate-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ACK Kubelet Version Check\",\n\t\t\"zh\": \"ACK 巡检：Kubelet 版本过时检测\",\n\t\t\"ja\": \"ACK Kubelet バージョンチェック\",\n\t\t\"de\": \"ACK Kubelet Versionsprüfung\",\n\t\t\"es\": \"Verificación de Versión de Kubelet ACK\",\n\t\t\"fr\": \"Vérification de Version Kubelet ACK\",\n\t\t\"pt\": \"Verificação de Versão do Kubelet ACK\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures the Kubelet version in the ACK cluster is up to date.\",\n\t\t\"zh\": \"确保 ACK 集群中的 Kubelet 版本是最新的。\",\n\t\t\"ja\": \"ACK クラスタ内の Kubelet バージョンが最新であることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Kubelet-Version im ACK-Cluster auf dem neuesten Stand ist.\",\n\t\t\"es\": \"Garantiza que la versión de Kubelet en el clúster ACK esté actualizada.\",\n\t\t\"fr\": \"Garantit que la version Kubelet dans le cluster ACK est à jour.\",\n\t\t\"pt\": \"Garante que a versão do Kubelet no cluster ACK esteja atualizada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Outdated Kubelet versions may contain security vulnerabilities or compatibility issues.\",\n\t\t\"zh\": \"过时的 Kubelet 版本可能包含安全漏洞或兼容性问题。\",\n\t\t\"ja\": \"古い Kubelet バージョンには、セキュリティの脆弱性や互換性の問題が含まれている可能性があります。\",\n\t\t\"de\": \"Veraltete Kubelet-Versionen können Sicherheitslücken oder Kompatibilitätsprobleme enthalten.\",\n\t\t\"es\": \"Las versiones obsoletas de Kubelet pueden contener vulnerabilidades de seguridad o problemas de compatibilidad.\",\n\t\t\"fr\": \"Les versions obsolètes de Kubelet peuvent contenir des vulnérabilités de sécurité ou des problèmes de compatibilité.\",\n\t\t\"pt\": \"Versões desatualizadas do Kubelet podem conter vulnerabilidades de segurança ou problemas de compatibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade the Kubelet version of the worker nodes.\",\n\t\t\"zh\": \"升级工作节点的 Kubelet 版本。\",\n\t\t\"ja\": \"ワーカーノードの Kubelet バージョンをアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie die Kubelet-Version der Worker-Knoten.\",\n\t\t\"es\": \"Actualice la versión de Kubelet de los nodos trabajadores.\",\n\t\t\"fr\": \"Mettez à niveau la version Kubelet des nœuds de travail.\",\n\t\t\"pt\": \"Atualize a versão do Kubelet dos nós de trabalho.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CS::ManagedKubernetesCluster\"]\n}\n\n# Real check requires runtime data. In IaC, we check if a standard version is used.\nis_compliant(resource) if {\n\tv := helpers.get_property(resource, \"KubernetesVersion\", \"\")\n\tnot helpers.includes([\"1.16\", \"1.18\"], v) # Example: flag very old versions\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CS::ManagedKubernetesCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"KubernetesVersion\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-log-plugin-installed", Name: models.I18nString{"de": "ACK-Cluster Log-Plugin installiert", "en": "ACK Cluster Log Plugin Installed", "es": "Complemento de Registro de Clúster ACK Instalado", "fr": "Plugin de Journal du Cluster ACK Installé", "ja": "ACK クラスタログプラグインがインストールされている", "pt": "Plugin de Log do Cluster ACK Instalado", "zh": "ACK 集群安装日志插件"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass das log-service-Addon im ACK-Cluster installiert ist.", "en": "Ensures the log-service addon is installed in the ACK cluster.", "es": "Garantiza que el complemento log-service esté instalado en el clúster ACK.", "fr": "Garantit que le module complémentaire log-service est installé dans le cluster ACK.", "ja": "ACK クラスタに log-service アドオンがインストールされていることを確認します。", "pt": "Garante que o complemento log-service esteja instalado no cluster ACK.", "zh": "确保 ACK 集群中安装了 log-service 组件。"}, Reason: models.I18nString{"de": "Die Protokollsammlung ist für die Überwachung und Fehlerbehebung containerisierter Anwendungen unerlässlich.", "en": "Log collection is essential for monitoring and troubleshooting containerized applications.", "es": "La recopilación de registros es esencial para monitorear y solucionar problemas de aplicaciones containerizadas.", "fr": "La collecte de journaux est essentielle pour surveiller et dépanner les applications containerisées.", "ja": "ログ収集は、コンテナ化アプリケーションの監視とトラブルシューティングに不可欠です。", "pt": "A coleta de logs é essencial para monitorar e solucionar problemas de aplicações containerizadas.", "zh": "日志采集对于监控和排查容器化应用的故障至关重要。"}, Recommendation: models.I18nString{"de": "Installieren Sie das 'log-service'-Addon in den ACK-Cluster-Einstellungen.", "en": "Install the 'log-service' addon in the ACK cluster settings.", "es": "Instale el complemento 'log-service' en la configuración del clúster ACK.", "fr": "Installez le module complémentaire 'log-service' dans les paramètres du cluster ACK.", "ja": "ACK クラスタ設定で 'log-service' アドオンをインストールします。", "pt": "Instale o complemento 'log-service' nas configurações do cluster ACK.", "zh": "在 ACK 集群设置中安装 'log-service' 组件。"}, ResourceTypes: []string{"ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-log-plugin-installed.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_log_plugin_installed", Content: "package infraguard.rules.aliyun.ack_cluster_log_plugin_installed\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ack-cluster-log-plugin-installed\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ACK Cluster Log Plugin Installed\",\n\t\t\"zh\": \"ACK 集群安装日志插件\",\n\t\t\"ja\": \"ACK クラスタログプラグインがインストールされている\",\n\t\t\"de\": \"ACK-Cluster Log-Plugin installiert\",\n\t\t\"es\": \"Complemento de Registro de Clúster ACK Instalado\",\n\t\t\"fr\": \"Plugin de Journal du Cluster ACK Installé\",\n\t\t\"pt\": \"Plugin de Log do Cluster ACK Instalado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures the log-service addon is installed in the ACK cluster.\",\n\t\t\"zh\": \"确保 ACK 集群中安装了 log-service 组件。\",\n\t\t\"ja\": \"ACK クラスタに log-service アドオンがインストールされていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass das log-service-Addon im ACK-Cluster installiert ist.\",\n\t\t\"es\": \"Garantiza que el complemento log-service esté instalado en el clúster ACK.\",\n\t\t\"fr\": \"Garantit que le module complémentaire log-service est installé dans le cluster ACK.\",\n\t\t\"pt\": \"Garante que o complemento log-service esteja instalado no cluster ACK.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Log collection is essential for monitoring and troubleshooting containerized applications.\",\n\t\t\"zh\": \"日志采集对于监控和排查容器化应用的故障至关重要。\",\n\t\t\"ja\": \"ログ収集は、コンテナ化アプリケーションの監視とトラブルシューティングに不可欠です。\",\n\t\t\"de\": \"Die Protokollsammlung ist für die Überwachung und Fehlerbehebung containerisierter Anwendungen unerlässlich.\",\n\t\t\"es\": \"La recopilación de registros es esencial para monitorear y solucionar problemas de aplicaciones containerizadas.\",\n\t\t\"fr\": \"La collecte de journaux est essentielle pour surveiller et dépanner les applications containerisées.\",\n\t\t\"pt\": \"A coleta de logs é essencial para monitorar e solucionar problemas de aplicações containerizadas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Install the 'log-service' addon in the ACK cluster settings.\",\n\t\t\"zh\": \"在 ACK 集群设置中安装 'log-service' 组件。\",\n\t\t\"ja\": \"ACK クラスタ設定で 'log-service' アドオンをインストールします。\",\n\t\t\"de\": \"Installieren Sie das 'log-service'-Addon in den ACK-Cluster-Einstellungen.\",\n\t\t\"es\": \"Instale el complemento 'log-service' en la configuración del clúster ACK.\",\n\t\t\"fr\": \"Installez le module complémentaire 'log-service' dans les paramètres du cluster ACK.\",\n\t\t\"pt\": \"Instale o complemento 'log-service' nas configurações do cluster ACK.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CS::ManagedKubernetesCluster\"]\n}\n\nis_compliant(resource) if {\n\taddons := helpers.get_property(resource, \"Addons\", [])\n\tsome addon in addons\n\taddon.Name == \"log-service\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CS::ManagedKubernetesCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Addons\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-node-multi-zone", Name: models.I18nString{"de": "ACK-Cluster Multi-Zone-Bereitstellung", "en": "ACK Cluster Multi-Zone Deployment", "es": "Despliegue Multi-zona del Cluster ACK", "fr": "Déploiement Multi-Zones du Cluster ACK", "ja": "ACK クラスタのマルチゾーン展開", "pt": "Implantação Multi-zona do Cluster ACK", "zh": "使用区域级多可用区 ACK 集群"}, Severity: "high", Description: models.I18nString{"de": "Die ACK-Cluster-Knoten sollten für hohe Verfügbarkeit über 3 oder mehr Verfügbarkeitszonen verteilt werden.", "en": "The ACK cluster nodes should be distributed across 3 or more availability zones for high availability.", "es": "Los nodos del clúster ACK deben distribuirse en 3 o más zonas de disponibilidad para alta disponibilidad.", "fr": "Les nœuds du cluster ACK doivent être distribués sur 3 zones de disponibilité ou plus pour une haute disponibilité.", "ja": "高可用性のために、ACK クラスタノードは 3 つ以上の可用性ゾーンに分散させる必要があります。", "pt": "Os nós do cluster ACK devem ser distribuídos em 3 ou mais zonas de disponibilidade para alta disponibilidade.", "zh": "使用区域级 ACK 集群，节点分布在 3 个及以上可用区，视为合规。"}, Reason: models.I18nString{"de": "Die ACK-Cluster-Knoten sind nicht über 3 oder mehr Verfügbarkeitszonen verteilt.", "en": "The ACK cluster nodes are not distributed across 3 or more availability zones.", "es": "Los nodos del clúster ACK no están distribuidos en 3 o más zonas de disponibilidad.", "fr": "Les nœuds du cluster ACK ne sont pas distribués sur 3 zones de disponibilité ou plus.", "ja": "ACK クラスタノードが 3 つ以上の可用性ゾーンに分散されていません。", "pt": "Os nós do cluster ACK não estão distribuídos em 3 ou mais zonas de disponibilidade.", "zh": "ACK 集群节点未分布在 3 个及以上可用区。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie den Cluster so, dass er mindestens 3 Verfügbarkeitszonen verwendet, indem Sie mehrere VSwitchIds angeben.", "en": "Configure the cluster to use at least 3 availability zones by specifying multiple VSwitchIds.", "es": "Configure el clúster para usar al menos 3 zonas de disponibilidad especificando múltiples VSwitchIds.", "fr": "Configurez le cluster pour utiliser au moins 3 zones de disponibilité en spécifiant plusieurs VSwitchIds.", "ja": "複数の VSwitchIds を指定して、クラスタを少なくとも 3 つの可用性ゾーンを使用するように設定します。", "pt": "Configure o cluster para usar pelo menos 3 zonas de disponibilidade especificando múltiplos VSwitchIds.", "zh": "通过指定多个 VSwitchIds，将集群配置为使用至少 3 个可用区。"}, ResourceTypes: []string{"ALIYUN::CS::KubernetesCluster", "ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-node-multi-zone.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_node_multi_zone", Content: "package infraguard.rules.aliyun.ack_cluster_node_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ack-cluster-node-multi-zone\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ACK Cluster Multi-Zone Deployment\",\n\t\t\"zh\": \"使用区域级多可用区 ACK 集群\",\n\t\t\"ja\": \"ACK クラスタのマルチゾーン展開\",\n\t\t\"de\": \"ACK-Cluster Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-zona del Cluster ACK\",\n\t\t\"fr\": \"Déploiement Multi-Zones du Cluster ACK\",\n\t\t\"pt\": \"Implantação Multi-zona do Cluster ACK\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"The ACK cluster nodes should be distributed across 3 or more availability zones for high availability.\",\n\t\t\"zh\": \"使用区域级 ACK 集群，节点分布在 3 个及以上可用区，视为合规。\",\n\t\t\"ja\": \"高可用性のために、ACK クラスタノードは 3 つ以上の可用性ゾーンに分散させる必要があります。\",\n\t\t\"de\": \"Die ACK-Cluster-Knoten sollten für hohe Verfügbarkeit über 3 oder mehr Verfügbarkeitszonen verteilt werden.\",\n\t\t\"es\": \"Los nodos del clúster ACK deben distribuirse en 3 o más zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les nœuds du cluster ACK doivent être distribués sur 3 zones de disponibilité ou plus pour une haute disponibilité.\",\n\t\t\"pt\": \"Os nós do cluster ACK devem ser distribuídos em 3 ou mais zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ACK cluster nodes are not distributed across 3 or more availability zones.\",\n\t\t\"zh\": \"ACK 集群节点未分布在 3 个及以上可用区。\",\n\t\t\"ja\": \"ACK クラスタノードが 3 つ以上の可用性ゾーンに分散されていません。\",\n\t\t\"de\": \"Die ACK-Cluster-Knoten sind nicht über 3 oder mehr Verfügbarkeitszonen verteilt.\",\n\t\t\"es\": \"Los nodos del clúster ACK no están distribuidos en 3 o más zonas de disponibilidad.\",\n\t\t\"fr\": \"Les nœuds du cluster ACK ne sont pas distribués sur 3 zones de disponibilité ou plus.\",\n\t\t\"pt\": \"Os nós do cluster ACK não estão distribuídos em 3 ou mais zonas de disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the cluster to use at least 3 availability zones by specifying multiple VSwitchIds.\",\n\t\t\"zh\": \"通过指定多个 VSwitchIds，将集群配置为使用至少 3 个可用区。\",\n\t\t\"ja\": \"複数の VSwitchIds を指定して、クラスタを少なくとも 3 つの可用性ゾーンを使用するように設定します。\",\n\t\t\"de\": \"Konfigurieren Sie den Cluster so, dass er mindestens 3 Verfügbarkeitszonen verwendet, indem Sie mehrere VSwitchIds angeben.\",\n\t\t\"es\": \"Configure el clúster para usar al menos 3 zonas de disponibilidad especificando múltiples VSwitchIds.\",\n\t\t\"fr\": \"Configurez le cluster pour utiliser au moins 3 zones de disponibilité en spécifiant plusieurs VSwitchIds.\",\n\t\t\"pt\": \"Configure o cluster para usar pelo menos 3 zonas de disponibilidade especificando múltiplos VSwitchIds.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CS::KubernetesCluster\", \"ALIYUN::CS::ManagedKubernetesCluster\"]\n}\n\n# Check if cluster is multi-zone\nis_multi_zone(resource) if {\n\tcount(object.get(resource.Properties, \"VSwitchIds\", [])) >= 3\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ZoneIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-public-endpoint-check", Name: models.I18nString{"de": "ACK-Cluster öffentlicher Endpunkt-Prüfung", "en": "ACK Cluster Public Endpoint Check", "es": "Verificación de Endpoint Público del Cluster ACK", "fr": "Vérification de l'Endpoint Public du Cluster ACK", "ja": "ACK クラスタのパブリックエンドポイントチェック", "pt": "Verificação de Endpoint Público do Cluster ACK", "zh": "ACK 集群未设置公网连接端点"}, Severity: "high", Description: models.I18nString{"de": "ACK-Cluster sollten keinen öffentlichen Endpunkt gesetzt haben, oder der zugehörige SLB-Listener sollte ACL aktiviert haben.", "en": "ACK clusters should not have a public endpoint set, or the associated SLB listener should have ACL enabled.", "es": "Los clústeres ACK no deben tener un endpoint público configurado, o el listener SLB asociado debe tener ACL habilitado.", "fr": "Les clusters ACK ne doivent pas avoir d'endpoint public configuré, ou le listener SLB associé doit avoir l'ACL activé.", "ja": "ACK クラスタはパブリックエンドポイントを設定しないか、関連する SLB リスナーで ACL を有効にする必要があります。", "pt": "Clusters ACK não devem ter um endpoint público configurado, ou o listener SLB associado deve ter ACL habilitado.", "zh": "ACK 集群未设置公网连接端点，或关联的 SLB 的监听开启 acl 访问控制，视为合规。"}, Reason: models.I18nString{"de": "Der ACK-Cluster hat einen öffentlichen Endpunkt aktiviert, was den API-Server dem Internet aussetzen kann.", "en": "The ACK cluster has a public endpoint enabled, which may expose the API server to the internet.", "es": "El clúster ACK tiene un endpoint público habilitado, lo que puede exponer el servidor API a internet.", "fr": "Le cluster ACK a un endpoint public activé, ce qui peut exposer le serveur API à Internet.", "ja": "ACK クラスタでパブリックエンドポイントが有効になっているため、API サーバーがインターネットに公開される可能性があります。", "pt": "O cluster ACK tem um endpoint público habilitado, o que pode expor o servidor API à internet.", "zh": "ACK 集群开启了公网连接端点，可能将 API Server 暴露给互联网。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie den öffentlichen Endpunkt für den ACK-Cluster, indem Sie 'EndpointPublicAccess' auf false setzen.", "en": "Disable the public endpoint for the ACK cluster by setting 'EndpointPublicAccess' to false.", "es": "Deshabilite el endpoint público del clúster ACK estableciendo 'EndpointPublicAccess' en false.", "fr": "Désactivez l'endpoint public du cluster ACK en définissant 'EndpointPublicAccess' sur false.", "ja": "'EndpointPublicAccess' を false に設定して、ACK クラスタのパブリックエンドポイントを無効にします。", "pt": "Desabilite o endpoint público do cluster ACK definindo 'EndpointPublicAccess' como false.", "zh": "通过将'EndpointPublicAccess'设置为 false 来禁用 ACK 集群的公网连接端点。"}, ResourceTypes: []string{"ALIYUN::CS::ASKCluster", "ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-public-endpoint-check.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_public_endpoint_check", Content: "package infraguard.rules.aliyun.ack_cluster_public_endpoint_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ack-cluster-public-endpoint-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ACK Cluster Public Endpoint Check\",\n\t\t\"zh\": \"ACK 集群未设置公网连接端点\",\n\t\t\"ja\": \"ACK クラスタのパブリックエンドポイントチェック\",\n\t\t\"de\": \"ACK-Cluster öffentlicher Endpunkt-Prüfung\",\n\t\t\"es\": \"Verificación de Endpoint Público del Cluster ACK\",\n\t\t\"fr\": \"Vérification de l'Endpoint Public du Cluster ACK\",\n\t\t\"pt\": \"Verificação de Endpoint Público do Cluster ACK\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ACK clusters should not have a public endpoint set, or the associated SLB listener should have ACL enabled.\",\n\t\t\"zh\": \"ACK 集群未设置公网连接端点，或关联的 SLB 的监听开启 acl 访问控制，视为合规。\",\n\t\t\"ja\": \"ACK クラスタはパブリックエンドポイントを設定しないか、関連する SLB リスナーで ACL を有効にする必要があります。\",\n\t\t\"de\": \"ACK-Cluster sollten keinen öffentlichen Endpunkt gesetzt haben, oder der zugehörige SLB-Listener sollte ACL aktiviert haben.\",\n\t\t\"es\": \"Los clústeres ACK no deben tener un endpoint público configurado, o el listener SLB asociado debe tener ACL habilitado.\",\n\t\t\"fr\": \"Les clusters ACK ne doivent pas avoir d'endpoint public configuré, ou le listener SLB associé doit avoir l'ACL activé.\",\n\t\t\"pt\": \"Clusters ACK não devem ter um endpoint público configurado, ou o listener SLB associado deve ter ACL habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ACK cluster has a public endpoint enabled, which may expose the API server to the internet.\",\n\t\t\"zh\": \"ACK 集群开启了公网连接端点，可能将 API Server 暴露给互联网。\",\n\t\t\"ja\": \"ACK クラスタでパブリックエンドポイントが有効になっているため、API サーバーがインターネットに公開される可能性があります。\",\n\t\t\"de\": \"Der ACK-Cluster hat einen öffentlichen Endpunkt aktiviert, was den API-Server dem Internet aussetzen kann.\",\n\t\t\"es\": \"El clúster ACK tiene un endpoint público habilitado, lo que puede exponer el servidor API a internet.\",\n\t\t\"fr\": \"Le cluster ACK a un endpoint public activé, ce qui peut exposer le serveur API à Internet.\",\n\t\t\"pt\": \"O cluster ACK tem um endpoint público habilitado, o que pode expor o servidor API à internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable the public endpoint for the ACK cluster by setting 'EndpointPublicAccess' to false.\",\n\t\t\"zh\": \"通过将'EndpointPublicAccess'设置为 false 来禁用 ACK 集群的公网连接端点。\",\n\t\t\"ja\": \"'EndpointPublicAccess' を false に設定して、ACK クラスタのパブリックエンドポイントを無効にします。\",\n\t\t\"de\": \"Deaktivieren Sie den öffentlichen Endpunkt für den ACK-Cluster, indem Sie 'EndpointPublicAccess' auf false setzen.\",\n\t\t\"es\": \"Deshabilite el endpoint público del clúster ACK estableciendo 'EndpointPublicAccess' en false.\",\n\t\t\"fr\": \"Désactivez l'endpoint public du cluster ACK en définissant 'EndpointPublicAccess' sur false.\",\n\t\t\"pt\": \"Desabilite o endpoint público do cluster ACK definindo 'EndpointPublicAccess' como false.\"\n\t},\n\t\"resource_types\": [\n\t\t\"ALIYUN::CS::ASKCluster\",\n\t\t\"ALIYUN::CS::ManagedKubernetesCluster\"\n\t]\n}\n\n# Check for ManagedKubernetesCluster\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CS::ManagedKubernetesCluster\")\n\thelpers.get_property(resource, \"EndpointPublicAccess\", false) == true\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EndpointPublicAccess\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check for ASKCluster\n# Default for ASKCluster EndpointPublicAccess is true\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CS::ASKCluster\")\n\tis_ask_public_access_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EndpointPublicAccess\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nis_ask_public_access_enabled(resource) if {\n\t# If explicitly true\n\thelpers.get_property(resource, \"EndpointPublicAccess\", false) == true\n}\n\nis_ask_public_access_enabled(resource) if {\n\t# If missing, default is true\n\tnot helpers.has_property(resource, \"EndpointPublicAccess\")\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-rrsa-enabled", Name: models.I18nString{"de": "ACK-Cluster RRSA aktiviert", "en": "ACK Cluster RRSA Enabled", "es": "RRSA del Cluster ACK Habilitado", "fr": "RRSA du Cluster ACK Activé", "ja": "ACK クラスタで RRSA が有効", "pt": "RRSA do Cluster ACK Habilitado", "zh": "ACK 集群开启 RRSA"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die RAM Roles for Service Accounts (RRSA)-Funktion für den ACK-Cluster aktiviert ist.", "en": "Ensures that the RAM Roles for Service Accounts (RRSA) feature is enabled for the ACK cluster.", "es": "Garantiza que la función RAM Roles for Service Accounts (RRSA) esté habilitada para el clúster ACK.", "fr": "Garantit que la fonctionnalité RAM Roles for Service Accounts (RRSA) est activée pour le cluster ACK.", "ja": "ACK クラスタで RAM Roles for Service Accounts (RRSA) 機能が有効になっていることを確認します。", "pt": "Garante que o recurso RAM Roles for Service Accounts (RRSA) está habilitado para o cluster ACK.", "zh": "确保 ACK 集群开启了 RAM 角色注入(RRSA)功能。"}, Reason: models.I18nString{"de": "RRSA ermöglicht es Pods, RAM-Rollen zu übernehmen, was eine sicherere und feinere Art der Berechtigungsverwaltung bietet.", "en": "RRSA allows pods to assume RAM roles, providing a more secure and fine-grained way to manage permissions.", "es": "RRSA permite que los pods asuman roles RAM, proporcionando una forma más segura y granular de gestionar permisos.", "fr": "RRSA permet aux pods d'assumer des rôles RAM, offrant une manière plus sécurisée et granulaire de gérer les permissions.", "ja": "RRSA により、Pod が RAM ロールを引き受けることができ、より安全で細かい権限管理方法を提供します。", "pt": "O RRSA permite que pods assumam funções RAM, fornecendo uma maneira mais segura e granular de gerenciar permissões.", "zh": "RRSA 允许 Pod 扮演 RAM 角色，提供更安全、更细粒度的权限管理方式。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie RRSA für den ACK-Cluster.", "en": "Enable RRSA for the ACK cluster.", "es": "Habilite RRSA para el clúster ACK.", "fr": "Activez RRSA pour le cluster ACK.", "ja": "ACK クラスタで RRSA を有効にします。", "pt": "Habilite RRSA para o cluster ACK.", "zh": "为 ACK 集群开启 RRSA 功能。"}, ResourceTypes: []string{"ALIYUN::CS::AnyCluster", "ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-rrsa-enabled.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_rrsa_enabled", Content: "package infraguard.rules.aliyun.ack_cluster_rrsa_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ack-cluster-rrsa-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ACK Cluster RRSA Enabled\",\n\t\t\"zh\": \"ACK 集群开启 RRSA\",\n\t\t\"ja\": \"ACK クラスタで RRSA が有効\",\n\t\t\"de\": \"ACK-Cluster RRSA aktiviert\",\n\t\t\"es\": \"RRSA del Cluster ACK Habilitado\",\n\t\t\"fr\": \"RRSA du Cluster ACK Activé\",\n\t\t\"pt\": \"RRSA do Cluster ACK Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the RAM Roles for Service Accounts (RRSA) feature is enabled for the ACK cluster.\",\n\t\t\"zh\": \"确保 ACK 集群开启了 RAM 角色注入(RRSA)功能。\",\n\t\t\"ja\": \"ACK クラスタで RAM Roles for Service Accounts (RRSA) 機能が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die RAM Roles for Service Accounts (RRSA)-Funktion für den ACK-Cluster aktiviert ist.\",\n\t\t\"es\": \"Garantiza que la función RAM Roles for Service Accounts (RRSA) esté habilitada para el clúster ACK.\",\n\t\t\"fr\": \"Garantit que la fonctionnalité RAM Roles for Service Accounts (RRSA) est activée pour le cluster ACK.\",\n\t\t\"pt\": \"Garante que o recurso RAM Roles for Service Accounts (RRSA) está habilitado para o cluster ACK.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"RRSA allows pods to assume RAM roles, providing a more secure and fine-grained way to manage permissions.\",\n\t\t\"zh\": \"RRSA 允许 Pod 扮演 RAM 角色，提供更安全、更细粒度的权限管理方式。\",\n\t\t\"ja\": \"RRSA により、Pod が RAM ロールを引き受けることができ、より安全で細かい権限管理方法を提供します。\",\n\t\t\"de\": \"RRSA ermöglicht es Pods, RAM-Rollen zu übernehmen, was eine sicherere und feinere Art der Berechtigungsverwaltung bietet.\",\n\t\t\"es\": \"RRSA permite que los pods asuman roles RAM, proporcionando una forma más segura y granular de gestionar permisos.\",\n\t\t\"fr\": \"RRSA permet aux pods d'assumer des rôles RAM, offrant une manière plus sécurisée et granulaire de gérer les permissions.\",\n\t\t\"pt\": \"O RRSA permite que pods assumam funções RAM, fornecendo uma maneira mais segura e granular de gerenciar permissões.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable RRSA for the ACK cluster.\",\n\t\t\"zh\": \"为 ACK 集群开启 RRSA 功能。\",\n\t\t\"ja\": \"ACK クラスタで RRSA を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie RRSA für den ACK-Cluster.\",\n\t\t\"es\": \"Habilite RRSA para el clúster ACK.\",\n\t\t\"fr\": \"Activez RRSA pour le cluster ACK.\",\n\t\t\"pt\": \"Habilite RRSA para o cluster ACK.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CS::AnyCluster\", \"ALIYUN::CS::ManagedKubernetesCluster\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::CS::ManagedKubernetesCluster\", \"ALIYUN::CS::AnyCluster\"])\n\trrsa_config := helpers.get_property(resource, \"RrsaConfig\", {})\n\tenabled := rrsa_config.Enabled\n\tnot helpers.is_true(enabled)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"RrsaConfig\", \"Enabled\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-spec-check", Name: models.I18nString{"de": "ACK-Cluster-Spezifikationsprüfung", "en": "ACK Cluster Spec Check", "es": "Verificación de Especificación de Clúster ACK", "fr": "Vérification de Spécification de Cluster ACK", "ja": "ACK クラスタ仕様チェック", "pt": "Verificação de Especificação de Cluster ACK", "zh": "ACK 集群规格核查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass ACK-Cluster genehmigte Spezifikationen (z. B. ACK Pro) verwenden.", "en": "Ensures ACK clusters use approved specifications (e.g., ACK Pro).", "es": "Garantiza que los clústeres ACK usen especificaciones aprobadas (por ejemplo, ACK Pro).", "fr": "Garantit que les clusters ACK utilisent des spécifications approuvées (par exemple, ACK Pro).", "ja": "ACK クラスタが承認された仕様（例：ACK Pro）を使用することを確認します。", "pt": "Garante que os clusters ACK usem especificações aprovadas (por exemplo, ACK Pro).", "zh": "确保 ACK 集群使用批准的规格（如专业版 ACK Pro）。"}, Reason: models.I18nString{"de": "ACK Pro-Version-Cluster bieten bessere Zuverlässigkeit und SLA-Garantien für Produktions-Workloads.", "en": "ACK Pro version clusters provide better reliability and SLA guarantees for production workloads.", "es": "Los clústeres de versión ACK Pro proporcionan mejor confiabilidad y garantías SLA para cargas de trabajo de producción.", "fr": "Les clusters de version ACK Pro offrent une meilleure fiabilité et des garanties SLA pour les charges de travail de production.", "ja": "ACK Pro バージョンのクラスタは、本番ワークロードに優れた信頼性と SLA 保証を提供します。", "pt": "Os clusters da versão ACK Pro fornecem melhor confiabilidade e garantias de SLA para cargas de trabalho de produção.", "zh": "ACK 专业版集群为生产工作负载提供更好的可靠性和 SLA 保障。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie den Cluster auf 'ack.pro.small' für Produktionsumgebungen.", "en": "Upgrade the cluster to 'ack.pro.small' for production environments.", "es": "Actualice el clúster a 'ack.pro.small' para entornos de producción.", "fr": "Mettez à niveau le cluster vers 'ack.pro.small' pour les environnements de production.", "ja": "本番環境では、クラスタを 'ack.pro.small' にアップグレードします。", "pt": "Atualize o cluster para 'ack.pro.small' para ambientes de produção.", "zh": "对于生产环境，建议将集群规格升级为 'ack.pro.small'。"}, ResourceTypes: []string{"ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-spec-check.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_spec_check", Content: "package infraguard.rules.aliyun.ack_cluster_spec_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ack-cluster-spec-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ACK Cluster Spec Check\",\n\t\t\"zh\": \"ACK 集群规格核查\",\n\t\t\"ja\": \"ACK クラスタ仕様チェック\",\n\t\t\"de\": \"ACK-Cluster-Spezifikationsprüfung\",\n\t\t\"es\": \"Verificación de Especificación de Clúster ACK\",\n\t\t\"fr\": \"Vérification de Spécification de Cluster ACK\",\n\t\t\"pt\": \"Verificação de Especificação de Cluster ACK\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ACK clusters use approved specifications (e.g., ACK Pro).\",\n\t\t\"zh\": \"确保 ACK 集群使用批准的规格（如专业版 ACK Pro）。\",\n\t\t\"ja\": \"ACK クラスタが承認された仕様（例：ACK Pro）を使用することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ACK-Cluster genehmigte Spezifikationen (z. B. ACK Pro) verwenden.\",\n\t\t\"es\": \"Garantiza que los clústeres ACK usen especificaciones aprobadas (por ejemplo, ACK Pro).\",\n\t\t\"fr\": \"Garantit que les clusters ACK utilisent des spécifications approuvées (par exemple, ACK Pro).\",\n\t\t\"pt\": \"Garante que os clusters ACK usem especificações aprovadas (por exemplo, ACK Pro).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ACK Pro version clusters provide better reliability and SLA guarantees for production workloads.\",\n\t\t\"zh\": \"ACK 专业版集群为生产工作负载提供更好的可靠性和 SLA 保障。\",\n\t\t\"ja\": \"ACK Pro バージョンのクラスタは、本番ワークロードに優れた信頼性と SLA 保証を提供します。\",\n\t\t\"de\": \"ACK Pro-Version-Cluster bieten bessere Zuverlässigkeit und SLA-Garantien für Produktions-Workloads.\",\n\t\t\"es\": \"Los clústeres de versión ACK Pro proporcionan mejor confiabilidad y garantías SLA para cargas de trabajo de producción.\",\n\t\t\"fr\": \"Les clusters de version ACK Pro offrent une meilleure fiabilité et des garanties SLA pour les charges de travail de production.\",\n\t\t\"pt\": \"Os clusters da versão ACK Pro fornecem melhor confiabilidade e garantias de SLA para cargas de trabalho de produção.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade the cluster to 'ack.pro.small' for production environments.\",\n\t\t\"zh\": \"对于生产环境，建议将集群规格升级为 'ack.pro.small'。\",\n\t\t\"ja\": \"本番環境では、クラスタを 'ack.pro.small' にアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie den Cluster auf 'ack.pro.small' für Produktionsumgebungen.\",\n\t\t\"es\": \"Actualice el clúster a 'ack.pro.small' para entornos de producción.\",\n\t\t\"fr\": \"Mettez à niveau le cluster vers 'ack.pro.small' pour les environnements de production.\",\n\t\t\"pt\": \"Atualize o cluster para 'ack.pro.small' para ambientes de produção.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CS::ManagedKubernetesCluster\"]\n}\n\nis_compliant(resource) if {\n\tspec := helpers.get_property(resource, \"ClusterSpec\", \"\")\n\tspec == \"ack.pro.small\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CS::ManagedKubernetesCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ClusterSpec\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-supported-version", Name: models.I18nString{"de": "ACK-Cluster Unterstützte Version", "en": "ACK Cluster Supported Version", "es": "Versión Compatible del Clúster ACK", "fr": "Version Prise en Charge du Cluster ACK", "ja": "ACK クラスターサポートバージョン", "pt": "Versão Suportada do Cluster ACK", "zh": "ACK 集群版本支持检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der ACK-Cluster eine unterstützte Version ausführt.", "en": "Ensures that the ACK cluster is running a supported version.", "es": "Garantiza que el clúster ACK esté ejecutando una versión compatible.", "fr": "Garantit que le cluster ACK exécute une version prise en charge.", "ja": "ACK クラスターがサポートされているバージョンで実行されていることを確認します。", "pt": "Garante que o cluster ACK esteja executando uma versão suportada.", "zh": "确保 ACK 集群运行的是受支持的版本。"}, Reason: models.I18nString{"de": "Das Ausführen einer nicht unterstützten Version kann zu Sicherheitslücken und fehlender Unterstützung führen.", "en": "Running an unsupported version may lead to security vulnerabilities and lack of support.", "es": "Ejecutar una versión no compatible puede provocar vulnerabilidades de seguridad y falta de soporte.", "fr": "Exécuter une version non prise en charge peut entraîner des vulnérabilités de sécurité et un manque de support.", "ja": "サポートされていないバージョンを実行すると、セキュリティの脆弱性やサポートの欠如につながる可能性があります。", "pt": "Executar uma versão não suportada pode levar a vulnerabilidades de segurança e falta de suporte.", "zh": "运行不受支持的版本可能导致安全漏洞和缺乏技术支持。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie den ACK-Cluster auf eine unterstützte Version.", "en": "Upgrade the ACK cluster to a supported version.", "es": "Actualice el clúster ACK a una versión compatible.", "fr": "Mettez à niveau le cluster ACK vers une version prise en charge.", "ja": "ACK クラスターをサポートされているバージョンにアップグレードします。", "pt": "Atualize o cluster ACK para uma versão suportada.", "zh": "将 ACK 集群升级到受支持的版本。"}, ResourceTypes: []string{"ALIYUN::CS::AnyCluster", "ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-supported-version.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_supported_version", Content: "package infraguard.rules.aliyun.ack_cluster_supported_version\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ack-cluster-supported-version\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ACK Cluster Supported Version\",\n\t\t\"zh\": \"ACK 集群版本支持检测\",\n\t\t\"ja\": \"ACK クラスターサポートバージョン\",\n\t\t\"de\": \"ACK-Cluster Unterstützte Version\",\n\t\t\"es\": \"Versión Compatible del Clúster ACK\",\n\t\t\"fr\": \"Version Prise en Charge du Cluster ACK\",\n\t\t\"pt\": \"Versão Suportada do Cluster ACK\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the ACK cluster is running a supported version.\",\n\t\t\"zh\": \"确保 ACK 集群运行的是受支持的版本。\",\n\t\t\"ja\": \"ACK クラスターがサポートされているバージョンで実行されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der ACK-Cluster eine unterstützte Version ausführt.\",\n\t\t\"es\": \"Garantiza que el clúster ACK esté ejecutando una versión compatible.\",\n\t\t\"fr\": \"Garantit que le cluster ACK exécute une version prise en charge.\",\n\t\t\"pt\": \"Garante que o cluster ACK esteja executando uma versão suportada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Running an unsupported version may lead to security vulnerabilities and lack of support.\",\n\t\t\"zh\": \"运行不受支持的版本可能导致安全漏洞和缺乏技术支持。\",\n\t\t\"ja\": \"サポートされていないバージョンを実行すると、セキュリティの脆弱性やサポートの欠如につながる可能性があります。\",\n\t\t\"de\": \"Das Ausführen einer nicht unterstützten Version kann zu Sicherheitslücken und fehlender Unterstützung führen.\",\n\t\t\"es\": \"Ejecutar una versión no compatible puede provocar vulnerabilidades de seguridad y falta de soporte.\",\n\t\t\"fr\": \"Exécuter une version non prise en charge peut entraîner des vulnérabilités de sécurité et un manque de support.\",\n\t\t\"pt\": \"Executar uma versão não suportada pode levar a vulnerabilidades de segurança e falta de suporte.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade the ACK cluster to a supported version.\",\n\t\t\"zh\": \"将 ACK 集群升级到受支持的版本。\",\n\t\t\"ja\": \"ACK クラスターをサポートされているバージョンにアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie den ACK-Cluster auf eine unterstützte Version.\",\n\t\t\"es\": \"Actualice el clúster ACK a una versión compatible.\",\n\t\t\"fr\": \"Mettez à niveau le cluster ACK vers une version prise en charge.\",\n\t\t\"pt\": \"Atualize o cluster ACK para uma versão suportada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CS::AnyCluster\", \"ALIYUN::CS::ManagedKubernetesCluster\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::CS::ManagedKubernetesCluster\", \"ALIYUN::CS::AnyCluster\"])\n\n\t# Conceptual check - any cluster with a version is potentially unsupported\n\thelpers.has_property(resource, \"KubernetesVersion\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"KubernetesVersion\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ack-cluster-upgrade-latest-version", Name: models.I18nString{"de": "ACK-Cluster auf neueste Version aktualisiert", "en": "ACK Cluster Upgraded to Latest Version", "es": "Clúster ACK Actualizado a la Última Versión", "fr": "Cluster ACK Mis à Jour vers la Dernière Version", "ja": "ACK クラスタが最新バージョンにアップグレードされている", "pt": "Cluster ACK Atualizado para a Versão Mais Recente", "zh": "ACK 集群已升级至最新版本"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der ACK-Cluster die neueste verfügbare Version ausführt.", "en": "Ensures that the ACK cluster is running the latest available version.", "es": "Garantiza que el clúster ACK esté ejecutando la última versión disponible.", "fr": "Garantit que le cluster ACK exécute la dernière version disponible.", "ja": "ACK クラスタが最新の利用可能なバージョンを実行していることを確認します。", "pt": "Garante que o cluster ACK esteja executando a versão mais recente disponível.", "zh": "确保 ACK 集群运行的是最新的可用版本。"}, Reason: models.I18nString{"de": "Die Ausführung der neuesten Version stellt sicher, dass Sie die neuesten Sicherheitspatches und Funktionen haben.", "en": "Running the latest version ensures that you have the latest security patches and features.", "es": "Ejecutar la última versión garantiza que tenga los últimos parches de seguridad y funciones.", "fr": "L'exécution de la dernière version garantit que vous disposez des derniers correctifs de sécurité et fonctionnalités.", "ja": "最新バージョンを実行することで、最新のセキュリティパッチと機能を確保できます。", "pt": "Executar a versão mais recente garante que você tenha os patches de segurança e recursos mais recentes.", "zh": "运行最新版本可确保您获得最新的安全补丁和功能。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie den ACK-Cluster auf die neueste verfügbare Version.", "en": "Upgrade the ACK cluster to the latest available version.", "es": "Actualice el clúster ACK a la última versión disponible.", "fr": "Mettez à jour le cluster ACK vers la dernière version disponible.", "ja": "ACK クラスタを最新の利用可能なバージョンにアップグレードします。", "pt": "Atualize o cluster ACK para a versão mais recente disponível.", "zh": "将 ACK 集群升级到最新的可用版本。"}, ResourceTypes: []string{"ALIYUN::CS::AnyCluster", "ALIYUN::CS::ManagedKubernetesCluster"}, FilePath: "aliyun/rules/ack-cluster-upgrade-latest-version.rego", PackageName: "infraguard.rules.aliyun.ack_cluster_upgrade_latest_version", Content: "package infraguard.rules.aliyun.ack_cluster_upgrade_latest_version\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ack-cluster-upgrade-latest-version\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ACK Cluster Upgraded to Latest Version\",\n\t\t\"zh\": \"ACK 集群已升级至最新版本\",\n\t\t\"ja\": \"ACK クラスタが最新バージョンにアップグレードされている\",\n\t\t\"de\": \"ACK-Cluster auf neueste Version aktualisiert\",\n\t\t\"es\": \"Clúster ACK Actualizado a la Última Versión\",\n\t\t\"fr\": \"Cluster ACK Mis à Jour vers la Dernière Version\",\n\t\t\"pt\": \"Cluster ACK Atualizado para a Versão Mais Recente\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the ACK cluster is running the latest available version.\",\n\t\t\"zh\": \"确保 ACK 集群运行的是最新的可用版本。\",\n\t\t\"ja\": \"ACK クラスタが最新の利用可能なバージョンを実行していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der ACK-Cluster die neueste verfügbare Version ausführt.\",\n\t\t\"es\": \"Garantiza que el clúster ACK esté ejecutando la última versión disponible.\",\n\t\t\"fr\": \"Garantit que le cluster ACK exécute la dernière version disponible.\",\n\t\t\"pt\": \"Garante que o cluster ACK esteja executando a versão mais recente disponível.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Running the latest version ensures that you have the latest security patches and features.\",\n\t\t\"zh\": \"运行最新版本可确保您获得最新的安全补丁和功能。\",\n\t\t\"ja\": \"最新バージョンを実行することで、最新のセキュリティパッチと機能を確保できます。\",\n\t\t\"de\": \"Die Ausführung der neuesten Version stellt sicher, dass Sie die neuesten Sicherheitspatches und Funktionen haben.\",\n\t\t\"es\": \"Ejecutar la última versión garantiza que tenga los últimos parches de seguridad y funciones.\",\n\t\t\"fr\": \"L'exécution de la dernière version garantit que vous disposez des derniers correctifs de sécurité et fonctionnalités.\",\n\t\t\"pt\": \"Executar a versão mais recente garante que você tenha os patches de segurança e recursos mais recentes.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade the ACK cluster to the latest available version.\",\n\t\t\"zh\": \"将 ACK 集群升级到最新的可用版本。\",\n\t\t\"ja\": \"ACK クラスタを最新の利用可能なバージョンにアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie den ACK-Cluster auf die neueste verfügbare Version.\",\n\t\t\"es\": \"Actualice el clúster ACK a la última versión disponible.\",\n\t\t\"fr\": \"Mettez à jour le cluster ACK vers la dernière version disponible.\",\n\t\t\"pt\": \"Atualize o cluster ACK para a versão mais recente disponível.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CS::AnyCluster\", \"ALIYUN::CS::ManagedKubernetesCluster\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::CS::ManagedKubernetesCluster\", \"ALIYUN::CS::AnyCluster\"])\n\n\t# Conceptual check for version\n\thelpers.has_property(resource, \"ClusterVersion\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ClusterVersion\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:acs-cluster-node-multi-zone", Name: models.I18nString{"de": "ACS-Cluster-Knoten Multi-Zone-Bereitstellung", "en": "ACS Cluster Node Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Nodos de Clúster ACS", "fr": "Déploiement Multi-Zone des Nœuds du Cluster ACS", "ja": "ACS クラスターノードのマルチゾーン展開", "pt": "Implantação Multi-Zona de Nós do Cluster ACS", "zh": "使用区域级多可用区 ACS 集群"}, Severity: "high", Description: models.I18nString{"de": "Die ACS-Cluster-Knoten sollten für hohe Verfügbarkeit über 3 oder mehr Verfügbarkeitszonen verteilt werden.", "en": "The ACS cluster nodes should be distributed across 3 or more availability zones for high availability.", "es": "Los nodos del clúster ACS deben distribuirse en 3 o más zonas de disponibilidad para alta disponibilidad.", "fr": "Les nœuds du cluster ACS doivent être distribués sur 3 zones de disponibilité ou plus pour une haute disponibilité.", "ja": "ACS クラスターノードは高可用性のために 3 つ以上の可用性ゾーンに分散する必要があります。", "pt": "Os nós do cluster ACS devem ser distribuídos em 3 ou mais zonas de disponibilidade para alta disponibilidade.", "zh": "使用区域级 ACS 集群，节点分布在 3 个及以上可用区，视为合规。"}, Reason: models.I18nString{"de": "Die ACS-Cluster-Knoten sind nicht über 3 oder mehr Verfügbarkeitszonen verteilt.", "en": "The ACS cluster nodes are not distributed across 3 or more availability zones.", "es": "Los nodos del clúster ACS no están distribuidos en 3 o más zonas de disponibilidad.", "fr": "Les nœuds du cluster ACS ne sont pas distribués sur 3 zones de disponibilité ou plus.", "ja": "ACS クラスターノードが 3 つ以上の可用性ゾーンに分散されていません。", "pt": "Os nós do cluster ACS não estão distribuídos em 3 ou mais zonas de disponibilidade.", "zh": "ACS 集群节点未分布在 3 个及以上可用区。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie den Cluster so, dass er mindestens 3 Verfügbarkeitszonen verwendet, indem Sie mehrere ZoneIds oder VSwitchIds angeben.", "en": "Configure the cluster to use at least 3 availability zones by specifying multiple ZoneIds or VSwitchIds.", "es": "Configure el clúster para usar al menos 3 zonas de disponibilidad especificando múltiples ZoneIds o VSwitchIds.", "fr": "Configurez le cluster pour utiliser au moins 3 zones de disponibilité en spécifiant plusieurs ZoneIds ou VSwitchIds.", "ja": "複数の ZoneIds または VSwitchIds を指定して、クラスターを少なくとも 3 つの可用性ゾーンを使用するように設定します。", "pt": "Configure o cluster para usar pelo menos 3 zonas de disponibilidade especificando múltiplos ZoneIds ou VSwitchIds.", "zh": "通过指定多个 ZoneIds 或 VSwitchIds，将集群配置为使用至少 3 个可用区。"}, ResourceTypes: []string{"ALIYUN::ACS::Cluster"}, FilePath: "aliyun/rules/acs-cluster-node-multi-zone.rego", PackageName: "infraguard.rules.aliyun.acs_cluster_node_multi_zone", Content: "package infraguard.rules.aliyun.acs_cluster_node_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"acs-cluster-node-multi-zone\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ACS Cluster Node Multi-Zone Deployment\",\n\t\t\"zh\": \"使用区域级多可用区 ACS 集群\",\n\t\t\"ja\": \"ACS クラスターノードのマルチゾーン展開\",\n\t\t\"de\": \"ACS-Cluster-Knoten Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Nodos de Clúster ACS\",\n\t\t\"fr\": \"Déploiement Multi-Zone des Nœuds du Cluster ACS\",\n\t\t\"pt\": \"Implantação Multi-Zona de Nós do Cluster ACS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"The ACS cluster nodes should be distributed across 3 or more availability zones for high availability.\",\n\t\t\"zh\": \"使用区域级 ACS 集群，节点分布在 3 个及以上可用区，视为合规。\",\n\t\t\"ja\": \"ACS クラスターノードは高可用性のために 3 つ以上の可用性ゾーンに分散する必要があります。\",\n\t\t\"de\": \"Die ACS-Cluster-Knoten sollten für hohe Verfügbarkeit über 3 oder mehr Verfügbarkeitszonen verteilt werden.\",\n\t\t\"es\": \"Los nodos del clúster ACS deben distribuirse en 3 o más zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les nœuds du cluster ACS doivent être distribués sur 3 zones de disponibilité ou plus pour une haute disponibilité.\",\n\t\t\"pt\": \"Os nós do cluster ACS devem ser distribuídos em 3 ou mais zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ACS cluster nodes are not distributed across 3 or more availability zones.\",\n\t\t\"zh\": \"ACS 集群节点未分布在 3 个及以上可用区。\",\n\t\t\"ja\": \"ACS クラスターノードが 3 つ以上の可用性ゾーンに分散されていません。\",\n\t\t\"de\": \"Die ACS-Cluster-Knoten sind nicht über 3 oder mehr Verfügbarkeitszonen verteilt.\",\n\t\t\"es\": \"Los nodos del clúster ACS no están distribuidos en 3 o más zonas de disponibilidad.\",\n\t\t\"fr\": \"Les nœuds du cluster ACS ne sont pas distribués sur 3 zones de disponibilité ou plus.\",\n\t\t\"pt\": \"Os nós do cluster ACS não estão distribuídos em 3 ou mais zonas de disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the cluster to use at least 3 availability zones by specifying multiple ZoneIds or VSwitchIds.\",\n\t\t\"zh\": \"通过指定多个 ZoneIds 或 VSwitchIds，将集群配置为使用至少 3 个可用区。\",\n\t\t\"ja\": \"複数の ZoneIds または VSwitchIds を指定して、クラスターを少なくとも 3 つの可用性ゾーンを使用するように設定します。\",\n\t\t\"de\": \"Konfigurieren Sie den Cluster so, dass er mindestens 3 Verfügbarkeitszonen verwendet, indem Sie mehrere ZoneIds oder VSwitchIds angeben.\",\n\t\t\"es\": \"Configure el clúster para usar al menos 3 zonas de disponibilidad especificando múltiples ZoneIds o VSwitchIds.\",\n\t\t\"fr\": \"Configurez le cluster pour utiliser au moins 3 zones de disponibilité en spécifiant plusieurs ZoneIds ou VSwitchIds.\",\n\t\t\"pt\": \"Configure o cluster para usar pelo menos 3 zonas de disponibilidade especificando múltiplos ZoneIds ou VSwitchIds.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ACS::Cluster\"]\n}\n\n# Check if cluster is multi-zone\nis_multi_zone(resource) if {\n\tcount(object.get(resource.Properties, \"ZoneIds\", [])) >= 3\n}\n\nis_multi_zone(resource) if {\n\t# If ZoneIds is not provided, check VSwitchIds as a proxy if ZoneIds is missing\n\tnot object.get(resource.Properties, \"ZoneIds\", [])\n\tcount(object.get(resource.Properties, \"VSwitchIds\", [])) >= 3\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ZoneIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:actiontrail-enabled", Name: models.I18nString{"de": "ActionTrail aktiviert", "en": "ActionTrail Enabled", "es": "ActionTrail Habilitado", "fr": "ActionTrail Activé", "ja": "ActionTrail が有効", "pt": "ActionTrail Habilitado", "zh": "确保操作审计已开启"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass ActionTrail aktiviert ist, um Kontenaktivitäten aufzuzeichnen.", "en": "Ensures ActionTrail is enabled to record account activities.", "es": "Garantiza que ActionTrail esté habilitado para registrar actividades de la cuenta.", "fr": "Garantit qu'ActionTrail est activé pour enregistrer les activités du compte.", "ja": "アカウント活動を記録するために ActionTrail が有効になっていることを確認します。", "pt": "Garante que o ActionTrail está habilitado para registrar atividades da conta.", "zh": "确保开启了操作审计（ActionTrail）以记录账号活动。"}, Reason: models.I18nString{"de": "ActionTrail bietet einen Datensatz von API-Aufrufen, der für Sicherheitsaudits und forensische Analysen unerlässlich ist.", "en": "ActionTrail provides a record of API calls, which is essential for security auditing and forensic analysis.", "es": "ActionTrail proporciona un registro de llamadas API, esencial para auditorías de seguridad y análisis forense.", "fr": "ActionTrail fournit un enregistrement des appels API, essentiel pour l'audit de sécurité et l'analyse médico-légale.", "ja": "ActionTrail は API 呼び出しの記録を提供し、セキュリティ監査とフォレンジック分析に不可欠です。", "pt": "O ActionTrail fornece um registro de chamadas de API, essencial para auditoria de segurança e análise forense.", "zh": "操作审计记录了 API 调用情况，这对于安全审计和取证分析至关重要。"}, Recommendation: models.I18nString{"de": "Erstellen und aktivieren Sie mindestens eine Spur in ActionTrail.", "en": "Create and enable at least one trail in ActionTrail.", "es": "Cree y habilite al menos un rastro en ActionTrail.", "fr": "Créez et activez au moins une piste dans ActionTrail.", "ja": "ActionTrail で少なくとも 1 つのトレイルを作成して有効にします。", "pt": "Crie e habilite pelo menos uma trilha no ActionTrail.", "zh": "在操作审计中创建并启用至少一个跟踪（Trail）。"}, ResourceTypes: []string{"ALIYUN::ACTIONTRAIL::Trail"}, FilePath: "aliyun/rules/actiontrail-enabled.rego", PackageName: "infraguard.rules.aliyun.actiontrail_enabled", Content: "package infraguard.rules.aliyun.actiontrail_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"actiontrail-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ActionTrail Enabled\",\n\t\t\"zh\": \"确保操作审计已开启\",\n\t\t\"ja\": \"ActionTrail が有効\",\n\t\t\"de\": \"ActionTrail aktiviert\",\n\t\t\"es\": \"ActionTrail Habilitado\",\n\t\t\"fr\": \"ActionTrail Activé\",\n\t\t\"pt\": \"ActionTrail Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ActionTrail is enabled to record account activities.\",\n\t\t\"zh\": \"确保开启了操作审计（ActionTrail）以记录账号活动。\",\n\t\t\"ja\": \"アカウント活動を記録するために ActionTrail が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ActionTrail aktiviert ist, um Kontenaktivitäten aufzuzeichnen.\",\n\t\t\"es\": \"Garantiza que ActionTrail esté habilitado para registrar actividades de la cuenta.\",\n\t\t\"fr\": \"Garantit qu'ActionTrail est activé pour enregistrer les activités du compte.\",\n\t\t\"pt\": \"Garante que o ActionTrail está habilitado para registrar atividades da conta.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ActionTrail provides a record of API calls, which is essential for security auditing and forensic analysis.\",\n\t\t\"zh\": \"操作审计记录了 API 调用情况，这对于安全审计和取证分析至关重要。\",\n\t\t\"ja\": \"ActionTrail は API 呼び出しの記録を提供し、セキュリティ監査とフォレンジック分析に不可欠です。\",\n\t\t\"de\": \"ActionTrail bietet einen Datensatz von API-Aufrufen, der für Sicherheitsaudits und forensische Analysen unerlässlich ist.\",\n\t\t\"es\": \"ActionTrail proporciona un registro de llamadas API, esencial para auditorías de seguridad y análisis forense.\",\n\t\t\"fr\": \"ActionTrail fournit un enregistrement des appels API, essentiel pour l'audit de sécurité et l'analyse médico-légale.\",\n\t\t\"pt\": \"O ActionTrail fornece um registro de chamadas de API, essencial para auditoria de segurança e análise forense.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Create and enable at least one trail in ActionTrail.\",\n\t\t\"zh\": \"在操作审计中创建并启用至少一个跟踪（Trail）。\",\n\t\t\"ja\": \"ActionTrail で少なくとも 1 つのトレイルを作成して有効にします。\",\n\t\t\"de\": \"Erstellen und aktivieren Sie mindestens eine Spur in ActionTrail.\",\n\t\t\"es\": \"Cree y habilite al menos un rastro en ActionTrail.\",\n\t\t\"fr\": \"Créez et activez au moins une piste dans ActionTrail.\",\n\t\t\"pt\": \"Crie e habilite pelo menos uma trilha no ActionTrail.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ACTIONTRAIL::Trail\"]\n}\n\nis_compliant(resource) := true\n\n# If the resource exists in template, we check if logging is enabled\n# Note: Often requires ALIYUN::ACTIONTRAIL::TrailLogging\n# Basic check for existence of Trail resource\n\ndeny contains result if {\n\t# If no Trail resource exists at all in the template\n\thelpers.count_resources_by_type(\"ALIYUN::ACTIONTRAIL::Trail\") == 0\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": \"Global\",\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:actiontrail-trail-intact-enabled", Name: models.I18nString{"de": "ActionTrail Trail vollständig aktiviert", "en": "ActionTrail Trail Intact Enabled", "es": "Trilha ActionTrail Intacta Habilitada", "fr": "Piste ActionTrail Intacte Activée", "ja": "ActionTrail トレイルが完全に有効", "pt": "Trilha ActionTrail Intacta Habilitada", "zh": "开启操作审计全量日志跟踪"}, Severity: "high", Description: models.I18nString{"de": "ActionTrail Trail sollte aktiviert sein und alle Ereignistypen (Lesen und Schreiben) verfolgen.", "en": "ActionTrail trail should be enabled and track all event types (Read and Write).", "es": "La trilha ActionTrail debe estar habilitada y rastrear todos los tipos de eventos (Lectura y Escritura).", "fr": "La piste ActionTrail doit être activée et suivre tous les types d'événements (Lecture et Écriture).", "ja": "ActionTrail トレイルを有効にし、すべてのイベントタイプ（読み取りと書き込み）を追跡する必要があります。", "pt": "A trilha ActionTrail deve estar habilitada e rastrear todos os tipos de eventos (Leitura e Escrita).", "zh": "操作审计中存在开启状态的跟踪，且跟踪全部地域和全部事件类型。"}, Reason: models.I18nString{"de": "Der ActionTrail Trail ist nicht aktiviert oder verfolgt nicht alle Ereignistypen.", "en": "The ActionTrail trail is not enabled or does not track all event types.", "es": "La trilha ActionTrail no está habilitada o no rastrea todos los tipos de eventos.", "fr": "La piste ActionTrail n'est pas activée ou ne suit pas tous les types d'événements.", "ja": "ActionTrail トレイルが有効になっていないか、すべてのイベントタイプを追跡していません。", "pt": "A trilha ActionTrail não está habilitada ou não rastreia todos os tipos de eventos.", "zh": "操作审计跟踪未开启或未跟踪所有事件类型。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Trail mit ALIYUN::ACTIONTRAIL::TrailLogging und setzen Sie EventRW in ALIYUN::ACTIONTRAIL::Trail auf All.", "en": "Enable the trail using ALIYUN::ACTIONTRAIL::TrailLogging and set EventRW to All in ALIYUN::ACTIONTRAIL::Trail.", "es": "Habilite la trilha usando ALIYUN::ACTIONTRAIL::TrailLogging y establezca EventRW en All en ALIYUN::ACTIONTRAIL::Trail.", "fr": "Activez la piste en utilisant ALIYUN::ACTIONTRAIL::TrailLogging et définissez EventRW sur All dans ALIYUN::ACTIONTRAIL::Trail.", "ja": "ALIYUN::ACTIONTRAIL::TrailLogging を使用してトレイルを有効にし、ALIYUN::ACTIONTRAIL::Trail で EventRW を All に設定します。", "pt": "Habilite a trilha usando ALIYUN::ACTIONTRAIL::TrailLogging e defina EventRW como All em ALIYUN::ACTIONTRAIL::Trail.", "zh": "使用 ALIYUN::ACTIONTRAIL::TrailLogging 启用跟踪，并在 ALIYUN::ACTIONTRAIL::Trail 中将 EventRW 设置为 All。"}, ResourceTypes: []string{"ALIYUN::ACTIONTRAIL::Trail"}, FilePath: "aliyun/rules/actiontrail-trail-intact-enabled.rego", PackageName: "infraguard.rules.aliyun.actiontrail_trail_intact_enabled", Content: "package infraguard.rules.aliyun.actiontrail_trail_intact_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"actiontrail-trail-intact-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ActionTrail Trail Intact Enabled\",\n\t\t\"zh\": \"开启操作审计全量日志跟踪\",\n\t\t\"ja\": \"ActionTrail トレイルが完全に有効\",\n\t\t\"de\": \"ActionTrail Trail vollständig aktiviert\",\n\t\t\"es\": \"Trilha ActionTrail Intacta Habilitada\",\n\t\t\"fr\": \"Piste ActionTrail Intacte Activée\",\n\t\t\"pt\": \"Trilha ActionTrail Intacta Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ActionTrail trail should be enabled and track all event types (Read and Write).\",\n\t\t\"zh\": \"操作审计中存在开启状态的跟踪，且跟踪全部地域和全部事件类型。\",\n\t\t\"ja\": \"ActionTrail トレイルを有効にし、すべてのイベントタイプ（読み取りと書き込み）を追跡する必要があります。\",\n\t\t\"de\": \"ActionTrail Trail sollte aktiviert sein und alle Ereignistypen (Lesen und Schreiben) verfolgen.\",\n\t\t\"es\": \"La trilha ActionTrail debe estar habilitada y rastrear todos los tipos de eventos (Lectura y Escritura).\",\n\t\t\"fr\": \"La piste ActionTrail doit être activée et suivre tous les types d'événements (Lecture et Écriture).\",\n\t\t\"pt\": \"A trilha ActionTrail deve estar habilitada e rastrear todos os tipos de eventos (Leitura e Escrita).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ActionTrail trail is not enabled or does not track all event types.\",\n\t\t\"zh\": \"操作审计跟踪未开启或未跟踪所有事件类型。\",\n\t\t\"ja\": \"ActionTrail トレイルが有効になっていないか、すべてのイベントタイプを追跡していません。\",\n\t\t\"de\": \"Der ActionTrail Trail ist nicht aktiviert oder verfolgt nicht alle Ereignistypen.\",\n\t\t\"es\": \"La trilha ActionTrail no está habilitada o no rastrea todos los tipos de eventos.\",\n\t\t\"fr\": \"La piste ActionTrail n'est pas activée ou ne suit pas tous les types d'événements.\",\n\t\t\"pt\": \"A trilha ActionTrail não está habilitada ou não rastreia todos os tipos de eventos.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable the trail using ALIYUN::ACTIONTRAIL::TrailLogging and set EventRW to All in ALIYUN::ACTIONTRAIL::Trail.\",\n\t\t\"zh\": \"使用 ALIYUN::ACTIONTRAIL::TrailLogging 启用跟踪，并在 ALIYUN::ACTIONTRAIL::Trail 中将 EventRW 设置为 All。\",\n\t\t\"ja\": \"ALIYUN::ACTIONTRAIL::TrailLogging を使用してトレイルを有効にし、ALIYUN::ACTIONTRAIL::Trail で EventRW を All に設定します。\",\n\t\t\"de\": \"Aktivieren Sie den Trail mit ALIYUN::ACTIONTRAIL::TrailLogging und setzen Sie EventRW in ALIYUN::ACTIONTRAIL::Trail auf All.\",\n\t\t\"es\": \"Habilite la trilha usando ALIYUN::ACTIONTRAIL::TrailLogging y establezca EventRW en All en ALIYUN::ACTIONTRAIL::Trail.\",\n\t\t\"fr\": \"Activez la piste en utilisant ALIYUN::ACTIONTRAIL::TrailLogging et définissez EventRW sur All dans ALIYUN::ACTIONTRAIL::Trail.\",\n\t\t\"pt\": \"Habilite a trilha usando ALIYUN::ACTIONTRAIL::TrailLogging e defina EventRW como All em ALIYUN::ACTIONTRAIL::Trail.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ACTIONTRAIL::Trail\"]\n}\n\n# Get all enabled trail names from TrailLogging resources\nenabled_trails := {name |\n\tsome logging in helpers.resources_by_type(\"ALIYUN::ACTIONTRAIL::TrailLogging\")\n\thelpers.get_property(logging, \"Enable\", false) == true\n\tname := helpers.get_property(logging, \"Name\", \"\")\n\tname != \"\"\n}\n\n# Check if a trail is enabled (referenced by an enabled TrailLogging)\nis_trail_enabled(trail_name) if {\n\ttrail_name in enabled_trails\n}\n\n# Check if trail tracks all events\nis_track_all_events(resource) if {\n\thelpers.get_property(resource, \"EventRW\", \"Write\") == \"All\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\n\t# Get the trail name (either property Name or resource name if not set?)\n\t# Trail Name property is required.\n\ttrail_name := helpers.get_property(resource, \"Name\", \"\")\n\n\t# Check conditions\n\tviolation := check_violation(trail_name, resource)\n\tviolation != null\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EventRW\"], # Approximate path\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": violation,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ncheck_violation(trail_name, resource) := reason if {\n\tnot is_track_all_events(resource)\n\treason := rule_meta.reason.zh # \"Not tracking all events\"\n}\n\ncheck_violation(trail_name, resource) := reason if {\n\tis_track_all_events(resource)\n\tnot is_trail_enabled(trail_name)\n\treason := \"操作审计跟踪未开启 (缺少启用的 TrailLogging)\"\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:adb-cluster-multi-zone", Name: models.I18nString{"de": "ADB-Cluster Multi-Zonen-Bereitstellung", "en": "ADB Cluster Multi-Zone Deployment", "es": "Implementación Multi-Zona del Clúster ADB", "fr": "Déploiement Multi-Zone du Cluster ADB", "ja": "ADB クラスターマルチゾーン展開", "pt": "Implantação Multi-Zona do Cluster ADB", "zh": "ADB 集群部署模式为多可用区"}, Severity: "medium", Description: models.I18nString{"de": "Der ADB-Cluster sollte im Multi-Zonen-Modus bereitgestellt werden.", "en": "The ADB cluster should be deployed in multi-zone mode.", "es": "El clúster ADB debe implementarse en modo multi-zona.", "fr": "Le cluster ADB doit être déployé en mode multi-zone.", "ja": "ADB クラスターはマルチゾーンモードで展開する必要があります。", "pt": "O cluster ADB deve ser implantado em modo multi-zona.", "zh": "ADB 集群为多可用区部署模式，视为合规。"}, Reason: models.I18nString{"de": "Der ADB-Cluster ist nicht mit einer sekundären Zone konfiguriert, was darauf hindeutet, dass es sich um eine Einzelzone handelt.", "en": "The ADB cluster is not configured with a secondary zone, indicating it is single-zone.", "es": "El clúster ADB no está configurado con una zona secundaria, lo que indica que es de zona única.", "fr": "Le cluster ADB n'est pas configuré avec une zone secondaire, indiquant qu'il s'agit d'une zone unique.", "ja": "ADB クラスターにセカンダリゾーンが設定されていないため、シングルゾーンであることを示しています。", "pt": "O cluster ADB não está configurado com uma zona secundária, indicando que é de zona única.", "zh": "ADB 集群未配置备可用区，表明其为单可用区部署。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie SecondaryZoneId, um Multi-Zonen-Bereitstellung zu aktivieren.", "en": "Configure the SecondaryZoneId to enable multi-zone deployment.", "es": "Configure SecondaryZoneId para habilitar la implementación multi-zona.", "fr": "Configurez SecondaryZoneId pour activer le déploiement multi-zone.", "ja": "マルチゾーン展開を有効にするために SecondaryZoneId を設定します。", "pt": "Configure SecondaryZoneId para habilitar a implantação multi-zona.", "zh": "配置 SecondaryZoneId 以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::ADBLake::DBCluster"}, FilePath: "aliyun/rules/adb-cluster-multi-zone.rego", PackageName: "infraguard.rules.aliyun.adb_cluster_multi_zone", Content: "package infraguard.rules.aliyun.adb_cluster_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"adb-cluster-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ADB Cluster Multi-Zone Deployment\",\n\t\t\"zh\": \"ADB 集群部署模式为多可用区\",\n\t\t\"ja\": \"ADB クラスターマルチゾーン展開\",\n\t\t\"de\": \"ADB-Cluster Multi-Zonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona del Clúster ADB\",\n\t\t\"fr\": \"Déploiement Multi-Zone du Cluster ADB\",\n\t\t\"pt\": \"Implantação Multi-Zona do Cluster ADB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"The ADB cluster should be deployed in multi-zone mode.\",\n\t\t\"zh\": \"ADB 集群为多可用区部署模式，视为合规。\",\n\t\t\"ja\": \"ADB クラスターはマルチゾーンモードで展開する必要があります。\",\n\t\t\"de\": \"Der ADB-Cluster sollte im Multi-Zonen-Modus bereitgestellt werden.\",\n\t\t\"es\": \"El clúster ADB debe implementarse en modo multi-zona.\",\n\t\t\"fr\": \"Le cluster ADB doit être déployé en mode multi-zone.\",\n\t\t\"pt\": \"O cluster ADB deve ser implantado em modo multi-zona.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ADB cluster is not configured with a secondary zone, indicating it is single-zone.\",\n\t\t\"zh\": \"ADB 集群未配置备可用区，表明其为单可用区部署。\",\n\t\t\"ja\": \"ADB クラスターにセカンダリゾーンが設定されていないため、シングルゾーンであることを示しています。\",\n\t\t\"de\": \"Der ADB-Cluster ist nicht mit einer sekundären Zone konfiguriert, was darauf hindeutet, dass es sich um eine Einzelzone handelt.\",\n\t\t\"es\": \"El clúster ADB no está configurado con una zona secundaria, lo que indica que es de zona única.\",\n\t\t\"fr\": \"Le cluster ADB n'est pas configuré avec une zone secondaire, indiquant qu'il s'agit d'une zone unique.\",\n\t\t\"pt\": \"O cluster ADB não está configurado com uma zona secundária, indicando que é de zona única.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the SecondaryZoneId to enable multi-zone deployment.\",\n\t\t\"zh\": \"配置 SecondaryZoneId 以启用多可用区部署。\",\n\t\t\"ja\": \"マルチゾーン展開を有効にするために SecondaryZoneId を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie SecondaryZoneId, um Multi-Zonen-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure SecondaryZoneId para habilitar la implementación multi-zona.\",\n\t\t\"fr\": \"Configurez SecondaryZoneId pour activer le déploiement multi-zone.\",\n\t\t\"pt\": \"Configure SecondaryZoneId para habilitar a implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ADBLake::DBCluster\"]\n}\n\n# Check if ADB is multi-zone\nis_multi_zone(resource) if {\n\t# Check if SecondaryZoneId is present\n\tobject.get(resource.Properties, \"SecondaryZoneId\", \"\") != \"\"\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecondaryZoneId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-acl-public-access-check", Name: models.I18nString{"de": "ALB ACL erlaubt keinen öffentlichen Zugriff", "en": "ALB ACL Does Not Allow Public Access", "es": "La ACL ALB No Permite Acceso Público", "fr": "L'ACL ALB N'autorise Pas l'Accès Public", "ja": "ALB ACL がパブリックアクセスを許可していない", "pt": "A ACL ALB Não Permite Acesso Público", "zh": "ALB 访问控制列表不允许配置所有地址段"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass ALB-Zugriffssteuerungslisten 0.0.0.0/0 (Erlaubnis aller IPs) nicht enthalten.", "en": "Ensures that ALB access control lists do not contain 0.0.0.0/0 (allowing all IPs).", "es": "Garantiza que las listas de control de acceso ALB no contengan 0.0.0.0/0 (permitiendo todas las IPs).", "fr": "Garantit que les listes de contrôle d'accès ALB ne contiennent pas 0.0.0.0/0 (autorisant toutes les IP).", "ja": "ALB アクセス制御リストに 0.0.0.0/0（すべての IP を許可）が含まれていないことを確認します。", "pt": "Garante que as listas de controle de acesso ALB não contenham 0.0.0.0/0 (permitindo todos os IPs).", "zh": "确保 ALB 访问控制列表不包含 0.0.0.0/0（允许所有 IP）。"}, Reason: models.I18nString{"de": "Das Setzen der ACL auf 0.0.0.0/0 erlaubt jeder IP den Zugriff auf den Load Balancer, was die Sicherheitsrisiken erheblich erhöht.", "en": "Setting the ACL to 0.0.0.0/0 allows any IP to access the load balancer, significantly increasing security risks.", "es": "Establecer la ACL en 0.0.0.0/0 permite que cualquier IP acceda al equilibrador de carga, aumentando significativamente los riesgos de seguridad.", "fr": "Définir l'ACL sur 0.0.0.0/0 permet à n'importe quelle IP d'accéder à l'équilibreur de charge, augmentant considérablement les risques de sécurité.", "ja": "ACL を 0.0.0.0/0 に設定すると、任意の IP がロードバランサーにアクセスできるようになり、セキュリティリスクが大幅に増加します。", "pt": "Definir a ACL como 0.0.0.0/0 permite que qualquer IP acesse o balanceador de carga, aumentando significativamente os riscos de segurança.", "zh": "将 ACL 设置为 0.0.0.0/0 允许任何 IP 访问负载均衡器，大大增加了安全风险。"}, Recommendation: models.I18nString{"de": "Beschränken Sie die ACL auf spezifische IP-Bereiche, anstatt alle IPs zuzulassen.", "en": "Restrict the ACL to specific IP ranges instead of allowing all IPs.", "es": "Restrinja la ACL a rangos de IP específicos en lugar de permitir todas las IPs.", "fr": "Restreignez l'ACL à des plages d'IP spécifiques au lieu d'autoriser toutes les IP.", "ja": "すべての IP を許可するのではなく、ACL を特定の IP 範囲に制限します。", "pt": "Restrinja a ACL a intervalos de IP específicos em vez de permitir todos os IPs.", "zh": "将 ACL 限制为特定的 IP 范围，而不是允许所有 IP。"}, ResourceTypes: []string{"ALIYUN::ALB::Acl"}, FilePath: "aliyun/rules/alb-acl-public-access-check.rego", PackageName: "infraguard.rules.aliyun.alb_acl_public_access_check", Content: "package infraguard.rules.aliyun.alb_acl_public_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"alb-acl-public-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ALB ACL Does Not Allow Public Access\",\n\t\t\"zh\": \"ALB 访问控制列表不允许配置所有地址段\",\n\t\t\"ja\": \"ALB ACL がパブリックアクセスを許可していない\",\n\t\t\"de\": \"ALB ACL erlaubt keinen öffentlichen Zugriff\",\n\t\t\"es\": \"La ACL ALB No Permite Acceso Público\",\n\t\t\"fr\": \"L'ACL ALB N'autorise Pas l'Accès Public\",\n\t\t\"pt\": \"A ACL ALB Não Permite Acesso Público\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ALB access control lists do not contain 0.0.0.0/0 (allowing all IPs).\",\n\t\t\"zh\": \"确保 ALB 访问控制列表不包含 0.0.0.0/0（允许所有 IP）。\",\n\t\t\"ja\": \"ALB アクセス制御リストに 0.0.0.0/0（すべての IP を許可）が含まれていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ALB-Zugriffssteuerungslisten 0.0.0.0/0 (Erlaubnis aller IPs) nicht enthalten.\",\n\t\t\"es\": \"Garantiza que las listas de control de acceso ALB no contengan 0.0.0.0/0 (permitiendo todas las IPs).\",\n\t\t\"fr\": \"Garantit que les listes de contrôle d'accès ALB ne contiennent pas 0.0.0.0/0 (autorisant toutes les IP).\",\n\t\t\"pt\": \"Garante que as listas de controle de acesso ALB não contenham 0.0.0.0/0 (permitindo todos os IPs).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Setting the ACL to 0.0.0.0/0 allows any IP to access the load balancer, significantly increasing security risks.\",\n\t\t\"zh\": \"将 ACL 设置为 0.0.0.0/0 允许任何 IP 访问负载均衡器，大大增加了安全风险。\",\n\t\t\"ja\": \"ACL を 0.0.0.0/0 に設定すると、任意の IP がロードバランサーにアクセスできるようになり、セキュリティリスクが大幅に増加します。\",\n\t\t\"de\": \"Das Setzen der ACL auf 0.0.0.0/0 erlaubt jeder IP den Zugriff auf den Load Balancer, was die Sicherheitsrisiken erheblich erhöht.\",\n\t\t\"es\": \"Establecer la ACL en 0.0.0.0/0 permite que cualquier IP acceda al equilibrador de carga, aumentando significativamente los riesgos de seguridad.\",\n\t\t\"fr\": \"Définir l'ACL sur 0.0.0.0/0 permet à n'importe quelle IP d'accéder à l'équilibreur de charge, augmentant considérablement les risques de sécurité.\",\n\t\t\"pt\": \"Definir a ACL como 0.0.0.0/0 permite que qualquer IP acesse o balanceador de carga, aumentando significativamente os riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict the ACL to specific IP ranges instead of allowing all IPs.\",\n\t\t\"zh\": \"将 ACL 限制为特定的 IP 范围，而不是允许所有 IP。\",\n\t\t\"ja\": \"すべての IP を許可するのではなく、ACL を特定の IP 範囲に制限します。\",\n\t\t\"de\": \"Beschränken Sie die ACL auf spezifische IP-Bereiche, anstatt alle IPs zuzulassen.\",\n\t\t\"es\": \"Restrinja la ACL a rangos de IP específicos en lugar de permitir todas las IPs.\",\n\t\t\"fr\": \"Restreignez l'ACL à des plages d'IP spécifiques au lieu d'autoriser toutes les IP.\",\n\t\t\"pt\": \"Restrinja a ACL a intervalos de IP específicos em vez de permitir todos os IPs.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::Acl\"]\n}\n\n# Check if ACL contains 0.0.0.0/0\ncontains_public_cidr(acl_resource) if {\n\tacl_entries := helpers.get_property(acl_resource, \"AclEntries\", [])\n\tsome entry in acl_entries\n\tcidr := entry.Entry\n\tcidr == \"0.0.0.0/0\"\n}\n\ncontains_public_cidr(acl_resource) if {\n\tacl_entries := helpers.get_property(acl_resource, \"AclEntries\", [])\n\tsome entry in acl_entries\n\tcidr := entry.Entry\n\tcidr == \"0.0.0.0\"\n}\n\nis_compliant(resource) if {\n\tnot contains_public_cidr(resource)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::Acl\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AclEntries\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-address-type-check", Name: models.I18nString{"de": "ALB-Adresstyp-Prüfung", "en": "ALB Address Type Check", "es": "Verificación de Tipo de Dirección ALB", "fr": "Vérification du Type d'Adresse ALB", "ja": "ALB アドレスタイプチェック", "pt": "Verificação de Tipo de Endereço ALB", "zh": "ALB 网络类型核查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass ALB-Instanzen den bevorzugten Adresstyp (z. B. Intranet) verwenden.", "en": "Ensures ALB instances use the preferred address type (e.g., Intranet).", "es": "Garantiza que las instancias ALB usen el tipo de dirección preferido (por ejemplo, Intranet).", "fr": "Garantit que les instances ALB utilisent le type d'adresse préféré (par exemple, Intranet).", "ja": "ALB インスタンスが優先アドレスタイプ（例：Intranet）を使用することを確認します。", "pt": "Garante que as instâncias ALB usem o tipo de endereço preferido (por exemplo, Intranet).", "zh": "确保 ALB 实例使用首选的网络类型（如私网）。"}, Reason: models.I18nString{"de": "Nur interne Dienste sollten auf einem Intranet-ALB platziert werden, um die Exposition zu reduzieren.", "en": "Internal-only services should be placed on an Intranet ALB to reduce exposure.", "es": "Los servicios solo internos deben colocarse en un ALB de Intranet para reducir la exposición.", "fr": "Les services uniquement internes doivent être placés sur un ALB Intranet pour réduire l'exposition.", "ja": "内部専用サービスは、露出を減らすために Intranet ALB に配置する必要があります。", "pt": "Serviços apenas internos devem ser colocados em um ALB Intranet para reduzir a exposição.", "zh": "仅限内部使用的服务应放置在私网 ALB 上以减少暴露。"}, Recommendation: models.I18nString{"de": "Setzen Sie AddressType für interne Dienste auf 'Intranet'.", "en": "Set AddressType to 'Intranet' for internal services.", "es": "Establezca AddressType en 'Intranet' para servicios internos.", "fr": "Définissez AddressType sur 'Intranet' pour les services internes.", "ja": "内部サービスの AddressType を 'Intranet' に設定します。", "pt": "Defina AddressType como 'Intranet' para serviços internos.", "zh": "为内部服务将 AddressType 设置为 'Intranet'。"}, ResourceTypes: []string{"ALIYUN::ALB::LoadBalancer"}, FilePath: "aliyun/rules/alb-address-type-check.rego", PackageName: "infraguard.rules.aliyun.alb_address_type_check", Content: "package infraguard.rules.aliyun.alb_address_type_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"alb-address-type-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ALB Address Type Check\",\n\t\t\"zh\": \"ALB 网络类型核查\",\n\t\t\"ja\": \"ALB アドレスタイプチェック\",\n\t\t\"de\": \"ALB-Adresstyp-Prüfung\",\n\t\t\"es\": \"Verificación de Tipo de Dirección ALB\",\n\t\t\"fr\": \"Vérification du Type d'Adresse ALB\",\n\t\t\"pt\": \"Verificação de Tipo de Endereço ALB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ALB instances use the preferred address type (e.g., Intranet).\",\n\t\t\"zh\": \"确保 ALB 实例使用首选的网络类型（如私网）。\",\n\t\t\"ja\": \"ALB インスタンスが優先アドレスタイプ（例：Intranet）を使用することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ALB-Instanzen den bevorzugten Adresstyp (z. B. Intranet) verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias ALB usen el tipo de dirección preferido (por ejemplo, Intranet).\",\n\t\t\"fr\": \"Garantit que les instances ALB utilisent le type d'adresse préféré (par exemple, Intranet).\",\n\t\t\"pt\": \"Garante que as instâncias ALB usem o tipo de endereço preferido (por exemplo, Intranet).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Internal-only services should be placed on an Intranet ALB to reduce exposure.\",\n\t\t\"zh\": \"仅限内部使用的服务应放置在私网 ALB 上以减少暴露。\",\n\t\t\"ja\": \"内部専用サービスは、露出を減らすために Intranet ALB に配置する必要があります。\",\n\t\t\"de\": \"Nur interne Dienste sollten auf einem Intranet-ALB platziert werden, um die Exposition zu reduzieren.\",\n\t\t\"es\": \"Los servicios solo internos deben colocarse en un ALB de Intranet para reducir la exposición.\",\n\t\t\"fr\": \"Les services uniquement internes doivent être placés sur un ALB Intranet pour réduire l'exposition.\",\n\t\t\"pt\": \"Serviços apenas internos devem ser colocados em um ALB Intranet para reduzir a exposição.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set AddressType to 'Intranet' for internal services.\",\n\t\t\"zh\": \"为内部服务将 AddressType 设置为 'Intranet'。\",\n\t\t\"ja\": \"内部サービスの AddressType を 'Intranet' に設定します。\",\n\t\t\"de\": \"Setzen Sie AddressType für interne Dienste auf 'Intranet'.\",\n\t\t\"es\": \"Establezca AddressType en 'Intranet' para servicios internos.\",\n\t\t\"fr\": \"Définissez AddressType sur 'Intranet' pour les services internes.\",\n\t\t\"pt\": \"Defina AddressType como 'Intranet' para serviços internos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::LoadBalancer\"]\n}\n\nis_compliant(resource) if {\n\t# Example: check if it's Intranet\n\thelpers.get_property(resource, \"AddressType\", \"\") == \"Intranet\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::LoadBalancer\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AddressType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-all-listener-health-check-enabled", Name: models.I18nString{"de": "ALB Alle Listener Health Check aktiviert", "en": "ALB All Listeners Health Check Enabled", "es": "Verificación de Salud de Todos los Oyentes ALB Habilitada", "fr": "Vérification de Santé de Tous les Écouteurs ALB Activée", "ja": "ALB すべてのリスナーヘルスチェックが有効", "pt": "Verificação de Integridade de Todos os Ouvintes ALB Habilitada", "zh": "ALB 所有监听开启健康检查"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass alle ALB-Listener Health Checks aktiviert haben.", "en": "Ensures all ALB listeners have health checks enabled.", "es": "Garantiza que todos los oyentes ALB tengan verificaciones de salud habilitadas.", "fr": "Garantit que tous les écouteurs ALB ont des vérifications de santé activées.", "ja": "すべての ALB リスナーでヘルスチェックが有効になっていることを確認します。", "pt": "Garante que todos os ouvintes ALB tenham verificações de integridade habilitadas.", "zh": "确保所有 ALB 监听均开启了健康检查。"}, Reason: models.I18nString{"de": "Health Checks sind entscheidend für die Erkennung und Umgehung ungesunder Backend-Server.", "en": "Health checks are vital for detecting and bypassing unhealthy backend servers.", "es": "Las verificaciones de salud son vitales para detectar y evitar servidores backend no saludables.", "fr": "Les vérifications de santé sont essentielles pour détecter et contourner les serveurs backend malsains.", "ja": "ヘルスチェックは、異常なバックエンドサーバーを検出して回避するために不可欠です。", "pt": "As verificações de integridade são vitais para detectar e contornar servidores backend não saudáveis.", "zh": "健康检查对于发现和避开不健康的后端服务器至关重要。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Health Checks für alle ALB-Listener.", "en": "Enable health checks for all ALB listeners.", "es": "Habilite las verificaciones de salud para todos los oyentes ALB.", "fr": "Activez les vérifications de santé pour tous les écouteurs ALB.", "ja": "すべての ALB リスナーのヘルスチェックを有効にします。", "pt": "Habilite verificações de integridade para todos os ouvintes ALB.", "zh": "为所有 ALB 监听开启健康检查。"}, ResourceTypes: []string{"ALIYUN::ALB::Listener"}, FilePath: "aliyun/rules/alb-all-listener-health-check-enabled.rego", PackageName: "infraguard.rules.aliyun.alb_all_listener_health_check_enabled", Content: "package infraguard.rules.aliyun.alb_all_listener_health_check_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"alb-all-listener-health-check-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ALB All Listeners Health Check Enabled\",\n\t\t\"zh\": \"ALB 所有监听开启健康检查\",\n\t\t\"ja\": \"ALB すべてのリスナーヘルスチェックが有効\",\n\t\t\"de\": \"ALB Alle Listener Health Check aktiviert\",\n\t\t\"es\": \"Verificación de Salud de Todos los Oyentes ALB Habilitada\",\n\t\t\"fr\": \"Vérification de Santé de Tous les Écouteurs ALB Activée\",\n\t\t\"pt\": \"Verificação de Integridade de Todos os Ouvintes ALB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures all ALB listeners have health checks enabled.\",\n\t\t\"zh\": \"确保所有 ALB 监听均开启了健康检查。\",\n\t\t\"ja\": \"すべての ALB リスナーでヘルスチェックが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass alle ALB-Listener Health Checks aktiviert haben.\",\n\t\t\"es\": \"Garantiza que todos los oyentes ALB tengan verificaciones de salud habilitadas.\",\n\t\t\"fr\": \"Garantit que tous les écouteurs ALB ont des vérifications de santé activées.\",\n\t\t\"pt\": \"Garante que todos os ouvintes ALB tenham verificações de integridade habilitadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Health checks are vital for detecting and bypassing unhealthy backend servers.\",\n\t\t\"zh\": \"健康检查对于发现和避开不健康的后端服务器至关重要。\",\n\t\t\"ja\": \"ヘルスチェックは、異常なバックエンドサーバーを検出して回避するために不可欠です。\",\n\t\t\"de\": \"Health Checks sind entscheidend für die Erkennung und Umgehung ungesunder Backend-Server.\",\n\t\t\"es\": \"Las verificaciones de salud son vitales para detectar y evitar servidores backend no saludables.\",\n\t\t\"fr\": \"Les vérifications de santé sont essentielles pour détecter et contourner les serveurs backend malsains.\",\n\t\t\"pt\": \"As verificações de integridade são vitais para detectar e contornar servidores backend não saudáveis.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable health checks for all ALB listeners.\",\n\t\t\"zh\": \"为所有 ALB 监听开启健康检查。\",\n\t\t\"ja\": \"すべての ALB リスナーのヘルスチェックを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Health Checks für alle ALB-Listener.\",\n\t\t\"es\": \"Habilite las verificaciones de salud para todos los oyentes ALB.\",\n\t\t\"fr\": \"Activez les vérifications de santé pour tous les écouteurs ALB.\",\n\t\t\"pt\": \"Habilite verificações de integridade para todos os ouvintes ALB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::Listener\"]\n}\n\n# Resolve ServerGroupId from Ref or string\nresolve_server_group_id(val) := id if {\n\tis_object(val)\n\tid := val.Ref\n} else := val if {\n\tis_string(val)\n}\n\n# Check if listener's server groups have health check enabled\nis_compliant(resource) if {\n\tdefault_actions := helpers.get_property(resource, \"DefaultActions\", [])\n\tsome action in default_actions\n\taction.Type == \"ForwardGroup\"\n\tforward_group_config := action.ForwardGroupConfig\n\tsome tuple in forward_group_config.ServerGroupTuples\n\tserver_group_id_val := tuple.ServerGroupId\n\tserver_group_id := resolve_server_group_id(server_group_id_val)\n\n\t# Find the server group resource\n\tsome name, server_group in input.Resources\n\tname == server_group_id\n\tserver_group.Type == \"ALIYUN::ALB::ServerGroup\"\n\n\t# Check health check config\n\thc := helpers.get_property(server_group, \"HealthCheckConfig\", {})\n\thelpers.is_true(object.get(hc, \"HealthCheckEnabled\", true))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"HealthCheckConfig\", \"HealthCheckEnabled\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-all-listenter-has-server", Name: models.I18nString{"de": "ALB-Listener hat Backend-Server", "en": "ALB Listener Has Backend Server", "es": "El Oyente ALB Tiene Servidor Backend", "fr": "L'Écouteur ALB a un Serveur Backend", "ja": "ALB リスナーにバックエンドサーバーがある", "pt": "O Ouvinte ALB Tem Servidor Backend", "zh": "ALB 监听绑定后端服务器"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass alle ALB-Listener einer nicht leeren Servergruppe zugeordnet sind.", "en": "Ensures all ALB listeners are associated with a non-empty server group.", "es": "Garantiza que todos los oyentes ALB estén asociados con un grupo de servidores no vacío.", "fr": "Garantit que tous les écouteurs ALB sont associés à un groupe de serveurs non vide.", "ja": "すべての ALB リスナーが空でないサーバーグループに関連付けられていることを確認します。", "pt": "Garante que todos os ouvintes ALB estejam associados a um grupo de servidores não vazio.", "zh": "确保所有 ALB 监听均关联了非空的服务器组。"}, Reason: models.I18nString{"de": "Ein Listener ohne Backend-Server kann keinen Datenverkehr verarbeiten, was zu Dienstunverfügbarkeit führt.", "en": "A listener without backend servers cannot handle any traffic, leading to service unavailability.", "es": "Un oyente sin servidores backend no puede manejar ningún tráfico, lo que lleva a la indisponibilidad del servicio.", "fr": "Un écouteur sans serveurs backend ne peut gérer aucun trafic, ce qui entraîne l'indisponibilité du service.", "ja": "バックエンドサーバーがないリスナーはトラフィックを処理できず、サービスが利用できなくなります。", "pt": "Um ouvinte sem servidores backend não pode lidar com nenhum tráfego, levando à indisponibilidade do serviço.", "zh": "未绑定后端服务器的监听无法处理任何流量，会导致服务不可用。"}, Recommendation: models.I18nString{"de": "Ordnen Sie den Listener einer Servergruppe zu, die gesunde Backend-Server enthält.", "en": "Associate the listener with a server group that contains healthy backend servers.", "es": "Asocie el oyente con un grupo de servidores que contenga servidores backend saludables.", "fr": "Associez l'écouteur à un groupe de serveurs contenant des serveurs backend sains.", "ja": "リスナーを正常なバックエンドサーバーを含むサーバーグループに関連付けます。", "pt": "Associe o ouvinte a um grupo de servidores que contenha servidores backend saudáveis.", "zh": "将监听关联到包含健康后端服务器的服务器组。"}, ResourceTypes: []string{"ALIYUN::ALB::Listener"}, FilePath: "aliyun/rules/alb-all-listenter-has-server.rego", PackageName: "infraguard.rules.aliyun.alb_all_listenter_has_server", Content: "package infraguard.rules.aliyun.alb_all_listenter_has_server\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"alb-all-listenter-has-server\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ALB Listener Has Backend Server\",\n\t\t\"zh\": \"ALB 监听绑定后端服务器\",\n\t\t\"ja\": \"ALB リスナーにバックエンドサーバーがある\",\n\t\t\"de\": \"ALB-Listener hat Backend-Server\",\n\t\t\"es\": \"El Oyente ALB Tiene Servidor Backend\",\n\t\t\"fr\": \"L'Écouteur ALB a un Serveur Backend\",\n\t\t\"pt\": \"O Ouvinte ALB Tem Servidor Backend\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures all ALB listeners are associated with a non-empty server group.\",\n\t\t\"zh\": \"确保所有 ALB 监听均关联了非空的服务器组。\",\n\t\t\"ja\": \"すべての ALB リスナーが空でないサーバーグループに関連付けられていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass alle ALB-Listener einer nicht leeren Servergruppe zugeordnet sind.\",\n\t\t\"es\": \"Garantiza que todos los oyentes ALB estén asociados con un grupo de servidores no vacío.\",\n\t\t\"fr\": \"Garantit que tous les écouteurs ALB sont associés à un groupe de serveurs non vide.\",\n\t\t\"pt\": \"Garante que todos os ouvintes ALB estejam associados a um grupo de servidores não vazio.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"A listener without backend servers cannot handle any traffic, leading to service unavailability.\",\n\t\t\"zh\": \"未绑定后端服务器的监听无法处理任何流量，会导致服务不可用。\",\n\t\t\"ja\": \"バックエンドサーバーがないリスナーはトラフィックを処理できず、サービスが利用できなくなります。\",\n\t\t\"de\": \"Ein Listener ohne Backend-Server kann keinen Datenverkehr verarbeiten, was zu Dienstunverfügbarkeit führt.\",\n\t\t\"es\": \"Un oyente sin servidores backend no puede manejar ningún tráfico, lo que lleva a la indisponibilidad del servicio.\",\n\t\t\"fr\": \"Un écouteur sans serveurs backend ne peut gérer aucun trafic, ce qui entraîne l'indisponibilité du service.\",\n\t\t\"pt\": \"Um ouvinte sem servidores backend não pode lidar com nenhum tráfego, levando à indisponibilidade do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Associate the listener with a server group that contains healthy backend servers.\",\n\t\t\"zh\": \"将监听关联到包含健康后端服务器的服务器组。\",\n\t\t\"ja\": \"リスナーを正常なバックエンドサーバーを含むサーバーグループに関連付けます。\",\n\t\t\"de\": \"Ordnen Sie den Listener einer Servergruppe zu, die gesunde Backend-Server enthält.\",\n\t\t\"es\": \"Asocie el oyente con un grupo de servidores que contenga servidores backend saludables.\",\n\t\t\"fr\": \"Associez l'écouteur à un groupe de serveurs contenant des serveurs backend sains.\",\n\t\t\"pt\": \"Associe o ouvinte a um grupo de servidores que contenha servidores backend saudáveis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::Listener\"]\n}\n\nis_compliant(resource) if {\n\t# Check if DefaultActions contains ForwardGroup with ServerGroupTuples\n\tdefault_actions := helpers.get_property(resource, \"DefaultActions\", [])\n\tsome action in default_actions\n\taction.Type == \"ForwardGroup\"\n\tforward_group_config := action.ForwardGroupConfig\n\tserver_group_tuples := forward_group_config.ServerGroupTuples\n\tcount(server_group_tuples) > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DefaultActions\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-delete-protection-enabled", Name: models.I18nString{"de": "ALB-Instanz Löschschutz aktiviert", "en": "ALB Instance Deletion Protection Enabled", "es": "Protección de Eliminación de Instancia ALB Habilitada", "fr": "Protection contre la Suppression d'Instance ALB Activée", "ja": "ALB インスタンス削除保護が有効", "pt": "Proteção contra Exclusão de Instância ALB Habilitada", "zh": "ALB 实例开启释放保护"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass ALB-Instanzen Löschschutz aktiviert haben.", "en": "Ensures that ALB instances have deletion protection enabled.", "es": "Garantiza que las instancias ALB tengan protección contra eliminación habilitada.", "fr": "Garantit que les instances ALB ont la protection contre la suppression activée.", "ja": "ALB インスタンスで削除保護が有効になっていることを確認します。", "pt": "Garante que as instâncias ALB tenham proteção contra exclusão habilitada.", "zh": "确保 ALB 实例开启了释放保护。"}, Reason: models.I18nString{"de": "Wenn der Löschschutz nicht aktiviert ist, kann die ALB-Instanz versehentlich freigegeben werden, was zu Dienstunterbrechungen führt.", "en": "If deletion protection is not enabled, the ALB instance may be released accidentally, causing service interruption.", "es": "Si la protección contra eliminación no está habilitada, la instancia ALB puede ser liberada accidentalmente, causando interrupción del servicio.", "fr": "Si la protection contre la suppression n'est pas activée, l'instance ALB peut être libérée accidentellement, entraînant une interruption de service.", "ja": "削除保護が有効になっていない場合、ALB インスタンスが誤って解放され、サービス中断が発生する可能性があります。", "pt": "Se a proteção contra exclusão não estiver habilitada, a instância ALB pode ser liberada acidentalmente, causando interrupção do serviço.", "zh": "如果未开启释放保护，ALB 实例可能会被意外释放，导致业务中断。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für die ALB-Instanz.", "en": "Enable deletion protection for the ALB instance.", "es": "Habilite la protección contra eliminación para la instancia ALB.", "fr": "Activez la protection contre la suppression pour l'instance ALB.", "ja": "ALB インスタンスの削除保護を有効にします。", "pt": "Habilite a proteção contra exclusão para a instância ALB.", "zh": "为 ALB 实例开启释放保护功能。"}, ResourceTypes: []string{"ALIYUN::ALB::LoadBalancer"}, FilePath: "aliyun/rules/alb-delete-protection-enabled.rego", PackageName: "infraguard.rules.aliyun.alb_delete_protection_enabled", Content: "package infraguard.rules.aliyun.alb_delete_protection_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"alb-delete-protection-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ALB Instance Deletion Protection Enabled\",\n\t\t\"zh\": \"ALB 实例开启释放保护\",\n\t\t\"ja\": \"ALB インスタンス削除保護が有効\",\n\t\t\"de\": \"ALB-Instanz Löschschutz aktiviert\",\n\t\t\"es\": \"Protección de Eliminación de Instancia ALB Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression d'Instance ALB Activée\",\n\t\t\"pt\": \"Proteção contra Exclusão de Instância ALB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ALB instances have deletion protection enabled.\",\n\t\t\"zh\": \"确保 ALB 实例开启了释放保护。\",\n\t\t\"ja\": \"ALB インスタンスで削除保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ALB-Instanzen Löschschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias ALB tengan protección contra eliminación habilitada.\",\n\t\t\"fr\": \"Garantit que les instances ALB ont la protection contre la suppression activée.\",\n\t\t\"pt\": \"Garante que as instâncias ALB tenham proteção contra exclusão habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If deletion protection is not enabled, the ALB instance may be released accidentally, causing service interruption.\",\n\t\t\"zh\": \"如果未开启释放保护，ALB 实例可能会被意外释放，导致业务中断。\",\n\t\t\"ja\": \"削除保護が有効になっていない場合、ALB インスタンスが誤って解放され、サービス中断が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Löschschutz nicht aktiviert ist, kann die ALB-Instanz versehentlich freigegeben werden, was zu Dienstunterbrechungen führt.\",\n\t\t\"es\": \"Si la protección contra eliminación no está habilitada, la instancia ALB puede ser liberada accidentalmente, causando interrupción del servicio.\",\n\t\t\"fr\": \"Si la protection contre la suppression n'est pas activée, l'instance ALB peut être libérée accidentellement, entraînant une interruption de service.\",\n\t\t\"pt\": \"Se a proteção contra exclusão não estiver habilitada, a instância ALB pode ser liberada acidentalmente, causando interrupção do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for the ALB instance.\",\n\t\t\"zh\": \"为 ALB 实例开启释放保护功能。\",\n\t\t\"ja\": \"ALB インスタンスの削除保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für die ALB-Instanz.\",\n\t\t\"es\": \"Habilite la protección contra eliminación para la instancia ALB.\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour l'instance ALB.\",\n\t\t\"pt\": \"Habilite a proteção contra exclusão para a instância ALB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::LoadBalancer\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtectionEnabled\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::LoadBalancer\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtectionEnabled\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-instance-bind-security-group-or-enabled-acl", Name: models.I18nString{"de": "ALB-Instanz Sicherheitsgruppe binden oder ACL aktivieren", "en": "ALB Instance Bind Security Group or Enable ACL", "es": "Instancia ALB Vincular Grupo de Seguridad o Habilitar ACL", "fr": "Instance ALB Lier Groupe de Sécurité ou Activer ACL", "ja": "ALB インスタンスセキュリティグループのバインドまたは ACL の有効化", "pt": "Instância ALB Vincular Grupo de Segurança ou Habilitar ACL", "zh": "ALB 实例关联安全组或者为所有监听设置访问控制"}, Severity: "medium", Description: models.I18nString{"de": "ALB-Instanz sollte Sicherheitsgruppen zugeordnet haben oder ACL für alle laufenden Listener konfiguriert haben.", "en": "ALB instance should have security groups associated or ACL configured for all running listeners.", "es": "La instancia ALB debe tener grupos de seguridad asociados o ACL configurado para todos los oyentes en ejecución.", "fr": "L'instance ALB doit avoir des groupes de sécurité associés ou ACL configuré pour tous les écouteurs en cours d'exécution.", "ja": "ALB インスタンスは、セキュリティグループが関連付けられているか、すべての実行中のリスナーに ACL が設定されている必要があります。", "pt": "A instância ALB deve ter grupos de segurança associados ou ACL configurado para todos os ouvintes em execução.", "zh": "ALB 实例关联了安全组或者为所有运行中的监听都设置了访问控制，视为合规。不存在运行中监听的实例不适用本规则，视为不适用。"}, Reason: models.I18nString{"de": "ALB-Instanz hat keine Sicherheitsgruppen zugeordnet, was den Load Balancer Sicherheitsrisiken aussetzen kann.", "en": "ALB instance does not have security groups associated, which may expose the load balancer to security risks.", "es": "La instancia ALB no tiene grupos de seguridad asociados, lo que puede exponer el equilibrador de carga a riesgos de seguridad.", "fr": "L'instance ALB n'a pas de groupes de sécurité associés, ce qui peut exposer l'équilibreur de charge à des risques de sécurité.", "ja": "ALB インスタンスにセキュリティグループが関連付けられていないため、ロードバランサーがセキュリティリスクにさらされる可能性があります。", "pt": "A instância ALB não tem grupos de segurança associados, o que pode expor o balanceador de carga a riscos de segurança.", "zh": "ALB 实例未关联安全组，可能导致负载均衡器面临安全风险。"}, Recommendation: models.I18nString{"de": "Ordnen Sie Sicherheitsgruppen der ALB-Instanz zu, indem Sie die Eigenschaft SecurityGroupIds konfigurieren, oder richten Sie ACL für alle Listener ein.", "en": "Associate security groups with the ALB instance by configuring SecurityGroupIds property, or set up ACL for all listeners.", "es": "Asocie grupos de seguridad con la instancia ALB configurando la propiedad SecurityGroupIds, o configure ACL para todos los oyentes.", "fr": "Associez des groupes de sécurité à l'instance ALB en configurant la propriété SecurityGroupIds, ou configurez ACL pour tous les écouteurs.", "ja": "SecurityGroupIds プロパティを設定して ALB インスタンスにセキュリティグループを関連付けるか、すべてのリスナーに ACL を設定します。", "pt": "Associe grupos de segurança à instância ALB configurando a propriedade SecurityGroupIds, ou configure ACL para todos os ouvintes.", "zh": "通过配置 SecurityGroupIds 属性为 ALB 实例关联安全组，或为所有监听器设置访问控制列表(ACL)。"}, ResourceTypes: []string{"ALIYUN::ALB::LoadBalancer"}, FilePath: "aliyun/rules/alb-instance-bind-security-group-or-enabled-acl.rego", PackageName: "infraguard.rules.aliyun.alb_instance_bind_security_group_or_enabled_acl", Content: "package infraguard.rules.aliyun.alb_instance_bind_security_group_or_enabled_acl\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"alb-instance-bind-security-group-or-enabled-acl\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ALB Instance Bind Security Group or Enable ACL\",\n\t\t\"zh\": \"ALB 实例关联安全组或者为所有监听设置访问控制\",\n\t\t\"ja\": \"ALB インスタンスセキュリティグループのバインドまたは ACL の有効化\",\n\t\t\"de\": \"ALB-Instanz Sicherheitsgruppe binden oder ACL aktivieren\",\n\t\t\"es\": \"Instancia ALB Vincular Grupo de Seguridad o Habilitar ACL\",\n\t\t\"fr\": \"Instance ALB Lier Groupe de Sécurité ou Activer ACL\",\n\t\t\"pt\": \"Instância ALB Vincular Grupo de Segurança ou Habilitar ACL\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ALB instance should have security groups associated or ACL configured for all running listeners.\",\n\t\t\"zh\": \"ALB 实例关联了安全组或者为所有运行中的监听都设置了访问控制，视为合规。不存在运行中监听的实例不适用本规则，视为不适用。\",\n\t\t\"ja\": \"ALB インスタンスは、セキュリティグループが関連付けられているか、すべての実行中のリスナーに ACL が設定されている必要があります。\",\n\t\t\"de\": \"ALB-Instanz sollte Sicherheitsgruppen zugeordnet haben oder ACL für alle laufenden Listener konfiguriert haben.\",\n\t\t\"es\": \"La instancia ALB debe tener grupos de seguridad asociados o ACL configurado para todos los oyentes en ejecución.\",\n\t\t\"fr\": \"L'instance ALB doit avoir des groupes de sécurité associés ou ACL configuré pour tous les écouteurs en cours d'exécution.\",\n\t\t\"pt\": \"A instância ALB deve ter grupos de segurança associados ou ACL configurado para todos os ouvintes em execução.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ALB instance does not have security groups associated, which may expose the load balancer to security risks.\",\n\t\t\"zh\": \"ALB 实例未关联安全组，可能导致负载均衡器面临安全风险。\",\n\t\t\"ja\": \"ALB インスタンスにセキュリティグループが関連付けられていないため、ロードバランサーがセキュリティリスクにさらされる可能性があります。\",\n\t\t\"de\": \"ALB-Instanz hat keine Sicherheitsgruppen zugeordnet, was den Load Balancer Sicherheitsrisiken aussetzen kann.\",\n\t\t\"es\": \"La instancia ALB no tiene grupos de seguridad asociados, lo que puede exponer el equilibrador de carga a riesgos de seguridad.\",\n\t\t\"fr\": \"L'instance ALB n'a pas de groupes de sécurité associés, ce qui peut exposer l'équilibreur de charge à des risques de sécurité.\",\n\t\t\"pt\": \"A instância ALB não tem grupos de segurança associados, o que pode expor o balanceador de carga a riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Associate security groups with the ALB instance by configuring SecurityGroupIds property, or set up ACL for all listeners.\",\n\t\t\"zh\": \"通过配置 SecurityGroupIds 属性为 ALB 实例关联安全组，或为所有监听器设置访问控制列表(ACL)。\",\n\t\t\"ja\": \"SecurityGroupIds プロパティを設定して ALB インスタンスにセキュリティグループを関連付けるか、すべてのリスナーに ACL を設定します。\",\n\t\t\"de\": \"Ordnen Sie Sicherheitsgruppen der ALB-Instanz zu, indem Sie die Eigenschaft SecurityGroupIds konfigurieren, oder richten Sie ACL für alle Listener ein.\",\n\t\t\"es\": \"Asocie grupos de seguridad con la instancia ALB configurando la propiedad SecurityGroupIds, o configure ACL para todos los oyentes.\",\n\t\t\"fr\": \"Associez des groupes de sécurité à l'instance ALB en configurant la propriété SecurityGroupIds, ou configurez ACL pour tous les écouteurs.\",\n\t\t\"pt\": \"Associe grupos de segurança à instância ALB configurando a propriedade SecurityGroupIds, ou configure ACL para todos os ouvintes.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::LoadBalancer\"]\n}\n\n# Check if security groups are configured\nhas_security_groups(resource) if {\n\tcount(resource.Properties.SecurityGroupIds) > 0\n}\n\n# Generate deny for non-compliant resources\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::LoadBalancer\")\n\tnot has_security_groups(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-instance-multi-zone", Name: models.I18nString{"de": "ALB-Instanz Multi-Zone-Bereitstellung", "en": "ALB Instance Multi-Zone Deployment", "es": "Despliegue Multi-zona de Instancia ALB", "fr": "Déploiement Multi-Zones de l'Instance ALB", "ja": "ALB インスタンスのマルチゾーン展開", "pt": "Implantação Multi-zona da Instância ALB", "zh": "使用多可用区的 ALB 实例"}, Severity: "high", Description: models.I18nString{"de": "ALB-Instanzen sollten für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen bereitgestellt werden. Wenn nur eine Zone ausgewählt wird, wirkt sich ein Zonenausfall auf die ALB-Instanz und die Geschäftsstabilität aus.", "en": "ALB instances should be deployed across multiple availability zones for high availability. If only one zone is selected, a zone failure will affect the ALB instance and business stability.", "es": "Las instancias ALB deben implementarse en múltiples zonas de disponibilidad para alta disponibilidad. Si solo se selecciona una zona, una falla en la zona afectará la instancia ALB y la estabilidad del negocio.", "fr": "Les instances ALB doivent être déployées sur plusieurs zones de disponibilité pour une haute disponibilité. Si une seule zone est sélectionnée, une panne de zone affectera l'instance ALB et la stabilité de l'entreprise.", "ja": "高可用性のために、ALB インスタンスは複数の可用性ゾーンに展開する必要があります。1 つのゾーンのみを選択した場合、ゾーンの障害が ALB インスタンスとビジネスの安定性に影響します。", "pt": "Instâncias ALB devem ser implantadas em múltiplas zonas de disponibilidade para alta disponibilidade. Se apenas uma zona for selecionada, uma falha na zona afetará a instância ALB e a estabilidade do negócio.", "zh": "ALB 实例为多可用区实例，视为合规。如果只选择了一个可用区，当这个可用区出现故障时，会影响 ALB 实例，进而影响业务稳定性。"}, Reason: models.I18nString{"de": "Die ALB-Instanz ist nur in einer Verfügbarkeitszone bereitgestellt, was einen Single Point of Failure schafft.", "en": "The ALB instance is deployed in only one availability zone, which creates a single point of failure.", "es": "La instancia ALB está implementada en solo una zona de disponibilidad, lo que crea un punto único de falla.", "fr": "L'instance ALB est déployée dans une seule zone de disponibilité, ce qui crée un point de défaillance unique.", "ja": "ALB インスタンスが 1 つの可用性ゾーンにのみ展開されているため、単一障害点が発生します。", "pt": "A instância ALB está implantada em apenas uma zona de disponibilidade, criando um ponto único de falha.", "zh": "ALB 实例仅部署在一个可用区，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die ALB-Instanz so, dass sie mindestens zwei Verfügbarkeitszonen verwendet, indem Sie mehrere Zonen-Zuordnungen in der ZoneMappings-Eigenschaft hinzufügen.", "en": "Configure the ALB instance to use at least two availability zones by adding multiple zone mappings in the ZoneMappings property.", "es": "Configure la instancia ALB para usar al menos dos zonas de disponibilidad agregando múltiples mapeos de zona en la propiedad ZoneMappings.", "fr": "Configurez l'instance ALB pour utiliser au moins deux zones de disponibilité en ajoutant plusieurs mappages de zone dans la propriété ZoneMappings.", "ja": "ZoneMappings プロパティに複数のゾーンマッピングを追加して、ALB インスタンスを少なくとも 2 つの可用性ゾーンを使用するように設定します。", "pt": "Configure a instância ALB para usar pelo menos duas zonas de disponibilidade adicionando múltiplos mapeamentos de zona na propriedade ZoneMappings.", "zh": "通过在 ZoneMappings 属性中添加多个可用区映射，将 ALB 实例配置为使用至少两个可用区。"}, ResourceTypes: []string{"ALIYUN::ALB::LoadBalancer"}, FilePath: "aliyun/rules/alb-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.alb_instance_multi_zone", Content: "package infraguard.rules.aliyun.alb_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"alb-instance-multi-zone\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ALB Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的 ALB 实例\",\n\t\t\"ja\": \"ALB インスタンスのマルチゾーン展開\",\n\t\t\"de\": \"ALB-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-zona de Instancia ALB\",\n\t\t\"fr\": \"Déploiement Multi-Zones de l'Instance ALB\",\n\t\t\"pt\": \"Implantação Multi-zona da Instância ALB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ALB instances should be deployed across multiple availability zones for high availability. If only one zone is selected, a zone failure will affect the ALB instance and business stability.\",\n\t\t\"zh\": \"ALB 实例为多可用区实例，视为合规。如果只选择了一个可用区，当这个可用区出现故障时，会影响 ALB 实例，进而影响业务稳定性。\",\n\t\t\"ja\": \"高可用性のために、ALB インスタンスは複数の可用性ゾーンに展開する必要があります。1 つのゾーンのみを選択した場合、ゾーンの障害が ALB インスタンスとビジネスの安定性に影響します。\",\n\t\t\"de\": \"ALB-Instanzen sollten für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen bereitgestellt werden. Wenn nur eine Zone ausgewählt wird, wirkt sich ein Zonenausfall auf die ALB-Instanz und die Geschäftsstabilität aus.\",\n\t\t\"es\": \"Las instancias ALB deben implementarse en múltiples zonas de disponibilidad para alta disponibilidad. Si solo se selecciona una zona, una falla en la zona afectará la instancia ALB y la estabilidad del negocio.\",\n\t\t\"fr\": \"Les instances ALB doivent être déployées sur plusieurs zones de disponibilité pour une haute disponibilité. Si une seule zone est sélectionnée, une panne de zone affectera l'instance ALB et la stabilité de l'entreprise.\",\n\t\t\"pt\": \"Instâncias ALB devem ser implantadas em múltiplas zonas de disponibilidade para alta disponibilidade. Se apenas uma zona for selecionada, uma falha na zona afetará a instância ALB e a estabilidade do negócio.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ALB instance is deployed in only one availability zone, which creates a single point of failure.\",\n\t\t\"zh\": \"ALB 实例仅部署在一个可用区，存在单点故障风险。\",\n\t\t\"ja\": \"ALB インスタンスが 1 つの可用性ゾーンにのみ展開されているため、単一障害点が発生します。\",\n\t\t\"de\": \"Die ALB-Instanz ist nur in einer Verfügbarkeitszone bereitgestellt, was einen Single Point of Failure schafft.\",\n\t\t\"es\": \"La instancia ALB está implementada en solo una zona de disponibilidad, lo que crea un punto único de falla.\",\n\t\t\"fr\": \"L'instance ALB est déployée dans une seule zone de disponibilité, ce qui crée un point de défaillance unique.\",\n\t\t\"pt\": \"A instância ALB está implantada em apenas uma zona de disponibilidade, criando um ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the ALB instance to use at least two availability zones by adding multiple zone mappings in the ZoneMappings property.\",\n\t\t\"zh\": \"通过在 ZoneMappings 属性中添加多个可用区映射，将 ALB 实例配置为使用至少两个可用区。\",\n\t\t\"ja\": \"ZoneMappings プロパティに複数のゾーンマッピングを追加して、ALB インスタンスを少なくとも 2 つの可用性ゾーンを使用するように設定します。\",\n\t\t\"de\": \"Konfigurieren Sie die ALB-Instanz so, dass sie mindestens zwei Verfügbarkeitszonen verwendet, indem Sie mehrere Zonen-Zuordnungen in der ZoneMappings-Eigenschaft hinzufügen.\",\n\t\t\"es\": \"Configure la instancia ALB para usar al menos dos zonas de disponibilidad agregando múltiples mapeos de zona en la propiedad ZoneMappings.\",\n\t\t\"fr\": \"Configurez l'instance ALB pour utiliser au moins deux zones de disponibilité en ajoutant plusieurs mappages de zone dans la propriété ZoneMappings.\",\n\t\t\"pt\": \"Configure a instância ALB para usar pelo menos duas zonas de disponibilidade adicionando múltiplos mapeamentos de zona na propriedade ZoneMappings.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::LoadBalancer\"]\n}\n\n# Check if ALB is multi-zone\nis_multi_zone(resource) if {\n\tcount(object.get(resource.Properties, \"ZoneMappings\", [])) >= 2\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::LoadBalancer\")\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ZoneMappings\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-instance-waf-enabled", Name: models.I18nString{"de": "ALB-Instanz hat WAF-Schutz", "en": "ALB Instance Has WAF Protection", "es": "La Instancia ALB Tiene Protección WAF", "fr": "L'Instance ALB a une Protection WAF", "ja": "ALB インスタンスに WAF 保護がある", "pt": "A Instância ALB Tem Proteção WAF", "zh": "ALB 实例开启 WEB 应用防火墙防护"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass ALB-Instanzen WAF3 (Web Application Firewall) Schutz aktiviert haben.", "en": "Ensures that ALB instances have WAF3 (Web Application Firewall) protection enabled.", "es": "Garantiza que las instancias ALB tengan protección WAF3 (Web Application Firewall) habilitada.", "fr": "Garantit que les instances ALB ont la protection WAF3 (Web Application Firewall) activée.", "ja": "ALB インスタンスで WAF3（Web アプリケーションファイアウォール）保護が有効になっていることを確認します。", "pt": "Garante que as instâncias ALB tenham proteção WAF3 (Web Application Firewall) habilitada.", "zh": "确保 ALB 实例已启用 WAF3（Web 应用防火墙）防护。"}, Reason: models.I18nString{"de": "WAF-Schutz hilft, vor häufigen Web-Schwachstellen und Angriffen zu schützen.", "en": "WAF protection helps protect against common web vulnerabilities and attacks.", "es": "La protección WAF ayuda a protegerse contra vulnerabilidades y ataques web comunes.", "fr": "La protection WAF aide à se protéger contre les vulnérabilités et attaques Web courantes.", "ja": "WAF 保護は、一般的な Web の脆弱性や攻撃から保護するのに役立ちます。", "pt": "A proteção WAF ajuda a proteger contra vulnerabilidades e ataques web comuns.", "zh": "WAF 防护有助于防范常见的 Web 漏洞和攻击。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie WAF3-Schutz für die ALB-Instanz.", "en": "Enable WAF3 protection for the ALB instance.", "es": "Habilite la protección WAF3 para la instancia ALB.", "fr": "Activez la protection WAF3 pour l'instance ALB.", "ja": "ALB インスタンスの WAF3 保護を有効にします。", "pt": "Habilite a proteção WAF3 para a instância ALB.", "zh": "为 ALB 实例启用 WAF3 防护。"}, ResourceTypes: []string{"ALIYUN::ALB::LoadBalancer"}, FilePath: "aliyun/rules/alb-instance-waf-enabled.rego", PackageName: "infraguard.rules.aliyun.alb_instance_waf_enabled", Content: "package infraguard.rules.aliyun.alb_instance_waf_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"alb-instance-waf-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ALB Instance Has WAF Protection\",\n\t\t\"zh\": \"ALB 实例开启 WEB 应用防火墙防护\",\n\t\t\"ja\": \"ALB インスタンスに WAF 保護がある\",\n\t\t\"de\": \"ALB-Instanz hat WAF-Schutz\",\n\t\t\"es\": \"La Instancia ALB Tiene Protección WAF\",\n\t\t\"fr\": \"L'Instance ALB a une Protection WAF\",\n\t\t\"pt\": \"A Instância ALB Tem Proteção WAF\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ALB instances have WAF3 (Web Application Firewall) protection enabled.\",\n\t\t\"zh\": \"确保 ALB 实例已启用 WAF3（Web 应用防火墙）防护。\",\n\t\t\"ja\": \"ALB インスタンスで WAF3（Web アプリケーションファイアウォール）保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ALB-Instanzen WAF3 (Web Application Firewall) Schutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias ALB tengan protección WAF3 (Web Application Firewall) habilitada.\",\n\t\t\"fr\": \"Garantit que les instances ALB ont la protection WAF3 (Web Application Firewall) activée.\",\n\t\t\"pt\": \"Garante que as instâncias ALB tenham proteção WAF3 (Web Application Firewall) habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"WAF protection helps protect against common web vulnerabilities and attacks.\",\n\t\t\"zh\": \"WAF 防护有助于防范常见的 Web 漏洞和攻击。\",\n\t\t\"ja\": \"WAF 保護は、一般的な Web の脆弱性や攻撃から保護するのに役立ちます。\",\n\t\t\"de\": \"WAF-Schutz hilft, vor häufigen Web-Schwachstellen und Angriffen zu schützen.\",\n\t\t\"es\": \"La protección WAF ayuda a protegerse contra vulnerabilidades y ataques web comunes.\",\n\t\t\"fr\": \"La protection WAF aide à se protéger contre les vulnérabilités et attaques Web courantes.\",\n\t\t\"pt\": \"A proteção WAF ajuda a proteger contra vulnerabilidades e ataques web comuns.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable WAF3 protection for the ALB instance.\",\n\t\t\"zh\": \"为 ALB 实例启用 WAF3 防护。\",\n\t\t\"ja\": \"ALB インスタンスの WAF3 保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie WAF3-Schutz für die ALB-Instanz.\",\n\t\t\"es\": \"Habilite la protección WAF3 para la instancia ALB.\",\n\t\t\"fr\": \"Activez la protection WAF3 pour l'instance ALB.\",\n\t\t\"pt\": \"Habilite a proteção WAF3 para a instância ALB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::LoadBalancer\"]\n}\n\n# Check if WAF protection is enabled via LoadBalancerEdition\nis_compliant(resource) if {\n\tedition := helpers.get_property(resource, \"LoadBalancerEdition\", \"\")\n\tedition == \"StandardWithWaf\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::LoadBalancer\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"WafEnabled\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-server-group-multi-server", Name: models.I18nString{"de": "ALB-Servergruppe hat mehrere Server", "en": "ALB Server Group Has Multiple Servers", "es": "El Grupo de Servidores ALB Tiene Múltiples Servidores", "fr": "Le Groupe de Serveurs ALB a Plusieurs Serveurs", "ja": "ALB サーバーグループに複数のサーバーがある", "pt": "O Grupo de Servidores ALB Tem Múltiplos Servidores", "zh": "ALB 服务器组包含至少两台服务器"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass ALB-Servergruppen mindestens zwei Backend-Server für Hochverfügbarkeit enthalten.", "en": "Ensures that ALB server groups contain at least two backend servers for high availability.", "es": "Garantiza que los grupos de servidores ALB contengan al menos dos servidores backend para alta disponibilidad.", "fr": "Garantit que les groupes de serveurs ALB contiennent au moins deux serveurs backend pour une haute disponibilité.", "ja": "ALB サーバーグループに高可用性のために少なくとも 2 つのバックエンドサーバーが含まれていることを確認します。", "pt": "Garante que os grupos de servidores ALB contenham pelo menos dois servidores backend para alta disponibilidade.", "zh": "确保 ALB 服务器组包含至少两台后端服务器以实现高可用性。"}, Reason: models.I18nString{"de": "Servergruppen mit nur einem Server schaffen einen Single Point of Failure.", "en": "Server groups with only one server create a single point of failure.", "es": "Los grupos de servidores con solo un servidor crean un punto único de falla.", "fr": "Les groupes de serveurs avec un seul serveur créent un point de défaillance unique.", "ja": "サーバーが 1 つだけのサーバーグループは単一障害点を作成します。", "pt": "Grupos de servidores com apenas um servidor criam um ponto único de falha.", "zh": "只有一台服务器的服务器组存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Fügen Sie mindestens zwei Backend-Server zur Servergruppe hinzu, indem Sie ALIYUN::ALB::BackendServerAttachment-Ressourcen verwenden.", "en": "Add at least two backend servers to the server group using ALIYUN::ALB::BackendServerAttachment resources.", "es": "Agregue al menos dos servidores backend al grupo de servidores usando recursos ALIYUN::ALB::BackendServerAttachment.", "fr": "Ajoutez au moins deux serveurs backend au groupe de serveurs en utilisant les ressources ALIYUN::ALB::BackendServerAttachment.", "ja": "ALIYUN::ALB::BackendServerAttachment リソースを使用して、サーバーグループに少なくとも 2 つのバックエンドサーバーを追加します。", "pt": "Adicione pelo menos dois servidores backend ao grupo de servidores usando recursos ALIYUN::ALB::BackendServerAttachment.", "zh": "使用 ALIYUN::ALB::BackendServerAttachment 资源，向服务器组添加至少两台后端服务器。"}, ResourceTypes: []string{"ALIYUN::ALB::ServerGroup"}, FilePath: "aliyun/rules/alb-server-group-multi-server.rego", PackageName: "infraguard.rules.aliyun.alb_server_group_multi_server", Content: "package infraguard.rules.aliyun.alb_server_group_multi_server\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"alb-server-group-multi-server\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ALB Server Group Has Multiple Servers\",\n\t\t\"zh\": \"ALB 服务器组包含至少两台服务器\",\n\t\t\"ja\": \"ALB サーバーグループに複数のサーバーがある\",\n\t\t\"de\": \"ALB-Servergruppe hat mehrere Server\",\n\t\t\"es\": \"El Grupo de Servidores ALB Tiene Múltiples Servidores\",\n\t\t\"fr\": \"Le Groupe de Serveurs ALB a Plusieurs Serveurs\",\n\t\t\"pt\": \"O Grupo de Servidores ALB Tem Múltiplos Servidores\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ALB server groups contain at least two backend servers for high availability.\",\n\t\t\"zh\": \"确保 ALB 服务器组包含至少两台后端服务器以实现高可用性。\",\n\t\t\"ja\": \"ALB サーバーグループに高可用性のために少なくとも 2 つのバックエンドサーバーが含まれていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ALB-Servergruppen mindestens zwei Backend-Server für Hochverfügbarkeit enthalten.\",\n\t\t\"es\": \"Garantiza que los grupos de servidores ALB contengan al menos dos servidores backend para alta disponibilidad.\",\n\t\t\"fr\": \"Garantit que les groupes de serveurs ALB contiennent au moins deux serveurs backend pour une haute disponibilité.\",\n\t\t\"pt\": \"Garante que os grupos de servidores ALB contenham pelo menos dois servidores backend para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Server groups with only one server create a single point of failure.\",\n\t\t\"zh\": \"只有一台服务器的服务器组存在单点故障风险。\",\n\t\t\"ja\": \"サーバーが 1 つだけのサーバーグループは単一障害点を作成します。\",\n\t\t\"de\": \"Servergruppen mit nur einem Server schaffen einen Single Point of Failure.\",\n\t\t\"es\": \"Los grupos de servidores con solo un servidor crean un punto único de falla.\",\n\t\t\"fr\": \"Les groupes de serveurs avec un seul serveur créent un point de défaillance unique.\",\n\t\t\"pt\": \"Grupos de servidores com apenas um servidor criam um ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add at least two backend servers to the server group using ALIYUN::ALB::BackendServerAttachment resources.\",\n\t\t\"zh\": \"使用 ALIYUN::ALB::BackendServerAttachment 资源，向服务器组添加至少两台后端服务器。\",\n\t\t\"ja\": \"ALIYUN::ALB::BackendServerAttachment リソースを使用して、サーバーグループに少なくとも 2 つのバックエンドサーバーを追加します。\",\n\t\t\"de\": \"Fügen Sie mindestens zwei Backend-Server zur Servergruppe hinzu, indem Sie ALIYUN::ALB::BackendServerAttachment-Ressourcen verwenden.\",\n\t\t\"es\": \"Agregue al menos dos servidores backend al grupo de servidores usando recursos ALIYUN::ALB::BackendServerAttachment.\",\n\t\t\"fr\": \"Ajoutez au moins deux serveurs backend au groupe de serveurs en utilisant les ressources ALIYUN::ALB::BackendServerAttachment.\",\n\t\t\"pt\": \"Adicione pelo menos dois servidores backend ao grupo de servidores usando recursos ALIYUN::ALB::BackendServerAttachment.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::ServerGroup\"]\n}\n\n# Check if server group type is Instance (not IP or Function Compute)\nis_applicable_type(resource) if {\n\tserver_group_type := helpers.get_property(resource, \"ServerGroupType\", \"Instance\")\n\tserver_group_type == \"Instance\"\n}\n\n# Get server group ID from reference or direct value\nget_server_group_id(value) := value if {\n\tis_string(value)\n}\n\nget_server_group_id(value) := ref_val if {\n\tis_object(value)\n\tref_val := value.Ref\n}\n\n# Check if attachment belongs to this server group\nattachment_belongs_to_group(attachment, server_group_id) if {\n\tgroup_id := get_server_group_id(attachment.Properties.ServerGroupId)\n\tgroup_id == server_group_id\n}\n\n# Count servers attached to a server group\nget_server_count(server_group_id) := server_count if {\n\tattachments := [attachment |\n\t\tsome _, attachment in helpers.resources_by_type(\"ALIYUN::ALB::BackendServerAttachment\")\n\t\tattachment_belongs_to_group(attachment, server_group_id)\n\t]\n\n\tservers := [server |\n\t\tsome attachment in attachments\n\t\tsome server in attachment.Properties.Servers\n\t]\n\n\tserver_count := count(servers)\n}\n\n# Check if server group has at least 2 servers\nhas_min_servers(server_group_id) if {\n\tserver_count := get_server_count(server_group_id)\n\tserver_count >= 2\n}\n\nis_compliant(name, resource) if {\n\tis_applicable_type(resource)\n\thas_min_servers(name)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::ServerGroup\")\n\n\t# Only check Instance type server groups\n\tis_applicable_type(resource)\n\n\tnot is_compliant(name, resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alb-server-group-multi-zone", Name: models.I18nString{"de": "ALB-Servergruppe Multi-Zone-Verteilung", "en": "ALB Server Group Multi-Zone Distribution", "es": "Distribución Multi-Zona del Grupo de Servidores ALB", "fr": "Distribution Multi-Zone du Groupe de Serveurs ALB", "ja": "ALB サーバーグループマルチゾーン分散", "pt": "Distribuição Multi-Zona do Grupo de Servidores ALB", "zh": "ALB 负载均衡服务器组添加多个可用区资源"}, Severity: "medium", Description: models.I18nString{"de": "ALB-Servergruppen sollten Backend-Server über mehrere Verfügbarkeitszonen verteilt haben, um Hochverfügbarkeit zu gewährleisten. Diese Regel gilt nicht für Servergruppen ohne angehängte Server oder für IP/Function Compute-Typ-Servergruppen.", "en": "ALB server groups should have backend servers distributed across multiple availability zones for high availability. This rule does not apply to server groups with no attached servers, or to IP/Function Compute type server groups.", "es": "Los grupos de servidores ALB deben tener servidores backend distribuidos en múltiples zonas de disponibilidad para alta disponibilidad. Esta regla no se aplica a grupos de servidores sin servidores adjuntos, ni a grupos de servidores de tipo IP/Function Compute.", "fr": "Les groupes de serveurs ALB doivent avoir des serveurs backend distribués sur plusieurs zones de disponibilité pour une haute disponibilité. Cette règle ne s'applique pas aux groupes de serveurs sans serveurs attachés, ni aux groupes de serveurs de type IP/Function Compute.", "ja": "ALB サーバーグループは、高可用性のために複数の可用性ゾーンに分散されたバックエンドサーバーを持つ必要があります。このルールは、アタッチされたサーバーがないサーバーグループ、または IP/Function Compute タイプのサーバーグループには適用されません。", "pt": "Os grupos de servidores ALB devem ter servidores backend distribuídos em múltiplas zonas de disponibilidade para alta disponibilidade. Esta regra não se aplica a grupos de servidores sem servidores anexados, nem a grupos de servidores do tipo IP/Function Compute.", "zh": "ALB 负载均衡的服务器组挂载资源分布在多个可用区，视为合规。ALB 服务器组无挂载任何资源时不适用本规则，视为不适用。IP 或者函数计算类型的服务器组视为不适用。"}, Reason: models.I18nString{"de": "Die ALB-Servergruppe hat Backend-Server nur in einer Verfügbarkeitszone, was einen Single Point of Failure schafft.", "en": "The ALB server group has backend servers in only one availability zone, creating a single point of failure.", "es": "El grupo de servidores ALB tiene servidores backend en solo una zona de disponibilidad, creando un punto único de falla.", "fr": "Le groupe de serveurs ALB a des serveurs backend dans une seule zone de disponibilité, créant un point de défaillance unique.", "ja": "ALB サーバーグループのバックエンドサーバーが 1 つの可用性ゾーンにのみ存在し、単一障害点が発生しています。", "pt": "O grupo de servidores ALB tem servidores backend em apenas uma zona de disponibilidade, criando um ponto único de falha.", "zh": "ALB 服务器组的后端服务器仅分布在一个可用区，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Fügen Sie Backend-Server aus mindestens zwei verschiedenen Verfügbarkeitszonen zur Servergruppe hinzu, indem Sie ALIYUN::ALB::BackendServerAttachment-Ressourcen verwenden.", "en": "Add backend servers from at least two different availability zones to the server group using ALIYUN::ALB::BackendServerAttachment resources.", "es": "Agregue servidores backend de al menos dos zonas de disponibilidad diferentes al grupo de servidores usando recursos ALIYUN::ALB::BackendServerAttachment.", "fr": "Ajoutez des serveurs backend d'au moins deux zones de disponibilité différentes au groupe de serveurs en utilisant les ressources ALIYUN::ALB::BackendServerAttachment.", "ja": "ALIYUN::ALB::BackendServerAttachment リソースを使用して、少なくとも 2 つの異なる可用性ゾーンからバックエンドサーバーをサーバーグループに追加します。", "pt": "Adicione servidores backend de pelo menos duas zonas de disponibilidade diferentes ao grupo de servidores usando recursos ALIYUN::ALB::BackendServerAttachment.", "zh": "使用 ALIYUN::ALB::BackendServerAttachment 资源，向服务器组添加来自至少两个不同可用区的后端服务器。"}, ResourceTypes: []string{"ALIYUN::ALB::ServerGroup"}, FilePath: "aliyun/rules/alb-server-group-multi-zone.rego", PackageName: "infraguard.rules.aliyun.alb_server_group_multi_zone", Content: "package infraguard.rules.aliyun.alb_server_group_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"alb-server-group-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ALB Server Group Multi-Zone Distribution\",\n\t\t\"zh\": \"ALB 负载均衡服务器组添加多个可用区资源\",\n\t\t\"ja\": \"ALB サーバーグループマルチゾーン分散\",\n\t\t\"de\": \"ALB-Servergruppe Multi-Zone-Verteilung\",\n\t\t\"es\": \"Distribución Multi-Zona del Grupo de Servidores ALB\",\n\t\t\"fr\": \"Distribution Multi-Zone du Groupe de Serveurs ALB\",\n\t\t\"pt\": \"Distribuição Multi-Zona do Grupo de Servidores ALB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ALB server groups should have backend servers distributed across multiple availability zones for high availability. This rule does not apply to server groups with no attached servers, or to IP/Function Compute type server groups.\",\n\t\t\"zh\": \"ALB 负载均衡的服务器组挂载资源分布在多个可用区，视为合规。ALB 服务器组无挂载任何资源时不适用本规则，视为不适用。IP 或者函数计算类型的服务器组视为不适用。\",\n\t\t\"ja\": \"ALB サーバーグループは、高可用性のために複数の可用性ゾーンに分散されたバックエンドサーバーを持つ必要があります。このルールは、アタッチされたサーバーがないサーバーグループ、または IP/Function Compute タイプのサーバーグループには適用されません。\",\n\t\t\"de\": \"ALB-Servergruppen sollten Backend-Server über mehrere Verfügbarkeitszonen verteilt haben, um Hochverfügbarkeit zu gewährleisten. Diese Regel gilt nicht für Servergruppen ohne angehängte Server oder für IP/Function Compute-Typ-Servergruppen.\",\n\t\t\"es\": \"Los grupos de servidores ALB deben tener servidores backend distribuidos en múltiples zonas de disponibilidad para alta disponibilidad. Esta regla no se aplica a grupos de servidores sin servidores adjuntos, ni a grupos de servidores de tipo IP/Function Compute.\",\n\t\t\"fr\": \"Les groupes de serveurs ALB doivent avoir des serveurs backend distribués sur plusieurs zones de disponibilité pour une haute disponibilité. Cette règle ne s'applique pas aux groupes de serveurs sans serveurs attachés, ni aux groupes de serveurs de type IP/Function Compute.\",\n\t\t\"pt\": \"Os grupos de servidores ALB devem ter servidores backend distribuídos em múltiplas zonas de disponibilidade para alta disponibilidade. Esta regra não se aplica a grupos de servidores sem servidores anexados, nem a grupos de servidores do tipo IP/Function Compute.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ALB server group has backend servers in only one availability zone, creating a single point of failure.\",\n\t\t\"zh\": \"ALB 服务器组的后端服务器仅分布在一个可用区，存在单点故障风险。\",\n\t\t\"ja\": \"ALB サーバーグループのバックエンドサーバーが 1 つの可用性ゾーンにのみ存在し、単一障害点が発生しています。\",\n\t\t\"de\": \"Die ALB-Servergruppe hat Backend-Server nur in einer Verfügbarkeitszone, was einen Single Point of Failure schafft.\",\n\t\t\"es\": \"El grupo de servidores ALB tiene servidores backend en solo una zona de disponibilidad, creando un punto único de falla.\",\n\t\t\"fr\": \"Le groupe de serveurs ALB a des serveurs backend dans une seule zone de disponibilité, créant un point de défaillance unique.\",\n\t\t\"pt\": \"O grupo de servidores ALB tem servidores backend em apenas uma zona de disponibilidade, criando um ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add backend servers from at least two different availability zones to the server group using ALIYUN::ALB::BackendServerAttachment resources.\",\n\t\t\"zh\": \"使用 ALIYUN::ALB::BackendServerAttachment 资源，向服务器组添加来自至少两个不同可用区的后端服务器。\",\n\t\t\"ja\": \"ALIYUN::ALB::BackendServerAttachment リソースを使用して、少なくとも 2 つの異なる可用性ゾーンからバックエンドサーバーをサーバーグループに追加します。\",\n\t\t\"de\": \"Fügen Sie Backend-Server aus mindestens zwei verschiedenen Verfügbarkeitszonen zur Servergruppe hinzu, indem Sie ALIYUN::ALB::BackendServerAttachment-Ressourcen verwenden.\",\n\t\t\"es\": \"Agregue servidores backend de al menos dos zonas de disponibilidad diferentes al grupo de servidores usando recursos ALIYUN::ALB::BackendServerAttachment.\",\n\t\t\"fr\": \"Ajoutez des serveurs backend d'au moins deux zones de disponibilité différentes au groupe de serveurs en utilisant les ressources ALIYUN::ALB::BackendServerAttachment.\",\n\t\t\"pt\": \"Adicione servidores backend de pelo menos duas zonas de disponibilidade diferentes ao grupo de servidores usando recursos ALIYUN::ALB::BackendServerAttachment.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::ServerGroup\"]\n}\n\n# Check if server group type is applicable (not IP or Fc)\nis_applicable_type(resource) if {\n\tserver_group_type := helpers.get_property(resource, \"ServerGroupType\", \"Instance\")\n\tserver_group_type == \"Instance\"\n}\n\n# Get server group ID from reference or direct value\nget_server_group_id(value) := value if {\n\tis_string(value)\n}\n\nget_server_group_id(value) := value.Ref if {\n\tis_object(value)\n\tvalue.Ref\n}\n\n# Get server ID from reference or direct value\nget_server_id(value) := value if {\n\tis_string(value)\n}\n\nget_server_id(value) := value.Ref if {\n\tis_object(value)\n\tvalue.Ref\n}\n\n# Check if attachment belongs to this server group\nattachment_belongs_to_group(attachment, server_group_id) if {\n\tgroup_id := get_server_group_id(attachment.Properties.ServerGroupId)\n\tgroup_id == server_group_id\n}\n\n# Get all zones from backend servers for a server group\nzones_for_server_group(server_group_id) := zones if {\n\t# Find all attachments for this server group\n\tattachments := [attachment |\n\t\tsome _, attachment in helpers.resources_by_type(\"ALIYUN::ALB::BackendServerAttachment\")\n\t\tattachment_belongs_to_group(attachment, server_group_id)\n\t]\n\n\t# Get all zones from servers in these attachments\n\tzones := {zone |\n\t\tsome attachment in attachments\n\t\tsome server in attachment.Properties.Servers\n\t\tserver_id := get_server_id(server.ServerId)\n\n\t\t# Look up the server resource\n\t\tsome name, resource in input.Resources\n\t\tname == server_id\n\t\tresource.Type in {\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"}\n\t\tzone := resource.Properties.ZoneId\n\t}\n}\n\n# Check if server group has attachments\nhas_attachments(server_group_id) if {\n\tsome _, attachment in helpers.resources_by_type(\"ALIYUN::ALB::BackendServerAttachment\")\n\tattachment_belongs_to_group(attachment, server_group_id)\n}\n\n# Check if servers are distributed across multiple zones\nis_multi_zone_distributed(server_group_id) if {\n\tzones := zones_for_server_group(server_group_id)\n\tcount(zones) >= 2\n}\n\n# Deny rule: ALB server groups must have servers in multiple zones\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ALB::ServerGroup\")\n\n\t# Only check Instance type server groups\n\tis_applicable_type(resource)\n\n\t# Only check if there are attachments\n\thas_attachments(name)\n\n\t# Check if not multi-zone\n\tnot is_multi_zone_distributed(name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alidns-domain-regex-match", Name: models.I18nString{"de": "Alibaba Cloud DNS-Domänennamen entsprechen Namenskonvention", "en": "Alibaba Cloud DNS Domain Names Match Naming Convention", "es": "Los Nombres de Dominio DNS de Alibaba Cloud Coinciden con la Convención de Nomenclatura", "fr": "Les Noms de Domaine DNS d'Alibaba Cloud Correspondent à la Convention de Dénomination", "ja": "Alibaba Cloud DNS ドメイン名が命名規則に一致", "pt": "Os Nomes de Domínio DNS da Alibaba Cloud Correspondem à Convenção de Nomenclatura", "zh": "阿里云解析域名符合命名规范"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Alibaba Cloud DNS-Domänennamen dem angegebenen Namenskonventions-Regex entsprechen.", "en": "Ensures that Alibaba Cloud DNS domain names match the specified naming convention regex.", "es": "Garantiza que los nombres de dominio DNS de Alibaba Cloud coincidan con la expresión regular de convención de nomenclatura especificada.", "fr": "Garantit que les noms de domaine DNS d'Alibaba Cloud correspondent à l'expression régulière de convention de dénomination spécifiée.", "ja": "Alibaba Cloud DNS ドメイン名が指定された命名規則の正規表現に一致していることを確認します。", "pt": "Garante que os nomes de domínio DNS da Alibaba Cloud correspondam à expressão regular de convenção de nomenclatura especificada.", "zh": "域名符合参数指定的命名规范正则，视为合规。"}, Reason: models.I18nString{"de": "Domänenname entspricht nicht dem angegebenen Namenskonventions-Regex.", "en": "Domain name does not match the specified naming convention regex.", "es": "El nombre de dominio no coincide con la expresión regular de convención de nomenclatura especificada.", "fr": "Le nom de domaine ne correspond pas à l'expression régulière de convention de dénomination spécifiée.", "ja": "ドメイン名が指定された命名規則の正規表現に一致していません。", "pt": "O nome de domínio não corresponde à expressão regular de convenção de nomenclatura especificada.", "zh": "域名不符合参数指定的命名规范正则。"}, Recommendation: models.I18nString{"de": "Benennen Sie die Domäne um, damit sie der angegebenen Namenskonvention entspricht.", "en": "Rename the domain to match the specified naming convention.", "es": "Renombre el dominio para que coincida con la convención de nomenclatura especificada.", "fr": "Renommez le domaine pour qu'il corresponde à la convention de dénomination spécifiée.", "ja": "指定された命名規則に一致するようにドメイン名を変更します。", "pt": "Renomeie o domínio para corresponder à convenção de nomenclatura especificada.", "zh": "请修改域名以符合指定的命名规范。"}, ResourceTypes: []string{"ALIYUN::DNS::Domain"}, FilePath: "aliyun/rules/alidns-domain-regex-match.rego", PackageName: "infraguard.rules.aliyun.alidns_domain_regex_match", Content: "package infraguard.rules.aliyun.alidns_domain_regex_match\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"alidns-domain-regex-match\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Alibaba Cloud DNS Domain Names Match Naming Convention\",\n\t\t\"zh\": \"阿里云解析域名符合命名规范\",\n\t\t\"ja\": \"Alibaba Cloud DNS ドメイン名が命名規則に一致\",\n\t\t\"de\": \"Alibaba Cloud DNS-Domänennamen entsprechen Namenskonvention\",\n\t\t\"es\": \"Los Nombres de Dominio DNS de Alibaba Cloud Coinciden con la Convención de Nomenclatura\",\n\t\t\"fr\": \"Les Noms de Domaine DNS d'Alibaba Cloud Correspondent à la Convention de Dénomination\",\n\t\t\"pt\": \"Os Nomes de Domínio DNS da Alibaba Cloud Correspondem à Convenção de Nomenclatura\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Alibaba Cloud DNS domain names match the specified naming convention regex.\",\n\t\t\"zh\": \"域名符合参数指定的命名规范正则，视为合规。\",\n\t\t\"ja\": \"Alibaba Cloud DNS ドメイン名が指定された命名規則の正規表現に一致していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Alibaba Cloud DNS-Domänennamen dem angegebenen Namenskonventions-Regex entsprechen.\",\n\t\t\"es\": \"Garantiza que los nombres de dominio DNS de Alibaba Cloud coincidan con la expresión regular de convención de nomenclatura especificada.\",\n\t\t\"fr\": \"Garantit que les noms de domaine DNS d'Alibaba Cloud correspondent à l'expression régulière de convention de dénomination spécifiée.\",\n\t\t\"pt\": \"Garante que os nomes de domínio DNS da Alibaba Cloud correspondam à expressão regular de convenção de nomenclatura especificada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Domain name does not match the specified naming convention regex.\",\n\t\t\"zh\": \"域名不符合参数指定的命名规范正则。\",\n\t\t\"ja\": \"ドメイン名が指定された命名規則の正規表現に一致していません。\",\n\t\t\"de\": \"Domänenname entspricht nicht dem angegebenen Namenskonventions-Regex.\",\n\t\t\"es\": \"El nombre de dominio no coincide con la expresión regular de convención de nomenclatura especificada.\",\n\t\t\"fr\": \"Le nom de domaine ne correspond pas à l'expression régulière de convention de dénomination spécifiée.\",\n\t\t\"pt\": \"O nome de domínio não corresponde à expressão regular de convenção de nomenclatura especificada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Rename the domain to match the specified naming convention.\",\n\t\t\"zh\": \"请修改域名以符合指定的命名规范。\",\n\t\t\"ja\": \"指定された命名規則に一致するようにドメイン名を変更します。\",\n\t\t\"de\": \"Benennen Sie die Domäne um, damit sie der angegebenen Namenskonvention entspricht.\",\n\t\t\"es\": \"Renombre el dominio para que coincida con la convención de nomenclatura especificada.\",\n\t\t\"fr\": \"Renommez le domaine pour qu'il corresponde à la convention de dénomination spécifiée.\",\n\t\t\"pt\": \"Renomeie o domínio para corresponder à convenção de nomenclatura especificada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::DNS::Domain\"]\n}\n\n# Default regex pattern for domain names\ndefault_regex_pattern := \"^[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]$\"\n\n# Get regex pattern from parameters or use default\nget_regex_pattern := input.rule_parameters.domain_name_regex_pattern if {\n\tinput.rule_parameters.domain_name_regex_pattern != \"\"\n} else := default_regex_pattern\n\n# Check if domain name matches the regex pattern\ndomain_name_matches_regex(domain_name, pattern) if {\n\tregex.match(pattern, domain_name)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::DNS::Domain\")\n\n\tdomain_name := resource.Properties.DomainName\n\tpattern := get_regex_pattern\n\n\tnot domain_name_matches_regex(domain_name, pattern)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DomainName\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:alidns-route-53-mx-check", Name: models.I18nString{"de": "DNS MX-Eintrag hat gültiges SPF in zugehörigem TXT-Eintrag", "en": "DNS MX Record Has Valid SPF in Associated TXT Record", "es": "Registro MX de DNS Tiene SPF Válido en Registro TXT Asociado", "fr": "L'Enregistrement MX DNS a un SPF Valide dans l'Enregistrement TXT Associé", "ja": "DNS MX レコードに関連付けられた TXT レコードに有効な SPF がある", "pt": "Registro MX DNS Tem SPF Válido no Registro TXT Associado", "zh": "DNS 域名 MX 记录关联的 TXT 记录包含有效的 SPF 值"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MX-Einträge zugehörige TXT-Einträge mit gültigen SPF-Werten für die E-Mail-Validierung haben.", "en": "Ensures that MX records have associated TXT records with valid SPF values for email validation.", "es": "Garantiza que los registros MX tengan registros TXT asociados con valores SPF válidos para validación de correo electrónico.", "fr": "Garantit que les enregistrements MX ont des enregistrements TXT associés avec des valeurs SPF valides pour la validation des e-mails.", "ja": "MX レコードに、メール検証用の有効な SPF 値を持つ関連 TXT レコードがあることを確認します。", "pt": "Garante que os registros MX tenham registros TXT associados com valores SPF válidos para validação de e-mail.", "zh": "对于每个 MX 记录，检查关联的 TXT 记录是否包含有效的 SPF 值,只要 MX 记录有至少一个具有有效 SPF 值的关联 TXT 记录，则视为合规。"}, Reason: models.I18nString{"de": "MX-Einträge ohne gültige SPF-Konfiguration können anfällig für E-Mail-Spoofing sein.", "en": "MX records without valid SPF configuration may be vulnerable to email spoofing.", "es": "Los registros MX sin configuración SPF válida pueden ser vulnerables a suplantación de correo electrónico.", "fr": "Les enregistrements MX sans configuration SPF valide peuvent être vulnérables à l'usurpation d'e-mail.", "ja": "有効な SPF 設定がない MX レコードは、メールスプーフィングに対して脆弱である可能性があります。", "pt": "Registros MX sem configuração SPF válida podem ser vulneráveis à falsificação de e-mail.", "zh": "MX 记录未配置有效的 SPF 值，可能导致邮件伪造风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie TXT-Einträge mit gültigen SPF-Werten für jeden MX-Eintrag.", "en": "Configure TXT records with valid SPF values for each MX record.", "es": "Configure registros TXT con valores SPF válidos para cada registro MX.", "fr": "Configurez les enregistrements TXT avec des valeurs SPF valides pour chaque enregistrement MX.", "ja": "各 MX レコードに対して有効な SPF 値を持つ TXT レコードを設定します。", "pt": "Configure registros TXT com valores SPF válidos para cada registro MX.", "zh": "为每个 MX 记录配置包含有效 SPF 值的 TXT 记录。"}, ResourceTypes: []string{"ALIYUN::DNS::DomainRecord"}, FilePath: "aliyun/rules/alidns-route-53-mx-check.rego", PackageName: "infraguard.rules.aliyun.alidns_route_53_mx_check", Content: "package infraguard.rules.aliyun.alidns_route_53_mx_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"alidns-route-53-mx-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"DNS MX Record Has Valid SPF in Associated TXT Record\",\n\t\t\"zh\": \"DNS 域名 MX 记录关联的 TXT 记录包含有效的 SPF 值\",\n\t\t\"ja\": \"DNS MX レコードに関連付けられた TXT レコードに有効な SPF がある\",\n\t\t\"de\": \"DNS MX-Eintrag hat gültiges SPF in zugehörigem TXT-Eintrag\",\n\t\t\"es\": \"Registro MX de DNS Tiene SPF Válido en Registro TXT Asociado\",\n\t\t\"fr\": \"L'Enregistrement MX DNS a un SPF Valide dans l'Enregistrement TXT Associé\",\n\t\t\"pt\": \"Registro MX DNS Tem SPF Válido no Registro TXT Associado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that MX records have associated TXT records with valid SPF values for email validation.\",\n\t\t\"zh\": \"对于每个 MX 记录，检查关联的 TXT 记录是否包含有效的 SPF 值,只要 MX 记录有至少一个具有有效 SPF 值的关联 TXT 记录，则视为合规。\",\n\t\t\"ja\": \"MX レコードに、メール検証用の有効な SPF 値を持つ関連 TXT レコードがあることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MX-Einträge zugehörige TXT-Einträge mit gültigen SPF-Werten für die E-Mail-Validierung haben.\",\n\t\t\"es\": \"Garantiza que los registros MX tengan registros TXT asociados con valores SPF válidos para validación de correo electrónico.\",\n\t\t\"fr\": \"Garantit que les enregistrements MX ont des enregistrements TXT associés avec des valeurs SPF valides pour la validation des e-mails.\",\n\t\t\"pt\": \"Garante que os registros MX tenham registros TXT associados com valores SPF válidos para validação de e-mail.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"MX records without valid SPF configuration may be vulnerable to email spoofing.\",\n\t\t\"zh\": \"MX 记录未配置有效的 SPF 值，可能导致邮件伪造风险。\",\n\t\t\"ja\": \"有効な SPF 設定がない MX レコードは、メールスプーフィングに対して脆弱である可能性があります。\",\n\t\t\"de\": \"MX-Einträge ohne gültige SPF-Konfiguration können anfällig für E-Mail-Spoofing sein.\",\n\t\t\"es\": \"Los registros MX sin configuración SPF válida pueden ser vulnerables a suplantación de correo electrónico.\",\n\t\t\"fr\": \"Les enregistrements MX sans configuration SPF valide peuvent être vulnérables à l'usurpation d'e-mail.\",\n\t\t\"pt\": \"Registros MX sem configuração SPF válida podem ser vulneráveis à falsificação de e-mail.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure TXT records with valid SPF values for each MX record.\",\n\t\t\"zh\": \"为每个 MX 记录配置包含有效 SPF 值的 TXT 记录。\",\n\t\t\"ja\": \"各 MX レコードに対して有効な SPF 値を持つ TXT レコードを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie TXT-Einträge mit gültigen SPF-Werten für jeden MX-Eintrag.\",\n\t\t\"es\": \"Configure registros TXT con valores SPF válidos para cada registro MX.\",\n\t\t\"fr\": \"Configurez les enregistrements TXT avec des valeurs SPF valides pour chaque enregistrement MX.\",\n\t\t\"pt\": \"Configure registros TXT com valores SPF válidos para cada registro MX.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::DNS::DomainRecord\"]\n}\n\n# Check if a TXT record contains a valid SPF record\nhas_valid_spf(txt_record) if {\n\tvalue := txt_record.Value\n\tstartswith(value, \"v=spf1\")\n}\n\n# Check if an MX record has an associated TXT record with valid SPF\n# Valid SPF means TXT record starts with \"v=spf1\" and contains meaningful mechanisms\nmx_has_valid_spf(mx_props, txt_records) if {\n\tmx_host := mx_props.Value\n\n\tsome txt_record in txt_records\n\ttxt_value := txt_record.Properties.Value\n\thas_valid_spf({\"Value\": txt_value})\n\n\t# TXT record should contain the mx host or include mechanism\n\tcontains(txt_value, mx_host)\n}\n\nmx_has_valid_spf(mx_props, txt_records) if {\n\tsome txt_record in txt_records\n\ttxt_value := txt_record.Properties.Value\n\thas_valid_spf({\"Value\": txt_value})\n\n\t# TXT record should contain the include mechanism\n\tcontains(txt_value, \"include:\")\n}\n\n# Get all MX records for a domain\nget_mx_records(domain_name) := [record |\n\tsome name, record in helpers.resources_by_type(\"ALIYUN::DNS::DomainRecord\")\n\trecord.Properties.Type == \"MX\"\n\trecord.Properties.DomainName == domain_name\n]\n\n# Get all TXT records for a domain\nget_txt_records(domain_name) := [record |\n\tsome name, record in helpers.resources_by_type(\"ALIYUN::DNS::DomainRecord\")\n\trecord.Properties.Type == \"TXT\"\n\trecord.Properties.DomainName == domain_name\n]\n\ndeny contains result if {\n\tsome name, domain_resource in helpers.resources_by_type(\"ALIYUN::DNS::Domain\")\n\tdomain_name := domain_resource.Properties.DomainName\n\n\tmx_records := get_mx_records(domain_name)\n\ttxt_records := get_txt_records(domain_name)\n\n\t# Find MX records that don't have valid SPF TXT records\n\tsome mx_record in mx_records\n\tmx_record.Properties.Type == \"MX\"\n\tnot mx_has_valid_spf(mx_record.Properties, txt_records)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": domain_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-api-auth-jwt", Name: models.I18nString{"de": "API Gateway API-Authentifizierung JWT", "en": "API Gateway API Auth JWT", "es": "Autenticación JWT de API de API Gateway", "fr": "Authentification JWT de l'API API Gateway", "ja": "API ゲートウェイ API 認証 JWT", "pt": "Autenticação JWT da API do API Gateway", "zh": "API 网关中 API 安全认证设置为 JWT 方式"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass API Gateway APIs JWT-Authentifizierung verwenden.", "en": "Ensures API Gateway APIs use JWT authentication.", "es": "Garantiza que las APIs de API Gateway usen autenticación JWT.", "fr": "Garantit que les API API Gateway utilisent l'authentification JWT.", "ja": "API ゲートウェイ API が JWT 認証を使用することを確認します。", "pt": "Garante que as APIs do API Gateway usem autenticação JWT.", "zh": "确保 API 网关中的 API 安全认证为 JWT 方式。"}, Reason: models.I18nString{"de": "JWT bietet sichere Authentifizierung für API-Zugriff.", "en": "JWT provides secure authentication for API access.", "es": "JWT proporciona autenticación segura para el acceso a la API.", "fr": "JWT fournit une authentification sécurisée pour l'accès à l'API.", "ja": "JWT は API アクセスに安全な認証を提供します。", "pt": "JWT fornece autenticação segura para acesso à API.", "zh": "JWT 为 API 访问提供安全的认证机制。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie JWT-Authentifizierung für APIs.", "en": "Configure JWT authentication for APIs.", "es": "Configure la autenticación JWT para las APIs.", "fr": "Configurez l'authentification JWT pour les API.", "ja": "API の JWT 認証を設定します。", "pt": "Configure a autenticação JWT para as APIs.", "zh": "为 API 配置 JWT 认证。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Api"}, FilePath: "aliyun/rules/api-gateway-api-auth-jwt.rego", PackageName: "infraguard.rules.aliyun.api_gateway_api_auth_jwt", Content: "package infraguard.rules.aliyun.api_gateway_api_auth_jwt\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"api-gateway-api-auth-jwt\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway API Auth JWT\",\n\t\t\"zh\": \"API 网关中 API 安全认证设置为 JWT 方式\",\n\t\t\"ja\": \"API ゲートウェイ API 認証 JWT\",\n\t\t\"de\": \"API Gateway API-Authentifizierung JWT\",\n\t\t\"es\": \"Autenticación JWT de API de API Gateway\",\n\t\t\"fr\": \"Authentification JWT de l'API API Gateway\",\n\t\t\"pt\": \"Autenticação JWT da API do API Gateway\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures API Gateway APIs use JWT authentication.\",\n\t\t\"zh\": \"确保 API 网关中的 API 安全认证为 JWT 方式。\",\n\t\t\"ja\": \"API ゲートウェイ API が JWT 認証を使用することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API Gateway APIs JWT-Authentifizierung verwenden.\",\n\t\t\"es\": \"Garantiza que las APIs de API Gateway usen autenticación JWT.\",\n\t\t\"fr\": \"Garantit que les API API Gateway utilisent l'authentification JWT.\",\n\t\t\"pt\": \"Garante que as APIs do API Gateway usem autenticação JWT.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"JWT provides secure authentication for API access.\",\n\t\t\"zh\": \"JWT 为 API 访问提供安全的认证机制。\",\n\t\t\"ja\": \"JWT は API アクセスに安全な認証を提供します。\",\n\t\t\"de\": \"JWT bietet sichere Authentifizierung für API-Zugriff.\",\n\t\t\"es\": \"JWT proporciona autenticación segura para el acceso a la API.\",\n\t\t\"fr\": \"JWT fournit une authentification sécurisée pour l'accès à l'API.\",\n\t\t\"pt\": \"JWT fornece autenticação segura para acesso à API.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure JWT authentication for APIs.\",\n\t\t\"zh\": \"为 API 配置 JWT 认证。\",\n\t\t\"ja\": \"API の JWT 認証を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie JWT-Authentifizierung für APIs.\",\n\t\t\"es\": \"Configure la autenticación JWT para las APIs.\",\n\t\t\"fr\": \"Configurez l'authentification JWT pour les API.\",\n\t\t\"pt\": \"Configure a autenticação JWT para as APIs.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Api\"]\n}\n\ndeny contains result if {\n\tsome api_name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Api\")\n\tauth_type := helpers.get_property(resource, \"AuthType\", \"\")\n\n\tnot auth_type == \"APPOPENID\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": api_name,\n\t\t\"violation_path\": [\"Properties\", \"AuthType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome api_name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Api\")\n\tauth_type := helpers.get_property(resource, \"AuthType\", \"\")\n\n\tauth_type == \"APPOPENID\"\n\n\topen_id_config := helpers.get_property(resource, \"OpenIdConnectConfig\", {})\n\topen_id_api_type := object.get(open_id_config, \"OpenIdApiType\", \"\")\n\n\tnot open_id_api_type == \"IDTOKEN\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": api_name,\n\t\t\"violation_path\": [\"Properties\", \"OpenIdConnectConfig\", \"OpenIdApiType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-api-auth-required", Name: models.I18nString{"de": "API Gateway API-Authentifizierung erforderlich", "en": "API Gateway API Auth Required", "es": "Autenticación de API del Gateway de API Requerida", "fr": "Authentification API du Gateway API Requise", "ja": "API ゲートウェイ API 認証が必要", "pt": "Autenticação de API do Gateway de API Obrigatória", "zh": "API 网关中配置 API 安全认证"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass API Gateway APIs Authentifizierung konfiguriert haben.", "en": "Ensures API Gateway APIs have authentication configured.", "es": "Garantiza que las APIs del Gateway de API tengan autenticación configurada.", "fr": "Garantit que les APIs du Gateway API ont l'authentification configurée.", "ja": "API ゲートウェイ API に認証が設定されていることを確認します。", "pt": "Garante que as APIs do Gateway de API tenham autenticação configurada.", "zh": "确保 API 网关中配置 API 安全认证为阿里云 APP 或使用指定的插件类型。"}, Reason: models.I18nString{"de": "Authentifizierung verhindert unbefugten Zugriff auf APIs.", "en": "Authentication prevents unauthorized access to APIs.", "es": "La autenticación previene el acceso no autorizado a las APIs.", "fr": "L'authentification empêche l'accès non autorisé aux APIs.", "ja": "認証により、API への不正アクセスを防ぎます。", "pt": "A autenticação impede acesso não autorizado às APIs.", "zh": "认证可防止未授权访问 API。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Authentifizierung für alle APIs.", "en": "Enable authentication for all APIs.", "es": "Habilite autenticación para todas las APIs.", "fr": "Activez l'authentification pour toutes les APIs.", "ja": "すべての API で認証を有効にします。", "pt": "Habilite autenticação para todas as APIs.", "zh": "为所有 API 启用认证。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Api"}, FilePath: "aliyun/rules/api-gateway-api-auth-required.rego", PackageName: "infraguard.rules.aliyun.api_gateway_api_auth_required", Content: "package infraguard.rules.aliyun.api_gateway_api_auth_required\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"api-gateway-api-auth-required\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway API Auth Required\",\n\t\t\"zh\": \"API 网关中配置 API 安全认证\",\n\t\t\"ja\": \"API ゲートウェイ API 認証が必要\",\n\t\t\"de\": \"API Gateway API-Authentifizierung erforderlich\",\n\t\t\"es\": \"Autenticación de API del Gateway de API Requerida\",\n\t\t\"fr\": \"Authentification API du Gateway API Requise\",\n\t\t\"pt\": \"Autenticação de API do Gateway de API Obrigatória\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures API Gateway APIs have authentication configured.\",\n\t\t\"zh\": \"确保 API 网关中配置 API 安全认证为阿里云 APP 或使用指定的插件类型。\",\n\t\t\"ja\": \"API ゲートウェイ API に認証が設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API Gateway APIs Authentifizierung konfiguriert haben.\",\n\t\t\"es\": \"Garantiza que las APIs del Gateway de API tengan autenticación configurada.\",\n\t\t\"fr\": \"Garantit que les APIs du Gateway API ont l'authentification configurée.\",\n\t\t\"pt\": \"Garante que as APIs do Gateway de API tenham autenticação configurada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Authentication prevents unauthorized access to APIs.\",\n\t\t\"zh\": \"认证可防止未授权访问 API。\",\n\t\t\"ja\": \"認証により、API への不正アクセスを防ぎます。\",\n\t\t\"de\": \"Authentifizierung verhindert unbefugten Zugriff auf APIs.\",\n\t\t\"es\": \"La autenticación previene el acceso no autorizado a las APIs.\",\n\t\t\"fr\": \"L'authentification empêche l'accès non autorisé aux APIs.\",\n\t\t\"pt\": \"A autenticação impede acesso não autorizado às APIs.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable authentication for all APIs.\",\n\t\t\"zh\": \"为所有 API 启用认证。\",\n\t\t\"ja\": \"すべての API で認証を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Authentifizierung für alle APIs.\",\n\t\t\"es\": \"Habilite autenticación para todas las APIs.\",\n\t\t\"fr\": \"Activez l'authentification pour toutes les APIs.\",\n\t\t\"pt\": \"Habilite autenticação para todas as APIs.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Api\"]\n}\n\ndeny contains result if {\n\tsome api_name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Api\")\n\tauth_type := helpers.get_property(resource, \"AuthType\", \"\")\n\n\tauth_type == \"ANONYMOUS\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": api_name,\n\t\t\"violation_path\": [\"Properties\", \"AuthType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-api-internet-request-https", Name: models.I18nString{"de": "API Gateway Internet-Anfrage HTTPS aktiviert", "en": "API Gateway Internet Request HTTPS Enabled", "es": "HTTPS de Solicitud de Internet del Gateway de API Habilitado", "fr": "HTTPS de Requête Internet du Gateway API Activé", "ja": "API ゲートウェイのインターネットリクエストで HTTPS が有効", "pt": "HTTPS de Solicitação de Internet do Gateway de API Habilitado", "zh": "API 网关公网请求开启 HTTPS"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass API Gateway APIs, die dem Internet ausgesetzt sind, das HTTPS-Protokoll verwenden.", "en": "Ensures that API Gateway APIs exposed to the internet use HTTPS protocol.", "es": "Garantiza que las APIs del Gateway de API expuestas a internet usen el protocolo HTTPS.", "fr": "Garantit que les APIs du Gateway API exposées à Internet utilisent le protocole HTTPS.", "ja": "インターネットに公開された API ゲートウェイ API が HTTPS プロトコルを使用していることを確認します。", "pt": "Garante que as APIs do Gateway de API expostas à internet usem o protocolo HTTPS.", "zh": "确保暴露给公网的 API 网关 API 使用 HTTPS 协议。"}, Reason: models.I18nString{"de": "HTTPS gewährleistet Datenvertraulichkeit und Integrität während der Übertragung über das Internet.", "en": "HTTPS ensures data confidentiality and integrity during transmission over the internet.", "es": "HTTPS garantiza la confidencialidad e integridad de los datos durante la transmisión por internet.", "fr": "HTTPS assure la confidentialité et l'intégrité des données pendant la transmission sur Internet.", "ja": "HTTPS により、インターネット経由での送信中にデータの機密性と整合性が確保されます。", "pt": "O HTTPS garante confidencialidade e integridade dos dados durante a transmissão pela internet.", "zh": "HTTPS 可确保在公网传输期间数据的机密性和完整性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die API Gateway API so, dass HTTPS für Internet-Anfragen erforderlich ist.", "en": "Configure the API Gateway API to require HTTPS for internet requests.", "es": "Configure la API del Gateway de API para requerir HTTPS para solicitudes de internet.", "fr": "Configurez l'API du Gateway API pour exiger HTTPS pour les requêtes Internet.", "ja": "API ゲートウェイ API を設定して、インターネットリクエストに HTTPS を要求します。", "pt": "Configure a API do Gateway de API para exigir HTTPS para solicitações de internet.", "zh": "配置 API 网关 API，要求公网请求使用 HTTPS。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Api"}, FilePath: "aliyun/rules/api-gateway-api-internet-request-https.rego", PackageName: "infraguard.rules.aliyun.api_gateway_api_internet_request_https", Content: "package infraguard.rules.aliyun.api_gateway_api_internet_request_https\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"api-gateway-api-internet-request-https\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway Internet Request HTTPS Enabled\",\n\t\t\"zh\": \"API 网关公网请求开启 HTTPS\",\n\t\t\"ja\": \"API ゲートウェイのインターネットリクエストで HTTPS が有効\",\n\t\t\"de\": \"API Gateway Internet-Anfrage HTTPS aktiviert\",\n\t\t\"es\": \"HTTPS de Solicitud de Internet del Gateway de API Habilitado\",\n\t\t\"fr\": \"HTTPS de Requête Internet du Gateway API Activé\",\n\t\t\"pt\": \"HTTPS de Solicitação de Internet do Gateway de API Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that API Gateway APIs exposed to the internet use HTTPS protocol.\",\n\t\t\"zh\": \"确保暴露给公网的 API 网关 API 使用 HTTPS 协议。\",\n\t\t\"ja\": \"インターネットに公開された API ゲートウェイ API が HTTPS プロトコルを使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API Gateway APIs, die dem Internet ausgesetzt sind, das HTTPS-Protokoll verwenden.\",\n\t\t\"es\": \"Garantiza que las APIs del Gateway de API expuestas a internet usen el protocolo HTTPS.\",\n\t\t\"fr\": \"Garantit que les APIs du Gateway API exposées à Internet utilisent le protocole HTTPS.\",\n\t\t\"pt\": \"Garante que as APIs do Gateway de API expostas à internet usem o protocolo HTTPS.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"HTTPS ensures data confidentiality and integrity during transmission over the internet.\",\n\t\t\"zh\": \"HTTPS 可确保在公网传输期间数据的机密性和完整性。\",\n\t\t\"ja\": \"HTTPS により、インターネット経由での送信中にデータの機密性と整合性が確保されます。\",\n\t\t\"de\": \"HTTPS gewährleistet Datenvertraulichkeit und Integrität während der Übertragung über das Internet.\",\n\t\t\"es\": \"HTTPS garantiza la confidencialidad e integridad de los datos durante la transmisión por internet.\",\n\t\t\"fr\": \"HTTPS assure la confidentialité et l'intégrité des données pendant la transmission sur Internet.\",\n\t\t\"pt\": \"O HTTPS garante confidencialidade e integridade dos dados durante a transmissão pela internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the API Gateway API to require HTTPS for internet requests.\",\n\t\t\"zh\": \"配置 API 网关 API，要求公网请求使用 HTTPS。\",\n\t\t\"ja\": \"API ゲートウェイ API を設定して、インターネットリクエストに HTTPS を要求します。\",\n\t\t\"de\": \"Konfigurieren Sie die API Gateway API so, dass HTTPS für Internet-Anfragen erforderlich ist.\",\n\t\t\"es\": \"Configure la API del Gateway de API para requerir HTTPS para solicitudes de internet.\",\n\t\t\"fr\": \"Configurez l'API du Gateway API pour exiger HTTPS pour les requêtes Internet.\",\n\t\t\"pt\": \"Configure a API do Gateway de API para exigir HTTPS para solicitações de internet.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Api\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Api\")\n\n\t# Conceptual check for protocol\n\tproto := helpers.get_property(resource, \"RequestConfig\", {\"RequestProtocol\": \"HTTP\"}).RequestProtocol\n\tproto == \"HTTP\"\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"RequestConfig\", \"RequestProtocol\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-api-visibility-private", Name: models.I18nString{"de": "API-Gateway-API-Sichtbarkeit privat", "en": "API Gateway API Visibility Private", "es": "Visibilidad de API de API Gateway Privada", "fr": "Visibilité API de l'API Gateway Privée", "ja": "API ゲートウェイ API の可視性がプライベート", "pt": "Visibilidade da API do API Gateway Privada", "zh": "API 网关中的 API 设置为私有"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass API-Gateway-APIs auf PRIVATE-Sichtbarkeit gesetzt sind.", "en": "Ensures API Gateway APIs are set to PRIVATE visibility.", "es": "Garantiza que las API de API Gateway estén configuradas con visibilidad PRIVADA.", "fr": "Garantit que les API de l'API Gateway sont définies sur la visibilité PRIVÉE.", "ja": "API ゲートウェイの API が PRIVATE 可視性に設定されていることを確認します。", "pt": "Garante que as APIs do API Gateway estejam definidas com visibilidade PRIVADA.", "zh": "确保 API 网关中的 API 设置为私有。"}, Reason: models.I18nString{"de": "Private APIs sind nur innerhalb des VPC zugänglich, was die Exposition reduziert.", "en": "Private APIs are only accessible within the VPC, reducing exposure.", "es": "Las API privadas solo son accesibles dentro de la VPC, reduciendo la exposición.", "fr": "Les API privées ne sont accessibles qu'au sein du VPC, réduisant l'exposition.", "ja": "プライベート API は VPC 内でのみアクセス可能で、露出を減らします。", "pt": "APIs privadas são acessíveis apenas dentro da VPC, reduzindo a exposição.", "zh": "私有 API 只能在 VPC 内访问，减少暴露面。"}, Recommendation: models.I18nString{"de": "Setzen Sie die API-Sichtbarkeit für interne APIs auf PRIVATE.", "en": "Set API visibility to PRIVATE for internal APIs.", "es": "Establezca la visibilidad de la API en PRIVADA para API internas.", "fr": "Définissez la visibilité de l'API sur PRIVÉE pour les API internes.", "ja": "内部 API の可視性を PRIVATE に設定します。", "pt": "Defina a visibilidade da API como PRIVADA para APIs internas.", "zh": "将内部 API 的可见性设置为私有。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Api"}, FilePath: "aliyun/rules/api-gateway-api-visibility-private.rego", PackageName: "infraguard.rules.aliyun.api_gateway_api_visibility_private", Content: "package infraguard.rules.aliyun.api_gateway_api_visibility_private\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"api-gateway-api-visibility-private\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway API Visibility Private\",\n\t\t\"zh\": \"API 网关中的 API 设置为私有\",\n\t\t\"ja\": \"API ゲートウェイ API の可視性がプライベート\",\n\t\t\"de\": \"API-Gateway-API-Sichtbarkeit privat\",\n\t\t\"es\": \"Visibilidad de API de API Gateway Privada\",\n\t\t\"fr\": \"Visibilité API de l'API Gateway Privée\",\n\t\t\"pt\": \"Visibilidade da API do API Gateway Privada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures API Gateway APIs are set to PRIVATE visibility.\",\n\t\t\"zh\": \"确保 API 网关中的 API 设置为私有。\",\n\t\t\"ja\": \"API ゲートウェイの API が PRIVATE 可視性に設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API-Gateway-APIs auf PRIVATE-Sichtbarkeit gesetzt sind.\",\n\t\t\"es\": \"Garantiza que las API de API Gateway estén configuradas con visibilidad PRIVADA.\",\n\t\t\"fr\": \"Garantit que les API de l'API Gateway sont définies sur la visibilité PRIVÉE.\",\n\t\t\"pt\": \"Garante que as APIs do API Gateway estejam definidas com visibilidade PRIVADA.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Private APIs are only accessible within the VPC, reducing exposure.\",\n\t\t\"zh\": \"私有 API 只能在 VPC 内访问，减少暴露面。\",\n\t\t\"ja\": \"プライベート API は VPC 内でのみアクセス可能で、露出を減らします。\",\n\t\t\"de\": \"Private APIs sind nur innerhalb des VPC zugänglich, was die Exposition reduziert.\",\n\t\t\"es\": \"Las API privadas solo son accesibles dentro de la VPC, reduciendo la exposición.\",\n\t\t\"fr\": \"Les API privées ne sont accessibles qu'au sein du VPC, réduisant l'exposition.\",\n\t\t\"pt\": \"APIs privadas são acessíveis apenas dentro da VPC, reduzindo a exposição.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set API visibility to PRIVATE for internal APIs.\",\n\t\t\"zh\": \"将内部 API 的可见性设置为私有。\",\n\t\t\"ja\": \"内部 API の可視性を PRIVATE に設定します。\",\n\t\t\"de\": \"Setzen Sie die API-Sichtbarkeit für interne APIs auf PRIVATE.\",\n\t\t\"es\": \"Establezca la visibilidad de la API en PRIVADA para API internas.\",\n\t\t\"fr\": \"Définissez la visibilité de l'API sur PRIVÉE pour les API internes.\",\n\t\t\"pt\": \"Defina a visibilidade da API como PRIVADA para APIs internas.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Api\"]\n}\n\ndeny contains result if {\n\tsome api_name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Api\")\n\tvisibility := helpers.get_property(resource, \"Visibility\", \"\")\n\n\tvisibility == \"PUBLIC\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": api_name,\n\t\t\"violation_path\": [\"Properties\", \"Visibility\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-group-bind-domain", Name: models.I18nString{"de": "API-Gateway-Gruppe Domain binden", "en": "API Gateway Group Bind Domain", "es": "Vincular Dominio del Grupo de API Gateway", "fr": "Lier le Domaine du Groupe API Gateway", "ja": "API ゲートウェイグループのドメインバインド", "pt": "Vincular Domínio do Grupo de API Gateway", "zh": "API 网关中 API 分组绑定自定义域名"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass API-Gateway-Gruppen benutzerdefinierte Domains gebunden haben.", "en": "Ensures API Gateway groups have custom domains bound.", "es": "Garantiza que los grupos de API Gateway tengan dominios personalizados vinculados.", "fr": "Garantit que les groupes API Gateway ont des domaines personnalisés liés.", "ja": "API ゲートウェイグループにカスタムドメインがバインドされていることを確認します。", "pt": "Garante que os grupos de API Gateway tenham domínios personalizados vinculados.", "zh": "确保 API 网关中的 API 分组绑定了自定义域名。"}, Reason: models.I18nString{"de": "Benutzerdefinierte Domains bieten besseres Branding und Kontrolle.", "en": "Custom domains provide better branding and control.", "es": "Los dominios personalizados proporcionan mejor marca y control.", "fr": "Les domaines personnalisés offrent un meilleur branding et contrôle.", "ja": "カスタムドメインはより優れたブランディングと制御を提供します。", "pt": "Os domínios personalizados fornecem melhor marca e controle.", "zh": "自定义域名提供更好的品牌控制和可管理性。"}, Recommendation: models.I18nString{"de": "Binden Sie benutzerdefinierte Domains an API-Gateway-Gruppen.", "en": "Bind custom domains to API Gateway groups.", "es": "Vincule dominios personalizados a grupos de API Gateway.", "fr": "Liez des domaines personnalisés aux groupes API Gateway.", "ja": "API ゲートウェイグループにカスタムドメインをバインドします。", "pt": "Vincule domínios personalizados a grupos de API Gateway.", "zh": "为 API 网关分组绑定自定义域名。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Group"}, FilePath: "aliyun/rules/api-gateway-group-bind-domain.rego", PackageName: "infraguard.rules.aliyun.api_gateway_group_bind_domain", Content: "package infraguard.rules.aliyun.api_gateway_group_bind_domain\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"api-gateway-group-bind-domain\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway Group Bind Domain\",\n\t\t\"zh\": \"API 网关中 API 分组绑定自定义域名\",\n\t\t\"ja\": \"API ゲートウェイグループのドメインバインド\",\n\t\t\"de\": \"API-Gateway-Gruppe Domain binden\",\n\t\t\"es\": \"Vincular Dominio del Grupo de API Gateway\",\n\t\t\"fr\": \"Lier le Domaine du Groupe API Gateway\",\n\t\t\"pt\": \"Vincular Domínio do Grupo de API Gateway\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures API Gateway groups have custom domains bound.\",\n\t\t\"zh\": \"确保 API 网关中的 API 分组绑定了自定义域名。\",\n\t\t\"ja\": \"API ゲートウェイグループにカスタムドメインがバインドされていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API-Gateway-Gruppen benutzerdefinierte Domains gebunden haben.\",\n\t\t\"es\": \"Garantiza que los grupos de API Gateway tengan dominios personalizados vinculados.\",\n\t\t\"fr\": \"Garantit que les groupes API Gateway ont des domaines personnalisés liés.\",\n\t\t\"pt\": \"Garante que os grupos de API Gateway tenham domínios personalizados vinculados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Custom domains provide better branding and control.\",\n\t\t\"zh\": \"自定义域名提供更好的品牌控制和可管理性。\",\n\t\t\"ja\": \"カスタムドメインはより優れたブランディングと制御を提供します。\",\n\t\t\"de\": \"Benutzerdefinierte Domains bieten besseres Branding und Kontrolle.\",\n\t\t\"es\": \"Los dominios personalizados proporcionan mejor marca y control.\",\n\t\t\"fr\": \"Les domaines personnalisés offrent un meilleur branding et contrôle.\",\n\t\t\"pt\": \"Os domínios personalizados fornecem melhor marca e controle.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Bind custom domains to API Gateway groups.\",\n\t\t\"zh\": \"为 API 网关分组绑定自定义域名。\",\n\t\t\"ja\": \"API ゲートウェイグループにカスタムドメインをバインドします。\",\n\t\t\"de\": \"Binden Sie benutzerdefinierte Domains an API-Gateway-Gruppen.\",\n\t\t\"es\": \"Vincule dominios personalizados a grupos de API Gateway.\",\n\t\t\"fr\": \"Liez des domaines personnalisés aux groupes API Gateway.\",\n\t\t\"pt\": \"Vincule domínios personalizados a grupos de API Gateway.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Group\"]\n}\n\ndeny contains result if {\n\tsome group_name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Group\")\n\n\tnot has_custom_domain_bound(group_name, resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\nhas_custom_domain_bound(group_name, group_resource) if {\n\tsome domain_name, domain_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::CustomDomain\")\n\tbound_group_id := helpers.get_property(domain_resource, \"GroupId\", \"\")\n\tgroup_id := helpers.get_property(group_resource, \"GroupId\", \"\")\n\n\t# Handle direct string match\n\tbound_group_id == group_id\n}\n\nhas_custom_domain_bound(group_name, group_resource) if {\n\tsome domain_name, domain_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::CustomDomain\")\n\tbound_group_id := helpers.get_property(domain_resource, \"GroupId\", \"\")\n\n\t# Handle Fn::GetAtt reference - check if it references the group\n\thelpers.is_get_att_referencing(bound_group_id, group_name)\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-group-enabled-ssl", Name: models.I18nString{"de": "API-Gateway-Gruppe SSL aktiviert", "en": "API Gateway Group SSL Enabled", "es": "SSL de Grupo de API Gateway Habilitado", "fr": "SSL du Groupe API Gateway Activé", "ja": "API ゲートウェイグループで SSL が有効", "pt": "SSL do Grupo de API Gateway Habilitado", "zh": "API 网关分组开启 SSL"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass SSL für API-Gateway-Gruppen aktiviert ist.", "en": "Ensures that SSL is enabled for API Gateway groups.", "es": "Garantiza que SSL esté habilitado para los grupos de API Gateway.", "fr": "Garantit que SSL est activé pour les groupes API Gateway.", "ja": "API ゲートウェイグループで SSL が有効になっていることを確認します。", "pt": "Garante que SSL esteja habilitado para grupos de API Gateway.", "zh": "确保 API 网关分组开启了 SSL。"}, Reason: models.I18nString{"de": "SSL verschlüsselt den Datenverkehr zwischen Clients und dem API-Gateway und gewährleistet die Vertraulichkeit der Daten.", "en": "SSL encrypts traffic between clients and the API Gateway, ensuring data confidentiality.", "es": "SSL cifra el tráfico entre clientes y la API Gateway, garantizando la confidencialidad de los datos.", "fr": "SSL chiffre le trafic entre les clients et l'API Gateway, garantissant la confidentialité des données.", "ja": "SSL はクライアントと API ゲートウェイ間のトラフィックを暗号化し、データの機密性を確保します。", "pt": "SSL criptografa o tráfego entre clientes e o API Gateway, garantindo a confidencialidade dos dados.", "zh": "SSL 对客户端和 API 网关之间的流量进行加密，确保数据机密性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie ein SSL-Zertifikat für die API-Gateway-Gruppe.", "en": "Configure an SSL certificate for the API Gateway group.", "es": "Configure un certificado SSL para el grupo de API Gateway.", "fr": "Configurez un certificat SSL pour le groupe API Gateway.", "ja": "API ゲートウェイグループに SSL 証明書を設定します。", "pt": "Configure um certificado SSL para o grupo de API Gateway.", "zh": "为 API 网关分组配置 SSL 证书。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Group"}, FilePath: "aliyun/rules/api-gateway-group-enabled-ssl.rego", PackageName: "infraguard.rules.aliyun.api_gateway_group_enabled_ssl", Content: "package infraguard.rules.aliyun.api_gateway_group_enabled_ssl\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"api-gateway-group-enabled-ssl\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway Group SSL Enabled\",\n\t\t\"zh\": \"API 网关分组开启 SSL\",\n\t\t\"ja\": \"API ゲートウェイグループで SSL が有効\",\n\t\t\"de\": \"API-Gateway-Gruppe SSL aktiviert\",\n\t\t\"es\": \"SSL de Grupo de API Gateway Habilitado\",\n\t\t\"fr\": \"SSL du Groupe API Gateway Activé\",\n\t\t\"pt\": \"SSL do Grupo de API Gateway Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that SSL is enabled for API Gateway groups.\",\n\t\t\"zh\": \"确保 API 网关分组开启了 SSL。\",\n\t\t\"ja\": \"API ゲートウェイグループで SSL が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SSL für API-Gateway-Gruppen aktiviert ist.\",\n\t\t\"es\": \"Garantiza que SSL esté habilitado para los grupos de API Gateway.\",\n\t\t\"fr\": \"Garantit que SSL est activé pour les groupes API Gateway.\",\n\t\t\"pt\": \"Garante que SSL esteja habilitado para grupos de API Gateway.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"SSL encrypts traffic between clients and the API Gateway, ensuring data confidentiality.\",\n\t\t\"zh\": \"SSL 对客户端和 API 网关之间的流量进行加密，确保数据机密性。\",\n\t\t\"ja\": \"SSL はクライアントと API ゲートウェイ間のトラフィックを暗号化し、データの機密性を確保します。\",\n\t\t\"de\": \"SSL verschlüsselt den Datenverkehr zwischen Clients und dem API-Gateway und gewährleistet die Vertraulichkeit der Daten.\",\n\t\t\"es\": \"SSL cifra el tráfico entre clientes y la API Gateway, garantizando la confidencialidad de los datos.\",\n\t\t\"fr\": \"SSL chiffre le trafic entre les clients et l'API Gateway, garantissant la confidentialité des données.\",\n\t\t\"pt\": \"SSL criptografa o tráfego entre clientes e o API Gateway, garantindo a confidencialidade dos dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure an SSL certificate for the API Gateway group.\",\n\t\t\"zh\": \"为 API 网关分组配置 SSL 证书。\",\n\t\t\"ja\": \"API ゲートウェイグループに SSL 証明書を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie ein SSL-Zertifikat für die API-Gateway-Gruppe.\",\n\t\t\"es\": \"Configure un certificado SSL para el grupo de API Gateway.\",\n\t\t\"fr\": \"Configurez un certificat SSL pour le groupe API Gateway.\",\n\t\t\"pt\": \"Configure um certificado SSL para o grupo de API Gateway.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Group\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Group\")\n\n\t# Conceptual check\n\tnot helpers.has_property(resource, \"CustomDomains\") # Simplified\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-group-force-https", Name: models.I18nString{"de": "API-Gateway-Gruppe HTTPS erzwingen", "en": "API Gateway Group Force HTTPS", "es": "Forzar HTTPS del Grupo de API Gateway", "fr": "Forcer HTTPS du Groupe API Gateway", "ja": "API ゲートウェイグループの HTTPS 強制", "pt": "Forçar HTTPS do Grupo de API Gateway", "zh": "API 分组绑定独立域名并开启 Https 强制跳转"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass API-Gateway-Gruppen mit öffentlichen benutzerdefinierten Domains HTTPS-Force-Redirect aktiviert haben.", "en": "Ensures API Gateway groups with public custom domains have HTTPS force redirect enabled.", "es": "Garantiza que los grupos de API Gateway con dominios personalizados públicos tengan redirección forzada HTTPS habilitada.", "fr": "Garantit que les groupes API Gateway avec des domaines personnalisés publics ont la redirection HTTPS forcée activée.", "ja": "パブリックカスタムドメインを持つ API ゲートウェイグループで HTTPS 強制リダイレクトが有効になっていることを確認します。", "pt": "Garante que os grupos de API Gateway com domínios personalizados públicos tenham redirecionamento forçado HTTPS habilitado.", "zh": "检测网关分组下的所有公网独立域名是否都开启 HTTPS 强制跳转。"}, Reason: models.I18nString{"de": "HTTPS-Force-Redirect stellt sicher, dass der gesamte Datenverkehr verschlüsselt ist.", "en": "HTTPS force redirect ensures all traffic is encrypted.", "es": "La redirección forzada HTTPS garantiza que todo el tráfico esté cifrado.", "fr": "La redirection HTTPS forcée garantit que tout le trafic est chiffré.", "ja": "HTTPS 強制リダイレクトにより、すべてのトラフィックが暗号化されます。", "pt": "O redirecionamento forçado HTTPS garante que todo o tráfego esteja criptografado.", "zh": "HTTPS 强制跳转确保所有流量都经过加密。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie HTTPS-Force-Redirect für alle öffentlichen Domains.", "en": "Enable HTTPS force redirect for all public domains.", "es": "Habilite la redirección forzada HTTPS para todos los dominios públicos.", "fr": "Activez la redirection HTTPS forcée pour tous les domaines publics.", "ja": "すべてのパブリックドメインで HTTPS 強制リダイレクトを有効にします。", "pt": "Habilite o redirecionamento forçado HTTPS para todos os domínios públicos.", "zh": "为所有公网域名启用 HTTPS 强制跳转。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Group"}, FilePath: "aliyun/rules/api-gateway-group-force-https.rego", PackageName: "infraguard.rules.aliyun.api_gateway_group_force_https", Content: "package infraguard.rules.aliyun.api_gateway_group_force_https\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"api-gateway-group-force-https\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway Group Force HTTPS\",\n\t\t\"zh\": \"API 分组绑定独立域名并开启 Https 强制跳转\",\n\t\t\"ja\": \"API ゲートウェイグループの HTTPS 強制\",\n\t\t\"de\": \"API-Gateway-Gruppe HTTPS erzwingen\",\n\t\t\"es\": \"Forzar HTTPS del Grupo de API Gateway\",\n\t\t\"fr\": \"Forcer HTTPS du Groupe API Gateway\",\n\t\t\"pt\": \"Forçar HTTPS do Grupo de API Gateway\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures API Gateway groups with public custom domains have HTTPS force redirect enabled.\",\n\t\t\"zh\": \"检测网关分组下的所有公网独立域名是否都开启 HTTPS 强制跳转。\",\n\t\t\"ja\": \"パブリックカスタムドメインを持つ API ゲートウェイグループで HTTPS 強制リダイレクトが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API-Gateway-Gruppen mit öffentlichen benutzerdefinierten Domains HTTPS-Force-Redirect aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los grupos de API Gateway con dominios personalizados públicos tengan redirección forzada HTTPS habilitada.\",\n\t\t\"fr\": \"Garantit que les groupes API Gateway avec des domaines personnalisés publics ont la redirection HTTPS forcée activée.\",\n\t\t\"pt\": \"Garante que os grupos de API Gateway com domínios personalizados públicos tenham redirecionamento forçado HTTPS habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"HTTPS force redirect ensures all traffic is encrypted.\",\n\t\t\"zh\": \"HTTPS 强制跳转确保所有流量都经过加密。\",\n\t\t\"ja\": \"HTTPS 強制リダイレクトにより、すべてのトラフィックが暗号化されます。\",\n\t\t\"de\": \"HTTPS-Force-Redirect stellt sicher, dass der gesamte Datenverkehr verschlüsselt ist.\",\n\t\t\"es\": \"La redirección forzada HTTPS garantiza que todo el tráfico esté cifrado.\",\n\t\t\"fr\": \"La redirection HTTPS forcée garantit que tout le trafic est chiffré.\",\n\t\t\"pt\": \"O redirecionamento forçado HTTPS garante que todo o tráfego esteja criptografado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable HTTPS force redirect for all public domains.\",\n\t\t\"zh\": \"为所有公网域名启用 HTTPS 强制跳转。\",\n\t\t\"ja\": \"すべてのパブリックドメインで HTTPS 強制リダイレクトを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie HTTPS-Force-Redirect für alle öffentlichen Domains.\",\n\t\t\"es\": \"Habilite la redirección forzada HTTPS para todos los dominios públicos.\",\n\t\t\"fr\": \"Activez la redirection HTTPS forcée pour tous les domaines publics.\",\n\t\t\"pt\": \"Habilite o redirecionamento forçado HTTPS para todos os domínios públicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Group\"]\n}\n\ndeny contains result if {\n\tsome group_name, group_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Group\")\n\n\tsome domain_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::CustomDomain\")\n\tbound_group_id := helpers.get_property(domain_resource, \"GroupId\", \"\")\n\n\t# Check if domain is bound to this group (direct match via Ref)\n\thelpers.is_referencing(bound_group_id, group_name)\n\n\tdomain_name := helpers.get_property(domain_resource, \"DomainName\", \"\")\n\tis_public_domain(domain_name)\n\n\tcert_body := helpers.get_property(domain_resource, \"CertificateBody\", \"\")\n\tcert_key := helpers.get_property(domain_resource, \"CertificatePrivateKey\", \"\")\n\tcert_body == \"\"\n\tcert_key == \"\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\", \"CustomDomains\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome group_name, group_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Group\")\n\n\tsome domain_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::CustomDomain\")\n\tbound_group_id := helpers.get_property(domain_resource, \"GroupId\", \"\")\n\n\t# Check if domain is bound to this group (Fn::GetAtt reference)\n\thelpers.is_get_att_referencing(bound_group_id, group_name)\n\n\tdomain_name := helpers.get_property(domain_resource, \"DomainName\", \"\")\n\tis_public_domain(domain_name)\n\n\tcert_body := helpers.get_property(domain_resource, \"CertificateBody\", \"\")\n\tcert_key := helpers.get_property(domain_resource, \"CertificatePrivateKey\", \"\")\n\tcert_body == \"\"\n\tcert_key == \"\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\", \"CustomDomains\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\nis_public_domain(domain) if {\n\tnot contains(domain, \".internal.\")\n\tnot contains(domain, \".local\")\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-group-https-policy-check", Name: models.I18nString{"de": "API Gateway Gruppe HTTPS-Richtlinienprüfung", "en": "API Gateway Group HTTPS Policy Check", "es": "Verificación de Política HTTPS del Grupo de API Gateway", "fr": "Vérification de Politique HTTPS du Groupe API Gateway", "ja": "API ゲートウェイグループ HTTPS ポリシーチェック", "pt": "Verificação de Política HTTPS do Grupo API Gateway", "zh": "API 网关中 API 分组的 HTTPS 安全策略满足要求"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass API Gateway-Gruppen die HTTPS-Sicherheitsrichtlinie korrekt gesetzt haben.", "en": "Ensures API Gateway groups have HTTPS security policy set correctly.", "es": "Garantiza que los grupos de API Gateway tengan la política de seguridad HTTPS configurada correctamente.", "fr": "Garantit que les groupes API Gateway ont la politique de sécurité HTTPS définie correctement.", "ja": "API ゲートウェイグループで HTTPS セキュリティポリシーが正しく設定されていることを確認します。", "pt": "Garante que os grupos do API Gateway tenham a política de segurança HTTPS configurada corretamente.", "zh": "确保 API 网关中的 API 分组设置的 HTTPS 安全策略在指定的参数列表中。"}, Reason: models.I18nString{"de": "Starke HTTPS-Richtlinien gewährleisten sichere Verbindungen.", "en": "Strong HTTPS policies ensure secure connections.", "es": "Las políticas HTTPS fuertes garantizan conexiones seguras.", "fr": "Des politiques HTTPS fortes garantissent des connexions sécurisées.", "ja": "強力な HTTPS ポリシーにより、安全な接続が確保されます。", "pt": "Políticas HTTPS fortes garantem conexões seguras.", "zh": "强 HTTPS 策略确保连接安全。"}, Recommendation: models.I18nString{"de": "Verwenden Sie TLS 1.2 oder höher für HTTPS-Verbindungen.", "en": "Use TLS 1.2 or higher for HTTPS connections.", "es": "Use TLS 1.2 o superior para conexiones HTTPS.", "fr": "Utilisez TLS 1.2 ou supérieur pour les connexions HTTPS.", "ja": "HTTPS 接続には TLS 1.2 以降を使用します。", "pt": "Use TLS 1.2 ou superior para conexões HTTPS.", "zh": "使用 TLS 1.2 或更高版本进行 HTTPS 连接。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Group"}, FilePath: "aliyun/rules/api-gateway-group-https-policy-check.rego", PackageName: "infraguard.rules.aliyun.api_gateway_group_https_policy_check", Content: "package infraguard.rules.aliyun.api_gateway_group_https_policy_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"api-gateway-group-https-policy-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway Group HTTPS Policy Check\",\n\t\t\"zh\": \"API 网关中 API 分组的 HTTPS 安全策略满足要求\",\n\t\t\"ja\": \"API ゲートウェイグループ HTTPS ポリシーチェック\",\n\t\t\"de\": \"API Gateway Gruppe HTTPS-Richtlinienprüfung\",\n\t\t\"es\": \"Verificación de Política HTTPS del Grupo de API Gateway\",\n\t\t\"fr\": \"Vérification de Politique HTTPS du Groupe API Gateway\",\n\t\t\"pt\": \"Verificação de Política HTTPS do Grupo API Gateway\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures API Gateway groups have HTTPS security policy set correctly.\",\n\t\t\"zh\": \"确保 API 网关中的 API 分组设置的 HTTPS 安全策略在指定的参数列表中。\",\n\t\t\"ja\": \"API ゲートウェイグループで HTTPS セキュリティポリシーが正しく設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API Gateway-Gruppen die HTTPS-Sicherheitsrichtlinie korrekt gesetzt haben.\",\n\t\t\"es\": \"Garantiza que los grupos de API Gateway tengan la política de seguridad HTTPS configurada correctamente.\",\n\t\t\"fr\": \"Garantit que les groupes API Gateway ont la politique de sécurité HTTPS définie correctement.\",\n\t\t\"pt\": \"Garante que os grupos do API Gateway tenham a política de segurança HTTPS configurada corretamente.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Strong HTTPS policies ensure secure connections.\",\n\t\t\"zh\": \"强 HTTPS 策略确保连接安全。\",\n\t\t\"ja\": \"強力な HTTPS ポリシーにより、安全な接続が確保されます。\",\n\t\t\"de\": \"Starke HTTPS-Richtlinien gewährleisten sichere Verbindungen.\",\n\t\t\"es\": \"Las políticas HTTPS fuertes garantizan conexiones seguras.\",\n\t\t\"fr\": \"Des politiques HTTPS fortes garantissent des connexions sécurisées.\",\n\t\t\"pt\": \"Políticas HTTPS fortes garantem conexões seguras.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use TLS 1.2 or higher for HTTPS connections.\",\n\t\t\"zh\": \"使用 TLS 1.2 或更高版本进行 HTTPS 连接。\",\n\t\t\"ja\": \"HTTPS 接続には TLS 1.2 以降を使用します。\",\n\t\t\"de\": \"Verwenden Sie TLS 1.2 oder höher für HTTPS-Verbindungen.\",\n\t\t\"es\": \"Use TLS 1.2 o superior para conexiones HTTPS.\",\n\t\t\"fr\": \"Utilisez TLS 1.2 ou supérieur pour les connexions HTTPS.\",\n\t\t\"pt\": \"Use TLS 1.2 ou superior para conexões HTTPS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Group\"]\n}\n\nallowed_https_policies := [\n\t\"HTTPS2_TLS1_2\",\n\t\"HTTPS2_TLS1_3\",\n]\n\ndeny contains result if {\n\tsome group_name, group_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Group\")\n\n\tinstance_id := helpers.get_property(group_resource, \"InstanceId\", \"\")\n\n\t# Check all instances and find the one referenced by this group\n\tsome instance_name, instance_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Instance\")\n\n\t# Match by direct string ID\n\tinstance_id == instance_name\n\thttps_policy := helpers.get_property(instance_resource, \"HttpsPolicy\", \"\")\n\tnot https_policy in allowed_https_policies\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\", \"InstanceId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome group_name, group_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Group\")\n\n\tinstance_id := helpers.get_property(group_resource, \"InstanceId\", \"\")\n\n\t# Check all instances and find the one referenced by this group via Fn::GetAtt\n\tsome instance_name, instance_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Instance\")\n\n\t# Match by Fn::GetAtt reference\n\thelpers.is_get_att_referencing(instance_id, instance_name)\n\n\thttps_policy := helpers.get_property(instance_resource, \"HttpsPolicy\", \"\")\n\tnot https_policy in allowed_https_policies\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\", \"InstanceId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:api-gateway-group-log-enabled", Name: models.I18nString{"de": "API Gateway Gruppe Log aktiviert", "en": "API Gateway Group Log Enabled", "es": "Registro de Grupo de API Gateway Habilitado", "fr": "Journal du Groupe API Gateway Activé", "ja": "API ゲートウェイグループログが有効", "pt": "Log do Grupo API Gateway Habilitado", "zh": "为 API 分组设置调用日志存储"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass API Gateway-Gruppen Protokollierung konfiguriert haben.", "en": "Ensures API Gateway groups have logging configured.", "es": "Garantiza que los grupos de API Gateway tengan registro configurado.", "fr": "Garantit que les groupes API Gateway ont la journalisation configurée.", "ja": "API ゲートウェイグループでログ記録が設定されていることを確認します。", "pt": "Garante que os grupos do API Gateway tenham registro configurado.", "zh": "确保 API 网关中 API 分组设置了调用日志存储。"}, Reason: models.I18nString{"de": "Die Protokollierung ermöglicht die Überwachung und Fehlerbehebung der API-Nutzung.", "en": "Logging enables monitoring and troubleshooting of API usage.", "es": "El registro permite el monitoreo y la solución de problemas del uso de la API.", "fr": "La journalisation permet la surveillance et le dépannage de l'utilisation de l'API.", "ja": "ログ記録により、API 使用の監視とトラブルシューティングが可能になります。", "pt": "O registro permite monitoramento e solução de problemas do uso da API.", "zh": "日志记录可实现 API 使用的监控和故障排除。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Protokollierung für API Gateway-Gruppen.", "en": "Enable logging for API Gateway groups.", "es": "Habilite el registro para los grupos de API Gateway.", "fr": "Activez la journalisation pour les groupes API Gateway.", "ja": "API ゲートウェイグループのログ記録を有効にします。", "pt": "Habilite o registro para os grupos do API Gateway.", "zh": "为 API 网关分组启用日志记录。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Group"}, FilePath: "aliyun/rules/api-gateway-group-log-enabled.rego", PackageName: "infraguard.rules.aliyun.api_gateway_group_log_enabled", Content: "package infraguard.rules.aliyun.api_gateway_group_log_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"api-gateway-group-log-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway Group Log Enabled\",\n\t\t\"zh\": \"为 API 分组设置调用日志存储\",\n\t\t\"ja\": \"API ゲートウェイグループログが有効\",\n\t\t\"de\": \"API Gateway Gruppe Log aktiviert\",\n\t\t\"es\": \"Registro de Grupo de API Gateway Habilitado\",\n\t\t\"fr\": \"Journal du Groupe API Gateway Activé\",\n\t\t\"pt\": \"Log do Grupo API Gateway Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures API Gateway groups have logging configured.\",\n\t\t\"zh\": \"确保 API 网关中 API 分组设置了调用日志存储。\",\n\t\t\"ja\": \"API ゲートウェイグループでログ記録が設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API Gateway-Gruppen Protokollierung konfiguriert haben.\",\n\t\t\"es\": \"Garantiza que los grupos de API Gateway tengan registro configurado.\",\n\t\t\"fr\": \"Garantit que les groupes API Gateway ont la journalisation configurée.\",\n\t\t\"pt\": \"Garante que os grupos do API Gateway tenham registro configurado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Logging enables monitoring and troubleshooting of API usage.\",\n\t\t\"zh\": \"日志记录可实现 API 使用的监控和故障排除。\",\n\t\t\"ja\": \"ログ記録により、API 使用の監視とトラブルシューティングが可能になります。\",\n\t\t\"de\": \"Die Protokollierung ermöglicht die Überwachung und Fehlerbehebung der API-Nutzung.\",\n\t\t\"es\": \"El registro permite el monitoreo y la solución de problemas del uso de la API.\",\n\t\t\"fr\": \"La journalisation permet la surveillance et le dépannage de l'utilisation de l'API.\",\n\t\t\"pt\": \"O registro permite monitoramento e solução de problemas do uso da API.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable logging for API Gateway groups.\",\n\t\t\"zh\": \"为 API 网关分组启用日志记录。\",\n\t\t\"ja\": \"API ゲートウェイグループのログ記録を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Protokollierung für API Gateway-Gruppen.\",\n\t\t\"es\": \"Habilite el registro para los grupos de API Gateway.\",\n\t\t\"fr\": \"Activez la journalisation pour les groupes API Gateway.\",\n\t\t\"pt\": \"Habilite o registro para os grupos do API Gateway.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Group\"]\n}\n\ndeny contains result if {\n\tsome group_name, group_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Group\")\n\n\tnot has_log_config(group_name, group_resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\nhas_log_config(group_name, group_resource) if {\n\tsome log_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::LogConfig\")\n\tbound_group_id := helpers.get_property(log_resource, \"GroupId\", \"\")\n\n\t# Handle direct string match\n\tbound_group_id == group_name\n\n\tlog_store := helpers.get_property(log_resource, \"LogStore\", \"\")\n\tlog_store != \"\"\n}\n\nhas_log_config(group_name, group_resource) if {\n\tsome log_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::LogConfig\")\n\tbound_group_id := helpers.get_property(log_resource, \"GroupId\", \"\")\n\n\t# Handle Fn::GetAtt reference\n\thelpers.is_get_att_referencing(bound_group_id, group_name)\n\n\tlog_store := helpers.get_property(log_resource, \"LogStore\", \"\")\n\tlog_store != \"\"\n}\n\nhas_log_config(group_name, group_resource) if {\n\tsome log_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::LogConfig\")\n\tbound_group_id := helpers.get_property(log_resource, \"GroupId\", \"\")\n\n\t# Handle direct string match\n\tbound_group_id == group_name\n\n\tsls_log_store := helpers.get_property(log_resource, \"SlsLogStore\", \"\")\n\tsls_log_store != \"\"\n}\n\nhas_log_config(group_name, group_resource) if {\n\tsome log_resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::LogConfig\")\n\tbound_group_id := helpers.get_property(log_resource, \"GroupId\", \"\")\n\n\t# Handle Fn::GetAtt reference\n\thelpers.is_get_att_referencing(bound_group_id, group_name)\n\n\tsls_log_store := helpers.get_property(log_resource, \"SlsLogStore\", \"\")\n\tsls_log_store != \"\"\n}\n\nhas_log_config(group_name, group_resource) if {\n\ttags := helpers.get_property(group_resource, \"Tags\", [])\n\tsome tag in tags\n\ttag.Key == \"LogEnabled\"\n\ttag.Value == \"true\"\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:apig-group-custom-trace-enabled", Name: models.I18nString{"de": "API Gateway Gruppe Benutzerdefinierte Verfolgung aktiviert", "en": "API Gateway Group Custom Trace Enabled", "es": "Rastreo Personalizado de Grupo de API Gateway Habilitado", "fr": "Traçage Personnalisé du Groupe API Gateway Activé", "ja": "API ゲートウェイグループカスタムトレースが有効", "pt": "Rastreamento Personalizado do Grupo API Gateway Habilitado", "zh": "API 分组自定义追踪启用"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass API Gateway-Gruppen benutzerdefinierte Verfolgung aktiviert haben.", "en": "Ensures API Gateway groups have custom tracing enabled.", "es": "Garantiza que los grupos de API Gateway tengan rastreo personalizado habilitado.", "fr": "Garantit que les groupes API Gateway ont le traçage personnalisé activé.", "ja": "API ゲートウェイグループでカスタムトレースが有効になっていることを確認します。", "pt": "Garante que os grupos do API Gateway tenham rastreamento personalizado habilitado.", "zh": "确保 API 网关分组启用了自定义追踪功能。"}, Reason: models.I18nString{"de": "Benutzerdefinierte Verfolgung ermöglicht besseres Debugging und Leistungsanalyse.", "en": "Custom tracing enables better debugging and performance analysis.", "es": "El rastreo personalizado permite un mejor depuración y análisis de rendimiento.", "fr": "Le traçage personnalisé permet un meilleur débogage et une meilleure analyse des performances.", "ja": "カスタムトレースにより、より良いデバッグとパフォーマンス分析が可能になります。", "pt": "O rastreamento personalizado permite melhor depuração e análise de desempenho.", "zh": "自定义追踪可实现更好的调试和性能分析。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie benutzerdefinierte Verfolgung für API Gateway-Gruppen.", "en": "Enable custom tracing for API Gateway groups.", "es": "Habilite el rastreo personalizado para los grupos de API Gateway.", "fr": "Activez le traçage personnalisé pour les groupes API Gateway.", "ja": "API ゲートウェイグループのカスタムトレースを有効にします。", "pt": "Habilite o rastreamento personalizado para os grupos do API Gateway.", "zh": "为 API 网关分组启用自定义追踪。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Group"}, FilePath: "aliyun/rules/apig-group-custom-trace-enabled.rego", PackageName: "infraguard.rules.aliyun.apig_group_custom_trace_enabled", Content: "package infraguard.rules.aliyun.apig_group_custom_trace_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"apig-group-custom-trace-enabled\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway Group Custom Trace Enabled\",\n\t\t\"zh\": \"API 分组自定义追踪启用\",\n\t\t\"ja\": \"API ゲートウェイグループカスタムトレースが有効\",\n\t\t\"de\": \"API Gateway Gruppe Benutzerdefinierte Verfolgung aktiviert\",\n\t\t\"es\": \"Rastreo Personalizado de Grupo de API Gateway Habilitado\",\n\t\t\"fr\": \"Traçage Personnalisé du Groupe API Gateway Activé\",\n\t\t\"pt\": \"Rastreamento Personalizado do Grupo API Gateway Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures API Gateway groups have custom tracing enabled.\",\n\t\t\"zh\": \"确保 API 网关分组启用了自定义追踪功能。\",\n\t\t\"ja\": \"API ゲートウェイグループでカスタムトレースが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass API Gateway-Gruppen benutzerdefinierte Verfolgung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los grupos de API Gateway tengan rastreo personalizado habilitado.\",\n\t\t\"fr\": \"Garantit que les groupes API Gateway ont le traçage personnalisé activé.\",\n\t\t\"pt\": \"Garante que os grupos do API Gateway tenham rastreamento personalizado habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Custom tracing enables better debugging and performance analysis.\",\n\t\t\"zh\": \"自定义追踪可实现更好的调试和性能分析。\",\n\t\t\"ja\": \"カスタムトレースにより、より良いデバッグとパフォーマンス分析が可能になります。\",\n\t\t\"de\": \"Benutzerdefinierte Verfolgung ermöglicht besseres Debugging und Leistungsanalyse.\",\n\t\t\"es\": \"El rastreo personalizado permite un mejor depuración y análisis de rendimiento.\",\n\t\t\"fr\": \"Le traçage personnalisé permet un meilleur débogage et une meilleure analyse des performances.\",\n\t\t\"pt\": \"O rastreamento personalizado permite melhor depuração e análise de desempenho.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable custom tracing for API Gateway groups.\",\n\t\t\"zh\": \"为 API 网关分组启用自定义追踪。\",\n\t\t\"ja\": \"API ゲートウェイグループのカスタムトレースを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie benutzerdefinierte Verfolgung für API Gateway-Gruppen.\",\n\t\t\"es\": \"Habilite el rastreo personalizado para los grupos de API Gateway.\",\n\t\t\"fr\": \"Activez le traçage personnalisé pour les groupes API Gateway.\",\n\t\t\"pt\": \"Habilite o rastreamento personalizado para os grupos do API Gateway.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Group\"]\n}\n\ndeny contains result if {\n\tsome group_name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Group\")\n\n\tnot has_tracing_enabled(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\nhas_tracing_enabled(resource) if {\n\ttags := helpers.get_property(resource, \"Tags\", [])\n\tsome tag in tags\n\ttag.Key == \"TracingEnabled\"\n\ttag.Value == \"true\"\n}\n\nhas_tracing_enabled(resource) if {\n\tsome name, config in helpers.resources_by_type(\"ALIYUN::ApiGateway::Tracing\")\n\tgroup_id := helpers.get_property(config, \"GroupId\", \"\")\n\tresource_group_id := helpers.get_property(resource, \"GroupId\", \"\")\n\tgroup_id == resource_group_id\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:apigateway-instance-multi-zone", Name: models.I18nString{"de": "API Gateway-Instanz Multi-Zonen-Bereitstellung", "en": "API Gateway Instance Multi-Zone Deployment", "es": "Implementación Multi-Zona de Instancia de API Gateway", "fr": "Déploiement Multi-Zone d'Instance API Gateway", "ja": "API ゲートウェイインスタンスマルチゾーン展開", "pt": "Implantação Multi-Zona de Instância API Gateway", "zh": "使用多可用区的 API 网关实例"}, Severity: "medium", Description: models.I18nString{"de": "API Gateway-Instanzen sollten in Multi-Zonen-Konfiguration für Hochverfügbarkeit bereitgestellt werden.", "en": "API Gateway instances should be deployed in multi-zone configuration for high availability.", "es": "Las instancias de API Gateway deben implementarse en configuración multi-zona para alta disponibilidad.", "fr": "Les instances API Gateway doivent être déployées en configuration multi-zone pour une haute disponibilité.", "ja": "API ゲートウェイインスタンスは、高可用性のためにマルチゾーン設定に展開する必要があります。", "pt": "As instâncias do API Gateway devem ser implantadas em configuração multi-zona para alta disponibilidade.", "zh": "使用多可用区的 API 网关实例，视为合规。"}, Reason: models.I18nString{"de": "Die API Gateway-Instanz wird in einer einzelnen Verfügbarkeitszone bereitgestellt, was einen Single Point of Failure schafft.", "en": "The API Gateway instance is deployed in a single availability zone, creating a single point of failure.", "es": "La instancia de API Gateway se implementa en una sola zona de disponibilidad, creando un punto único de falla.", "fr": "L'instance API Gateway est déployée dans une seule zone de disponibilité, créant un point de défaillance unique.", "ja": "API ゲートウェイインスタンスが単一の可用性ゾーンに展開されているため、単一障害点が作成されます。", "pt": "A instância do API Gateway é implantada em uma única zona de disponibilidade, criando um ponto único de falha.", "zh": "API 网关实例部署在单个可用区，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Stellen Sie die API Gateway-Instanz in einer Multi-Zonen-Konfiguration bereit, indem Sie eine ZoneId im MAZ (Multi-AZ) Format angeben, z. B. 'cn-beijing-MAZ2(f,g)'.", "en": "Deploy the API Gateway instance in a multi-zone configuration by specifying a ZoneId with MAZ (Multi-AZ) format, such as 'cn-beijing-MAZ2(f,g)'.", "es": "Implemente la instancia de API Gateway en una configuración multi-zona especificando un ZoneId con formato MAZ (Multi-AZ), como 'cn-beijing-MAZ2(f,g)'.", "fr": "Déployez l'instance API Gateway dans une configuration multi-zone en spécifiant un ZoneId au format MAZ (Multi-AZ), tel que 'cn-beijing-MAZ2(f,g)'.", "ja": "MAZ（マルチ AZ）形式の ZoneId（例：'cn-beijing-MAZ2(f,g)'）を指定して、API ゲートウェイインスタンスをマルチゾーン設定に展開します。", "pt": "Implante a instância do API Gateway em uma configuração multi-zona especificando um ZoneId com formato MAZ (Multi-AZ), como 'cn-beijing-MAZ2(f,g)'.", "zh": "通过指定 MAZ（多可用区）格式的 ZoneId（如'cn-beijing-MAZ2(f,g)'），将 API 网关实例部署在多可用区配置中。"}, ResourceTypes: []string{"ALIYUN::ApiGateway::Instance"}, FilePath: "aliyun/rules/apigateway-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.apigateway_instance_multi_zone", Content: "package infraguard.rules.aliyun.apigateway_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"apigateway-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"API Gateway Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的 API 网关实例\",\n\t\t\"ja\": \"API ゲートウェイインスタンスマルチゾーン展開\",\n\t\t\"de\": \"API Gateway-Instanz Multi-Zonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona de Instancia de API Gateway\",\n\t\t\"fr\": \"Déploiement Multi-Zone d'Instance API Gateway\",\n\t\t\"pt\": \"Implantação Multi-Zona de Instância API Gateway\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"API Gateway instances should be deployed in multi-zone configuration for high availability.\",\n\t\t\"zh\": \"使用多可用区的 API 网关实例，视为合规。\",\n\t\t\"ja\": \"API ゲートウェイインスタンスは、高可用性のためにマルチゾーン設定に展開する必要があります。\",\n\t\t\"de\": \"API Gateway-Instanzen sollten in Multi-Zonen-Konfiguration für Hochverfügbarkeit bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias de API Gateway deben implementarse en configuración multi-zona para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances API Gateway doivent être déployées en configuration multi-zone pour une haute disponibilité.\",\n\t\t\"pt\": \"As instâncias do API Gateway devem ser implantadas em configuração multi-zona para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The API Gateway instance is deployed in a single availability zone, creating a single point of failure.\",\n\t\t\"zh\": \"API 网关实例部署在单个可用区，存在单点故障风险。\",\n\t\t\"ja\": \"API ゲートウェイインスタンスが単一の可用性ゾーンに展開されているため、単一障害点が作成されます。\",\n\t\t\"de\": \"Die API Gateway-Instanz wird in einer einzelnen Verfügbarkeitszone bereitgestellt, was einen Single Point of Failure schafft.\",\n\t\t\"es\": \"La instancia de API Gateway se implementa en una sola zona de disponibilidad, creando un punto único de falla.\",\n\t\t\"fr\": \"L'instance API Gateway est déployée dans une seule zone de disponibilité, créant un point de défaillance unique.\",\n\t\t\"pt\": \"A instância do API Gateway é implantada em uma única zona de disponibilidade, criando um ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy the API Gateway instance in a multi-zone configuration by specifying a ZoneId with MAZ (Multi-AZ) format, such as 'cn-beijing-MAZ2(f,g)'.\",\n\t\t\"zh\": \"通过指定 MAZ（多可用区）格式的 ZoneId（如'cn-beijing-MAZ2(f,g)'），将 API 网关实例部署在多可用区配置中。\",\n\t\t\"ja\": \"MAZ（マルチ AZ）形式の ZoneId（例：'cn-beijing-MAZ2(f,g)'）を指定して、API ゲートウェイインスタンスをマルチゾーン設定に展開します。\",\n\t\t\"de\": \"Stellen Sie die API Gateway-Instanz in einer Multi-Zonen-Konfiguration bereit, indem Sie eine ZoneId im MAZ (Multi-AZ) Format angeben, z. B. 'cn-beijing-MAZ2(f,g)'.\",\n\t\t\"es\": \"Implemente la instancia de API Gateway en una configuración multi-zona especificando un ZoneId con formato MAZ (Multi-AZ), como 'cn-beijing-MAZ2(f,g)'.\",\n\t\t\"fr\": \"Déployez l'instance API Gateway dans une configuration multi-zone en spécifiant un ZoneId au format MAZ (Multi-AZ), tel que 'cn-beijing-MAZ2(f,g)'.\",\n\t\t\"pt\": \"Implante a instância do API Gateway em uma configuração multi-zona especificando um ZoneId com formato MAZ (Multi-AZ), como 'cn-beijing-MAZ2(f,g)'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ApiGateway::Instance\"]\n}\n\n# Check if zone ID indicates multi-zone deployment\n# Multi-zone format: cn-region-MAZ#(zone1,zone2,...)\nis_multi_zone(zone_id) if {\n\tcontains(zone_id, \"MAZ\")\n\tcontains(zone_id, \"(\")\n\tcontains(zone_id, \")\")\n}\n\n# Check if instance is multi-zone\nhas_multi_zone_deployment(resource) if {\n\tzone_id := resource.Properties.ZoneId\n\tis_multi_zone(zone_id)\n}\n\n# Deny rule: API Gateway instances must be multi-zone\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ApiGateway::Instance\")\n\tnot has_multi_zone_deployment(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ZoneId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:bastionhost-instance-expired-check", Name: models.I18nString{"de": "BastionHost-Instanz Ablaufprüfung", "en": "BastionHost Instance Expiration Check", "es": "Verificación de Expiración de Instancia BastionHost", "fr": "Vérification d'Expiration d'Instance BastionHost", "ja": "BastionHost インスタンス有効期限チェック", "pt": "Verificação de Expiração de Instância BastionHost", "zh": "堡垒机实例到期检查"}, Severity: "high", Description: models.I18nString{"de": "Vorausbezahlte BastionHost-Instanzen sollten automatische Verlängerung aktiviert haben.", "en": "Prepaid BastionHost instances should have auto-renewal enabled.", "es": "Las instancias BastionHost prepagadas deben tener renovación automática habilitada.", "fr": "Les instances BastionHost prépayées doivent avoir le renouvellement automatique activé.", "ja": "プリペイド BastionHost インスタンスで自動更新が有効になっている必要があります。", "pt": "As instâncias BastionHost pré-pagas devem ter renovação automática habilitada.", "zh": "预付费堡垒机实例应开启自动续费，避免业务中断。"}, Reason: models.I18nString{"de": "Die vorausbezahlte BastionHost-Instanz hat keine automatische Verlängerung aktiviert.", "en": "The prepaid BastionHost instance does not have auto-renewal enabled.", "es": "La instancia BastionHost prepagada no tiene renovación automática habilitada.", "fr": "L'instance BastionHost prépayée n'a pas le renouvellement automatique activé.", "ja": "プリペイド BastionHost インスタンスで自動更新が有効になっていません。", "pt": "A instância BastionHost pré-paga não tem renovação automática habilitada.", "zh": "预付费堡垒机实例未开启自动续费。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Verlängerung für die vorausbezahlte BastionHost-Instanz, indem Sie AutoRenew auf true setzen.", "en": "Enable auto-renewal for the prepaid BastionHost instance by setting AutoRenew to true.", "es": "Habilite la renovación automática para la instancia BastionHost prepagada estableciendo AutoRenew en true.", "fr": "Activez le renouvellement automatique pour l'instance BastionHost prépayée en définissant AutoRenew sur true.", "ja": "AutoRenew を true に設定して、プリペイド BastionHost インスタンスの自動更新を有効にします。", "pt": "Habilite a renovação automática para a instância BastionHost pré-paga definindo AutoRenew como true.", "zh": "通过将 AutoRenew 设置为 true 为预付费堡垒机实例开启自动续费。"}, ResourceTypes: []string{"ALIYUN::BastionHost::Instance"}, FilePath: "aliyun/rules/bastionhost-instance-expired-check.rego", PackageName: "infraguard.rules.aliyun.bastionhost_instance_expired_check", Content: "package infraguard.rules.aliyun.bastionhost_instance_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"bastionhost-instance-expired-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"BastionHost Instance Expiration Check\",\n\t\t\"zh\": \"堡垒机实例到期检查\",\n\t\t\"ja\": \"BastionHost インスタンス有効期限チェック\",\n\t\t\"de\": \"BastionHost-Instanz Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Instancia BastionHost\",\n\t\t\"fr\": \"Vérification d'Expiration d'Instance BastionHost\",\n\t\t\"pt\": \"Verificação de Expiração de Instância BastionHost\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Prepaid BastionHost instances should have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费堡垒机实例应开启自动续费，避免业务中断。\",\n\t\t\"ja\": \"プリペイド BastionHost インスタンスで自動更新が有効になっている必要があります。\",\n\t\t\"de\": \"Vorausbezahlte BastionHost-Instanzen sollten automatische Verlängerung aktiviert haben.\",\n\t\t\"es\": \"Las instancias BastionHost prepagadas deben tener renovación automática habilitada.\",\n\t\t\"fr\": \"Les instances BastionHost prépayées doivent avoir le renouvellement automatique activé.\",\n\t\t\"pt\": \"As instâncias BastionHost pré-pagas devem ter renovação automática habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The prepaid BastionHost instance does not have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费堡垒机实例未开启自动续费。\",\n\t\t\"ja\": \"プリペイド BastionHost インスタンスで自動更新が有効になっていません。\",\n\t\t\"de\": \"Die vorausbezahlte BastionHost-Instanz hat keine automatische Verlängerung aktiviert.\",\n\t\t\"es\": \"La instancia BastionHost prepagada no tiene renovación automática habilitada.\",\n\t\t\"fr\": \"L'instance BastionHost prépayée n'a pas le renouvellement automatique activé.\",\n\t\t\"pt\": \"A instância BastionHost pré-paga não tem renovação automática habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for the prepaid BastionHost instance by setting AutoRenew to true.\",\n\t\t\"zh\": \"通过将 AutoRenew 设置为 true 为预付费堡垒机实例开启自动续费。\",\n\t\t\"ja\": \"AutoRenew を true に設定して、プリペイド BastionHost インスタンスの自動更新を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die automatische Verlängerung für die vorausbezahlte BastionHost-Instanz, indem Sie AutoRenew auf true setzen.\",\n\t\t\"es\": \"Habilite la renovación automática para la instancia BastionHost prepagada estableciendo AutoRenew en true.\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour l'instance BastionHost prépayée en définissant AutoRenew sur true.\",\n\t\t\"pt\": \"Habilite a renovação automática para a instância BastionHost pré-paga definindo AutoRenew como true.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::BastionHost::Instance\"]\n}\n\nis_prepaid(resource) if {\n\t# Check if Period is set, as it implies subscription\n\thelpers.has_property(resource, \"Period\")\n}\n\nis_auto_renew_enabled(resource) if {\n\tauto_renew := helpers.get_property(resource, \"AutoRenew\", false)\n\thelpers.is_true(auto_renew)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tis_prepaid(resource)\n\tnot is_auto_renew_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AutoRenew\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:bastionhost-instance-spec-check", Name: models.I18nString{"de": "BastionHost-Instanz Multi-Zone-Spezifikationsprüfung", "en": "BastionHost Instance Multi-Zone Spec Check", "es": "Verificación de Especificación Multi-Zona de Instancia BastionHost", "fr": "Vérification de Spécification Multi-Zone d'Instance BastionHost", "ja": "BastionHost インスタンスマルチゾーン仕様チェック", "pt": "Verificação de Especificação Multi-Zona de Instância BastionHost", "zh": "使用多可用区部署的堡垒机版本"}, Severity: "medium", Description: models.I18nString{"de": "Die BastionHost-Instanz sollte die Enterprise-Version verwenden, die Multi-Zone-Bereitstellung unterstützt.", "en": "The BastionHost instance should use the Enterprise version which supports multi-zone deployment.", "es": "La instancia BastionHost debe usar la versión Enterprise que admite despliegue multi-zona.", "fr": "L'instance BastionHost doit utiliser la version Enterprise qui prend en charge le déploiement multi-zone.", "ja": "BastionHost インスタンスは、マルチゾーン展開をサポートするエンタープライズバージョンを使用する必要があります。", "pt": "A instância BastionHost deve usar a versão Enterprise que suporta implantação multi-zona.", "zh": "使用多可用区部署的企业双擎或者国密版堡垒机，保障稳定性，视为合规。"}, Reason: models.I18nString{"de": "Die BastionHost-Instanz verwendet die Basic-Version, was eine Single-Zone-Bereitstellung impliziert.", "en": "The BastionHost instance is using the Basic version which implies single-zone deployment.", "es": "La instancia BastionHost está usando la versión Basic que implica despliegue de zona única.", "fr": "L'instance BastionHost utilise la version Basic qui implique un déploiement en zone unique.", "ja": "BastionHost インスタンスはシングルゾーン展開を意味するベーシックバージョンを使用しています。", "pt": "A instância BastionHost está usando a versão Basic que implica implantação de zona única.", "zh": "堡垒机实例使用的是不支持多可用区部署的基础版。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie die BastionHost-Instanz auf die Enterprise-Version.", "en": "Upgrade the BastionHost instance to the Enterprise version.", "es": "Actualice la instancia BastionHost a la versión Enterprise.", "fr": "Mettez à niveau l'instance BastionHost vers la version Enterprise.", "ja": "BastionHost インスタンスをエンタープライズバージョンにアップグレードします。", "pt": "Atualize a instância BastionHost para a versão Enterprise.", "zh": "将堡垒机实例升级到企业版。"}, ResourceTypes: []string{"ALIYUN::BastionHost::Instance"}, FilePath: "aliyun/rules/bastionhost-instance-spec-check.rego", PackageName: "infraguard.rules.aliyun.bastionhost_instance_spec_check", Content: "package infraguard.rules.aliyun.bastionhost_instance_spec_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"bastionhost-instance-spec-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"BastionHost Instance Multi-Zone Spec Check\",\n\t\t\"zh\": \"使用多可用区部署的堡垒机版本\",\n\t\t\"ja\": \"BastionHost インスタンスマルチゾーン仕様チェック\",\n\t\t\"de\": \"BastionHost-Instanz Multi-Zone-Spezifikationsprüfung\",\n\t\t\"es\": \"Verificación de Especificación Multi-Zona de Instancia BastionHost\",\n\t\t\"fr\": \"Vérification de Spécification Multi-Zone d'Instance BastionHost\",\n\t\t\"pt\": \"Verificação de Especificação Multi-Zona de Instância BastionHost\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"The BastionHost instance should use the Enterprise version which supports multi-zone deployment.\",\n\t\t\"zh\": \"使用多可用区部署的企业双擎或者国密版堡垒机，保障稳定性，视为合规。\",\n\t\t\"ja\": \"BastionHost インスタンスは、マルチゾーン展開をサポートするエンタープライズバージョンを使用する必要があります。\",\n\t\t\"de\": \"Die BastionHost-Instanz sollte die Enterprise-Version verwenden, die Multi-Zone-Bereitstellung unterstützt.\",\n\t\t\"es\": \"La instancia BastionHost debe usar la versión Enterprise que admite despliegue multi-zona.\",\n\t\t\"fr\": \"L'instance BastionHost doit utiliser la version Enterprise qui prend en charge le déploiement multi-zone.\",\n\t\t\"pt\": \"A instância BastionHost deve usar a versão Enterprise que suporta implantação multi-zona.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The BastionHost instance is using the Basic version which implies single-zone deployment.\",\n\t\t\"zh\": \"堡垒机实例使用的是不支持多可用区部署的基础版。\",\n\t\t\"ja\": \"BastionHost インスタンスはシングルゾーン展開を意味するベーシックバージョンを使用しています。\",\n\t\t\"de\": \"Die BastionHost-Instanz verwendet die Basic-Version, was eine Single-Zone-Bereitstellung impliziert.\",\n\t\t\"es\": \"La instancia BastionHost está usando la versión Basic que implica despliegue de zona única.\",\n\t\t\"fr\": \"L'instance BastionHost utilise la version Basic qui implique un déploiement en zone unique.\",\n\t\t\"pt\": \"A instância BastionHost está usando a versão Basic que implica implantação de zona única.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade the BastionHost instance to the Enterprise version.\",\n\t\t\"zh\": \"将堡垒机实例升级到企业版。\",\n\t\t\"ja\": \"BastionHost インスタンスをエンタープライズバージョンにアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie die BastionHost-Instanz auf die Enterprise-Version.\",\n\t\t\"es\": \"Actualice la instancia BastionHost a la versión Enterprise.\",\n\t\t\"fr\": \"Mettez à niveau l'instance BastionHost vers la version Enterprise.\",\n\t\t\"pt\": \"Atualize a instância BastionHost para a versão Enterprise.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::BastionHost::Instance\"]\n}\n\n# Check if instance is Enterprise version\nis_enterprise(resource) if {\n\tresource.Properties.Version == \"Enterprise\"\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_enterprise(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Version\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:cdn-domain-multiple-origin-servers", Name: models.I18nString{"de": "CDN-Domäne Mehrere Ursprungsserver", "en": "CDN Domain Multiple Origin Servers", "es": "Múltiples Servidores de Origen de Dominio CDN", "fr": "Plusieurs Serveurs d'Origine de Domaine CDN", "ja": "CDN ドメイン複数オリジンサーバー", "pt": "Múltiplos Servidores de Origem do Domínio CDN", "zh": "CDN 域名配置多个源站"}, Severity: "high", Description: models.I18nString{"de": "CDN-Domänen sollten mit mehreren Ursprungsservern für Hochverfügbarkeit und Fehlertoleranz konfiguriert werden.", "en": "CDN domains should be configured with multiple origin servers for high availability and fault tolerance.", "es": "Los dominios CDN deben configurarse con múltiples servidores de origen para alta disponibilidad y tolerancia a fallos.", "fr": "Les domaines CDN doivent être configurés avec plusieurs serveurs d'origine pour une haute disponibilité et une tolérance aux pannes.", "ja": "CDN ドメインは高可用性とフォールトトレランスのために複数のオリジンサーバーで設定する必要があります。", "pt": "Os domínios CDN devem ser configurados com múltiplos servidores de origem para alta disponibilidade e tolerância a falhas.", "zh": "CDN 域名配置多个源站，视为合规。"}, Reason: models.I18nString{"de": "Die CDN-Domäne ist nur mit einem Ursprungsserver konfiguriert, was einen Single Point of Failure schafft.", "en": "The CDN domain is configured with only one origin server, creating a single point of failure.", "es": "El dominio CDN está configurado con solo un servidor de origen, creando un punto único de falla.", "fr": "Le domaine CDN est configuré avec un seul serveur d'origine, créant un point de défaillance unique.", "ja": "CDN ドメインが 1 つのオリジンサーバーのみで設定されているため、単一障害点が作成されます。", "pt": "O domínio CDN está configurado com apenas um servidor de origem, criando um ponto único de falha.", "zh": "CDN 域名仅配置了一个源站，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie mindestens zwei Ursprungsserver in der Eigenschaft OriginServers, um Hochverfügbarkeit sicherzustellen.", "en": "Configure at least two origin servers in the OriginServers property to ensure high availability.", "es": "Configure al menos dos servidores de origen en la propiedad OriginServers para garantizar alta disponibilidad.", "fr": "Configurez au moins deux serveurs d'origine dans la propriété OriginServers pour assurer une haute disponibilité.", "ja": "高可用性を確保するために、OriginServers プロパティに少なくとも 2 つのオリジンサーバーを設定します。", "pt": "Configure pelo menos dois servidores de origem na propriedade OriginServers para garantir alta disponibilidade.", "zh": "在 OriginServers 属性中配置至少两个源站，以确保高可用性。"}, ResourceTypes: []string{"ALIYUN::CDN::Domain"}, FilePath: "aliyun/rules/cdn-domain-multiple-origin-servers.rego", PackageName: "infraguard.rules.aliyun.cdn_domain_multiple_origin_servers", Content: "package infraguard.rules.aliyun.cdn_domain_multiple_origin_servers\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"cdn-domain-multiple-origin-servers\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"CDN Domain Multiple Origin Servers\",\n\t\t\"zh\": \"CDN 域名配置多个源站\",\n\t\t\"ja\": \"CDN ドメイン複数オリジンサーバー\",\n\t\t\"de\": \"CDN-Domäne Mehrere Ursprungsserver\",\n\t\t\"es\": \"Múltiples Servidores de Origen de Dominio CDN\",\n\t\t\"fr\": \"Plusieurs Serveurs d'Origine de Domaine CDN\",\n\t\t\"pt\": \"Múltiplos Servidores de Origem do Domínio CDN\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"CDN domains should be configured with multiple origin servers for high availability and fault tolerance.\",\n\t\t\"zh\": \"CDN 域名配置多个源站，视为合规。\",\n\t\t\"ja\": \"CDN ドメインは高可用性とフォールトトレランスのために複数のオリジンサーバーで設定する必要があります。\",\n\t\t\"de\": \"CDN-Domänen sollten mit mehreren Ursprungsservern für Hochverfügbarkeit und Fehlertoleranz konfiguriert werden.\",\n\t\t\"es\": \"Los dominios CDN deben configurarse con múltiples servidores de origen para alta disponibilidad y tolerancia a fallos.\",\n\t\t\"fr\": \"Les domaines CDN doivent être configurés avec plusieurs serveurs d'origine pour une haute disponibilité et une tolérance aux pannes.\",\n\t\t\"pt\": \"Os domínios CDN devem ser configurados com múltiplos servidores de origem para alta disponibilidade e tolerância a falhas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The CDN domain is configured with only one origin server, creating a single point of failure.\",\n\t\t\"zh\": \"CDN 域名仅配置了一个源站，存在单点故障风险。\",\n\t\t\"ja\": \"CDN ドメインが 1 つのオリジンサーバーのみで設定されているため、単一障害点が作成されます。\",\n\t\t\"de\": \"Die CDN-Domäne ist nur mit einem Ursprungsserver konfiguriert, was einen Single Point of Failure schafft.\",\n\t\t\"es\": \"El dominio CDN está configurado con solo un servidor de origen, creando un punto único de falla.\",\n\t\t\"fr\": \"Le domaine CDN est configuré avec un seul serveur d'origine, créant un point de défaillance unique.\",\n\t\t\"pt\": \"O domínio CDN está configurado com apenas um servidor de origem, criando um ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure at least two origin servers in the OriginServers property to ensure high availability.\",\n\t\t\"zh\": \"在 OriginServers 属性中配置至少两个源站，以确保高可用性。\",\n\t\t\"ja\": \"高可用性を確保するために、OriginServers プロパティに少なくとも 2 つのオリジンサーバーを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie mindestens zwei Ursprungsserver in der Eigenschaft OriginServers, um Hochverfügbarkeit sicherzustellen.\",\n\t\t\"es\": \"Configure al menos dos servidores de origen en la propiedad OriginServers para garantizar alta disponibilidad.\",\n\t\t\"fr\": \"Configurez au moins deux serveurs d'origine dans la propriété OriginServers pour assurer une haute disponibilité.\",\n\t\t\"pt\": \"Configure pelo menos dois servidores de origem na propriedade OriginServers para garantir alta disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CDN::Domain\"]\n}\n\n# Check if domain has multiple origin servers\nhas_multiple_origin_servers(resource) if {\n\torigin_servers := resource.Properties.OriginServers\n\tcount(origin_servers) >= 2\n}\n\n# Deny rule: CDN domains must have multiple origin servers\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CDN::Domain\")\n\tnot has_multiple_origin_servers(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"OriginServers\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:cen-cross-region-bandwidth-check", Name: models.I18nString{"de": "CEN Cross-Region Bandbreitenprüfung", "en": "CEN Cross-Region Bandwidth Check", "es": "Verificación de Ancho de Banda Inter-Región CEN", "fr": "Vérification de la Bande Passante Inter-Région CEN", "ja": "CEN クロスリージョンバンド幅チェック", "pt": "Verificação de Largura de Banda Inter-Região CEN", "zh": "CEN 实例中的跨地域连接带宽分配满足指定要求"}, Severity: "medium", Description: models.I18nString{"de": "CEN-Instanz Cross-Region-Verbindungen sollten ausreichende Bandbreitenzuweisung haben, um Leistungsanforderungen zu erfüllen.", "en": "CEN instance cross-region connections should have sufficient bandwidth allocation to meet performance requirements.", "es": "Las conexiones inter-región de instancia CEN deben tener asignación de ancho de banda suficiente para cumplir con los requisitos de rendimiento.", "fr": "Les connexions inter-région d'instance CEN doivent avoir une allocation de bande passante suffisante pour répondre aux exigences de performance.", "ja": "CEN インスタンスのクロスリージョン接続は、パフォーマンス要件を満たすために十分な帯域幅割り当てを持つ必要があります。", "pt": "As conexões inter-região da instância CEN devem ter alocação de largura de banda suficiente para atender aos requisitos de desempenho.", "zh": "云企业网实例下所有跨地域连接分配的带宽大于参数指定值，视为合规。"}, Reason: models.I18nString{"de": "Unzureichende Cross-Region-Bandbreite kann zu Leistungsengpässen und verschlechterter Anwendungsleistung führen.", "en": "Insufficient cross-region bandwidth can lead to performance bottlenecks and degraded application performance.", "es": "El ancho de banda inter-región insuficiente puede provocar cuellos de botella de rendimiento y degradación del rendimiento de la aplicación.", "fr": "Une bande passante inter-région insuffisante peut entraîner des goulots d'étranglement de performance et une dégradation des performances de l'application.", "ja": "不十分なクロスリージョンバンド幅は、パフォーマンスのボトルネックやアプリケーションパフォーマンスの低下につながる可能性があります。", "pt": "Largura de banda inter-região insuficiente pode levar a gargalos de desempenho e degradação do desempenho da aplicação.", "zh": "不足的跨地域带宽可能导致性能瓶颈和应用程序性能下降。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass Cross-Region-Verbindungen eine Bandbreitenzuweisung über dem angegebenen Mindestschwellenwert haben (Standard: 1Mbps).", "en": "Ensure cross-region connections have bandwidth allocation above the specified minimum threshold (default: 1Mbps).", "es": "Asegúrese de que las conexiones inter-región tengan asignación de ancho de banda por encima del umbral mínimo especificado (predeterminado: 1Mbps).", "fr": "Assurez-vous que les connexions inter-région ont une allocation de bande passante supérieure au seuil minimum spécifié (par défaut : 1Mbps).", "ja": "クロスリージョン接続の帯域幅割り当てが指定された最小しきい値（デフォルト：1Mbps）を超えていることを確認します。", "pt": "Garanta que as conexões inter-região tenham alocação de largura de banda acima do limite mínimo especificado (padrão: 1Mbps).", "zh": "确保跨地域连接的带宽分配高于指定的最小阈值（默认：1Mbps）。"}, ResourceTypes: []string{"ALIYUN::CEN::CenInstance"}, FilePath: "aliyun/rules/cen-cross-region-bandwidth-check.rego", PackageName: "infraguard.rules.aliyun.cen_cross_region_bandwidth_check", Content: "package infraguard.rules.aliyun.cen_cross_region_bandwidth_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"cen-cross-region-bandwidth-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"CEN Cross-Region Bandwidth Check\",\n\t\t\"zh\": \"CEN 实例中的跨地域连接带宽分配满足指定要求\",\n\t\t\"ja\": \"CEN クロスリージョンバンド幅チェック\",\n\t\t\"de\": \"CEN Cross-Region Bandbreitenprüfung\",\n\t\t\"es\": \"Verificación de Ancho de Banda Inter-Región CEN\",\n\t\t\"fr\": \"Vérification de la Bande Passante Inter-Région CEN\",\n\t\t\"pt\": \"Verificação de Largura de Banda Inter-Região CEN\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"CEN instance cross-region connections should have sufficient bandwidth allocation to meet performance requirements.\",\n\t\t\"zh\": \"云企业网实例下所有跨地域连接分配的带宽大于参数指定值，视为合规。\",\n\t\t\"ja\": \"CEN インスタンスのクロスリージョン接続は、パフォーマンス要件を満たすために十分な帯域幅割り当てを持つ必要があります。\",\n\t\t\"de\": \"CEN-Instanz Cross-Region-Verbindungen sollten ausreichende Bandbreitenzuweisung haben, um Leistungsanforderungen zu erfüllen.\",\n\t\t\"es\": \"Las conexiones inter-región de instancia CEN deben tener asignación de ancho de banda suficiente para cumplir con los requisitos de rendimiento.\",\n\t\t\"fr\": \"Les connexions inter-région d'instance CEN doivent avoir une allocation de bande passante suffisante pour répondre aux exigences de performance.\",\n\t\t\"pt\": \"As conexões inter-região da instância CEN devem ter alocação de largura de banda suficiente para atender aos requisitos de desempenho.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Insufficient cross-region bandwidth can lead to performance bottlenecks and degraded application performance.\",\n\t\t\"zh\": \"不足的跨地域带宽可能导致性能瓶颈和应用程序性能下降。\",\n\t\t\"ja\": \"不十分なクロスリージョンバンド幅は、パフォーマンスのボトルネックやアプリケーションパフォーマンスの低下につながる可能性があります。\",\n\t\t\"de\": \"Unzureichende Cross-Region-Bandbreite kann zu Leistungsengpässen und verschlechterter Anwendungsleistung führen.\",\n\t\t\"es\": \"El ancho de banda inter-región insuficiente puede provocar cuellos de botella de rendimiento y degradación del rendimiento de la aplicación.\",\n\t\t\"fr\": \"Une bande passante inter-région insuffisante peut entraîner des goulots d'étranglement de performance et une dégradation des performances de l'application.\",\n\t\t\"pt\": \"Largura de banda inter-região insuficiente pode levar a gargalos de desempenho e degradação do desempenho da aplicação.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure cross-region connections have bandwidth allocation above the specified minimum threshold (default: 1Mbps).\",\n\t\t\"zh\": \"确保跨地域连接的带宽分配高于指定的最小阈值（默认：1Mbps）。\",\n\t\t\"ja\": \"クロスリージョン接続の帯域幅割り当てが指定された最小しきい値（デフォルト：1Mbps）を超えていることを確認します。\",\n\t\t\"de\": \"Stellen Sie sicher, dass Cross-Region-Verbindungen eine Bandbreitenzuweisung über dem angegebenen Mindestschwellenwert haben (Standard: 1Mbps).\",\n\t\t\"es\": \"Asegúrese de que las conexiones inter-región tengan asignación de ancho de banda por encima del umbral mínimo especificado (predeterminado: 1Mbps).\",\n\t\t\"fr\": \"Assurez-vous que les connexions inter-région ont une allocation de bande passante supérieure au seuil minimum spécifié (par défaut : 1Mbps).\",\n\t\t\"pt\": \"Garanta que as conexões inter-região tenham alocação de largura de banda acima do limite mínimo especificado (padrão: 1Mbps).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CEN::CenInstance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CEN::CenInstance\")\n\n\t# Cross-resource check would examine CenBandwidthPackage associations\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:clickhouse-dbcluster-multi-zone", Name: models.I18nString{"de": "ClickHouse DBCluster Multi-Zone-Bereitstellung", "en": "ClickHouse DBCluster Multi-Zone Deployment", "es": "Despliegue Multi-Zona de ClickHouse DBCluster", "fr": "Déploiement Multi-Zone ClickHouse DBCluster", "ja": "ClickHouse DBCluster マルチゾーン展開", "pt": "Implantações Multi-Zona do ClickHouse DBCluster", "zh": "使用多可用区的 ClickHouse 集群实例"}, Severity: "medium", Description: models.I18nString{"de": "ClickHouse-Cluster sollten die HighAvailability (Double-Replica) Edition für Multi-Zone-Bereitstellung verwenden. Hinweis: Dies gilt nur für die Community-Edition.", "en": "ClickHouse clusters should use the HighAvailability (Double-replica) edition for multi-zone deployment. Note: This applies only to community edition.", "es": "Los clústeres ClickHouse deben usar la edición HighAvailability (Double-replica) para despliegue multi-zona. Nota: Esto se aplica solo a la edición comunitaria.", "fr": "Les clusters ClickHouse doivent utiliser l'édition HighAvailability (Double-replica) pour le déploiement multi-zone. Note : Cela s'applique uniquement à l'édition communautaire.", "ja": "ClickHouse クラスタはマルチゾーン展開に HighAvailability（ダブルレプリカ）エディションを使用する必要があります。注：これはコミュニティエディションにのみ適用されます。", "pt": "Os clusters ClickHouse devem usar a edição HighAvailability (Double-replica) para implantação multi-zona. Nota: Isso se aplica apenas à edição da comunidade.", "zh": "使用多可用区的 ClickHouse 集群实例，视为合规，注意只包含社区版本。"}, Reason: models.I18nString{"de": "Der ClickHouse-Cluster verwendet die Single-Replica-Edition, die keine Multi-Zone-Hochverfügbarkeit bietet.", "en": "The ClickHouse cluster is using Single-replica Edition, which does not provide multi-zone high availability.", "es": "El clúster ClickHouse está usando la edición Single-replica, que no proporciona alta disponibilidad multi-zona.", "fr": "Le cluster ClickHouse utilise l'édition Single-replica, qui ne fournit pas de haute disponibilité multi-zone.", "ja": "ClickHouse クラスタはシングルレプリカエディションを使用しており、マルチゾーン高可用性を提供しません。", "pt": "O cluster ClickHouse está usando a edição Single-replica, que não fornece alta disponibilidade multi-zona.", "zh": "ClickHouse 集群使用单副本版本，不提供多可用区高可用性。"}, Recommendation: models.I18nString{"de": "Verwenden Sie die HighAvailability (Double-Replica) Edition, indem Sie Category auf 'HighAvailability' setzen für Multi-Zone-Bereitstellung.", "en": "Use the HighAvailability (Double-replica) edition by setting Category to 'HighAvailability' for multi-zone deployment.", "es": "Use la edición HighAvailability (Double-replica) estableciendo Category en 'HighAvailability' para despliegue multi-zona.", "fr": "Utilisez l'édition HighAvailability (Double-replica) en définissant Category sur 'HighAvailability' pour le déploiement multi-zone.", "ja": "マルチゾーン展開のために、Category を 'HighAvailability' に設定して HighAvailability（ダブルレプリカ）エディションを使用します。", "pt": "Use a edição HighAvailability (Double-replica) definindo Category como 'HighAvailability' para implantação multi-zona.", "zh": "通过将 Category 设置为'HighAvailability'来使用双副本版本，实现多可用区部署。"}, ResourceTypes: []string{"ALIYUN::ClickHouse::DBCluster"}, FilePath: "aliyun/rules/clickhouse-dbcluster-multi-zone.rego", PackageName: "infraguard.rules.aliyun.clickhouse_dbcluster_multi_zone", Content: "package infraguard.rules.aliyun.clickhouse_dbcluster_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"clickhouse-dbcluster-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ClickHouse DBCluster Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的 ClickHouse 集群实例\",\n\t\t\"ja\": \"ClickHouse DBCluster マルチゾーン展開\",\n\t\t\"de\": \"ClickHouse DBCluster Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de ClickHouse DBCluster\",\n\t\t\"fr\": \"Déploiement Multi-Zone ClickHouse DBCluster\",\n\t\t\"pt\": \"Implantações Multi-Zona do ClickHouse DBCluster\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ClickHouse clusters should use the HighAvailability (Double-replica) edition for multi-zone deployment. Note: This applies only to community edition.\",\n\t\t\"zh\": \"使用多可用区的 ClickHouse 集群实例，视为合规，注意只包含社区版本。\",\n\t\t\"ja\": \"ClickHouse クラスタはマルチゾーン展開に HighAvailability（ダブルレプリカ）エディションを使用する必要があります。注：これはコミュニティエディションにのみ適用されます。\",\n\t\t\"de\": \"ClickHouse-Cluster sollten die HighAvailability (Double-Replica) Edition für Multi-Zone-Bereitstellung verwenden. Hinweis: Dies gilt nur für die Community-Edition.\",\n\t\t\"es\": \"Los clústeres ClickHouse deben usar la edición HighAvailability (Double-replica) para despliegue multi-zona. Nota: Esto se aplica solo a la edición comunitaria.\",\n\t\t\"fr\": \"Les clusters ClickHouse doivent utiliser l'édition HighAvailability (Double-replica) pour le déploiement multi-zone. Note : Cela s'applique uniquement à l'édition communautaire.\",\n\t\t\"pt\": \"Os clusters ClickHouse devem usar a edição HighAvailability (Double-replica) para implantação multi-zona. Nota: Isso se aplica apenas à edição da comunidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ClickHouse cluster is using Single-replica Edition, which does not provide multi-zone high availability.\",\n\t\t\"zh\": \"ClickHouse 集群使用单副本版本，不提供多可用区高可用性。\",\n\t\t\"ja\": \"ClickHouse クラスタはシングルレプリカエディションを使用しており、マルチゾーン高可用性を提供しません。\",\n\t\t\"de\": \"Der ClickHouse-Cluster verwendet die Single-Replica-Edition, die keine Multi-Zone-Hochverfügbarkeit bietet.\",\n\t\t\"es\": \"El clúster ClickHouse está usando la edición Single-replica, que no proporciona alta disponibilidad multi-zona.\",\n\t\t\"fr\": \"Le cluster ClickHouse utilise l'édition Single-replica, qui ne fournit pas de haute disponibilité multi-zone.\",\n\t\t\"pt\": \"O cluster ClickHouse está usando a edição Single-replica, que não fornece alta disponibilidade multi-zona.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use the HighAvailability (Double-replica) edition by setting Category to 'HighAvailability' for multi-zone deployment.\",\n\t\t\"zh\": \"通过将 Category 设置为'HighAvailability'来使用双副本版本，实现多可用区部署。\",\n\t\t\"ja\": \"マルチゾーン展開のために、Category を 'HighAvailability' に設定して HighAvailability（ダブルレプリカ）エディションを使用します。\",\n\t\t\"de\": \"Verwenden Sie die HighAvailability (Double-Replica) Edition, indem Sie Category auf 'HighAvailability' setzen für Multi-Zone-Bereitstellung.\",\n\t\t\"es\": \"Use la edición HighAvailability (Double-replica) estableciendo Category en 'HighAvailability' para despliegue multi-zona.\",\n\t\t\"fr\": \"Utilisez l'édition HighAvailability (Double-replica) en définissant Category sur 'HighAvailability' pour le déploiement multi-zone.\",\n\t\t\"pt\": \"Use a edição HighAvailability (Double-replica) definindo Category como 'HighAvailability' para implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ClickHouse::DBCluster\"]\n}\n\n# Check if cluster is high availability (multi-zone)\nis_high_availability(resource) if {\n\tcategory := resource.Properties.Category\n\tcategory == \"HighAvailability\"\n}\n\n# Deny rule: ClickHouse clusters should use HighAvailability edition\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ClickHouse::DBCluster\")\n\tnot is_high_availability(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Category\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:cr-instance-any-ip-access-check", Name: models.I18nString{"de": "CR-Instanz Kein Beliebiger IP-Zugriff", "en": "CR Instance No Any IP Access", "es": "Instancia CR Sin Acceso de Cualquier IP", "fr": "Instance CR Sans Accès IP Quelconque", "ja": "CR インスタンスに任意の IP アクセスがない", "pt": "Instância CR Sem Acesso de Qualquer IP", "zh": "容器镜像服务实例白名单检测"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Container Registry-Instanzen keine beliebige IP (0.0.0.0/0) in ihrer Whitelist haben.", "en": "Ensures Container Registry instances do not have any IP (0.0.0.0/0) in their whitelist.", "es": "Garantiza que las instancias de Container Registry no tengan ninguna IP (0.0.0.0/0) en su lista blanca.", "fr": "Garantit que les instances Container Registry n'ont pas d'IP quelconque (0.0.0.0/0) dans leur liste blanche.", "ja": "コンテナレジストリインスタンスのホワイトリストに任意の IP（0.0.0.0/0）が含まれていないことを確認します。", "pt": "Garante que as instâncias do Container Registry não tenham qualquer IP (0.0.0.0/0) em sua lista branca.", "zh": "确保容器镜像服务实例的白名单中不包含任意 IP（0.0.0.0/0）。"}, Reason: models.I18nString{"de": "Das Zulassen beliebiger IPs (0.0.0.0/0) in der Whitelist setzt die Container Registry potenziell unbefugtem Zugriff von jedem Internetbenutzer aus.", "en": "Allowing any IP (0.0.0.0/0) in the whitelist exposes the container registry to potential unauthorized access from any internet user.", "es": "Permitir cualquier IP (0.0.0.0/0) en la lista blanca expone el registro de contenedores a acceso no autorizado potencial de cualquier usuario de Internet.", "fr": "Autoriser n'importe quelle IP (0.0.0.0/0) dans la liste blanche expose le registre de conteneurs à un accès non autorisé potentiel de n'importe quel utilisateur Internet.", "ja": "ホワイトリストで任意の IP（0.0.0.0/0）を許可すると、コンテナレジストリが任意のインターネットユーザーからの不正アクセスのリスクにさらされます。", "pt": "Permitir qualquer IP (0.0.0.0/0) na lista branca expõe o registro de contêineres a acesso não autorizado potencial de qualquer usuário da Internet.", "zh": "在白名单中允许任意 IP（0.0.0.0/0）会使容器镜像服务面临来自任何互联网用户的潜在未授权访问风险。"}, Recommendation: models.I18nString{"de": "Entfernen Sie 0.0.0.0/0 aus der Whitelist und geben Sie spezifische IP-Bereiche an.", "en": "Remove 0.0.0.0/0 from the whitelist and specify specific IP ranges.", "es": "Elimine 0.0.0.0/0 de la lista blanca y especifique rangos de IP específicos.", "fr": "Supprimez 0.0.0.0/0 de la liste blanche et spécifiez des plages d'IP spécifiques.", "ja": "ホワイトリストから 0.0.0.0/0 を削除し、特定の IP 範囲を指定します。", "pt": "Remova 0.0.0.0/0 da lista branca e especifique intervalos de IP específicos.", "zh": "从白名单中移除 0.0.0.0/0，并指定具体的 IP 范围。"}, ResourceTypes: []string{"ALIYUN::CR::Instance"}, FilePath: "aliyun/rules/cr-instance-any-ip-access-check.rego", PackageName: "infraguard.rules.aliyun.cr_instance_any_ip_access_check", Content: "package infraguard.rules.aliyun.cr_instance_any_ip_access_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"cr-instance-any-ip-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"CR Instance No Any IP Access\",\n\t\t\"zh\": \"容器镜像服务实例白名单检测\",\n\t\t\"ja\": \"CR インスタンスに任意の IP アクセスがない\",\n\t\t\"de\": \"CR-Instanz Kein Beliebiger IP-Zugriff\",\n\t\t\"es\": \"Instancia CR Sin Acceso de Cualquier IP\",\n\t\t\"fr\": \"Instance CR Sans Accès IP Quelconque\",\n\t\t\"pt\": \"Instância CR Sem Acesso de Qualquer IP\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Container Registry instances do not have any IP (0.0.0.0/0) in their whitelist.\",\n\t\t\"zh\": \"确保容器镜像服务实例的白名单中不包含任意 IP（0.0.0.0/0）。\",\n\t\t\"ja\": \"コンテナレジストリインスタンスのホワイトリストに任意の IP（0.0.0.0/0）が含まれていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Container Registry-Instanzen keine beliebige IP (0.0.0.0/0) in ihrer Whitelist haben.\",\n\t\t\"es\": \"Garantiza que las instancias de Container Registry no tengan ninguna IP (0.0.0.0/0) en su lista blanca.\",\n\t\t\"fr\": \"Garantit que les instances Container Registry n'ont pas d'IP quelconque (0.0.0.0/0) dans leur liste blanche.\",\n\t\t\"pt\": \"Garante que as instâncias do Container Registry não tenham qualquer IP (0.0.0.0/0) em sua lista branca.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Allowing any IP (0.0.0.0/0) in the whitelist exposes the container registry to potential unauthorized access from any internet user.\",\n\t\t\"zh\": \"在白名单中允许任意 IP（0.0.0.0/0）会使容器镜像服务面临来自任何互联网用户的潜在未授权访问风险。\",\n\t\t\"ja\": \"ホワイトリストで任意の IP（0.0.0.0/0）を許可すると、コンテナレジストリが任意のインターネットユーザーからの不正アクセスのリスクにさらされます。\",\n\t\t\"de\": \"Das Zulassen beliebiger IPs (0.0.0.0/0) in der Whitelist setzt die Container Registry potenziell unbefugtem Zugriff von jedem Internetbenutzer aus.\",\n\t\t\"es\": \"Permitir cualquier IP (0.0.0.0/0) en la lista blanca expone el registro de contenedores a acceso no autorizado potencial de cualquier usuario de Internet.\",\n\t\t\"fr\": \"Autoriser n'importe quelle IP (0.0.0.0/0) dans la liste blanche expose le registre de conteneurs à un accès non autorisé potentiel de n'importe quel utilisateur Internet.\",\n\t\t\"pt\": \"Permitir qualquer IP (0.0.0.0/0) na lista branca expõe o registro de contêineres a acesso não autorizado potencial de qualquer usuário da Internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove 0.0.0.0/0 from the whitelist and specify specific IP ranges.\",\n\t\t\"zh\": \"从白名单中移除 0.0.0.0/0，并指定具体的 IP 范围。\",\n\t\t\"ja\": \"ホワイトリストから 0.0.0.0/0 を削除し、特定の IP 範囲を指定します。\",\n\t\t\"de\": \"Entfernen Sie 0.0.0.0/0 aus der Whitelist und geben Sie spezifische IP-Bereiche an.\",\n\t\t\"es\": \"Elimine 0.0.0.0/0 de la lista blanca y especifique rangos de IP específicos.\",\n\t\t\"fr\": \"Supprimez 0.0.0.0/0 de la liste blanche et spécifiez des plages d'IP spécifiques.\",\n\t\t\"pt\": \"Remova 0.0.0.0/0 da lista branca e especifique intervalos de IP específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CR::Instance\"]\n}\n\n# Check if any ACL policy has 0.0.0.0/0 and is associated with a CR instance\nhas_any_ip_access(cr_instance_name) if {\n\tsome acl_name, acl_resource in helpers.resources_by_type(\"ALIYUN::CR::InstanceEndpointAclPolicy\")\n\n\t# Check if the entry is 0.0.0.0/0 (any IP)\n\tentry := helpers.get_property(acl_resource, \"Entry\", \"\")\n\tentry == \"0.0.0.0/0\"\n\n\t# Get the instance ID from the ACL policy (could be a GetAtt reference or string)\n\tinstance_id_prop := helpers.get_property(acl_resource, \"InstanceId\", \"\")\n\n\t# Check if InstanceId is a GetAtt reference pointing to this CR instance\n\thelpers.is_get_att_referencing(instance_id_prop, cr_instance_name)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CR::Instance\")\n\thas_any_ip_access(name)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:cr-instance-multi-zone", Name: models.I18nString{"de": "CR-Instanz mit zonenredundantem OSS-Bucket", "en": "CR Instance with Zone-Redundant OSS Bucket", "es": "Instancia CR con Bucket OSS Redundante de Zona", "fr": "Instance CR avec Bucket OSS Redondant par Zone", "ja": "ゾーン冗長 OSS バケットを持つ CR インスタンス", "pt": "Instância CR com Bucket OSS Redundante de Zona", "zh": "关联同城冗余的 oss 桶的容器镜像实例"}, Severity: "medium", Description: models.I18nString{"de": "Container Registry-Instanzen sollten mit zonenredundanten OSS-Buckets für Hochverfügbarkeit verknüpft werden.", "en": "Container Registry instances should be associated with zone-redundant OSS buckets for high availability.", "es": "Las instancias de Container Registry deben estar asociadas con buckets OSS redundantes de zona para alta disponibilidad.", "fr": "Les instances Container Registry doivent être associées à des buckets OSS redondants par zone pour une haute disponibilité.", "ja": "コンテナレジストリインスタンスは、高可用性のためにゾーン冗長 OSS バケットに関連付けられる必要があります。", "pt": "As instâncias do Container Registry devem estar associadas a buckets OSS redundantes de zona para alta disponibilidade.", "zh": "关联同城冗余的 oss 桶的容器镜像实例，视为合规。"}, Reason: models.I18nString{"de": "Die Container Registry-Instanz ist mit einem nicht redundanten OSS-Bucket verknüpft, was die Verfügbarkeit beeinträchtigen kann.", "en": "The Container Registry instance is associated with a non-redundant OSS bucket, which may affect availability.", "es": "La instancia de Container Registry está asociada con un bucket OSS no redundante, lo que puede afectar la disponibilidad.", "fr": "L'instance Container Registry est associée à un bucket OSS non redondant, ce qui peut affecter la disponibilité.", "ja": "コンテナレジストリインスタンスが非冗長 OSS バケットに関連付けられているため、可用性に影響を与える可能性があります。", "pt": "A instância do Container Registry está associada a um bucket OSS não redundante, o que pode afetar a disponibilidade.", "zh": "容器镜像实例关联的 OSS 桶不是同城冗余类型，可能影响可用性。"}, Recommendation: models.I18nString{"de": "Verknüpfen Sie die Container Registry-Instanz mit einem OSS-Bucket, der zonenredundanten Speicher (ZRS) aktiviert hat.", "en": "Associate the Container Registry instance with an OSS bucket that has zone-redundant storage (ZRS) enabled.", "es": "Asocie la instancia de Container Registry con un bucket OSS que tenga almacenamiento redundante de zona (ZRS) habilitado.", "fr": "Associez l'instance Container Registry à un bucket OSS qui a le stockage redondant par zone (ZRS) activé.", "ja": "ゾーン冗長ストレージ（ZRS）が有効な OSS バケットにコンテナレジストリインスタンスを関連付けます。", "pt": "Associe a instância do Container Registry a um bucket OSS que tenha armazenamento redundante de zona (ZRS) habilitado.", "zh": "将容器镜像实例关联到启用了同城冗余存储（ZRS）的 OSS 桶。"}, ResourceTypes: []string{"ALIYUN::CR::Instance"}, FilePath: "aliyun/rules/cr-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.cr_instance_multi_zone", Content: "package infraguard.rules.aliyun.cr_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"cr-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"CR Instance with Zone-Redundant OSS Bucket\",\n\t\t\"zh\": \"关联同城冗余的 oss 桶的容器镜像实例\",\n\t\t\"ja\": \"ゾーン冗長 OSS バケットを持つ CR インスタンス\",\n\t\t\"de\": \"CR-Instanz mit zonenredundantem OSS-Bucket\",\n\t\t\"es\": \"Instancia CR con Bucket OSS Redundante de Zona\",\n\t\t\"fr\": \"Instance CR avec Bucket OSS Redondant par Zone\",\n\t\t\"pt\": \"Instância CR com Bucket OSS Redundante de Zona\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Container Registry instances should be associated with zone-redundant OSS buckets for high availability.\",\n\t\t\"zh\": \"关联同城冗余的 oss 桶的容器镜像实例，视为合规。\",\n\t\t\"ja\": \"コンテナレジストリインスタンスは、高可用性のためにゾーン冗長 OSS バケットに関連付けられる必要があります。\",\n\t\t\"de\": \"Container Registry-Instanzen sollten mit zonenredundanten OSS-Buckets für Hochverfügbarkeit verknüpft werden.\",\n\t\t\"es\": \"Las instancias de Container Registry deben estar asociadas con buckets OSS redundantes de zona para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances Container Registry doivent être associées à des buckets OSS redondants par zone pour une haute disponibilité.\",\n\t\t\"pt\": \"As instâncias do Container Registry devem estar associadas a buckets OSS redundantes de zona para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The Container Registry instance is associated with a non-redundant OSS bucket, which may affect availability.\",\n\t\t\"zh\": \"容器镜像实例关联的 OSS 桶不是同城冗余类型，可能影响可用性。\",\n\t\t\"ja\": \"コンテナレジストリインスタンスが非冗長 OSS バケットに関連付けられているため、可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Die Container Registry-Instanz ist mit einem nicht redundanten OSS-Bucket verknüpft, was die Verfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"La instancia de Container Registry está asociada con un bucket OSS no redundante, lo que puede afectar la disponibilidad.\",\n\t\t\"fr\": \"L'instance Container Registry est associée à un bucket OSS non redondant, ce qui peut affecter la disponibilité.\",\n\t\t\"pt\": \"A instância do Container Registry está associada a um bucket OSS não redundante, o que pode afetar a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Associate the Container Registry instance with an OSS bucket that has zone-redundant storage (ZRS) enabled.\",\n\t\t\"zh\": \"将容器镜像实例关联到启用了同城冗余存储（ZRS）的 OSS 桶。\",\n\t\t\"ja\": \"ゾーン冗長ストレージ（ZRS）が有効な OSS バケットにコンテナレジストリインスタンスを関連付けます。\",\n\t\t\"de\": \"Verknüpfen Sie die Container Registry-Instanz mit einem OSS-Bucket, der zonenredundanten Speicher (ZRS) aktiviert hat.\",\n\t\t\"es\": \"Asocie la instancia de Container Registry con un bucket OSS que tenga almacenamiento redundante de zona (ZRS) habilitado.\",\n\t\t\"fr\": \"Associez l'instance Container Registry à un bucket OSS qui a le stockage redondant par zone (ZRS) activé.\",\n\t\t\"pt\": \"Associe a instância do Container Registry a um bucket OSS que tenha armazenamento redundante de zona (ZRS) habilitado.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CR::Instance\"]\n}\n\n# Get OSS bucket name from CR instance (handle both direct string and Ref)\nget_oss_bucket_name(cr_instance) := bucket_name if {\n\tstorage_name := cr_instance.Properties.InstanceStorageName\n\tis_string(storage_name)\n\tbucket_name := storage_name\n}\n\nget_oss_bucket_name(cr_instance) := bucket_name if {\n\tstorage_name := cr_instance.Properties.InstanceStorageName\n\tis_object(storage_name)\n\tbucket_name := storage_name.Ref\n}\n\n# Check if associated OSS bucket is zone-redundant\nhas_zone_redundant_oss(cr_instance_name) if {\n\tbucket_name := get_oss_bucket_name(input.Resources[cr_instance_name])\n\n\t# Find the OSS bucket resource\n\tsome oss_name, oss_resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\toss_name == bucket_name\n\n\t# Check if storage class is ZRS (Zone-Redundant Storage)\n\tstorage_class := helpers.get_property(oss_resource, \"StorageClass\", \"Standard\")\n\tstorage_class == \"ZRS\"\n}\n\n# Deny rule: CR instances must be associated with zone-redundant OSS buckets\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CR::Instance\")\n\n\t# Only check if custom OSS bucket is specified\n\thelpers.has_property(resource, \"InstanceStorageName\")\n\n\t# Check if not zone-redundant\n\tnot has_zone_redundant_oss(name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InstanceStorageName\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:cr-repository-image-scanning-enabled", Name: models.I18nString{"de": "CR-Instanz Bild-Scanning aktiviert", "en": "CR Instance Image Scanning Enabled", "es": "Escaneo de Imagen de Instancia CR Habilitado", "fr": "Balayage d'Image d'Instance CR Activé", "ja": "CR インスタンスイメージスキャンが有効", "pt": "Varredura de Imagem de Instância CR Habilitada", "zh": "为容器镜像实例开启安全扫描"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Container Registry-Instanzen Bild-Scanning für die Erkennung von Sicherheitslücken aktiviert haben.", "en": "Ensures Container Registry instances have image scanning enabled for security vulnerability detection.", "es": "Garantiza que las instancias de Container Registry tengan escaneo de imágenes habilitado para la detección de vulnerabilidades de seguridad.", "fr": "Garantit que les instances Container Registry ont le balayage d'images activé pour la détection des vulnérabilités de sécurité.", "ja": "コンテナレジストリインスタンスでセキュリティ脆弱性検出のためにイメージスキャンが有効になっていることを確認します。", "pt": "Garante que as instâncias do Container Registry tenham varredura de imagem habilitada para detecção de vulnerabilidades de segurança.", "zh": "确保容器镜像实例开启了镜像安全扫描功能以检测安全漏洞。"}, Reason: models.I18nString{"de": "Bild-Scanning hilft dabei, die Bereitstellung anfälliger Container-Images zu identifizieren und zu verhindern.", "en": "Image scanning helps identify and prevent deployment of vulnerable container images.", "es": "El escaneo de imágenes ayuda a identificar y prevenir el despliegue de imágenes de contenedor vulnerables.", "fr": "Le balayage d'images aide à identifier et empêcher le déploiement d'images de conteneurs vulnérables.", "ja": "イメージスキャンは、脆弱なコンテナイメージの展開を識別および防止するのに役立ちます。", "pt": "A varredura de imagem ajuda a identificar e prevenir a implantação de imagens de contêiner vulneráveis.", "zh": "镜像扫描有助于识别和防止部署有漏洞的容器镜像。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Bild-Scanning für die Container Registry-Instanz.", "en": "Enable image scanning for the Container Registry instance.", "es": "Habilite el escaneo de imágenes para la instancia de Container Registry.", "fr": "Activez le balayage d'images pour l'instance Container Registry.", "ja": "コンテナレジストリインスタンスのイメージスキャンを有効にします。", "pt": "Habilite a varredura de imagem para a instância do Container Registry.", "zh": "为容器镜像实例启用镜像扫描功能。"}, ResourceTypes: []string{"ALIYUN::CR::Instance"}, FilePath: "aliyun/rules/cr-repository-image-scanning-enabled.rego", PackageName: "infraguard.rules.aliyun.cr_repository_image_scanning_enabled", Content: "package infraguard.rules.aliyun.cr_repository_image_scanning_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"cr-repository-image-scanning-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"CR Instance Image Scanning Enabled\",\n\t\t\"zh\": \"为容器镜像实例开启安全扫描\",\n\t\t\"ja\": \"CR インスタンスイメージスキャンが有効\",\n\t\t\"de\": \"CR-Instanz Bild-Scanning aktiviert\",\n\t\t\"es\": \"Escaneo de Imagen de Instancia CR Habilitado\",\n\t\t\"fr\": \"Balayage d'Image d'Instance CR Activé\",\n\t\t\"pt\": \"Varredura de Imagem de Instância CR Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Container Registry instances have image scanning enabled for security vulnerability detection.\",\n\t\t\"zh\": \"确保容器镜像实例开启了镜像安全扫描功能以检测安全漏洞。\",\n\t\t\"ja\": \"コンテナレジストリインスタンスでセキュリティ脆弱性検出のためにイメージスキャンが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Container Registry-Instanzen Bild-Scanning für die Erkennung von Sicherheitslücken aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias de Container Registry tengan escaneo de imágenes habilitado para la detección de vulnerabilidades de seguridad.\",\n\t\t\"fr\": \"Garantit que les instances Container Registry ont le balayage d'images activé pour la détection des vulnérabilités de sécurité.\",\n\t\t\"pt\": \"Garante que as instâncias do Container Registry tenham varredura de imagem habilitada para detecção de vulnerabilidades de segurança.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Image scanning helps identify and prevent deployment of vulnerable container images.\",\n\t\t\"zh\": \"镜像扫描有助于识别和防止部署有漏洞的容器镜像。\",\n\t\t\"ja\": \"イメージスキャンは、脆弱なコンテナイメージの展開を識別および防止するのに役立ちます。\",\n\t\t\"de\": \"Bild-Scanning hilft dabei, die Bereitstellung anfälliger Container-Images zu identifizieren und zu verhindern.\",\n\t\t\"es\": \"El escaneo de imágenes ayuda a identificar y prevenir el despliegue de imágenes de contenedor vulnerables.\",\n\t\t\"fr\": \"Le balayage d'images aide à identifier et empêcher le déploiement d'images de conteneurs vulnérables.\",\n\t\t\"pt\": \"A varredura de imagem ajuda a identificar e prevenir a implantação de imagens de contêiner vulneráveis.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable image scanning for the Container Registry instance.\",\n\t\t\"zh\": \"为容器镜像实例启用镜像扫描功能。\",\n\t\t\"ja\": \"コンテナレジストリインスタンスのイメージスキャンを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Bild-Scanning für die Container Registry-Instanz.\",\n\t\t\"es\": \"Habilite el escaneo de imágenes para la instancia de Container Registry.\",\n\t\t\"fr\": \"Activez le balayage d'images pour l'instance Container Registry.\",\n\t\t\"pt\": \"Habilite a varredura de imagem para a instância do Container Registry.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CR::Instance\"]\n}\n\nis_compliant(resource) if {\n\t# Check ImageScanner property\n\timage_scanner := helpers.get_property(resource, \"ImageScanner\", \"\")\n\tcount(image_scanner) > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CR::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ImageScanner\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:cr-repository-immutablity-enable", Name: models.I18nString{"de": "Container Registry Repository Bildversion ist unveränderlich", "en": "Container Registry repository image version is immutable", "es": "La Versión de Imagen del Repositorio del Registro de Contenedores es Inmutable", "fr": "La Version d'Image du Dépôt du Registre de Conteneurs est Immutable", "ja": "コンテナレジストリリポジトリイメージバージョンが不変", "pt": "A Versão da Imagem do Repositório do Registro de Contêineres é Imutável", "zh": "容器镜像服务镜像版本为不可变"}, Severity: "low", Description: models.I18nString{"de": "Container Registry Repository Bildversion ist unveränderlich, was als konform gilt.", "en": "Container Registry repository image version is immutable, considered compliant.", "es": "La versión de imagen del repositorio del Registro de Contenedores es inmutable, considerado conforme.", "fr": "La version d'image du dépôt du Registre de Conteneurs est immuable, considéré comme conforme.", "ja": "コンテナレジストリリポジトリイメージバージョンが不変であり、準拠と見なされます。", "pt": "A versão da imagem do repositório do Registro de Contêineres é imutável, considerado conforme.", "zh": "容器镜像服务镜像版本为不可变,视为合规。"}, Reason: models.I18nString{"de": "Container Registry Repository Bildversion ist nicht unveränderlich", "en": "Container Registry repository image version is not immutable", "es": "La versión de imagen del repositorio del Registro de Contenedores no es inmutable", "fr": "La version d'image du dépôt du Registre de Conteneurs n'est pas immuable", "ja": "コンテナレジストリリポジトリイメージバージョンが不変ではない", "pt": "A versão da imagem do repositório do Registro de Contêineres não é imutável", "zh": "容器镜像服务镜像版本不是不可变的"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Tag-Unveränderlichkeit für Container Registry Repository, um zu verhindern, dass Bild-Tags überschrieben werden", "en": "Enable tag immutability for Container Registry repository to prevent image tags from being overwritten", "es": "Habilite la inmutabilidad de etiquetas para el repositorio del Registro de Contenedores para evitar que las etiquetas de imagen se sobrescriban", "fr": "Activez l'immuabilité des balises pour le dépôt du Registre de Conteneurs pour empêcher l'écrasement des balises d'image", "ja": "イメージタグが上書きされないように、コンテナレジストリリポジトリのタグ不変性を有効にします", "pt": "Habilite a imutabilidade de tags para o repositório do Registro de Contêineres para evitar que tags de imagem sejam sobrescritas", "zh": "为容器镜像服务仓库启用标签不可变性以防止镜像标签被覆盖"}, ResourceTypes: []string{"ALIYUN::CR::Repository"}, FilePath: "aliyun/rules/cr-repository-immutablity-enable.rego", PackageName: "infraguard.rules.aliyun.cr_repository_immutablity_enable", Content: "package infraguard.rules.aliyun.cr_repository_immutablity_enable\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"cr-repository-immutablity-enable\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"Container Registry repository image version is immutable\",\n\t\t\"zh\": \"容器镜像服务镜像版本为不可变\",\n\t\t\"ja\": \"コンテナレジストリリポジトリイメージバージョンが不変\",\n\t\t\"de\": \"Container Registry Repository Bildversion ist unveränderlich\",\n\t\t\"es\": \"La Versión de Imagen del Repositorio del Registro de Contenedores es Inmutable\",\n\t\t\"fr\": \"La Version d'Image du Dépôt du Registre de Conteneurs est Immutable\",\n\t\t\"pt\": \"A Versão da Imagem do Repositório do Registro de Contêineres é Imutável\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Container Registry repository image version is immutable, considered compliant.\",\n\t\t\"zh\": \"容器镜像服务镜像版本为不可变,视为合规。\",\n\t\t\"ja\": \"コンテナレジストリリポジトリイメージバージョンが不変であり、準拠と見なされます。\",\n\t\t\"de\": \"Container Registry Repository Bildversion ist unveränderlich, was als konform gilt.\",\n\t\t\"es\": \"La versión de imagen del repositorio del Registro de Contenedores es inmutable, considerado conforme.\",\n\t\t\"fr\": \"La version d'image du dépôt du Registre de Conteneurs est immuable, considéré comme conforme.\",\n\t\t\"pt\": \"A versão da imagem do repositório do Registro de Contêineres é imutável, considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Container Registry repository image version is not immutable\",\n\t\t\"zh\": \"容器镜像服务镜像版本不是不可变的\",\n\t\t\"ja\": \"コンテナレジストリリポジトリイメージバージョンが不変ではない\",\n\t\t\"de\": \"Container Registry Repository Bildversion ist nicht unveränderlich\",\n\t\t\"es\": \"La versión de imagen del repositorio del Registro de Contenedores no es inmutable\",\n\t\t\"fr\": \"La version d'image du dépôt du Registre de Conteneurs n'est pas immuable\",\n\t\t\"pt\": \"A versão da imagem do repositório do Registro de Contêineres não é imutável\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable tag immutability for Container Registry repository to prevent image tags from being overwritten\",\n\t\t\"zh\": \"为容器镜像服务仓库启用标签不可变性以防止镜像标签被覆盖\",\n\t\t\"ja\": \"イメージタグが上書きされないように、コンテナレジストリリポジトリのタグ不変性を有効にします\",\n\t\t\"de\": \"Aktivieren Sie Tag-Unveränderlichkeit für Container Registry Repository, um zu verhindern, dass Bild-Tags überschrieben werden\",\n\t\t\"es\": \"Habilite la inmutabilidad de etiquetas para el repositorio del Registro de Contenedores para evitar que las etiquetas de imagen se sobrescriban\",\n\t\t\"fr\": \"Activez l'immuabilité des balises pour le dépôt du Registre de Conteneurs pour empêcher l'écrasement des balises d'image\",\n\t\t\"pt\": \"Habilite a imutabilidade de tags para o repositório do Registro de Contêineres para evitar que tags de imagem sejam sobrescritas\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CR::Repository\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CR::Repository\")\n\n\t# Check if TagImmutability is enabled\n\t# Only applicable when InstanceId is specified (Enterprise Edition)\n\thas_instance := helpers.has_property(resource, \"InstanceId\")\n\thas_instance\n\n\ttag_immutability := helpers.get_property(resource, \"TagImmutability\", false)\n\tnot helpers.is_true(tag_immutability)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:cr-repository-type-private", Name: models.I18nString{"de": "CR-Repository-Typ privat", "en": "CR Repository Type Private", "es": "Tipo de Repositorio CR Privado", "fr": "Type de Dépôt CR Privé", "ja": "CR リポジトリタイプがプライベート", "pt": "Tipo de Repositório CR Privado", "zh": "容器镜像服务镜像仓库类型为私有"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass CR-Repositories auf PRIVATE gesetzt sind.", "en": "Ensures that CR repositories are set to PRIVATE.", "es": "Garantiza que los repositorios CR estén configurados como PRIVADOS.", "fr": "Garantit que les dépôts CR sont définis sur PRIVÉ.", "ja": "CR リポジトリが PRIVATE に設定されていることを確認します。", "pt": "Garante que os repositórios CR estejam definidos como PRIVADO.", "zh": "确保容器镜像仓库类型设置为私有。"}, Reason: models.I18nString{"de": "Öffentliche Repositories können von jedem abgerufen werden, was zur Offenlegung sensibler Codes oder Daten führen kann.", "en": "Public repositories can be accessed by anyone, which may lead to exposure of sensitive code or data.", "es": "Los repositorios públicos pueden ser accedidos por cualquiera, lo que puede llevar a la exposición de código o datos sensibles.", "fr": "Les dépôts publics peuvent être accessibles par n'importe qui, ce qui peut entraîner l'exposition de code ou de données sensibles.", "ja": "パブリックリポジトリは誰でもアクセスでき、機密コードやデータの露出につながる可能性があります。", "pt": "Repositórios públicos podem ser acessados por qualquer pessoa, o que pode levar à exposição de código ou dados sensíveis.", "zh": "公开仓库可以被任何人访问，可能导致敏感代码或数据泄露。"}, Recommendation: models.I18nString{"de": "Setzen Sie den RepoType für das CR-Repository auf 'PRIVATE'.", "en": "Set the RepoType to 'PRIVATE' for the CR repository.", "es": "Establezca el RepoType en 'PRIVADO' para el repositorio CR.", "fr": "Définissez le RepoType sur 'PRIVÉ' pour le dépôt CR.", "ja": "CR リポジトリの RepoType を 'PRIVATE' に設定します。", "pt": "Defina o RepoType como 'PRIVADO' para o repositório CR.", "zh": "将容器镜像仓库的 RepoType 设置为 'PRIVATE'。"}, ResourceTypes: []string{"ALIYUN::CR::Repository"}, FilePath: "aliyun/rules/cr-repository-type-private.rego", PackageName: "infraguard.rules.aliyun.cr_repository_type_private", Content: "package infraguard.rules.aliyun.cr_repository_type_private\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"cr-repository-type-private\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"CR Repository Type Private\",\n\t\t\"zh\": \"容器镜像服务镜像仓库类型为私有\",\n\t\t\"ja\": \"CR リポジトリタイプがプライベート\",\n\t\t\"de\": \"CR-Repository-Typ privat\",\n\t\t\"es\": \"Tipo de Repositorio CR Privado\",\n\t\t\"fr\": \"Type de Dépôt CR Privé\",\n\t\t\"pt\": \"Tipo de Repositório CR Privado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that CR repositories are set to PRIVATE.\",\n\t\t\"zh\": \"确保容器镜像仓库类型设置为私有。\",\n\t\t\"ja\": \"CR リポジトリが PRIVATE に設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass CR-Repositories auf PRIVATE gesetzt sind.\",\n\t\t\"es\": \"Garantiza que los repositorios CR estén configurados como PRIVADOS.\",\n\t\t\"fr\": \"Garantit que les dépôts CR sont définis sur PRIVÉ.\",\n\t\t\"pt\": \"Garante que os repositórios CR estejam definidos como PRIVADO.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Public repositories can be accessed by anyone, which may lead to exposure of sensitive code or data.\",\n\t\t\"zh\": \"公开仓库可以被任何人访问，可能导致敏感代码或数据泄露。\",\n\t\t\"ja\": \"パブリックリポジトリは誰でもアクセスでき、機密コードやデータの露出につながる可能性があります。\",\n\t\t\"de\": \"Öffentliche Repositories können von jedem abgerufen werden, was zur Offenlegung sensibler Codes oder Daten führen kann.\",\n\t\t\"es\": \"Los repositorios públicos pueden ser accedidos por cualquiera, lo que puede llevar a la exposición de código o datos sensibles.\",\n\t\t\"fr\": \"Les dépôts publics peuvent être accessibles par n'importe qui, ce qui peut entraîner l'exposition de code ou de données sensibles.\",\n\t\t\"pt\": \"Repositórios públicos podem ser acessados por qualquer pessoa, o que pode levar à exposição de código ou dados sensíveis.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set the RepoType to 'PRIVATE' for the CR repository.\",\n\t\t\"zh\": \"将容器镜像仓库的 RepoType 设置为 'PRIVATE'。\",\n\t\t\"ja\": \"CR リポジトリの RepoType を 'PRIVATE' に設定します。\",\n\t\t\"de\": \"Setzen Sie den RepoType für das CR-Repository auf 'PRIVATE'.\",\n\t\t\"es\": \"Establezca el RepoType en 'PRIVADO' para el repositorio CR.\",\n\t\t\"fr\": \"Définissez le RepoType sur 'PRIVÉ' pour le dépôt CR.\",\n\t\t\"pt\": \"Defina o RepoType como 'PRIVADO' para o repositório CR.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CR::Repository\"]\n}\n\nis_compliant(resource) if {\n\thelpers.get_property(resource, \"RepoType\", \"PRIVATE\") == \"PRIVATE\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CR::Repository\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"RepoType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:dcdn-domain-multiple-origin-servers", Name: models.I18nString{"de": "DCDN-Domäne Mehrere Ursprungsserver", "en": "DCDN Domain Multiple Origin Servers", "es": "Dominio DCDN Múltiples Servidores de Origen", "fr": "Domaine DCDN Serveurs d'Origine Multiples", "ja": "DCDN ドメイン複数オリジンサーバー", "pt": "Domínio DCDN Múltiplos Servidores de Origem", "zh": "DCDN 域名配置多个源站"}, Severity: "high", Description: models.I18nString{"de": "DCDN-Domänen sollten mit mehreren Ursprungsservern für hohe Verfügbarkeit und Fehlertoleranz konfiguriert werden.", "en": "DCDN domains should be configured with multiple origin servers for high availability and fault tolerance.", "es": "Los dominios DCDN deben configurarse con múltiples servidores de origen para alta disponibilidad y tolerancia a fallos.", "fr": "Les domaines DCDN doivent être configurés avec plusieurs serveurs d'origine pour une haute disponibilité et une tolérance aux pannes.", "ja": "DCDN ドメインは高可用性とフォールトトレランスのために複数のオリジンサーバーで構成する必要があります。", "pt": "Os domínios DCDN devem ser configurados com múltiplos servidores de origem para alta disponibilidade e tolerância a falhas.", "zh": "DCDN 域名配置多个源站，视为合规。"}, Reason: models.I18nString{"de": "Die DCDN-Domäne ist nur mit einem Ursprungsserver konfiguriert, was einen Single Point of Failure erzeugt.", "en": "The DCDN domain is configured with only one origin server, creating a single point of failure.", "es": "El dominio DCDN está configurado con solo un servidor de origen, creando un punto único de fallo.", "fr": "Le domaine DCDN est configuré avec un seul serveur d'origine, créant un point de défaillance unique.", "ja": "DCDN ドメインが1つのオリジンサーバーのみで構成されており、単一障害点が発生しています。", "pt": "O domínio DCDN está configurado com apenas um servidor de origem, criando um ponto único de falha.", "zh": "DCDN 域名仅配置了一个源站，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie mindestens zwei Ursprungsserver in der Sources-Eigenschaft, um hohe Verfügbarkeit sicherzustellen.", "en": "Configure at least two origin servers in the Sources property to ensure high availability.", "es": "Configure al menos dos servidores de origen en la propiedad Sources para garantizar alta disponibilidad.", "fr": "Configurez au moins deux serveurs d'origine dans la propriété Sources pour assurer une haute disponibilité.", "ja": "高可用性を確保するために、Sources プロパティに少なくとも2つのオリジンサーバーを設定します。", "pt": "Configure pelo menos dois servidores de origem na propriedade Sources para garantir alta disponibilidade.", "zh": "在 Sources 属性中配置至少两个源站，以确保高可用性。"}, ResourceTypes: []string{"ALIYUN::DCDN::Domain"}, FilePath: "aliyun/rules/dcdn-domain-multiple-origin-servers.rego", PackageName: "infraguard.rules.aliyun.dcdn_domain_multiple_origin_servers", Content: "package infraguard.rules.aliyun.dcdn_domain_multiple_origin_servers\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"dcdn-domain-multiple-origin-servers\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"DCDN Domain Multiple Origin Servers\",\n\t\t\"zh\": \"DCDN 域名配置多个源站\",\n\t\t\"ja\": \"DCDN ドメイン複数オリジンサーバー\",\n\t\t\"de\": \"DCDN-Domäne Mehrere Ursprungsserver\",\n\t\t\"es\": \"Dominio DCDN Múltiples Servidores de Origen\",\n\t\t\"fr\": \"Domaine DCDN Serveurs d'Origine Multiples\",\n\t\t\"pt\": \"Domínio DCDN Múltiplos Servidores de Origem\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"DCDN domains should be configured with multiple origin servers for high availability and fault tolerance.\",\n\t\t\"zh\": \"DCDN 域名配置多个源站，视为合规。\",\n\t\t\"ja\": \"DCDN ドメインは高可用性とフォールトトレランスのために複数のオリジンサーバーで構成する必要があります。\",\n\t\t\"de\": \"DCDN-Domänen sollten mit mehreren Ursprungsservern für hohe Verfügbarkeit und Fehlertoleranz konfiguriert werden.\",\n\t\t\"es\": \"Los dominios DCDN deben configurarse con múltiples servidores de origen para alta disponibilidad y tolerancia a fallos.\",\n\t\t\"fr\": \"Les domaines DCDN doivent être configurés avec plusieurs serveurs d'origine pour une haute disponibilité et une tolérance aux pannes.\",\n\t\t\"pt\": \"Os domínios DCDN devem ser configurados com múltiplos servidores de origem para alta disponibilidade e tolerância a falhas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The DCDN domain is configured with only one origin server, creating a single point of failure.\",\n\t\t\"zh\": \"DCDN 域名仅配置了一个源站，存在单点故障风险。\",\n\t\t\"ja\": \"DCDN ドメインが1つのオリジンサーバーのみで構成されており、単一障害点が発生しています。\",\n\t\t\"de\": \"Die DCDN-Domäne ist nur mit einem Ursprungsserver konfiguriert, was einen Single Point of Failure erzeugt.\",\n\t\t\"es\": \"El dominio DCDN está configurado con solo un servidor de origen, creando un punto único de fallo.\",\n\t\t\"fr\": \"Le domaine DCDN est configuré avec un seul serveur d'origine, créant un point de défaillance unique.\",\n\t\t\"pt\": \"O domínio DCDN está configurado com apenas um servidor de origem, criando um ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure at least two origin servers in the Sources property to ensure high availability.\",\n\t\t\"zh\": \"在 Sources 属性中配置至少两个源站，以确保高可用性。\",\n\t\t\"ja\": \"高可用性を確保するために、Sources プロパティに少なくとも2つのオリジンサーバーを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie mindestens zwei Ursprungsserver in der Sources-Eigenschaft, um hohe Verfügbarkeit sicherzustellen.\",\n\t\t\"es\": \"Configure al menos dos servidores de origen en la propiedad Sources para garantizar alta disponibilidad.\",\n\t\t\"fr\": \"Configurez au moins deux serveurs d'origine dans la propriété Sources pour assurer une haute disponibilité.\",\n\t\t\"pt\": \"Configure pelo menos dois servidores de origem na propriedade Sources para garantir alta disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::DCDN::Domain\"]\n}\n\n# Check if domain has multiple origin servers\nhas_multiple_origin_servers(resource) if {\n\tsources := resource.Properties.Sources\n\tcount(sources) >= 2\n}\n\n# Deny rule: DCDN domains must have multiple origin servers\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::DCDN::Domain\")\n\tnot has_multiple_origin_servers(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Sources\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:eci-container-group-volumn-mounts", Name: models.I18nString{"de": "ECI-Volumen-Mount-Prüfung", "en": "ECI Volume Mounting Check", "es": "Verificación de Montaje de Volumen ECI", "fr": "Vérification du Montage de Volume ECI", "ja": "ECI ボリュームマウントチェック", "pt": "Verificação de Montagem de Volume ECI", "zh": "ECI 容器组挂载卷核查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass ECI-Containergruppen Volumes für persistente Datenspeicherung gemountet haben.", "en": "Ensures ECI container groups have volumes mounted for persistent data storage.", "es": "Garantiza que los grupos de contenedores ECI tengan volúmenes montados para almacenamiento de datos persistente.", "fr": "Garantit que les groupes de conteneurs ECI ont des volumes montés pour le stockage de données persistant.", "ja": "ECI コンテナグループに永続データストレージ用のボリュームがマウントされていることを確認します。", "pt": "Garante que os grupos de contêineres ECI tenham volumes montados para armazenamento de dados persistente.", "zh": "确保 ECI 容器组挂载了用于持久化数据存储的卷。"}, Reason: models.I18nString{"de": "Zustandslose Container können bei Neustart kritische Daten verlieren, wenn keine Volumes gemountet sind.", "en": "Stateless containers may lose critical data upon restart if volumes are not mounted.", "es": "Los contenedores sin estado pueden perder datos críticos al reiniciar si no se montan volúmenes.", "fr": "Les conteneurs sans état peuvent perdre des données critiques lors du redémarrage si les volumes ne sont pas montés.", "ja": "ボリュームがマウントされていない場合、ステートレスコンテナは再起動時に重要なデータを失う可能性があります。", "pt": "Contêineres sem estado podem perder dados críticos ao reiniciar se os volumes não estiverem montados.", "zh": "如果未挂载卷，无状态容器在重启时可能会丢失关键数据。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie Volumes und Volume-Mounts für die ECI-Containergruppe.", "en": "Configure volumes and volume mounts for the ECI container group.", "es": "Configure volúmenes y montajes de volúmenes para el grupo de contenedores ECI.", "fr": "Configurez les volumes et les montages de volumes pour le groupe de conteneurs ECI.", "ja": "ECI コンテナグループのボリュームとボリュームマウントを設定します。", "pt": "Configure volumes e montagens de volumes para o grupo de contêineres ECI.", "zh": "为 ECI 容器组配置卷及卷挂载。"}, ResourceTypes: []string{"ALIYUN::ECI::ContainerGroup"}, FilePath: "aliyun/rules/eci-container-group-volumn-mounts.rego", PackageName: "infraguard.rules.aliyun.eci_container_group_volumn_mounts", Content: "package infraguard.rules.aliyun.eci_container_group_volumn_mounts\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"eci-container-group-volumn-mounts\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECI Volume Mounting Check\",\n\t\t\"zh\": \"ECI 容器组挂载卷核查\",\n\t\t\"ja\": \"ECI ボリュームマウントチェック\",\n\t\t\"de\": \"ECI-Volumen-Mount-Prüfung\",\n\t\t\"es\": \"Verificación de Montaje de Volumen ECI\",\n\t\t\"fr\": \"Vérification du Montage de Volume ECI\",\n\t\t\"pt\": \"Verificação de Montagem de Volume ECI\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ECI container groups have volumes mounted for persistent data storage.\",\n\t\t\"zh\": \"确保 ECI 容器组挂载了用于持久化数据存储的卷。\",\n\t\t\"ja\": \"ECI コンテナグループに永続データストレージ用のボリュームがマウントされていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECI-Containergruppen Volumes für persistente Datenspeicherung gemountet haben.\",\n\t\t\"es\": \"Garantiza que los grupos de contenedores ECI tengan volúmenes montados para almacenamiento de datos persistente.\",\n\t\t\"fr\": \"Garantit que les groupes de conteneurs ECI ont des volumes montés pour le stockage de données persistant.\",\n\t\t\"pt\": \"Garante que os grupos de contêineres ECI tenham volumes montados para armazenamento de dados persistente.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Stateless containers may lose critical data upon restart if volumes are not mounted.\",\n\t\t\"zh\": \"如果未挂载卷，无状态容器在重启时可能会丢失关键数据。\",\n\t\t\"ja\": \"ボリュームがマウントされていない場合、ステートレスコンテナは再起動時に重要なデータを失う可能性があります。\",\n\t\t\"de\": \"Zustandslose Container können bei Neustart kritische Daten verlieren, wenn keine Volumes gemountet sind.\",\n\t\t\"es\": \"Los contenedores sin estado pueden perder datos críticos al reiniciar si no se montan volúmenes.\",\n\t\t\"fr\": \"Les conteneurs sans état peuvent perdre des données critiques lors du redémarrage si les volumes ne sont pas montés.\",\n\t\t\"pt\": \"Contêineres sem estado podem perder dados críticos ao reiniciar se os volumes não estiverem montados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure volumes and volume mounts for the ECI container group.\",\n\t\t\"zh\": \"为 ECI 容器组配置卷及卷挂载。\",\n\t\t\"ja\": \"ECI コンテナグループのボリュームとボリュームマウントを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie Volumes und Volume-Mounts für die ECI-Containergruppe.\",\n\t\t\"es\": \"Configure volúmenes y montajes de volúmenes para el grupo de contenedores ECI.\",\n\t\t\"fr\": \"Configurez les volumes et les montages de volumes pour le groupe de conteneurs ECI.\",\n\t\t\"pt\": \"Configure volumes e montagens de volumes para o grupo de contêineres ECI.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECI::ContainerGroup\"]\n}\n\nis_compliant(resource) if {\n\tvolumes := helpers.get_property(resource, \"Volume\", [])\n\tcount(volumes) > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECI::ContainerGroup\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Volume\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:eci-containergroup-environment-no-specified-keys", Name: models.I18nString{"de": "ECI-Containergruppe enthält keine sensiblen Umgebungsvariablen", "en": "ECI Container Group Does Not Contain Sensitive Environment Variables", "es": "El Grupo de Contenedores ECI No Contiene Variables de Entorno Sensibles", "fr": "Le Groupe de Conteneurs ECI Ne Contient Pas de Variables d'Environnement Sensibles", "ja": "ECI コンテナグループに機密環境変数が含まれていない", "pt": "Grupo de Contêineres ECI Não Contém Variáveis de Ambiente Sensíveis", "zh": "ECI 容器组不包含敏感环境变量"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass ECI-Containergruppen keine sensiblen Umgebungsvariablen wie Passwörter oder Zugriffsschlüssel haben.", "en": "Ensures that ECI container groups do not have sensitive environment variables like passwords or access keys.", "es": "Garantiza que los grupos de contenedores ECI no tengan variables de entorno sensibles como contraseñas o claves de acceso.", "fr": "Garantit que les groupes de conteneurs ECI n'ont pas de variables d'environnement sensibles comme les mots de passe ou les clés d'accès.", "ja": "ECI コンテナグループにパスワードやアクセスキーなどの機密環境変数がないことを確認します。", "pt": "Garante que os grupos de contêineres ECI não tenham variáveis de ambiente sensíveis como senhas ou chaves de acesso.", "zh": "ECI 容器组不包含敏感环境变量（如密码、AccessKey 等），视为合规。"}, Reason: models.I18nString{"de": "ECI-Containergruppe enthält sensible Umgebungsvariablen, die zu Anmeldedatenlecks führen können.", "en": "ECI container group contains sensitive environment variables, which may leak credentials.", "es": "El grupo de contenedores ECI contiene variables de entorno sensibles, lo que puede provocar la filtración de credenciales.", "fr": "Le groupe de conteneurs ECI contient des variables d'environnement sensibles, ce qui peut entraîner une fuite d'identifiants.", "ja": "ECI コンテナグループに機密環境変数が含まれており、認証情報が漏洩する可能性があります。", "pt": "O grupo de contêineres ECI contém variáveis de ambiente sensíveis, o que pode causar vazamento de credenciais.", "zh": "ECI 容器组包含敏感环境变量，可能导致凭证泄露。"}, Recommendation: models.I18nString{"de": "Verwenden Sie Secrets oder Parameter Store, um sensible Umgebungsvariablen zu verwalten.", "en": "Use Secrets or parameter store to manage sensitive environment variables.", "es": "Use Secrets o almacén de parámetros para gestionar variables de entorno sensibles.", "fr": "Utilisez Secrets ou le magasin de paramètres pour gérer les variables d'environnement sensibles.", "ja": "機密環境変数を管理するには、Secrets またはパラメータストアを使用します。", "pt": "Use Secrets ou armazenamento de parâmetros para gerenciar variáveis de ambiente sensíveis.", "zh": "请使用 Secret 或参数存储来管理敏感环境变量。"}, ResourceTypes: []string{"ALIYUN::ECI::ContainerGroup"}, FilePath: "aliyun/rules/eci-containergroup-environment-no-specified-keys.rego", PackageName: "infraguard.rules.aliyun.eci_containergroup_environment_no_specified_keys", Content: "package infraguard.rules.aliyun.eci_containergroup_environment_no_specified_keys\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"eci-containergroup-environment-no-specified-keys\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECI Container Group Does Not Contain Sensitive Environment Variables\",\n\t\t\"zh\": \"ECI 容器组不包含敏感环境变量\",\n\t\t\"ja\": \"ECI コンテナグループに機密環境変数が含まれていない\",\n\t\t\"de\": \"ECI-Containergruppe enthält keine sensiblen Umgebungsvariablen\",\n\t\t\"es\": \"El Grupo de Contenedores ECI No Contiene Variables de Entorno Sensibles\",\n\t\t\"fr\": \"Le Groupe de Conteneurs ECI Ne Contient Pas de Variables d'Environnement Sensibles\",\n\t\t\"pt\": \"Grupo de Contêineres ECI Não Contém Variáveis de Ambiente Sensíveis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ECI container groups do not have sensitive environment variables like passwords or access keys.\",\n\t\t\"zh\": \"ECI 容器组不包含敏感环境变量（如密码、AccessKey 等），视为合规。\",\n\t\t\"ja\": \"ECI コンテナグループにパスワードやアクセスキーなどの機密環境変数がないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECI-Containergruppen keine sensiblen Umgebungsvariablen wie Passwörter oder Zugriffsschlüssel haben.\",\n\t\t\"es\": \"Garantiza que los grupos de contenedores ECI no tengan variables de entorno sensibles como contraseñas o claves de acceso.\",\n\t\t\"fr\": \"Garantit que les groupes de conteneurs ECI n'ont pas de variables d'environnement sensibles comme les mots de passe ou les clés d'accès.\",\n\t\t\"pt\": \"Garante que os grupos de contêineres ECI não tenham variáveis de ambiente sensíveis como senhas ou chaves de acesso.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECI container group contains sensitive environment variables, which may leak credentials.\",\n\t\t\"zh\": \"ECI 容器组包含敏感环境变量，可能导致凭证泄露。\",\n\t\t\"ja\": \"ECI コンテナグループに機密環境変数が含まれており、認証情報が漏洩する可能性があります。\",\n\t\t\"de\": \"ECI-Containergruppe enthält sensible Umgebungsvariablen, die zu Anmeldedatenlecks führen können.\",\n\t\t\"es\": \"El grupo de contenedores ECI contiene variables de entorno sensibles, lo que puede provocar la filtración de credenciales.\",\n\t\t\"fr\": \"Le groupe de conteneurs ECI contient des variables d'environnement sensibles, ce qui peut entraîner une fuite d'identifiants.\",\n\t\t\"pt\": \"O grupo de contêineres ECI contém variáveis de ambiente sensíveis, o que pode causar vazamento de credenciais.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use Secrets or parameter store to manage sensitive environment variables.\",\n\t\t\"zh\": \"请使用 Secret 或参数存储来管理敏感环境变量。\",\n\t\t\"ja\": \"機密環境変数を管理するには、Secrets またはパラメータストアを使用します。\",\n\t\t\"de\": \"Verwenden Sie Secrets oder Parameter Store, um sensible Umgebungsvariablen zu verwalten.\",\n\t\t\"es\": \"Use Secrets o almacén de parámetros para gestionar variables de entorno sensibles.\",\n\t\t\"fr\": \"Utilisez Secrets ou le magasin de paramètres pour gérer les variables d'environnement sensibles.\",\n\t\t\"pt\": \"Use Secrets ou armazenamento de parâmetros para gerenciar variáveis de ambiente sensíveis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECI::ContainerGroup\"]\n}\n\n# Default sensitive environment variable keys\ndefault sensitive_keys := [\n\t\"password\",\n\t\"passwd\",\n\t\"pwd\",\n\t\"secret\",\n\t\"key\",\n\t\"token\",\n\t\"credential\",\n\t\"access_key\",\n\t\"accesskey\",\n\t\"secret_key\",\n\t\"secretkey\",\n\t\"access_key_id\",\n]\n\n# Get sensitive keys from parameters or use default\nget_sensitive_keys := input.rule_parameters.sensitive_env_keys if {\n\tcount(input.rule_parameters.sensitive_env_keys) > 0\n} else := sensitive_keys\n\n# Check if a key is sensitive (supports partial match)\nis_sensitive_key(key) if {\n\tsome sensitive in get_sensitive_keys\n\tcontains(lower(key), lower(sensitive))\n}\n\n# Check if environment variable contains sensitive key\nhas_sensitive_env(container) if {\n\tsome env in container.EnvironmentVar\n\tis_sensitive_key(env.Key)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECI::ContainerGroup\")\n\n\tsome container in resource.Properties.Container\n\thas_sensitive_env(container)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Container\", \"EnvironmentVar\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-available-disk-encrypted", Name: models.I18nString{"de": "ECS-Festplattenverschlüsselung aktiviert", "en": "ECS Disk Encryption Enabled", "es": "Cifrado de Disco ECS Habilitado", "fr": "Chiffrement de Disque ECS Activé", "ja": "ECS ディスク暗号化が有効", "pt": "Criptografia de Disco ECS Habilitada", "zh": "可用的磁盘均已加密"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass alle ECS-Festplatten verschlüsselt sind.", "en": "Ensures that all ECS disks are encrypted.", "es": "Garantiza que todos los discos ECS estén cifrados.", "fr": "Garantit que tous les disques ECS sont chiffrés.", "ja": "すべての ECS ディスクが暗号化されていることを確認します。", "pt": "Garante que todos os discos ECS estejam criptografados.", "zh": "确保所有 ECS 磁盘都已加密。"}, Reason: models.I18nString{"de": "Verschlüsselung schützt ruhende Daten vor unbefugtem physischem Zugriff oder Diebstahl.", "en": "Encryption protects data at rest from unauthorized physical access or theft.", "es": "El cifrado protege los datos en reposo del acceso físico no autorizado o el robo.", "fr": "Le chiffrement protège les données au repos contre l'accès physique non autorisé ou le vol.", "ja": "暗号化により、保存データが不正な物理アクセスや盗難から保護されます。", "pt": "A criptografia protege dados em repouso contra acesso físico não autorizado ou roubo.", "zh": "加密可以保护静态数据免受未经授权的物理访问或盗窃。"}, Recommendation: models.I18nString{"de": "Setzen Sie 'Encrypted' für alle ECS-Festplatten auf true.", "en": "Set 'Encrypted' to true for all ECS disks.", "es": "Establezca 'Encrypted' en true para todos los discos ECS.", "fr": "Définissez 'Encrypted' sur true pour tous les disques ECS.", "ja": "すべての ECS ディスクの 'Encrypted' を true に設定します。", "pt": "Defina 'Encrypted' como true para todos os discos ECS.", "zh": "将所有 ECS 磁盘的'Encrypted'属性设置为 true。"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-available-disk-encrypted.rego", PackageName: "infraguard.rules.aliyun.ecs_available_disk_encrypted", Content: "package infraguard.rules.aliyun.ecs_available_disk_encrypted\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ecs-available-disk-encrypted\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECS Disk Encryption Enabled\",\n\t\t\"zh\": \"可用的磁盘均已加密\",\n\t\t\"ja\": \"ECS ディスク暗号化が有効\",\n\t\t\"de\": \"ECS-Festplattenverschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado de Disco ECS Habilitado\",\n\t\t\"fr\": \"Chiffrement de Disque ECS Activé\",\n\t\t\"pt\": \"Criptografia de Disco ECS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that all ECS disks are encrypted.\",\n\t\t\"zh\": \"确保所有 ECS 磁盘都已加密。\",\n\t\t\"ja\": \"すべての ECS ディスクが暗号化されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass alle ECS-Festplatten verschlüsselt sind.\",\n\t\t\"es\": \"Garantiza que todos los discos ECS estén cifrados.\",\n\t\t\"fr\": \"Garantit que tous les disques ECS sont chiffrés.\",\n\t\t\"pt\": \"Garante que todos os discos ECS estejam criptografados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Encryption protects data at rest from unauthorized physical access or theft.\",\n\t\t\"zh\": \"加密可以保护静态数据免受未经授权的物理访问或盗窃。\",\n\t\t\"ja\": \"暗号化により、保存データが不正な物理アクセスや盗難から保護されます。\",\n\t\t\"de\": \"Verschlüsselung schützt ruhende Daten vor unbefugtem physischem Zugriff oder Diebstahl.\",\n\t\t\"es\": \"El cifrado protege los datos en reposo del acceso físico no autorizado o el robo.\",\n\t\t\"fr\": \"Le chiffrement protège les données au repos contre l'accès physique non autorisé ou le vol.\",\n\t\t\"pt\": \"A criptografia protege dados em repouso contra acesso físico não autorizado ou roubo.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set 'Encrypted' to true for all ECS disks.\",\n\t\t\"zh\": \"将所有 ECS 磁盘的'Encrypted'属性设置为 true。\",\n\t\t\"ja\": \"すべての ECS ディスクの 'Encrypted' を true に設定します。\",\n\t\t\"de\": \"Setzen Sie 'Encrypted' für alle ECS-Festplatten auf true.\",\n\t\t\"es\": \"Establezca 'Encrypted' en true para todos los discos ECS.\",\n\t\t\"fr\": \"Définissez 'Encrypted' sur true pour tous les disques ECS.\",\n\t\t\"pt\": \"Defina 'Encrypted' como true para todos os discos ECS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"Encrypted\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Encrypted\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-disk-all-encrypted-by-kms", Name: models.I18nString{"de": "ECS-Festplatte mit KMS-Verschlüsselung aktiviert", "en": "ECS disk with KMS encryption enabled", "es": "Disco ECS con Cifrado KMS Habilitado", "fr": "Disque ECS avec Chiffrement KMS Activé", "ja": "KMS 暗号化が有効な ECS ディスク", "pt": "Disco ECS com Criptografia KMS Habilitada", "zh": "ECS 磁盘开启 KMS 加密"}, Severity: "medium", Description: models.I18nString{"de": "ECS-Festplatten (einschließlich Systemfestplatte und Datenträger) sind mit KMS verschlüsselt, was als konform gilt.", "en": "ECS disks (including system disk and data disks) are encrypted with KMS, considered compliant.", "es": "Los discos ECS (incluidos el disco del sistema y los discos de datos) están cifrados con KMS, considerado conforme.", "fr": "Les disques ECS (y compris le disque système et les disques de données) sont chiffrés avec KMS, considéré comme conforme.", "ja": "ECS ディスク（システムディスクとデータディスクを含む）が KMS で暗号化されており、準拠と見なされます。", "pt": "Os discos ECS (incluindo disco do sistema e discos de dados) estão criptografados com KMS, considerado conforme.", "zh": "ECS 磁盘(包括系统盘和数据盘)开启 KMS 加密，视为合规。"}, Reason: models.I18nString{"de": "ECS-Festplatte ist nicht mit KMS verschlüsselt", "en": "ECS disk is not encrypted with KMS", "es": "El disco ECS no está cifrado con KMS", "fr": "Le disque ECS n'est pas chiffré avec KMS", "ja": "ECS ディスクが KMS で暗号化されていない", "pt": "O disco ECS não está criptografado com KMS", "zh": "ECS 磁盘未开启 KMS 加密"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die KMS-Verschlüsselung für ECS-Festplatten, indem Sie Encrypted auf true setzen und eine KMSKeyId angeben", "en": "Enable KMS encryption for ECS disks by setting Encrypted to true and specifying a KMSKeyId", "es": "Habilite el cifrado KMS para discos ECS estableciendo Encrypted en true y especificando un KMSKeyId", "fr": "Activez le chiffrement KMS pour les disques ECS en définissant Encrypted sur true et en spécifiant un KMSKeyId", "ja": "Encrypted を true に設定し、KMSKeyId を指定して ECS ディスクの KMS 暗号化を有効にします", "pt": "Habilite a criptografia KMS para discos ECS definindo Encrypted como true e especificando um KMSKeyId", "zh": "通过设置 Encrypted 为 true 并指定 KMSKeyId 来为 ECS 磁盘启用 KMS 加密"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-disk-all-encrypted-by-kms.rego", PackageName: "infraguard.rules.aliyun.ecs_disk_all_encrypted_by_kms", Content: "package infraguard.rules.aliyun.ecs_disk_all_encrypted_by_kms\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-disk-all-encrypted-by-kms\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS disk with KMS encryption enabled\",\n\t\t\"zh\": \"ECS 磁盘开启 KMS 加密\",\n\t\t\"ja\": \"KMS 暗号化が有効な ECS ディスク\",\n\t\t\"de\": \"ECS-Festplatte mit KMS-Verschlüsselung aktiviert\",\n\t\t\"es\": \"Disco ECS con Cifrado KMS Habilitado\",\n\t\t\"fr\": \"Disque ECS avec Chiffrement KMS Activé\",\n\t\t\"pt\": \"Disco ECS com Criptografia KMS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS disks (including system disk and data disks) are encrypted with KMS, considered compliant.\",\n\t\t\"zh\": \"ECS 磁盘(包括系统盘和数据盘)开启 KMS 加密，视为合规。\",\n\t\t\"ja\": \"ECS ディスク（システムディスクとデータディスクを含む）が KMS で暗号化されており、準拠と見なされます。\",\n\t\t\"de\": \"ECS-Festplatten (einschließlich Systemfestplatte und Datenträger) sind mit KMS verschlüsselt, was als konform gilt.\",\n\t\t\"es\": \"Los discos ECS (incluidos el disco del sistema y los discos de datos) están cifrados con KMS, considerado conforme.\",\n\t\t\"fr\": \"Les disques ECS (y compris le disque système et les disques de données) sont chiffrés avec KMS, considéré comme conforme.\",\n\t\t\"pt\": \"Os discos ECS (incluindo disco do sistema e discos de dados) estão criptografados com KMS, considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS disk is not encrypted with KMS\",\n\t\t\"zh\": \"ECS 磁盘未开启 KMS 加密\",\n\t\t\"ja\": \"ECS ディスクが KMS で暗号化されていない\",\n\t\t\"de\": \"ECS-Festplatte ist nicht mit KMS verschlüsselt\",\n\t\t\"es\": \"El disco ECS no está cifrado con KMS\",\n\t\t\"fr\": \"Le disque ECS n'est pas chiffré avec KMS\",\n\t\t\"pt\": \"O disco ECS não está criptografado com KMS\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable KMS encryption for ECS disks by setting Encrypted to true and specifying a KMSKeyId\",\n\t\t\"zh\": \"通过设置 Encrypted 为 true 并指定 KMSKeyId 来为 ECS 磁盘启用 KMS 加密\",\n\t\t\"ja\": \"Encrypted を true に設定し、KMSKeyId を指定して ECS ディスクの KMS 暗号化を有効にします\",\n\t\t\"de\": \"Aktivieren Sie die KMS-Verschlüsselung für ECS-Festplatten, indem Sie Encrypted auf true setzen und eine KMSKeyId angeben\",\n\t\t\"es\": \"Habilite el cifrado KMS para discos ECS estableciendo Encrypted en true y especificando un KMSKeyId\",\n\t\t\"fr\": \"Activez le chiffrement KMS pour les disques ECS en définissant Encrypted sur true et en spécifiant un KMSKeyId\",\n\t\t\"pt\": \"Habilite a criptografia KMS para discos ECS definindo Encrypted como true e especificando um KMSKeyId\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\n\t# Check if disk is encrypted\n\tencrypted := helpers.get_property(resource, \"Encrypted\", false)\n\tnot helpers.is_true(encrypted)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Encrypted\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-disk-auto-snapshot-policy", Name: models.I18nString{"de": "ECS-Disk hat automatische Snapshot-Richtlinie konfiguriert", "en": "ECS disk has auto snapshot policy configured", "es": "Disco ECS tiene política de snapshot automático configurada", "fr": "Disque ECS a une politique de snapshot automatique configurée", "ja": "ECS ディスクに自動スナップショットポリシーが設定されている", "pt": "Disco ECS tem política de snapshot automático configurada", "zh": "ECS 磁盘设置自动快照策略"}, Severity: "low", Description: models.I18nString{"de": "ECS-Disk hat automatische Snapshot-Richtlinie konfiguriert, wird als konform betrachtet. Nicht verwendete Disks, Disks, die keine automatische Snapshot-Richtlinie unterstützen, und nicht persistente Disks, die von ACK-Clustern gemountet werden, sind nicht anwendbar. Nach Aktivierung der automatischen Snapshot-Richtlinie erstellt Alibaba Cloud automatisch Snapshots für Cloud-Disks gemäß voreingestellten Zeitpunkten und Zyklen, was eine schnelle Wiederherstellung nach Virenbefall oder Ransomware-Angriffen ermöglicht.", "en": "ECS disk has auto snapshot policy configured, considered compliant. Disks not in use, disks that do not support auto snapshot policy, and non-persistent disks mounted by ACK clusters are not applicable. After enabling auto snapshot policy, Alibaba Cloud will automatically create snapshots for cloud disks according to preset time points and cycles, enabling quick recovery from virus intrusion or ransomware attacks.", "es": "El disco ECS tiene política de snapshot automático configurada, considerada conforme. Los discos no en uso, discos que no admiten política de snapshot automático y discos no persistentes montados por clústeres ACK no son aplicables. Después de habilitar la política de snapshot automático, Alibaba Cloud creará automáticamente snapshots para discos en la nube según puntos de tiempo y ciclos predefinidos, permitiendo recuperación rápida de intrusión de virus o ataques de ransomware.", "fr": "Le disque ECS a une politique de snapshot automatique configurée, considérée comme conforme. Les disques non utilisés, les disques qui ne prennent pas en charge la politique de snapshot automatique et les disques non persistants montés par les clusters ACK ne sont pas applicables. Après avoir activé la politique de snapshot automatique, Alibaba Cloud créera automatiquement des snapshots pour les disques cloud selon les points de temps et cycles prédéfinis, permettant une récupération rapide après une intrusion de virus ou des attaques de ransomware.", "ja": "ECS ディスクに自動スナップショットポリシーが設定されている場合、準拠と見なされます。使用中でないディスク、自動スナップショットポリシーをサポートしないディスク、ACK クラスタによってマウントされた非永続化ディスクは適用されません。自動スナップショットポリシーを有効にすると、Alibaba Cloud は事前設定された時間とサイクルに従ってクラウドディスクのスナップショットを自動的に作成し、ウイルス侵入やランサムウェア攻撃から迅速に回復できるようにします。", "pt": "Disco ECS tem política de snapshot automático configurada, considerado conforme. Discos não em uso, discos que não suportam política de snapshot automático e discos não persistentes montados por clusters ACK não são aplicáveis. Após habilitar a política de snapshot automático, o Alibaba Cloud criará automaticamente snapshots para discos em nuvem de acordo com pontos de tempo e ciclos predefinidos, permitindo recuperação rápida de invasão de vírus ou ataques de ransomware.", "zh": "ECS 磁盘设置了自动快照策略,视为合规。状态非使用中的磁盘、不支持设置自动快照策略的磁盘、ACK 集群挂载的非持久化使用场景的磁盘视为不适用。开启自动快照策略后,阿里云会自动按照预设的时间点和周期为云盘创建快照,遭遇病毒入侵或勒索后能够快速从安全事件中恢复。"}, Reason: models.I18nString{"de": "ECS-Disk hat keine automatische Snapshot-Richtlinie konfiguriert", "en": "ECS disk does not have auto snapshot policy configured", "es": "El disco ECS no tiene política de snapshot automático configurada", "fr": "Le disque ECS n'a pas de politique de snapshot automatique configurée", "ja": "ECS ディスクに自動スナップショットポリシーが設定されていません", "pt": "Disco ECS não tem política de snapshot automático configurada", "zh": "ECS 磁盘未设置自动快照策略"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie eine automatische Snapshot-Richtlinie für ECS-Disks, um automatische Backups zu aktivieren und schnelle Wiederherstellung nach Sicherheitsvorfällen zu ermöglichen", "en": "Configure auto snapshot policy for ECS disk to enable automatic backup and quick recovery from security incidents", "es": "Configure política de snapshot automático para disco ECS para habilitar backup automático y recuperación rápida de incidentes de seguridad", "fr": "Configurez une politique de snapshot automatique pour le disque ECS pour activer la sauvegarde automatique et la récupération rapide après des incidents de sécurité", "ja": "自動バックアップを有効にし、セキュリティインシデントから迅速に回復するために、ECS ディスクに自動スナップショットポリシーを設定します", "pt": "Configure política de snapshot automático para disco ECS para habilitar backup automático e recuperação rápida de incidentes de segurança", "zh": "为 ECS 磁盘配置自动快照策略以启用自动备份并快速从安全事件中恢复"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-disk-auto-snapshot-policy.rego", PackageName: "infraguard.rules.aliyun.ecs_disk_auto_snapshot_policy", Content: "package infraguard.rules.aliyun.ecs_disk_auto_snapshot_policy\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-disk-auto-snapshot-policy\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS disk has auto snapshot policy configured\",\n\t\t\"zh\": \"ECS 磁盘设置自动快照策略\",\n\t\t\"ja\": \"ECS ディスクに自動スナップショットポリシーが設定されている\",\n\t\t\"de\": \"ECS-Disk hat automatische Snapshot-Richtlinie konfiguriert\",\n\t\t\"es\": \"Disco ECS tiene política de snapshot automático configurada\",\n\t\t\"fr\": \"Disque ECS a une politique de snapshot automatique configurée\",\n\t\t\"pt\": \"Disco ECS tem política de snapshot automático configurada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS disk has auto snapshot policy configured, considered compliant. Disks not in use, disks that do not support auto snapshot policy, and non-persistent disks mounted by ACK clusters are not applicable. After enabling auto snapshot policy, Alibaba Cloud will automatically create snapshots for cloud disks according to preset time points and cycles, enabling quick recovery from virus intrusion or ransomware attacks.\",\n\t\t\"zh\": \"ECS 磁盘设置了自动快照策略,视为合规。状态非使用中的磁盘、不支持设置自动快照策略的磁盘、ACK 集群挂载的非持久化使用场景的磁盘视为不适用。开启自动快照策略后,阿里云会自动按照预设的时间点和周期为云盘创建快照,遭遇病毒入侵或勒索后能够快速从安全事件中恢复。\",\n\t\t\"ja\": \"ECS ディスクに自動スナップショットポリシーが設定されている場合、準拠と見なされます。使用中でないディスク、自動スナップショットポリシーをサポートしないディスク、ACK クラスタによってマウントされた非永続化ディスクは適用されません。自動スナップショットポリシーを有効にすると、Alibaba Cloud は事前設定された時間とサイクルに従ってクラウドディスクのスナップショットを自動的に作成し、ウイルス侵入やランサムウェア攻撃から迅速に回復できるようにします。\",\n\t\t\"de\": \"ECS-Disk hat automatische Snapshot-Richtlinie konfiguriert, wird als konform betrachtet. Nicht verwendete Disks, Disks, die keine automatische Snapshot-Richtlinie unterstützen, und nicht persistente Disks, die von ACK-Clustern gemountet werden, sind nicht anwendbar. Nach Aktivierung der automatischen Snapshot-Richtlinie erstellt Alibaba Cloud automatisch Snapshots für Cloud-Disks gemäß voreingestellten Zeitpunkten und Zyklen, was eine schnelle Wiederherstellung nach Virenbefall oder Ransomware-Angriffen ermöglicht.\",\n\t\t\"es\": \"El disco ECS tiene política de snapshot automático configurada, considerada conforme. Los discos no en uso, discos que no admiten política de snapshot automático y discos no persistentes montados por clústeres ACK no son aplicables. Después de habilitar la política de snapshot automático, Alibaba Cloud creará automáticamente snapshots para discos en la nube según puntos de tiempo y ciclos predefinidos, permitiendo recuperación rápida de intrusión de virus o ataques de ransomware.\",\n\t\t\"fr\": \"Le disque ECS a une politique de snapshot automatique configurée, considérée comme conforme. Les disques non utilisés, les disques qui ne prennent pas en charge la politique de snapshot automatique et les disques non persistants montés par les clusters ACK ne sont pas applicables. Après avoir activé la politique de snapshot automatique, Alibaba Cloud créera automatiquement des snapshots pour les disques cloud selon les points de temps et cycles prédéfinis, permettant une récupération rapide après une intrusion de virus ou des attaques de ransomware.\",\n\t\t\"pt\": \"Disco ECS tem política de snapshot automático configurada, considerado conforme. Discos não em uso, discos que não suportam política de snapshot automático e discos não persistentes montados por clusters ACK não são aplicáveis. Após habilitar a política de snapshot automático, o Alibaba Cloud criará automaticamente snapshots para discos em nuvem de acordo com pontos de tempo e ciclos predefinidos, permitindo recuperação rápida de invasão de vírus ou ataques de ransomware.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS disk does not have auto snapshot policy configured\",\n\t\t\"zh\": \"ECS 磁盘未设置自动快照策略\",\n\t\t\"ja\": \"ECS ディスクに自動スナップショットポリシーが設定されていません\",\n\t\t\"de\": \"ECS-Disk hat keine automatische Snapshot-Richtlinie konfiguriert\",\n\t\t\"es\": \"El disco ECS no tiene política de snapshot automático configurada\",\n\t\t\"fr\": \"Le disque ECS n'a pas de politique de snapshot automatique configurée\",\n\t\t\"pt\": \"Disco ECS não tem política de snapshot automático configurada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure auto snapshot policy for ECS disk to enable automatic backup and quick recovery from security incidents\",\n\t\t\"zh\": \"为 ECS 磁盘配置自动快照策略以启用自动备份并快速从安全事件中恢复\",\n\t\t\"ja\": \"自動バックアップを有効にし、セキュリティインシデントから迅速に回復するために、ECS ディスクに自動スナップショットポリシーを設定します\",\n\t\t\"de\": \"Konfigurieren Sie eine automatische Snapshot-Richtlinie für ECS-Disks, um automatische Backups zu aktivieren und schnelle Wiederherstellung nach Sicherheitsvorfällen zu ermöglichen\",\n\t\t\"es\": \"Configure política de snapshot automático para disco ECS para habilitar backup automático y recuperación rápida de incidentes de seguridad\",\n\t\t\"fr\": \"Configurez une politique de snapshot automatique pour le disque ECS pour activer la sauvegarde automatique et la récupération rapide après des incidents de sécurité\",\n\t\t\"pt\": \"Configure política de snapshot automático para disco ECS para habilitar backup automático e recuperação rápida de incidentes de segurança\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\n\t# Check if AutoSnapshotPolicyId is configured\n\tnot helpers.has_property(resource, \"AutoSnapshotPolicyId\")\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-disk-encrypted", Name: models.I18nString{"de": "ECS-Datendisk-Verschlüsselung aktiviert", "en": "ECS data disk encryption enabled", "es": "Criptografía de disco de datos ECS habilitada", "fr": "Chiffrement du disque de données ECS activé", "ja": "ECS データディスクの暗号化が有効", "pt": "Criptografia de disco de dados ECS habilitada", "zh": "ECS 数据磁盘开启加密"}, Severity: "medium", Description: models.I18nString{"de": "ECS-Datendisk hat Verschlüsselung aktiviert, wird als konform betrachtet.", "en": "ECS data disk has encryption enabled, considered compliant.", "es": "El disco de datos ECS tiene cifrado habilitado, se considera conforme.", "fr": "Le disque de données ECS a le chiffrement activé, considéré comme conforme.", "ja": "ECS データディスクで暗号化が有効になっている場合、準拠と見なされます。", "pt": "O disco de dados ECS tem criptografia habilitada, considerado conforme.", "zh": "ECS 数据磁盘已开启加密,视为合规。"}, Reason: models.I18nString{"de": "ECS-Datendisk hat keine Verschlüsselung aktiviert", "en": "ECS data disk does not have encryption enabled", "es": "El disco de datos ECS no tiene cifrado habilitado", "fr": "Le disque de données ECS n'a pas le chiffrement activé", "ja": "ECS データディスクで暗号化が有効になっていません", "pt": "O disco de dados ECS não tem criptografia habilitada", "zh": "ECS 数据磁盘未开启加密"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Verschlüsselung für ECS-Datendisks, um ruhende Daten zu schützen", "en": "Enable encryption for ECS data disk to protect data at rest", "es": "Habilite el cifrado para el disco de datos ECS para proteger los datos en reposo", "fr": "Activez le chiffrement pour le disque de données ECS pour protéger les données au repos", "ja": "保存データを保護するために、ECS データディスクで暗号化を有効にします", "pt": "Habilite criptografia para disco de dados ECS para proteger dados em repouso", "zh": "为 ECS 数据磁盘开启加密以保护静态数据"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-disk-encrypted.rego", PackageName: "infraguard.rules.aliyun.ecs_disk_encrypted", Content: "package infraguard.rules.aliyun.ecs_disk_encrypted\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-disk-encrypted\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS data disk encryption enabled\",\n\t\t\"zh\": \"ECS 数据磁盘开启加密\",\n\t\t\"ja\": \"ECS データディスクの暗号化が有効\",\n\t\t\"de\": \"ECS-Datendisk-Verschlüsselung aktiviert\",\n\t\t\"es\": \"Criptografía de disco de datos ECS habilitada\",\n\t\t\"fr\": \"Chiffrement du disque de données ECS activé\",\n\t\t\"pt\": \"Criptografia de disco de dados ECS habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS data disk has encryption enabled, considered compliant.\",\n\t\t\"zh\": \"ECS 数据磁盘已开启加密,视为合规。\",\n\t\t\"ja\": \"ECS データディスクで暗号化が有効になっている場合、準拠と見なされます。\",\n\t\t\"de\": \"ECS-Datendisk hat Verschlüsselung aktiviert, wird als konform betrachtet.\",\n\t\t\"es\": \"El disco de datos ECS tiene cifrado habilitado, se considera conforme.\",\n\t\t\"fr\": \"Le disque de données ECS a le chiffrement activé, considéré comme conforme.\",\n\t\t\"pt\": \"O disco de dados ECS tem criptografia habilitada, considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS data disk does not have encryption enabled\",\n\t\t\"zh\": \"ECS 数据磁盘未开启加密\",\n\t\t\"ja\": \"ECS データディスクで暗号化が有効になっていません\",\n\t\t\"de\": \"ECS-Datendisk hat keine Verschlüsselung aktiviert\",\n\t\t\"es\": \"El disco de datos ECS no tiene cifrado habilitado\",\n\t\t\"fr\": \"Le disque de données ECS n'a pas le chiffrement activé\",\n\t\t\"pt\": \"O disco de dados ECS não tem criptografia habilitada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable encryption for ECS data disk to protect data at rest\",\n\t\t\"zh\": \"为 ECS 数据磁盘开启加密以保护静态数据\",\n\t\t\"ja\": \"保存データを保護するために、ECS データディスクで暗号化を有効にします\",\n\t\t\"de\": \"Aktivieren Sie die Verschlüsselung für ECS-Datendisks, um ruhende Daten zu schützen\",\n\t\t\"es\": \"Habilite el cifrado para el disco de datos ECS para proteger los datos en reposo\",\n\t\t\"fr\": \"Activez le chiffrement pour le disque de données ECS pour protéger les données au repos\",\n\t\t\"pt\": \"Habilite criptografia para disco de dados ECS para proteger dados em repouso\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\n\t# Check if disk is encrypted\n\tencrypted := helpers.get_property(resource, \"Encrypted\", false)\n\tnot helpers.is_true(encrypted)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-disk-idle-check", Name: models.I18nString{"de": "ECS-Disk-Leerlaufprüfung", "en": "ECS Disk Idle Check", "es": "Verificación de Disco Inactivo ECS", "fr": "Vérification de Disque Inactif ECS", "ja": "ECS ディスクアイドルチェック", "pt": "Verificação de Disco Inativo ECS", "zh": "ECS 磁盘闲置检测"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Disks an eine Instanz angehängt sind und nicht im Leerlaufzustand sind.", "en": "Ensures that ECS disks are attached to an instance and not in an idle state.", "es": "Garantiza que los discos ECS estén adjuntos a una instancia y no en estado inactivo.", "fr": "Garantit que les disques ECS sont attachés à une instance et ne sont pas dans un état inactif.", "ja": "ECS ディスクがインスタンスに接続され、アイドル状態ではないことを確認します。", "pt": "Garante que os discos ECS estejam anexados a uma instância e não estejam em estado inativo.", "zh": "确保 ECS 磁盘已挂载到实例，未处于闲置状态。"}, Reason: models.I18nString{"de": "Leerlaufende Disks verursachen weiterhin Kosten und können ungenutzte Ressourcen darstellen.", "en": "Idle disks still incur costs and may represent unused resources.", "es": "Los discos inactivos aún generan costos y pueden representar recursos no utilizados.", "fr": "Les disques inactifs génèrent toujours des coûts et peuvent représenter des ressources non utilisées.", "ja": "アイドルディスクは依然としてコストがかかり、未使用のリソースを表している可能性があります。", "pt": "Discos inativos ainda geram custos e podem representar recursos não utilizados.", "zh": "闲置磁盘仍会产生费用，并且可能表示资源未被使用。"}, Recommendation: models.I18nString{"de": "Hängen Sie den Disk an eine Instanz an oder löschen Sie ihn, wenn er nicht mehr benötigt wird.", "en": "Attach the disk to an instance or delete it if it's no longer needed.", "es": "Adjunte el disco a una instancia o elimínelo si ya no es necesario.", "fr": "Attachez le disque à une instance ou supprimez-le s'il n'est plus nécessaire.", "ja": "ディスクをインスタンスに接続するか、不要になった場合は削除します。", "pt": "Anexe o disco a uma instância ou exclua-o se não for mais necessário.", "zh": "将磁盘挂载到实例，如果不再需要，则将其删除。"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-disk-idle-check.rego", PackageName: "infraguard.rules.aliyun.ecs_disk_idle_check", Content: "package infraguard.rules.aliyun.ecs_disk_idle_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ecs-disk-idle-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS Disk Idle Check\",\n\t\t\"zh\": \"ECS 磁盘闲置检测\",\n\t\t\"ja\": \"ECS ディスクアイドルチェック\",\n\t\t\"de\": \"ECS-Disk-Leerlaufprüfung\",\n\t\t\"es\": \"Verificación de Disco Inactivo ECS\",\n\t\t\"fr\": \"Vérification de Disque Inactif ECS\",\n\t\t\"pt\": \"Verificação de Disco Inativo ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ECS disks are attached to an instance and not in an idle state.\",\n\t\t\"zh\": \"确保 ECS 磁盘已挂载到实例，未处于闲置状态。\",\n\t\t\"ja\": \"ECS ディスクがインスタンスに接続され、アイドル状態ではないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Disks an eine Instanz angehängt sind und nicht im Leerlaufzustand sind.\",\n\t\t\"es\": \"Garantiza que los discos ECS estén adjuntos a una instancia y no en estado inactivo.\",\n\t\t\"fr\": \"Garantit que les disques ECS sont attachés à une instance et ne sont pas dans un état inactif.\",\n\t\t\"pt\": \"Garante que os discos ECS estejam anexados a uma instância e não estejam em estado inativo.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Idle disks still incur costs and may represent unused resources.\",\n\t\t\"zh\": \"闲置磁盘仍会产生费用，并且可能表示资源未被使用。\",\n\t\t\"ja\": \"アイドルディスクは依然としてコストがかかり、未使用のリソースを表している可能性があります。\",\n\t\t\"de\": \"Leerlaufende Disks verursachen weiterhin Kosten und können ungenutzte Ressourcen darstellen.\",\n\t\t\"es\": \"Los discos inactivos aún generan costos y pueden representar recursos no utilizados.\",\n\t\t\"fr\": \"Les disques inactifs génèrent toujours des coûts et peuvent représenter des ressources non utilisées.\",\n\t\t\"pt\": \"Discos inativos ainda geram custos e podem representar recursos não utilizados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach the disk to an instance or delete it if it's no longer needed.\",\n\t\t\"zh\": \"将磁盘挂载到实例，如果不再需要，则将其删除。\",\n\t\t\"ja\": \"ディスクをインスタンスに接続するか、不要になった場合は削除します。\",\n\t\t\"de\": \"Hängen Sie den Disk an eine Instanz an oder löschen Sie ihn, wenn er nicht mehr benötigt wird.\",\n\t\t\"es\": \"Adjunte el disco a una instancia o elimínelo si ya no es necesario.\",\n\t\t\"fr\": \"Attachez le disque à une instance ou supprimez-le s'il n'est plus nécessaire.\",\n\t\t\"pt\": \"Anexe o disco a uma instância ou exclua-o se não for mais necessário.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\n\t# Conceptual check for attachment\n\tnot helpers.has_property(resource, \"InstanceId\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-disk-in-use", Name: models.I18nString{"de": "ECS-Festplatte ist in Verwendung", "en": "ECS disk is in use", "es": "El Disco ECS Está en Uso", "fr": "Le Disque ECS est en Utilisation", "ja": "ECS ディスクが使用中", "pt": "O Disco ECS Está em Uso", "zh": "ECS 磁盘正在使用中"}, Severity: "medium", Description: models.I18nString{"de": "ECS-Festplatten sind an eine Instanz angehängt oder im Gebrauchszustand, was als konform gilt. Verfügbare oder nicht angehängte Festplatten können inaktive Ressourcen sein.", "en": "ECS disks are attached to an instance or in use state, considered compliant. Disks that are available or unattached may be idle resources.", "es": "Los discos ECS están adjuntos a una instancia o en estado de uso, considerado conforme. Los discos disponibles o no adjuntos pueden ser recursos inactivos.", "fr": "Les disques ECS sont attachés à une instance ou en état d'utilisation, considéré comme conforme. Les disques disponibles ou non attachés peuvent être des ressources inactives.", "ja": "ECS ディスクがインスタンスにアタッチされているか使用中状態であり、準拠と見なされます。利用可能またはアタッチされていないディスクはアイドルリソースである可能性があります。", "pt": "Os discos ECS estão anexados a uma instância ou em estado de uso, considerado conforme. Discos disponíveis ou não anexados podem ser recursos ociosos.", "zh": "ECS 磁盘已挂载到实例或处于使用中状态，视为合规。闲置或未挂载的磁盘可能造成资源浪费。"}, Reason: models.I18nString{"de": "ECS-Festplatte ist nicht in Verwendung (Verfügbarer Status oder nicht angehängt)", "en": "ECS disk is not in use (Available status or unattached)", "es": "El disco ECS no está en uso (estado disponible o no adjunto)", "fr": "Le disque ECS n'est pas en utilisation (statut disponible ou non attaché)", "ja": "ECS ディスクが使用されていない（利用可能な状態またはアタッチされていない）", "pt": "O disco ECS não está em uso (status disponível ou não anexado)", "zh": "ECS 磁盘未使用中（可用状态或未挂载）"}, Recommendation: models.I18nString{"de": "Hängen Sie die Festplatte an eine ECS-Instanz an oder geben Sie ungenutzte Festplatten frei, um Kosten zu sparen", "en": "Attach the disk to an ECS instance or release unused disks to save costs", "es": "Adjunte el disco a una instancia ECS o libere discos no utilizados para ahorrar costos", "fr": "Attachez le disque à une instance ECS ou libérez les disques non utilisés pour économiser des coûts", "ja": "ディスクを ECS インスタンスにアタッチするか、未使用のディスクを解放してコストを節約します", "pt": "Anexe o disco a uma instância ECS ou libere discos não utilizados para economizar custos", "zh": "将磁盘挂载到 ECS 实例，或释放未使用的磁盘以节省成本"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-disk-in-use.rego", PackageName: "infraguard.rules.aliyun.ecs_disk_in_use", Content: "package infraguard.rules.aliyun.ecs_disk_in_use\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-disk-in-use\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS disk is in use\",\n\t\t\"zh\": \"ECS 磁盘正在使用中\",\n\t\t\"ja\": \"ECS ディスクが使用中\",\n\t\t\"de\": \"ECS-Festplatte ist in Verwendung\",\n\t\t\"es\": \"El Disco ECS Está en Uso\",\n\t\t\"fr\": \"Le Disque ECS est en Utilisation\",\n\t\t\"pt\": \"O Disco ECS Está em Uso\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS disks are attached to an instance or in use state, considered compliant. Disks that are available or unattached may be idle resources.\",\n\t\t\"zh\": \"ECS 磁盘已挂载到实例或处于使用中状态，视为合规。闲置或未挂载的磁盘可能造成资源浪费。\",\n\t\t\"ja\": \"ECS ディスクがインスタンスにアタッチされているか使用中状態であり、準拠と見なされます。利用可能またはアタッチされていないディスクはアイドルリソースである可能性があります。\",\n\t\t\"de\": \"ECS-Festplatten sind an eine Instanz angehängt oder im Gebrauchszustand, was als konform gilt. Verfügbare oder nicht angehängte Festplatten können inaktive Ressourcen sein.\",\n\t\t\"es\": \"Los discos ECS están adjuntos a una instancia o en estado de uso, considerado conforme. Los discos disponibles o no adjuntos pueden ser recursos inactivos.\",\n\t\t\"fr\": \"Les disques ECS sont attachés à une instance ou en état d'utilisation, considéré comme conforme. Les disques disponibles ou non attachés peuvent être des ressources inactives.\",\n\t\t\"pt\": \"Os discos ECS estão anexados a uma instância ou em estado de uso, considerado conforme. Discos disponíveis ou não anexados podem ser recursos ociosos.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS disk is not in use (Available status or unattached)\",\n\t\t\"zh\": \"ECS 磁盘未使用中（可用状态或未挂载）\",\n\t\t\"ja\": \"ECS ディスクが使用されていない（利用可能な状態またはアタッチされていない）\",\n\t\t\"de\": \"ECS-Festplatte ist nicht in Verwendung (Verfügbarer Status oder nicht angehängt)\",\n\t\t\"es\": \"El disco ECS no está en uso (estado disponible o no adjunto)\",\n\t\t\"fr\": \"Le disque ECS n'est pas en utilisation (statut disponible ou non attaché)\",\n\t\t\"pt\": \"O disco ECS não está em uso (status disponível ou não anexado)\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach the disk to an ECS instance or release unused disks to save costs\",\n\t\t\"zh\": \"将磁盘挂载到 ECS 实例，或释放未使用的磁盘以节省成本\",\n\t\t\"ja\": \"ディスクを ECS インスタンスにアタッチするか、未使用のディスクを解放してコストを節約します\",\n\t\t\"de\": \"Hängen Sie die Festplatte an eine ECS-Instanz an oder geben Sie ungenutzte Festplatten frei, um Kosten zu sparen\",\n\t\t\"es\": \"Adjunte el disco a una instancia ECS o libere discos no utilizados para ahorrar costos\",\n\t\t\"fr\": \"Attachez le disque à une instance ECS ou libérez les disques non utilisés pour économiser des coûts\",\n\t\t\"pt\": \"Anexe o disco a uma instância ECS ou libere discos não utilizados para economizar custos\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\n\t# Disk is not in use if not referenced by DiskAttachment and not attached via InstanceId\n\tnot helpers.is_referenced_by_property(name, \"ALIYUN::ECS::DiskAttachment\", [\"DiskId\"])\n\tnot helpers.has_property(resource, \"InstanceId\")\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-disk-regional-auto-check", Name: models.I18nString{"de": "ECS-Disk-Zonenredundanter ESSD-Speicher", "en": "ECS Disk Zone-Redundant ESSD Storage", "es": "Almacenamiento ESSD con Redundancia de Zona de Disco ECS", "fr": "Stockage ESSD Redondant par Zone de Disque ECS", "ja": "ECS ディスクゾーン冗長 ESSD ストレージ", "pt": "Armazenamento ESSD com Redundância de Zona de Disco ECS", "zh": "使用同城冗余类型的 ESSD 数据盘"}, Severity: "low", Description: models.I18nString{"de": "ECS-Datendisks sollten zonenredundanten ESSD-Speicher für hohe Verfügbarkeit verwenden. Systemdisks sind für diese Regel nicht anwendbar.", "en": "ECS data disks should use zone-redundant ESSD storage for high availability. System disks are not applicable to this rule.", "es": "Los discos de datos ECS deben usar almacenamiento ESSD con redundancia de zona para alta disponibilidad. Los discos del sistema no son aplicables a esta regla.", "fr": "Les disques de données ECS doivent utiliser le stockage ESSD redondant par zone pour une haute disponibilité. Les disques système ne sont pas applicables à cette règle.", "ja": "ECS データディスクは高可用性のためにゾーン冗長 ESSD ストレージを使用する必要があります。システムディスクはこのルールには適用されません。", "pt": "Os discos de dados ECS devem usar armazenamento ESSD com redundância de zona para alta disponibilidade. Os discos do sistema não são aplicáveis a esta regra.", "zh": "使用同城冗余类型的 ESSD 数据盘，视为合规。系统盘视为不适用。"}, Reason: models.I18nString{"de": "Der ECS-Datendisk verwendet keinen zonenredundanten Speicher, was die Datenverfügbarkeit beeinträchtigen kann.", "en": "The ECS data disk does not use zone-redundant storage, which may affect data availability.", "es": "El disco de datos ECS no usa almacenamiento con redundancia de zona, lo que puede afectar la disponibilidad de datos.", "fr": "Le disque de données ECS n'utilise pas de stockage redondant par zone, ce qui peut affecter la disponibilité des données.", "ja": "ECS データディスクがゾーン冗長ストレージを使用していないため、データの可用性に影響を与える可能性があります。", "pt": "O disco de dados ECS não usa armazenamento com redundância de zona, o que pode afetar a disponibilidade dos dados.", "zh": "ECS 数据盘未使用同城冗余存储，可能影响数据可用性。"}, Recommendation: models.I18nString{"de": "Verwenden Sie zonenredundanten ESSD-Speicher, indem Sie DiskCategory auf 'cloud_regional_disk_auto' setzen oder 'cloud_essd' mit entsprechender Redundanzkonfiguration verwenden.", "en": "Use zone-redundant ESSD storage by setting DiskCategory to 'cloud_regional_disk_auto' or 'cloud_essd' with appropriate redundancy configuration.", "es": "Use almacenamiento ESSD con redundancia de zona estableciendo DiskCategory en 'cloud_regional_disk_auto' o 'cloud_essd' con configuración de redundancia apropiada.", "fr": "Utilisez le stockage ESSD redondant par zone en définissant DiskCategory sur 'cloud_regional_disk_auto' ou 'cloud_essd' avec une configuration de redondance appropriée.", "ja": "DiskCategory を 'cloud_regional_disk_auto' に設定するか、適切な冗長性設定で 'cloud_essd' を使用して、ゾーン冗長 ESSD ストレージを使用します。", "pt": "Use armazenamento ESSD com redundância de zona definindo DiskCategory como 'cloud_regional_disk_auto' ou 'cloud_essd' com configuração de redundância apropriada.", "zh": "通过将 DiskCategory 设置为'cloud_regional_disk_auto'或配置适当冗余的'cloud_essd'来使用同城冗余 ESSD 存储。"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-disk-regional-auto-check.rego", PackageName: "infraguard.rules.aliyun.ecs_disk_regional_auto_check", Content: "package infraguard.rules.aliyun.ecs_disk_regional_auto_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ecs-disk-regional-auto-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS Disk Zone-Redundant ESSD Storage\",\n\t\t\"zh\": \"使用同城冗余类型的 ESSD 数据盘\",\n\t\t\"ja\": \"ECS ディスクゾーン冗長 ESSD ストレージ\",\n\t\t\"de\": \"ECS-Disk-Zonenredundanter ESSD-Speicher\",\n\t\t\"es\": \"Almacenamiento ESSD con Redundancia de Zona de Disco ECS\",\n\t\t\"fr\": \"Stockage ESSD Redondant par Zone de Disque ECS\",\n\t\t\"pt\": \"Armazenamento ESSD com Redundância de Zona de Disco ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS data disks should use zone-redundant ESSD storage for high availability. System disks are not applicable to this rule.\",\n\t\t\"zh\": \"使用同城冗余类型的 ESSD 数据盘，视为合规。系统盘视为不适用。\",\n\t\t\"ja\": \"ECS データディスクは高可用性のためにゾーン冗長 ESSD ストレージを使用する必要があります。システムディスクはこのルールには適用されません。\",\n\t\t\"de\": \"ECS-Datendisks sollten zonenredundanten ESSD-Speicher für hohe Verfügbarkeit verwenden. Systemdisks sind für diese Regel nicht anwendbar.\",\n\t\t\"es\": \"Los discos de datos ECS deben usar almacenamiento ESSD con redundancia de zona para alta disponibilidad. Los discos del sistema no son aplicables a esta regla.\",\n\t\t\"fr\": \"Les disques de données ECS doivent utiliser le stockage ESSD redondant par zone pour une haute disponibilité. Les disques système ne sont pas applicables à cette règle.\",\n\t\t\"pt\": \"Os discos de dados ECS devem usar armazenamento ESSD com redundância de zona para alta disponibilidade. Os discos do sistema não são aplicáveis a esta regra.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ECS data disk does not use zone-redundant storage, which may affect data availability.\",\n\t\t\"zh\": \"ECS 数据盘未使用同城冗余存储，可能影响数据可用性。\",\n\t\t\"ja\": \"ECS データディスクがゾーン冗長ストレージを使用していないため、データの可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Der ECS-Datendisk verwendet keinen zonenredundanten Speicher, was die Datenverfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"El disco de datos ECS no usa almacenamiento con redundancia de zona, lo que puede afectar la disponibilidad de datos.\",\n\t\t\"fr\": \"Le disque de données ECS n'utilise pas de stockage redondant par zone, ce qui peut affecter la disponibilité des données.\",\n\t\t\"pt\": \"O disco de dados ECS não usa armazenamento com redundância de zona, o que pode afetar a disponibilidade dos dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use zone-redundant ESSD storage by setting DiskCategory to 'cloud_regional_disk_auto' or 'cloud_essd' with appropriate redundancy configuration.\",\n\t\t\"zh\": \"通过将 DiskCategory 设置为'cloud_regional_disk_auto'或配置适当冗余的'cloud_essd'来使用同城冗余 ESSD 存储。\",\n\t\t\"ja\": \"DiskCategory を 'cloud_regional_disk_auto' に設定するか、適切な冗長性設定で 'cloud_essd' を使用して、ゾーン冗長 ESSD ストレージを使用します。\",\n\t\t\"de\": \"Verwenden Sie zonenredundanten ESSD-Speicher, indem Sie DiskCategory auf 'cloud_regional_disk_auto' setzen oder 'cloud_essd' mit entsprechender Redundanzkonfiguration verwenden.\",\n\t\t\"es\": \"Use almacenamiento ESSD con redundancia de zona estableciendo DiskCategory en 'cloud_regional_disk_auto' o 'cloud_essd' con configuración de redundancia apropiada.\",\n\t\t\"fr\": \"Utilisez le stockage ESSD redondant par zone en définissant DiskCategory sur 'cloud_regional_disk_auto' ou 'cloud_essd' avec une configuration de redondance appropriée.\",\n\t\t\"pt\": \"Use armazenamento ESSD com redundância de zona definindo DiskCategory como 'cloud_regional_disk_auto' ou 'cloud_essd' com configuração de redundância apropriada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\n# Check if disk is zone-redundant\nis_zone_redundant(resource) if {\n\tdisk_category := resource.Properties.DiskCategory\n\tdisk_category == \"cloud_regional_disk_auto\"\n}\n\n# Check if disk is attached to an instance (system disks are created with instance)\nis_data_disk(resource) if {\n\t# Data disks don't have InstanceId set (they are created separately)\n\tnot helpers.has_property(resource, \"InstanceId\")\n}\n\n# Deny rule: ECS data disks should use zone-redundant storage\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\n\t# Only check data disks\n\tis_data_disk(resource)\n\n\t# Check if not zone-redundant\n\tnot is_zone_redundant(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DiskCategory\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-disk-retain-auto-snapshot", Name: models.I18nString{"de": "Automatische Momentaufnahme beibehalten, wenn ECS-Festplatte freigegeben wird", "en": "Retain auto snapshot when ECS disk is released", "es": "Retener Instantánea Automática cuando se Libera el Disco ECS", "fr": "Conserver l'Instantané Automatique lors de la Libération du Disque ECS", "ja": "ECS ディスク解放時に自動スナップショットを保持", "pt": "Reter Instantâneo Automático quando o Disco ECS é Liberado", "zh": "ECS 数据磁盘释放时保留自动快照"}, Severity: "medium", Description: models.I18nString{"de": "Konfigurieren Sie ECS-Festplatten so, dass automatische Momentaufnahmen beim Freigeben beibehalten werden, was als konform gilt. Dies hilft, Daten vor versehentlichem Löschen zu schützen.", "en": "Configure ECS disks to retain auto snapshots when released, considered compliant. This helps protect data from accidental deletion.", "es": "Configure los discos ECS para retener instantáneas automáticas cuando se liberen, considerado conforme. Esto ayuda a proteger los datos de eliminación accidental.", "fr": "Configurez les disques ECS pour conserver les instantanés automatiques lors de la libération, considéré comme conforme. Cela aide à protéger les données contre la suppression accidentelle.", "ja": "ECS ディスクが解放されたときに自動スナップショットを保持するように設定し、準拠と見なされます。これは、誤削除からデータを保護するのに役立ちます。", "pt": "Configure os discos ECS para reter instantâneos automáticos quando liberados, considerado conforme. Isso ajuda a proteger os dados contra exclusão acidental.", "zh": "设置 ECS 磁盘释放时保留自动快照，视为合规。这有助于防止数据意外删除。"}, Reason: models.I18nString{"de": "ECS-Festplatte löscht automatische Momentaufnahmen beim Freigeben, was Datenverlust riskiert", "en": "ECS disk will delete auto snapshots when released, risking data loss", "es": "El disco ECS eliminará instantáneas automáticas cuando se libere, arriesgando pérdida de datos", "fr": "Le disque ECS supprimera les instantanés automatiques lors de la libération, risquant une perte de données", "ja": "ECS ディスクは解放時に自動スナップショットを削除し、データ損失のリスクがあります", "pt": "O disco ECS excluirá instantâneos automáticos quando liberado, arriscando perda de dados", "zh": "ECS 磁盘释放时将删除自动快照，可能导致数据丢失"}, Recommendation: models.I18nString{"de": "Setzen Sie DeleteAutoSnapshot auf false, um automatische Momentaufnahmen beim Freigeben der Festplatte beizubehalten", "en": "Set DeleteAutoSnapshot to false to retain auto snapshots when disk is released", "es": "Establezca DeleteAutoSnapshot en false para retener instantáneas automáticas cuando se libere el disco", "fr": "Définissez DeleteAutoSnapshot sur false pour conserver les instantanés automatiques lorsque le disque est libéré", "ja": "ディスクが解放されたときに自動スナップショットを保持するために、DeleteAutoSnapshot を false に設定します", "pt": "Defina DeleteAutoSnapshot como false para reter instantâneos automáticos quando o disco for liberado", "zh": "将 DeleteAutoSnapshot 设置为 false 以在磁盘释放时保留自动快照"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-disk-retain-auto-snapshot.rego", PackageName: "infraguard.rules.aliyun.ecs_disk_retain_auto_snapshot", Content: "package infraguard.rules.aliyun.ecs_disk_retain_auto_snapshot\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-disk-retain-auto-snapshot\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Retain auto snapshot when ECS disk is released\",\n\t\t\"zh\": \"ECS 数据磁盘释放时保留自动快照\",\n\t\t\"ja\": \"ECS ディスク解放時に自動スナップショットを保持\",\n\t\t\"de\": \"Automatische Momentaufnahme beibehalten, wenn ECS-Festplatte freigegeben wird\",\n\t\t\"es\": \"Retener Instantánea Automática cuando se Libera el Disco ECS\",\n\t\t\"fr\": \"Conserver l'Instantané Automatique lors de la Libération du Disque ECS\",\n\t\t\"pt\": \"Reter Instantâneo Automático quando o Disco ECS é Liberado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Configure ECS disks to retain auto snapshots when released, considered compliant. This helps protect data from accidental deletion.\",\n\t\t\"zh\": \"设置 ECS 磁盘释放时保留自动快照，视为合规。这有助于防止数据意外删除。\",\n\t\t\"ja\": \"ECS ディスクが解放されたときに自動スナップショットを保持するように設定し、準拠と見なされます。これは、誤削除からデータを保護するのに役立ちます。\",\n\t\t\"de\": \"Konfigurieren Sie ECS-Festplatten so, dass automatische Momentaufnahmen beim Freigeben beibehalten werden, was als konform gilt. Dies hilft, Daten vor versehentlichem Löschen zu schützen.\",\n\t\t\"es\": \"Configure los discos ECS para retener instantáneas automáticas cuando se liberen, considerado conforme. Esto ayuda a proteger los datos de eliminación accidental.\",\n\t\t\"fr\": \"Configurez les disques ECS pour conserver les instantanés automatiques lors de la libération, considéré comme conforme. Cela aide à protéger les données contre la suppression accidentelle.\",\n\t\t\"pt\": \"Configure os discos ECS para reter instantâneos automáticos quando liberados, considerado conforme. Isso ajuda a proteger os dados contra exclusão acidental.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS disk will delete auto snapshots when released, risking data loss\",\n\t\t\"zh\": \"ECS 磁盘释放时将删除自动快照，可能导致数据丢失\",\n\t\t\"ja\": \"ECS ディスクは解放時に自動スナップショットを削除し、データ損失のリスクがあります\",\n\t\t\"de\": \"ECS-Festplatte löscht automatische Momentaufnahmen beim Freigeben, was Datenverlust riskiert\",\n\t\t\"es\": \"El disco ECS eliminará instantáneas automáticas cuando se libere, arriesgando pérdida de datos\",\n\t\t\"fr\": \"Le disque ECS supprimera les instantanés automatiques lors de la libération, risquant une perte de données\",\n\t\t\"pt\": \"O disco ECS excluirá instantâneos automáticos quando liberado, arriscando perda de dados\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set DeleteAutoSnapshot to false to retain auto snapshots when disk is released\",\n\t\t\"zh\": \"将 DeleteAutoSnapshot 设置为 false 以在磁盘释放时保留自动快照\",\n\t\t\"ja\": \"ディスクが解放されたときに自動スナップショットを保持するために、DeleteAutoSnapshot を false に設定します\",\n\t\t\"de\": \"Setzen Sie DeleteAutoSnapshot auf false, um automatische Momentaufnahmen beim Freigeben der Festplatte beizubehalten\",\n\t\t\"es\": \"Establezca DeleteAutoSnapshot en false para retener instantáneas automáticas cuando se libere el disco\",\n\t\t\"fr\": \"Définissez DeleteAutoSnapshot sur false pour conserver les instantanés automatiques lorsque le disque est libéré\",\n\t\t\"pt\": \"Defina DeleteAutoSnapshot como false para reter instantâneos automáticos quando o disco for liberado\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\n\t# Check if auto snapshots will be retained\n\tdelete_auto_snapshot := helpers.get_property(resource, \"DeleteAutoSnapshot\", false)\n\thelpers.is_true(delete_auto_snapshot)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeleteAutoSnapshot\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-in-use-disk-encrypted", Name: models.I18nString{"de": "ECS-Disk-Verschlüsselung in Verwendung", "en": "ECS In-Use Disk Encryption", "es": "Cifrado de Disco en Uso de ECS", "fr": "Chiffrement de Disque en Utilisation ECS", "ja": "ECS 使用中ディスクの暗号化", "pt": "Criptografia de Disco em Uso ECS", "zh": "使用中的 ECS 数据磁盘开启加密"}, Severity: "medium", Description: models.I18nString{"de": "ECS-Datendisks sollten Verschlüsselung aktiviert haben, um ruhende Daten zu schützen. Verschlüsselte Disks verwenden KMS-Schlüssel zur Datenverschlüsselung und gewährleisten Datensicherheit und Compliance mit regulatorischen Anforderungen.", "en": "ECS data disks should have encryption enabled to protect data at rest. Encrypted disks use KMS keys to encrypt data, ensuring data security and compliance with regulatory requirements.", "es": "Los discos de datos ECS deben tener cifrado habilitado para proteger los datos en reposo. Los discos cifrados usan claves KMS para cifrar datos, asegurando la seguridad de los datos y el cumplimiento de los requisitos regulatorios.", "fr": "Les disques de données ECS doivent avoir le chiffrement activé pour protéger les données au repos. Les disques chiffrés utilisent des clés KMS pour chiffrer les données, garantissant la sécurité des données et la conformité aux exigences réglementaires.", "ja": "ECS データディスクは、保存データを保護するために暗号化を有効にする必要があります。暗号化されたディスクは KMS キーを使用してデータを暗号化し、データのセキュリティと規制要件への準拠を確保します。", "pt": "Discos de dados ECS devem ter criptografia habilitada para proteger dados em repouso. Discos criptografados usam chaves KMS para criptografar dados, garantindo segurança de dados e conformidade com requisitos regulatórios.", "zh": "使用中的 ECS 数据磁盘应开启加密以保护静态数据。加密磁盘使用 KMS 密钥对数据进行加密，确保数据安全并符合合规要求。"}, Reason: models.I18nString{"de": "Die ECS-Disk hat keine Verschlüsselung aktiviert, was sensible Daten unbefugtem Zugriff aussetzen kann.", "en": "The ECS disk does not have encryption enabled, which may expose sensitive data to unauthorized access.", "es": "El disco ECS no tiene cifrado habilitado, lo que puede exponer datos sensibles a acceso no autorizado.", "fr": "Le disque ECS n'a pas le chiffrement activé, ce qui peut exposer des données sensibles à un accès non autorisé.", "ja": "ECS ディスクで暗号化が有効になっていないため、機密データが不正アクセスにさらされる可能性があります。", "pt": "O disco ECS não tem criptografia habilitada, o que pode expor dados sensíveis a acesso não autorizado.", "zh": "ECS 磁盘未开启加密，可能导致敏感数据暴露给未授权访问。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Verschlüsselung für die ECS-Disk, indem Sie die Encrypted-Eigenschaft auf true setzen.", "en": "Enable encryption for the ECS disk by setting the Encrypted property to true.", "es": "Habilite el cifrado para el disco ECS estableciendo la propiedad Encrypted en true.", "fr": "Activez le chiffrement pour le disque ECS en définissant la propriété Encrypted sur true.", "ja": "Encrypted プロパティを true に設定して、ECS ディスクの暗号化を有効にします。", "pt": "Habilite criptografia para o disco ECS definindo a propriedade Encrypted como true.", "zh": "通过将 Encrypted 属性设置为 true 来为 ECS 磁盘启用加密。"}, ResourceTypes: []string{"ALIYUN::ECS::Disk"}, FilePath: "aliyun/rules/ecs-in-use-disk-encrypted.rego", PackageName: "infraguard.rules.aliyun.ecs_in_use_disk_encrypted", Content: "package infraguard.rules.aliyun.ecs_in_use_disk_encrypted\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-in-use-disk-encrypted\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS In-Use Disk Encryption\",\n\t\t\"zh\": \"使用中的 ECS 数据磁盘开启加密\",\n\t\t\"ja\": \"ECS 使用中ディスクの暗号化\",\n\t\t\"de\": \"ECS-Disk-Verschlüsselung in Verwendung\",\n\t\t\"es\": \"Cifrado de Disco en Uso de ECS\",\n\t\t\"fr\": \"Chiffrement de Disque en Utilisation ECS\",\n\t\t\"pt\": \"Criptografia de Disco em Uso ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS data disks should have encryption enabled to protect data at rest. Encrypted disks use KMS keys to encrypt data, ensuring data security and compliance with regulatory requirements.\",\n\t\t\"zh\": \"使用中的 ECS 数据磁盘应开启加密以保护静态数据。加密磁盘使用 KMS 密钥对数据进行加密，确保数据安全并符合合规要求。\",\n\t\t\"ja\": \"ECS データディスクは、保存データを保護するために暗号化を有効にする必要があります。暗号化されたディスクは KMS キーを使用してデータを暗号化し、データのセキュリティと規制要件への準拠を確保します。\",\n\t\t\"de\": \"ECS-Datendisks sollten Verschlüsselung aktiviert haben, um ruhende Daten zu schützen. Verschlüsselte Disks verwenden KMS-Schlüssel zur Datenverschlüsselung und gewährleisten Datensicherheit und Compliance mit regulatorischen Anforderungen.\",\n\t\t\"es\": \"Los discos de datos ECS deben tener cifrado habilitado para proteger los datos en reposo. Los discos cifrados usan claves KMS para cifrar datos, asegurando la seguridad de los datos y el cumplimiento de los requisitos regulatorios.\",\n\t\t\"fr\": \"Les disques de données ECS doivent avoir le chiffrement activé pour protéger les données au repos. Les disques chiffrés utilisent des clés KMS pour chiffrer les données, garantissant la sécurité des données et la conformité aux exigences réglementaires.\",\n\t\t\"pt\": \"Discos de dados ECS devem ter criptografia habilitada para proteger dados em repouso. Discos criptografados usam chaves KMS para criptografar dados, garantindo segurança de dados e conformidade com requisitos regulatórios.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ECS disk does not have encryption enabled, which may expose sensitive data to unauthorized access.\",\n\t\t\"zh\": \"ECS 磁盘未开启加密，可能导致敏感数据暴露给未授权访问。\",\n\t\t\"ja\": \"ECS ディスクで暗号化が有効になっていないため、機密データが不正アクセスにさらされる可能性があります。\",\n\t\t\"de\": \"Die ECS-Disk hat keine Verschlüsselung aktiviert, was sensible Daten unbefugtem Zugriff aussetzen kann.\",\n\t\t\"es\": \"El disco ECS no tiene cifrado habilitado, lo que puede exponer datos sensibles a acceso no autorizado.\",\n\t\t\"fr\": \"Le disque ECS n'a pas le chiffrement activé, ce qui peut exposer des données sensibles à un accès non autorisé.\",\n\t\t\"pt\": \"O disco ECS não tem criptografia habilitada, o que pode expor dados sensíveis a acesso não autorizado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable encryption for the ECS disk by setting the Encrypted property to true.\",\n\t\t\"zh\": \"通过将 Encrypted 属性设置为 true 来为 ECS 磁盘启用加密。\",\n\t\t\"ja\": \"Encrypted プロパティを true に設定して、ECS ディスクの暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Verschlüsselung für die ECS-Disk, indem Sie die Encrypted-Eigenschaft auf true setzen.\",\n\t\t\"es\": \"Habilite el cifrado para el disco ECS estableciendo la propiedad Encrypted en true.\",\n\t\t\"fr\": \"Activez le chiffrement pour le disque ECS en définissant la propriété Encrypted sur true.\",\n\t\t\"pt\": \"Habilite criptografia para o disco ECS definindo a propriedade Encrypted como true.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Disk\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::Disk\")\n\tnot is_encrypted(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Encrypted\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nis_encrypted(resource) if {\n\tresource.Properties.Encrypted == true\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-attached-security-group", Name: models.I18nString{"de": "ECS-Instanz Sicherheitsgruppe angehängt", "en": "ECS Instance Attached Security Group", "es": "Instancia ECS con Grupo de Seguridad Adjunto", "fr": "Instance ECS avec Groupe de Sécurité Attaché", "ja": "ECS インスタンスにセキュリティグループがアタッチされている", "pt": "Instância ECS com Grupo de Segurança Anexado", "zh": "ECS 实例绑定安全组"}, Severity: "high", Description: models.I18nString{"de": "Wenn die ECS-Instanz in der angegebenen Sicherheitsgruppe enthalten ist, wird die Konfiguration als konform betrachtet.", "en": "If the ECS instance is included in the specified security group, the configuration is considered compliant.", "es": "Si la instancia ECS está incluida en el grupo de seguridad especificado, la configuración se considera conforme.", "fr": "Si l'instance ECS est incluse dans le groupe de sécurité spécifié, la configuration est considérée comme conforme.", "ja": "ECS インスタンスが指定されたセキュリティグループに含まれている場合、設定は準拠していると見なされます。", "pt": "Se a instância ECS estiver incluída no grupo de segurança especificado, a configuração é considerada conforme.", "zh": "如果 ECS 实例已关联指定的安全组，则视为合规。"}, Reason: models.I18nString{"de": "Die ECS-Instanz ist keiner Sicherheitsgruppe angehängt, was zu fehlender ordnungsgemäßer Netzwerkzugriffskontrolle führen kann.", "en": "The ECS instance is not attached to any security group, which may leave it without proper network access control.", "es": "La instancia ECS no está adjunta a ningún grupo de seguridad, lo que puede dejarla sin control adecuado de acceso a la red.", "fr": "L'instance ECS n'est attachée à aucun groupe de sécurité, ce qui peut la laisser sans contrôle d'accès réseau approprié.", "ja": "ECS インスタンスがセキュリティグループにアタッチされていないため、適切なネットワークアクセス制御が欠如している可能性があります。", "pt": "A instância ECS não está anexada a nenhum grupo de segurança, o que pode deixá-la sem controle adequado de acesso à rede.", "zh": "ECS 实例未关联任何安全组，可能导致缺乏适当的网络访问控制。"}, Recommendation: models.I18nString{"de": "Hängen Sie die ECS-Instanz an mindestens eine Sicherheitsgruppe an, indem Sie die Eigenschaft SecurityGroupId oder SecurityGroupIds setzen.", "en": "Attach the ECS instance to at least one security group by setting SecurityGroupId or SecurityGroupIds property.", "es": "Adjunte la instancia ECS a al menos un grupo de seguridad estableciendo la propiedad SecurityGroupId o SecurityGroupIds.", "fr": "Attachez l'instance ECS à au moins un groupe de sécurité en définissant la propriété SecurityGroupId ou SecurityGroupIds.", "ja": "SecurityGroupId または SecurityGroupIds プロパティを設定して、ECS インスタンスを少なくとも1つのセキュリティグループにアタッチします。", "pt": "Anexe a instância ECS a pelo menos um grupo de segurança definindo a propriedade SecurityGroupId ou SecurityGroupIds.", "zh": "通过设置 SecurityGroupId 或 SecurityGroupIds 属性，将 ECS 实例关联至少一个安全组。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-attached-security-group.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_attached_security_group", Content: "package infraguard.rules.aliyun.ecs_instance_attached_security_group\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-attached-security-group\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Attached Security Group\",\n\t\t\"zh\": \"ECS 实例绑定安全组\",\n\t\t\"ja\": \"ECS インスタンスにセキュリティグループがアタッチされている\",\n\t\t\"de\": \"ECS-Instanz Sicherheitsgruppe angehängt\",\n\t\t\"es\": \"Instancia ECS con Grupo de Seguridad Adjunto\",\n\t\t\"fr\": \"Instance ECS avec Groupe de Sécurité Attaché\",\n\t\t\"pt\": \"Instância ECS com Grupo de Segurança Anexado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"If the ECS instance is included in the specified security group, the configuration is considered compliant.\",\n\t\t\"zh\": \"如果 ECS 实例已关联指定的安全组，则视为合规。\",\n\t\t\"ja\": \"ECS インスタンスが指定されたセキュリティグループに含まれている場合、設定は準拠していると見なされます。\",\n\t\t\"de\": \"Wenn die ECS-Instanz in der angegebenen Sicherheitsgruppe enthalten ist, wird die Konfiguration als konform betrachtet.\",\n\t\t\"es\": \"Si la instancia ECS está incluida en el grupo de seguridad especificado, la configuración se considera conforme.\",\n\t\t\"fr\": \"Si l'instance ECS est incluse dans le groupe de sécurité spécifié, la configuration est considérée comme conforme.\",\n\t\t\"pt\": \"Se a instância ECS estiver incluída no grupo de segurança especificado, a configuração é considerada conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ECS instance is not attached to any security group, which may leave it without proper network access control.\",\n\t\t\"zh\": \"ECS 实例未关联任何安全组，可能导致缺乏适当的网络访问控制。\",\n\t\t\"ja\": \"ECS インスタンスがセキュリティグループにアタッチされていないため、適切なネットワークアクセス制御が欠如している可能性があります。\",\n\t\t\"de\": \"Die ECS-Instanz ist keiner Sicherheitsgruppe angehängt, was zu fehlender ordnungsgemäßer Netzwerkzugriffskontrolle führen kann.\",\n\t\t\"es\": \"La instancia ECS no está adjunta a ningún grupo de seguridad, lo que puede dejarla sin control adecuado de acceso a la red.\",\n\t\t\"fr\": \"L'instance ECS n'est attachée à aucun groupe de sécurité, ce qui peut la laisser sans contrôle d'accès réseau approprié.\",\n\t\t\"pt\": \"A instância ECS não está anexada a nenhum grupo de segurança, o que pode deixá-la sem controle adequado de acesso à rede.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach the ECS instance to at least one security group by setting SecurityGroupId or SecurityGroupIds property.\",\n\t\t\"zh\": \"通过设置 SecurityGroupId 或 SecurityGroupIds 属性，将 ECS 实例关联至少一个安全组。\",\n\t\t\"ja\": \"SecurityGroupId または SecurityGroupIds プロパティを設定して、ECS インスタンスを少なくとも1つのセキュリティグループにアタッチします。\",\n\t\t\"de\": \"Hängen Sie die ECS-Instanz an mindestens eine Sicherheitsgruppe an, indem Sie die Eigenschaft SecurityGroupId oder SecurityGroupIds setzen.\",\n\t\t\"es\": \"Adjunte la instancia ECS a al menos un grupo de seguridad estableciendo la propiedad SecurityGroupId o SecurityGroupIds.\",\n\t\t\"fr\": \"Attachez l'instance ECS à au moins un groupe de sécurité en définissant la propriété SecurityGroupId ou SecurityGroupIds.\",\n\t\t\"pt\": \"Anexe a instância ECS a pelo menos um grupo de segurança definindo a propriedade SecurityGroupId ou SecurityGroupIds.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\n# Check if the instance has SecurityGroupId set\nhas_security_group_id(resource) if {\n\thelpers.has_property(resource, \"SecurityGroupId\")\n\tresource.Properties.SecurityGroupId != \"\"\n}\n\n# Check if the instance has SecurityGroupIds set with at least one entry\nhas_security_group_ids(resource) if {\n\thelpers.has_property(resource, \"SecurityGroupIds\")\n\tcount(resource.Properties.SecurityGroupIds) > 0\n}\n\n# Instance is attached to security group if either property is set\nis_attached_to_security_group(resource) if {\n\thas_security_group_id(resource)\n}\n\nis_attached_to_security_group(resource) if {\n\thas_security_group_ids(resource)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types({\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"})\n\tnot is_attached_to_security_group(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-auto-renewal-enabled", Name: models.I18nString{"de": "ECS-Abonnement-Instanz hat automatische Verlängerung aktiviert", "en": "ECS subscription instance has auto-renewal enabled", "es": "Instancia de suscripción ECS tiene renovación automática habilitada", "fr": "Instance d'abonnement ECS a le renouvellement automatique activé", "ja": "ECS サブスクリプションインスタンスで自動更新が有効", "pt": "Instância de assinatura ECS tem renovação automática habilitada", "zh": "ECS 包年包月实例开启自动续费"}, Severity: "medium", Description: models.I18nString{"de": "ECS-Abonnement-Instanzen (vorausbezahlt) haben automatische Verlängerung aktiviert, werden als konform betrachtet. Pay-as-you-go-Instanzen sind nicht anwendbar.", "en": "ECS subscription (prepaid) instances have auto-renewal enabled, considered compliant. Pay-as-you-go instances are not applicable.", "es": "Las instancias de suscripción ECS (prepagadas) tienen renovación automática habilitada, consideradas conformes. Las instancias de pago por uso no son aplicables.", "fr": "Les instances d'abonnement ECS (prépayées) ont le renouvellement automatique activé, considérées comme conformes. Les instances à la demande ne sont pas applicables.", "ja": "ECS サブスクリプション（プリペイド）インスタンスで自動更新が有効になっている場合、準拠と見なされます。従量課金インスタンスは適用されません。", "pt": "Instâncias de assinatura ECS (pré-pagas) têm renovação automática habilitada, consideradas conformes. Instâncias pay-as-you-go não são aplicáveis.", "zh": "ECS 包年包月的实例开启自动续费，视为合规。按量付费的实例不适用本规则。"}, Reason: models.I18nString{"de": "ECS-Abonnement-Instanz hat keine automatische Verlängerung aktiviert", "en": "ECS subscription instance does not have auto-renewal enabled", "es": "La instancia de suscripción ECS no tiene renovación automática habilitada", "fr": "L'instance d'abonnement ECS n'a pas le renouvellement automatique activé", "ja": "ECS サブスクリプションインスタンスで自動更新が有効になっていません", "pt": "Instância de assinatura ECS não tem renovação automática habilitada", "zh": "ECS 包年包月实例未开启自动续费"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Verlängerung für Abonnement-Instanzen, um Dienstunterbrechungen aufgrund von Ablauf zu vermeiden", "en": "Enable auto-renewal for subscription instances to avoid service interruption due to expiration", "es": "Habilite la renovación automática para instancias de suscripción para evitar la interrupción del servicio debido a la expiración", "fr": "Activez le renouvellement automatique pour les instances d'abonnement pour éviter l'interruption de service due à l'expiration", "ja": "有効期限によるサービス中断を避けるために、サブスクリプションインスタンスで自動更新を有効にします", "pt": "Habilite renovação automática para instâncias de assinatura para evitar interrupção do serviço devido à expiração", "zh": "为订阅实例启用自动续费，避免因到期导致服务中断"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-auto-renewal-enabled.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_auto_renewal_enabled", Content: "package infraguard.rules.aliyun.ecs_instance_auto_renewal_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-auto-renewal-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS subscription instance has auto-renewal enabled\",\n\t\t\"zh\": \"ECS 包年包月实例开启自动续费\",\n\t\t\"ja\": \"ECS サブスクリプションインスタンスで自動更新が有効\",\n\t\t\"de\": \"ECS-Abonnement-Instanz hat automatische Verlängerung aktiviert\",\n\t\t\"es\": \"Instancia de suscripción ECS tiene renovación automática habilitada\",\n\t\t\"fr\": \"Instance d'abonnement ECS a le renouvellement automatique activé\",\n\t\t\"pt\": \"Instância de assinatura ECS tem renovação automática habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS subscription (prepaid) instances have auto-renewal enabled, considered compliant. Pay-as-you-go instances are not applicable.\",\n\t\t\"zh\": \"ECS 包年包月的实例开启自动续费，视为合规。按量付费的实例不适用本规则。\",\n\t\t\"ja\": \"ECS サブスクリプション（プリペイド）インスタンスで自動更新が有効になっている場合、準拠と見なされます。従量課金インスタンスは適用されません。\",\n\t\t\"de\": \"ECS-Abonnement-Instanzen (vorausbezahlt) haben automatische Verlängerung aktiviert, werden als konform betrachtet. Pay-as-you-go-Instanzen sind nicht anwendbar.\",\n\t\t\"es\": \"Las instancias de suscripción ECS (prepagadas) tienen renovación automática habilitada, consideradas conformes. Las instancias de pago por uso no son aplicables.\",\n\t\t\"fr\": \"Les instances d'abonnement ECS (prépayées) ont le renouvellement automatique activé, considérées comme conformes. Les instances à la demande ne sont pas applicables.\",\n\t\t\"pt\": \"Instâncias de assinatura ECS (pré-pagas) têm renovação automática habilitada, consideradas conformes. Instâncias pay-as-you-go não são aplicáveis.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS subscription instance does not have auto-renewal enabled\",\n\t\t\"zh\": \"ECS 包年包月实例未开启自动续费\",\n\t\t\"ja\": \"ECS サブスクリプションインスタンスで自動更新が有効になっていません\",\n\t\t\"de\": \"ECS-Abonnement-Instanz hat keine automatische Verlängerung aktiviert\",\n\t\t\"es\": \"La instancia de suscripción ECS no tiene renovación automática habilitada\",\n\t\t\"fr\": \"L'instance d'abonnement ECS n'a pas le renouvellement automatique activé\",\n\t\t\"pt\": \"Instância de assinatura ECS não tem renovação automática habilitada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for subscription instances to avoid service interruption due to expiration\",\n\t\t\"zh\": \"为订阅实例启用自动续费，避免因到期导致服务中断\",\n\t\t\"ja\": \"有効期限によるサービス中断を避けるために、サブスクリプションインスタンスで自動更新を有効にします\",\n\t\t\"de\": \"Aktivieren Sie die automatische Verlängerung für Abonnement-Instanzen, um Dienstunterbrechungen aufgrund von Ablauf zu vermeiden\",\n\t\t\"es\": \"Habilite la renovación automática para instancias de suscripción para evitar la interrupción del servicio debido a la expiración\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour les instances d'abonnement pour éviter l'interruption de service due à l'expiration\",\n\t\t\"pt\": \"Habilite renovação automática para instâncias de assinatura para evitar interrupção do serviço devido à expiração\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Only check subscription instances\n\tinstance_charge_type := helpers.get_property(resource, \"InstanceChargeType\", \"Postpaid\")\n\n\t# Skip postpaid instances\n\tnot instance_charge_type in [\"Postpaid\", \"PayAsYouGo\", \"PostPaid\", \"PayOnDemand\"]\n\n\t# For subscription instances, check if auto-renewal is enabled\n\tauto_renew := helpers.get_property(resource, \"AutoRenew\", \"False\")\n\tauto_renew == \"False\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AutoRenew\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-chargetype-check", Name: models.I18nString{"de": "ECS-Instanz-Gebührentyp-Prüfung", "en": "ECS Instance Charge Type Check", "es": "Verificación de Tipo de Cargo de Instancia ECS", "fr": "Vérification du Type de Facturation de l'Instance ECS", "ja": "ECS インスタンスの課金タイプチェック", "pt": "Verificação de Tipo de Cobrança da Instância ECS", "zh": "ECS 实例付费类型核查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen den autorisierten Gebührentyp verwenden.", "en": "Ensures ECS instances use the authorized charge type.", "es": "Garantiza que las instancias ECS usen el tipo de cargo autorizado.", "fr": "Garantit que les instances ECS utilisent le type de facturation autorisé.", "ja": "ECS インスタンスが承認された課金タイプを使用していることを確認します。", "pt": "Garante que as instâncias ECS usem o tipo de cobrança autorizado.", "zh": "确保 ECS 实例使用授权的付费类型。"}, Reason: models.I18nString{"de": "Die Durchsetzung spezifischer Gebührentypen (z. B. PostPaid) entspricht den organisatorischen Budgetrichtlinien.", "en": "Enforcing specific charge types (e.g., PostPaid) aligns with organizational budget policies.", "es": "Hacer cumplir tipos de cargo específicos (por ejemplo, PostPaid) se alinea con las políticas presupuestarias organizacionales.", "fr": "L'application de types de facturation spécifiques (par exemple, PostPaid) s'aligne sur les politiques budgétaires organisationnelles.", "ja": "特定の課金タイプ（例：PostPaid）を強制することは、組織の予算ポリシーと一致します。", "pt": "Aplicar tipos de cobrança específicos (por exemplo, PostPaid) está alinhado com as políticas orçamentárias organizacionais.", "zh": "强制执行特定的付费类型（如后付费）符合组织预算政策。"}, Recommendation: models.I18nString{"de": "Setzen Sie InstanceChargeType auf 'PostPaid'.", "en": "Set InstanceChargeType to 'PostPaid'.", "es": "Establezca InstanceChargeType en 'PostPaid'.", "fr": "Définissez InstanceChargeType sur 'PostPaid'.", "ja": "InstanceChargeType を 'PostPaid' に設定します。", "pt": "Defina InstanceChargeType como 'PostPaid'.", "zh": "将 InstanceChargeType 设置为'PostPaid'。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-chargetype-check.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_chargetype_check", Content: "package infraguard.rules.aliyun.ecs_instance_chargetype_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ecs-instance-chargetype-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Charge Type Check\",\n\t\t\"zh\": \"ECS 实例付费类型核查\",\n\t\t\"ja\": \"ECS インスタンスの課金タイプチェック\",\n\t\t\"de\": \"ECS-Instanz-Gebührentyp-Prüfung\",\n\t\t\"es\": \"Verificación de Tipo de Cargo de Instancia ECS\",\n\t\t\"fr\": \"Vérification du Type de Facturation de l'Instance ECS\",\n\t\t\"pt\": \"Verificação de Tipo de Cobrança da Instância ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ECS instances use the authorized charge type.\",\n\t\t\"zh\": \"确保 ECS 实例使用授权的付费类型。\",\n\t\t\"ja\": \"ECS インスタンスが承認された課金タイプを使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen den autorisierten Gebührentyp verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias ECS usen el tipo de cargo autorizado.\",\n\t\t\"fr\": \"Garantit que les instances ECS utilisent le type de facturation autorisé.\",\n\t\t\"pt\": \"Garante que as instâncias ECS usem o tipo de cobrança autorizado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Enforcing specific charge types (e.g., PostPaid) aligns with organizational budget policies.\",\n\t\t\"zh\": \"强制执行特定的付费类型（如后付费）符合组织预算政策。\",\n\t\t\"ja\": \"特定の課金タイプ（例：PostPaid）を強制することは、組織の予算ポリシーと一致します。\",\n\t\t\"de\": \"Die Durchsetzung spezifischer Gebührentypen (z. B. PostPaid) entspricht den organisatorischen Budgetrichtlinien.\",\n\t\t\"es\": \"Hacer cumplir tipos de cargo específicos (por ejemplo, PostPaid) se alinea con las políticas presupuestarias organizacionales.\",\n\t\t\"fr\": \"L'application de types de facturation spécifiques (par exemple, PostPaid) s'aligne sur les politiques budgétaires organisationnelles.\",\n\t\t\"pt\": \"Aplicar tipos de cobrança específicos (por exemplo, PostPaid) está alinhado com as políticas orçamentárias organizacionais.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set InstanceChargeType to 'PostPaid'.\",\n\t\t\"zh\": \"将 InstanceChargeType 设置为'PostPaid'。\",\n\t\t\"ja\": \"InstanceChargeType を 'PostPaid' に設定します。\",\n\t\t\"de\": \"Setzen Sie InstanceChargeType auf 'PostPaid'.\",\n\t\t\"es\": \"Establezca InstanceChargeType en 'PostPaid'.\",\n\t\t\"fr\": \"Définissez InstanceChargeType sur 'PostPaid'.\",\n\t\t\"pt\": \"Defina InstanceChargeType como 'PostPaid'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\nis_compliant(resource) if {\n\tcharge_type := helpers.get_property(resource, \"InstanceChargeType\", \"PostPaid\")\n\tcharge_type == \"PostPaid\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InstanceChargeType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-deletion-protection-enabled", Name: models.I18nString{"de": "ECS-Instanz Löschschutz aktiviert", "en": "ECS Instance Deletion Protection Enabled", "es": "Protección de Eliminación de Instancia ECS Habilitada", "fr": "Protection contre la Suppression d'Instance ECS Activée", "ja": "ECS インスタンスの削除保護が有効", "pt": "Proteção contra Exclusão de Instância ECS Habilitada", "zh": "ECS 实例开启释放保护"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen Löschschutz aktiviert haben.", "en": "Ensures that ECS instances have deletion protection enabled.", "es": "Asegura que las instancias ECS tengan habilitada la protección contra eliminación.", "fr": "Garantit que les instances ECS ont la protection contre la suppression activée.", "ja": "ECS インスタンスで削除保護が有効になっていることを確認します。", "pt": "Garante que as instâncias ECS tenham proteção contra exclusão habilitada.", "zh": "确保 ECS 实例开启了释放保护。"}, Reason: models.I18nString{"de": "Wenn der Löschschutz nicht aktiviert ist, kann die Instanz versehentlich freigegeben werden, was zu Dienstunterbrechungen oder Datenverlust führt.", "en": "If deletion protection is not enabled, the instance may be released accidentally, causing service interruption or data loss.", "es": "Si la protección contra eliminación no está habilitada, la instancia puede ser liberada accidentalmente, causando interrupción del servicio o pérdida de datos.", "fr": "Si la protection contre la suppression n'est pas activée, l'instance peut être libérée accidentellement, provoquant une interruption de service ou une perte de données.", "ja": "削除保護が有効になっていない場合、インスタンスが誤って解放され、サービス中断やデータ損失が発生する可能性があります。", "pt": "Se a proteção contra exclusão não estiver habilitada, a instância pode ser liberada acidentalmente, causando interrupção do serviço ou perda de dados.", "zh": "如果未开启释放保护，实例可能会被意外释放，导致业务中断或数据丢失。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für die ECS-Instanz.", "en": "Enable deletion protection for the ECS instance.", "es": "Habilite la protección contra eliminación para la instancia ECS.", "fr": "Activez la protection contre la suppression pour l'instance ECS.", "ja": "ECS インスタンスで削除保護を有効にします。", "pt": "Habilite proteção contra exclusão para a instância ECS.", "zh": "为 ECS 实例开启释放保护功能。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-deletion-protection-enabled.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_deletion_protection_enabled", Content: "package infraguard.rules.aliyun.ecs_instance_deletion_protection_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-deletion-protection-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Deletion Protection Enabled\",\n\t\t\"zh\": \"ECS 实例开启释放保护\",\n\t\t\"ja\": \"ECS インスタンスの削除保護が有効\",\n\t\t\"de\": \"ECS-Instanz Löschschutz aktiviert\",\n\t\t\"es\": \"Protección de Eliminación de Instancia ECS Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression d'Instance ECS Activée\",\n\t\t\"pt\": \"Proteção contra Exclusão de Instância ECS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ECS instances have deletion protection enabled.\",\n\t\t\"zh\": \"确保 ECS 实例开启了释放保护。\",\n\t\t\"ja\": \"ECS インスタンスで削除保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen Löschschutz aktiviert haben.\",\n\t\t\"es\": \"Asegura que las instancias ECS tengan habilitada la protección contra eliminación.\",\n\t\t\"fr\": \"Garantit que les instances ECS ont la protection contre la suppression activée.\",\n\t\t\"pt\": \"Garante que as instâncias ECS tenham proteção contra exclusão habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If deletion protection is not enabled, the instance may be released accidentally, causing service interruption or data loss.\",\n\t\t\"zh\": \"如果未开启释放保护，实例可能会被意外释放，导致业务中断或数据丢失。\",\n\t\t\"ja\": \"削除保護が有効になっていない場合、インスタンスが誤って解放され、サービス中断やデータ損失が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Löschschutz nicht aktiviert ist, kann die Instanz versehentlich freigegeben werden, was zu Dienstunterbrechungen oder Datenverlust führt.\",\n\t\t\"es\": \"Si la protección contra eliminación no está habilitada, la instancia puede ser liberada accidentalmente, causando interrupción del servicio o pérdida de datos.\",\n\t\t\"fr\": \"Si la protection contre la suppression n'est pas activée, l'instance peut être libérée accidentellement, provoquant une interruption de service ou une perte de données.\",\n\t\t\"pt\": \"Se a proteção contra exclusão não estiver habilitada, a instância pode ser liberada acidentalmente, causando interrupção do serviço ou perda de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for the ECS instance.\",\n\t\t\"zh\": \"为 ECS 实例开启释放保护功能。\",\n\t\t\"ja\": \"ECS インスタンスで削除保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für die ECS-Instanz.\",\n\t\t\"es\": \"Habilite la protección contra eliminación para la instancia ECS.\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour l'instance ECS.\",\n\t\t\"pt\": \"Habilite proteção contra exclusão para a instância ECS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-enabled-security-protection", Name: models.I18nString{"de": "ECS-Instanz Sicherheitsschutz aktiviert", "en": "ECS Instance Enabled Security Protection", "es": "Protección de Seguridad de Instancia ECS Habilitada", "fr": "Protection de Sécurité d'Instance ECS Activée", "ja": "ECS インスタンスでセキュリティ保護が有効", "pt": "Proteção de Segurança de Instância ECS Habilitada", "zh": "运行中的 ECS 实例开启云安全中心防护"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen Sicherheitsverbesserungsstrategie aktiviert haben.", "en": "Ensures that ECS instances have security enhancement strategy enabled.", "es": "Garantiza que las instancias ECS tengan estrategia de mejora de seguridad habilitada.", "fr": "Garantit que les instances ECS ont la stratégie d'amélioration de la sécurité activée.", "ja": "ECS インスタンスでセキュリティ強化戦略が有効になっていることを確認します。", "pt": "Garante que as instâncias ECS tenham estratégia de aprimoramento de segurança habilitada.", "zh": "确保 ECS 实例开启了安全增强策略（云安全中心防护）。"}, Reason: models.I18nString{"de": "Ohne Sicherheitsschutz ist die Instanz anfälliger für Angriffe und Malware.", "en": "Without security protection, the instance is more vulnerable to attacks and malware.", "es": "Sin protección de seguridad, la instancia es más vulnerable a ataques y malware.", "fr": "Sans protection de sécurité, l'instance est plus vulnérable aux attaques et aux logiciels malveillants.", "ja": "セキュリティ保護がない場合、インスタンスは攻撃やマルウェアに対してより脆弱になります。", "pt": "Sem proteção de segurança, a instância é mais vulnerável a ataques e malware.", "zh": "如果没有安全防护，实例更容易受到攻击和恶意软件的侵害。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Sicherheitsverbesserungsstrategie für die ECS-Instanz, indem Sie SecurityEnhancementStrategy auf 'Active' setzen.", "en": "Enable security enhancement strategy for the ECS instance by setting SecurityEnhancementStrategy to 'Active'.", "es": "Habilite la estrategia de mejora de seguridad para la instancia ECS estableciendo SecurityEnhancementStrategy en 'Active'.", "fr": "Activez la stratégie d'amélioration de la sécurité pour l'instance ECS en définissant SecurityEnhancementStrategy sur 'Active'.", "ja": "SecurityEnhancementStrategy を 'Active' に設定して、ECS インスタンスでセキュリティ強化戦略を有効にします。", "pt": "Habilite estratégia de aprimoramento de segurança para a instância ECS definindo SecurityEnhancementStrategy como 'Active'.", "zh": "通过将 SecurityEnhancementStrategy 设置为 'Active' 为 ECS 实例开启安全增强策略。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-enabled-security-protection.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_enabled_security_protection", Content: "package infraguard.rules.aliyun.ecs_instance_enabled_security_protection\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-enabled-security-protection\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Enabled Security Protection\",\n\t\t\"zh\": \"运行中的 ECS 实例开启云安全中心防护\",\n\t\t\"ja\": \"ECS インスタンスでセキュリティ保護が有効\",\n\t\t\"de\": \"ECS-Instanz Sicherheitsschutz aktiviert\",\n\t\t\"es\": \"Protección de Seguridad de Instancia ECS Habilitada\",\n\t\t\"fr\": \"Protection de Sécurité d'Instance ECS Activée\",\n\t\t\"pt\": \"Proteção de Segurança de Instância ECS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ECS instances have security enhancement strategy enabled.\",\n\t\t\"zh\": \"确保 ECS 实例开启了安全增强策略（云安全中心防护）。\",\n\t\t\"ja\": \"ECS インスタンスでセキュリティ強化戦略が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen Sicherheitsverbesserungsstrategie aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias ECS tengan estrategia de mejora de seguridad habilitada.\",\n\t\t\"fr\": \"Garantit que les instances ECS ont la stratégie d'amélioration de la sécurité activée.\",\n\t\t\"pt\": \"Garante que as instâncias ECS tenham estratégia de aprimoramento de segurança habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Without security protection, the instance is more vulnerable to attacks and malware.\",\n\t\t\"zh\": \"如果没有安全防护，实例更容易受到攻击和恶意软件的侵害。\",\n\t\t\"ja\": \"セキュリティ保護がない場合、インスタンスは攻撃やマルウェアに対してより脆弱になります。\",\n\t\t\"de\": \"Ohne Sicherheitsschutz ist die Instanz anfälliger für Angriffe und Malware.\",\n\t\t\"es\": \"Sin protección de seguridad, la instancia es más vulnerable a ataques y malware.\",\n\t\t\"fr\": \"Sans protection de sécurité, l'instance est plus vulnérable aux attaques et aux logiciels malveillants.\",\n\t\t\"pt\": \"Sem proteção de segurança, a instância é mais vulnerável a ataques e malware.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable security enhancement strategy for the ECS instance by setting SecurityEnhancementStrategy to 'Active'.\",\n\t\t\"zh\": \"通过将 SecurityEnhancementStrategy 设置为 'Active' 为 ECS 实例开启安全增强策略。\",\n\t\t\"ja\": \"SecurityEnhancementStrategy を 'Active' に設定して、ECS インスタンスでセキュリティ強化戦略を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Sicherheitsverbesserungsstrategie für die ECS-Instanz, indem Sie SecurityEnhancementStrategy auf 'Active' setzen.\",\n\t\t\"es\": \"Habilite la estrategia de mejora de seguridad para la instancia ECS estableciendo SecurityEnhancementStrategy en 'Active'.\",\n\t\t\"fr\": \"Activez la stratégie d'amélioration de la sécurité pour l'instance ECS en définissant SecurityEnhancementStrategy sur 'Active'.\",\n\t\t\"pt\": \"Habilite estratégia de aprimoramento de segurança para a instância ECS definindo SecurityEnhancementStrategy como 'Active'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\nis_compliant(resource) if {\n\thelpers.get_property(resource, \"SecurityEnhancementStrategy\", \"Active\") == \"Active\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityEnhancementStrategy\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-expired-check", Name: models.I18nString{"de": "ECS-Vorauszahlungs-Instanz Ablaufprüfung", "en": "ECS Prepaid Instance Expiration Check", "es": "Verificación de Expiración de Instancia Prepagada ECS", "fr": "Vérification d'Expiration d'Instance Prépayée ECS", "ja": "ECS プリペイドインスタンスの有効期限チェック", "pt": "Verificação de Expiração de Instância Pré-paga ECS", "zh": "ECS 预付费实例到期检查"}, Severity: "high", Description: models.I18nString{"de": "Vorauszahlungs-Instanzen sollten automatische Verlängerung aktiviert haben, um Dienstunterbrechungen aufgrund von Ablauf zu vermeiden.", "en": "Prepaid instances should have auto-renewal enabled to avoid service interruption due to expiration.", "es": "Las instancias prepagadas deben tener renovación automática habilitada para evitar la interrupción del servicio debido a la expiración.", "fr": "Les instances prépayées doivent avoir le renouvellement automatique activé pour éviter l'interruption de service due à l'expiration.", "ja": "プリペイドインスタンスは、有効期限によるサービス中断を避けるために自動更新を有効にする必要があります。", "pt": "Instâncias pré-pagas devem ter renovação automática habilitada para evitar interrupção do serviço devido à expiração.", "zh": "预付费实例应开启自动续费，避免出现因费用问题停机。"}, Reason: models.I18nString{"de": "Die vorausbezahlte ECS-Instanz hat keine automatische Verlängerung aktiviert.", "en": "The prepaid ECS instance does not have auto-renewal enabled.", "es": "La instancia prepagada ECS no tiene renovación automática habilitada.", "fr": "L'instance prépayée ECS n'a pas le renouvellement automatique activé.", "ja": "プリペイド ECS インスタンスで自動更新が有効になっていません。", "pt": "A instância pré-paga ECS não tem renovação automática habilitada.", "zh": "预付费 ECS 实例未开启自动续费。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Verlängerung für die vorausbezahlte ECS-Instanz, indem Sie AutoRenew auf true setzen.", "en": "Enable auto-renewal for the prepaid ECS instance by setting AutoRenew to true.", "es": "Habilite la renovación automática para la instancia prepagada ECS estableciendo AutoRenew en true.", "fr": "Activez le renouvellement automatique pour l'instance prépayée ECS en définissant AutoRenew sur true.", "ja": "AutoRenew を true に設定して、プリペイド ECS インスタンスで自動更新を有効にします。", "pt": "Habilite renovação automática para a instância pré-paga ECS definindo AutoRenew como true.", "zh": "通过将 AutoRenew 设置为 true 为预付费 ECS 实例开启自动续费。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance"}, FilePath: "aliyun/rules/ecs-instance-expired-check.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_expired_check", Content: "package infraguard.rules.aliyun.ecs_instance_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-expired-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECS Prepaid Instance Expiration Check\",\n\t\t\"zh\": \"ECS 预付费实例到期检查\",\n\t\t\"ja\": \"ECS プリペイドインスタンスの有効期限チェック\",\n\t\t\"de\": \"ECS-Vorauszahlungs-Instanz Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Instancia Prepagada ECS\",\n\t\t\"fr\": \"Vérification d'Expiration d'Instance Prépayée ECS\",\n\t\t\"pt\": \"Verificação de Expiração de Instância Pré-paga ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Prepaid instances should have auto-renewal enabled to avoid service interruption due to expiration.\",\n\t\t\"zh\": \"预付费实例应开启自动续费，避免出现因费用问题停机。\",\n\t\t\"ja\": \"プリペイドインスタンスは、有効期限によるサービス中断を避けるために自動更新を有効にする必要があります。\",\n\t\t\"de\": \"Vorauszahlungs-Instanzen sollten automatische Verlängerung aktiviert haben, um Dienstunterbrechungen aufgrund von Ablauf zu vermeiden.\",\n\t\t\"es\": \"Las instancias prepagadas deben tener renovación automática habilitada para evitar la interrupción del servicio debido a la expiración.\",\n\t\t\"fr\": \"Les instances prépayées doivent avoir le renouvellement automatique activé pour éviter l'interruption de service due à l'expiration.\",\n\t\t\"pt\": \"Instâncias pré-pagas devem ter renovação automática habilitada para evitar interrupção do serviço devido à expiração.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The prepaid ECS instance does not have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 ECS 实例未开启自动续费。\",\n\t\t\"ja\": \"プリペイド ECS インスタンスで自動更新が有効になっていません。\",\n\t\t\"de\": \"Die vorausbezahlte ECS-Instanz hat keine automatische Verlängerung aktiviert.\",\n\t\t\"es\": \"La instancia prepagada ECS no tiene renovación automática habilitada.\",\n\t\t\"fr\": \"L'instance prépayée ECS n'a pas le renouvellement automatique activé.\",\n\t\t\"pt\": \"A instância pré-paga ECS não tem renovação automática habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for the prepaid ECS instance by setting AutoRenew to true.\",\n\t\t\"zh\": \"通过将 AutoRenew 设置为 true 为预付费 ECS 实例开启自动续费。\",\n\t\t\"ja\": \"AutoRenew を true に設定して、プリペイド ECS インスタンスで自動更新を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die automatische Verlängerung für die vorausbezahlte ECS-Instanz, indem Sie AutoRenew auf true setzen.\",\n\t\t\"es\": \"Habilite la renovación automática para la instancia prepagada ECS estableciendo AutoRenew en true.\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour l'instance prépayée ECS en définissant AutoRenew sur true.\",\n\t\t\"pt\": \"Habilite renovação automática para a instância pré-paga ECS definindo AutoRenew como true.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\"]\n}\n\n# Check if instance is Prepaid\nis_prepaid(resource) if {\n\t# Check InstanceChargeType\n\tcharge_type := helpers.get_property(resource, \"InstanceChargeType\", \"PostPaid\")\n\tcharge_type == \"PrePaid\"\n}\n\n# Check if AutoRenew is enabled\nis_auto_renew_enabled(resource) if {\n\tauto_renew := helpers.get_property(resource, \"AutoRenew\", false)\n\thelpers.is_true(auto_renew)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tis_prepaid(resource)\n\tnot is_auto_renew_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AutoRenew\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-image-expired-check", Name: models.I18nString{"de": "ECS-Instanz Bild-Ablaufprüfung", "en": "ECS Instance Image Expired Check", "es": "Verificación de Expiración de Imagen de Instancia ECS", "fr": "Vérification d'Expiration d'Image d'Instance ECS", "ja": "ECS インスタンスイメージの有効期限チェック", "pt": "Verificação de Expiração de Imagem de Instância ECS", "zh": "ECS 实例镜像过期检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass das von der ECS-Instanz verwendete Bild nicht abgelaufen ist.", "en": "Ensures that the image used by the ECS instance has not expired.", "es": "Garantiza que la imagen usada por la instancia ECS no haya expirado.", "fr": "Garantit que l'image utilisée par l'instance ECS n'a pas expiré.", "ja": "ECS インスタンスで使用されているイメージが期限切れでないことを確認します。", "pt": "Garante que a imagem usada pela instância ECS não tenha expirado.", "zh": "确保 ECS 实例使用的镜像未过期。"}, Reason: models.I18nString{"de": "Die Verwendung eines abgelaufenen Bildes kann zu Sicherheitslücken und fehlender Unterstützung führen.", "en": "Using an expired image may lead to security vulnerabilities and lack of support.", "es": "Usar una imagen expirada puede llevar a vulnerabilidades de seguridad y falta de soporte.", "fr": "Utiliser une image expirée peut entraîner des vulnérabilités de sécurité et un manque de support.", "ja": "期限切れのイメージを使用すると、セキュリティの脆弱性やサポートの欠如につながる可能性があります。", "pt": "Usar uma imagem expirada pode levar a vulnerabilidades de segurança e falta de suporte.", "zh": "使用过期的镜像可能导致安全漏洞和缺乏技术支持。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie die ECS-Instanz, um ein unterstütztes, nicht abgelaufenes Bild zu verwenden.", "en": "Update the ECS instance to use a supported, non-expired image.", "es": "Actualice la instancia ECS para usar una imagen compatible y no expirada.", "fr": "Mettez à jour l'instance ECS pour utiliser une image prise en charge et non expirée.", "ja": "ECS インスタンスを更新して、サポートされている期限切れでないイメージを使用します。", "pt": "Atualize a instância ECS para usar uma imagem suportada e não expirada.", "zh": "更新 ECS 实例以使用受支持、未过期的镜像。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-image-expired-check.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_image_expired_check", Content: "package infraguard.rules.aliyun.ecs_instance_image_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ecs-instance-image-expired-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Image Expired Check\",\n\t\t\"zh\": \"ECS 实例镜像过期检测\",\n\t\t\"ja\": \"ECS インスタンスイメージの有効期限チェック\",\n\t\t\"de\": \"ECS-Instanz Bild-Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Imagen de Instancia ECS\",\n\t\t\"fr\": \"Vérification d'Expiration d'Image d'Instance ECS\",\n\t\t\"pt\": \"Verificação de Expiração de Imagem de Instância ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the image used by the ECS instance has not expired.\",\n\t\t\"zh\": \"确保 ECS 实例使用的镜像未过期。\",\n\t\t\"ja\": \"ECS インスタンスで使用されているイメージが期限切れでないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass das von der ECS-Instanz verwendete Bild nicht abgelaufen ist.\",\n\t\t\"es\": \"Garantiza que la imagen usada por la instancia ECS no haya expirado.\",\n\t\t\"fr\": \"Garantit que l'image utilisée par l'instance ECS n'a pas expiré.\",\n\t\t\"pt\": \"Garante que a imagem usada pela instância ECS não tenha expirado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using an expired image may lead to security vulnerabilities and lack of support.\",\n\t\t\"zh\": \"使用过期的镜像可能导致安全漏洞和缺乏技术支持。\",\n\t\t\"ja\": \"期限切れのイメージを使用すると、セキュリティの脆弱性やサポートの欠如につながる可能性があります。\",\n\t\t\"de\": \"Die Verwendung eines abgelaufenen Bildes kann zu Sicherheitslücken und fehlender Unterstützung führen.\",\n\t\t\"es\": \"Usar una imagen expirada puede llevar a vulnerabilidades de seguridad y falta de soporte.\",\n\t\t\"fr\": \"Utiliser une image expirée peut entraîner des vulnérabilités de sécurité et un manque de support.\",\n\t\t\"pt\": \"Usar uma imagem expirada pode levar a vulnerabilidades de segurança e falta de suporte.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Update the ECS instance to use a supported, non-expired image.\",\n\t\t\"zh\": \"更新 ECS 实例以使用受支持、未过期的镜像。\",\n\t\t\"ja\": \"ECS インスタンスを更新して、サポートされている期限切れでないイメージを使用します。\",\n\t\t\"de\": \"Aktualisieren Sie die ECS-Instanz, um ein unterstütztes, nicht abgelaufenes Bild zu verwenden.\",\n\t\t\"es\": \"Actualice la instancia ECS para usar una imagen compatible y no expirada.\",\n\t\t\"fr\": \"Mettez à jour l'instance ECS pour utiliser une image prise en charge et non expirée.\",\n\t\t\"pt\": \"Atualize a instância ECS para usar uma imagem suportada e não expirada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Conceptual check\n\thelpers.has_property(resource, \"ImageId\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ImageId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-image-type-check", Name: models.I18nString{"de": "ECS-Instanz Bildtyp-Prüfung", "en": "ECS Instance Image Type Check", "es": "Verificación de Tipo de Imagen de Instancia ECS", "fr": "Vérification du Type d'Image d'Instance ECS", "ja": "ECS インスタンスイメージタイプチェック", "pt": "Verificação de Tipo de Imagem de Instância ECS", "zh": "ECS 实例镜像来源核查"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen Bilder aus autorisierten Quellen verwenden.", "en": "Ensures ECS instances use images from authorized sources.", "es": "Garantiza que las instancias ECS usen imágenes de fuentes autorizadas.", "fr": "Garantit que les instances ECS utilisent des images provenant de sources autorisées.", "ja": "ECS インスタンスが承認されたソースからのイメージを使用することを確認します。", "pt": "Garante que as instâncias ECS usem imagens de fontes autorizadas.", "zh": "确保 ECS 实例使用来自授权来源的镜像。"}, Reason: models.I18nString{"de": "Die Verwendung nicht vertrauenswürdiger Bildquellen kann Sicherheitslücken oder Malware einführen.", "en": "Using untrusted image sources can introduce security vulnerabilities or malware.", "es": "Usar fuentes de imagen no confiables puede introducir vulnerabilidades de seguridad o malware.", "fr": "Utiliser des sources d'images non fiables peut introduire des vulnérabilités de sécurité ou des logiciels malveillants.", "ja": "信頼できないイメージソースを使用すると、セキュリティの脆弱性やマルウェアが導入される可能性があります。", "pt": "Usar fontes de imagem não confiáveis pode introduzir vulnerabilidades de segurança ou malware.", "zh": "使用未经信任的镜像来源可能会引入安全漏洞或恶意软件。"}, Recommendation: models.I18nString{"de": "Geben Sie eine autorisierte ImageId für die ECS-Instanz an.", "en": "Specify an authorized ImageId for the ECS instance.", "es": "Especifique un ImageId autorizado para la instancia ECS.", "fr": "Spécifiez un ImageId autorisé pour l'instance ECS.", "ja": "ECS インスタンスに承認された ImageId を指定します。", "pt": "Especifique um ImageId autorizado para a instância ECS.", "zh": "为 ECS 实例指定授权的镜像 ID。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-image-type-check.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_image_type_check", Content: "package infraguard.rules.aliyun.ecs_instance_image_type_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ecs-instance-image-type-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Image Type Check\",\n\t\t\"zh\": \"ECS 实例镜像来源核查\",\n\t\t\"ja\": \"ECS インスタンスイメージタイプチェック\",\n\t\t\"de\": \"ECS-Instanz Bildtyp-Prüfung\",\n\t\t\"es\": \"Verificación de Tipo de Imagen de Instancia ECS\",\n\t\t\"fr\": \"Vérification du Type d'Image d'Instance ECS\",\n\t\t\"pt\": \"Verificação de Tipo de Imagem de Instância ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ECS instances use images from authorized sources.\",\n\t\t\"zh\": \"确保 ECS 实例使用来自授权来源的镜像。\",\n\t\t\"ja\": \"ECS インスタンスが承認されたソースからのイメージを使用することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen Bilder aus autorisierten Quellen verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias ECS usen imágenes de fuentes autorizadas.\",\n\t\t\"fr\": \"Garantit que les instances ECS utilisent des images provenant de sources autorisées.\",\n\t\t\"pt\": \"Garante que as instâncias ECS usem imagens de fontes autorizadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using untrusted image sources can introduce security vulnerabilities or malware.\",\n\t\t\"zh\": \"使用未经信任的镜像来源可能会引入安全漏洞或恶意软件。\",\n\t\t\"ja\": \"信頼できないイメージソースを使用すると、セキュリティの脆弱性やマルウェアが導入される可能性があります。\",\n\t\t\"de\": \"Die Verwendung nicht vertrauenswürdiger Bildquellen kann Sicherheitslücken oder Malware einführen.\",\n\t\t\"es\": \"Usar fuentes de imagen no confiables puede introducir vulnerabilidades de seguridad o malware.\",\n\t\t\"fr\": \"Utiliser des sources d'images non fiables peut introduire des vulnérabilités de sécurité ou des logiciels malveillants.\",\n\t\t\"pt\": \"Usar fontes de imagem não confiáveis pode introduzir vulnerabilidades de segurança ou malware.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Specify an authorized ImageId for the ECS instance.\",\n\t\t\"zh\": \"为 ECS 实例指定授权的镜像 ID。\",\n\t\t\"ja\": \"ECS インスタンスに承認された ImageId を指定します。\",\n\t\t\"de\": \"Geben Sie eine autorisierte ImageId für die ECS-Instanz an.\",\n\t\t\"es\": \"Especifique un ImageId autorizado para la instancia ECS.\",\n\t\t\"fr\": \"Spécifiez un ImageId autorisé pour l'instance ECS.\",\n\t\t\"pt\": \"Especifique um ImageId autorizado para a instância ECS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\nis_compliant(resource) if {\n\t# In ROS, we usually check if ImageId is set.\n\t# Complex source checking often requires runtime tags, but we ensure ImageId is present.\n\thelpers.has_property(resource, \"ImageId\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ImageId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-login-use-keypair", Name: models.I18nString{"de": "ECS-Instanz-Anmeldung mit Schlüsselpaar", "en": "ECS Instance Login Using Key Pair", "es": "Inicio de Sesión de Instancia ECS Usando Par de Claves", "fr": "Connexion d'Instance ECS Utilisant une Paire de Clés", "ja": "ECS インスタンスのログインにキーペアを使用", "pt": "Login de Instância ECS Usando Par de Chaves", "zh": "ECS 实例登录使用密钥对"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen Schlüsselpaare für die Anmeldung verwenden, anstatt Passwörter.", "en": "Ensures that ECS instances use key pairs for login instead of passwords.", "es": "Garantiza que las instancias ECS usen pares de claves para iniciar sesión en lugar de contraseñas.", "fr": "Garantit que les instances ECS utilisent des paires de clés pour la connexion au lieu de mots de passe.", "ja": "ECS インスタンスがパスワードではなくキーペアを使用してログインすることを確認します。", "pt": "Garante que as instâncias ECS usem pares de chaves para login em vez de senhas.", "zh": "确保 ECS 实例使用密钥对进行登录，而不是密码。"}, Reason: models.I18nString{"de": "Die Anmeldung mit Schlüsselpaar ist sicherer als die Anmeldung mit Passwort.", "en": "Key pair login is more secure than password login.", "es": "El inicio de sesión con par de claves es más seguro que el inicio de sesión con contraseña.", "fr": "La connexion avec paire de clés est plus sécurisée que la connexion avec mot de passe.", "ja": "キーペアログインはパスワードログインよりも安全です。", "pt": "Login com par de chaves é mais seguro que login com senha.", "zh": "密钥对登录比密码登录更安全。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die Anmeldung mit Schlüsselpaar für die ECS-Instanz und deaktivieren Sie die Anmeldung mit Passwort.", "en": "Configure key pair login for the ECS instance and disable password login.", "es": "Configure el inicio de sesión con par de claves para la instancia ECS y deshabilite el inicio de sesión con contraseña.", "fr": "Configurez la connexion avec paire de clés pour l'instance ECS et désactivez la connexion avec mot de passe.", "ja": "ECS インスタンスでキーペアログインを設定し、パスワードログインを無効にします。", "pt": "Configure login com par de chaves para a instância ECS e desabilite login com senha.", "zh": "为 ECS 实例配置密钥对登录，并禁用密码登录。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-login-use-keypair.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_login_use_keypair", Content: "package infraguard.rules.aliyun.ecs_instance_login_use_keypair\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ecs-instance-login-use-keypair\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Login Using Key Pair\",\n\t\t\"zh\": \"ECS 实例登录使用密钥对\",\n\t\t\"ja\": \"ECS インスタンスのログインにキーペアを使用\",\n\t\t\"de\": \"ECS-Instanz-Anmeldung mit Schlüsselpaar\",\n\t\t\"es\": \"Inicio de Sesión de Instancia ECS Usando Par de Claves\",\n\t\t\"fr\": \"Connexion d'Instance ECS Utilisant une Paire de Clés\",\n\t\t\"pt\": \"Login de Instância ECS Usando Par de Chaves\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ECS instances use key pairs for login instead of passwords.\",\n\t\t\"zh\": \"确保 ECS 实例使用密钥对进行登录，而不是密码。\",\n\t\t\"ja\": \"ECS インスタンスがパスワードではなくキーペアを使用してログインすることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen Schlüsselpaare für die Anmeldung verwenden, anstatt Passwörter.\",\n\t\t\"es\": \"Garantiza que las instancias ECS usen pares de claves para iniciar sesión en lugar de contraseñas.\",\n\t\t\"fr\": \"Garantit que les instances ECS utilisent des paires de clés pour la connexion au lieu de mots de passe.\",\n\t\t\"pt\": \"Garante que as instâncias ECS usem pares de chaves para login em vez de senhas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Key pair login is more secure than password login.\",\n\t\t\"zh\": \"密钥对登录比密码登录更安全。\",\n\t\t\"ja\": \"キーペアログインはパスワードログインよりも安全です。\",\n\t\t\"de\": \"Die Anmeldung mit Schlüsselpaar ist sicherer als die Anmeldung mit Passwort.\",\n\t\t\"es\": \"El inicio de sesión con par de claves es más seguro que el inicio de sesión con contraseña.\",\n\t\t\"fr\": \"La connexion avec paire de clés est plus sécurisée que la connexion avec mot de passe.\",\n\t\t\"pt\": \"Login com par de chaves é mais seguro que login com senha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure key pair login for the ECS instance and disable password login.\",\n\t\t\"zh\": \"为 ECS 实例配置密钥对登录，并禁用密码登录。\",\n\t\t\"ja\": \"ECS インスタンスでキーペアログインを設定し、パスワードログインを無効にします。\",\n\t\t\"de\": \"Konfigurieren Sie die Anmeldung mit Schlüsselpaar für die ECS-Instanz und deaktivieren Sie die Anmeldung mit Passwort.\",\n\t\t\"es\": \"Configure el inicio de sesión con par de claves para la instancia ECS y deshabilite el inicio de sesión con contraseña.\",\n\t\t\"fr\": \"Configurez la connexion avec paire de clés pour l'instance ECS et désactivez la connexion avec mot de passe.\",\n\t\t\"pt\": \"Configure login com par de chaves para a instância ECS e desabilite login com senha.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\tnot helpers.has_property(resource, \"KeyPairName\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"KeyPairName\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-meta-data-mode-check", Name: models.I18nString{"de": "ECS-Instanz-Metadatenzugriff verwendet sicherheitsverbesserten Modus (IMDSv2)", "en": "ECS instance metadata access uses security-enhanced mode (IMDSv2)", "es": "El acceso a metadatos de instancia ECS usa modo de seguridad mejorado (IMDSv2)", "fr": "L'accès aux métadonnées d'instance ECS utilise le mode de sécurité renforcé (IMDSv2)", "ja": "ECS インスタンスメタデータアクセスがセキュリティ強化モード（IMDSv2）を使用", "pt": "Acesso a metadados de instância ECS usa modo de segurança aprimorado (IMDSv2)", "zh": "访问 ECS 实例元数据时强制使用加固模式"}, Severity: "medium", Description: models.I18nString{"de": "Beim Zugriff auf ECS-Instanz-Metadaten wird der sicherheitsverbesserte Modus (IMDSv2) erzwungen, wird als konform betrachtet. Mit ACK-Clustern verbundene Instanzen sind nicht anwendbar.", "en": "When accessing ECS instance metadata, security-enhanced mode (IMDSv2) is enforced, considered compliant. Instances associated with ACK clusters are not applicable.", "es": "Al acceder a metadatos de instancia ECS, se aplica el modo de seguridad mejorado (IMDSv2), considerado conforme. Las instancias asociadas con clústeres ACK no son aplicables.", "fr": "Lors de l'accès aux métadonnées d'instance ECS, le mode de sécurité renforcé (IMDSv2) est appliqué, considéré comme conforme. Les instances associées aux clusters ACK ne sont pas applicables.", "ja": "ECS インスタンスメタデータにアクセスする際、セキュリティ強化モード（IMDSv2）が適用され、準拠と見なされます。ACK クラスタに関連付けられたインスタンスは適用されません。", "pt": "Ao acessar metadados de instância ECS, o modo de segurança aprimorado (IMDSv2) é aplicado, considerado conforme. Instâncias associadas a clusters ACK não são aplicáveis.", "zh": "访问 ECS 实例元数据时强制使用加固模式，视为合规。ACK 集群关联的实例视为不适用。"}, Reason: models.I18nString{"de": "ECS-Instanz-Metadaten sind ohne sicherheitsverbesserten Modus (IMDSv1) zugänglich", "en": "ECS instance metadata is accessible without security-enhanced mode (IMDSv1)", "es": "Los metadatos de instancia ECS son accesibles sin modo de seguridad mejorado (IMDSv1)", "fr": "Les métadonnées d'instance ECS sont accessibles sans mode de sécurité renforcé (IMDSv1)", "ja": "ECS インスタンスメタデータはセキュリティ強化モード（IMDSv1）なしでアクセス可能", "pt": "Metadados de instância ECS são acessíveis sem modo de segurança aprimorado (IMDSv1)", "zh": "ECS 实例元数据可在未启用加固模式(IMDSv1)的情况下访问"}, Recommendation: models.I18nString{"de": "Setzen Sie HttpEndpoint auf 'enabled' und HttpTokens auf 'required', um IMDSv2 zu erzwingen", "en": "Set HttpEndpoint to 'enabled' and HttpTokens to 'required' to enforce IMDSv2", "es": "Establezca HttpEndpoint en 'enabled' y HttpTokens en 'required' para aplicar IMDSv2", "fr": "Définissez HttpEndpoint sur 'enabled' et HttpTokens sur 'required' pour appliquer IMDSv2", "ja": "IMDSv2 を適用するために、HttpEndpoint を 'enabled' に設定し、HttpTokens を 'required' に設定します", "pt": "Defina HttpEndpoint como 'enabled' e HttpTokens como 'required' para aplicar IMDSv2", "zh": "将 HttpEndpoint 设置为 'enabled'，并将 HttpTokens 设置为 'required' 以强制使用 IMDSv2"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-meta-data-mode-check.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_meta_data_mode_check", Content: "package infraguard.rules.aliyun.ecs_instance_meta_data_mode_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-meta-data-mode-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS instance metadata access uses security-enhanced mode (IMDSv2)\",\n\t\t\"zh\": \"访问 ECS 实例元数据时强制使用加固模式\",\n\t\t\"ja\": \"ECS インスタンスメタデータアクセスがセキュリティ強化モード（IMDSv2）を使用\",\n\t\t\"de\": \"ECS-Instanz-Metadatenzugriff verwendet sicherheitsverbesserten Modus (IMDSv2)\",\n\t\t\"es\": \"El acceso a metadatos de instancia ECS usa modo de seguridad mejorado (IMDSv2)\",\n\t\t\"fr\": \"L'accès aux métadonnées d'instance ECS utilise le mode de sécurité renforcé (IMDSv2)\",\n\t\t\"pt\": \"Acesso a metadados de instância ECS usa modo de segurança aprimorado (IMDSv2)\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"When accessing ECS instance metadata, security-enhanced mode (IMDSv2) is enforced, considered compliant. Instances associated with ACK clusters are not applicable.\",\n\t\t\"zh\": \"访问 ECS 实例元数据时强制使用加固模式，视为合规。ACK 集群关联的实例视为不适用。\",\n\t\t\"ja\": \"ECS インスタンスメタデータにアクセスする際、セキュリティ強化モード（IMDSv2）が適用され、準拠と見なされます。ACK クラスタに関連付けられたインスタンスは適用されません。\",\n\t\t\"de\": \"Beim Zugriff auf ECS-Instanz-Metadaten wird der sicherheitsverbesserte Modus (IMDSv2) erzwungen, wird als konform betrachtet. Mit ACK-Clustern verbundene Instanzen sind nicht anwendbar.\",\n\t\t\"es\": \"Al acceder a metadatos de instancia ECS, se aplica el modo de seguridad mejorado (IMDSv2), considerado conforme. Las instancias asociadas con clústeres ACK no son aplicables.\",\n\t\t\"fr\": \"Lors de l'accès aux métadonnées d'instance ECS, le mode de sécurité renforcé (IMDSv2) est appliqué, considéré comme conforme. Les instances associées aux clusters ACK ne sont pas applicables.\",\n\t\t\"pt\": \"Ao acessar metadados de instância ECS, o modo de segurança aprimorado (IMDSv2) é aplicado, considerado conforme. Instâncias associadas a clusters ACK não são aplicáveis.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS instance metadata is accessible without security-enhanced mode (IMDSv1)\",\n\t\t\"zh\": \"ECS 实例元数据可在未启用加固模式(IMDSv1)的情况下访问\",\n\t\t\"ja\": \"ECS インスタンスメタデータはセキュリティ強化モード（IMDSv1）なしでアクセス可能\",\n\t\t\"de\": \"ECS-Instanz-Metadaten sind ohne sicherheitsverbesserten Modus (IMDSv1) zugänglich\",\n\t\t\"es\": \"Los metadatos de instancia ECS son accesibles sin modo de seguridad mejorado (IMDSv1)\",\n\t\t\"fr\": \"Les métadonnées d'instance ECS sont accessibles sans mode de sécurité renforcé (IMDSv1)\",\n\t\t\"pt\": \"Metadados de instância ECS são acessíveis sem modo de segurança aprimorado (IMDSv1)\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set HttpEndpoint to 'enabled' and HttpTokens to 'required' to enforce IMDSv2\",\n\t\t\"zh\": \"将 HttpEndpoint 设置为 'enabled'，并将 HttpTokens 设置为 'required' 以强制使用 IMDSv2\",\n\t\t\"ja\": \"IMDSv2 を適用するために、HttpEndpoint を 'enabled' に設定し、HttpTokens を 'required' に設定します\",\n\t\t\"de\": \"Setzen Sie HttpEndpoint auf 'enabled' und HttpTokens auf 'required', um IMDSv2 zu erzwingen\",\n\t\t\"es\": \"Establezca HttpEndpoint en 'enabled' y HttpTokens en 'required' para aplicar IMDSv2\",\n\t\t\"fr\": \"Définissez HttpEndpoint sur 'enabled' et HttpTokens sur 'required' pour appliquer IMDSv2\",\n\t\t\"pt\": \"Defina HttpEndpoint como 'enabled' e HttpTokens como 'required' para aplicar IMDSv2\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Check if metadata endpoint is enabled\n\thttp_endpoint := helpers.get_property(resource, \"HttpEndpoint\", \"enabled\")\n\n\t# If endpoint is disabled, metadata access is not possible\n\thttp_endpoint == \"disabled\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"HttpEndpoint\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# If endpoint is not disabled, check if tokens are required (IMDSv2)\n\thttp_endpoint := helpers.get_property(resource, \"HttpEndpoint\", \"enabled\")\n\thttp_endpoint != \"disabled\"\n\n\thttp_tokens := helpers.get_property(resource, \"HttpTokens\", \"optional\")\n\thttp_tokens == \"optional\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"HttpTokens\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-multiple-eni-check", Name: models.I18nString{"de": "ECS-Instanz ist nur an eine elastische Netzwerkschnittstelle gebunden", "en": "ECS instance is bound to only one elastic network interface", "es": "La Instancia ECS Está Vinculada Solo a Una Interfaz de Red Elástica", "fr": "L'Instance ECS est Liée à Une Seule Interface Réseau Élastique", "ja": "ECS インスタンスが1つのエラスティックネットワークインターフェースにのみバインドされている", "pt": "A Instância ECS Está Vinculada Apenas a Uma Interface de Rede Elástica", "zh": "ECS 实例仅绑定一个弹性网卡"}, Severity: "low", Description: models.I18nString{"de": "ECS-Instanzen sind nur an eine elastische Netzwerkschnittstelle gebunden, was als konform gilt. Dies hilft, die Netzwerkkonfiguration zu vereinfachen und die Komplexität zu reduzieren.", "en": "ECS instances are bound to only one elastic network interface, considered compliant. This helps simplify network configuration and reduce complexity.", "es": "Las instancias ECS están vinculadas solo a una interfaz de red elástica, considerado conforme. Esto ayuda a simplificar la configuración de red y reducir la complejidad.", "fr": "Les instances ECS sont liées à une seule interface réseau élastique, considéré comme conforme. Cela aide à simplifier la configuration réseau et à réduire la complexité.", "ja": "ECS インスタンスが1つのエラスティックネットワークインターフェースにのみバインドされており、準拠と見なされます。これにより、ネットワーク設定が簡素化され、複雑さが軽減されます。", "pt": "As instâncias ECS estão vinculadas apenas a uma interface de rede elástica, considerado conforme. Isso ajuda a simplificar a configuração de rede e reduzir a complexidade.", "zh": "ECS 实例仅绑定一个弹性网卡，视为合规。这有助于简化网络配置并减少复杂性。"}, Reason: models.I18nString{"de": "ECS-Instanz ist an mehrere elastische Netzwerkschnittstellen gebunden", "en": "ECS instance is bound to multiple elastic network interfaces", "es": "La instancia ECS está vinculada a múltiples interfaces de red elásticas", "fr": "L'instance ECS est liée à plusieurs interfaces réseau élastiques", "ja": "ECS インスタンスが複数のエラスティックネットワークインターフェースにバインドされている", "pt": "A instância ECS está vinculada a múltiplas interfaces de rede elásticas", "zh": "ECS 实例绑定了多个弹性网卡"}, Recommendation: models.I18nString{"de": "Vereinfachen Sie die Instanznetzwerkkonfiguration, indem Sie nur eine ENI verwenden", "en": "Simplify instance network configuration by using only one ENI", "es": "Simplifique la configuración de red de la instancia usando solo una ENI", "fr": "Simplifiez la configuration réseau de l'instance en utilisant une seule ENI", "ja": "1つの ENI のみを使用してインスタンスネットワーク設定を簡素化します", "pt": "Simplifique a configuração de rede da instância usando apenas uma ENI", "zh": "通过仅使用一个 ENI 来简化实例网络配置"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-multiple-eni-check.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_multiple_eni_check", Content: "package infraguard.rules.aliyun.ecs_instance_multiple_eni_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-multiple-eni-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS instance is bound to only one elastic network interface\",\n\t\t\"zh\": \"ECS 实例仅绑定一个弹性网卡\",\n\t\t\"ja\": \"ECS インスタンスが1つのエラスティックネットワークインターフェースにのみバインドされている\",\n\t\t\"de\": \"ECS-Instanz ist nur an eine elastische Netzwerkschnittstelle gebunden\",\n\t\t\"es\": \"La Instancia ECS Está Vinculada Solo a Una Interfaz de Red Elástica\",\n\t\t\"fr\": \"L'Instance ECS est Liée à Une Seule Interface Réseau Élastique\",\n\t\t\"pt\": \"A Instância ECS Está Vinculada Apenas a Uma Interface de Rede Elástica\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS instances are bound to only one elastic network interface, considered compliant. This helps simplify network configuration and reduce complexity.\",\n\t\t\"zh\": \"ECS 实例仅绑定一个弹性网卡，视为合规。这有助于简化网络配置并减少复杂性。\",\n\t\t\"ja\": \"ECS インスタンスが1つのエラスティックネットワークインターフェースにのみバインドされており、準拠と見なされます。これにより、ネットワーク設定が簡素化され、複雑さが軽減されます。\",\n\t\t\"de\": \"ECS-Instanzen sind nur an eine elastische Netzwerkschnittstelle gebunden, was als konform gilt. Dies hilft, die Netzwerkkonfiguration zu vereinfachen und die Komplexität zu reduzieren.\",\n\t\t\"es\": \"Las instancias ECS están vinculadas solo a una interfaz de red elástica, considerado conforme. Esto ayuda a simplificar la configuración de red y reducir la complejidad.\",\n\t\t\"fr\": \"Les instances ECS sont liées à une seule interface réseau élastique, considéré comme conforme. Cela aide à simplifier la configuration réseau et à réduire la complexité.\",\n\t\t\"pt\": \"As instâncias ECS estão vinculadas apenas a uma interface de rede elástica, considerado conforme. Isso ajuda a simplificar a configuração de rede e reduzir a complexidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS instance is bound to multiple elastic network interfaces\",\n\t\t\"zh\": \"ECS 实例绑定了多个弹性网卡\",\n\t\t\"ja\": \"ECS インスタンスが複数のエラスティックネットワークインターフェースにバインドされている\",\n\t\t\"de\": \"ECS-Instanz ist an mehrere elastische Netzwerkschnittstellen gebunden\",\n\t\t\"es\": \"La instancia ECS está vinculada a múltiples interfaces de red elásticas\",\n\t\t\"fr\": \"L'instance ECS est liée à plusieurs interfaces réseau élastiques\",\n\t\t\"pt\": \"A instância ECS está vinculada a múltiplas interfaces de rede elásticas\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Simplify instance network configuration by using only one ENI\",\n\t\t\"zh\": \"通过仅使用一个 ENI 来简化实例网络配置\",\n\t\t\"ja\": \"1つの ENI のみを使用してインスタンスネットワーク設定を簡素化します\",\n\t\t\"de\": \"Vereinfachen Sie die Instanznetzwerkkonfiguration, indem Sie nur eine ENI verwenden\",\n\t\t\"es\": \"Simplifique la configuración de red de la instancia usando solo una ENI\",\n\t\t\"fr\": \"Simplifiez la configuration réseau de l'instance en utilisant une seule ENI\",\n\t\t\"pt\": \"Simplifique a configuração de rede da instância usando apenas uma ENI\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Check if NetworkInterfaces is specified with multiple ENIs\n\tnetwork_interfaces := helpers.get_property(resource, \"NetworkInterfaces\", [])\n\tcount(network_interfaces) > 1\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"NetworkInterfaces\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Count NetworkInterfaceAttachment resources that reference this instance\n\tattachment_count := count([att_name |\n\t\tsome att_name, att_resource in helpers.resources_by_type(\"ALIYUN::ECS::NetworkInterfaceAttachment\")\n\t\tinstance_id := helpers.get_property(att_resource, \"InstanceId\", \"\")\n\t\thelpers.is_referencing(instance_id, name)\n\t])\n\n\t# If more than one attachment references this instance, it's a violation\n\tattachment_count > 1\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Count NetworkInterfaceAttachment resources that reference this instance via GetAtt\n\tattachment_count := count([att_name |\n\t\tsome att_name, att_resource in helpers.resources_by_type(\"ALIYUN::ECS::NetworkInterfaceAttachment\")\n\t\tinstance_id := helpers.get_property(att_resource, \"InstanceId\", \"\")\n\t\thelpers.is_get_att_referencing(instance_id, name)\n\t])\n\n\t# If more than one attachment references this instance, it's a violation\n\tattachment_count > 1\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-no-public-and-anyip", Name: models.I18nString{"de": "ECS-Instanz sollte kein öffentliches IP binden oder Zugriff von beliebigen IPs zulassen", "en": "ECS Instance Should Not Bind Public IP or Allow Any IP Access", "es": "La Instancia ECS No Debe Vincular IP Público o Permitir Acceso de Cualquier IP", "fr": "L'Instance ECS Ne Doit Pas Lier d'IP Publique ou Autoriser l'Accès de N'importe Quelle IP", "ja": "ECS インスタンスはパブリック IP をバインドしないか、任意の IP アクセスを許可しない", "pt": "Instância ECS Não Deve Vincular IP Público ou Permitir Acesso de Qualquer IP", "zh": "ECS 实例禁止绑定公网地址和开放任意 ip"}, Severity: "medium", Description: models.I18nString{"de": "ECS-Instanzen sollten keine IPv4-öffentlichen IPs oder elastischen IPs direkt binden, und zugehörige Sicherheitsgruppen sollten 0.0.0.0/0 nicht freigeben. Konform, wenn keine öffentliche IP gebunden ist.", "en": "ECS instances should not directly bind IPv4 public IPs or Elastic IPs, and associated security groups should not expose 0.0.0.0/0. Compliant when no public IP is bound.", "es": "Las instancias ECS no deben vincular directamente IPs públicos IPv4 o IPs elásticos, y los grupos de seguridad asociados no deben exponer 0.0.0.0/0. Conforme cuando no se vincula ninguna IP pública.", "fr": "Les instances ECS ne doivent pas lier directement des IPs publiques IPv4 ou des IPs élastiques, et les groupes de sécurité associés ne doivent pas exposer 0.0.0.0/0. Conforme lorsqu'aucune IP publique n'est liée.", "ja": "ECS インスタンスは IPv4 パブリック IP または Elastic IP を直接バインドせず、関連するセキュリティグループは 0.0.0.0/0 を公開しません。パブリック IP がバインドされていない場合は準拠と見なされます。", "pt": "Instâncias ECS não devem vincular diretamente IPs públicos IPv4 ou IPs elásticos, e os grupos de segurança associados não devem expor 0.0.0.0/0. Conforme quando nenhum IP público está vinculado.", "zh": "ECS 实例没有直接绑定 IPv4 公网 IP 或弹性公网 IP，或关联的安全组未开放 0.0.0.0/0，视为合规。"}, Reason: models.I18nString{"de": "ECS-Instanz hat öffentliche IP-Zuweisung aktiviert oder verwendet uneingeschränkte Internetbandbreite", "en": "ECS instance has public IP allocation enabled or uses unrestricted internet bandwidth", "es": "La instancia ECS tiene asignación de IP pública habilitada o usa ancho de banda de internet sin restricciones", "fr": "L'instance ECS a l'allocation d'IP publique activée ou utilise une bande passante Internet sans restriction", "ja": "ECS インスタンスでパブリック IP 割り当てが有効になっているか、制限のないインターネット帯域幅を使用しています", "pt": "A instância ECS tem alocação de IP público habilitada ou usa largura de banda de internet sem restrições", "zh": "ECS 实例启用了公网 IP 分配或使用了不受限制的互联网带宽"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie die öffentliche IP-Zuweisung (AllocatePublicIP=false) und setzen Sie InternetMaxBandwidthOut auf 0. Verwenden Sie stattdessen NAT Gateway oder SLB für Internetzugriff.", "en": "Disable public IP allocation (AllocatePublicIP=false) and set InternetMaxBandwidthOut to 0. Use NAT Gateway or SLB for internet access instead.", "es": "Deshabilite la asignación de IP pública (AllocatePublicIP=false) y establezca InternetMaxBandwidthOut en 0. Use NAT Gateway o SLB para acceso a internet en su lugar.", "fr": "Désactivez l'allocation d'IP publique (AllocatePublicIP=false) et définissez InternetMaxBandwidthOut sur 0. Utilisez NAT Gateway ou SLB pour l'accès Internet à la place.", "ja": "パブリック IP 割り当てを無効にし（AllocatePublicIP=false）、InternetMaxBandwidthOut を 0 に設定します。代わりに NAT ゲートウェイまたは SLB を使用してインターネットアクセスを行います。", "pt": "Desabilite a alocação de IP público (AllocatePublicIP=false) e defina InternetMaxBandwidthOut como 0. Use NAT Gateway ou SLB para acesso à internet em vez disso.", "zh": "禁用公网 IP 分配(AllocatePublicIP=false)并将 InternetMaxBandwidthOut 设置为 0。改用 NAT 网关或 SLB 进行互联网访问。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-no-public-and-anyip.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_no_public_and_anyip", Content: "package infraguard.rules.aliyun.ecs_instance_no_public_and_anyip\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-no-public-and-anyip\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Should Not Bind Public IP or Allow Any IP Access\",\n\t\t\"zh\": \"ECS 实例禁止绑定公网地址和开放任意 ip\",\n\t\t\"ja\": \"ECS インスタンスはパブリック IP をバインドしないか、任意の IP アクセスを許可しない\",\n\t\t\"de\": \"ECS-Instanz sollte kein öffentliches IP binden oder Zugriff von beliebigen IPs zulassen\",\n\t\t\"es\": \"La Instancia ECS No Debe Vincular IP Público o Permitir Acceso de Cualquier IP\",\n\t\t\"fr\": \"L'Instance ECS Ne Doit Pas Lier d'IP Publique ou Autoriser l'Accès de N'importe Quelle IP\",\n\t\t\"pt\": \"Instância ECS Não Deve Vincular IP Público ou Permitir Acesso de Qualquer IP\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS instances should not directly bind IPv4 public IPs or Elastic IPs, and associated security groups should not expose 0.0.0.0/0. Compliant when no public IP is bound.\",\n\t\t\"zh\": \"ECS 实例没有直接绑定 IPv4 公网 IP 或弹性公网 IP，或关联的安全组未开放 0.0.0.0/0，视为合规。\",\n\t\t\"ja\": \"ECS インスタンスは IPv4 パブリック IP または Elastic IP を直接バインドせず、関連するセキュリティグループは 0.0.0.0/0 を公開しません。パブリック IP がバインドされていない場合は準拠と見なされます。\",\n\t\t\"de\": \"ECS-Instanzen sollten keine IPv4-öffentlichen IPs oder elastischen IPs direkt binden, und zugehörige Sicherheitsgruppen sollten 0.0.0.0/0 nicht freigeben. Konform, wenn keine öffentliche IP gebunden ist.\",\n\t\t\"es\": \"Las instancias ECS no deben vincular directamente IPs públicos IPv4 o IPs elásticos, y los grupos de seguridad asociados no deben exponer 0.0.0.0/0. Conforme cuando no se vincula ninguna IP pública.\",\n\t\t\"fr\": \"Les instances ECS ne doivent pas lier directement des IPs publiques IPv4 ou des IPs élastiques, et les groupes de sécurité associés ne doivent pas exposer 0.0.0.0/0. Conforme lorsqu'aucune IP publique n'est liée.\",\n\t\t\"pt\": \"Instâncias ECS não devem vincular diretamente IPs públicos IPv4 ou IPs elásticos, e os grupos de segurança associados não devem expor 0.0.0.0/0. Conforme quando nenhum IP público está vinculado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS instance has public IP allocation enabled or uses unrestricted internet bandwidth\",\n\t\t\"zh\": \"ECS 实例启用了公网 IP 分配或使用了不受限制的互联网带宽\",\n\t\t\"ja\": \"ECS インスタンスでパブリック IP 割り当てが有効になっているか、制限のないインターネット帯域幅を使用しています\",\n\t\t\"de\": \"ECS-Instanz hat öffentliche IP-Zuweisung aktiviert oder verwendet uneingeschränkte Internetbandbreite\",\n\t\t\"es\": \"La instancia ECS tiene asignación de IP pública habilitada o usa ancho de banda de internet sin restricciones\",\n\t\t\"fr\": \"L'instance ECS a l'allocation d'IP publique activée ou utilise une bande passante Internet sans restriction\",\n\t\t\"pt\": \"A instância ECS tem alocação de IP público habilitada ou usa largura de banda de internet sem restrições\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable public IP allocation (AllocatePublicIP=false) and set InternetMaxBandwidthOut to 0. Use NAT Gateway or SLB for internet access instead.\",\n\t\t\"zh\": \"禁用公网 IP 分配(AllocatePublicIP=false)并将 InternetMaxBandwidthOut 设置为 0。改用 NAT 网关或 SLB 进行互联网访问。\",\n\t\t\"ja\": \"パブリック IP 割り当てを無効にし（AllocatePublicIP=false）、InternetMaxBandwidthOut を 0 に設定します。代わりに NAT ゲートウェイまたは SLB を使用してインターネットアクセスを行います。\",\n\t\t\"de\": \"Deaktivieren Sie die öffentliche IP-Zuweisung (AllocatePublicIP=false) und setzen Sie InternetMaxBandwidthOut auf 0. Verwenden Sie stattdessen NAT Gateway oder SLB für Internetzugriff.\",\n\t\t\"es\": \"Deshabilite la asignación de IP pública (AllocatePublicIP=false) y establezca InternetMaxBandwidthOut en 0. Use NAT Gateway o SLB para acceso a internet en su lugar.\",\n\t\t\"fr\": \"Désactivez l'allocation d'IP publique (AllocatePublicIP=false) et définissez InternetMaxBandwidthOut sur 0. Utilisez NAT Gateway ou SLB pour l'accès Internet à la place.\",\n\t\t\"pt\": \"Desabilite a alocação de IP público (AllocatePublicIP=false) e defina InternetMaxBandwidthOut como 0. Use NAT Gateway ou SLB para acesso à internet em vez disso.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\n# Check if instance has public IP allocated\nhas_public_ip(resource) if {\n\tprint(\"public_ip\", helpers.get_property(resource, \"AllocatePublicIP\", false))\n\thelpers.get_property(resource, \"AllocatePublicIP\", false) == true\n}\n\n# Check if instance has internet bandwidth (which implies public IP access)\nhas_internet_bandwidth(resource) if {\n\thelpers.has_property(resource, \"InternetMaxBandwidthOut\")\n\tresource.Properties.InternetMaxBandwidthOut > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\thas_public_ip(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AllocatePublicIP\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\thas_internet_bandwidth(resource)\n\tnot has_public_ip(resource) # Only report if not already reported by AllocatePublicIP check\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InternetMaxBandwidthOut\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-no-public-ip", Name: models.I18nString{"de": "ECS-Instanz sollte keine öffentliche IP binden", "en": "ECS instance should not bind public IP", "es": "La Instancia ECS No Debe Vincular IP Pública", "fr": "L'Instance ECS Ne Doit Pas Lier d'IP Publique", "ja": "ECS インスタンスはパブリック IP をバインドすべきではない", "pt": "Instância ECS Não Deve Vincular IP Público", "zh": "ECS 实例禁止绑定公网地址"}, Severity: "high", Description: models.I18nString{"de": "ECS-Instanzen sollten keine IPv4-öffentliche IP oder Elastic IP direkt binden, was als konform gilt.", "en": "ECS instances should not directly bind IPv4 public IP or Elastic IP, considered compliant.", "es": "Las instancias ECS no deben vincular directamente IP pública IPv4 o IP elástica, considerado conforme.", "fr": "Les instances ECS ne doivent pas lier directement d'IP publique IPv4 ou d'IP élastique, considéré comme conforme.", "ja": "ECS インスタンスは IPv4 パブリック IP または Elastic IP を直接バインドすべきではなく、準拠と見なされます。", "pt": "As instâncias ECS não devem vincular diretamente IP público IPv4 ou IP elástico, considerado conforme.", "zh": "ECS 实例没有直接绑定 IPv4 公网 IP 或弹性公网 IP，视为合规。"}, Reason: models.I18nString{"de": "ECS-Instanz hat eine öffentliche IP gebunden", "en": "ECS instance has a public IP bound", "es": "La instancia ECS tiene una IP pública vinculada", "fr": "L'instance ECS a une IP publique liée", "ja": "ECS インスタンスにパブリック IP がバインドされています", "pt": "A instância ECS tem um IP público vinculado", "zh": "ECS 实例绑定了公网地址"}, Recommendation: models.I18nString{"de": "Verwenden Sie NAT Gateway oder SLB für Internetzugriff anstelle der direkten Bindung öffentlicher IP", "en": "Use NAT Gateway or SLB for internet access instead of direct public IP binding", "es": "Use NAT Gateway o SLB para acceso a Internet en lugar de vinculación directa de IP pública", "fr": "Utilisez NAT Gateway ou SLB pour l'accès Internet au lieu de la liaison directe d'IP publique", "ja": "直接パブリック IP バインディングの代わりに、インターネットアクセスに NAT ゲートウェイまたは SLB を使用します", "pt": "Use NAT Gateway ou SLB para acesso à Internet em vez de vinculação direta de IP público", "zh": "使用 NAT 网关或 SLB 进行互联网访问，而不是直接绑定公网 IP"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-no-public-ip.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_no_public_ip", Content: "package infraguard.rules.aliyun.ecs_instance_no_public_ip\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instance-no-public-ip\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECS instance should not bind public IP\",\n\t\t\"zh\": \"ECS 实例禁止绑定公网地址\",\n\t\t\"ja\": \"ECS インスタンスはパブリック IP をバインドすべきではない\",\n\t\t\"de\": \"ECS-Instanz sollte keine öffentliche IP binden\",\n\t\t\"es\": \"La Instancia ECS No Debe Vincular IP Pública\",\n\t\t\"fr\": \"L'Instance ECS Ne Doit Pas Lier d'IP Publique\",\n\t\t\"pt\": \"Instância ECS Não Deve Vincular IP Público\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS instances should not directly bind IPv4 public IP or Elastic IP, considered compliant.\",\n\t\t\"zh\": \"ECS 实例没有直接绑定 IPv4 公网 IP 或弹性公网 IP，视为合规。\",\n\t\t\"ja\": \"ECS インスタンスは IPv4 パブリック IP または Elastic IP を直接バインドすべきではなく、準拠と見なされます。\",\n\t\t\"de\": \"ECS-Instanzen sollten keine IPv4-öffentliche IP oder Elastic IP direkt binden, was als konform gilt.\",\n\t\t\"es\": \"Las instancias ECS no deben vincular directamente IP pública IPv4 o IP elástica, considerado conforme.\",\n\t\t\"fr\": \"Les instances ECS ne doivent pas lier directement d'IP publique IPv4 ou d'IP élastique, considéré comme conforme.\",\n\t\t\"pt\": \"As instâncias ECS não devem vincular diretamente IP público IPv4 ou IP elástico, considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS instance has a public IP bound\",\n\t\t\"zh\": \"ECS 实例绑定了公网地址\",\n\t\t\"ja\": \"ECS インスタンスにパブリック IP がバインドされています\",\n\t\t\"de\": \"ECS-Instanz hat eine öffentliche IP gebunden\",\n\t\t\"es\": \"La instancia ECS tiene una IP pública vinculada\",\n\t\t\"fr\": \"L'instance ECS a une IP publique liée\",\n\t\t\"pt\": \"A instância ECS tem um IP público vinculado\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use NAT Gateway or SLB for internet access instead of direct public IP binding\",\n\t\t\"zh\": \"使用 NAT 网关或 SLB 进行互联网访问，而不是直接绑定公网 IP\",\n\t\t\"ja\": \"直接パブリック IP バインディングの代わりに、インターネットアクセスに NAT ゲートウェイまたは SLB を使用します\",\n\t\t\"de\": \"Verwenden Sie NAT Gateway oder SLB für Internetzugriff anstelle der direkten Bindung öffentlicher IP\",\n\t\t\"es\": \"Use NAT Gateway o SLB para acceso a Internet en lugar de vinculación directa de IP pública\",\n\t\t\"fr\": \"Utilisez NAT Gateway ou SLB pour l'accès Internet au lieu de la liaison directe d'IP publique\",\n\t\t\"pt\": \"Use NAT Gateway ou SLB para acesso à Internet em vez de vinculação direta de IP público\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\n# Check if instance allocates public IP\nallocates_public_ip(resource) if {\n\thelpers.get_property(resource, \"AllocatePublicIP\", false) == true\n}\n\n# Check if instance has internet bandwidth (which may result in public IP)\nhas_internet_bandwidth(resource) if {\n\thelpers.has_property(resource, \"InternetMaxBandwidthOut\")\n\tresource.Properties.InternetMaxBandwidthOut > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\tallocates_public_ip(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AllocatePublicIP\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\thas_internet_bandwidth(resource)\n\tnot allocates_public_ip(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InternetMaxBandwidthOut\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Check if instance is referenced by EIPAssociation via Ref\n\tsome eip_name, eip_resource in helpers.resources_by_type(\"ALIYUN::VPC::EIPAssociation\")\n\tinstance_id := helpers.get_property(eip_resource, \"InstanceId\", \"\")\n\thelpers.is_referencing(instance_id, name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Check if instance is referenced by EIPAssociation via GetAtt\n\tsome eip_name, eip_resource in helpers.resources_by_type(\"ALIYUN::VPC::EIPAssociation\")\n\tinstance_id := helpers.get_property(eip_resource, \"InstanceId\", \"\")\n\thelpers.is_get_att_referencing(instance_id, name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-not-bind-key-pair", Name: models.I18nString{"de": "ECS-Instanz nicht an Schlüsselpaar gebunden", "en": "ECS Instance Not Bound to Key Pair", "es": "Instancia ECS No Vinculada a Par de Claves", "fr": "Instance ECS Non Liée à une Paire de Clés", "ja": "ECS インスタンスがキーペアにバインドされていない", "pt": "Instância ECS Não Vinculada a Par de Chaves", "zh": "ECS 实例未绑定密钥对检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen Schlüsselpaare für die Authentifizierung verwenden, anstatt Passwörter.", "en": "Ensures that ECS instances use key pairs for authentication instead of passwords.", "es": "Garantiza que las instancias ECS usen pares de claves para autenticación en lugar de contraseñas.", "fr": "Garantit que les instances ECS utilisent des paires de clés pour l'authentification au lieu de mots de passe.", "ja": "ECS インスタンスがパスワードではなくキーペアを使用して認証することを確認します。", "pt": "Garante que as instâncias ECS usem pares de chaves para autenticação em vez de senhas.", "zh": "确保 ECS 实例使用密钥对进行身份验证，而不是密码。"}, Reason: models.I18nString{"de": "Die Authentifizierung mit Schlüsselpaar ist sicherer als die Authentifizierung mit Passwort.", "en": "Key pair authentication is more secure than password authentication.", "es": "La autenticación con par de claves es más segura que la autenticación con contraseña.", "fr": "L'authentification par paire de clés est plus sécurisée que l'authentification par mot de passe.", "ja": "キーペア認証はパスワード認証よりも安全です。", "pt": "Autenticação com par de chaves é mais segura que autenticação com senha.", "zh": "密钥对身份验证比密码身份验证更安全。"}, Recommendation: models.I18nString{"de": "Binden Sie ein Schlüsselpaar an die ECS-Instanz und deaktivieren Sie die Passwortauthentifizierung.", "en": "Bind a key pair to the ECS instance and disable password authentication.", "es": "Vincule un par de claves a la instancia ECS y deshabilite la autenticación por contraseña.", "fr": "Lieez une paire de clés à l'instance ECS et désactivez l'authentification par mot de passe.", "ja": "ECS インスタンスにキーペアをバインドし、パスワード認証を無効にします。", "pt": "Vincule um par de chaves à instância ECS e desabilite autenticação com senha.", "zh": "为 ECS 实例绑定密钥对，并禁用密码身份验证。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-not-bind-key-pair.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_not_bind_key_pair", Content: "package infraguard.rules.aliyun.ecs_instance_not_bind_key_pair\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ecs-instance-not-bind-key-pair\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Not Bound to Key Pair\",\n\t\t\"zh\": \"ECS 实例未绑定密钥对检测\",\n\t\t\"ja\": \"ECS インスタンスがキーペアにバインドされていない\",\n\t\t\"de\": \"ECS-Instanz nicht an Schlüsselpaar gebunden\",\n\t\t\"es\": \"Instancia ECS No Vinculada a Par de Claves\",\n\t\t\"fr\": \"Instance ECS Non Liée à une Paire de Clés\",\n\t\t\"pt\": \"Instância ECS Não Vinculada a Par de Chaves\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ECS instances use key pairs for authentication instead of passwords.\",\n\t\t\"zh\": \"确保 ECS 实例使用密钥对进行身份验证，而不是密码。\",\n\t\t\"ja\": \"ECS インスタンスがパスワードではなくキーペアを使用して認証することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen Schlüsselpaare für die Authentifizierung verwenden, anstatt Passwörter.\",\n\t\t\"es\": \"Garantiza que las instancias ECS usen pares de claves para autenticación en lugar de contraseñas.\",\n\t\t\"fr\": \"Garantit que les instances ECS utilisent des paires de clés pour l'authentification au lieu de mots de passe.\",\n\t\t\"pt\": \"Garante que as instâncias ECS usem pares de chaves para autenticação em vez de senhas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Key pair authentication is more secure than password authentication.\",\n\t\t\"zh\": \"密钥对身份验证比密码身份验证更安全。\",\n\t\t\"ja\": \"キーペア認証はパスワード認証よりも安全です。\",\n\t\t\"de\": \"Die Authentifizierung mit Schlüsselpaar ist sicherer als die Authentifizierung mit Passwort.\",\n\t\t\"es\": \"La autenticación con par de claves es más segura que la autenticación con contraseña.\",\n\t\t\"fr\": \"L'authentification par paire de clés est plus sécurisée que l'authentification par mot de passe.\",\n\t\t\"pt\": \"Autenticação com par de chaves é mais segura que autenticação com senha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Bind a key pair to the ECS instance and disable password authentication.\",\n\t\t\"zh\": \"为 ECS 实例绑定密钥对，并禁用密码身份验证。\",\n\t\t\"ja\": \"ECS インスタンスにキーペアをバインドし、パスワード認証を無効にします。\",\n\t\t\"de\": \"Binden Sie ein Schlüsselpaar an die ECS-Instanz und deaktivieren Sie die Passwortauthentifizierung.\",\n\t\t\"es\": \"Vincule un par de claves a la instancia ECS y deshabilite la autenticación por contraseña.\",\n\t\t\"fr\": \"Lieez une paire de clés à l'instance ECS et désactivez l'authentification par mot de passe.\",\n\t\t\"pt\": \"Vincule um par de chaves à instância ECS e desabilite autenticação com senha.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\tnot helpers.has_property(resource, \"KeyPairName\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"KeyPairName\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-ram-role-attached", Name: models.I18nString{"de": "ECS-Instanz RAM-Rolle angehängt", "en": "ECS Instance RAM Role Attached", "es": "Rol RAM de Instancia ECS Adjunto", "fr": "Rôle RAM d'Instance ECS Attaché", "ja": "ECS インスタンスに RAM ロールがアタッチされている", "pt": "Função RAM de Instância ECS Anexada", "zh": "ECS 实例被授予实例 RAM 角色"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen eine IAM-Rolle angehängt haben, um sicher auf andere Cloud-Dienste zuzugreifen.", "en": "Ensures that ECS instances have an IAM role attached for secure access to other cloud services.", "es": "Garantiza que las instancias ECS tengan un rol IAM adjunto para acceso seguro a otros servicios en la nube.", "fr": "Garantit que les instances ECS ont un rôle IAM attaché pour un accès sécurisé aux autres services cloud.", "ja": "ECS インスタンスに IAM ロールがアタッチされ、他のクラウドサービスに安全にアクセスできることを確認します。", "pt": "Garante que as instâncias ECS tenham uma função IAM anexada para acesso seguro a outros serviços em nuvem.", "zh": "确保 ECS 实例被授予了实例 RAM 角色，以便安全地访问其他云服务。"}, Reason: models.I18nString{"de": "Die Verwendung von RAM-Rollen anstelle von hartcodierten AccessKeys verbessert die Sicherheit durch Bereitstellung temporärer Anmeldeinformationen.", "en": "Using RAM roles instead of hardcoded AccessKeys improves security by providing temporary credentials.", "es": "Usar roles RAM en lugar de AccessKeys codificadas mejora la seguridad al proporcionar credenciales temporales.", "fr": "Utiliser des rôles RAM au lieu d'AccessKeys codées en dur améliore la sécurité en fournissant des identifiants temporaires.", "ja": "ハードコードされた AccessKey の代わりに RAM ロールを使用することで、一時的な認証情報を提供してセキュリティを向上させます。", "pt": "Usar funções RAM em vez de AccessKeys codificadas melhora a segurança fornecendo credenciais temporárias.", "zh": "使用 RAM 角色代替硬编码的 AccessKey，通过提供临时凭证来提高安全性。"}, Recommendation: models.I18nString{"de": "Hängen Sie eine RAM-Rolle an die ECS-Instanz an.", "en": "Attach a RAM role to the ECS instance.", "es": "Adjunte un rol RAM a la instancia ECS.", "fr": "Attachez un rôle RAM à l'instance ECS.", "ja": "ECS インスタンスに RAM ロールをアタッチします。", "pt": "Anexe uma função RAM à instância ECS.", "zh": "为 ECS 实例授予 RAM 角色。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-ram-role-attached.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_ram_role_attached", Content: "package infraguard.rules.aliyun.ecs_instance_ram_role_attached\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ecs-instance-ram-role-attached\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance RAM Role Attached\",\n\t\t\"zh\": \"ECS 实例被授予实例 RAM 角色\",\n\t\t\"ja\": \"ECS インスタンスに RAM ロールがアタッチされている\",\n\t\t\"de\": \"ECS-Instanz RAM-Rolle angehängt\",\n\t\t\"es\": \"Rol RAM de Instancia ECS Adjunto\",\n\t\t\"fr\": \"Rôle RAM d'Instance ECS Attaché\",\n\t\t\"pt\": \"Função RAM de Instância ECS Anexada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ECS instances have an IAM role attached for secure access to other cloud services.\",\n\t\t\"zh\": \"确保 ECS 实例被授予了实例 RAM 角色，以便安全地访问其他云服务。\",\n\t\t\"ja\": \"ECS インスタンスに IAM ロールがアタッチされ、他のクラウドサービスに安全にアクセスできることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen eine IAM-Rolle angehängt haben, um sicher auf andere Cloud-Dienste zuzugreifen.\",\n\t\t\"es\": \"Garantiza que las instancias ECS tengan un rol IAM adjunto para acceso seguro a otros servicios en la nube.\",\n\t\t\"fr\": \"Garantit que les instances ECS ont un rôle IAM attaché pour un accès sécurisé aux autres services cloud.\",\n\t\t\"pt\": \"Garante que as instâncias ECS tenham uma função IAM anexada para acesso seguro a outros serviços em nuvem.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using RAM roles instead of hardcoded AccessKeys improves security by providing temporary credentials.\",\n\t\t\"zh\": \"使用 RAM 角色代替硬编码的 AccessKey，通过提供临时凭证来提高安全性。\",\n\t\t\"ja\": \"ハードコードされた AccessKey の代わりに RAM ロールを使用することで、一時的な認証情報を提供してセキュリティを向上させます。\",\n\t\t\"de\": \"Die Verwendung von RAM-Rollen anstelle von hartcodierten AccessKeys verbessert die Sicherheit durch Bereitstellung temporärer Anmeldeinformationen.\",\n\t\t\"es\": \"Usar roles RAM en lugar de AccessKeys codificadas mejora la seguridad al proporcionar credenciales temporales.\",\n\t\t\"fr\": \"Utiliser des rôles RAM au lieu d'AccessKeys codées en dur améliore la sécurité en fournissant des identifiants temporaires.\",\n\t\t\"pt\": \"Usar funções RAM em vez de AccessKeys codificadas melhora a segurança fornecendo credenciais temporárias.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach a RAM role to the ECS instance.\",\n\t\t\"zh\": \"为 ECS 实例授予 RAM 角色。\",\n\t\t\"ja\": \"ECS インスタンスに RAM ロールをアタッチします。\",\n\t\t\"de\": \"Hängen Sie eine RAM-Rolle an die ECS-Instanz an.\",\n\t\t\"es\": \"Adjunte un rol RAM a la instancia ECS.\",\n\t\t\"fr\": \"Attachez un rôle RAM à l'instance ECS.\",\n\t\t\"pt\": \"Anexe uma função RAM à instância ECS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\n# Check if instance has RAM role attached\nhas_ram_role(resource) if {\n\thelpers.has_property(resource, \"RamRoleName\")\n\trole := resource.Properties.RamRoleName\n\trole != \"\"\n}\n\n# Deny rule: ECS instances should have RAM role attached\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\tnot has_ram_role(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"RamRoleName\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instance-type-family-not-deprecated", Name: models.I18nString{"de": "ECS-Instanztyp nicht veraltet", "en": "ECS Instance Type Not Deprecated", "es": "Tipo de Instancia ECS No Deprecado", "fr": "Type d'Instance ECS Non Déprécié", "ja": "ECS インスタンスタイプが非推奨ではない", "pt": "Tipo de Instância ECS Não Depreciado", "zh": "ECS 弃用规格族预警"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen keine veralteten oder Legacy-Instanztypen verwenden.", "en": "Ensures ECS instances do not use deprecated or legacy instance types.", "es": "Garantiza que las instancias ECS no usen tipos de instancia deprecados o heredados.", "fr": "Garantit que les instances ECS n'utilisent pas de types d'instance dépréciés ou hérités.", "ja": "ECS インスタンスが非推奨またはレガシーインスタンスタイプを使用していないことを確認します。", "pt": "Garante que as instâncias ECS não usem tipos de instância depreciados ou legados.", "zh": "确保 ECS 实例未使用已弃用或陈旧的规格类型。"}, Reason: models.I18nString{"de": "Legacy-Instanztypen können eine geringere Leistung und begrenzte zukünftige Verfügbarkeit haben.", "en": "Legacy instance types may have lower performance and limited future availability.", "es": "Los tipos de instancia heredados pueden tener un rendimiento más bajo y disponibilidad futura limitada.", "fr": "Les types d'instance hérités peuvent avoir des performances inférieures et une disponibilité future limitée.", "ja": "レガシーインスタンスタイプは、パフォーマンスが低く、将来の可用性が制限される可能性があります。", "pt": "Tipos de instância legados podem ter desempenho mais baixo e disponibilidade futura limitada.", "zh": "陈旧的实例类型可能性能较低，且未来的可用性受限。"}, Recommendation: models.I18nString{"de": "Wechseln Sie zu neueren Instanztyp-Generationen (z. B. g6, c6, r6).", "en": "Move to newer generation instance types (e.g., g6, c6, r6).", "es": "Migre a tipos de instancia de nueva generación (por ejemplo, g6, c6, r6).", "fr": "Migrez vers des types d'instance de nouvelle génération (par exemple, g6, c6, r6).", "ja": "新しい世代のインスタンスタイプ（例：g6、c6、r6）に移行します。", "pt": "Migre para tipos de instância de nova geração (por exemplo, g6, c6, r6).", "zh": "迁移至新一代实例规格（如 g6, c6, r6）。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instance-type-family-not-deprecated.rego", PackageName: "infraguard.rules.aliyun.ecs_instance_type_family_not_deprecated", Content: "package infraguard.rules.aliyun.ecs_instance_type_family_not_deprecated\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ecs-instance-type-family-not-deprecated\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance Type Not Deprecated\",\n\t\t\"zh\": \"ECS 弃用规格族预警\",\n\t\t\"ja\": \"ECS インスタンスタイプが非推奨ではない\",\n\t\t\"de\": \"ECS-Instanztyp nicht veraltet\",\n\t\t\"es\": \"Tipo de Instancia ECS No Deprecado\",\n\t\t\"fr\": \"Type d'Instance ECS Non Déprécié\",\n\t\t\"pt\": \"Tipo de Instância ECS Não Depreciado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ECS instances do not use deprecated or legacy instance types.\",\n\t\t\"zh\": \"确保 ECS 实例未使用已弃用或陈旧的规格类型。\",\n\t\t\"ja\": \"ECS インスタンスが非推奨またはレガシーインスタンスタイプを使用していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen keine veralteten oder Legacy-Instanztypen verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias ECS no usen tipos de instancia deprecados o heredados.\",\n\t\t\"fr\": \"Garantit que les instances ECS n'utilisent pas de types d'instance dépréciés ou hérités.\",\n\t\t\"pt\": \"Garante que as instâncias ECS não usem tipos de instância depreciados ou legados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Legacy instance types may have lower performance and limited future availability.\",\n\t\t\"zh\": \"陈旧的实例类型可能性能较低，且未来的可用性受限。\",\n\t\t\"ja\": \"レガシーインスタンスタイプは、パフォーマンスが低く、将来の可用性が制限される可能性があります。\",\n\t\t\"de\": \"Legacy-Instanztypen können eine geringere Leistung und begrenzte zukünftige Verfügbarkeit haben.\",\n\t\t\"es\": \"Los tipos de instancia heredados pueden tener un rendimiento más bajo y disponibilidad futura limitada.\",\n\t\t\"fr\": \"Les types d'instance hérités peuvent avoir des performances inférieures et une disponibilité future limitée.\",\n\t\t\"pt\": \"Tipos de instância legados podem ter desempenho mais baixo e disponibilidade futura limitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Move to newer generation instance types (e.g., g6, c6, r6).\",\n\t\t\"zh\": \"迁移至新一代实例规格（如 g6, c6, r6）。\",\n\t\t\"ja\": \"新しい世代のインスタンスタイプ（例：g6、c6、r6）に移行します。\",\n\t\t\"de\": \"Wechseln Sie zu neueren Instanztyp-Generationen (z. B. g6, c6, r6).\",\n\t\t\"es\": \"Migre a tipos de instancia de nueva generación (por ejemplo, g6, c6, r6).\",\n\t\t\"fr\": \"Migrez vers des types d'instance de nouvelle génération (par exemple, g6, c6, r6).\",\n\t\t\"pt\": \"Migre para tipos de instância de nova geração (por exemplo, g6, c6, r6).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeprecated_prefixes := [\"ecs.t1.\", \"ecs.s1.\", \"ecs.m1.\", \"ecs.c1.\", \"ecs.n1.\"]\n\nis_compliant(resource) if {\n\ttype := helpers.get_property(resource, \"InstanceType\", \"\")\n\tnot is_deprecated(type)\n}\n\nis_deprecated(type) if {\n\tsome prefix in deprecated_prefixes\n\tstartswith(type, prefix)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InstanceType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-instances-in-vpc", Name: models.I18nString{"de": "ECS-Instanzen in VPC", "en": "ECS Instances in VPC", "es": "Instancias ECS en VPC", "fr": "Instances ECS dans le VPC", "ja": "VPC 内の ECS インスタンス", "pt": "Instâncias ECS em VPC", "zh": "使用专有网络类型的 ECS 实例"}, Severity: "medium", Description: models.I18nString{"de": "ECS-Instanzen sollten in VPC (Virtual Private Cloud) Netzwerken und nicht in klassischen Netzwerken bereitgestellt werden. VPC bietet bessere Netzwerkisolation, Sicherheit und Flexibilität.", "en": "ECS instances should be deployed in VPC (Virtual Private Cloud) networks rather than classic networks. VPC provides better network isolation, security, and flexibility.", "es": "Las instancias ECS deben implementarse en redes VPC (Virtual Private Cloud) en lugar de redes clásicas. VPC proporciona mejor aislamiento de red, seguridad y flexibilidad.", "fr": "Les instances ECS doivent être déployées dans des réseaux VPC (Virtual Private Cloud) plutôt que dans des réseaux classiques. VPC offre une meilleure isolation réseau, sécurité et flexibilité.", "ja": "ECS インスタンスは、クラシックネットワークではなく VPC（Virtual Private Cloud）ネットワークに展開する必要があります。VPC はより優れたネットワーク分離、セキュリティ、柔軟性を提供します。", "pt": "Instâncias ECS devem ser implantadas em redes VPC (Virtual Private Cloud) em vez de redes clássicas. O VPC fornece melhor isolamento de rede, segurança e flexibilidade.", "zh": "ECS 实例应部署在专有网络(VPC)而非经典网络中。VPC 提供更好的网络隔离、安全性和灵活性。"}, Reason: models.I18nString{"de": "Die ECS-Instanz ist nicht in einem VPC bereitgestellt, was zu unzureichender Netzwerkisolation und Sicherheit führen kann.", "en": "The ECS instance is not deployed in a VPC, which may result in insufficient network isolation and security.", "es": "La instancia ECS no está implementada en un VPC, lo que puede resultar en aislamiento de red y seguridad insuficientes.", "fr": "L'instance ECS n'est pas déployée dans un VPC, ce qui peut entraîner un isolement réseau et une sécurité insuffisants.", "ja": "ECS インスタンスが VPC に展開されていないため、ネットワーク分離とセキュリティが不十分になる可能性があります。", "pt": "A instância ECS não está implantada em um VPC, o que pode resultar em isolamento de rede e segurança insuficientes.", "zh": "ECS 实例未部署在 VPC 中，可能导致网络隔离和安全性不足。"}, Recommendation: models.I18nString{"de": "Stellen Sie die ECS-Instanz in einem VPC bereit, indem Sie die Eigenschaften VpcId und VSwitchId angeben.", "en": "Deploy the ECS instance in a VPC by specifying the VpcId and VSwitchId properties.", "es": "Implemente la instancia ECS en un VPC especificando las propiedades VpcId y VSwitchId.", "fr": "Déployez l'instance ECS dans un VPC en spécifiant les propriétés VpcId et VSwitchId.", "ja": "VpcId と VSwitchId プロパティを指定して、ECS インスタンスを VPC に展開します。", "pt": "Implante a instância ECS em um VPC especificando as propriedades VpcId e VSwitchId.", "zh": "通过指定 VpcId 和 VSwitchId 属性，将 ECS 实例部署在 VPC 中。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-instances-in-vpc.rego", PackageName: "infraguard.rules.aliyun.ecs_instances_in_vpc", Content: "package infraguard.rules.aliyun.ecs_instances_in_vpc\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-instances-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instances in VPC\",\n\t\t\"zh\": \"使用专有网络类型的 ECS 实例\",\n\t\t\"ja\": \"VPC 内の ECS インスタンス\",\n\t\t\"de\": \"ECS-Instanzen in VPC\",\n\t\t\"es\": \"Instancias ECS en VPC\",\n\t\t\"fr\": \"Instances ECS dans le VPC\",\n\t\t\"pt\": \"Instâncias ECS em VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS instances should be deployed in VPC (Virtual Private Cloud) networks rather than classic networks. VPC provides better network isolation, security, and flexibility.\",\n\t\t\"zh\": \"ECS 实例应部署在专有网络(VPC)而非经典网络中。VPC 提供更好的网络隔离、安全性和灵活性。\",\n\t\t\"ja\": \"ECS インスタンスは、クラシックネットワークではなく VPC（Virtual Private Cloud）ネットワークに展開する必要があります。VPC はより優れたネットワーク分離、セキュリティ、柔軟性を提供します。\",\n\t\t\"de\": \"ECS-Instanzen sollten in VPC (Virtual Private Cloud) Netzwerken und nicht in klassischen Netzwerken bereitgestellt werden. VPC bietet bessere Netzwerkisolation, Sicherheit und Flexibilität.\",\n\t\t\"es\": \"Las instancias ECS deben implementarse en redes VPC (Virtual Private Cloud) en lugar de redes clásicas. VPC proporciona mejor aislamiento de red, seguridad y flexibilidad.\",\n\t\t\"fr\": \"Les instances ECS doivent être déployées dans des réseaux VPC (Virtual Private Cloud) plutôt que dans des réseaux classiques. VPC offre une meilleure isolation réseau, sécurité et flexibilité.\",\n\t\t\"pt\": \"Instâncias ECS devem ser implantadas em redes VPC (Virtual Private Cloud) em vez de redes clássicas. O VPC fornece melhor isolamento de rede, segurança e flexibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ECS instance is not deployed in a VPC, which may result in insufficient network isolation and security.\",\n\t\t\"zh\": \"ECS 实例未部署在 VPC 中，可能导致网络隔离和安全性不足。\",\n\t\t\"ja\": \"ECS インスタンスが VPC に展開されていないため、ネットワーク分離とセキュリティが不十分になる可能性があります。\",\n\t\t\"de\": \"Die ECS-Instanz ist nicht in einem VPC bereitgestellt, was zu unzureichender Netzwerkisolation und Sicherheit führen kann.\",\n\t\t\"es\": \"La instancia ECS no está implementada en un VPC, lo que puede resultar en aislamiento de red y seguridad insuficientes.\",\n\t\t\"fr\": \"L'instance ECS n'est pas déployée dans un VPC, ce qui peut entraîner un isolement réseau et une sécurité insuffisants.\",\n\t\t\"pt\": \"A instância ECS não está implantada em um VPC, o que pode resultar em isolamento de rede e segurança insuficientes.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy the ECS instance in a VPC by specifying the VpcId and VSwitchId properties.\",\n\t\t\"zh\": \"通过指定 VpcId 和 VSwitchId 属性，将 ECS 实例部署在 VPC 中。\",\n\t\t\"ja\": \"VpcId と VSwitchId プロパティを指定して、ECS インスタンスを VPC に展開します。\",\n\t\t\"de\": \"Stellen Sie die ECS-Instanz in einem VPC bereit, indem Sie die Eigenschaften VpcId und VSwitchId angeben.\",\n\t\t\"es\": \"Implemente la instancia ECS en un VPC especificando las propiedades VpcId y VSwitchId.\",\n\t\t\"fr\": \"Déployez l'instance ECS dans un VPC en spécifiant les propriétés VpcId et VSwitchId.\",\n\t\t\"pt\": \"Implante a instância ECS em um VPC especificando as propriedades VpcId e VSwitchId.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types({\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"})\n\tnot is_in_vpc(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nis_in_vpc(resource) if {\n\thelpers.has_property(resource, \"VpcId\")\n\thelpers.has_property(resource, \"VSwitchId\")\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-internet-charge-type-check", Name: models.I18nString{"de": "ECS Internet-Abrechnungstyp-Prüfung", "en": "ECS Internet Charge Type Check", "es": "Verificación de Tipo de Cargo de Internet ECS", "fr": "Vérification du Type de Facturation Internet ECS", "ja": "ECS インターネット課金タイプチェック", "pt": "Verificação de Tipo de Cobrança de Internet ECS", "zh": "ECS 公网带宽计费方式核查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Instanzen den bevorzugten Internet-Abrechnungstyp verwenden.", "en": "Ensures ECS instances use the preferred internet charge type.", "es": "Garantiza que las instancias ECS usen el tipo de cargo de Internet preferido.", "fr": "Garantit que les instances ECS utilisent le type de facturation Internet préféré.", "ja": "ECS インスタンスが優先インターネット課金タイプを使用することを確認します。", "pt": "Garante que as instâncias ECS usem o tipo de cobrança de Internet preferido.", "zh": "确保 ECS 实例使用首选的公网带宽计费方式。"}, Reason: models.I18nString{"de": "Konsistente Abrechnungstypen helfen bei vorhersehbarer Abrechnung und Kostenverwaltung.", "en": "Consistent charge types help in predictable billing and cost management.", "es": "Los tipos de cargo consistentes ayudan en la facturación predecible y la gestión de costos.", "fr": "Des types de facturation cohérents aident à une facturation prévisible et à la gestion des coûts.", "ja": "一貫した課金タイプにより、予測可能な請求とコスト管理が可能になります。", "pt": "Tipos de cobrança consistentes ajudam na cobrança previsível e no gerenciamento de custos.", "zh": "一致的计费方式有助于实现可预测的账单和成本管理。"}, Recommendation: models.I18nString{"de": "Setzen Sie InternetChargeType auf 'PayByTraffic'.", "en": "Set InternetChargeType to 'PayByTraffic'.", "es": "Establezca InternetChargeType en 'PayByTraffic'.", "fr": "Définissez InternetChargeType sur 'PayByTraffic'.", "ja": "InternetChargeType を 'PayByTraffic' に設定します。", "pt": "Defina InternetChargeType como 'PayByTraffic'.", "zh": "将 InternetChargeType 设置为'PayByTraffic'。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-internet-charge-type-check.rego", PackageName: "infraguard.rules.aliyun.ecs_internet_charge_type_check", Content: "package infraguard.rules.aliyun.ecs_internet_charge_type_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ecs-internet-charge-type-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS Internet Charge Type Check\",\n\t\t\"zh\": \"ECS 公网带宽计费方式核查\",\n\t\t\"ja\": \"ECS インターネット課金タイプチェック\",\n\t\t\"de\": \"ECS Internet-Abrechnungstyp-Prüfung\",\n\t\t\"es\": \"Verificación de Tipo de Cargo de Internet ECS\",\n\t\t\"fr\": \"Vérification du Type de Facturation Internet ECS\",\n\t\t\"pt\": \"Verificação de Tipo de Cobrança de Internet ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ECS instances use the preferred internet charge type.\",\n\t\t\"zh\": \"确保 ECS 实例使用首选的公网带宽计费方式。\",\n\t\t\"ja\": \"ECS インスタンスが優先インターネット課金タイプを使用することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Instanzen den bevorzugten Internet-Abrechnungstyp verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias ECS usen el tipo de cargo de Internet preferido.\",\n\t\t\"fr\": \"Garantit que les instances ECS utilisent le type de facturation Internet préféré.\",\n\t\t\"pt\": \"Garante que as instâncias ECS usem o tipo de cobrança de Internet preferido.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Consistent charge types help in predictable billing and cost management.\",\n\t\t\"zh\": \"一致的计费方式有助于实现可预测的账单和成本管理。\",\n\t\t\"ja\": \"一貫した課金タイプにより、予測可能な請求とコスト管理が可能になります。\",\n\t\t\"de\": \"Konsistente Abrechnungstypen helfen bei vorhersehbarer Abrechnung und Kostenverwaltung.\",\n\t\t\"es\": \"Los tipos de cargo consistentes ayudan en la facturación predecible y la gestión de costos.\",\n\t\t\"fr\": \"Des types de facturation cohérents aident à une facturation prévisible et à la gestion des coûts.\",\n\t\t\"pt\": \"Tipos de cobrança consistentes ajudam na cobrança previsível e no gerenciamento de custos.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set InternetChargeType to 'PayByTraffic'.\",\n\t\t\"zh\": \"将 InternetChargeType 设置为'PayByTraffic'。\",\n\t\t\"ja\": \"InternetChargeType を 'PayByTraffic' に設定します。\",\n\t\t\"de\": \"Setzen Sie InternetChargeType auf 'PayByTraffic'.\",\n\t\t\"es\": \"Establezca InternetChargeType en 'PayByTraffic'.\",\n\t\t\"fr\": \"Définissez InternetChargeType sur 'PayByTraffic'.\",\n\t\t\"pt\": \"Defina InternetChargeType como 'PayByTraffic'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\nis_compliant(resource) if {\n\tcharge_type := helpers.get_property(resource, \"InternetChargeType\", \"PayByTraffic\")\n\tcharge_type == \"PayByTraffic\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InternetChargeType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-internetmaxbandwidth-check", Name: models.I18nString{"de": "ECS-Internet Max-Bandbreitenprüfung", "en": "ECS Internet Max Bandwidth Check", "es": "Verificación de Ancho de Banda Máximo de Internet ECS", "fr": "Vérification de la Bande Passante Internet Maximale ECS", "ja": "ECS インターネット最大帯域幅チェック", "pt": "Verificação de Largura de Banda Máxima da Internet ECS", "zh": "ECS 公网出口带宽检查"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die ausgehende Internet-Bandbreite von ECS die angegebenen Grenzwerte nicht überschreitet.", "en": "Ensures ECS internet outbound bandwidth does not exceed specified limits.", "es": "Garantiza que el ancho de banda saliente de Internet ECS no exceda los límites especificados.", "fr": "Garantit que la bande passante Internet sortante ECS ne dépasse pas les limites spécifiées.", "ja": "ECS インターネット送信帯域幅が指定された制限を超えないことを確認します。", "pt": "Garante que a largura de banda de saída da Internet ECS não exceda os limites especificados.", "zh": "确保 ECS 公网出口带宽不超过指定限制。"}, Reason: models.I18nString{"de": "Hohe Bandbreiteneinstellungen können zu unerwarteten Kosten und einer erhöhten Angriffsfläche führen.", "en": "High bandwidth settings can lead to unexpected costs and increased attack surface.", "es": "Las configuraciones de alto ancho de banda pueden provocar costos inesperados y una superficie de ataque aumentada.", "fr": "Les paramètres de bande passante élevée peuvent entraîner des coûts inattendus et une surface d'attaque accrue.", "ja": "高い帯域幅設定は、予期しないコストの増加と攻撃面の拡大につながる可能性があります。", "pt": "Configurações de largura de banda alta podem levar a custos inesperados e aumento da superfície de ataque.", "zh": "高带宽设置可能导致意外成本增加并扩大攻击面。"}, Recommendation: models.I18nString{"de": "Begrenzen Sie InternetMaxBandwidthOut auf einen angemessenen Wert (z. B. 100 Mbps).", "en": "Limit the InternetMaxBandwidthOut to a reasonable value (e.g., 100Mbps).", "es": "Limite InternetMaxBandwidthOut a un valor razonable (por ejemplo, 100 Mbps).", "fr": "Limitez InternetMaxBandwidthOut à une valeur raisonnable (par exemple, 100 Mbps).", "ja": "InternetMaxBandwidthOut を合理的な値（例：100Mbps）に制限します。", "pt": "Limite InternetMaxBandwidthOut a um valor razoável (por exemplo, 100 Mbps).", "zh": "将 InternetMaxBandwidthOut 限制在合理范围内（例如 100Mbps）。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-internetmaxbandwidth-check.rego", PackageName: "infraguard.rules.aliyun.ecs_internetmaxbandwidth_check", Content: "package infraguard.rules.aliyun.ecs_internetmaxbandwidth_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ecs-internetmaxbandwidth-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS Internet Max Bandwidth Check\",\n\t\t\"zh\": \"ECS 公网出口带宽检查\",\n\t\t\"ja\": \"ECS インターネット最大帯域幅チェック\",\n\t\t\"de\": \"ECS-Internet Max-Bandbreitenprüfung\",\n\t\t\"es\": \"Verificación de Ancho de Banda Máximo de Internet ECS\",\n\t\t\"fr\": \"Vérification de la Bande Passante Internet Maximale ECS\",\n\t\t\"pt\": \"Verificação de Largura de Banda Máxima da Internet ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ECS internet outbound bandwidth does not exceed specified limits.\",\n\t\t\"zh\": \"确保 ECS 公网出口带宽不超过指定限制。\",\n\t\t\"ja\": \"ECS インターネット送信帯域幅が指定された制限を超えないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die ausgehende Internet-Bandbreite von ECS die angegebenen Grenzwerte nicht überschreitet.\",\n\t\t\"es\": \"Garantiza que el ancho de banda saliente de Internet ECS no exceda los límites especificados.\",\n\t\t\"fr\": \"Garantit que la bande passante Internet sortante ECS ne dépasse pas les limites spécifiées.\",\n\t\t\"pt\": \"Garante que a largura de banda de saída da Internet ECS não exceda os limites especificados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"High bandwidth settings can lead to unexpected costs and increased attack surface.\",\n\t\t\"zh\": \"高带宽设置可能导致意外成本增加并扩大攻击面。\",\n\t\t\"ja\": \"高い帯域幅設定は、予期しないコストの増加と攻撃面の拡大につながる可能性があります。\",\n\t\t\"de\": \"Hohe Bandbreiteneinstellungen können zu unerwarteten Kosten und einer erhöhten Angriffsfläche führen.\",\n\t\t\"es\": \"Las configuraciones de alto ancho de banda pueden provocar costos inesperados y una superficie de ataque aumentada.\",\n\t\t\"fr\": \"Les paramètres de bande passante élevée peuvent entraîner des coûts inattendus et une surface d'attaque accrue.\",\n\t\t\"pt\": \"Configurações de largura de banda alta podem levar a custos inesperados e aumento da superfície de ataque.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Limit the InternetMaxBandwidthOut to a reasonable value (e.g., 100Mbps).\",\n\t\t\"zh\": \"将 InternetMaxBandwidthOut 限制在合理范围内（例如 100Mbps）。\",\n\t\t\"ja\": \"InternetMaxBandwidthOut を合理的な値（例：100Mbps）に制限します。\",\n\t\t\"de\": \"Begrenzen Sie InternetMaxBandwidthOut auf einen angemessenen Wert (z. B. 100 Mbps).\",\n\t\t\"es\": \"Limite InternetMaxBandwidthOut a un valor razonable (por ejemplo, 100 Mbps).\",\n\t\t\"fr\": \"Limitez InternetMaxBandwidthOut à une valeur raisonnable (par exemple, 100 Mbps).\",\n\t\t\"pt\": \"Limite InternetMaxBandwidthOut a um valor razoável (por exemplo, 100 Mbps).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\nis_compliant(resource) if {\n\tbandwidth := helpers.get_property(resource, \"InternetMaxBandwidthOut\", 1)\n\tbandwidth <= 100\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InternetMaxBandwidthOut\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-launch-template-network-type-check", Name: models.I18nString{"de": "ECS-Startvorlage verwendet VPC-Netzwerktyp", "en": "ECS launch template uses VPC network type", "es": "La plantilla de inicio de ECS usa tipo de red VPC", "fr": "Le modèle de lancement ECS utilise le type de réseau VPC", "ja": "ECS 起動テンプレートが VPC ネットワークタイプを使用", "pt": "O modelo de inicialização do ECS usa tipo de rede VPC", "zh": "ECS 启动模版配置不应设置公网访问"}, Severity: "medium", Description: models.I18nString{"de": "ECS-Startvorlagenversionen haben den Netzwerktyp auf VPC gesetzt, was als konform gilt. Der klassische Netzwerktyp wird für Produktionsumgebungen nicht empfohlen.", "en": "ECS launch template versions have network type set to VPC, considered compliant. Classic network type is not recommended for production environments.", "es": "Las versiones de plantilla de inicio de ECS tienen el tipo de red configurado como VPC, considerado conforme. El tipo de red clásica no se recomienda para entornos de producción.", "fr": "Les versions de modèle de lancement ECS ont le type de réseau défini sur VPC, considéré comme conforme. Le type de réseau classique n'est pas recommandé pour les environnements de production.", "ja": "ECS 起動テンプレートバージョンでネットワークタイプが VPC に設定されている場合、準拠と見なされます。クラシックネットワークタイプは本番環境には推奨されません。", "pt": "As versões do modelo de inicialização do ECS têm o tipo de rede definido como VPC, considerado em conformidade. O tipo de rede clássica não é recomendado para ambientes de produção.", "zh": "ECS 启动模版版本中网络类型为 VPC 类型，视为合规。"}, Reason: models.I18nString{"de": "ECS-Startvorlage ist mit klassischem Netzwerktyp konfiguriert", "en": "ECS launch template is configured with classic network type", "es": "La plantilla de inicio de ECS está configurada con tipo de red clásica", "fr": "Le modèle de lancement ECS est configuré avec le type de réseau classique", "ja": "ECS 起動テンプレートがクラシックネットワークタイプで設定されています", "pt": "O modelo de inicialização do ECS está configurado com tipo de rede clássica", "zh": "ECS 启动模板配置了经典网络类型"}, Recommendation: models.I18nString{"de": "Verwenden Sie den VPC-Netzwerktyp in Startvorlagen für bessere Netzwerkisolation", "en": "Use VPC network type in launch templates for better network isolation", "es": "Use el tipo de red VPC en las plantillas de inicio para mejor aislamiento de red", "fr": "Utilisez le type de réseau VPC dans les modèles de lancement pour une meilleure isolation réseau", "ja": "より良いネットワーク分離のために起動テンプレートで VPC ネットワークタイプを使用します", "pt": "Use o tipo de rede VPC nos modelos de inicialização para melhor isolamento de rede", "zh": "在启动模板中使用 VPC 网络类型以获得更好的网络隔离"}, ResourceTypes: []string{"ALIYUN::ECS::LaunchTemplate"}, FilePath: "aliyun/rules/ecs-launch-template-network-type-check.rego", PackageName: "infraguard.rules.aliyun.ecs_launch_template_network_type_check", Content: "package infraguard.rules.aliyun.ecs_launch_template_network_type_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-launch-template-network-type-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS launch template uses VPC network type\",\n\t\t\"zh\": \"ECS 启动模版配置不应设置公网访问\",\n\t\t\"ja\": \"ECS 起動テンプレートが VPC ネットワークタイプを使用\",\n\t\t\"de\": \"ECS-Startvorlage verwendet VPC-Netzwerktyp\",\n\t\t\"es\": \"La plantilla de inicio de ECS usa tipo de red VPC\",\n\t\t\"fr\": \"Le modèle de lancement ECS utilise le type de réseau VPC\",\n\t\t\"pt\": \"O modelo de inicialização do ECS usa tipo de rede VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS launch template versions have network type set to VPC, considered compliant. Classic network type is not recommended for production environments.\",\n\t\t\"zh\": \"ECS 启动模版版本中网络类型为 VPC 类型，视为合规。\",\n\t\t\"ja\": \"ECS 起動テンプレートバージョンでネットワークタイプが VPC に設定されている場合、準拠と見なされます。クラシックネットワークタイプは本番環境には推奨されません。\",\n\t\t\"de\": \"ECS-Startvorlagenversionen haben den Netzwerktyp auf VPC gesetzt, was als konform gilt. Der klassische Netzwerktyp wird für Produktionsumgebungen nicht empfohlen.\",\n\t\t\"es\": \"Las versiones de plantilla de inicio de ECS tienen el tipo de red configurado como VPC, considerado conforme. El tipo de red clásica no se recomienda para entornos de producción.\",\n\t\t\"fr\": \"Les versions de modèle de lancement ECS ont le type de réseau défini sur VPC, considéré comme conforme. Le type de réseau classique n'est pas recommandé pour les environnements de production.\",\n\t\t\"pt\": \"As versões do modelo de inicialização do ECS têm o tipo de rede definido como VPC, considerado em conformidade. O tipo de rede clássica não é recomendado para ambientes de produção.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS launch template is configured with classic network type\",\n\t\t\"zh\": \"ECS 启动模板配置了经典网络类型\",\n\t\t\"ja\": \"ECS 起動テンプレートがクラシックネットワークタイプで設定されています\",\n\t\t\"de\": \"ECS-Startvorlage ist mit klassischem Netzwerktyp konfiguriert\",\n\t\t\"es\": \"La plantilla de inicio de ECS está configurada con tipo de red clásica\",\n\t\t\"fr\": \"Le modèle de lancement ECS est configuré avec le type de réseau classique\",\n\t\t\"pt\": \"O modelo de inicialização do ECS está configurado com tipo de rede clássica\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use VPC network type in launch templates for better network isolation\",\n\t\t\"zh\": \"在启动模板中使用 VPC 网络类型以获得更好的网络隔离\",\n\t\t\"ja\": \"より良いネットワーク分離のために起動テンプレートで VPC ネットワークタイプを使用します\",\n\t\t\"de\": \"Verwenden Sie den VPC-Netzwerktyp in Startvorlagen für bessere Netzwerkisolation\",\n\t\t\"es\": \"Use el tipo de red VPC en las plantillas de inicio para mejor aislamiento de red\",\n\t\t\"fr\": \"Utilisez le type de réseau VPC dans les modèles de lancement pour une meilleure isolation réseau\",\n\t\t\"pt\": \"Use o tipo de rede VPC nos modelos de inicialização para melhor isolamento de rede\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::LaunchTemplate\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::LaunchTemplate\")\n\n\t# Check network type\n\tnetwork_type := helpers.get_property(resource, \"NetworkType\", \"\")\n\n\t# Classic network is not recommended\n\tnetwork_type == \"classic\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"NetworkType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-launch-template-version-attach-security-group", Name: models.I18nString{"de": "ECS-Startvorlagenversion fügt Sicherheitsgruppen hinzu", "en": "ECS launch template version attaches security groups", "es": "La Versión de Plantilla de Inicio ECS Adjunta Grupos de Seguridad", "fr": "La Version du Modèle de Démarrage ECS Attache les Groupes de Sécurité", "ja": "ECS 起動テンプレートバージョンがセキュリティグループをアタッチ", "pt": "Versão do Modelo de Inicialização ECS Anexa Grupos de Segurança", "zh": "ECS 启动模版版本中设置加入的安全组"}, Severity: "high", Description: models.I18nString{"de": "ECS-Startvorlagenversionen haben Sicherheitsgruppen für Instanzen konfiguriert, was als konform gilt.", "en": "ECS launch template versions have security groups configured for instances, considered compliant.", "es": "Las versiones de plantilla de inicio ECS tienen grupos de seguridad configurados para instancias, considerado conforme.", "fr": "Les versions de modèle de démarrage ECS ont des groupes de sécurité configurés pour les instances, considéré comme conforme.", "ja": "ECS 起動テンプレートバージョンにインスタンス用のセキュリティグループが設定されており、準拠と見なされます。", "pt": "As versões do modelo de inicialização ECS têm grupos de segurança configurados para instâncias, considerado conforme.", "zh": "ECS 启动模版版本中设置了实例要加入的安全组，视为合规。"}, Reason: models.I18nString{"de": "ECS-Startvorlagenversion hat keine Sicherheitsgruppen konfiguriert", "en": "ECS launch template version does not have security groups configured", "es": "La versión de plantilla de inicio ECS no tiene grupos de seguridad configurados", "fr": "La version du modèle de démarrage ECS n'a pas de groupes de sécurité configurés", "ja": "ECS 起動テンプレートバージョンにセキュリティグループが設定されていません", "pt": "A versão do modelo de inicialização ECS não tem grupos de segurança configurados", "zh": "ECS 启动模板版本未配置安全组"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie Sicherheitsgruppen in Startvorlagenversionen für die Instanznetzwerksicherheit", "en": "Configure security groups in launch template versions for instance network security", "es": "Configure grupos de seguridad en versiones de plantilla de inicio para la seguridad de red de instancias", "fr": "Configurez les groupes de sécurité dans les versions de modèle de démarrage pour la sécurité réseau des instances", "ja": "インスタンスネットワークセキュリティのために起動テンプレートバージョンでセキュリティグループを設定します", "pt": "Configure grupos de segurança nas versões do modelo de inicialização para segurança de rede da instância", "zh": "在启动模板版本中配置安全组以确保实例网络安全"}, ResourceTypes: []string{"ALIYUN::ECS::LaunchTemplate"}, FilePath: "aliyun/rules/ecs-launch-template-version-attach-security-group.rego", PackageName: "infraguard.rules.aliyun.ecs_launch_template_version_attach_security_group", Content: "package infraguard.rules.aliyun.ecs_launch_template_version_attach_security_group\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-launch-template-version-attach-security-group\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECS launch template version attaches security groups\",\n\t\t\"zh\": \"ECS 启动模版版本中设置加入的安全组\",\n\t\t\"ja\": \"ECS 起動テンプレートバージョンがセキュリティグループをアタッチ\",\n\t\t\"de\": \"ECS-Startvorlagenversion fügt Sicherheitsgruppen hinzu\",\n\t\t\"es\": \"La Versión de Plantilla de Inicio ECS Adjunta Grupos de Seguridad\",\n\t\t\"fr\": \"La Version du Modèle de Démarrage ECS Attache les Groupes de Sécurité\",\n\t\t\"pt\": \"Versão do Modelo de Inicialização ECS Anexa Grupos de Segurança\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS launch template versions have security groups configured for instances, considered compliant.\",\n\t\t\"zh\": \"ECS 启动模版版本中设置了实例要加入的安全组，视为合规。\",\n\t\t\"ja\": \"ECS 起動テンプレートバージョンにインスタンス用のセキュリティグループが設定されており、準拠と見なされます。\",\n\t\t\"de\": \"ECS-Startvorlagenversionen haben Sicherheitsgruppen für Instanzen konfiguriert, was als konform gilt.\",\n\t\t\"es\": \"Las versiones de plantilla de inicio ECS tienen grupos de seguridad configurados para instancias, considerado conforme.\",\n\t\t\"fr\": \"Les versions de modèle de démarrage ECS ont des groupes de sécurité configurés pour les instances, considéré comme conforme.\",\n\t\t\"pt\": \"As versões do modelo de inicialização ECS têm grupos de segurança configurados para instâncias, considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS launch template version does not have security groups configured\",\n\t\t\"zh\": \"ECS 启动模板版本未配置安全组\",\n\t\t\"ja\": \"ECS 起動テンプレートバージョンにセキュリティグループが設定されていません\",\n\t\t\"de\": \"ECS-Startvorlagenversion hat keine Sicherheitsgruppen konfiguriert\",\n\t\t\"es\": \"La versión de plantilla de inicio ECS no tiene grupos de seguridad configurados\",\n\t\t\"fr\": \"La version du modèle de démarrage ECS n'a pas de groupes de sécurité configurés\",\n\t\t\"pt\": \"A versão do modelo de inicialização ECS não tem grupos de segurança configurados\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure security groups in launch template versions for instance network security\",\n\t\t\"zh\": \"在启动模板版本中配置安全组以确保实例网络安全\",\n\t\t\"ja\": \"インスタンスネットワークセキュリティのために起動テンプレートバージョンでセキュリティグループを設定します\",\n\t\t\"de\": \"Konfigurieren Sie Sicherheitsgruppen in Startvorlagenversionen für die Instanznetzwerksicherheit\",\n\t\t\"es\": \"Configure grupos de seguridad en versiones de plantilla de inicio para la seguridad de red de instancias\",\n\t\t\"fr\": \"Configurez les groupes de sécurité dans les versions de modèle de démarrage pour la sécurité réseau des instances\",\n\t\t\"pt\": \"Configure grupos de segurança nas versões do modelo de inicialização para segurança de rede da instância\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::LaunchTemplate\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::LaunchTemplate\")\n\n\t# Check if security group is configured\n\tsecurity_group_id := helpers.get_property(resource, \"SecurityGroupId\", \"\")\n\tsecurity_group_ids := helpers.get_property(resource, \"SecurityGroupIds\", [])\n\n\t# Neither SecurityGroupId nor SecurityGroupIds is specified\n\tsecurity_group_id == \"\"\n\tcount(security_group_ids) == 0\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-launch-template-version-data-disk-encrypted", Name: models.I18nString{"de": "ECS-Startvorlagenversion aktiviert Datenfestplattenverschlüsselung", "en": "ECS launch template version enables data disk encryption", "es": "La Versión de Plantilla de Inicio ECS Habilita el Cifrado de Disco de Datos", "fr": "La Version du Modèle de Démarrage ECS Active le Chiffrement de Disque de Données", "ja": "ECS 起動テンプレートバージョンでデータディスク暗号化が有効", "pt": "A Versão do Modelo de Inicialização ECS Habilita a Criptografia de Disco de Dados", "zh": "ECS 启动模版版本中设置数据磁盘加密"}, Severity: "medium", Description: models.I18nString{"de": "Alle in ECS-Startvorlagenversionen konfigurierten Datenfestplatten sind verschlüsselt und gelten als konform.", "en": "All data disks configured in ECS launch template versions are encrypted, considered compliant.", "es": "Todos los discos de datos configurados en las versiones de plantilla de inicio ECS están cifrados, considerado conforme.", "fr": "Tous les disques de données configurés dans les versions de modèle de démarrage ECS sont chiffrés, considéré comme conforme.", "ja": "ECS 起動テンプレートバージョンで設定されたすべてのデータディスクが暗号化されており、準拠と見なされます。", "pt": "Todos os discos de dados configurados nas versões do modelo de inicialização ECS estão criptografados, considerado conforme.", "zh": "ECS 启动模版版本中数据磁盘配置均设置为加密，视为合规。"}, Reason: models.I18nString{"de": "ECS-Startvorlagenversion hat Datenfestplatten ohne aktivierte Verschlüsselung", "en": "ECS launch template version has data disks without encryption enabled", "es": "La versión de plantilla de inicio ECS tiene discos de datos sin cifrado habilitado", "fr": "La version du modèle de démarrage ECS a des disques de données sans chiffrement activé", "ja": "ECS 起動テンプレートバージョンに暗号化が有効になっていないデータディスクがある", "pt": "A versão do modelo de inicialização ECS tem discos de dados sem criptografia habilitada", "zh": "ECS 启动模板版本的数据磁盘未启用加密"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Verschlüsselung für alle Datenfestplatten in Startvorlagenversionen", "en": "Enable encryption for all data disks in launch template versions", "es": "Habilite el cifrado para todos los discos de datos en las versiones de plantilla de inicio", "fr": "Activez le chiffrement pour tous les disques de données dans les versions de modèle de démarrage", "ja": "起動テンプレートバージョンですべてのデータディスクの暗号化を有効にします", "pt": "Habilite a criptografia para todos os discos de dados nas versões do modelo de inicialização", "zh": "在启动模板版本中为所有数据磁盘启用加密"}, ResourceTypes: []string{"ALIYUN::ECS::LaunchTemplate"}, FilePath: "aliyun/rules/ecs-launch-template-version-data-disk-encrypted.rego", PackageName: "infraguard.rules.aliyun.ecs_launch_template_version_data_disk_encrypted", Content: "package infraguard.rules.aliyun.ecs_launch_template_version_data_disk_encrypted\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-launch-template-version-data-disk-encrypted\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS launch template version enables data disk encryption\",\n\t\t\"zh\": \"ECS 启动模版版本中设置数据磁盘加密\",\n\t\t\"ja\": \"ECS 起動テンプレートバージョンでデータディスク暗号化が有効\",\n\t\t\"de\": \"ECS-Startvorlagenversion aktiviert Datenfestplattenverschlüsselung\",\n\t\t\"es\": \"La Versión de Plantilla de Inicio ECS Habilita el Cifrado de Disco de Datos\",\n\t\t\"fr\": \"La Version du Modèle de Démarrage ECS Active le Chiffrement de Disque de Données\",\n\t\t\"pt\": \"A Versão do Modelo de Inicialização ECS Habilita a Criptografia de Disco de Dados\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"All data disks configured in ECS launch template versions are encrypted, considered compliant.\",\n\t\t\"zh\": \"ECS 启动模版版本中数据磁盘配置均设置为加密，视为合规。\",\n\t\t\"ja\": \"ECS 起動テンプレートバージョンで設定されたすべてのデータディスクが暗号化されており、準拠と見なされます。\",\n\t\t\"de\": \"Alle in ECS-Startvorlagenversionen konfigurierten Datenfestplatten sind verschlüsselt und gelten als konform.\",\n\t\t\"es\": \"Todos los discos de datos configurados en las versiones de plantilla de inicio ECS están cifrados, considerado conforme.\",\n\t\t\"fr\": \"Tous les disques de données configurés dans les versions de modèle de démarrage ECS sont chiffrés, considéré comme conforme.\",\n\t\t\"pt\": \"Todos os discos de dados configurados nas versões do modelo de inicialização ECS estão criptografados, considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS launch template version has data disks without encryption enabled\",\n\t\t\"zh\": \"ECS 启动模板版本的数据磁盘未启用加密\",\n\t\t\"ja\": \"ECS 起動テンプレートバージョンに暗号化が有効になっていないデータディスクがある\",\n\t\t\"de\": \"ECS-Startvorlagenversion hat Datenfestplatten ohne aktivierte Verschlüsselung\",\n\t\t\"es\": \"La versión de plantilla de inicio ECS tiene discos de datos sin cifrado habilitado\",\n\t\t\"fr\": \"La version du modèle de démarrage ECS a des disques de données sans chiffrement activé\",\n\t\t\"pt\": \"A versão do modelo de inicialização ECS tem discos de dados sem criptografia habilitada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable encryption for all data disks in launch template versions\",\n\t\t\"zh\": \"在启动模板版本中为所有数据磁盘启用加密\",\n\t\t\"ja\": \"起動テンプレートバージョンですべてのデータディスクの暗号化を有効にします\",\n\t\t\"de\": \"Aktivieren Sie die Verschlüsselung für alle Datenfestplatten in Startvorlagenversionen\",\n\t\t\"es\": \"Habilite el cifrado para todos los discos de datos en las versiones de plantilla de inicio\",\n\t\t\"fr\": \"Activez le chiffrement pour tous les disques de données dans les versions de modèle de démarrage\",\n\t\t\"pt\": \"Habilite a criptografia para todos os discos de dados nas versões do modelo de inicialização\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::LaunchTemplate\"]\n}\n\ndeny contains result if {\n\tsome name, resource in input.Resources\n\tresource.Type == \"ALIYUN::ECS::LaunchTemplate\"\n\tresource.Properties.DiskMappings != null\n\n\tsome disk in resource.Properties.DiskMappings\n\tdisk.Encrypted != true\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DiskMappings\", \"Encrypted\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-launch-template-version-image-type-check", Name: models.I18nString{"de": "Startvorlage Bildtypprüfung", "en": "Launch Template Image Type Check", "es": "Verificación de Tipo de Imagen de Plantilla de Inicio", "fr": "Vérification du Type d'Image du Modèle de Démarrage", "ja": "起動テンプレートイメージタイプチェック", "pt": "Verificação de Tipo de Imagem do Modelo de Inicialização", "zh": "启动模板镜像来源核查"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Startvorlagen autorisierte Bildtypen verwenden.", "en": "Ensures ECS launch templates use authorized image types.", "es": "Garantiza que las plantillas de inicio ECS usen tipos de imagen autorizados.", "fr": "Garantit que les modèles de démarrage ECS utilisent des types d'image autorisés.", "ja": "ECS 起動テンプレートが承認されたイメージタイプを使用していることを確認します。", "pt": "Garante que os modelos de inicialização ECS usem tipos de imagem autorizados.", "zh": "确保 ECS 启动模板使用授权的镜像类型。"}, Reason: models.I18nString{"de": "Die Einschränkung von Bildquellen in Vorlagen gewährleistet konsistente Sicherheitsbaselines.", "en": "Restricting image sources in templates ensures consistent security baselines.", "es": "Restringir las fuentes de imagen en las plantillas garantiza líneas base de seguridad consistentes.", "fr": "Restreindre les sources d'image dans les modèles garantit des lignes de base de sécurité cohérentes.", "ja": "テンプレートでイメージソースを制限することで、一貫したセキュリティベースラインが確保されます。", "pt": "Restringir fontes de imagem em modelos garante linhas de base de segurança consistentes.", "zh": "在模板中限制镜像来源可确保一致的安全基线。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie die Startvorlage, um autorisierte Bilder zu verwenden.", "en": "Update the launch template to use authorized images.", "es": "Actualice la plantilla de inicio para usar imágenes autorizadas.", "fr": "Mettez à jour le modèle de démarrage pour utiliser des images autorisées.", "ja": "承認されたイメージを使用するように起動テンプレートを更新します。", "pt": "Atualize o modelo de inicialização para usar imagens autorizadas.", "zh": "更新启动模板以使用授权镜像。"}, ResourceTypes: []string{"ALIYUN::ECS::LaunchTemplate"}, FilePath: "aliyun/rules/ecs-launch-template-version-image-type-check.rego", PackageName: "infraguard.rules.aliyun.ecs_launch_template_version_image_type_check", Content: "package infraguard.rules.aliyun.ecs_launch_template_version_image_type_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ecs-launch-template-version-image-type-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Launch Template Image Type Check\",\n\t\t\"zh\": \"启动模板镜像来源核查\",\n\t\t\"ja\": \"起動テンプレートイメージタイプチェック\",\n\t\t\"de\": \"Startvorlage Bildtypprüfung\",\n\t\t\"es\": \"Verificación de Tipo de Imagen de Plantilla de Inicio\",\n\t\t\"fr\": \"Vérification du Type d'Image du Modèle de Démarrage\",\n\t\t\"pt\": \"Verificação de Tipo de Imagem do Modelo de Inicialização\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ECS launch templates use authorized image types.\",\n\t\t\"zh\": \"确保 ECS 启动模板使用授权的镜像类型。\",\n\t\t\"ja\": \"ECS 起動テンプレートが承認されたイメージタイプを使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Startvorlagen autorisierte Bildtypen verwenden.\",\n\t\t\"es\": \"Garantiza que las plantillas de inicio ECS usen tipos de imagen autorizados.\",\n\t\t\"fr\": \"Garantit que les modèles de démarrage ECS utilisent des types d'image autorisés.\",\n\t\t\"pt\": \"Garante que os modelos de inicialização ECS usem tipos de imagem autorizados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Restricting image sources in templates ensures consistent security baselines.\",\n\t\t\"zh\": \"在模板中限制镜像来源可确保一致的安全基线。\",\n\t\t\"ja\": \"テンプレートでイメージソースを制限することで、一貫したセキュリティベースラインが確保されます。\",\n\t\t\"de\": \"Die Einschränkung von Bildquellen in Vorlagen gewährleistet konsistente Sicherheitsbaselines.\",\n\t\t\"es\": \"Restringir las fuentes de imagen en las plantillas garantiza líneas base de seguridad consistentes.\",\n\t\t\"fr\": \"Restreindre les sources d'image dans les modèles garantit des lignes de base de sécurité cohérentes.\",\n\t\t\"pt\": \"Restringir fontes de imagem em modelos garante linhas de base de segurança consistentes.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Update the launch template to use authorized images.\",\n\t\t\"zh\": \"更新启动模板以使用授权镜像。\",\n\t\t\"ja\": \"承認されたイメージを使用するように起動テンプレートを更新します。\",\n\t\t\"de\": \"Aktualisieren Sie die Startvorlage, um autorisierte Bilder zu verwenden.\",\n\t\t\"es\": \"Actualice la plantilla de inicio para usar imágenes autorizadas.\",\n\t\t\"fr\": \"Mettez à jour le modèle de démarrage pour utiliser des images autorisées.\",\n\t\t\"pt\": \"Atualize o modelo de inicialização para usar imagens autorizadas.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::LaunchTemplate\"]\n}\n\nis_compliant(resource) if {\n\t# Check ImageId directly in Properties\n\thelpers.get_property(resource, \"ImageId\", null) != null\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::LaunchTemplate\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ImageId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-running-instance-no-public-ip", Name: models.I18nString{"de": "ECS-Instanz Keine öffentliche IP", "en": "ECS Instance No Public IP", "es": "Instancia ECS Sin IP Pública", "fr": "Instance ECS Sans IP Publique", "ja": "ECS インスタンスにパブリック IP がない", "pt": "Instância ECS Sem IP Público", "zh": "ECS 实例不分配公网 IP"}, Severity: "high", Description: models.I18nString{"de": "ECS-Instanzen sollten keine öffentliche IP-Adresse haben, um die direkte Internetexposition zu reduzieren.", "en": "ECS instances should not have a public IP address to reduce direct internet exposure.", "es": "Las instancias ECS no deben tener una dirección IP pública para reducir la exposición directa a Internet.", "fr": "Les instances ECS ne doivent pas avoir d'adresse IP publique pour réduire l'exposition directe à Internet.", "ja": "ECS インスタンスは、直接的なインターネットへの露出を減らすためにパブリック IP アドレスを持つべきではありません。", "pt": "As instâncias ECS não devem ter um endereço IP público para reduzir a exposição direta à Internet.", "zh": "ECS 实例不应分配公网 IP，以减少直接暴露在互联网上的风险。"}, Reason: models.I18nString{"de": "Öffentliche IP-Adressen ermöglichen direkten Zugriff aus dem Internet und erhöhen die Angriffsfläche.", "en": "Public IP addresses allow direct access from the internet, increasing the attack surface.", "es": "Las direcciones IP públicas permiten acceso directo desde Internet, aumentando la superficie de ataque.", "fr": "Les adresses IP publiques permettent un accès direct depuis Internet, augmentant la surface d'attaque.", "ja": "パブリック IP アドレスはインターネットからの直接アクセスを許可し、攻撃面を増加させます。", "pt": "Endereços IP públicos permitem acesso direto da Internet, aumentando a superfície de ataque.", "zh": "分配公网 IP 会使实例直接暴露在互联网上，增加了攻击面。"}, Recommendation: models.I18nString{"de": "Entfernen Sie die öffentliche IP-Zuweisung, indem Sie AllocatePublicIP auf false setzen oder ein NAT-Gateway für den Ausgang verwenden.", "en": "Remove public IP assignment by setting AllocatePublicIP to false or using a NAT gateway for egress.", "es": "Elimine la asignación de IP pública estableciendo AllocatePublicIP en false o usando una puerta de enlace NAT para la salida.", "fr": "Supprimez l'attribution d'IP publique en définissant AllocatePublicIP sur false ou en utilisant une passerelle NAT pour la sortie.", "ja": "AllocatePublicIP を false に設定するか、エグレスに NAT ゲートウェイを使用してパブリック IP の割り当てを削除します。", "pt": "Remova a atribuição de IP público definindo AllocatePublicIP como false ou usando um gateway NAT para saída.", "zh": "通过将 AllocatePublicIP 设置为 false 或使用 NAT 网关来取消分配公网 IP。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-running-instance-no-public-ip.rego", PackageName: "infraguard.rules.aliyun.ecs_running_instance_no_public_ip", Content: "package infraguard.rules.aliyun.ecs_running_instance_no_public_ip\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-running-instance-no-public-ip\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ECS Instance No Public IP\",\n\t\t\"zh\": \"ECS 实例不分配公网 IP\",\n\t\t\"ja\": \"ECS インスタンスにパブリック IP がない\",\n\t\t\"de\": \"ECS-Instanz Keine öffentliche IP\",\n\t\t\"es\": \"Instancia ECS Sin IP Pública\",\n\t\t\"fr\": \"Instance ECS Sans IP Publique\",\n\t\t\"pt\": \"Instância ECS Sem IP Público\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS instances should not have a public IP address to reduce direct internet exposure.\",\n\t\t\"zh\": \"ECS 实例不应分配公网 IP，以减少直接暴露在互联网上的风险。\",\n\t\t\"ja\": \"ECS インスタンスは、直接的なインターネットへの露出を減らすためにパブリック IP アドレスを持つべきではありません。\",\n\t\t\"de\": \"ECS-Instanzen sollten keine öffentliche IP-Adresse haben, um die direkte Internetexposition zu reduzieren.\",\n\t\t\"es\": \"Las instancias ECS no deben tener una dirección IP pública para reducir la exposición directa a Internet.\",\n\t\t\"fr\": \"Les instances ECS ne doivent pas avoir d'adresse IP publique pour réduire l'exposition directe à Internet.\",\n\t\t\"pt\": \"As instâncias ECS não devem ter um endereço IP público para reduzir a exposição direta à Internet.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Public IP addresses allow direct access from the internet, increasing the attack surface.\",\n\t\t\"zh\": \"分配公网 IP 会使实例直接暴露在互联网上，增加了攻击面。\",\n\t\t\"ja\": \"パブリック IP アドレスはインターネットからの直接アクセスを許可し、攻撃面を増加させます。\",\n\t\t\"de\": \"Öffentliche IP-Adressen ermöglichen direkten Zugriff aus dem Internet und erhöhen die Angriffsfläche.\",\n\t\t\"es\": \"Las direcciones IP públicas permiten acceso directo desde Internet, aumentando la superficie de ataque.\",\n\t\t\"fr\": \"Les adresses IP publiques permettent un accès direct depuis Internet, augmentant la surface d'attaque.\",\n\t\t\"pt\": \"Endereços IP públicos permitem acesso direto da Internet, aumentando a superfície de ataque.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove public IP assignment by setting AllocatePublicIP to false or using a NAT gateway for egress.\",\n\t\t\"zh\": \"通过将 AllocatePublicIP 设置为 false 或使用 NAT 网关来取消分配公网 IP。\",\n\t\t\"ja\": \"AllocatePublicIP を false に設定するか、エグレスに NAT ゲートウェイを使用してパブリック IP の割り当てを削除します。\",\n\t\t\"de\": \"Entfernen Sie die öffentliche IP-Zuweisung, indem Sie AllocatePublicIP auf false setzen oder ein NAT-Gateway für den Ausgang verwenden.\",\n\t\t\"es\": \"Elimine la asignación de IP pública estableciendo AllocatePublicIP en false o usando una puerta de enlace NAT para la salida.\",\n\t\t\"fr\": \"Supprimez l'attribution d'IP publique en définissant AllocatePublicIP sur false ou en utilisant une passerelle NAT pour la sortie.\",\n\t\t\"pt\": \"Remova a atribuição de IP público definindo AllocatePublicIP como false ou usando um gateway NAT para saída.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\n# Check if the instance has a public IP allocated\nhas_public_ip(resource) if {\n\thelpers.get_property(resource, \"AllocatePublicIP\", false) == true\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\thas_public_ip(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AllocatePublicIP\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-running-instances-in-vpc", Name: models.I18nString{"de": "Laufende ECS-Instanzen sind in VPC", "en": "Running ECS instances are in VPC", "es": "Las Instancias ECS en Ejecución Están en VPC", "fr": "Les Instances ECS en Cours d'Exécution Sont dans le VPC", "ja": "実行中の ECS インスタンスが VPC 内にある", "pt": "Instâncias ECS em execução estão em VPC", "zh": "运行中的 ECS 实例在专有网络"}, Severity: "medium", Description: models.I18nString{"de": "Laufende ECS-Instanzen sind in Virtual Private Cloud (VPC) bereitgestellt, werden als konform betrachtet. Dies bietet Netzwerkisolation und verbesserte Sicherheit.", "en": "Running ECS instances are deployed in Virtual Private Cloud (VPC), considered compliant. This provides network isolation and enhanced security.", "es": "Las instancias ECS en ejecución se implementan en Virtual Private Cloud (VPC), consideradas conformes. Esto proporciona aislamiento de red y seguridad mejorada.", "fr": "Les instances ECS en cours d'exécution sont déployées dans Virtual Private Cloud (VPC), considérées comme conformes. Cela offre un isolement réseau et une sécurité renforcée.", "ja": "実行中の ECS インスタンスが Virtual Private Cloud (VPC) に展開されている場合、準拠と見なされます。これにより、ネットワーク分離とセキュリティの強化が提供されます。", "pt": "Instâncias ECS em execução são implantadas em Virtual Private Cloud (VPC), consideradas conformes. Isso fornece isolamento de rede e segurança aprimorada.", "zh": "阿里云推荐购买的 ECS 放在 VPC 里面。如果 ECS 有归属 VPC 则视为合规。"}, Reason: models.I18nString{"de": "ECS-Instanz ist nicht in VPC bereitgestellt (klassisches Netzwerk)", "en": "ECS instance is not deployed in VPC (Classic network)", "es": "La instancia ECS no está implementada en VPC (red clásica)", "fr": "L'instance ECS n'est pas déployée dans le VPC (réseau classique)", "ja": "ECS インスタンスが VPC に展開されていない（クラシックネットワーク）", "pt": "A instância ECS não está implantada em VPC (rede clássica)", "zh": "ECS 实例未部署在专有网络（经典网络）"}, Recommendation: models.I18nString{"de": "Stellen Sie ECS-Instanzen in VPC bereit, um Netzwerkisolation und verbesserte Sicherheit zu erreichen", "en": "Deploy ECS instances in VPC for network isolation and enhanced security", "es": "Implemente instancias ECS en VPC para aislamiento de red y seguridad mejorada", "fr": "Déployez les instances ECS dans le VPC pour l'isolement réseau et une sécurité renforcée", "ja": "ネットワーク分離とセキュリティの強化のために、ECS インスタンスを VPC に展開します", "pt": "Implante instâncias ECS em VPC para isolamento de rede e segurança aprimorada", "zh": "将 ECS 实例部署在专有网络中以实现网络隔离和增强安全性"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-running-instances-in-vpc.rego", PackageName: "infraguard.rules.aliyun.ecs_running_instances_in_vpc", Content: "package infraguard.rules.aliyun.ecs_running_instances_in_vpc\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-running-instances-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Running ECS instances are in VPC\",\n\t\t\"zh\": \"运行中的 ECS 实例在专有网络\",\n\t\t\"ja\": \"実行中の ECS インスタンスが VPC 内にある\",\n\t\t\"de\": \"Laufende ECS-Instanzen sind in VPC\",\n\t\t\"es\": \"Las Instancias ECS en Ejecución Están en VPC\",\n\t\t\"fr\": \"Les Instances ECS en Cours d'Exécution Sont dans le VPC\",\n\t\t\"pt\": \"Instâncias ECS em execução estão em VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Running ECS instances are deployed in Virtual Private Cloud (VPC), considered compliant. This provides network isolation and enhanced security.\",\n\t\t\"zh\": \"阿里云推荐购买的 ECS 放在 VPC 里面。如果 ECS 有归属 VPC 则视为合规。\",\n\t\t\"ja\": \"実行中の ECS インスタンスが Virtual Private Cloud (VPC) に展開されている場合、準拠と見なされます。これにより、ネットワーク分離とセキュリティの強化が提供されます。\",\n\t\t\"de\": \"Laufende ECS-Instanzen sind in Virtual Private Cloud (VPC) bereitgestellt, werden als konform betrachtet. Dies bietet Netzwerkisolation und verbesserte Sicherheit.\",\n\t\t\"es\": \"Las instancias ECS en ejecución se implementan en Virtual Private Cloud (VPC), consideradas conformes. Esto proporciona aislamiento de red y seguridad mejorada.\",\n\t\t\"fr\": \"Les instances ECS en cours d'exécution sont déployées dans Virtual Private Cloud (VPC), considérées comme conformes. Cela offre un isolement réseau et une sécurité renforcée.\",\n\t\t\"pt\": \"Instâncias ECS em execução são implantadas em Virtual Private Cloud (VPC), consideradas conformes. Isso fornece isolamento de rede e segurança aprimorada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ECS instance is not deployed in VPC (Classic network)\",\n\t\t\"zh\": \"ECS 实例未部署在专有网络（经典网络）\",\n\t\t\"ja\": \"ECS インスタンスが VPC に展開されていない（クラシックネットワーク）\",\n\t\t\"de\": \"ECS-Instanz ist nicht in VPC bereitgestellt (klassisches Netzwerk)\",\n\t\t\"es\": \"La instancia ECS no está implementada en VPC (red clásica)\",\n\t\t\"fr\": \"L'instance ECS n'est pas déployée dans le VPC (réseau classique)\",\n\t\t\"pt\": \"A instância ECS não está implantada em VPC (rede clássica)\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy ECS instances in VPC for network isolation and enhanced security\",\n\t\t\"zh\": \"将 ECS 实例部署在专有网络中以实现网络隔离和增强安全性\",\n\t\t\"ja\": \"ネットワーク分離とセキュリティの強化のために、ECS インスタンスを VPC に展開します\",\n\t\t\"de\": \"Stellen Sie ECS-Instanzen in VPC bereit, um Netzwerkisolation und verbesserte Sicherheit zu erreichen\",\n\t\t\"es\": \"Implemente instancias ECS en VPC para aislamiento de red y seguridad mejorada\",\n\t\t\"fr\": \"Déployez les instances ECS dans le VPC pour l'isolement réseau et une sécurité renforcée\",\n\t\t\"pt\": \"Implante instâncias ECS em VPC para isolamento de rede e segurança aprimorada\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"])\n\n\t# Check if instance is in classic network (no VPC specified)\n\tvpc_id := helpers.get_property(resource, \"VpcId\", \"\")\n\tvswitch_id := helpers.get_property(resource, \"VSwitchId\", \"\")\n\n\t# If neither VpcId nor VSwitchId is specified, it's classic network\n\tvpc_id == \"\"\n\tvswitch_id == \"\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-security-group-description-check", Name: models.I18nString{"de": "Sicherheitsgruppe Beschreibung nicht leer", "en": "Security Group Description Not Empty", "es": "Descripción de Grupo de Seguridad No Vacía", "fr": "Description du Groupe de Sécurité Non Vide", "ja": "セキュリティグループの説明が空でない", "pt": "Descrição de Grupo de Segurança Não Vazia", "zh": "安全组描述信息不能为空"}, Severity: "low", Description: models.I18nString{"de": "Die Beschreibung der Sicherheitsgruppe sollte nicht leer sein. Eine Beschreibung hilft bei der Verwaltung und Prüfung.", "en": "Security group description should not be empty. Having a description helps with management and auditing.", "es": "La descripción del grupo de seguridad no debe estar vacía. Tener una descripción ayuda con la gestión y la auditoría.", "fr": "La description du groupe de sécurité ne doit pas être vide. Avoir une description aide à la gestion et à l'audit.", "ja": "セキュリティグループの説明は空であってはなりません。説明があると、管理と監査に役立ちます。", "pt": "A descrição do grupo de segurança não deve estar vazia. Ter uma descrição ajuda com gerenciamento e auditoria.", "zh": "安全组描述信息不为空，视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe hat keine Beschreibung, was es schwierig macht, ihren Zweck zu verstehen und sie effektiv zu verwalten.", "en": "The security group does not have a description, which makes it difficult to understand its purpose and manage it effectively.", "es": "El grupo de seguridad no tiene descripción, lo que dificulta entender su propósito y gestionarlo eficazmente.", "fr": "Le groupe de sécurité n'a pas de description, ce qui rend difficile de comprendre son objectif et de le gérer efficacement.", "ja": "セキュリティグループに説明がないため、その目的を理解し、効果的に管理することが困難です。", "pt": "O grupo de segurança não tem descrição, o que dificulta entender seu propósito e gerenciá-lo efetivamente.", "zh": "安全组没有描述信息，难以理解其用途并进行有效管理。"}, Recommendation: models.I18nString{"de": "Fügen Sie der Sicherheitsgruppe eine aussagekräftige Beschreibung hinzu, indem Sie die Eigenschaft Description verwenden, um ihren Zweck und ihre Verwendung zu erklären.", "en": "Add a meaningful description to the security group using the Description property to explain its purpose and usage.", "es": "Agregue una descripción significativa al grupo de seguridad usando la propiedad Description para explicar su propósito y uso.", "fr": "Ajoutez une description significative au groupe de sécurité en utilisant la propriété Description pour expliquer son objectif et son utilisation.", "ja": "Description プロパティを使用して、セキュリティグループに目的と使用方法を説明する意味のある説明を追加します。", "pt": "Adicione uma descrição significativa ao grupo de segurança usando a propriedade Description para explicar seu propósito e uso.", "zh": "使用 Description 属性为安全组添加有意义的描述，说明其用途和使用场景。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup"}, FilePath: "aliyun/rules/ecs-security-group-description-check.rego", PackageName: "infraguard.rules.aliyun.ecs_security_group_description_check", Content: "package infraguard.rules.aliyun.ecs_security_group_description_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"ecs-security-group-description-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Description Not Empty\",\n\t\t\"zh\": \"安全组描述信息不能为空\",\n\t\t\"ja\": \"セキュリティグループの説明が空でない\",\n\t\t\"de\": \"Sicherheitsgruppe Beschreibung nicht leer\",\n\t\t\"es\": \"Descripción de Grupo de Seguridad No Vacía\",\n\t\t\"fr\": \"Description du Groupe de Sécurité Non Vide\",\n\t\t\"pt\": \"Descrição de Grupo de Segurança Não Vazia\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Security group description should not be empty. Having a description helps with management and auditing.\",\n\t\t\"zh\": \"安全组描述信息不为空，视为合规。\",\n\t\t\"ja\": \"セキュリティグループの説明は空であってはなりません。説明があると、管理と監査に役立ちます。\",\n\t\t\"de\": \"Die Beschreibung der Sicherheitsgruppe sollte nicht leer sein. Eine Beschreibung hilft bei der Verwaltung und Prüfung.\",\n\t\t\"es\": \"La descripción del grupo de seguridad no debe estar vacía. Tener una descripción ayuda con la gestión y la auditoría.\",\n\t\t\"fr\": \"La description du groupe de sécurité ne doit pas être vide. Avoir une description aide à la gestion et à l'audit.\",\n\t\t\"pt\": \"A descrição do grupo de segurança não deve estar vazia. Ter uma descrição ajuda com gerenciamento e auditoria.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group does not have a description, which makes it difficult to understand its purpose and manage it effectively.\",\n\t\t\"zh\": \"安全组没有描述信息，难以理解其用途并进行有效管理。\",\n\t\t\"ja\": \"セキュリティグループに説明がないため、その目的を理解し、効果的に管理することが困難です。\",\n\t\t\"de\": \"Die Sicherheitsgruppe hat keine Beschreibung, was es schwierig macht, ihren Zweck zu verstehen und sie effektiv zu verwalten.\",\n\t\t\"es\": \"El grupo de seguridad no tiene descripción, lo que dificulta entender su propósito y gestionarlo eficazmente.\",\n\t\t\"fr\": \"Le groupe de sécurité n'a pas de description, ce qui rend difficile de comprendre son objectif et de le gérer efficacement.\",\n\t\t\"pt\": \"O grupo de segurança não tem descrição, o que dificulta entender seu propósito e gerenciá-lo efetivamente.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add a meaningful description to the security group using the Description property to explain its purpose and usage.\",\n\t\t\"zh\": \"使用 Description 属性为安全组添加有意义的描述，说明其用途和使用场景。\",\n\t\t\"ja\": \"Description プロパティを使用して、セキュリティグループに目的と使用方法を説明する意味のある説明を追加します。\",\n\t\t\"de\": \"Fügen Sie der Sicherheitsgruppe eine aussagekräftige Beschreibung hinzu, indem Sie die Eigenschaft Description verwenden, um ihren Zweck und ihre Verwendung zu erklären.\",\n\t\t\"es\": \"Agregue una descripción significativa al grupo de seguridad usando la propiedad Description para explicar su propósito y uso.\",\n\t\t\"fr\": \"Ajoutez une description significative au groupe de sécurité en utilisant la propriété Description pour expliquer son objectif et son utilisation.\",\n\t\t\"pt\": \"Adicione uma descrição significativa ao grupo de segurança usando a propriedade Description para explicar seu propósito e uso.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\"]\n}\n\n# Check if security group has a non-empty description\nhas_description(resource) if {\n\thelpers.has_property(resource, \"Description\")\n\tresource.Properties.Description != \"\"\n}\n\n# Generate deny for non-compliant resources\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tnot has_description(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Description\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-security-group-egress-not-all-access", Name: models.I18nString{"de": "Sicherheitsgruppe Egress nicht auf Vollzugriff gesetzt", "en": "Security Group Egress Not Set to All Access", "es": "Egreso de Grupo de Seguridad No Establecido en Acceso Total", "fr": "Egress du Groupe de Sécurité Non Défini sur Accès Total", "ja": "セキュリティグループイーグレスが全アクセスに設定されていない", "pt": "Egresso de Grupo de Segurança Não Definido como Acesso Total", "zh": "安全组出方向未设置为全通"}, Severity: "high", Description: models.I18nString{"de": "Die Egress-Richtung der Sicherheitsgruppe sollte nicht so eingestellt werden, dass sie allen Zugriff erlaubt (alle Protokolle, alle Ports, alle Ziele).", "en": "Security group egress direction should not be set to allow all access (all protocols, all ports, all destinations).", "es": "La dirección de egreso del grupo de seguridad no debe establecerse para permitir todo el acceso (todos los protocolos, todos los puertos, todos los destinos).", "fr": "La direction d'egress du groupe de sécurité ne doit pas être définie pour autoriser tout accès (tous les protocoles, tous les ports, toutes les destinations).", "ja": "セキュリティグループのイーグレス方向は、すべてのアクセス（すべてのプロトコル、すべてのポート、すべての宛先）を許可するように設定すべきではありません。", "pt": "A direção de egresso do grupo de segurança não deve ser definida para permitir todo o acesso (todos os protocolos, todas as portas, todos os destinos).", "zh": "安全组出网方向未设置为全通，视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe hat eine Egress-Regel, die allen Zugriff erlaubt (alle Protokolle zu allen Zielen), was ein Sicherheitsrisiko darstellt.", "en": "The security group has an egress rule that allows all access (all protocols to all destinations), which poses a security risk.", "es": "El grupo de seguridad tiene una regla de egreso que permite todo el acceso (todos los protocolos a todos los destinos), lo que plantea un riesgo de seguridad.", "fr": "Le groupe de sécurité a une règle d'egress qui autorise tout accès (tous les protocoles vers toutes les destinations), ce qui pose un risque de sécurité.", "ja": "セキュリティグループにすべてのアクセス（すべてのプロトコルからすべての宛先）を許可するイーグレスルールがあり、セキュリティリスクをもたらします。", "pt": "O grupo de segurança tem uma regra de egresso que permite todo o acesso (todos os protocolos para todos os destinos), o que representa um risco de segurança.", "zh": "安全组有一条出网规则允许全通访问（所有协议到所有目标），存在安全风险。"}, Recommendation: models.I18nString{"de": "Beschränken Sie Egress-Regeln auf spezifische Protokolle, Ports und Ziel-IP-Bereiche basierend auf tatsächlichen Geschäftsanforderungen.", "en": "Restrict egress rules to specific protocols, ports, and destination IP ranges based on actual business requirements.", "es": "Restrinja las reglas de egreso a protocolos, puertos y rangos de IP de destino específicos según los requisitos comerciales reales.", "fr": "Restreignez les règles d'egress à des protocoles, ports et plages d'IP de destination spécifiques en fonction des exigences commerciales réelles.", "ja": "実際のビジネス要件に基づいて、イーグレスルールを特定のプロトコル、ポート、宛先 IP 範囲に制限します。", "pt": "Restrinja as regras de egresso a protocolos, portas e intervalos de IP de destino específicos com base nos requisitos comerciais reais.", "zh": "根据实际业务需求，将出网规则限制为特定的协议、端口和目标 IP 范围。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup", "ALIYUN::ECS::SecurityGroupEgress", "ALIYUN::ECS::SecurityGroupEgresses"}, FilePath: "aliyun/rules/ecs-security-group-egress-not-all-access.rego", PackageName: "infraguard.rules.aliyun.ecs_security_group_egress_not_all_access", Content: "package infraguard.rules.aliyun.ecs_security_group_egress_not_all_access\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"ecs-security-group-egress-not-all-access\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Egress Not Set to All Access\",\n\t\t\"zh\": \"安全组出方向未设置为全通\",\n\t\t\"ja\": \"セキュリティグループイーグレスが全アクセスに設定されていない\",\n\t\t\"de\": \"Sicherheitsgruppe Egress nicht auf Vollzugriff gesetzt\",\n\t\t\"es\": \"Egreso de Grupo de Seguridad No Establecido en Acceso Total\",\n\t\t\"fr\": \"Egress du Groupe de Sécurité Non Défini sur Accès Total\",\n\t\t\"pt\": \"Egresso de Grupo de Segurança Não Definido como Acesso Total\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Security group egress direction should not be set to allow all access (all protocols, all ports, all destinations).\",\n\t\t\"zh\": \"安全组出网方向未设置为全通，视为合规。\",\n\t\t\"ja\": \"セキュリティグループのイーグレス方向は、すべてのアクセス（すべてのプロトコル、すべてのポート、すべての宛先）を許可するように設定すべきではありません。\",\n\t\t\"de\": \"Die Egress-Richtung der Sicherheitsgruppe sollte nicht so eingestellt werden, dass sie allen Zugriff erlaubt (alle Protokolle, alle Ports, alle Ziele).\",\n\t\t\"es\": \"La dirección de egreso del grupo de seguridad no debe establecerse para permitir todo el acceso (todos los protocolos, todos los puertos, todos los destinos).\",\n\t\t\"fr\": \"La direction d'egress du groupe de sécurité ne doit pas être définie pour autoriser tout accès (tous les protocoles, tous les ports, toutes les destinations).\",\n\t\t\"pt\": \"A direção de egresso do grupo de segurança não deve ser definida para permitir todo o acesso (todos os protocolos, todas as portas, todos os destinos).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group has an egress rule that allows all access (all protocols to all destinations), which poses a security risk.\",\n\t\t\"zh\": \"安全组有一条出网规则允许全通访问（所有协议到所有目标），存在安全风险。\",\n\t\t\"ja\": \"セキュリティグループにすべてのアクセス（すべてのプロトコルからすべての宛先）を許可するイーグレスルールがあり、セキュリティリスクをもたらします。\",\n\t\t\"de\": \"Die Sicherheitsgruppe hat eine Egress-Regel, die allen Zugriff erlaubt (alle Protokolle zu allen Zielen), was ein Sicherheitsrisiko darstellt.\",\n\t\t\"es\": \"El grupo de seguridad tiene una regla de egreso que permite todo el acceso (todos los protocolos a todos los destinos), lo que plantea un riesgo de seguridad.\",\n\t\t\"fr\": \"Le groupe de sécurité a une règle d'egress qui autorise tout accès (tous les protocoles vers toutes les destinations), ce qui pose un risque de sécurité.\",\n\t\t\"pt\": \"O grupo de segurança tem uma regra de egresso que permite todo o acesso (todos os protocolos para todos os destinos), o que representa um risco de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict egress rules to specific protocols, ports, and destination IP ranges based on actual business requirements.\",\n\t\t\"zh\": \"根据实际业务需求，将出网规则限制为特定的协议、端口和目标 IP 范围。\",\n\t\t\"ja\": \"実際のビジネス要件に基づいて、イーグレスルールを特定のプロトコル、ポート、宛先 IP 範囲に制限します。\",\n\t\t\"de\": \"Beschränken Sie Egress-Regeln auf spezifische Protokolle, Ports und Ziel-IP-Bereiche basierend auf tatsächlichen Geschäftsanforderungen.\",\n\t\t\"es\": \"Restrinja las reglas de egreso a protocolos, puertos y rangos de IP de destino específicos según los requisitos comerciales reales.\",\n\t\t\"fr\": \"Restreignez les règles d'egress à des protocoles, ports et plages d'IP de destination spécifiques en fonction des exigences commerciales réelles.\",\n\t\t\"pt\": \"Restrinja as regras de egresso a protocolos, portas e intervalos de IP de destino específicos com base nos requisitos comerciais reais.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\", \"ALIYUN::ECS::SecurityGroupEgress\", \"ALIYUN::ECS::SecurityGroupEgresses\"]\n}\n\n# Check if an egress rule allows all access\nis_all_access_egress(rule) if {\n\trule.IpProtocol == \"all\"\n\trule.PortRange == \"-1/-1\"\n\trule.DestCidrIp == \"0.0.0.0/0\"\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n}\n\nis_all_access_egress(rule) if {\n\trule.IpProtocol == \"all\"\n\trule.PortRange == \"-1/-1\"\n\trule.Ipv6DestCidrIp == \"::/0\"\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n}\n\n# Check SecurityGroup resource for egress rules\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tsome i, rule in resource.Properties.SecurityGroupEgress\n\tis_all_access_egress(rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupEgress\", format_int(i, 10)],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupEgress resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupEgress\")\n\tprops := resource.Properties\n\tegress_rule := {\n\t\t\"IpProtocol\": props.IpProtocol,\n\t\t\"PortRange\": props.PortRange,\n\t\t\"DestCidrIp\": object.get(props, \"DestCidrIp\", \"\"),\n\t\t\"Ipv6DestCidrIp\": object.get(props, \"Ipv6DestCidrIp\", \"\"),\n\t\t\"Policy\": object.get(props, \"Policy\", \"accept\"),\n\t}\n\tis_all_access_egress(egress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupEgresses resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupEgresses\")\n\tsome i, perm in resource.Properties.Permissions\n\tegress_rule := {\n\t\t\"IpProtocol\": perm.IpProtocol,\n\t\t\"PortRange\": perm.PortRange,\n\t\t\"DestCidrIp\": object.get(perm, \"DestCidrIp\", \"\"),\n\t\t\"Ipv6DestCidrIp\": object.get(perm, \"Ipv6DestCidrIp\", \"\"),\n\t\t\"Policy\": object.get(perm, \"Policy\", \"accept\"),\n\t}\n\tis_all_access_egress(egress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Permissions\", format_int(i, 10)],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-security-group-not-internet-cidr-access", Name: models.I18nString{"de": "Sicherheitsgruppe Ingress-Quell-IP enthält keine öffentliche IP", "en": "Security Group Ingress Source IP Not Include Public IP", "es": "IP de Origen de Ingress de Grupo de Seguridad No Incluye IP Pública", "fr": "IP Source d'Ingress du Groupe de Sécurité N'Inclut Pas d'IP Publique", "ja": "セキュリティグループイングレスのソース IP にパブリック IP が含まれていない", "pt": "IP de Origem de Ingresso de Grupo de Segurança Não Inclui IP Público", "zh": "安全组入网设置允许的来源 IP 不包含公网 IP"}, Severity: "high", Description: models.I18nString{"de": "Sicherheitsgruppen-Ingress-Regeln mit Accept-Richtlinie sollten keine Quell-IP enthalten, die öffentliche Internet-IPs enthält.", "en": "Security group ingress rules with accept policy should not have source IP containing public internet IPs.", "es": "Las reglas de ingreso del grupo de seguridad con política de aceptación no deben tener IP de origen que contenga IPs públicas de internet.", "fr": "Les règles d'ingress du groupe de sécurité avec politique d'acceptation ne doivent pas avoir d'IP source contenant des IPs Internet publiques.", "ja": "許可ポリシーを持つセキュリティグループのイングレスルールは、パブリックインターネット IP を含むソース IP を持つべきではありません。", "pt": "As regras de ingresso do grupo de segurança com política de aceitação não devem ter IP de origem contendo IPs públicos da internet.", "zh": "安全组入网方向授权策略为允许的来源 IP 地址段不包含公网 IP，视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe hat eine Ingress-Regel, die Zugriff von öffentlichen Internet-IP-Adressen erlaubt, was die Ressourcen externen Angriffen aussetzen kann.", "en": "The security group has an ingress rule that allows access from public internet IP addresses, which may expose the resources to external attacks.", "es": "El grupo de seguridad tiene una regla de ingreso que permite el acceso desde direcciones IP públicas de internet, lo que puede exponer los recursos a ataques externos.", "fr": "Le groupe de sécurité a une règle d'ingress qui autorise l'accès depuis des adresses IP Internet publiques, ce qui peut exposer les ressources à des attaques externes.", "ja": "セキュリティグループにパブリックインターネット IP アドレスからのアクセスを許可するイングレスルールがあり、リソースが外部攻撃にさらされる可能性があります。", "pt": "O grupo de segurança tem uma regra de ingresso que permite acesso de endereços IP públicos da internet, o que pode expor os recursos a ataques externos.", "zh": "安全组有一条入网规则允许从公网 IP 地址访问，可能将资源暴露给外部攻击。"}, Recommendation: models.I18nString{"de": "Beschränken Sie die Ingress-Quell-IP auf private Netzwerkbereiche (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16), es sei denn, öffentlicher Internetzugriff ist ausdrücklich erforderlich.", "en": "Restrict ingress source IP to private network ranges (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) unless public internet access is explicitly required.", "es": "Restrinja la IP de origen de ingreso a rangos de red privada (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) a menos que se requiera explícitamente acceso público a internet.", "fr": "Restreignez l'IP source d'ingress aux plages de réseau privé (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) sauf si l'accès Internet public est explicitement requis.", "ja": "パブリックインターネットアクセスが明示的に必要な場合を除き、イングレスソース IP をプライベートネットワーク範囲（10.0.0.0/8、172.16.0.0/12、192.168.0.0/16）に制限します。", "pt": "Restrinja o IP de origem de ingresso a intervalos de rede privada (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16), a menos que o acesso público à internet seja explicitamente necessário.", "zh": "将入网来源 IP 限制为私有网络范围（10.0.0.0/8、172.16.0.0/12、192.168.0.0/16），除非确实需要公网访问。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup", "ALIYUN::ECS::SecurityGroupIngress", "ALIYUN::ECS::SecurityGroupIngresses"}, FilePath: "aliyun/rules/ecs-security-group-not-internet-cidr-access.rego", PackageName: "infraguard.rules.aliyun.ecs_security_group_not_internet_cidr_access", Content: "package infraguard.rules.aliyun.ecs_security_group_not_internet_cidr_access\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"ecs-security-group-not-internet-cidr-access\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Ingress Source IP Not Include Public IP\",\n\t\t\"zh\": \"安全组入网设置允许的来源 IP 不包含公网 IP\",\n\t\t\"ja\": \"セキュリティグループイングレスのソース IP にパブリック IP が含まれていない\",\n\t\t\"de\": \"Sicherheitsgruppe Ingress-Quell-IP enthält keine öffentliche IP\",\n\t\t\"es\": \"IP de Origen de Ingress de Grupo de Seguridad No Incluye IP Pública\",\n\t\t\"fr\": \"IP Source d'Ingress du Groupe de Sécurité N'Inclut Pas d'IP Publique\",\n\t\t\"pt\": \"IP de Origem de Ingresso de Grupo de Segurança Não Inclui IP Público\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Security group ingress rules with accept policy should not have source IP containing public internet IPs.\",\n\t\t\"zh\": \"安全组入网方向授权策略为允许的来源 IP 地址段不包含公网 IP，视为合规。\",\n\t\t\"ja\": \"許可ポリシーを持つセキュリティグループのイングレスルールは、パブリックインターネット IP を含むソース IP を持つべきではありません。\",\n\t\t\"de\": \"Sicherheitsgruppen-Ingress-Regeln mit Accept-Richtlinie sollten keine Quell-IP enthalten, die öffentliche Internet-IPs enthält.\",\n\t\t\"es\": \"Las reglas de ingreso del grupo de seguridad con política de aceptación no deben tener IP de origen que contenga IPs públicas de internet.\",\n\t\t\"fr\": \"Les règles d'ingress du groupe de sécurité avec politique d'acceptation ne doivent pas avoir d'IP source contenant des IPs Internet publiques.\",\n\t\t\"pt\": \"As regras de ingresso do grupo de segurança com política de aceitação não devem ter IP de origem contendo IPs públicos da internet.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group has an ingress rule that allows access from public internet IP addresses, which may expose the resources to external attacks.\",\n\t\t\"zh\": \"安全组有一条入网规则允许从公网 IP 地址访问，可能将资源暴露给外部攻击。\",\n\t\t\"ja\": \"セキュリティグループにパブリックインターネット IP アドレスからのアクセスを許可するイングレスルールがあり、リソースが外部攻撃にさらされる可能性があります。\",\n\t\t\"de\": \"Die Sicherheitsgruppe hat eine Ingress-Regel, die Zugriff von öffentlichen Internet-IP-Adressen erlaubt, was die Ressourcen externen Angriffen aussetzen kann.\",\n\t\t\"es\": \"El grupo de seguridad tiene una regla de ingreso que permite el acceso desde direcciones IP públicas de internet, lo que puede exponer los recursos a ataques externos.\",\n\t\t\"fr\": \"Le groupe de sécurité a une règle d'ingress qui autorise l'accès depuis des adresses IP Internet publiques, ce qui peut exposer les ressources à des attaques externes.\",\n\t\t\"pt\": \"O grupo de segurança tem uma regra de ingresso que permite acesso de endereços IP públicos da internet, o que pode expor os recursos a ataques externos.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict ingress source IP to private network ranges (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) unless public internet access is explicitly required.\",\n\t\t\"zh\": \"将入网来源 IP 限制为私有网络范围（10.0.0.0/8、172.16.0.0/12、192.168.0.0/16），除非确实需要公网访问。\",\n\t\t\"ja\": \"パブリックインターネットアクセスが明示的に必要な場合を除き、イングレスソース IP をプライベートネットワーク範囲（10.0.0.0/8、172.16.0.0/12、192.168.0.0/16）に制限します。\",\n\t\t\"de\": \"Beschränken Sie die Ingress-Quell-IP auf private Netzwerkbereiche (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16), es sei denn, öffentlicher Internetzugriff ist ausdrücklich erforderlich.\",\n\t\t\"es\": \"Restrinja la IP de origen de ingreso a rangos de red privada (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) a menos que se requiera explícitamente acceso público a internet.\",\n\t\t\"fr\": \"Restreignez l'IP source d'ingress aux plages de réseau privé (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) sauf si l'accès Internet public est explicitement requis.\",\n\t\t\"pt\": \"Restrinja o IP de origem de ingresso a intervalos de rede privada (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16), a menos que o acesso público à internet seja explicitamente necessário.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\", \"ALIYUN::ECS::SecurityGroupIngress\", \"ALIYUN::ECS::SecurityGroupIngresses\"]\n}\n\n# Check if a rule allows access from internet CIDR\nis_internet_source_rule(rule) if {\n\t# Source CIDR is a public internet IP\n\tcidr := rule.SourceCidrIp\n\tcidr != \"\"\n\thelpers.is_internet_cidr(cidr)\n\n\t# Policy is accept (default)\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n}\n\n# Check SecurityGroup resource for ingress rules\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tsome i, rule in resource.Properties.SecurityGroupIngress\n\tis_internet_source_rule(rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIngress\", format_int(i, 10), \"SourceCidrIp\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngress resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngress\")\n\tprops := resource.Properties\n\tingress_rule := {\n\t\t\"SourceCidrIp\": object.get(props, \"SourceCidrIp\", \"\"),\n\t\t\"Policy\": object.get(props, \"Policy\", \"accept\"),\n\t}\n\tis_internet_source_rule(ingress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SourceCidrIp\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngresses resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngresses\")\n\tsome i, perm in resource.Properties.Permissions\n\tingress_rule := {\n\t\t\"SourceCidrIp\": object.get(perm, \"SourceCidrIp\", \"\"),\n\t\t\"Policy\": object.get(perm, \"Policy\", \"accept\"),\n\t}\n\tis_internet_source_rule(ingress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Permissions\", format_int(i, 10), \"SourceCidrIp\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-security-group-not-open-all-port", Name: models.I18nString{"de": "Sicherheitsgruppe Ingress öffnet nicht alle Ports", "en": "Security Group Ingress Not Open All Ports", "es": "Ingress de Grupo de Seguridad No Abre Todos los Puertos", "fr": "Ingress du Groupe de Sécurité N'Ouvre Pas Tous les Ports", "ja": "セキュリティグループイングレスがすべてのポートを開放していない", "pt": "Ingress de Grupo de Segurança Não Abre Todas as Portas", "zh": "安全组入网设置中不能有对所有端口开放的访问规则"}, Severity: "high", Description: models.I18nString{"de": "Sicherheitsgruppen-Ingress-Regeln sollten nicht alle Ports erlauben. Wenn der Portbereich nicht auf -1/-1 gesetzt ist, wird dies als konform betrachtet.", "en": "Security group ingress rules should not allow all ports. When the port range is not set to -1/-1, it is considered compliant.", "es": "Las reglas de ingreso del grupo de seguridad no deben permitir todos los puertos. Cuando el rango de puertos no está establecido en -1/-1, se considera conforme.", "fr": "Les règles d'ingress du groupe de sécurité ne doivent pas autoriser tous les ports. Lorsque la plage de ports n'est pas définie sur -1/-1, elle est considérée comme conforme.", "ja": "セキュリティグループのイングレスルールはすべてのポートを許可すべきではありません。ポート範囲が -1/-1 に設定されていない場合、準拠と見なされます。", "pt": "As regras de ingresso do grupo de segurança não devem permitir todas as portas. Quando o intervalo de portas não está definido como -1/-1, é considerado conforme.", "zh": "安全组入方向授权策略为允许，当端口范围未设置为-1/-1 时，视为合规。如果端口范围设置为-1/-1，但被优先级更高的授权策略拒绝，视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe hat eine Ingress-Regel, die alle Ports (PortRange=-1/-1) erlaubt, was ein Sicherheitsrisiko darstellt, indem sie Zugriff auf jeden Port ermöglicht.", "en": "The security group has an ingress rule that allows all ports (PortRange=-1/-1), which poses a security risk by allowing access to any port.", "es": "El grupo de seguridad tiene una regla de ingreso que permite todos los puertos (PortRange=-1/-1), lo que plantea un riesgo de seguridad al permitir el acceso a cualquier puerto.", "fr": "Le groupe de sécurité a une règle d'ingress qui autorise tous les ports (PortRange=-1/-1), ce qui pose un risque de sécurité en autorisant l'accès à n'importe quel port.", "ja": "セキュリティグループにすべてのポート（PortRange=-1/-1）を許可するイングレスルールがあり、任意のポートへのアクセスを許可することでセキュリティリスクをもたらします。", "pt": "O grupo de segurança tem uma regra de ingresso que permite todas as portas (PortRange=-1/-1), o que representa um risco de segurança ao permitir acesso a qualquer porta.", "zh": "安全组有一条入网规则允许所有端口（PortRange=-1/-1），允许访问任何端口，存在安全风险。"}, Recommendation: models.I18nString{"de": "Beschränken Sie Ingress-Regeln auf spezifische Portbereiche basierend auf tatsächlichen Geschäftsanforderungen, anstatt '-1/-1' (alle Ports) zu verwenden.", "en": "Restrict ingress rules to specific port ranges based on actual business requirements instead of using '-1/-1' (all ports).", "es": "Restrinja las reglas de ingreso a rangos de puertos específicos según los requisitos comerciales reales en lugar de usar '-1/-1' (todos los puertos).", "fr": "Restreignez les règles d'ingress à des plages de ports spécifiques en fonction des exigences commerciales réelles au lieu d'utiliser '-1/-1' (tous les ports).", "ja": "実際のビジネス要件に基づいて、'-1/-1'（すべてのポート）を使用するのではなく、イングレスルールを特定のポート範囲に制限します。", "pt": "Restrinja as regras de ingresso a intervalos de portas específicos com base nos requisitos comerciais reais em vez de usar '-1/-1' (todas as portas).", "zh": "根据实际业务需求，将入网规则限制为特定的端口范围，而不是使用'-1/-1'（所有端口）。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup", "ALIYUN::ECS::SecurityGroupIngress", "ALIYUN::ECS::SecurityGroupIngresses"}, FilePath: "aliyun/rules/ecs-security-group-not-open-all-port.rego", PackageName: "infraguard.rules.aliyun.ecs_security_group_not_open_all_port", Content: "package infraguard.rules.aliyun.ecs_security_group_not_open_all_port\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"ecs-security-group-not-open-all-port\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Ingress Not Open All Ports\",\n\t\t\"zh\": \"安全组入网设置中不能有对所有端口开放的访问规则\",\n\t\t\"ja\": \"セキュリティグループイングレスがすべてのポートを開放していない\",\n\t\t\"de\": \"Sicherheitsgruppe Ingress öffnet nicht alle Ports\",\n\t\t\"es\": \"Ingress de Grupo de Seguridad No Abre Todos los Puertos\",\n\t\t\"fr\": \"Ingress du Groupe de Sécurité N'Ouvre Pas Tous les Ports\",\n\t\t\"pt\": \"Ingress de Grupo de Segurança Não Abre Todas as Portas\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Security group ingress rules should not allow all ports. When the port range is not set to -1/-1, it is considered compliant.\",\n\t\t\"zh\": \"安全组入方向授权策略为允许，当端口范围未设置为-1/-1 时，视为合规。如果端口范围设置为-1/-1，但被优先级更高的授权策略拒绝，视为合规。\",\n\t\t\"ja\": \"セキュリティグループのイングレスルールはすべてのポートを許可すべきではありません。ポート範囲が -1/-1 に設定されていない場合、準拠と見なされます。\",\n\t\t\"de\": \"Sicherheitsgruppen-Ingress-Regeln sollten nicht alle Ports erlauben. Wenn der Portbereich nicht auf -1/-1 gesetzt ist, wird dies als konform betrachtet.\",\n\t\t\"es\": \"Las reglas de ingreso del grupo de seguridad no deben permitir todos los puertos. Cuando el rango de puertos no está establecido en -1/-1, se considera conforme.\",\n\t\t\"fr\": \"Les règles d'ingress du groupe de sécurité ne doivent pas autoriser tous les ports. Lorsque la plage de ports n'est pas définie sur -1/-1, elle est considérée comme conforme.\",\n\t\t\"pt\": \"As regras de ingresso do grupo de segurança não devem permitir todas as portas. Quando o intervalo de portas não está definido como -1/-1, é considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group has an ingress rule that allows all ports (PortRange=-1/-1), which poses a security risk by allowing access to any port.\",\n\t\t\"zh\": \"安全组有一条入网规则允许所有端口（PortRange=-1/-1），允许访问任何端口，存在安全风险。\",\n\t\t\"ja\": \"セキュリティグループにすべてのポート（PortRange=-1/-1）を許可するイングレスルールがあり、任意のポートへのアクセスを許可することでセキュリティリスクをもたらします。\",\n\t\t\"de\": \"Die Sicherheitsgruppe hat eine Ingress-Regel, die alle Ports (PortRange=-1/-1) erlaubt, was ein Sicherheitsrisiko darstellt, indem sie Zugriff auf jeden Port ermöglicht.\",\n\t\t\"es\": \"El grupo de seguridad tiene una regla de ingreso que permite todos los puertos (PortRange=-1/-1), lo que plantea un riesgo de seguridad al permitir el acceso a cualquier puerto.\",\n\t\t\"fr\": \"Le groupe de sécurité a une règle d'ingress qui autorise tous les ports (PortRange=-1/-1), ce qui pose un risque de sécurité en autorisant l'accès à n'importe quel port.\",\n\t\t\"pt\": \"O grupo de segurança tem uma regra de ingresso que permite todas as portas (PortRange=-1/-1), o que representa um risco de segurança ao permitir acesso a qualquer porta.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict ingress rules to specific port ranges based on actual business requirements instead of using '-1/-1' (all ports).\",\n\t\t\"zh\": \"根据实际业务需求，将入网规则限制为特定的端口范围，而不是使用'-1/-1'（所有端口）。\",\n\t\t\"ja\": \"実際のビジネス要件に基づいて、'-1/-1'（すべてのポート）を使用するのではなく、イングレスルールを特定のポート範囲に制限します。\",\n\t\t\"de\": \"Beschränken Sie Ingress-Regeln auf spezifische Portbereiche basierend auf tatsächlichen Geschäftsanforderungen, anstatt '-1/-1' (alle Ports) zu verwenden.\",\n\t\t\"es\": \"Restrinja las reglas de ingreso a rangos de puertos específicos según los requisitos comerciales reales en lugar de usar '-1/-1' (todos los puertos).\",\n\t\t\"fr\": \"Restreignez les règles d'ingress à des plages de ports spécifiques en fonction des exigences commerciales réelles au lieu d'utiliser '-1/-1' (tous les ports).\",\n\t\t\"pt\": \"Restrinja as regras de ingresso a intervalos de portas específicos com base nos requisitos comerciais reais em vez de usar '-1/-1' (todas as portas).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\", \"ALIYUN::ECS::SecurityGroupIngress\", \"ALIYUN::ECS::SecurityGroupIngresses\"]\n}\n\n# Check if an ingress rule allows all ports with accept policy\nis_all_port_accept(rule) if {\n\trule.PortRange == \"-1/-1\"\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n}\n\n# Check SecurityGroup resource for ingress rules\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tsome i, rule in resource.Properties.SecurityGroupIngress\n\tis_all_port_accept(rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIngress\", format_int(i, 10), \"PortRange\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngress resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngress\")\n\tprops := resource.Properties\n\tis_all_port_accept(props)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"PortRange\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngresses resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngresses\")\n\tsome i, perm in resource.Properties.Permissions\n\tis_all_port_accept(perm)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Permissions\", format_int(i, 10), \"PortRange\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-security-group-not-open-all-protocol", Name: models.I18nString{"de": "Sicherheitsgruppe Ingress öffnet nicht alle Protokolle", "en": "Security Group Ingress Not Open All Protocols", "es": "Ingress de Grupo de Seguridad No Abre Todos los Protocolos", "fr": "Ingress du Groupe de Sécurité N'Ouvre Pas Tous les Protocoles", "ja": "セキュリティグループイングレスがすべてのプロトコルを開放していない", "pt": "Ingress de Grupo de Segurança Não Abre Todos os Protocolos", "zh": "安全组入网设置不能有对所有协议开放的访问规则"}, Severity: "high", Description: models.I18nString{"de": "Sicherheitsgruppen-Ingress-Regeln sollten nicht alle Protokolle erlauben. Wenn der Protokolltyp nicht auf ALL gesetzt ist, wird dies als konform betrachtet.", "en": "Security group ingress rules should not allow all protocols. When the protocol type is not set to ALL, it is considered compliant.", "es": "Las reglas de ingreso del grupo de seguridad no deben permitir todos los protocolos. Cuando el tipo de protocolo no está establecido en ALL, se considera conforme.", "fr": "Les règles d'ingress du groupe de sécurité ne doivent pas autoriser tous les protocoles. Lorsque le type de protocole n'est pas défini sur ALL, il est considéré comme conforme.", "ja": "セキュリティグループのイングレスルールはすべてのプロトコルを許可すべきではありません。プロトコルタイプが ALL に設定されていない場合、準拠と見なされます。", "pt": "As regras de ingresso do grupo de segurança não devem permitir todos os protocolos. Quando o tipo de protocolo não está definido como ALL, é considerado conforme.", "zh": "安全组入方向授权策略为允许，当协议类型未设置为 ALL 时，视为合规。如果协议类型设置为 ALL，但被优先级更高的授权策略拒绝，视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe hat eine Ingress-Regel, die alle Protokolle (IpProtocol=all) erlaubt, was ein Sicherheitsrisiko darstellt, indem sie jeden Typ von Netzwerkverkehr ermöglicht.", "en": "The security group has an ingress rule that allows all protocols (IpProtocol=all), which poses a security risk by allowing any type of network traffic.", "es": "El grupo de seguridad tiene una regla de ingreso que permite todos los protocolos (IpProtocol=all), lo que plantea un riesgo de seguridad al permitir cualquier tipo de tráfico de red.", "fr": "Le groupe de sécurité a une règle d'ingress qui autorise tous les protocoles (IpProtocol=all), ce qui pose un risque de sécurité en autorisant tout type de trafic réseau.", "ja": "セキュリティグループにすべてのプロトコル（IpProtocol=all）を許可するイングレスルールがあり、あらゆるタイプのネットワークトラフィックを許可することでセキュリティリスクをもたらします。", "pt": "O grupo de segurança tem uma regra de ingresso que permite todos os protocolos (IpProtocol=all), o que representa um risco de segurança ao permitir qualquer tipo de tráfego de rede.", "zh": "安全组有一条入网规则允许所有协议（IpProtocol=all），允许任何类型的网络流量，存在安全风险。"}, Recommendation: models.I18nString{"de": "Beschränken Sie Ingress-Regeln auf spezifische Protokolle (tcp, udp, icmp) basierend auf tatsächlichen Geschäftsanforderungen, anstatt 'all' zu verwenden.", "en": "Restrict ingress rules to specific protocols (tcp, udp, icmp) based on actual business requirements instead of using 'all'.", "es": "Restrinja las reglas de ingreso a protocolos específicos (tcp, udp, icmp) según los requisitos comerciales reales en lugar de usar 'all'.", "fr": "Restreignez les règles d'ingress à des protocoles spécifiques (tcp, udp, icmp) en fonction des exigences commerciales réelles au lieu d'utiliser 'all'.", "ja": "実際のビジネス要件に基づいて、'all' を使用するのではなく、イングレスルールを特定のプロトコル（tcp、udp、icmp）に制限します。", "pt": "Restrinja as regras de ingresso a protocolos específicos (tcp, udp, icmp) com base nos requisitos comerciais reais em vez de usar 'all'.", "zh": "根据实际业务需求，将入网规则限制为特定的协议（tcp、udp、icmp），而不是使用'all'。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup", "ALIYUN::ECS::SecurityGroupIngress", "ALIYUN::ECS::SecurityGroupIngresses"}, FilePath: "aliyun/rules/ecs-security-group-not-open-all-protocol.rego", PackageName: "infraguard.rules.aliyun.ecs_security_group_not_open_all_protocol", Content: "package infraguard.rules.aliyun.ecs_security_group_not_open_all_protocol\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"ecs-security-group-not-open-all-protocol\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Ingress Not Open All Protocols\",\n\t\t\"zh\": \"安全组入网设置不能有对所有协议开放的访问规则\",\n\t\t\"ja\": \"セキュリティグループイングレスがすべてのプロトコルを開放していない\",\n\t\t\"de\": \"Sicherheitsgruppe Ingress öffnet nicht alle Protokolle\",\n\t\t\"es\": \"Ingress de Grupo de Seguridad No Abre Todos los Protocolos\",\n\t\t\"fr\": \"Ingress du Groupe de Sécurité N'Ouvre Pas Tous les Protocoles\",\n\t\t\"pt\": \"Ingress de Grupo de Segurança Não Abre Todos os Protocolos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Security group ingress rules should not allow all protocols. When the protocol type is not set to ALL, it is considered compliant.\",\n\t\t\"zh\": \"安全组入方向授权策略为允许，当协议类型未设置为 ALL 时，视为合规。如果协议类型设置为 ALL，但被优先级更高的授权策略拒绝，视为合规。\",\n\t\t\"ja\": \"セキュリティグループのイングレスルールはすべてのプロトコルを許可すべきではありません。プロトコルタイプが ALL に設定されていない場合、準拠と見なされます。\",\n\t\t\"de\": \"Sicherheitsgruppen-Ingress-Regeln sollten nicht alle Protokolle erlauben. Wenn der Protokolltyp nicht auf ALL gesetzt ist, wird dies als konform betrachtet.\",\n\t\t\"es\": \"Las reglas de ingreso del grupo de seguridad no deben permitir todos los protocolos. Cuando el tipo de protocolo no está establecido en ALL, se considera conforme.\",\n\t\t\"fr\": \"Les règles d'ingress du groupe de sécurité ne doivent pas autoriser tous les protocoles. Lorsque le type de protocole n'est pas défini sur ALL, il est considéré comme conforme.\",\n\t\t\"pt\": \"As regras de ingresso do grupo de segurança não devem permitir todos os protocolos. Quando o tipo de protocolo não está definido como ALL, é considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group has an ingress rule that allows all protocols (IpProtocol=all), which poses a security risk by allowing any type of network traffic.\",\n\t\t\"zh\": \"安全组有一条入网规则允许所有协议（IpProtocol=all），允许任何类型的网络流量，存在安全风险。\",\n\t\t\"ja\": \"セキュリティグループにすべてのプロトコル（IpProtocol=all）を許可するイングレスルールがあり、あらゆるタイプのネットワークトラフィックを許可することでセキュリティリスクをもたらします。\",\n\t\t\"de\": \"Die Sicherheitsgruppe hat eine Ingress-Regel, die alle Protokolle (IpProtocol=all) erlaubt, was ein Sicherheitsrisiko darstellt, indem sie jeden Typ von Netzwerkverkehr ermöglicht.\",\n\t\t\"es\": \"El grupo de seguridad tiene una regla de ingreso que permite todos los protocolos (IpProtocol=all), lo que plantea un riesgo de seguridad al permitir cualquier tipo de tráfico de red.\",\n\t\t\"fr\": \"Le groupe de sécurité a une règle d'ingress qui autorise tous les protocoles (IpProtocol=all), ce qui pose un risque de sécurité en autorisant tout type de trafic réseau.\",\n\t\t\"pt\": \"O grupo de segurança tem uma regra de ingresso que permite todos os protocolos (IpProtocol=all), o que representa um risco de segurança ao permitir qualquer tipo de tráfego de rede.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict ingress rules to specific protocols (tcp, udp, icmp) based on actual business requirements instead of using 'all'.\",\n\t\t\"zh\": \"根据实际业务需求，将入网规则限制为特定的协议（tcp、udp、icmp），而不是使用'all'。\",\n\t\t\"ja\": \"実際のビジネス要件に基づいて、'all' を使用するのではなく、イングレスルールを特定のプロトコル（tcp、udp、icmp）に制限します。\",\n\t\t\"de\": \"Beschränken Sie Ingress-Regeln auf spezifische Protokolle (tcp, udp, icmp) basierend auf tatsächlichen Geschäftsanforderungen, anstatt 'all' zu verwenden.\",\n\t\t\"es\": \"Restrinja las reglas de ingreso a protocolos específicos (tcp, udp, icmp) según los requisitos comerciales reales en lugar de usar 'all'.\",\n\t\t\"fr\": \"Restreignez les règles d'ingress à des protocoles spécifiques (tcp, udp, icmp) en fonction des exigences commerciales réelles au lieu d'utiliser 'all'.\",\n\t\t\"pt\": \"Restrinja as regras de ingresso a protocolos específicos (tcp, udp, icmp) com base nos requisitos comerciais reais em vez de usar 'all'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\", \"ALIYUN::ECS::SecurityGroupIngress\", \"ALIYUN::ECS::SecurityGroupIngresses\"]\n}\n\n# Check if an ingress rule allows all protocols with accept policy\nis_all_protocol_accept(rule) if {\n\trule.IpProtocol == \"all\"\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n}\n\n# Check SecurityGroup resource for ingress rules\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tsome i, rule in resource.Properties.SecurityGroupIngress\n\tis_all_protocol_accept(rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIngress\", format_int(i, 10), \"IpProtocol\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngress resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngress\")\n\tprops := resource.Properties\n\tis_all_protocol_accept(props)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"IpProtocol\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngresses resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngresses\")\n\tsome i, perm in resource.Properties.Permissions\n\tis_all_protocol_accept(perm)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Permissions\", format_int(i, 10), \"IpProtocol\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", Name: models.I18nString{"de": "Sicherheitsgruppe riskante Ports-Prüfung mit Protokoll", "en": "Security Group Risky Ports Check with Protocol", "es": "Verificación de Puertos de Riesgo del Grupo de Seguridad con Protocolo", "fr": "Vérification des Ports à Risque du Groupe de Sécurité avec Protocole", "ja": "プロトコル付きセキュリティグループのリスクポートチェック", "pt": "Verificação de Portas de Risco do Grupo de Segurança com Protocolo", "zh": "安全组指定协议不允许对全部网段开启风险端口"}, Severity: "high", Description: models.I18nString{"de": "Wenn die Sicherheitsgruppen-Eingangsquelle auf 0.0.0.0/0 gesetzt ist, sollte der Portbereich keine riskanten Ports (22, 3389) für angegebene Protokolle (TCP/UDP) enthalten, um das Risiko von Brute-Force-Angriffen zu reduzieren.", "en": "When security group ingress source is set to 0.0.0.0/0, the port range should not include risky ports (22, 3389) for specified protocols (TCP/UDP), to reduce the risk of brute force attacks.", "es": "Cuando la fuente de ingreso del grupo de seguridad se establece en 0.0.0.0/0, el rango de puertos no debe incluir puertos de riesgo (22, 3389) para protocolos especificados (TCP/UDP), para reducir el riesgo de ataques de fuerza bruta.", "fr": "Lorsque la source d'ingress du groupe de sécurité est définie sur 0.0.0.0/0, la plage de ports ne doit pas inclure les ports à risque (22, 3389) pour les protocoles spécifiés (TCP/UDP), afin de réduire le risque d'attaques par force brute.", "ja": "セキュリティグループのイングレスソースが 0.0.0.0/0 に設定されている場合、ブルートフォース攻撃のリスクを低減するために、指定されたプロトコル（TCP/UDP）のポート範囲にリスクポート（22、3389）を含めるべきではありません。", "pt": "Quando a origem de entrada do grupo de segurança é definida como 0.0.0.0/0, o intervalo de portas não deve incluir portas de risco (22, 3389) para protocolos especificados (TCP/UDP), para reduzir o risco de ataques de força bruta.", "zh": "当安全组入网网段设置为 0.0.0.0/0 时，指定协议的端口范围不包含指定风险端口，降低服务器登录密码被暴力破解风险，视为合规。默认检测风险端口为 22、3389。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe erlaubt Zugriff auf riskante Ports (SSH:22, RDP:3389) von allen Quellen (0.0.0.0/0), was das Risiko von Brute-Force-Passwortangriffen erhöht.", "en": "The security group allows access to risky ports (SSH:22, RDP:3389) from all sources (0.0.0.0/0), which increases the risk of brute force password attacks.", "es": "El grupo de seguridad permite acceso a puertos de riesgo (SSH:22, RDP:3389) desde todas las fuentes (0.0.0.0/0), lo que aumenta el riesgo de ataques de fuerza bruta en contraseñas.", "fr": "Le groupe de sécurité autorise l'accès aux ports à risque (SSH:22, RDP:3389) depuis toutes les sources (0.0.0.0/0), ce qui augmente le risque d'attaques par force brute sur les mots de passe.", "ja": "セキュリティグループがすべてのソース（0.0.0.0/0）からのリスクポート（SSH:22、RDP:3389）へのアクセスを許可しているため、ブルートフォースパスワード攻撃のリスクが増加します。", "pt": "O grupo de segurança permite acesso a portas de risco (SSH:22, RDP:3389) de todas as fontes (0.0.0.0/0), o que aumenta o risco de ataques de força bruta em senhas.", "zh": "安全组允许从所有来源（0.0.0.0/0）访问风险端口（SSH:22、RDP:3389），增加了暴力破解密码的风险。"}, Recommendation: models.I18nString{"de": "Beschränken Sie den Zugriff auf Ports 22 (SSH) und 3389 (RDP), indem Sie das Quell-CIDR auf spezifische vertrauenswürdige IP-Bereiche anstelle von 0.0.0.0/0 beschränken.", "en": "Restrict access to ports 22 (SSH) and 3389 (RDP) by limiting the source CIDR to specific trusted IP ranges instead of 0.0.0.0/0.", "es": "Restrinja el acceso a los puertos 22 (SSH) y 3389 (RDP) limitando el CIDR de origen a rangos de IP confiables específicos en lugar de 0.0.0.0/0.", "fr": "Restreignez l'accès aux ports 22 (SSH) et 3389 (RDP) en limitant le CIDR source à des plages d'IP de confiance spécifiques au lieu de 0.0.0.0/0.", "ja": "ソース CIDR を 0.0.0.0/0 ではなく、特定の信頼できる IP 範囲に制限することで、ポート 22（SSH）と 3389（RDP）へのアクセスを制限します。", "pt": "Restrinja o acesso às portas 22 (SSH) e 3389 (RDP) limitando o CIDR de origem a intervalos de IP confiáveis específicos em vez de 0.0.0.0/0.", "zh": "限制对端口 22（SSH）和 3389（RDP）的访问，将来源 CIDR 限制为特定的可信 IP 范围，而不是 0.0.0.0/0。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup", "ALIYUN::ECS::SecurityGroupIngress", "ALIYUN::ECS::SecurityGroupIngresses"}, FilePath: "aliyun/rules/ecs-security-group-risky-ports-check-with-protocol.rego", PackageName: "infraguard.rules.aliyun.ecs_security_group_risky_ports_check_with_protocol", Content: "package infraguard.rules.aliyun.ecs_security_group_risky_ports_check_with_protocol\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"ecs-security-group-risky-ports-check-with-protocol\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Risky Ports Check with Protocol\",\n\t\t\"zh\": \"安全组指定协议不允许对全部网段开启风险端口\",\n\t\t\"ja\": \"プロトコル付きセキュリティグループのリスクポートチェック\",\n\t\t\"de\": \"Sicherheitsgruppe riskante Ports-Prüfung mit Protokoll\",\n\t\t\"es\": \"Verificación de Puertos de Riesgo del Grupo de Seguridad con Protocolo\",\n\t\t\"fr\": \"Vérification des Ports à Risque du Groupe de Sécurité avec Protocole\",\n\t\t\"pt\": \"Verificação de Portas de Risco do Grupo de Segurança com Protocolo\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"When security group ingress source is set to 0.0.0.0/0, the port range should not include risky ports (22, 3389) for specified protocols (TCP/UDP), to reduce the risk of brute force attacks.\",\n\t\t\"zh\": \"当安全组入网网段设置为 0.0.0.0/0 时，指定协议的端口范围不包含指定风险端口，降低服务器登录密码被暴力破解风险，视为合规。默认检测风险端口为 22、3389。\",\n\t\t\"ja\": \"セキュリティグループのイングレスソースが 0.0.0.0/0 に設定されている場合、ブルートフォース攻撃のリスクを低減するために、指定されたプロトコル（TCP/UDP）のポート範囲にリスクポート（22、3389）を含めるべきではありません。\",\n\t\t\"de\": \"Wenn die Sicherheitsgruppen-Eingangsquelle auf 0.0.0.0/0 gesetzt ist, sollte der Portbereich keine riskanten Ports (22, 3389) für angegebene Protokolle (TCP/UDP) enthalten, um das Risiko von Brute-Force-Angriffen zu reduzieren.\",\n\t\t\"es\": \"Cuando la fuente de ingreso del grupo de seguridad se establece en 0.0.0.0/0, el rango de puertos no debe incluir puertos de riesgo (22, 3389) para protocolos especificados (TCP/UDP), para reducir el riesgo de ataques de fuerza bruta.\",\n\t\t\"fr\": \"Lorsque la source d'ingress du groupe de sécurité est définie sur 0.0.0.0/0, la plage de ports ne doit pas inclure les ports à risque (22, 3389) pour les protocoles spécifiés (TCP/UDP), afin de réduire le risque d'attaques par force brute.\",\n\t\t\"pt\": \"Quando a origem de entrada do grupo de segurança é definida como 0.0.0.0/0, o intervalo de portas não deve incluir portas de risco (22, 3389) para protocolos especificados (TCP/UDP), para reduzir o risco de ataques de força bruta.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group allows access to risky ports (SSH:22, RDP:3389) from all sources (0.0.0.0/0), which increases the risk of brute force password attacks.\",\n\t\t\"zh\": \"安全组允许从所有来源（0.0.0.0/0）访问风险端口（SSH:22、RDP:3389），增加了暴力破解密码的风险。\",\n\t\t\"ja\": \"セキュリティグループがすべてのソース（0.0.0.0/0）からのリスクポート（SSH:22、RDP:3389）へのアクセスを許可しているため、ブルートフォースパスワード攻撃のリスクが増加します。\",\n\t\t\"de\": \"Die Sicherheitsgruppe erlaubt Zugriff auf riskante Ports (SSH:22, RDP:3389) von allen Quellen (0.0.0.0/0), was das Risiko von Brute-Force-Passwortangriffen erhöht.\",\n\t\t\"es\": \"El grupo de seguridad permite acceso a puertos de riesgo (SSH:22, RDP:3389) desde todas las fuentes (0.0.0.0/0), lo que aumenta el riesgo de ataques de fuerza bruta en contraseñas.\",\n\t\t\"fr\": \"Le groupe de sécurité autorise l'accès aux ports à risque (SSH:22, RDP:3389) depuis toutes les sources (0.0.0.0/0), ce qui augmente le risque d'attaques par force brute sur les mots de passe.\",\n\t\t\"pt\": \"O grupo de segurança permite acesso a portas de risco (SSH:22, RDP:3389) de todas as fontes (0.0.0.0/0), o que aumenta o risco de ataques de força bruta em senhas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict access to ports 22 (SSH) and 3389 (RDP) by limiting the source CIDR to specific trusted IP ranges instead of 0.0.0.0/0.\",\n\t\t\"zh\": \"限制对端口 22（SSH）和 3389（RDP）的访问，将来源 CIDR 限制为特定的可信 IP 范围，而不是 0.0.0.0/0。\",\n\t\t\"ja\": \"ソース CIDR を 0.0.0.0/0 ではなく、特定の信頼できる IP 範囲に制限することで、ポート 22（SSH）と 3389（RDP）へのアクセスを制限します。\",\n\t\t\"de\": \"Beschränken Sie den Zugriff auf Ports 22 (SSH) und 3389 (RDP), indem Sie das Quell-CIDR auf spezifische vertrauenswürdige IP-Bereiche anstelle von 0.0.0.0/0 beschränken.\",\n\t\t\"es\": \"Restrinja el acceso a los puertos 22 (SSH) y 3389 (RDP) limitando el CIDR de origen a rangos de IP confiables específicos en lugar de 0.0.0.0/0.\",\n\t\t\"fr\": \"Restreignez l'accès aux ports 22 (SSH) et 3389 (RDP) en limitant le CIDR source à des plages d'IP de confiance spécifiques au lieu de 0.0.0.0/0.\",\n\t\t\"pt\": \"Restrinja o acesso às portas 22 (SSH) e 3389 (RDP) limitando o CIDR de origem a intervalos de IP confiáveis específicos em vez de 0.0.0.0/0.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\", \"ALIYUN::ECS::SecurityGroupIngress\", \"ALIYUN::ECS::SecurityGroupIngresses\"]\n}\n\n# Risky ports that should not be exposed to all sources\nrisky_ports := [22, 3389]\n\n# Protocols to check (TCP and UDP are relevant for SSH and RDP)\nrisky_protocols := [\"tcp\", \"udp\"]\n\n# Check if a rule exposes risky ports from public sources\nis_risky_public_rule(rule) if {\n\t# Source is 0.0.0.0/0 (all IPv4)\n\trule.SourceCidrIp == \"0.0.0.0/0\"\n\n\t# Protocol is TCP, UDP, or ALL\n\tlower(rule.IpProtocol) in risky_protocols\n\n\t# Policy is accept (default)\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n\n\t# Check if any risky port is in the range\n\tsome port in risky_ports\n\thelpers.port_in_range(port, rule.PortRange)\n}\n\nis_risky_public_rule(rule) if {\n\t# Source is ::/0 (all IPv6)\n\trule.Ipv6SourceCidrIp == \"::/0\"\n\n\t# Protocol is TCP, UDP, or ALL\n\tlower(rule.IpProtocol) in risky_protocols\n\n\t# Policy is accept (default)\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n\n\t# Check if any risky port is in the range\n\tsome port in risky_ports\n\thelpers.port_in_range(port, rule.PortRange)\n}\n\n# Check SecurityGroup resource for ingress rules\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tsome i, rule in resource.Properties.SecurityGroupIngress\n\tis_risky_public_rule(rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIngress\", format_int(i, 10)],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngress resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngress\")\n\tprops := resource.Properties\n\tingress_rule := {\n\t\t\"IpProtocol\": props.IpProtocol,\n\t\t\"PortRange\": props.PortRange,\n\t\t\"SourceCidrIp\": object.get(props, \"SourceCidrIp\", \"\"),\n\t\t\"Ipv6SourceCidrIp\": object.get(props, \"Ipv6SourceCidrIp\", \"\"),\n\t\t\"Policy\": object.get(props, \"Policy\", \"accept\"),\n\t}\n\tis_risky_public_rule(ingress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngresses resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngresses\")\n\tsome i, perm in resource.Properties.Permissions\n\tingress_rule := {\n\t\t\"IpProtocol\": perm.IpProtocol,\n\t\t\"PortRange\": perm.PortRange,\n\t\t\"SourceCidrIp\": object.get(perm, \"SourceCidrIp\", \"\"),\n\t\t\"Ipv6SourceCidrIp\": object.get(perm, \"Ipv6SourceCidrIp\", \"\"),\n\t\t\"Policy\": object.get(perm, \"Policy\", \"accept\"),\n\t}\n\tis_risky_public_rule(ingress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Permissions\", format_int(i, 10)],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-security-group-type-not-normal", Name: models.I18nString{"de": "Unternehmens-Sicherheitsgruppentyp verwenden", "en": "Use Enterprise Security Group Type", "es": "Usar Tipo de Grupo de Seguridad Empresarial", "fr": "Utiliser le Type de Groupe de Sécurité Entreprise", "ja": "エンタープライズセキュリティグループタイプを使用", "pt": "Usar Tipo de Grupo de Segurança Empresarial", "zh": "使用企业类型安全组"}, Severity: "low", Description: models.I18nString{"de": "Der ECS-Sicherheitsgruppentyp sollte nicht der normale Typ sein. Die Verwendung von Unternehmens-Sicherheitsgruppen gilt als konform.", "en": "ECS security group type should not be normal type. Using enterprise security group is considered compliant.", "es": "El tipo de grupo de seguridad ECS no debe ser tipo normal. Usar grupo de seguridad empresarial se considera conforme.", "fr": "Le type de groupe de sécurité ECS ne doit pas être de type normal. L'utilisation d'un groupe de sécurité entreprise est considérée comme conforme.", "ja": "ECS セキュリティグループタイプは通常タイプであってはなりません。エンタープライズセキュリティグループの使用は準拠と見なされます。", "pt": "O tipo de grupo de segurança ECS não deve ser tipo normal. Usar grupo de segurança empresarial é considerado conforme.", "zh": "ECS 安全组类型非普通安全组，视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe verwendet den normalen Typ anstelle des Unternehmenstyps, was Einschränkungen bei Funktionalität und Leistung haben kann.", "en": "The security group is using normal type instead of enterprise type, which may have limitations in functionality and performance.", "es": "El grupo de seguridad está usando tipo normal en lugar de tipo empresarial, lo que puede tener limitaciones en funcionalidad y rendimiento.", "fr": "Le groupe de sécurité utilise le type normal au lieu du type entreprise, ce qui peut avoir des limitations en termes de fonctionnalité et de performances.", "ja": "セキュリティグループがエンタープライズタイプではなく通常タイプを使用しているため、機能とパフォーマンスに制限がある可能性があります。", "pt": "O grupo de segurança está usando tipo normal em vez de tipo empresarial, o que pode ter limitações em funcionalidade e desempenho.", "zh": "安全组使用了普通类型而非企业类型，可能在功能和性能上存在限制。"}, Recommendation: models.I18nString{"de": "Setzen Sie die Eigenschaft SecurityGroupType auf 'enterprise', um Unternehmens-Sicherheitsgruppen zu verwenden, die bessere Leistung und mehr Funktionen bieten.", "en": "Set SecurityGroupType property to 'enterprise' to use enterprise security group which provides better performance and more features.", "es": "Establezca la propiedad SecurityGroupType en 'enterprise' para usar grupo de seguridad empresarial que proporciona mejor rendimiento y más funciones.", "fr": "Définissez la propriété SecurityGroupType sur 'enterprise' pour utiliser un groupe de sécurité entreprise qui offre de meilleures performances et plus de fonctionnalités.", "ja": "SecurityGroupType プロパティを 'enterprise' に設定して、より優れたパフォーマンスとより多くの機能を提供するエンタープライズセキュリティグループを使用します。", "pt": "Defina a propriedade SecurityGroupType como 'enterprise' para usar grupo de segurança empresarial que oferece melhor desempenho e mais recursos.", "zh": "将 SecurityGroupType 属性设置为'enterprise'以使用企业安全组，获得更好的性能和更多功能。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup"}, FilePath: "aliyun/rules/ecs-security-group-type-not-normal.rego", PackageName: "infraguard.rules.aliyun.ecs_security_group_type_not_normal", Content: "package infraguard.rules.aliyun.ecs_security_group_type_not_normal\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"ecs-security-group-type-not-normal\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"Use Enterprise Security Group Type\",\n\t\t\"zh\": \"使用企业类型安全组\",\n\t\t\"ja\": \"エンタープライズセキュリティグループタイプを使用\",\n\t\t\"de\": \"Unternehmens-Sicherheitsgruppentyp verwenden\",\n\t\t\"es\": \"Usar Tipo de Grupo de Seguridad Empresarial\",\n\t\t\"fr\": \"Utiliser le Type de Groupe de Sécurité Entreprise\",\n\t\t\"pt\": \"Usar Tipo de Grupo de Segurança Empresarial\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS security group type should not be normal type. Using enterprise security group is considered compliant.\",\n\t\t\"zh\": \"ECS 安全组类型非普通安全组，视为合规。\",\n\t\t\"ja\": \"ECS セキュリティグループタイプは通常タイプであってはなりません。エンタープライズセキュリティグループの使用は準拠と見なされます。\",\n\t\t\"de\": \"Der ECS-Sicherheitsgruppentyp sollte nicht der normale Typ sein. Die Verwendung von Unternehmens-Sicherheitsgruppen gilt als konform.\",\n\t\t\"es\": \"El tipo de grupo de seguridad ECS no debe ser tipo normal. Usar grupo de seguridad empresarial se considera conforme.\",\n\t\t\"fr\": \"Le type de groupe de sécurité ECS ne doit pas être de type normal. L'utilisation d'un groupe de sécurité entreprise est considérée comme conforme.\",\n\t\t\"pt\": \"O tipo de grupo de segurança ECS não deve ser tipo normal. Usar grupo de segurança empresarial é considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group is using normal type instead of enterprise type, which may have limitations in functionality and performance.\",\n\t\t\"zh\": \"安全组使用了普通类型而非企业类型，可能在功能和性能上存在限制。\",\n\t\t\"ja\": \"セキュリティグループがエンタープライズタイプではなく通常タイプを使用しているため、機能とパフォーマンスに制限がある可能性があります。\",\n\t\t\"de\": \"Die Sicherheitsgruppe verwendet den normalen Typ anstelle des Unternehmenstyps, was Einschränkungen bei Funktionalität und Leistung haben kann.\",\n\t\t\"es\": \"El grupo de seguridad está usando tipo normal en lugar de tipo empresarial, lo que puede tener limitaciones en funcionalidad y rendimiento.\",\n\t\t\"fr\": \"Le groupe de sécurité utilise le type normal au lieu du type entreprise, ce qui peut avoir des limitations en termes de fonctionnalité et de performances.\",\n\t\t\"pt\": \"O grupo de segurança está usando tipo normal em vez de tipo empresarial, o que pode ter limitações em funcionalidade e desempenho.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set SecurityGroupType property to 'enterprise' to use enterprise security group which provides better performance and more features.\",\n\t\t\"zh\": \"将 SecurityGroupType 属性设置为'enterprise'以使用企业安全组，获得更好的性能和更多功能。\",\n\t\t\"ja\": \"SecurityGroupType プロパティを 'enterprise' に設定して、より優れたパフォーマンスとより多くの機能を提供するエンタープライズセキュリティグループを使用します。\",\n\t\t\"de\": \"Setzen Sie die Eigenschaft SecurityGroupType auf 'enterprise', um Unternehmens-Sicherheitsgruppen zu verwenden, die bessere Leistung und mehr Funktionen bieten.\",\n\t\t\"es\": \"Establezca la propiedad SecurityGroupType en 'enterprise' para usar grupo de seguridad empresarial que proporciona mejor rendimiento y más funciones.\",\n\t\t\"fr\": \"Définissez la propriété SecurityGroupType sur 'enterprise' pour utiliser un groupe de sécurité entreprise qui offre de meilleures performances et plus de fonctionnalités.\",\n\t\t\"pt\": \"Defina a propriedade SecurityGroupType como 'enterprise' para usar grupo de segurança empresarial que oferece melhor desempenho e mais recursos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\"]\n}\n\n# Check if security group uses enterprise type\nis_enterprise_type(resource) if {\n\tresource.Properties.SecurityGroupType == \"enterprise\"\n}\n\n# Generate deny for non-compliant resources (normal type or not specified)\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tnot is_enterprise_type(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-security-group-white-list-port-check", Name: models.I18nString{"de": "Sicherheitsgruppe Nicht-Whitelist-Port-Ingress-Prüfung", "en": "Security Group Non-Whitelist Port Ingress Check", "es": "Verificación de Ingress de Puerto No en Lista Blanca de Grupo de Seguridad", "fr": "Vérification d'Ingress de Port Non-Liste Blanche du Groupe de Sécurité", "ja": "セキュリティグループの非ホワイトリストポートイングレスチェック", "pt": "Verificação de Ingresso de Porta Não na Lista Branca do Grupo de Segurança", "zh": "安全组非白名单端口入网设置有效"}, Severity: "high", Description: models.I18nString{"de": "Außer Whitelist-Ports (80) sollten andere Ports keine Ingress-Regeln haben, die Zugriff von 0.0.0.0/0 erlauben.", "en": "Except for whitelisted ports (80), other ports should not have ingress rules allowing access from 0.0.0.0/0.", "es": "Excepto los puertos en lista blanca (80), otros puertos no deben tener reglas de ingreso que permitan el acceso desde 0.0.0.0/0.", "fr": "À l'exception des ports en liste blanche (80), les autres ports ne doivent pas avoir de règles d'ingress autorisant l'accès depuis 0.0.0.0/0.", "ja": "ホワイトリストポート（80）を除いて、他のポートは 0.0.0.0/0 からのアクセスを許可するイングレスルールを持つべきではありません。", "pt": "Exceto portas na lista branca (80), outras portas não devem ter regras de ingresso que permitam acesso de 0.0.0.0/0.", "zh": "除指定的白名单端口（80）外，其余端口不能有授权策略设置为允许而且来源为 0.0.0.0/0 的入方向规则，视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe erlaubt Zugriff auf Nicht-Whitelist-Ports von allen Quellen (0.0.0.0/0), was unnötige Dienste dem Internet aussetzen kann.", "en": "The security group allows access to non-whitelisted ports from all sources (0.0.0.0/0), which may expose unnecessary services to the internet.", "es": "El grupo de seguridad permite el acceso a puertos no incluidos en la lista blanca desde todas las fuentes (0.0.0.0/0), lo que puede exponer servicios innecesarios a internet.", "fr": "Le groupe de sécurité autorise l'accès aux ports non listés en liste blanche depuis toutes les sources (0.0.0.0/0), ce qui peut exposer des services inutiles à Internet.", "ja": "セキュリティグループがすべてのソース（0.0.0.0/0）からの非ホワイトリストポートへのアクセスを許可しているため、不要なサービスがインターネットに公開される可能性があります。", "pt": "O grupo de segurança permite acesso a portas não na lista branca de todas as fontes (0.0.0.0/0), o que pode expor serviços desnecessários à internet.", "zh": "安全组允许从所有来源（0.0.0.0/0）访问非白名单端口，可能将不必要的服务暴露到互联网。"}, Recommendation: models.I18nString{"de": "Erlauben Sie nur Whitelist-Ports (z. B. 80 für HTTP), die von 0.0.0.0/0 zugänglich sind. Beschränken Sie andere Ports auf spezifische vertrauenswürdige Quell-IP-Bereiche.", "en": "Only allow whitelisted ports (e.g., 80 for HTTP) to be accessible from 0.0.0.0/0. Restrict other ports to specific trusted source IP ranges.", "es": "Solo permita que los puertos en lista blanca (por ejemplo, 80 para HTTP) sean accesibles desde 0.0.0.0/0. Restrinja otros puertos a rangos de IP de origen confiables específicos.", "fr": "Autorisez uniquement les ports en liste blanche (par exemple, 80 pour HTTP) à être accessibles depuis 0.0.0.0/0. Restreignez les autres ports à des plages d'IP source de confiance spécifiques.", "ja": "ホワイトリストポート（例：HTTP の 80 ポート）のみが 0.0.0.0/0 からアクセス可能になるようにします。他のポートは特定の信頼できるソース IP 範囲に制限します。", "pt": "Permita apenas portas na lista branca (por exemplo, 80 para HTTP) sejam acessíveis de 0.0.0.0/0. Restrinja outras portas a intervalos de IP de origem confiáveis específicos.", "zh": "仅允许白名单端口（如 HTTP 的 80 端口）从 0.0.0.0/0 访问。将其他端口限制为特定的可信源 IP 范围。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup", "ALIYUN::ECS::SecurityGroupIngress", "ALIYUN::ECS::SecurityGroupIngresses"}, FilePath: "aliyun/rules/ecs-security-group-white-list-port-check.rego", PackageName: "infraguard.rules.aliyun.ecs_security_group_white_list_port_check", Content: "package infraguard.rules.aliyun.ecs_security_group_white_list_port_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"ecs-security-group-white-list-port-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Non-Whitelist Port Ingress Check\",\n\t\t\"zh\": \"安全组非白名单端口入网设置有效\",\n\t\t\"ja\": \"セキュリティグループの非ホワイトリストポートイングレスチェック\",\n\t\t\"de\": \"Sicherheitsgruppe Nicht-Whitelist-Port-Ingress-Prüfung\",\n\t\t\"es\": \"Verificación de Ingress de Puerto No en Lista Blanca de Grupo de Seguridad\",\n\t\t\"fr\": \"Vérification d'Ingress de Port Non-Liste Blanche du Groupe de Sécurité\",\n\t\t\"pt\": \"Verificação de Ingresso de Porta Não na Lista Branca do Grupo de Segurança\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Except for whitelisted ports (80), other ports should not have ingress rules allowing access from 0.0.0.0/0.\",\n\t\t\"zh\": \"除指定的白名单端口（80）外，其余端口不能有授权策略设置为允许而且来源为 0.0.0.0/0 的入方向规则，视为合规。\",\n\t\t\"ja\": \"ホワイトリストポート（80）を除いて、他のポートは 0.0.0.0/0 からのアクセスを許可するイングレスルールを持つべきではありません。\",\n\t\t\"de\": \"Außer Whitelist-Ports (80) sollten andere Ports keine Ingress-Regeln haben, die Zugriff von 0.0.0.0/0 erlauben.\",\n\t\t\"es\": \"Excepto los puertos en lista blanca (80), otros puertos no deben tener reglas de ingreso que permitan el acceso desde 0.0.0.0/0.\",\n\t\t\"fr\": \"À l'exception des ports en liste blanche (80), les autres ports ne doivent pas avoir de règles d'ingress autorisant l'accès depuis 0.0.0.0/0.\",\n\t\t\"pt\": \"Exceto portas na lista branca (80), outras portas não devem ter regras de ingresso que permitam acesso de 0.0.0.0/0.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group allows access to non-whitelisted ports from all sources (0.0.0.0/0), which may expose unnecessary services to the internet.\",\n\t\t\"zh\": \"安全组允许从所有来源（0.0.0.0/0）访问非白名单端口，可能将不必要的服务暴露到互联网。\",\n\t\t\"ja\": \"セキュリティグループがすべてのソース（0.0.0.0/0）からの非ホワイトリストポートへのアクセスを許可しているため、不要なサービスがインターネットに公開される可能性があります。\",\n\t\t\"de\": \"Die Sicherheitsgruppe erlaubt Zugriff auf Nicht-Whitelist-Ports von allen Quellen (0.0.0.0/0), was unnötige Dienste dem Internet aussetzen kann.\",\n\t\t\"es\": \"El grupo de seguridad permite el acceso a puertos no incluidos en la lista blanca desde todas las fuentes (0.0.0.0/0), lo que puede exponer servicios innecesarios a internet.\",\n\t\t\"fr\": \"Le groupe de sécurité autorise l'accès aux ports non listés en liste blanche depuis toutes les sources (0.0.0.0/0), ce qui peut exposer des services inutiles à Internet.\",\n\t\t\"pt\": \"O grupo de segurança permite acesso a portas não na lista branca de todas as fontes (0.0.0.0/0), o que pode expor serviços desnecessários à internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Only allow whitelisted ports (e.g., 80 for HTTP) to be accessible from 0.0.0.0/0. Restrict other ports to specific trusted source IP ranges.\",\n\t\t\"zh\": \"仅允许白名单端口（如 HTTP 的 80 端口）从 0.0.0.0/0 访问。将其他端口限制为特定的可信源 IP 范围。\",\n\t\t\"ja\": \"ホワイトリストポート（例：HTTP の 80 ポート）のみが 0.0.0.0/0 からアクセス可能になるようにします。他のポートは特定の信頼できるソース IP 範囲に制限します。\",\n\t\t\"de\": \"Erlauben Sie nur Whitelist-Ports (z. B. 80 für HTTP), die von 0.0.0.0/0 zugänglich sind. Beschränken Sie andere Ports auf spezifische vertrauenswürdige Quell-IP-Bereiche.\",\n\t\t\"es\": \"Solo permita que los puertos en lista blanca (por ejemplo, 80 para HTTP) sean accesibles desde 0.0.0.0/0. Restrinja otros puertos a rangos de IP de origen confiables específicos.\",\n\t\t\"fr\": \"Autorisez uniquement les ports en liste blanche (par exemple, 80 pour HTTP) à être accessibles depuis 0.0.0.0/0. Restreignez les autres ports à des plages d'IP source de confiance spécifiques.\",\n\t\t\"pt\": \"Permita apenas portas na lista branca (por exemplo, 80 para HTTP) sejam acessíveis de 0.0.0.0/0. Restrinja outras portas a intervalos de IP de origem confiáveis específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\", \"ALIYUN::ECS::SecurityGroupIngress\", \"ALIYUN::ECS::SecurityGroupIngresses\"]\n}\n\n# Whitelisted ports that are allowed from 0.0.0.0/0\nwhitelist_ports := [80]\n\n# Check if a port range contains only whitelisted ports\nis_only_whitelist_ports(port_range) if {\n\t[start, end] := helpers.parse_port_range(port_range)\n\tstart == end\n\tsome port in whitelist_ports\n\tstart == port\n}\n\n# Check if a rule allows non-whitelisted ports from public sources\nis_non_whitelist_public_rule(rule) if {\n\t# Source is 0.0.0.0/0 (all IPv4)\n\trule.SourceCidrIp == \"0.0.0.0/0\"\n\n\t# Policy is accept (default)\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n\n\t# Not all ports (-1/-1 is handled by other rules)\n\trule.PortRange != \"-1/-1\"\n\n\t# Port range is not only whitelisted ports\n\tnot is_only_whitelist_ports(rule.PortRange)\n}\n\nis_non_whitelist_public_rule(rule) if {\n\t# Source is ::/0 (all IPv6)\n\trule.Ipv6SourceCidrIp == \"::/0\"\n\n\t# Policy is accept (default)\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n\n\t# Not all ports (-1/-1 is handled by other rules)\n\trule.PortRange != \"-1/-1\"\n\n\t# Port range is not only whitelisted ports\n\tnot is_only_whitelist_ports(rule.PortRange)\n}\n\n# Check SecurityGroup resource for ingress rules\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tsome i, rule in resource.Properties.SecurityGroupIngress\n\tis_non_whitelist_public_rule(rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIngress\", format_int(i, 10)],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngress resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngress\")\n\tprops := resource.Properties\n\tingress_rule := {\n\t\t\"PortRange\": props.PortRange,\n\t\t\"SourceCidrIp\": object.get(props, \"SourceCidrIp\", \"\"),\n\t\t\"Ipv6SourceCidrIp\": object.get(props, \"Ipv6SourceCidrIp\", \"\"),\n\t\t\"Policy\": object.get(props, \"Policy\", \"accept\"),\n\t}\n\tis_non_whitelist_public_rule(ingress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngresses resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngresses\")\n\tsome i, perm in resource.Properties.Permissions\n\tingress_rule := {\n\t\t\"PortRange\": perm.PortRange,\n\t\t\"SourceCidrIp\": object.get(perm, \"SourceCidrIp\", \"\"),\n\t\t\"Ipv6SourceCidrIp\": object.get(perm, \"Ipv6SourceCidrIp\", \"\"),\n\t\t\"Policy\": object.get(perm, \"Policy\", \"accept\"),\n\t}\n\tis_non_whitelist_public_rule(ingress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Permissions\", format_int(i, 10)],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-snapshot-policy-timepoints-check", Name: models.I18nString{"de": "ECS-Automatische Momentaufnahme-Richtlinien-Zeitpunkte angemessen konfiguriert", "en": "ECS auto snapshot policy timepoints configured reasonably", "es": "Puntos de Tiempo de Política de Instantánea Automática ECS Configurados Razonablemente", "fr": "Points Temporels de Politique d'Instantané Automatique ECS Configurés Raisonnablement", "ja": "ECS 自動スナップショットポリシーの時間ポイントが適切に設定されている", "pt": "Pontos de Tempo da Política de Instantâneo Automático ECS Configurados Razoavelmente", "zh": "为自动快照策略设置合理的创建时间点"}, Severity: "medium", Description: models.I18nString{"de": "Die Zeitpunkte für die Momentaufnahmeerstellung in der automatischen Momentaufnahme-Richtlinie liegen innerhalb des angegebenen Zeitbereichs und gelten als konform. Das Erstellen von Momentaufnahmen reduziert vorübergehend die Block-Speicher-I/O-Leistung, wobei die Leistungsunterschiede im Allgemeinen innerhalb von 10% liegen und kurze Verlangsamungen verursachen. Es wird empfohlen, Zeitpunkte zu wählen, die Geschäftsspitzenzeiten vermeiden.", "en": "The snapshot creation timepoints in the auto snapshot policy are within the specified time range, considered compliant. Creating snapshots temporarily reduces block storage I/O performance, with performance differences generally within 10%, causing brief slowdowns. It is recommended to select timepoints that avoid business peak hours.", "es": "Los puntos de tiempo de creación de instantáneas en la política de instantáneas automáticas están dentro del rango de tiempo especificado, considerado conforme. Crear instantáneas reduce temporalmente el rendimiento de E/S del almacenamiento en bloque, con diferencias de rendimiento generalmente dentro del 10%, causando ralentizaciones breves. Se recomienda seleccionar puntos de tiempo que eviten las horas pico comerciales.", "fr": "Les points temporels de création d'instantanés dans la politique d'instantanés automatiques sont dans la plage de temps spécifiée, considérés comme conformes. La création d'instantanés réduit temporairement les performances d'E/S du stockage en bloc, avec des différences de performance généralement inférieures à 10%, provoquant de brefs ralentissements. Il est recommandé de sélectionner des points temporels qui évitent les heures de pointe commerciales.", "ja": "自動スナップショットポリシーのスナップショット作成時間ポイントが指定された時間範囲内にあり、準拠と見なされます。スナップショットの作成は一時的にブロックストレージの I/O パフォーマンスを低下させ、パフォーマンスの違いは一般的に 10% 以内で、短い瞬間的な速度低下を引き起こします。ビジネスのピーク時間を避ける時間ポイントを選択することをお勧めします。", "pt": "Os pontos de tempo de criação de instantâneos na política de instantâneos automáticos estão dentro do intervalo de tempo especificado, considerado conforme. Criar instantâneos reduz temporariamente o desempenho de E/S do armazenamento em bloco, com diferenças de desempenho geralmente dentro de 10%, causando lentidões breves. Recomenda-se selecionar pontos de tempo que evitem horários de pico de negócios.", "zh": "自动快照策略中设置的快照创建时间点在参数指定的时间点范围内,视为合规。创建快照会暂时降低块存储 I/O 性能,一般性能差异在 10%以内,出现短暂瞬间变慢。建议您选择避开业务高峰的时间点。"}, Reason: models.I18nString{"de": "Automatische Momentaufnahme-Richtlinien-Zeitpunkte sind möglicherweise nicht so konfiguriert, dass Geschäftsspitzenzeiten vermieden werden", "en": "Auto snapshot policy timepoints may not be configured to avoid business peak hours", "es": "Los puntos de tiempo de la política de instantáneas automáticas pueden no estar configurados para evitar las horas pico comerciales", "fr": "Les points temporels de la politique d'instantanés automatiques peuvent ne pas être configurés pour éviter les heures de pointe commerciales", "ja": "自動スナップショットポリシーの時間ポイントがビジネスのピーク時間を避けるように設定されていない可能性があります", "pt": "Os pontos de tempo da política de instantâneos automáticos podem não estar configurados para evitar horários de pico de negócios", "zh": "自动快照策略时间点可能未配置为避开业务高峰时段"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie Zeitpunkte für die Momentaufnahmeerstellung während der Nebenzeiten (z. B. 2:00-6:00 Uhr), um die Auswirkungen auf Geschäftsbetriebe zu minimieren", "en": "Configure snapshot creation timepoints during off-peak hours (e.g., 2:00-6:00 AM) to minimize impact on business operations", "es": "Configure puntos de tiempo de creación de instantáneas durante horas de menor actividad (por ejemplo, 2:00-6:00 AM) para minimizar el impacto en las operaciones comerciales", "fr": "Configurez les points temporels de création d'instantanés pendant les heures creuses (par exemple, 2h00-6h00) pour minimiser l'impact sur les opérations commerciales", "ja": "業務運営への影響を最小限に抑えるために、オフピーク時間（例：午前 2:00-6:00）にスナップショット作成時間ポイントを設定します", "pt": "Configure pontos de tempo de criação de instantâneos durante horários de menor movimento (por exemplo, 2:00-6:00) para minimizar o impacto nas operações comerciais", "zh": "将快照创建时间点配置在非高峰时段(如凌晨 2:00-6:00)以最小化对业务运营的影响"}, ResourceTypes: []string{"ALIYUN::ECS::AutoSnapshotPolicy"}, FilePath: "aliyun/rules/ecs-snapshot-policy-timepoints-check.rego", PackageName: "infraguard.rules.aliyun.ecs_snapshot_policy_timepoints_check", Content: "package infraguard.rules.aliyun.ecs_snapshot_policy_timepoints_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-snapshot-policy-timepoints-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ECS auto snapshot policy timepoints configured reasonably\",\n\t\t\"zh\": \"为自动快照策略设置合理的创建时间点\",\n\t\t\"ja\": \"ECS 自動スナップショットポリシーの時間ポイントが適切に設定されている\",\n\t\t\"de\": \"ECS-Automatische Momentaufnahme-Richtlinien-Zeitpunkte angemessen konfiguriert\",\n\t\t\"es\": \"Puntos de Tiempo de Política de Instantánea Automática ECS Configurados Razonablemente\",\n\t\t\"fr\": \"Points Temporels de Politique d'Instantané Automatique ECS Configurés Raisonnablement\",\n\t\t\"pt\": \"Pontos de Tempo da Política de Instantâneo Automático ECS Configurados Razoavelmente\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"The snapshot creation timepoints in the auto snapshot policy are within the specified time range, considered compliant. Creating snapshots temporarily reduces block storage I/O performance, with performance differences generally within 10%, causing brief slowdowns. It is recommended to select timepoints that avoid business peak hours.\",\n\t\t\"zh\": \"自动快照策略中设置的快照创建时间点在参数指定的时间点范围内,视为合规。创建快照会暂时降低块存储 I/O 性能,一般性能差异在 10%以内,出现短暂瞬间变慢。建议您选择避开业务高峰的时间点。\",\n\t\t\"ja\": \"自動スナップショットポリシーのスナップショット作成時間ポイントが指定された時間範囲内にあり、準拠と見なされます。スナップショットの作成は一時的にブロックストレージの I/O パフォーマンスを低下させ、パフォーマンスの違いは一般的に 10% 以内で、短い瞬間的な速度低下を引き起こします。ビジネスのピーク時間を避ける時間ポイントを選択することをお勧めします。\",\n\t\t\"de\": \"Die Zeitpunkte für die Momentaufnahmeerstellung in der automatischen Momentaufnahme-Richtlinie liegen innerhalb des angegebenen Zeitbereichs und gelten als konform. Das Erstellen von Momentaufnahmen reduziert vorübergehend die Block-Speicher-I/O-Leistung, wobei die Leistungsunterschiede im Allgemeinen innerhalb von 10% liegen und kurze Verlangsamungen verursachen. Es wird empfohlen, Zeitpunkte zu wählen, die Geschäftsspitzenzeiten vermeiden.\",\n\t\t\"es\": \"Los puntos de tiempo de creación de instantáneas en la política de instantáneas automáticas están dentro del rango de tiempo especificado, considerado conforme. Crear instantáneas reduce temporalmente el rendimiento de E/S del almacenamiento en bloque, con diferencias de rendimiento generalmente dentro del 10%, causando ralentizaciones breves. Se recomienda seleccionar puntos de tiempo que eviten las horas pico comerciales.\",\n\t\t\"fr\": \"Les points temporels de création d'instantanés dans la politique d'instantanés automatiques sont dans la plage de temps spécifiée, considérés comme conformes. La création d'instantanés réduit temporairement les performances d'E/S du stockage en bloc, avec des différences de performance généralement inférieures à 10%, provoquant de brefs ralentissements. Il est recommandé de sélectionner des points temporels qui évitent les heures de pointe commerciales.\",\n\t\t\"pt\": \"Os pontos de tempo de criação de instantâneos na política de instantâneos automáticos estão dentro do intervalo de tempo especificado, considerado conforme. Criar instantâneos reduz temporariamente o desempenho de E/S do armazenamento em bloco, com diferenças de desempenho geralmente dentro de 10%, causando lentidões breves. Recomenda-se selecionar pontos de tempo que evitem horários de pico de negócios.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Auto snapshot policy timepoints may not be configured to avoid business peak hours\",\n\t\t\"zh\": \"自动快照策略时间点可能未配置为避开业务高峰时段\",\n\t\t\"ja\": \"自動スナップショットポリシーの時間ポイントがビジネスのピーク時間を避けるように設定されていない可能性があります\",\n\t\t\"de\": \"Automatische Momentaufnahme-Richtlinien-Zeitpunkte sind möglicherweise nicht so konfiguriert, dass Geschäftsspitzenzeiten vermieden werden\",\n\t\t\"es\": \"Los puntos de tiempo de la política de instantáneas automáticas pueden no estar configurados para evitar las horas pico comerciales\",\n\t\t\"fr\": \"Les points temporels de la politique d'instantanés automatiques peuvent ne pas être configurés pour éviter les heures de pointe commerciales\",\n\t\t\"pt\": \"Os pontos de tempo da política de instantâneos automáticos podem não estar configurados para evitar horários de pico de negócios\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure snapshot creation timepoints during off-peak hours (e.g., 2:00-6:00 AM) to minimize impact on business operations\",\n\t\t\"zh\": \"将快照创建时间点配置在非高峰时段(如凌晨 2:00-6:00)以最小化对业务运营的影响\",\n\t\t\"ja\": \"業務運営への影響を最小限に抑えるために、オフピーク時間（例：午前 2:00-6:00）にスナップショット作成時間ポイントを設定します\",\n\t\t\"de\": \"Konfigurieren Sie Zeitpunkte für die Momentaufnahmeerstellung während der Nebenzeiten (z. B. 2:00-6:00 Uhr), um die Auswirkungen auf Geschäftsbetriebe zu minimieren\",\n\t\t\"es\": \"Configure puntos de tiempo de creación de instantáneas durante horas de menor actividad (por ejemplo, 2:00-6:00 AM) para minimizar el impacto en las operaciones comerciales\",\n\t\t\"fr\": \"Configurez les points temporels de création d'instantanés pendant les heures creuses (par exemple, 2h00-6h00) pour minimiser l'impact sur les opérations commerciales\",\n\t\t\"pt\": \"Configure pontos de tempo de criação de instantâneos durante horários de menor movimento (por exemplo, 2:00-6:00) para minimizar o impacto nas operações comerciais\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::AutoSnapshotPolicy\"]\n}\n\n# Recommended off-peak hours: 2:00-6:00 AM (hours 2-5)\nrecommended_timepoints := {2, 3, 4, 5}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::AutoSnapshotPolicy\")\n\n\t# Get configured timepoints\n\ttimepoints := helpers.get_property(resource, \"TimePoints\", [])\n\n\t# Check if any timepoint is outside recommended range\n\tsome point in timepoints\n\tnot point in recommended_timepoints\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TimePoints\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-snapshot-retention-days", Name: models.I18nString{"de": "ECS automatische Snapshot-Aufbewahrungstage erfüllen Anforderungen", "en": "ECS auto snapshot retention days meets requirements", "es": "Días de retención de snapshot automático ECS cumplen requisitos", "fr": "Jours de rétention de snapshot automatique ECS répondent aux exigences", "ja": "ECS 自動スナップショットの保持日数が要件を満たしている", "pt": "Dias de retenção de snapshot automático ECS atendem requisitos", "zh": "ECS 自动快照保留天数满足指定要求"}, Severity: "low", Description: models.I18nString{"de": "ECS automatische Snapshot-Richtlinie Aufbewahrungstage ist größer als die angegebene Anzahl von Tagen, wird als konform betrachtet. Standardwert: 7 Tage.", "en": "ECS auto snapshot policy retention days is greater than the specified number of days, considered compliant. Default value: 7 days.", "es": "Los días de retención de la política de snapshot automático ECS son mayores que el número especificado de días, considerado conforme. Valor predeterminado: 7 días.", "fr": "Les jours de rétention de la politique de snapshot automatique ECS sont supérieurs au nombre de jours spécifié, considéré comme conforme. Valeur par défaut: 7 jours.", "ja": "ECS 自動スナップショットポリシーの保持日数が指定された日数を超えている場合、準拠と見なされます。デフォルト値: 7 日。", "pt": "Os dias de retenção da política de snapshot automático ECS são maiores que o número especificado de dias, considerado conforme. Valor padrão: 7 dias.", "zh": "ECS 自动快照策略设置快照保留天数大于设置的天数,视为合规。默认值:7 天。"}, Reason: models.I18nString{"de": "Automatische Snapshot-Aufbewahrungstage sind weniger als die mindestens erforderlichen Tage (7 Tage)", "en": "Auto snapshot retention days is less than the minimum required days (7 days)", "es": "Los días de retención de snapshot automático son menores que los días mínimos requeridos (7 días)", "fr": "Les jours de rétention de snapshot automatique sont inférieurs aux jours minimum requis (7 jours)", "ja": "自動スナップショットの保持日数が最小要件日数（7 日）未満です", "pt": "Os dias de retenção de snapshot automático são menores que os dias mínimos necessários (7 dias)", "zh": "自动快照保留天数少于最低要求天数(7 天)"}, Recommendation: models.I18nString{"de": "Setzen Sie die automatischen Snapshot-Aufbewahrungstage auf mindestens 7 Tage, um eine angemessene Backup-Abdeckung sicherzustellen", "en": "Set auto snapshot retention days to at least 7 days to ensure adequate backup coverage", "es": "Establezca los días de retención de snapshot automático en al menos 7 días para asegurar una cobertura de respaldo adecuada", "fr": "Définissez les jours de rétention de snapshot automatique sur au moins 7 jours pour assurer une couverture de sauvegarde adéquate", "ja": "十分なバックアップカバレッジを確保するために、自動スナップショットの保持日数を少なくとも 7 日に設定します", "pt": "Defina os dias de retenção de snapshot automático para pelo menos 7 dias para garantir cobertura de backup adequada", "zh": "将自动快照保留天数设置为至少 7 天以确保足够的备份覆盖"}, ResourceTypes: []string{"ALIYUN::ECS::AutoSnapshotPolicy"}, FilePath: "aliyun/rules/ecs-snapshot-retention-days.rego", PackageName: "infraguard.rules.aliyun.ecs_snapshot_retention_days", Content: "package infraguard.rules.aliyun.ecs_snapshot_retention_days\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ecs-snapshot-retention-days\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS auto snapshot retention days meets requirements\",\n\t\t\"zh\": \"ECS 自动快照保留天数满足指定要求\",\n\t\t\"ja\": \"ECS 自動スナップショットの保持日数が要件を満たしている\",\n\t\t\"de\": \"ECS automatische Snapshot-Aufbewahrungstage erfüllen Anforderungen\",\n\t\t\"es\": \"Días de retención de snapshot automático ECS cumplen requisitos\",\n\t\t\"fr\": \"Jours de rétention de snapshot automatique ECS répondent aux exigences\",\n\t\t\"pt\": \"Dias de retenção de snapshot automático ECS atendem requisitos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ECS auto snapshot policy retention days is greater than the specified number of days, considered compliant. Default value: 7 days.\",\n\t\t\"zh\": \"ECS 自动快照策略设置快照保留天数大于设置的天数,视为合规。默认值:7 天。\",\n\t\t\"ja\": \"ECS 自動スナップショットポリシーの保持日数が指定された日数を超えている場合、準拠と見なされます。デフォルト値: 7 日。\",\n\t\t\"de\": \"ECS automatische Snapshot-Richtlinie Aufbewahrungstage ist größer als die angegebene Anzahl von Tagen, wird als konform betrachtet. Standardwert: 7 Tage.\",\n\t\t\"es\": \"Los días de retención de la política de snapshot automático ECS son mayores que el número especificado de días, considerado conforme. Valor predeterminado: 7 días.\",\n\t\t\"fr\": \"Les jours de rétention de la politique de snapshot automatique ECS sont supérieurs au nombre de jours spécifié, considéré comme conforme. Valeur par défaut: 7 jours.\",\n\t\t\"pt\": \"Os dias de retenção da política de snapshot automático ECS são maiores que o número especificado de dias, considerado conforme. Valor padrão: 7 dias.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Auto snapshot retention days is less than the minimum required days (7 days)\",\n\t\t\"zh\": \"自动快照保留天数少于最低要求天数(7 天)\",\n\t\t\"ja\": \"自動スナップショットの保持日数が最小要件日数（7 日）未満です\",\n\t\t\"de\": \"Automatische Snapshot-Aufbewahrungstage sind weniger als die mindestens erforderlichen Tage (7 Tage)\",\n\t\t\"es\": \"Los días de retención de snapshot automático son menores que los días mínimos requeridos (7 días)\",\n\t\t\"fr\": \"Les jours de rétention de snapshot automatique sont inférieurs aux jours minimum requis (7 jours)\",\n\t\t\"pt\": \"Os dias de retenção de snapshot automático são menores que os dias mínimos necessários (7 dias)\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set auto snapshot retention days to at least 7 days to ensure adequate backup coverage\",\n\t\t\"zh\": \"将自动快照保留天数设置为至少 7 天以确保足够的备份覆盖\",\n\t\t\"ja\": \"十分なバックアップカバレッジを確保するために、自動スナップショットの保持日数を少なくとも 7 日に設定します\",\n\t\t\"de\": \"Setzen Sie die automatischen Snapshot-Aufbewahrungstage auf mindestens 7 Tage, um eine angemessene Backup-Abdeckung sicherzustellen\",\n\t\t\"es\": \"Establezca los días de retención de snapshot automático en al menos 7 días para asegurar una cobertura de respaldo adecuada\",\n\t\t\"fr\": \"Définissez les jours de rétention de snapshot automatique sur au moins 7 jours pour assurer une couverture de sauvegarde adéquate\",\n\t\t\"pt\": \"Defina os dias de retenção de snapshot automático para pelo menos 7 dias para garantir cobertura de backup adequada\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::AutoSnapshotPolicy\"]\n}\n\n# Minimum retention days requirement\nmin_retention_days := 7\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::AutoSnapshotPolicy\")\n\n\t# Get retention days (-1 means permanent, which is compliant)\n\tretention_days := helpers.get_property(resource, \"RetentionDays\", 0)\n\n\t# Check if retention is less than minimum (but not -1 for permanent)\n\tretention_days != -1\n\tretention_days < min_retention_days\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"RetentionDays\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ecs-system-disk-size-check", Name: models.I18nString{"de": "ECS-Systemfestplatten-Größenprüfung", "en": "ECS System Disk Size Check", "es": "Verificación de Tamaño de Disco del Sistema ECS", "fr": "Vérification de la Taille du Disque Système ECS", "ja": "ECS システムディスクサイズチェック", "pt": "Verificação de Tamanho do Disco do Sistema ECS", "zh": "ECS 系统盘大小检查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass ECS-Systemfestplatten die Mindestgrößenanforderung erfüllen.", "en": "Ensures ECS system disks meet the minimum required size.", "es": "Garantiza que los discos del sistema ECS cumplan con el tamaño mínimo requerido.", "fr": "Garantit que les disques système ECS répondent à la taille minimale requise.", "ja": "ECS システムディスクが最小要件サイズを満たしていることを確認します。", "pt": "Garante que os discos do sistema ECS atendam ao tamanho mínimo necessário.", "zh": "确保 ECS 系统盘满足最低大小要求。"}, Reason: models.I18nString{"de": "Zu kleine Systemfestplatten können keinen Speicherplatz mehr haben, was zu Systeminstabilität führt.", "en": "System disks that are too small may run out of space, causing system instability.", "es": "Los discos del sistema que son demasiado pequeños pueden quedarse sin espacio, causando inestabilidad del sistema.", "fr": "Les disques système trop petits peuvent manquer d'espace, provoquant une instabilité du système.", "ja": "小さすぎるシステムディスクは容量不足になり、システムの不安定性を引き起こす可能性があります。", "pt": "Discos do sistema muito pequenos podem ficar sem espaço, causando instabilidade do sistema.", "zh": "系统盘过小可能导致空间耗尽，引发系统不稳定。"}, Recommendation: models.I18nString{"de": "Erhöhen Sie die Systemfestplattengröße auf mindestens 40 GB.", "en": "Increase the system disk size to at least 40GB.", "es": "Aumente el tamaño del disco del sistema a al menos 40 GB.", "fr": "Augmentez la taille du disque système à au moins 40 Go.", "ja": "システムディスクサイズを少なくとも 40GB に増やします。", "pt": "Aumente o tamanho do disco do sistema para pelo menos 40 GB.", "zh": "将系统盘大小增加到至少 40GB。"}, ResourceTypes: []string{"ALIYUN::ECS::Instance", "ALIYUN::ECS::InstanceGroup"}, FilePath: "aliyun/rules/ecs-system-disk-size-check.rego", PackageName: "infraguard.rules.aliyun.ecs_system_disk_size_check", Content: "package infraguard.rules.aliyun.ecs_system_disk_size_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ecs-system-disk-size-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"ECS System Disk Size Check\",\n\t\t\"zh\": \"ECS 系统盘大小检查\",\n\t\t\"ja\": \"ECS システムディスクサイズチェック\",\n\t\t\"de\": \"ECS-Systemfestplatten-Größenprüfung\",\n\t\t\"es\": \"Verificación de Tamaño de Disco del Sistema ECS\",\n\t\t\"fr\": \"Vérification de la Taille du Disque Système ECS\",\n\t\t\"pt\": \"Verificação de Tamanho do Disco do Sistema ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures ECS system disks meet the minimum required size.\",\n\t\t\"zh\": \"确保 ECS 系统盘满足最低大小要求。\",\n\t\t\"ja\": \"ECS システムディスクが最小要件サイズを満たしていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ECS-Systemfestplatten die Mindestgrößenanforderung erfüllen.\",\n\t\t\"es\": \"Garantiza que los discos del sistema ECS cumplan con el tamaño mínimo requerido.\",\n\t\t\"fr\": \"Garantit que les disques système ECS répondent à la taille minimale requise.\",\n\t\t\"pt\": \"Garante que os discos do sistema ECS atendam ao tamanho mínimo necessário.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"System disks that are too small may run out of space, causing system instability.\",\n\t\t\"zh\": \"系统盘过小可能导致空间耗尽，引发系统不稳定。\",\n\t\t\"ja\": \"小さすぎるシステムディスクは容量不足になり、システムの不安定性を引き起こす可能性があります。\",\n\t\t\"de\": \"Zu kleine Systemfestplatten können keinen Speicherplatz mehr haben, was zu Systeminstabilität führt.\",\n\t\t\"es\": \"Los discos del sistema que son demasiado pequeños pueden quedarse sin espacio, causando inestabilidad del sistema.\",\n\t\t\"fr\": \"Les disques système trop petits peuvent manquer d'espace, provoquant une instabilité du système.\",\n\t\t\"pt\": \"Discos do sistema muito pequenos podem ficar sem espaço, causando instabilidade do sistema.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Increase the system disk size to at least 40GB.\",\n\t\t\"zh\": \"将系统盘大小增加到至少 40GB。\",\n\t\t\"ja\": \"システムディスクサイズを少なくとも 40GB に増やします。\",\n\t\t\"de\": \"Erhöhen Sie die Systemfestplattengröße auf mindestens 40 GB.\",\n\t\t\"es\": \"Aumente el tamaño del disco del sistema a al menos 40 GB.\",\n\t\t\"fr\": \"Augmentez la taille du disque système à au moins 40 Go.\",\n\t\t\"pt\": \"Aumente o tamanho do disco do sistema para pelo menos 40 GB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"]\n}\n\nis_compliant(resource) if {\n\tsize := helpers.get_property(resource, \"SystemDiskSize\", 40)\n\tsize >= 40\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SystemDiskSize\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:eip-attached", Name: models.I18nString{"de": "EIP angehängt", "en": "EIP Attached", "es": "EIP Adjunto", "fr": "EIP Attaché", "ja": "EIP がアタッチされている", "pt": "EIP Anexado", "zh": "EIP 必须处于绑定状态"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass EIP-Instanzen einer Ressource zugeordnet sind.", "en": "Ensures that EIP instances are associated with a resource.", "es": "Garantiza que las instancias EIP estén asociadas con un recurso.", "fr": "Garantit que les instances EIP sont associées à une ressource.", "ja": "EIP インスタンスがリソースに関連付けられていることを確認します。", "pt": "Garante que as instâncias EIP estejam associadas a um recurso.", "zh": "确保 EIP 实例已与资源关联。"}, Reason: models.I18nString{"de": "Nicht angehängte EIPs verursachen Kosten, ohne einen Dienst bereitzustellen.", "en": "Unattached EIPs incur costs without providing any service.", "es": "Los EIP no adjuntos incurren en costos sin proporcionar ningún servicio.", "fr": "Les EIP non attachés entraînent des coûts sans fournir de service.", "ja": "アタッチされていない EIP は、サービスを提供せずにコストが発生します。", "pt": "EIPs não anexados incorrem em custos sem fornecer nenhum serviço.", "zh": "未绑定的 EIP 会产生费用，但未提供任何服务。"}, Recommendation: models.I18nString{"de": "Ordnen Sie die EIP einer ECS-Instanz, einem NAT-Gateway oder einem Load Balancer zu.", "en": "Associate the EIP with an ECS instance, NAT Gateway, or Load Balancer.", "es": "Asocie el EIP con una instancia ECS, puerta de enlace NAT o equilibrador de carga.", "fr": "Associez l'EIP à une instance ECS, une passerelle NAT ou un équilibreur de charge.", "ja": "EIP を ECS インスタンス、NAT ゲートウェイ、またはロードバランサーに関連付けます。", "pt": "Associe o EIP a uma instância ECS, Gateway NAT ou Load Balancer.", "zh": "将 EIP 与 ECS 实例、NAT 网关或负载均衡器关联。"}, ResourceTypes: []string{"ALIYUN::VPC::EIP"}, FilePath: "aliyun/rules/eip-attached.rego", PackageName: "infraguard.rules.aliyun.eip_attached", Content: "package infraguard.rules.aliyun.eip_attached\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"eip-attached\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"EIP Attached\",\n\t\t\"zh\": \"EIP 必须处于绑定状态\",\n\t\t\"ja\": \"EIP がアタッチされている\",\n\t\t\"de\": \"EIP angehängt\",\n\t\t\"es\": \"EIP Adjunto\",\n\t\t\"fr\": \"EIP Attaché\",\n\t\t\"pt\": \"EIP Anexado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that EIP instances are associated with a resource.\",\n\t\t\"zh\": \"确保 EIP 实例已与资源关联。\",\n\t\t\"ja\": \"EIP インスタンスがリソースに関連付けられていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass EIP-Instanzen einer Ressource zugeordnet sind.\",\n\t\t\"es\": \"Garantiza que las instancias EIP estén asociadas con un recurso.\",\n\t\t\"fr\": \"Garantit que les instances EIP sont associées à une ressource.\",\n\t\t\"pt\": \"Garante que as instâncias EIP estejam associadas a um recurso.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Unattached EIPs incur costs without providing any service.\",\n\t\t\"zh\": \"未绑定的 EIP 会产生费用，但未提供任何服务。\",\n\t\t\"ja\": \"アタッチされていない EIP は、サービスを提供せずにコストが発生します。\",\n\t\t\"de\": \"Nicht angehängte EIPs verursachen Kosten, ohne einen Dienst bereitzustellen.\",\n\t\t\"es\": \"Los EIP no adjuntos incurren en costos sin proporcionar ningún servicio.\",\n\t\t\"fr\": \"Les EIP non attachés entraînent des coûts sans fournir de service.\",\n\t\t\"pt\": \"EIPs não anexados incorrem em custos sem fornecer nenhum serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Associate the EIP with an ECS instance, NAT Gateway, or Load Balancer.\",\n\t\t\"zh\": \"将 EIP 与 ECS 实例、NAT 网关或负载均衡器关联。\",\n\t\t\"ja\": \"EIP を ECS インスタンス、NAT ゲートウェイ、またはロードバランサーに関連付けます。\",\n\t\t\"de\": \"Ordnen Sie die EIP einer ECS-Instanz, einem NAT-Gateway oder einem Load Balancer zu.\",\n\t\t\"es\": \"Asocie el EIP con una instancia ECS, puerta de enlace NAT o equilibrador de carga.\",\n\t\t\"fr\": \"Associez l'EIP à une instance ECS, une passerelle NAT ou un équilibreur de charge.\",\n\t\t\"pt\": \"Associe o EIP a uma instância ECS, Gateway NAT ou Load Balancer.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::EIP\"]\n}\n\n# In ROS, attachment is usually done via ALIYUN::VPC::EIPAssociation\nis_attached(eip_id) if {\n\tsome name, res in helpers.resources_by_type(\"ALIYUN::VPC::EIPAssociation\")\n\thelpers.is_referencing(helpers.get_property(res, \"AllocationId\", \"\"), eip_id)\n}\n\ndeny contains result if {\n\tsome eip_id, resource in helpers.resources_by_type(\"ALIYUN::VPC::EIP\")\n\tnot is_attached(eip_id)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": eip_id,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:eip-bandwidth-limit", Name: models.I18nString{"de": "EIP-Bandbreitenlimit", "en": "EIP Bandwidth Limit", "es": "Límite de Ancho de Banda EIP", "fr": "Limite de Bande Passante EIP", "ja": "EIP 帯域幅制限", "pt": "Limite de Largura de Banda EIP", "zh": "EIP 带宽上限核查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass die EIP-Bandbreite einen angegebenen Maximalwert nicht überschreitet.", "en": "Ensures EIP bandwidth does not exceed a specified maximum value.", "es": "Garantiza que el ancho de banda EIP no exceda un valor máximo especificado.", "fr": "Garantit que la bande passante EIP ne dépasse pas une valeur maximale spécifiée.", "ja": "EIP 帯域幅が指定された最大値を超えないことを確認します。", "pt": "Garante que a largura de banda EIP não exceda um valor máximo especificado.", "zh": "确保 EIP 带宽不超过指定的最高值。"}, Reason: models.I18nString{"de": "Übermäßige Bandbreiteneinstellungen können zu höheren als erwarteten Kosten führen.", "en": "Excessive bandwidth settings can lead to higher than expected costs.", "es": "Las configuraciones de ancho de banda excesivas pueden llevar a costos más altos de lo esperado.", "fr": "Des paramètres de bande passante excessifs peuvent entraîner des coûts plus élevés que prévu.", "ja": "過剰な帯域幅設定により、予想以上のコストが発生する可能性があります。", "pt": "Configurações excessivas de largura de banda podem levar a custos mais altos do que o esperado.", "zh": "过高的带宽设置可能导致超出预期的成本。"}, Recommendation: models.I18nString{"de": "Setzen Sie die EIP-Bandbreite auf einen angemessenen Wert (z. B. bis zu 100 Mbps).", "en": "Set EIP bandwidth to a reasonable value (e.g., up to 100Mbps).", "es": "Establezca el ancho de banda EIP en un valor razonable (por ejemplo, hasta 100 Mbps).", "fr": "Définissez la bande passante EIP à une valeur raisonnable (par exemple, jusqu'à 100 Mbps).", "ja": "EIP 帯域幅を合理的な値（例：100Mbps まで）に設定します。", "pt": "Defina a largura de banda EIP para um valor razoável (por exemplo, até 100 Mbps).", "zh": "将 EIP 带宽设置为合理的值（如不超过 100Mbps）。"}, ResourceTypes: []string{"ALIYUN::VPC::EIP"}, FilePath: "aliyun/rules/eip-bandwidth-limit.rego", PackageName: "infraguard.rules.aliyun.eip_bandwidth_limit", Content: "package infraguard.rules.aliyun.eip_bandwidth_limit\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"eip-bandwidth-limit\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"EIP Bandwidth Limit\",\n\t\t\"zh\": \"EIP 带宽上限核查\",\n\t\t\"ja\": \"EIP 帯域幅制限\",\n\t\t\"de\": \"EIP-Bandbreitenlimit\",\n\t\t\"es\": \"Límite de Ancho de Banda EIP\",\n\t\t\"fr\": \"Limite de Bande Passante EIP\",\n\t\t\"pt\": \"Limite de Largura de Banda EIP\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures EIP bandwidth does not exceed a specified maximum value.\",\n\t\t\"zh\": \"确保 EIP 带宽不超过指定的最高值。\",\n\t\t\"ja\": \"EIP 帯域幅が指定された最大値を超えないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die EIP-Bandbreite einen angegebenen Maximalwert nicht überschreitet.\",\n\t\t\"es\": \"Garantiza que el ancho de banda EIP no exceda un valor máximo especificado.\",\n\t\t\"fr\": \"Garantit que la bande passante EIP ne dépasse pas une valeur maximale spécifiée.\",\n\t\t\"pt\": \"Garante que a largura de banda EIP não exceda um valor máximo especificado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Excessive bandwidth settings can lead to higher than expected costs.\",\n\t\t\"zh\": \"过高的带宽设置可能导致超出预期的成本。\",\n\t\t\"ja\": \"過剰な帯域幅設定により、予想以上のコストが発生する可能性があります。\",\n\t\t\"de\": \"Übermäßige Bandbreiteneinstellungen können zu höheren als erwarteten Kosten führen.\",\n\t\t\"es\": \"Las configuraciones de ancho de banda excesivas pueden llevar a costos más altos de lo esperado.\",\n\t\t\"fr\": \"Des paramètres de bande passante excessifs peuvent entraîner des coûts plus élevés que prévu.\",\n\t\t\"pt\": \"Configurações excessivas de largura de banda podem levar a custos mais altos do que o esperado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set EIP bandwidth to a reasonable value (e.g., up to 100Mbps).\",\n\t\t\"zh\": \"将 EIP 带宽设置为合理的值（如不超过 100Mbps）。\",\n\t\t\"ja\": \"EIP 帯域幅を合理的な値（例：100Mbps まで）に設定します。\",\n\t\t\"de\": \"Setzen Sie die EIP-Bandbreite auf einen angemessenen Wert (z. B. bis zu 100 Mbps).\",\n\t\t\"es\": \"Establezca el ancho de banda EIP en un valor razonable (por ejemplo, hasta 100 Mbps).\",\n\t\t\"fr\": \"Définissez la bande passante EIP à une valeur raisonnable (par exemple, jusqu'à 100 Mbps).\",\n\t\t\"pt\": \"Defina a largura de banda EIP para um valor razoável (por exemplo, até 100 Mbps).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::EIP\"]\n}\n\nis_compliant(resource) if {\n\tbandwidth := helpers.get_property(resource, \"Bandwidth\", 5)\n\tbandwidth <= 100\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::VPC::EIP\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Bandwidth\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:eip-delete-protection-enabled", Name: models.I18nString{"de": "EIP-Löschschutz aktiviert", "en": "EIP Deletion Protection Enabled", "es": "Protección de Eliminación de EIP Habilitada", "fr": "Protection contre la Suppression EIP Activée", "ja": "EIP 削除保護が有効", "pt": "Proteção de Exclusão de EIP Habilitada", "zh": "弹性公网 IP 开启删除保护"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass EIP-Instanzen Löschschutz aktiviert haben.", "en": "Ensures that EIP instances have deletion protection enabled.", "es": "Garantiza que las instancias EIP tengan protección de eliminación habilitada.", "fr": "Garantit que les instances EIP ont la protection contre la suppression activée.", "ja": "EIP インスタンスで削除保護が有効になっていることを確認します。", "pt": "Garante que as instâncias EIP tenham proteção de exclusão habilitada.", "zh": "确保弹性公网 IP 开启了删除保护。"}, Reason: models.I18nString{"de": "Wenn der Löschschutz nicht aktiviert ist, kann die EIP versehentlich freigegeben werden, was möglicherweise die öffentliche IP Ihrer Dienste ändert.", "en": "If deletion protection is not enabled, the EIP may be released accidentally, potentially changing the public IP of your services.", "es": "Si la protección de eliminación no está habilitada, la EIP puede liberarse accidentalmente, cambiando potencialmente la IP pública de sus servicios.", "fr": "Si la protection contre la suppression n'est pas activée, l'EIP peut être libérée accidentellement, ce qui peut modifier l'IP publique de vos services.", "ja": "削除保護が有効になっていない場合、EIP が誤って解放され、サービスのパブリック IP が変更される可能性があります。", "pt": "Se a proteção de exclusão não estiver habilitada, o EIP pode ser liberado acidentalmente, potencialmente alterando o IP público dos seus serviços.", "zh": "如果未开启删除保护，弹性公网 IP 可能会被意外释放，从而可能导致您的服务公网 IP 发生变化。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für die EIP-Instanz.", "en": "Enable deletion protection for the EIP instance.", "es": "Habilite la protección de eliminación para la instancia EIP.", "fr": "Activez la protection contre la suppression pour l'instance EIP.", "ja": "EIP インスタンスの削除保護を有効にします。", "pt": "Habilite a proteção de exclusão para a instância EIP.", "zh": "为弹性公网 IP 开启删除保护功能。"}, ResourceTypes: []string{"ALIYUN::VPC::EIP"}, FilePath: "aliyun/rules/eip-delete-protection-enabled.rego", PackageName: "infraguard.rules.aliyun.eip_delete_protection_enabled", Content: "package infraguard.rules.aliyun.eip_delete_protection_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"eip-delete-protection-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"EIP Deletion Protection Enabled\",\n\t\t\"zh\": \"弹性公网 IP 开启删除保护\",\n\t\t\"ja\": \"EIP 削除保護が有効\",\n\t\t\"de\": \"EIP-Löschschutz aktiviert\",\n\t\t\"es\": \"Protección de Eliminación de EIP Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression EIP Activée\",\n\t\t\"pt\": \"Proteção de Exclusão de EIP Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that EIP instances have deletion protection enabled.\",\n\t\t\"zh\": \"确保弹性公网 IP 开启了删除保护。\",\n\t\t\"ja\": \"EIP インスタンスで削除保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass EIP-Instanzen Löschschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias EIP tengan protección de eliminación habilitada.\",\n\t\t\"fr\": \"Garantit que les instances EIP ont la protection contre la suppression activée.\",\n\t\t\"pt\": \"Garante que as instâncias EIP tenham proteção de exclusão habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If deletion protection is not enabled, the EIP may be released accidentally, potentially changing the public IP of your services.\",\n\t\t\"zh\": \"如果未开启删除保护，弹性公网 IP 可能会被意外释放，从而可能导致您的服务公网 IP 发生变化。\",\n\t\t\"ja\": \"削除保護が有効になっていない場合、EIP が誤って解放され、サービスのパブリック IP が変更される可能性があります。\",\n\t\t\"de\": \"Wenn der Löschschutz nicht aktiviert ist, kann die EIP versehentlich freigegeben werden, was möglicherweise die öffentliche IP Ihrer Dienste ändert.\",\n\t\t\"es\": \"Si la protección de eliminación no está habilitada, la EIP puede liberarse accidentalmente, cambiando potencialmente la IP pública de sus servicios.\",\n\t\t\"fr\": \"Si la protection contre la suppression n'est pas activée, l'EIP peut être libérée accidentellement, ce qui peut modifier l'IP publique de vos services.\",\n\t\t\"pt\": \"Se a proteção de exclusão não estiver habilitada, o EIP pode ser liberado acidentalmente, potencialmente alterando o IP público dos seus serviços.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for the EIP instance.\",\n\t\t\"zh\": \"为弹性公网 IP 开启删除保护功能。\",\n\t\t\"ja\": \"EIP インスタンスの削除保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für die EIP-Instanz.\",\n\t\t\"es\": \"Habilite la protección de eliminación para la instancia EIP.\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour l'instance EIP.\",\n\t\t\"pt\": \"Habilite a proteção de exclusão para a instância EIP.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::EIP\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::VPC::EIP\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:elasticsearch-instance-enabled-data-node-encryption", Name: models.I18nString{"de": "Elasticsearch-Datenknoten-Verschlüsselung aktiviert", "en": "Elasticsearch Data Node Encryption Enabled", "es": "Cifrado de Nodo de Datos de Elasticsearch Habilitado", "fr": "Chiffrement du Nœud de Données Elasticsearch Activé", "ja": "Elasticsearch データノード暗号化が有効", "pt": "Criptografia de Nó de Dados do Elasticsearch Habilitada", "zh": "Elasticsearch 数据节点开启加密"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Datenknoten in der Elasticsearch-Instanz Disk-Verschlüsselung aktiviert haben.", "en": "Ensures that data nodes in the Elasticsearch instance have disk encryption enabled.", "es": "Garantiza que los nodos de datos en la instancia de Elasticsearch tengan cifrado de disco habilitado.", "fr": "Garantit que les nœuds de données dans l'instance Elasticsearch ont le chiffrement de disque activé.", "ja": "Elasticsearch インスタンス内のデータノードでディスク暗号化が有効になっていることを確認します。", "pt": "Garante que os nós de dados na instância do Elasticsearch tenham criptografia de disco habilitada.", "zh": "确保 Elasticsearch 实例中的数据节点已开启磁盘加密。"}, Reason: models.I18nString{"de": "Disk-Verschlüsselung schützt sensible Daten, die auf Elasticsearch-Knoten gespeichert sind.", "en": "Disk encryption protects sensitive data stored on Elasticsearch nodes.", "es": "El cifrado de disco protege los datos sensibles almacenados en los nodos de Elasticsearch.", "fr": "Le chiffrement de disque protège les données sensibles stockées sur les nœuds Elasticsearch.", "ja": "ディスク暗号化により、Elasticsearch ノードに保存されている機密データが保護されます。", "pt": "A criptografia de disco protege dados sensíveis armazenados nos nós do Elasticsearch.", "zh": "磁盘加密可保护存储在 Elasticsearch 节点上的敏感数据。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Disk-Verschlüsselung für die Datenknoten der Elasticsearch-Instanz.", "en": "Enable disk encryption for the Elasticsearch instance data nodes.", "es": "Habilite el cifrado de disco para los nodos de datos de la instancia de Elasticsearch.", "fr": "Activez le chiffrement de disque pour les nœuds de données de l'instance Elasticsearch.", "ja": "Elasticsearch インスタンスのデータノードでディスク暗号化を有効にします。", "pt": "Habilite a criptografia de disco para os nós de dados da instância do Elasticsearch.", "zh": "为 Elasticsearch 实例数据节点开启磁盘加密。"}, ResourceTypes: []string{"ALIYUN::Elasticsearch::Instance"}, FilePath: "aliyun/rules/elasticsearch-instance-enabled-data-node-encryption.rego", PackageName: "infraguard.rules.aliyun.elasticsearch_instance_enabled_data_node_encryption", Content: "package infraguard.rules.aliyun.elasticsearch_instance_enabled_data_node_encryption\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"elasticsearch-instance-enabled-data-node-encryption\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Elasticsearch Data Node Encryption Enabled\",\n\t\t\"zh\": \"Elasticsearch 数据节点开启加密\",\n\t\t\"ja\": \"Elasticsearch データノード暗号化が有効\",\n\t\t\"de\": \"Elasticsearch-Datenknoten-Verschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado de Nodo de Datos de Elasticsearch Habilitado\",\n\t\t\"fr\": \"Chiffrement du Nœud de Données Elasticsearch Activé\",\n\t\t\"pt\": \"Criptografia de Nó de Dados do Elasticsearch Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that data nodes in the Elasticsearch instance have disk encryption enabled.\",\n\t\t\"zh\": \"确保 Elasticsearch 实例中的数据节点已开启磁盘加密。\",\n\t\t\"ja\": \"Elasticsearch インスタンス内のデータノードでディスク暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Datenknoten in der Elasticsearch-Instanz Disk-Verschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los nodos de datos en la instancia de Elasticsearch tengan cifrado de disco habilitado.\",\n\t\t\"fr\": \"Garantit que les nœuds de données dans l'instance Elasticsearch ont le chiffrement de disque activé.\",\n\t\t\"pt\": \"Garante que os nós de dados na instância do Elasticsearch tenham criptografia de disco habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Disk encryption protects sensitive data stored on Elasticsearch nodes.\",\n\t\t\"zh\": \"磁盘加密可保护存储在 Elasticsearch 节点上的敏感数据。\",\n\t\t\"ja\": \"ディスク暗号化により、Elasticsearch ノードに保存されている機密データが保護されます。\",\n\t\t\"de\": \"Disk-Verschlüsselung schützt sensible Daten, die auf Elasticsearch-Knoten gespeichert sind.\",\n\t\t\"es\": \"El cifrado de disco protege los datos sensibles almacenados en los nodos de Elasticsearch.\",\n\t\t\"fr\": \"Le chiffrement de disque protège les données sensibles stockées sur les nœuds Elasticsearch.\",\n\t\t\"pt\": \"A criptografia de disco protege dados sensíveis armazenados nos nós do Elasticsearch.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable disk encryption for the Elasticsearch instance data nodes.\",\n\t\t\"zh\": \"为 Elasticsearch 实例数据节点开启磁盘加密。\",\n\t\t\"ja\": \"Elasticsearch インスタンスのデータノードでディスク暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Disk-Verschlüsselung für die Datenknoten der Elasticsearch-Instanz.\",\n\t\t\"es\": \"Habilite el cifrado de disco para los nodos de datos de la instancia de Elasticsearch.\",\n\t\t\"fr\": \"Activez le chiffrement de disque pour les nœuds de données de l'instance Elasticsearch.\",\n\t\t\"pt\": \"Habilite a criptografia de disco para os nós de dados da instância do Elasticsearch.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::Elasticsearch::Instance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::Elasticsearch::Instance\")\n\n\t# Conceptual check for disk encryption\n\tnot helpers.has_property(resource, \"EncryptionAtRest\") # Simplified\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:elasticsearch-instance-enabled-kibana-public-check", Name: models.I18nString{"de": "Elasticsearch-Instanz Kibana aktiviert keinen öffentlichen Zugriff", "en": "Elasticsearch Instance Kibana Does Not Enable Public Access", "es": "La Instancia de Elasticsearch Kibana No Habilita el Acceso Público", "fr": "L'Instance Elasticsearch Kibana N'Active Pas l'Accès Public", "ja": "Elasticsearch インスタンス Kibana がパブリックアクセスを有効にしていない", "pt": "A Instância do Elasticsearch Kibana Não Habilita o Acesso Público", "zh": "Elasticsearch 实例 Kibana 未开启公网访问"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Elasticsearch-Instanz Kibana nicht von öffentlichen Netzwerken aus zugänglich ist.", "en": "Ensures that Elasticsearch instance Kibana is not accessible from public networks.", "es": "Garantiza que la instancia de Elasticsearch Kibana no sea accesible desde redes públicas.", "fr": "Garantit que l'instance Elasticsearch Kibana n'est pas accessible depuis les réseaux publics.", "ja": "Elasticsearch インスタンス Kibana がパブリックネットワークからアクセスできないことを確認します。", "pt": "Garante que a instância do Elasticsearch Kibana não seja acessível a partir de redes públicas.", "zh": "Elasticsearch 实例 Kibana 未开启公网访问，视为合规。"}, Reason: models.I18nString{"de": "Elasticsearch-Instanz Kibana ist von öffentlichen Netzwerken aus zugänglich, was ein Sicherheitsrisiko darstellt.", "en": "Elasticsearch instance Kibana is accessible from public network, which is a security risk.", "es": "La instancia de Elasticsearch Kibana es accesible desde la red pública, lo cual es un riesgo de seguridad.", "fr": "L'instance Elasticsearch Kibana est accessible depuis le réseau public, ce qui constitue un risque de sécurité.", "ja": "Elasticsearch インスタンス Kibana がパブリックネットワークからアクセス可能で、セキュリティリスクがあります。", "pt": "A instância do Elasticsearch Kibana é acessível a partir da rede pública, o que é um risco de segurança.", "zh": "Elasticsearch 实例 Kibana 开启公网访问，存在安全风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie Kibana so, dass nur Zugriff von VPC oder bestimmten IPs erlaubt ist.", "en": "Configure Kibana to only allow access from VPC or specific IPs.", "es": "Configure Kibana para permitir acceso solo desde VPC o IPs específicos.", "fr": "Configurez Kibana pour n'autoriser l'accès qu'à partir du VPC ou d'IP spécifiques.", "ja": "Kibana を VPC または特定の IP からのアクセスのみを許可するように設定します。", "pt": "Configure Kibana para permitir acesso apenas de VPC ou IPs específicos.", "zh": "请配置 Kibana 仅允许 VPC 或特定 IP 访问。"}, ResourceTypes: []string{"ALIYUN::ElasticSearch::Instance"}, FilePath: "aliyun/rules/elasticsearch-instance-enabled-kibana-public-check.rego", PackageName: "infraguard.rules.aliyun.elasticsearch_instance_enabled_kibana_public_check", Content: "package infraguard.rules.aliyun.elasticsearch_instance_enabled_kibana_public_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"elasticsearch-instance-enabled-kibana-public-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Elasticsearch Instance Kibana Does Not Enable Public Access\",\n\t\t\"zh\": \"Elasticsearch 实例 Kibana 未开启公网访问\",\n\t\t\"ja\": \"Elasticsearch インスタンス Kibana がパブリックアクセスを有効にしていない\",\n\t\t\"de\": \"Elasticsearch-Instanz Kibana aktiviert keinen öffentlichen Zugriff\",\n\t\t\"es\": \"La Instancia de Elasticsearch Kibana No Habilita el Acceso Público\",\n\t\t\"fr\": \"L'Instance Elasticsearch Kibana N'Active Pas l'Accès Public\",\n\t\t\"pt\": \"A Instância do Elasticsearch Kibana Não Habilita o Acesso Público\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Elasticsearch instance Kibana is not accessible from public networks.\",\n\t\t\"zh\": \"Elasticsearch 实例 Kibana 未开启公网访问，视为合规。\",\n\t\t\"ja\": \"Elasticsearch インスタンス Kibana がパブリックネットワークからアクセスできないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Elasticsearch-Instanz Kibana nicht von öffentlichen Netzwerken aus zugänglich ist.\",\n\t\t\"es\": \"Garantiza que la instancia de Elasticsearch Kibana no sea accesible desde redes públicas.\",\n\t\t\"fr\": \"Garantit que l'instance Elasticsearch Kibana n'est pas accessible depuis les réseaux publics.\",\n\t\t\"pt\": \"Garante que a instância do Elasticsearch Kibana não seja acessível a partir de redes públicas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Elasticsearch instance Kibana is accessible from public network, which is a security risk.\",\n\t\t\"zh\": \"Elasticsearch 实例 Kibana 开启公网访问，存在安全风险。\",\n\t\t\"ja\": \"Elasticsearch インスタンス Kibana がパブリックネットワークからアクセス可能で、セキュリティリスクがあります。\",\n\t\t\"de\": \"Elasticsearch-Instanz Kibana ist von öffentlichen Netzwerken aus zugänglich, was ein Sicherheitsrisiko darstellt.\",\n\t\t\"es\": \"La instancia de Elasticsearch Kibana es accesible desde la red pública, lo cual es un riesgo de seguridad.\",\n\t\t\"fr\": \"L'instance Elasticsearch Kibana est accessible depuis le réseau public, ce qui constitue un risque de sécurité.\",\n\t\t\"pt\": \"A instância do Elasticsearch Kibana é acessível a partir da rede pública, o que é um risco de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure Kibana to only allow access from VPC or specific IPs.\",\n\t\t\"zh\": \"请配置 Kibana 仅允许 VPC 或特定 IP 访问。\",\n\t\t\"ja\": \"Kibana を VPC または特定の IP からのアクセスのみを許可するように設定します。\",\n\t\t\"de\": \"Konfigurieren Sie Kibana so, dass nur Zugriff von VPC oder bestimmten IPs erlaubt ist.\",\n\t\t\"es\": \"Configure Kibana para permitir acceso solo desde VPC o IPs específicos.\",\n\t\t\"fr\": \"Configurez Kibana pour n'autoriser l'accès qu'à partir du VPC ou d'IP spécifiques.\",\n\t\t\"pt\": \"Configure Kibana para permitir acesso apenas de VPC ou IPs específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ElasticSearch::Instance\"]\n}\n\n# Check if Kibana public access is enabled\nis_kibana_public_access_enabled(resource) if {\n\tresource.Properties.KibanaPublicNetworkAccess == true\n}\n\nis_kibana_public_access_enabled(resource) if {\n\tcount(resource.Properties.KibanaWhitelist) > 0\n\t\"0.0.0.0/0\" in resource.Properties.KibanaWhitelist\n}\n\nis_kibana_public_access_enabled(resource) if {\n\tcount(resource.Properties.KibanaWhitelist) > 0\n\t\"0.0.0.0\" in resource.Properties.KibanaWhitelist\n}\n\nis_kibana_public_access_enabled(resource) if {\n\tresource.Properties.KibanaWhitelist == \"0.0.0.0/0\"\n}\n\nis_kibana_public_access_enabled(resource) if {\n\tresource.Properties.KibanaWhitelist == \"0.0.0.0\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ElasticSearch::Instance\")\n\tis_kibana_public_access_enabled(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"KibanaPublicNetworkAccess\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:elasticsearch-instance-enabled-node-config-disk-encryption", Name: models.I18nString{"de": "ES-Knoten-Konfiguration Festplattenverschlüsselung", "en": "ES Node Config Disk Encryption", "es": "Cifrado de Disco de Configuración de Nodo ES", "fr": "Chiffrement de Disque de Configuration de Nœud ES", "ja": "ES エラスティックノードディスク暗号化", "pt": "Criptografia de Disco de Configuração de Nó ES", "zh": "ES 弹性节点磁盘加密核查"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Elasticsearch-Elastikknoten-Konfigurationen Festplattenverschlüsselung aktiviert haben.", "en": "Ensures Elasticsearch elastic node configurations have disk encryption enabled.", "es": "Garantiza que las configuraciones de nodos elásticos de Elasticsearch tengan cifrado de disco habilitado.", "fr": "Garantit que les configurations de nœuds élastiques Elasticsearch ont le chiffrement de disque activé.", "ja": "Elasticsearch エラスティックノード設定でディスク暗号化が有効になっていることを確認します。", "pt": "Garante que as configurações de nós elásticos do Elasticsearch tenham criptografia de disco habilitada.", "zh": "确保 Elasticsearch 弹性节点配置开启了磁盘加密。"}, Reason: models.I18nString{"de": "Elastikknoten können sensible temporäre Daten speichern.", "en": "Elastic nodes can store sensitive transient data.", "es": "Los nodos elásticos pueden almacenar datos transitorios sensibles.", "fr": "Les nœuds élastiques peuvent stocker des données temporaires sensibles.", "ja": "エラスティックノードは機密の一時データを保存する可能性があります。", "pt": "Nós elásticos podem armazenar dados transitórios sensíveis.", "zh": "弹性节点可能存储敏感的临时数据。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Festplattenverschlüsselung für alle Knotenkonfigurationen in der ES-Instanz.", "en": "Enable disk encryption for all node configurations in the ES instance.", "es": "Habilite el cifrado de disco para todas las configuraciones de nodos en la instancia ES.", "fr": "Activez le chiffrement de disque pour toutes les configurations de nœuds dans l'instance ES.", "ja": "ES インスタンス内のすべてのノード設定でディスク暗号化を有効にします。", "pt": "Habilite a criptografia de disco para todas as configurações de nós na instância ES.", "zh": "为 Elasticsearch 实例中的所有节点配置开启磁盘加密。"}, ResourceTypes: []string{"ALIYUN::ElasticSearch::Instance"}, FilePath: "aliyun/rules/elasticsearch-instance-enabled-node-config-disk-encryption.rego", PackageName: "infraguard.rules.aliyun.elasticsearch_instance_enabled_node_config_disk_encryption", Content: "package infraguard.rules.aliyun.elasticsearch_instance_enabled_node_config_disk_encryption\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"elasticsearch-instance-enabled-node-config-disk-encryption\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ES Node Config Disk Encryption\",\n\t\t\"zh\": \"ES 弹性节点磁盘加密核查\",\n\t\t\"ja\": \"ES エラスティックノードディスク暗号化\",\n\t\t\"de\": \"ES-Knoten-Konfiguration Festplattenverschlüsselung\",\n\t\t\"es\": \"Cifrado de Disco de Configuración de Nodo ES\",\n\t\t\"fr\": \"Chiffrement de Disque de Configuration de Nœud ES\",\n\t\t\"pt\": \"Criptografia de Disco de Configuração de Nó ES\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Elasticsearch elastic node configurations have disk encryption enabled.\",\n\t\t\"zh\": \"确保 Elasticsearch 弹性节点配置开启了磁盘加密。\",\n\t\t\"ja\": \"Elasticsearch エラスティックノード設定でディスク暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Elasticsearch-Elastikknoten-Konfigurationen Festplattenverschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las configuraciones de nodos elásticos de Elasticsearch tengan cifrado de disco habilitado.\",\n\t\t\"fr\": \"Garantit que les configurations de nœuds élastiques Elasticsearch ont le chiffrement de disque activé.\",\n\t\t\"pt\": \"Garante que as configurações de nós elásticos do Elasticsearch tenham criptografia de disco habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Elastic nodes can store sensitive transient data.\",\n\t\t\"zh\": \"弹性节点可能存储敏感的临时数据。\",\n\t\t\"ja\": \"エラスティックノードは機密の一時データを保存する可能性があります。\",\n\t\t\"de\": \"Elastikknoten können sensible temporäre Daten speichern.\",\n\t\t\"es\": \"Los nodos elásticos pueden almacenar datos transitorios sensibles.\",\n\t\t\"fr\": \"Les nœuds élastiques peuvent stocker des données temporaires sensibles.\",\n\t\t\"pt\": \"Nós elásticos podem armazenar dados transitórios sensíveis.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable disk encryption for all node configurations in the ES instance.\",\n\t\t\"zh\": \"为 Elasticsearch 实例中的所有节点配置开启磁盘加密。\",\n\t\t\"ja\": \"ES インスタンス内のすべてのノード設定でディスク暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Festplattenverschlüsselung für alle Knotenkonfigurationen in der ES-Instanz.\",\n\t\t\"es\": \"Habilite el cifrado de disco para todas las configuraciones de nodos en la instancia ES.\",\n\t\t\"fr\": \"Activez le chiffrement de disque pour toutes les configurations de nœuds dans l'instance ES.\",\n\t\t\"pt\": \"Habilite a criptografia de disco para todas as configurações de nós na instância ES.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ElasticSearch::Instance\"]\n}\n\nis_compliant(resource) if {\n\t# DataNode disk encryption check\n\tnode := helpers.get_property(resource, \"DataNode\", {})\n\thelpers.is_true(object.get(node, \"DiskEncryption\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ElasticSearch::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DataNode\", \"DiskEncryption\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:elasticsearch-instance-enabled-public-check", Name: models.I18nString{"de": "Elasticsearch-Instanz aktiviert keinen öffentlichen Zugriff", "en": "Elasticsearch Instance Does Not Enable Public Access", "es": "La Instancia Elasticsearch No Habilita Acceso Público", "fr": "L'Instance Elasticsearch N'active Pas l'Accès Public", "ja": "Elasticsearch インスタンスがパブリックアクセスを有効にしていない", "pt": "A Instância Elasticsearch Não Habilita Acesso Público", "zh": "Elasticsearch 实例未开启公网访问"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Elasticsearch-Instanzen nicht von öffentlichen Netzwerken aus zugänglich sind.", "en": "Ensures that Elasticsearch instances are not accessible from public networks.", "es": "Garantiza que las instancias Elasticsearch no sean accesibles desde redes públicas.", "fr": "Garantit que les instances Elasticsearch ne sont pas accessibles depuis les réseaux publics.", "ja": "Elasticsearch インスタンスがパブリックネットワークからアクセスできないことを確認します。", "pt": "Garante que as instâncias Elasticsearch não sejam acessíveis de redes públicas.", "zh": "Elasticsearch 实例未开启公网访问，视为合规。"}, Reason: models.I18nString{"de": "Elasticsearch-Instanz ist von öffentlichen Netzwerken aus zugänglich, was ein Sicherheitsrisiko darstellt.", "en": "Elasticsearch instance is accessible from public network, which is a security risk.", "es": "La instancia Elasticsearch es accesible desde la red pública, lo que es un riesgo de seguridad.", "fr": "L'instance Elasticsearch est accessible depuis le réseau public, ce qui constitue un risque de sécurité.", "ja": "Elasticsearch インスタンスがパブリックネットワークからアクセス可能であり、セキュリティリスクがあります。", "pt": "A instância Elasticsearch é acessível de redes públicas, o que é um risco de segurança.", "zh": "Elasticsearch 实例开启公网访问，存在安全风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die Instanz so, dass nur Zugriff von VPC oder bestimmten IPs erlaubt ist.", "en": "Configure the instance to only allow access from VPC or specific IPs.", "es": "Configure la instancia para permitir acceso solo desde VPC o IPs específicas.", "fr": "Configurez l'instance pour n'autoriser l'accès que depuis VPC ou des IP spécifiques.", "ja": "インスタンスを VPC または特定の IP からのアクセスのみを許可するように設定します。", "pt": "Configure a instância para permitir acesso apenas de VPC ou IPs específicos.", "zh": "请配置实例仅允许 VPC 或特定 IP 访问。"}, ResourceTypes: []string{"ALIYUN::ElasticSearch::Instance"}, FilePath: "aliyun/rules/elasticsearch-instance-enabled-public-check.rego", PackageName: "infraguard.rules.aliyun.elasticsearch_instance_enabled_public_check", Content: "package infraguard.rules.aliyun.elasticsearch_instance_enabled_public_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"elasticsearch-instance-enabled-public-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Elasticsearch Instance Does Not Enable Public Access\",\n\t\t\"zh\": \"Elasticsearch 实例未开启公网访问\",\n\t\t\"ja\": \"Elasticsearch インスタンスがパブリックアクセスを有効にしていない\",\n\t\t\"de\": \"Elasticsearch-Instanz aktiviert keinen öffentlichen Zugriff\",\n\t\t\"es\": \"La Instancia Elasticsearch No Habilita Acceso Público\",\n\t\t\"fr\": \"L'Instance Elasticsearch N'active Pas l'Accès Public\",\n\t\t\"pt\": \"A Instância Elasticsearch Não Habilita Acesso Público\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Elasticsearch instances are not accessible from public networks.\",\n\t\t\"zh\": \"Elasticsearch 实例未开启公网访问，视为合规。\",\n\t\t\"ja\": \"Elasticsearch インスタンスがパブリックネットワークからアクセスできないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Elasticsearch-Instanzen nicht von öffentlichen Netzwerken aus zugänglich sind.\",\n\t\t\"es\": \"Garantiza que las instancias Elasticsearch no sean accesibles desde redes públicas.\",\n\t\t\"fr\": \"Garantit que les instances Elasticsearch ne sont pas accessibles depuis les réseaux publics.\",\n\t\t\"pt\": \"Garante que as instâncias Elasticsearch não sejam acessíveis de redes públicas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Elasticsearch instance is accessible from public network, which is a security risk.\",\n\t\t\"zh\": \"Elasticsearch 实例开启公网访问，存在安全风险。\",\n\t\t\"ja\": \"Elasticsearch インスタンスがパブリックネットワークからアクセス可能であり、セキュリティリスクがあります。\",\n\t\t\"de\": \"Elasticsearch-Instanz ist von öffentlichen Netzwerken aus zugänglich, was ein Sicherheitsrisiko darstellt.\",\n\t\t\"es\": \"La instancia Elasticsearch es accesible desde la red pública, lo que es un riesgo de seguridad.\",\n\t\t\"fr\": \"L'instance Elasticsearch est accessible depuis le réseau public, ce qui constitue un risque de sécurité.\",\n\t\t\"pt\": \"A instância Elasticsearch é acessível de redes públicas, o que é um risco de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the instance to only allow access from VPC or specific IPs.\",\n\t\t\"zh\": \"请配置实例仅允许 VPC 或特定 IP 访问。\",\n\t\t\"ja\": \"インスタンスを VPC または特定の IP からのアクセスのみを許可するように設定します。\",\n\t\t\"de\": \"Konfigurieren Sie die Instanz so, dass nur Zugriff von VPC oder bestimmten IPs erlaubt ist.\",\n\t\t\"es\": \"Configure la instancia para permitir acceso solo desde VPC o IPs específicas.\",\n\t\t\"fr\": \"Configurez l'instance pour n'autoriser l'accès que depuis VPC ou des IP spécifiques.\",\n\t\t\"pt\": \"Configure a instância para permitir acesso apenas de VPC ou IPs específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ElasticSearch::Instance\"]\n}\n\n# Check if public network access is enabled\nis_public_access_enabled(resource) if {\n\tresource.Properties.EnablePublic == true\n}\n\nis_public_access_enabled(resource) if {\n\tcount(resource.Properties.PublicWhitelist) > 0\n\t\"0.0.0.0/0\" in resource.Properties.PublicWhitelist\n}\n\nis_public_access_enabled(resource) if {\n\tcount(resource.Properties.PublicWhitelist) > 0\n\t\"0.0.0.0\" in resource.Properties.PublicWhitelist\n}\n\nis_public_access_enabled(resource) if {\n\tresource.Properties.PublicWhitelist == \"0.0.0.0/0\"\n}\n\nis_public_access_enabled(resource) if {\n\tresource.Properties.PublicWhitelist == \"0.0.0.0\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ElasticSearch::Instance\")\n\tis_public_access_enabled(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EnablePublic\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:elasticsearch-instance-multi-zone", Name: models.I18nString{"de": "Elasticsearch-Instanz Multi-Zonen-Bereitstellung", "en": "Elasticsearch Instance Multi-Zone Deployment", "es": "Implementación Multi-Zona de Instancia Elasticsearch", "fr": "Déploiement Multi-Zone d'Instance Elasticsearch", "ja": "Elasticsearch インスタンスマルチゾーン展開", "pt": "Implantação Multi-Zona de Instância Elasticsearch", "zh": "Elasticsearch 实例多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "Elasticsearch-Instanzen sollten über mehrere Verfügbarkeitszonen hinweg bereitgestellt werden.", "en": "Elasticsearch instances should be deployed across multiple availability zones.", "es": "Las instancias Elasticsearch deben implementarse en múltiples zonas de disponibilidad.", "fr": "Les instances Elasticsearch doivent être déployées sur plusieurs zones de disponibilité.", "ja": "Elasticsearch インスタンスは複数の可用性ゾーンに展開する必要があります。", "pt": "As instâncias Elasticsearch devem ser implantadas em múltiplas zonas de disponibilidade.", "zh": "Elasticsearch 实例应部署在多个可用区。"}, Reason: models.I18nString{"de": "Die Elasticsearch-Instanz ist mit weniger als 2 Verfügbarkeitszonen konfiguriert.", "en": "The Elasticsearch instance is configured with fewer than 2 availability zones.", "es": "La instancia Elasticsearch está configurada con menos de 2 zonas de disponibilidad.", "fr": "L'instance Elasticsearch est configurée avec moins de 2 zones de disponibilité.", "ja": "Elasticsearch インスタンスが 2 未満の可用性ゾーンで設定されています。", "pt": "A instância Elasticsearch está configurada com menos de 2 zonas de disponibilidade.", "zh": "Elasticsearch 实例配置的可用区数量少于 2 个。"}, Recommendation: models.I18nString{"de": "Erhöhen Sie ZoneCount auf mindestens 2.", "en": "Increase the ZoneCount to at least 2.", "es": "Aumente ZoneCount a al menos 2.", "fr": "Augmentez ZoneCount à au moins 2.", "ja": "ZoneCount を少なくとも 2 に増やします。", "pt": "Aumente ZoneCount para pelo menos 2.", "zh": "将 ZoneCount 增加到至少 2。"}, ResourceTypes: []string{"ALIYUN::ElasticSearch::Instance"}, FilePath: "aliyun/rules/elasticsearch-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.elasticsearch_instance_multi_zone", Content: "package infraguard.rules.aliyun.elasticsearch_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"elasticsearch-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Elasticsearch Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"Elasticsearch 实例多可用区部署\",\n\t\t\"ja\": \"Elasticsearch インスタンスマルチゾーン展開\",\n\t\t\"de\": \"Elasticsearch-Instanz Multi-Zonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona de Instancia Elasticsearch\",\n\t\t\"fr\": \"Déploiement Multi-Zone d'Instance Elasticsearch\",\n\t\t\"pt\": \"Implantação Multi-Zona de Instância Elasticsearch\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Elasticsearch instances should be deployed across multiple availability zones.\",\n\t\t\"zh\": \"Elasticsearch 实例应部署在多个可用区。\",\n\t\t\"ja\": \"Elasticsearch インスタンスは複数の可用性ゾーンに展開する必要があります。\",\n\t\t\"de\": \"Elasticsearch-Instanzen sollten über mehrere Verfügbarkeitszonen hinweg bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias Elasticsearch deben implementarse en múltiples zonas de disponibilidad.\",\n\t\t\"fr\": \"Les instances Elasticsearch doivent être déployées sur plusieurs zones de disponibilité.\",\n\t\t\"pt\": \"As instâncias Elasticsearch devem ser implantadas em múltiplas zonas de disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The Elasticsearch instance is configured with fewer than 2 availability zones.\",\n\t\t\"zh\": \"Elasticsearch 实例配置的可用区数量少于 2 个。\",\n\t\t\"ja\": \"Elasticsearch インスタンスが 2 未満の可用性ゾーンで設定されています。\",\n\t\t\"de\": \"Die Elasticsearch-Instanz ist mit weniger als 2 Verfügbarkeitszonen konfiguriert.\",\n\t\t\"es\": \"La instancia Elasticsearch está configurada con menos de 2 zonas de disponibilidad.\",\n\t\t\"fr\": \"L'instance Elasticsearch est configurée avec moins de 2 zones de disponibilité.\",\n\t\t\"pt\": \"A instância Elasticsearch está configurada com menos de 2 zonas de disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Increase the ZoneCount to at least 2.\",\n\t\t\"zh\": \"将 ZoneCount 增加到至少 2。\",\n\t\t\"ja\": \"ZoneCount を少なくとも 2 に増やします。\",\n\t\t\"de\": \"Erhöhen Sie ZoneCount auf mindestens 2.\",\n\t\t\"es\": \"Aumente ZoneCount a al menos 2.\",\n\t\t\"fr\": \"Augmentez ZoneCount à au moins 2.\",\n\t\t\"pt\": \"Aumente ZoneCount para pelo menos 2.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ElasticSearch::Instance\"]\n}\n\n# Check if instance is multi-zone\nis_multi_zone(resource) if {\n\t# Check ZoneCount >= 2\n\tobject.get(resource.Properties, \"ZoneCount\", 1) >= 2\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ZoneCount\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:elasticsearch-instance-node-not-use-specified-spec", Name: models.I18nString{"de": "Elasticsearch-Instanz verwendet keine veraltete Spezifikation", "en": "Elasticsearch Instance Does Not Use Deprecated Spec", "es": "La Instancia Elasticsearch No Usa Especificación Deprecada", "fr": "L'Instance Elasticsearch N'utilise Pas de Spécification Dépréciée", "ja": "Elasticsearch インスタンスが非推奨仕様を使用していない", "pt": "A Instância Elasticsearch Não Usa Especificação Depreciada", "zh": "未使用不推荐的 Elasticsearch 实例"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Elasticsearch-Instanzen keine veralteten oder nicht unterstützten Knotenspezifikationen verwenden.", "en": "Ensures that Elasticsearch instances do not use deprecated or unsupported node specifications.", "es": "Garantiza que las instancias Elasticsearch no usen especificaciones de nodo deprecadas o no compatibles.", "fr": "Garantit que les instances Elasticsearch n'utilisent pas de spécifications de nœud dépréciées ou non prises en charge.", "ja": "Elasticsearch インスタンスが非推奨またはサポートされていないノード仕様を使用していないことを確認します。", "pt": "Garante que as instâncias Elasticsearch não usem especificações de nó depreciadas ou não suportadas.", "zh": "未使用参数指定的 Elasticsearch 规格实例，视为合规。"}, Reason: models.I18nString{"de": "Die Verwendung veralteter Elasticsearch-Knotenspezifikationen kann zu fehlender Unterstützung und Sicherheitsupdates führen.", "en": "Using deprecated Elasticsearch node specifications may lack support and security updates.", "es": "Usar especificaciones de nodo Elasticsearch deprecadas puede carecer de soporte y actualizaciones de seguridad.", "fr": "L'utilisation de spécifications de nœud Elasticsearch dépréciées peut manquer de support et de mises à jour de sécurité.", "ja": "非推奨の Elasticsearch ノード仕様を使用すると、サポートとセキュリティ更新が不足する可能性があります。", "pt": "Usar especificações de nó Elasticsearch depreciadas pode faltar suporte e atualizações de segurança.", "zh": "使用不推荐的 Elasticsearch 规格实例，可能缺少支持和安全更新。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie auf eine unterstützte Elasticsearch-Knotenspezifikation.", "en": "Upgrade to a supported Elasticsearch node specification.", "es": "Actualice a una especificación de nodo Elasticsearch compatible.", "fr": "Mettez à niveau vers une spécification de nœud Elasticsearch prise en charge.", "ja": "サポートされている Elasticsearch ノード仕様にアップグレードします。", "pt": "Atualize para uma especificação de nó Elasticsearch suportada.", "zh": "请升级到支持的 Elasticsearch 节点规格。"}, ResourceTypes: []string{"ALIYUN::ElasticSearch::Instance"}, FilePath: "aliyun/rules/elasticsearch-instance-node-not-use-specified-spec.rego", PackageName: "infraguard.rules.aliyun.elasticsearch_instance_node_not_use_specified_spec", Content: "package infraguard.rules.aliyun.elasticsearch_instance_node_not_use_specified_spec\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"elasticsearch-instance-node-not-use-specified-spec\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Elasticsearch Instance Does Not Use Deprecated Spec\",\n\t\t\"zh\": \"未使用不推荐的 Elasticsearch 实例\",\n\t\t\"ja\": \"Elasticsearch インスタンスが非推奨仕様を使用していない\",\n\t\t\"de\": \"Elasticsearch-Instanz verwendet keine veraltete Spezifikation\",\n\t\t\"es\": \"La Instancia Elasticsearch No Usa Especificación Deprecada\",\n\t\t\"fr\": \"L'Instance Elasticsearch N'utilise Pas de Spécification Dépréciée\",\n\t\t\"pt\": \"A Instância Elasticsearch Não Usa Especificação Depreciada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Elasticsearch instances do not use deprecated or unsupported node specifications.\",\n\t\t\"zh\": \"未使用参数指定的 Elasticsearch 规格实例，视为合规。\",\n\t\t\"ja\": \"Elasticsearch インスタンスが非推奨またはサポートされていないノード仕様を使用していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Elasticsearch-Instanzen keine veralteten oder nicht unterstützten Knotenspezifikationen verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias Elasticsearch no usen especificaciones de nodo deprecadas o no compatibles.\",\n\t\t\"fr\": \"Garantit que les instances Elasticsearch n'utilisent pas de spécifications de nœud dépréciées ou non prises en charge.\",\n\t\t\"pt\": \"Garante que as instâncias Elasticsearch não usem especificações de nó depreciadas ou não suportadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using deprecated Elasticsearch node specifications may lack support and security updates.\",\n\t\t\"zh\": \"使用不推荐的 Elasticsearch 规格实例，可能缺少支持和安全更新。\",\n\t\t\"ja\": \"非推奨の Elasticsearch ノード仕様を使用すると、サポートとセキュリティ更新が不足する可能性があります。\",\n\t\t\"de\": \"Die Verwendung veralteter Elasticsearch-Knotenspezifikationen kann zu fehlender Unterstützung und Sicherheitsupdates führen.\",\n\t\t\"es\": \"Usar especificaciones de nodo Elasticsearch deprecadas puede carecer de soporte y actualizaciones de seguridad.\",\n\t\t\"fr\": \"L'utilisation de spécifications de nœud Elasticsearch dépréciées peut manquer de support et de mises à jour de sécurité.\",\n\t\t\"pt\": \"Usar especificações de nó Elasticsearch depreciadas pode faltar suporte e atualizações de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade to a supported Elasticsearch node specification.\",\n\t\t\"zh\": \"请升级到支持的 Elasticsearch 节点规格。\",\n\t\t\"ja\": \"サポートされている Elasticsearch ノード仕様にアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie auf eine unterstützte Elasticsearch-Knotenspezifikation.\",\n\t\t\"es\": \"Actualice a una especificación de nodo Elasticsearch compatible.\",\n\t\t\"fr\": \"Mettez à niveau vers une spécification de nœud Elasticsearch prise en charge.\",\n\t\t\"pt\": \"Atualize para uma especificação de nó Elasticsearch suportada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ElasticSearch::Instance\"]\n}\n\n# Default deprecated specs (should be parameterized in production)\ndeprecated_specs := [\n\t\"elasticsearch.sn1.small\",\n\t\"elasticsearch.sn2.small\",\n\t\"elasticsearch.mn1.small\",\n]\n\n# Check if rule parameters exist\nhas_rule_parameters := count(input.rule_parameters) > 0\n\n# Get deprecated specs from parameters or use default\ndeprecated_list := deprecated_specs if {\n\tnot has_rule_parameters\n}\n\ndeprecated_list := deprecated_specs if {\n\thas_rule_parameters\n\tinput.rule_parameters.deprecated_node_specs == \"\"\n}\n\ndeprecated_list := deprecated_specs if {\n\thas_rule_parameters\n\tnot input.rule_parameters.deprecated_node_specs\n}\n\ndeprecated_list := input.rule_parameters.deprecated_node_specs if {\n\thas_rule_parameters\n\tinput.rule_parameters.deprecated_node_specs != \"\"\n}\n\n# Check if a node spec is deprecated\nis_deprecated_spec(node_spec) if {\n\tsome deprecated in deprecated_list\n\tcontains(node_spec, deprecated)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ElasticSearch::Instance\")\n\n\tdata_node := resource.Properties.DataNode\n\tnode_spec := data_node.Spec\n\n\tis_deprecated_spec(node_spec)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DataNode\", \"Spec\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:elasticsearch-instance-version-not-deprecated", Name: models.I18nString{"de": "Elasticsearch-Instanz verwendet keine veraltete Version", "en": "Elasticsearch Instance Does Not Use Deprecated Version", "es": "La Instancia de Elasticsearch No Usa Versión Obsoleta", "fr": "L'Instance Elasticsearch N'Utilise Pas de Version Obsolète", "ja": "Elasticsearch インスタンスが非推奨バージョンを使用していない", "pt": "A Instância do Elasticsearch Não Usa Versão Obsoleta", "zh": "未使用不推荐的 Elasticsearch 实例版本"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Elasticsearch-Instanzen keine veralteten oder EOL-Versionen verwenden.", "en": "Ensures that Elasticsearch instances are not using deprecated or EOL versions.", "es": "Garantiza que las instancias de Elasticsearch no estén usando versiones obsoletas o EOL.", "fr": "Garantit que les instances Elasticsearch n'utilisent pas de versions obsolètes ou EOL.", "ja": "Elasticsearch インスタンスが非推奨または EOL バージョンを使用していないことを確認します。", "pt": "Garante que as instâncias do Elasticsearch não estejam usando versões obsoletas ou EOL.", "zh": "Elasticsearch 实例所使用的版本未在参数指定的不推荐版本范围内，视为合规。"}, Reason: models.I18nString{"de": "Die Verwendung veralteter Elasticsearch-Versionen kann Sicherheitslücken haben und Unterstützung fehlen.", "en": "Using deprecated Elasticsearch versions may have security vulnerabilities and lack support.", "es": "Usar versiones obsoletas de Elasticsearch puede tener vulnerabilidades de seguridad y carecer de soporte.", "fr": "L'utilisation de versions obsolètes d'Elasticsearch peut présenter des vulnérabilités de sécurité et manquer de support.", "ja": "非推奨の Elasticsearch バージョンを使用すると、セキュリティの脆弱性があり、サポートが不足している可能性があります。", "pt": "Usar versões obsoletas do Elasticsearch pode ter vulnerabilidades de segurança e falta de suporte.", "zh": "使用不推荐的 Elasticsearch 版本可能存在安全漏洞且缺乏支持。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie auf eine unterstützte Elasticsearch-Version.", "en": "Upgrade to a supported Elasticsearch version.", "es": "Actualice a una versión de Elasticsearch compatible.", "fr": "Mettez à niveau vers une version Elasticsearch prise en charge.", "ja": "サポートされている Elasticsearch バージョンにアップグレードします。", "pt": "Atualize para uma versão do Elasticsearch suportada.", "zh": "请升级到支持的 Elasticsearch 版本。"}, ResourceTypes: []string{"ALIYUN::ElasticSearch::Instance"}, FilePath: "aliyun/rules/elasticsearch-instance-version-not-deprecated.rego", PackageName: "infraguard.rules.aliyun.elasticsearch_instance_version_not_deprecated", Content: "package infraguard.rules.aliyun.elasticsearch_instance_version_not_deprecated\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"elasticsearch-instance-version-not-deprecated\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Elasticsearch Instance Does Not Use Deprecated Version\",\n\t\t\"zh\": \"未使用不推荐的 Elasticsearch 实例版本\",\n\t\t\"ja\": \"Elasticsearch インスタンスが非推奨バージョンを使用していない\",\n\t\t\"de\": \"Elasticsearch-Instanz verwendet keine veraltete Version\",\n\t\t\"es\": \"La Instancia de Elasticsearch No Usa Versión Obsoleta\",\n\t\t\"fr\": \"L'Instance Elasticsearch N'Utilise Pas de Version Obsolète\",\n\t\t\"pt\": \"A Instância do Elasticsearch Não Usa Versão Obsoleta\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Elasticsearch instances are not using deprecated or EOL versions.\",\n\t\t\"zh\": \"Elasticsearch 实例所使用的版本未在参数指定的不推荐版本范围内，视为合规。\",\n\t\t\"ja\": \"Elasticsearch インスタンスが非推奨または EOL バージョンを使用していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Elasticsearch-Instanzen keine veralteten oder EOL-Versionen verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias de Elasticsearch no estén usando versiones obsoletas o EOL.\",\n\t\t\"fr\": \"Garantit que les instances Elasticsearch n'utilisent pas de versions obsolètes ou EOL.\",\n\t\t\"pt\": \"Garante que as instâncias do Elasticsearch não estejam usando versões obsoletas ou EOL.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using deprecated Elasticsearch versions may have security vulnerabilities and lack support.\",\n\t\t\"zh\": \"使用不推荐的 Elasticsearch 版本可能存在安全漏洞且缺乏支持。\",\n\t\t\"ja\": \"非推奨の Elasticsearch バージョンを使用すると、セキュリティの脆弱性があり、サポートが不足している可能性があります。\",\n\t\t\"de\": \"Die Verwendung veralteter Elasticsearch-Versionen kann Sicherheitslücken haben und Unterstützung fehlen.\",\n\t\t\"es\": \"Usar versiones obsoletas de Elasticsearch puede tener vulnerabilidades de seguridad y carecer de soporte.\",\n\t\t\"fr\": \"L'utilisation de versions obsolètes d'Elasticsearch peut présenter des vulnérabilités de sécurité et manquer de support.\",\n\t\t\"pt\": \"Usar versões obsoletas do Elasticsearch pode ter vulnerabilidades de segurança e falta de suporte.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade to a supported Elasticsearch version.\",\n\t\t\"zh\": \"请升级到支持的 Elasticsearch 版本。\",\n\t\t\"ja\": \"サポートされている Elasticsearch バージョンにアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie auf eine unterstützte Elasticsearch-Version.\",\n\t\t\"es\": \"Actualice a una versión de Elasticsearch compatible.\",\n\t\t\"fr\": \"Mettez à niveau vers une version Elasticsearch prise en charge.\",\n\t\t\"pt\": \"Atualize para uma versão do Elasticsearch suportada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ElasticSearch::Instance\"]\n}\n\n# Default deprecated versions (major versions that are EOL)\ndefault deprecated_versions := [\n\t\"5.5.3\",\n\t\"5.6.16\",\n\t\"6.3\",\n\t\"6.7\",\n\t\"7.0\",\n]\n\n# Get deprecated versions from parameters or use default\nget_deprecated_versions := deprecated_versions if {\n\tparams := object.get(input, \"rule_parameters\", {})\n\tval := object.get(params, \"deprecated_versions\", \"\")\n\tval == \"\"\n}\n\nget_deprecated_versions := versions if {\n\tparams := object.get(input, \"rule_parameters\", {})\n\tval := object.get(params, \"deprecated_versions\", \"\")\n\tval != \"\"\n\tversions := val\n}\n\n# Check if a version is deprecated\nis_deprecated_version(version) if {\n\tsome deprecated in get_deprecated_versions\n\tstartswith(version, deprecated)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ElasticSearch::Instance\")\n\n\tversion := resource.Properties.Version\n\n\tis_deprecated_version(version)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Version\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:elasticsearch-public-and-any-ip-access-check", Name: models.I18nString{"de": "Elasticsearch Öffentlicher und Beliebiger IP-Zugriff Prüfung", "en": "Elasticsearch Public and Any IP Access Check", "es": "Verificación de Acceso Público y de Cualquier IP de Elasticsearch", "fr": "Vérification d'Accès Public et IP Elasticsearch", "ja": "Elasticsearch パブリックおよび任意の IP アクセスチェック", "pt": "Verificação de Acesso Público e de Qualquer IP do Elasticsearch", "zh": "Elasticsearch 实例未开启公网或不允许任意 IP 访问"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Elasticsearch-Instanzen keinen öffentlichen Zugriff aktiviert haben oder eine offene Whitelist haben.", "en": "Ensures that Elasticsearch instances do not have public access enabled or an open whitelist.", "es": "Garantiza que las instancias Elasticsearch no tengan acceso público habilitado o una lista blanca abierta.", "fr": "Garantit que les instances Elasticsearch n'ont pas d'accès public activé ou une liste blanche ouverte.", "ja": "Elasticsearch インスタンスでパブリックアクセスが有効になっていない、またはオープンホワイトリストが設定されていないことを確認します。", "pt": "Garante que as instâncias Elasticsearch não tenham acesso público habilitado ou uma lista branca aberta.", "zh": "确保 Elasticsearch 实例未开启公网访问，或者白名单未设置为对所有 IP 开放。"}, Reason: models.I18nString{"de": "Öffentlicher Zugriff oder eine offene Whitelist setzt den Elasticsearch-Cluster dem Internet aus und erhöht das Risiko unbefugten Zugriffs oder Angriffe.", "en": "Public access or an open whitelist exposes the Elasticsearch cluster to the internet, increasing the risk of unauthorized access or attacks.", "es": "El acceso público o una lista blanca abierta expone el clúster Elasticsearch a Internet, aumentando el riesgo de acceso no autorizado o ataques.", "fr": "L'accès public ou une liste blanche ouverte expose le cluster Elasticsearch à Internet, augmentant le risque d'accès non autorisé ou d'attaques.", "ja": "パブリックアクセスまたはオープンホワイトリストにより、Elasticsearch クラスタがインターネットに公開され、不正アクセスや攻撃のリスクが増加します。", "pt": "O acesso público ou uma lista branca aberta expõe o cluster Elasticsearch à Internet, aumentando o risco de acesso não autorizado ou ataques.", "zh": "开启公网访问或设置开放白名单会将 Elasticsearch 集群暴露在互联网上，增加未经授权访问或攻击的风险。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie den öffentlichen Zugriff oder beschränken Sie die IP-Whitelist für die Elasticsearch-Instanz.", "en": "Disable public access or restrict the IP whitelist for the Elasticsearch instance.", "es": "Deshabilite el acceso público o restrinja la lista blanca de IP para la instancia Elasticsearch.", "fr": "Désactivez l'accès public ou restreignez la liste blanche IP pour l'instance Elasticsearch.", "ja": "Elasticsearch インスタンスのパブリックアクセスを無効にするか、IP ホワイトリストを制限します。", "pt": "Desabilite o acesso público ou restrinja a lista branca de IP para a instância Elasticsearch.", "zh": "禁用 Elasticsearch 实例的公网访问或限制 IP 白名单。"}, ResourceTypes: []string{"ALIYUN::ElasticSearch::Instance"}, FilePath: "aliyun/rules/elasticsearch-public-and-any-ip-access-check.rego", PackageName: "infraguard.rules.aliyun.elasticsearch_public_and_any_ip_access_check", Content: "package infraguard.rules.aliyun.elasticsearch_public_and_any_ip_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"elasticsearch-public-and-any-ip-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Elasticsearch Public and Any IP Access Check\",\n\t\t\"zh\": \"Elasticsearch 实例未开启公网或不允许任意 IP 访问\",\n\t\t\"ja\": \"Elasticsearch パブリックおよび任意の IP アクセスチェック\",\n\t\t\"de\": \"Elasticsearch Öffentlicher und Beliebiger IP-Zugriff Prüfung\",\n\t\t\"es\": \"Verificación de Acceso Público y de Cualquier IP de Elasticsearch\",\n\t\t\"fr\": \"Vérification d'Accès Public et IP Elasticsearch\",\n\t\t\"pt\": \"Verificação de Acesso Público e de Qualquer IP do Elasticsearch\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Elasticsearch instances do not have public access enabled or an open whitelist.\",\n\t\t\"zh\": \"确保 Elasticsearch 实例未开启公网访问，或者白名单未设置为对所有 IP 开放。\",\n\t\t\"ja\": \"Elasticsearch インスタンスでパブリックアクセスが有効になっていない、またはオープンホワイトリストが設定されていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Elasticsearch-Instanzen keinen öffentlichen Zugriff aktiviert haben oder eine offene Whitelist haben.\",\n\t\t\"es\": \"Garantiza que las instancias Elasticsearch no tengan acceso público habilitado o una lista blanca abierta.\",\n\t\t\"fr\": \"Garantit que les instances Elasticsearch n'ont pas d'accès public activé ou une liste blanche ouverte.\",\n\t\t\"pt\": \"Garante que as instâncias Elasticsearch não tenham acesso público habilitado ou uma lista branca aberta.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Public access or an open whitelist exposes the Elasticsearch cluster to the internet, increasing the risk of unauthorized access or attacks.\",\n\t\t\"zh\": \"开启公网访问或设置开放白名单会将 Elasticsearch 集群暴露在互联网上，增加未经授权访问或攻击的风险。\",\n\t\t\"ja\": \"パブリックアクセスまたはオープンホワイトリストにより、Elasticsearch クラスタがインターネットに公開され、不正アクセスや攻撃のリスクが増加します。\",\n\t\t\"de\": \"Öffentlicher Zugriff oder eine offene Whitelist setzt den Elasticsearch-Cluster dem Internet aus und erhöht das Risiko unbefugten Zugriffs oder Angriffe.\",\n\t\t\"es\": \"El acceso público o una lista blanca abierta expone el clúster Elasticsearch a Internet, aumentando el riesgo de acceso no autorizado o ataques.\",\n\t\t\"fr\": \"L'accès public ou une liste blanche ouverte expose le cluster Elasticsearch à Internet, augmentant le risque d'accès non autorisé ou d'attaques.\",\n\t\t\"pt\": \"O acesso público ou uma lista branca aberta expõe o cluster Elasticsearch à Internet, aumentando o risco de acesso não autorizado ou ataques.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable public access or restrict the IP whitelist for the Elasticsearch instance.\",\n\t\t\"zh\": \"禁用 Elasticsearch 实例的公网访问或限制 IP 白名单。\",\n\t\t\"ja\": \"Elasticsearch インスタンスのパブリックアクセスを無効にするか、IP ホワイトリストを制限します。\",\n\t\t\"de\": \"Deaktivieren Sie den öffentlichen Zugriff oder beschränken Sie die IP-Whitelist für die Elasticsearch-Instanz.\",\n\t\t\"es\": \"Deshabilite el acceso público o restrinja la lista blanca de IP para la instancia Elasticsearch.\",\n\t\t\"fr\": \"Désactivez l'accès public ou restreignez la liste blanche IP pour l'instance Elasticsearch.\",\n\t\t\"pt\": \"Desabilite o acesso público ou restrinja a lista branca de IP para a instância Elasticsearch.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ElasticSearch::Instance\"]\n}\n\nis_compliant(resource) if {\n\t# If public access is not enabled, it's compliant\n\tnot helpers.is_true(helpers.get_property(resource, \"EnablePublic\", false))\n}\n\nis_compliant(resource) if {\n\t# If public access is enabled, check the whitelist\n\thelpers.is_true(helpers.get_property(resource, \"EnablePublic\", false))\n\twhitelist := helpers.get_property(resource, \"PublicWhitelist\", [])\n\tnot has_open_cidr(whitelist)\n}\n\nhas_open_cidr(whitelist) if {\n\tsome cidr in whitelist\n\thelpers.is_public_cidr(cidr)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ElasticSearch::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EnablePublic\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:emr-cluster-master-public-access-check", Name: models.I18nString{"de": "EMR-Cluster-Master-Knoten öffentlicher Zugriffsprüfung", "en": "EMR Cluster Master Node Public Access Check", "es": "Verificación de Acceso Público del Nodo Maestro del Clúster EMR", "fr": "Vérification de l'Accès Public du Nœud Maître du Cluster EMR", "ja": "EMR クラスターのマスターノードのパブリックアクセチェック", "pt": "Verificação de Acesso Público do Nó Mestre do Cluster EMR", "zh": "EMR 集群 Master 节点公网开启检测"}, Severity: "medium", Description: models.I18nString{"de": "EMR on ECS-Cluster-Master-Knoten sollten keine öffentliche IP aktiviert haben.", "en": "EMR on ECS cluster master nodes should not have public IP enabled.", "es": "Los nodos maestros del clúster EMR en ECS no deben tener IP pública habilitada.", "fr": "Les nœuds maîtres du cluster EMR sur ECS ne doivent pas avoir d'IP publique activée.", "ja": "EMR on ECS クラスターのマスターノードでパブリック IP を有効にしないでください。", "pt": "Os nós mestres do cluster EMR no ECS não devem ter IP público habilitado.", "zh": "EMR on ECS 集群 Master 节点公网不开启，视为合规。"}, Reason: models.I18nString{"de": "EMR-Master-Knoten mit aktivierter öffentlicher IP können dem Internet ausgesetzt sein, was die Sicherheitsrisiken erhöht.", "en": "EMR master nodes with public IP enabled may be exposed to the internet, increasing security risks.", "es": "Los nodos maestros de EMR con IP pública habilitada pueden estar expuestos a internet, aumentando los riesgos de seguridad.", "fr": "Les nœuds maîtres EMR avec IP publique activée peuvent être exposés à Internet, augmentant les risques de sécurité.", "ja": "パブリック IP が有効な EMR マスターノードはインターネットにさらされる可能性があり、セキュリティリスクが増加します。", "pt": "Nós mestres do EMR com IP público habilitado podem estar expostos à internet, aumentando os riscos de segurança.", "zh": "EMR Master 节点开启公网 IP 可能会暴露在互联网中，增加安全风险。"}, Recommendation: models.I18nString{"de": "Setzen Sie 'IsOpenPublicIp' für den EMR-Cluster auf false und verwenden Sie ein NAT-Gateway oder einen Bastion-Host für den Zugriff.", "en": "Set 'IsOpenPublicIp' to false for the EMR cluster and use a NAT gateway or bastion host for access.", "es": "Establezca 'IsOpenPublicIp' en false para el clúster EMR y use una puerta de enlace NAT o un host bastión para el acceso.", "fr": "Définissez 'IsOpenPublicIp' sur false pour le cluster EMR et utilisez une passerelle NAT ou un hôte bastion pour l'accès.", "ja": "EMR クラスターの 'IsOpenPublicIp' を false に設定し、アクセスに NAT ゲートウェイまたはバスチオンホストを使用します。", "pt": "Defina 'IsOpenPublicIp' como false para o cluster EMR e use um gateway NAT ou host bastião para acesso.", "zh": "将 EMR 集群的'IsOpenPublicIp'属性设置为 false，并使用 NAT 网关或堡垒机进行访问。"}, ResourceTypes: []string{"ALIYUN::EMR::Cluster"}, FilePath: "aliyun/rules/emr-cluster-master-public-access-check.rego", PackageName: "infraguard.rules.aliyun.emr_cluster_master_public_access_check", Content: "package infraguard.rules.aliyun.emr_cluster_master_public_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"emr-cluster-master-public-access-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"EMR Cluster Master Node Public Access Check\",\n\t\t\"zh\": \"EMR 集群 Master 节点公网开启检测\",\n\t\t\"ja\": \"EMR クラスターのマスターノードのパブリックアクセチェック\",\n\t\t\"de\": \"EMR-Cluster-Master-Knoten öffentlicher Zugriffsprüfung\",\n\t\t\"es\": \"Verificación de Acceso Público del Nodo Maestro del Clúster EMR\",\n\t\t\"fr\": \"Vérification de l'Accès Public du Nœud Maître du Cluster EMR\",\n\t\t\"pt\": \"Verificação de Acesso Público do Nó Mestre do Cluster EMR\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"EMR on ECS cluster master nodes should not have public IP enabled.\",\n\t\t\"zh\": \"EMR on ECS 集群 Master 节点公网不开启，视为合规。\",\n\t\t\"ja\": \"EMR on ECS クラスターのマスターノードでパブリック IP を有効にしないでください。\",\n\t\t\"de\": \"EMR on ECS-Cluster-Master-Knoten sollten keine öffentliche IP aktiviert haben.\",\n\t\t\"es\": \"Los nodos maestros del clúster EMR en ECS no deben tener IP pública habilitada.\",\n\t\t\"fr\": \"Les nœuds maîtres du cluster EMR sur ECS ne doivent pas avoir d'IP publique activée.\",\n\t\t\"pt\": \"Os nós mestres do cluster EMR no ECS não devem ter IP público habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"EMR master nodes with public IP enabled may be exposed to the internet, increasing security risks.\",\n\t\t\"zh\": \"EMR Master 节点开启公网 IP 可能会暴露在互联网中，增加安全风险。\",\n\t\t\"ja\": \"パブリック IP が有効な EMR マスターノードはインターネットにさらされる可能性があり、セキュリティリスクが増加します。\",\n\t\t\"de\": \"EMR-Master-Knoten mit aktivierter öffentlicher IP können dem Internet ausgesetzt sein, was die Sicherheitsrisiken erhöht.\",\n\t\t\"es\": \"Los nodos maestros de EMR con IP pública habilitada pueden estar expuestos a internet, aumentando los riesgos de seguridad.\",\n\t\t\"fr\": \"Les nœuds maîtres EMR avec IP publique activée peuvent être exposés à Internet, augmentant les risques de sécurité.\",\n\t\t\"pt\": \"Nós mestres do EMR com IP público habilitado podem estar expostos à internet, aumentando os riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set 'IsOpenPublicIp' to false for the EMR cluster and use a NAT gateway or bastion host for access.\",\n\t\t\"zh\": \"将 EMR 集群的'IsOpenPublicIp'属性设置为 false，并使用 NAT 网关或堡垒机进行访问。\",\n\t\t\"ja\": \"EMR クラスターの 'IsOpenPublicIp' を false に設定し、アクセスに NAT ゲートウェイまたはバスチオンホストを使用します。\",\n\t\t\"de\": \"Setzen Sie 'IsOpenPublicIp' für den EMR-Cluster auf false und verwenden Sie ein NAT-Gateway oder einen Bastion-Host für den Zugriff.\",\n\t\t\"es\": \"Establezca 'IsOpenPublicIp' en false para el clúster EMR y use una puerta de enlace NAT o un host bastión para el acceso.\",\n\t\t\"fr\": \"Définissez 'IsOpenPublicIp' sur false pour le cluster EMR et utilisez une passerelle NAT ou un hôte bastion pour l'accès.\",\n\t\t\"pt\": \"Defina 'IsOpenPublicIp' como false para o cluster EMR e use um gateway NAT ou host bastião para acesso.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::EMR::Cluster\"]\n}\n\n# Deny if IsOpenPublicIp is true\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::EMR::Cluster\")\n\tresource.Properties.IsOpenPublicIp == true\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"IsOpenPublicIp\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-group-health-check", Name: models.I18nString{"de": "ESS-Skalierungsgruppe Gesundheitsprüfung", "en": "ESS Scaling Group Health Check", "es": "Verificación de Salud del Grupo de Escalado ESS", "fr": "Vérification de Santé du Groupe de Mise à l'Échelle ESS", "ja": "ESS スケーリンググループのヘルスチェック", "pt": "Verificação de Saúde do Grupo de Escalonamento ESS", "zh": "弹性伸缩组开启 ECS 实例健康检查"}, Severity: "medium", Description: models.I18nString{"de": "ESS-Skalierungsgruppen sollten ECS-Instanz-Gesundheitsprüfung aktivieren, um sicherzustellen, dass nur gesunde Instanzen im Dienst sind.", "en": "ESS scaling groups should enable ECS instance health check to ensure only healthy instances are in service.", "es": "Los grupos de escalado ESS deben habilitar la verificación de salud de instancias ECS para asegurar que solo instancias saludables estén en servicio.", "fr": "Les groupes de mise à l'échelle ESS doivent activer la vérification de santé des instances ECS pour s'assurer que seules les instances saines sont en service.", "ja": "ESS スケーリンググループは、正常なインスタンスのみがサービスを提供するように、ECS インスタンスのヘルスチェックを有効にする必要があります。", "pt": "Os grupos de escalonamento ESS devem habilitar a verificação de saúde da instância ECS para garantir que apenas instâncias saudáveis estejam em serviço.", "zh": "弹性伸缩组开启对 ECS 实例的健康检查，视为合规。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungsgruppe hat keine Gesundheitsprüfung aktiviert, was dazu führen kann, dass ungesunde Instanzen Datenverkehr bedienen.", "en": "The ESS scaling group does not have health check enabled, which may result in unhealthy instances serving traffic.", "es": "El grupo de escalado ESS no tiene verificación de salud habilitada, lo que puede resultar en instancias no saludables sirviendo tráfico.", "fr": "Le groupe de mise à l'échelle ESS n'a pas de vérification de santé activée, ce qui peut entraîner des instances malsaines servant le trafic.", "ja": "ESS スケーリンググループでヘルスチェックが有効になっていないため、異常なインスタンスがトラフィックを処理する可能性があります。", "pt": "O grupo de escalonamento ESS não tem verificação de saúde habilitada, o que pode resultar em instâncias não saudáveis servindo tráfego.", "zh": "弹性伸缩组未开启健康检查，可能导致异常实例仍在提供服务。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Gesundheitsprüfungstyp für die ESS-Skalierungsgruppe, indem Sie HealthCheckType auf ECS setzen oder HealthCheckTypes konfigurieren.", "en": "Enable health check type for the ESS scaling group by setting HealthCheckType to ECS or configuring HealthCheckTypes.", "es": "Habilite el tipo de verificación de salud para el grupo de escalado ESS estableciendo HealthCheckType en ECS o configurando HealthCheckTypes.", "fr": "Activez le type de vérification de santé pour le groupe de mise à l'échelle ESS en définissant HealthCheckType sur ECS ou en configurant HealthCheckTypes.", "ja": "HealthCheckType を ECS に設定するか、HealthCheckTypes を設定して、ESS スケーリンググループのヘルスチェックタイプを有効にします。", "pt": "Habilite o tipo de verificação de saúde para o grupo de escalonamento ESS definindo HealthCheckType como ECS ou configurando HealthCheckTypes.", "zh": "为弹性伸缩组启用健康检查，将 HealthCheckType 设置为 ECS 或配置 HealthCheckTypes。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingGroup"}, FilePath: "aliyun/rules/ess-group-health-check.rego", PackageName: "infraguard.rules.aliyun.ess_group_health_check", Content: "package infraguard.rules.aliyun.ess_group_health_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-group-health-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Group Health Check\",\n\t\t\"zh\": \"弹性伸缩组开启 ECS 实例健康检查\",\n\t\t\"ja\": \"ESS スケーリンググループのヘルスチェック\",\n\t\t\"de\": \"ESS-Skalierungsgruppe Gesundheitsprüfung\",\n\t\t\"es\": \"Verificación de Salud del Grupo de Escalado ESS\",\n\t\t\"fr\": \"Vérification de Santé du Groupe de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Verificação de Saúde do Grupo de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling groups should enable ECS instance health check to ensure only healthy instances are in service.\",\n\t\t\"zh\": \"弹性伸缩组开启对 ECS 实例的健康检查，视为合规。\",\n\t\t\"ja\": \"ESS スケーリンググループは、正常なインスタンスのみがサービスを提供するように、ECS インスタンスのヘルスチェックを有効にする必要があります。\",\n\t\t\"de\": \"ESS-Skalierungsgruppen sollten ECS-Instanz-Gesundheitsprüfung aktivieren, um sicherzustellen, dass nur gesunde Instanzen im Dienst sind.\",\n\t\t\"es\": \"Los grupos de escalado ESS deben habilitar la verificación de salud de instancias ECS para asegurar que solo instancias saludables estén en servicio.\",\n\t\t\"fr\": \"Les groupes de mise à l'échelle ESS doivent activer la vérification de santé des instances ECS pour s'assurer que seules les instances saines sont en service.\",\n\t\t\"pt\": \"Os grupos de escalonamento ESS devem habilitar a verificação de saúde da instância ECS para garantir que apenas instâncias saudáveis estejam em serviço.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling group does not have health check enabled, which may result in unhealthy instances serving traffic.\",\n\t\t\"zh\": \"弹性伸缩组未开启健康检查，可能导致异常实例仍在提供服务。\",\n\t\t\"ja\": \"ESS スケーリンググループでヘルスチェックが有効になっていないため、異常なインスタンスがトラフィックを処理する可能性があります。\",\n\t\t\"de\": \"Die ESS-Skalierungsgruppe hat keine Gesundheitsprüfung aktiviert, was dazu führen kann, dass ungesunde Instanzen Datenverkehr bedienen.\",\n\t\t\"es\": \"El grupo de escalado ESS no tiene verificación de salud habilitada, lo que puede resultar en instancias no saludables sirviendo tráfico.\",\n\t\t\"fr\": \"Le groupe de mise à l'échelle ESS n'a pas de vérification de santé activée, ce qui peut entraîner des instances malsaines servant le trafic.\",\n\t\t\"pt\": \"O grupo de escalonamento ESS não tem verificação de saúde habilitada, o que pode resultar em instâncias não saudáveis servindo tráfego.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable health check type for the ESS scaling group by setting HealthCheckType to ECS or configuring HealthCheckTypes.\",\n\t\t\"zh\": \"为弹性伸缩组启用健康检查，将 HealthCheckType 设置为 ECS 或配置 HealthCheckTypes。\",\n\t\t\"ja\": \"HealthCheckType を ECS に設定するか、HealthCheckTypes を設定して、ESS スケーリンググループのヘルスチェックタイプを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Gesundheitsprüfungstyp für die ESS-Skalierungsgruppe, indem Sie HealthCheckType auf ECS setzen oder HealthCheckTypes konfigurieren.\",\n\t\t\"es\": \"Habilite el tipo de verificación de salud para el grupo de escalado ESS estableciendo HealthCheckType en ECS o configurando HealthCheckTypes.\",\n\t\t\"fr\": \"Activez le type de vérification de santé pour le groupe de mise à l'échelle ESS en définissant HealthCheckType sur ECS ou en configurant HealthCheckTypes.\",\n\t\t\"pt\": \"Habilite o tipo de verificação de saúde para o grupo de escalonamento ESS definindo HealthCheckType como ECS ou configurando HealthCheckTypes.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingGroup\"]\n}\n\n# Check if scaling group has health check enabled\nhas_health_check_enabled(resource) if {\n\thealth_check_type := helpers.get_property(resource, \"HealthCheckType\", \"\")\n\thealth_check_type != \"\"\n\thealth_check_type != \"NONE\"\n}\n\nhas_health_check_enabled(resource) if {\n\thealth_check_types := helpers.get_property(resource, \"HealthCheckTypes\", [])\n\tcount(health_check_types) > 0\n}\n\n# Deny rule: ESS scaling groups must have health check enabled\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingGroup\")\n\tnot has_health_check_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"HealthCheckType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-configuration-attach-security-group", Name: models.I18nString{"de": "ESS-Skalierungskonfiguration Sicherheitsgruppe", "en": "ESS Scaling Configuration Security Group", "es": "Grupo de Seguridad de Configuración de Escalado ESS", "fr": "Groupe de Sécurité de Configuration de Mise à l'Échelle ESS", "ja": "ESS スケーリング設定セキュリティグループ", "pt": "Grupo de Segurança de Configuração de Escalonamento ESS", "zh": "弹性伸缩配置中为实例设置关联安全组"}, Severity: "medium", Description: models.I18nString{"de": "ESS-Skalierungskonfigurationen sollten Sicherheitsgruppen an Instanzen anhängen, um ordnungsgemäße Netzwerkisolation und Zugriffskontrolle zu gewährleisten.", "en": "ESS scaling configurations should attach security groups to instances for proper network isolation and access control.", "es": "Las configuraciones de escalado ESS deben adjuntar grupos de seguridad a las instancias para un aislamiento de red y control de acceso adecuados.", "fr": "Les configurations de mise à l'échelle ESS doivent attacher des groupes de sécurité aux instances pour une isolation réseau et un contrôle d'accès appropriés.", "ja": "ESS スケーリング設定は、適切なネットワーク分離とアクセス制御のためにインスタンスにセキュリティグループをアタッチする必要があります。", "pt": "As configurações de escalonamento ESS devem anexar grupos de segurança às instâncias para isolamento de rede e controle de acesso adequados.", "zh": "弹性伸缩配置中设置了实例要加入的安全组，视为合规。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungskonfiguration hat keine angehängten Sicherheitsgruppen, was zu Instanzen ohne ordnungsgemäße Netzwerkzugriffskontrolle führen kann.", "en": "The ESS scaling configuration does not have security groups attached, which may result in instances without proper network access control.", "es": "La configuración de escalado ESS no tiene grupos de seguridad adjuntos, lo que puede resultar en instancias sin control de acceso de red adecuado.", "fr": "La configuration de mise à l'échelle ESS n'a pas de groupes de sécurité attachés, ce qui peut entraîner des instances sans contrôle d'accès réseau approprié.", "ja": "ESS スケーリング設定にセキュリティグループがアタッチされていないため、適切なネットワークアクセス制御がないインスタンスが発生する可能性があります。", "pt": "A configuração de escalonamento ESS não tem grupos de segurança anexados, o que pode resultar em instâncias sem controle de acesso de rede adequado.", "zh": "弹性伸缩配置未关联安全组，实例可能缺少网络访问控制。"}, Recommendation: models.I18nString{"de": "Fügen Sie Sicherheitsgruppen zur Skalierungskonfiguration hinzu, indem Sie die Eigenschaften SecurityGroupId oder SecurityGroupIds verwenden.", "en": "Add security groups to the scaling configuration using SecurityGroupId or SecurityGroupIds properties.", "es": "Agregue grupos de seguridad a la configuración de escalado usando las propiedades SecurityGroupId o SecurityGroupIds.", "fr": "Ajoutez des groupes de sécurité à la configuration de mise à l'échelle en utilisant les propriétés SecurityGroupId ou SecurityGroupIds.", "ja": "SecurityGroupId または SecurityGroupIds プロパティを使用して、スケーリング設定にセキュリティグループを追加します。", "pt": "Adicione grupos de segurança à configuração de escalonamento usando as propriedades SecurityGroupId ou SecurityGroupIds.", "zh": "在伸缩配置中使用 SecurityGroupId 或 SecurityGroupIds 属性添加安全组。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingConfiguration"}, FilePath: "aliyun/rules/ess-scaling-configuration-attach-security-group.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_configuration_attach_security_group", Content: "package infraguard.rules.aliyun.ess_scaling_configuration_attach_security_group\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-scaling-configuration-attach-security-group\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Configuration Security Group\",\n\t\t\"zh\": \"弹性伸缩配置中为实例设置关联安全组\",\n\t\t\"ja\": \"ESS スケーリング設定セキュリティグループ\",\n\t\t\"de\": \"ESS-Skalierungskonfiguration Sicherheitsgruppe\",\n\t\t\"es\": \"Grupo de Seguridad de Configuración de Escalado ESS\",\n\t\t\"fr\": \"Groupe de Sécurité de Configuration de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Grupo de Segurança de Configuração de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling configurations should attach security groups to instances for proper network isolation and access control.\",\n\t\t\"zh\": \"弹性伸缩配置中设置了实例要加入的安全组，视为合规。\",\n\t\t\"ja\": \"ESS スケーリング設定は、適切なネットワーク分離とアクセス制御のためにインスタンスにセキュリティグループをアタッチする必要があります。\",\n\t\t\"de\": \"ESS-Skalierungskonfigurationen sollten Sicherheitsgruppen an Instanzen anhängen, um ordnungsgemäße Netzwerkisolation und Zugriffskontrolle zu gewährleisten.\",\n\t\t\"es\": \"Las configuraciones de escalado ESS deben adjuntar grupos de seguridad a las instancias para un aislamiento de red y control de acceso adecuados.\",\n\t\t\"fr\": \"Les configurations de mise à l'échelle ESS doivent attacher des groupes de sécurité aux instances pour une isolation réseau et un contrôle d'accès appropriés.\",\n\t\t\"pt\": \"As configurações de escalonamento ESS devem anexar grupos de segurança às instâncias para isolamento de rede e controle de acesso adequados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling configuration does not have security groups attached, which may result in instances without proper network access control.\",\n\t\t\"zh\": \"弹性伸缩配置未关联安全组，实例可能缺少网络访问控制。\",\n\t\t\"ja\": \"ESS スケーリング設定にセキュリティグループがアタッチされていないため、適切なネットワークアクセス制御がないインスタンスが発生する可能性があります。\",\n\t\t\"de\": \"Die ESS-Skalierungskonfiguration hat keine angehängten Sicherheitsgruppen, was zu Instanzen ohne ordnungsgemäße Netzwerkzugriffskontrolle führen kann.\",\n\t\t\"es\": \"La configuración de escalado ESS no tiene grupos de seguridad adjuntos, lo que puede resultar en instancias sin control de acceso de red adecuado.\",\n\t\t\"fr\": \"La configuration de mise à l'échelle ESS n'a pas de groupes de sécurité attachés, ce qui peut entraîner des instances sans contrôle d'accès réseau approprié.\",\n\t\t\"pt\": \"A configuração de escalonamento ESS não tem grupos de segurança anexados, o que pode resultar em instâncias sem controle de acesso de rede adequado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add security groups to the scaling configuration using SecurityGroupId or SecurityGroupIds properties.\",\n\t\t\"zh\": \"在伸缩配置中使用 SecurityGroupId 或 SecurityGroupIds 属性添加安全组。\",\n\t\t\"ja\": \"SecurityGroupId または SecurityGroupIds プロパティを使用して、スケーリング設定にセキュリティグループを追加します。\",\n\t\t\"de\": \"Fügen Sie Sicherheitsgruppen zur Skalierungskonfiguration hinzu, indem Sie die Eigenschaften SecurityGroupId oder SecurityGroupIds verwenden.\",\n\t\t\"es\": \"Agregue grupos de seguridad a la configuración de escalado usando las propiedades SecurityGroupId o SecurityGroupIds.\",\n\t\t\"fr\": \"Ajoutez des groupes de sécurité à la configuration de mise à l'échelle en utilisant les propriétés SecurityGroupId ou SecurityGroupIds.\",\n\t\t\"pt\": \"Adicione grupos de segurança à configuração de escalonamento usando as propriedades SecurityGroupId ou SecurityGroupIds.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingConfiguration\"]\n}\n\n# Check if scaling configuration has security groups attached\nhas_security_group(resource) if {\n\tsecurity_group_id := helpers.get_property(resource, \"SecurityGroupId\", \"\")\n\tsecurity_group_id != \"\"\n}\n\nhas_security_group(resource) if {\n\tsecurity_group_ids := helpers.get_property(resource, \"SecurityGroupIds\", [])\n\tcount(security_group_ids) > 0\n}\n\n# Deny rule: ESS scaling configurations must have security groups attached\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingConfiguration\")\n\tnot has_security_group(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-configuration-data-disk-encrypted", Name: models.I18nString{"de": "ESS-Skalierungskonfiguration Datenfestplattenverschlüsselung", "en": "ESS Scaling Configuration Data Disk Encryption", "es": "Cifrado de Disco de Datos de Configuración de Escalado ESS", "fr": "Chiffrement de Disque de Données de Configuration de Mise à l'Échelle ESS", "ja": "ESS スケーリング設定データディスク暗号化", "pt": "Criptografia de Disco de Dados de Configuração de Escalonamento ESS", "zh": "弹性伸缩配置中设置数据磁盘加密"}, Severity: "high", Description: models.I18nString{"de": "ESS-Skalierungskonfigurationen sollten Datenfestplattenverschlüsselung aktivieren, um ruhende Daten zu schützen.", "en": "ESS scaling configurations should enable data disk encryption to protect data at rest.", "es": "Las configuraciones de escalado ESS deben habilitar el cifrado de disco de datos para proteger los datos en reposo.", "fr": "Les configurations de mise à l'échelle ESS doivent activer le chiffrement des disques de données pour protéger les données au repos.", "ja": "ESS スケーリング設定は、保存データを保護するためにデータディスク暗号化を有効にする必要があります。", "pt": "As configurações de escalonamento ESS devem habilitar a criptografia de disco de dados para proteger dados em repouso.", "zh": "弹性伸缩配置中数据磁盘配置均设置为加密，视为合规。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungskonfiguration hat Datenfestplatten, die nicht verschlüsselt sind, was ruhende sensible Daten aussetzen kann.", "en": "The ESS scaling configuration has data disks that are not encrypted, which may expose sensitive data at rest.", "es": "La configuración de escalado ESS tiene discos de datos que no están cifrados, lo que puede exponer datos sensibles en reposo.", "fr": "La configuration de mise à l'échelle ESS a des disques de données qui ne sont pas chiffrés, ce qui peut exposer des données sensibles au repos.", "ja": "ESS スケーリング設定に暗号化されていないデータディスクがあり、保存データが漏洩する可能性があります。", "pt": "A configuração de escalonamento ESS tem discos de dados que não estão criptografados, o que pode expor dados sensíveis em repouso.", "zh": "弹性伸缩配置中的数据磁盘未加密，静态数据可能面临泄露风险。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Verschlüsselung für alle Datenfestplatten in der Skalierungskonfiguration, indem Sie DiskMappings[*].Encrypted auf true setzen.", "en": "Enable encryption for all data disks in the scaling configuration by setting DiskMappings[*].Encrypted to true.", "es": "Habilite el cifrado para todos los discos de datos en la configuración de escalado estableciendo DiskMappings[*].Encrypted en true.", "fr": "Activez le chiffrement pour tous les disques de données dans la configuration de mise à l'échelle en définissant DiskMappings[*].Encrypted sur true.", "ja": "スケーリング設定で DiskMappings[*].Encrypted を true に設定して、すべてのデータディスクの暗号化を有効にします。", "pt": "Habilite a criptografia para todos os discos de dados na configuração de escalonamento definindo DiskMappings[*].Encrypted como true.", "zh": "在伸缩配置中，将所有数据磁盘的 DiskMappings[*].Encrypted 设置为 true 以启用加密。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingConfiguration"}, FilePath: "aliyun/rules/ess-scaling-configuration-data-disk-encrypted.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_configuration_data_disk_encrypted", Content: "package infraguard.rules.aliyun.ess_scaling_configuration_data_disk_encrypted\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-scaling-configuration-data-disk-encrypted\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Configuration Data Disk Encryption\",\n\t\t\"zh\": \"弹性伸缩配置中设置数据磁盘加密\",\n\t\t\"ja\": \"ESS スケーリング設定データディスク暗号化\",\n\t\t\"de\": \"ESS-Skalierungskonfiguration Datenfestplattenverschlüsselung\",\n\t\t\"es\": \"Cifrado de Disco de Datos de Configuración de Escalado ESS\",\n\t\t\"fr\": \"Chiffrement de Disque de Données de Configuration de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Criptografia de Disco de Dados de Configuração de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling configurations should enable data disk encryption to protect data at rest.\",\n\t\t\"zh\": \"弹性伸缩配置中数据磁盘配置均设置为加密，视为合规。\",\n\t\t\"ja\": \"ESS スケーリング設定は、保存データを保護するためにデータディスク暗号化を有効にする必要があります。\",\n\t\t\"de\": \"ESS-Skalierungskonfigurationen sollten Datenfestplattenverschlüsselung aktivieren, um ruhende Daten zu schützen.\",\n\t\t\"es\": \"Las configuraciones de escalado ESS deben habilitar el cifrado de disco de datos para proteger los datos en reposo.\",\n\t\t\"fr\": \"Les configurations de mise à l'échelle ESS doivent activer le chiffrement des disques de données pour protéger les données au repos.\",\n\t\t\"pt\": \"As configurações de escalonamento ESS devem habilitar a criptografia de disco de dados para proteger dados em repouso.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling configuration has data disks that are not encrypted, which may expose sensitive data at rest.\",\n\t\t\"zh\": \"弹性伸缩配置中的数据磁盘未加密，静态数据可能面临泄露风险。\",\n\t\t\"ja\": \"ESS スケーリング設定に暗号化されていないデータディスクがあり、保存データが漏洩する可能性があります。\",\n\t\t\"de\": \"Die ESS-Skalierungskonfiguration hat Datenfestplatten, die nicht verschlüsselt sind, was ruhende sensible Daten aussetzen kann.\",\n\t\t\"es\": \"La configuración de escalado ESS tiene discos de datos que no están cifrados, lo que puede exponer datos sensibles en reposo.\",\n\t\t\"fr\": \"La configuration de mise à l'échelle ESS a des disques de données qui ne sont pas chiffrés, ce qui peut exposer des données sensibles au repos.\",\n\t\t\"pt\": \"A configuração de escalonamento ESS tem discos de dados que não estão criptografados, o que pode expor dados sensíveis em repouso.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable encryption for all data disks in the scaling configuration by setting DiskMappings[*].Encrypted to true.\",\n\t\t\"zh\": \"在伸缩配置中，将所有数据磁盘的 DiskMappings[*].Encrypted 设置为 true 以启用加密。\",\n\t\t\"ja\": \"スケーリング設定で DiskMappings[*].Encrypted を true に設定して、すべてのデータディスクの暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Verschlüsselung für alle Datenfestplatten in der Skalierungskonfiguration, indem Sie DiskMappings[*].Encrypted auf true setzen.\",\n\t\t\"es\": \"Habilite el cifrado para todos los discos de datos en la configuración de escalado estableciendo DiskMappings[*].Encrypted en true.\",\n\t\t\"fr\": \"Activez le chiffrement pour tous les disques de données dans la configuration de mise à l'échelle en définissant DiskMappings[*].Encrypted sur true.\",\n\t\t\"pt\": \"Habilite a criptografia para todos os discos de dados na configuração de escalonamento definindo DiskMappings[*].Encrypted como true.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingConfiguration\"]\n}\n\n# Check if all data disks are encrypted\nall_data_disks_encrypted(resource) if {\n\tdisk_mappings := helpers.get_property(resource, \"DiskMappings\", [])\n\tdisk_mappings == []\n}\n\nall_data_disks_encrypted(resource) if {\n\tdisk_mappings := helpers.get_property(resource, \"DiskMappings\", [])\n\tdisk_mappings != []\n\tevery disk in disk_mappings {\n\t\tdisk.Encrypted == true\n\t}\n}\n\nall_data_disks_encrypted(resource) if {\n\tdisk_mappings := helpers.get_property(resource, \"DiskMappings\", [])\n\tdisk_mappings != []\n\tevery disk in disk_mappings {\n\t\tdisk.Encrypted == \"true\"\n\t}\n}\n\n# Deny rule: ESS scaling configurations must have all data disks encrypted\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingConfiguration\")\n\tnot all_data_disks_encrypted(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DiskMappings\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-configuration-enabled-internet-check", Name: models.I18nString{"de": "ESS-Skalierungskonfiguration Internetzugriffsprüfung", "en": "ESS Scaling Configuration Internet Access Check", "es": "Verificación de Acceso a Internet de Configuración de Escalado ESS", "fr": "Vérification de l'Accès Internet de la Configuration de Mise à l'Échelle ESS", "ja": "ESS スケーリング設定のインターネットアクセチェック", "pt": "Verificação de Acesso à Internet da Configuração de Escalonamento ESS", "zh": "ESS 伸缩配置公网访问检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass ESS-Skalierungskonfigurationen keine öffentlichen IP-Adressen für Instanzen aktivieren, es sei denn, es ist notwendig.", "en": "Ensures that ESS scaling configurations do not enable public IP addresses for instances unless necessary.", "es": "Garantiza que las configuraciones de escalado ESS no habiliten direcciones IP públicas para instancias a menos que sea necesario.", "fr": "Garantit que les configurations de mise à l'échelle ESS n'activent pas d'adresses IP publiques pour les instances sauf si nécessaire.", "ja": "ESS スケーリング設定が、必要でない限りインスタンスにパブリック IP アドレスを有効にしないことを確認します。", "pt": "Garante que as configurações de escalonamento ESS não habilitem endereços IP públicos para instâncias, a menos que seja necessário.", "zh": "确保 ESS 伸缩配置未为实例开启公网 IP 地址，除非必要。"}, Reason: models.I18nString{"de": "Das Aktivieren öffentlicher IPs für alle Instanzen in einer Skalierungsgruppe erhöht die Angriffsfläche.", "en": "Enabling public IPs for all instances in a scaling group increases the attack surface.", "es": "Habilitar IPs públicas para todas las instancias en un grupo de escalado aumenta la superficie de ataque.", "fr": "Activer les IP publiques pour toutes les instances d'un groupe de mise à l'échelle augmente la surface d'attaque.", "ja": "スケーリンググループ内のすべてのインスタンスにパブリック IP を有効にすると、攻撃面が増加します。", "pt": "Habilitar IPs públicos para todas as instâncias em um grupo de escalonamento aumenta a superfície de ataque.", "zh": "为伸缩组中的所有实例开启公网 IP 会增加攻击面。"}, Recommendation: models.I18nString{"de": "Verwenden Sie interne IPs und ein NAT-Gateway oder SLB für den Internetzugriff, anstatt öffentliche IPs auf jeder Instanz zu verwenden.", "en": "Use internal IPs and a NAT gateway or SLB for internet access instead of public IPs on each instance.", "es": "Use IPs internas y una puerta de enlace NAT o SLB para acceso a internet en lugar de IPs públicas en cada instancia.", "fr": "Utilisez des IP internes et une passerelle NAT ou SLB pour l'accès Internet au lieu d'IP publiques sur chaque instance.", "ja": "各インスタンスでパブリック IP を使用する代わりに、内部 IP と NAT ゲートウェイまたは SLB を使用してインターネットアクセスを行います。", "pt": "Use IPs internos e um gateway NAT ou SLB para acesso à internet em vez de IPs públicos em cada instância.", "zh": "使用内网 IP 和 NAT 网关或 SLB 进行公网访问，而不是在每个实例上使用公网 IP。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingConfiguration"}, FilePath: "aliyun/rules/ess-scaling-configuration-enabled-internet-check.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_configuration_enabled_internet_check", Content: "package infraguard.rules.aliyun.ess_scaling_configuration_enabled_internet_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-scaling-configuration-enabled-internet-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Configuration Internet Access Check\",\n\t\t\"zh\": \"ESS 伸缩配置公网访问检测\",\n\t\t\"ja\": \"ESS スケーリング設定のインターネットアクセチェック\",\n\t\t\"de\": \"ESS-Skalierungskonfiguration Internetzugriffsprüfung\",\n\t\t\"es\": \"Verificación de Acceso a Internet de Configuración de Escalado ESS\",\n\t\t\"fr\": \"Vérification de l'Accès Internet de la Configuration de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Verificação de Acesso à Internet da Configuração de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that ESS scaling configurations do not enable public IP addresses for instances unless necessary.\",\n\t\t\"zh\": \"确保 ESS 伸缩配置未为实例开启公网 IP 地址，除非必要。\",\n\t\t\"ja\": \"ESS スケーリング設定が、必要でない限りインスタンスにパブリック IP アドレスを有効にしないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass ESS-Skalierungskonfigurationen keine öffentlichen IP-Adressen für Instanzen aktivieren, es sei denn, es ist notwendig.\",\n\t\t\"es\": \"Garantiza que las configuraciones de escalado ESS no habiliten direcciones IP públicas para instancias a menos que sea necesario.\",\n\t\t\"fr\": \"Garantit que les configurations de mise à l'échelle ESS n'activent pas d'adresses IP publiques pour les instances sauf si nécessaire.\",\n\t\t\"pt\": \"Garante que as configurações de escalonamento ESS não habilitem endereços IP públicos para instâncias, a menos que seja necessário.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Enabling public IPs for all instances in a scaling group increases the attack surface.\",\n\t\t\"zh\": \"为伸缩组中的所有实例开启公网 IP 会增加攻击面。\",\n\t\t\"ja\": \"スケーリンググループ内のすべてのインスタンスにパブリック IP を有効にすると、攻撃面が増加します。\",\n\t\t\"de\": \"Das Aktivieren öffentlicher IPs für alle Instanzen in einer Skalierungsgruppe erhöht die Angriffsfläche.\",\n\t\t\"es\": \"Habilitar IPs públicas para todas las instancias en un grupo de escalado aumenta la superficie de ataque.\",\n\t\t\"fr\": \"Activer les IP publiques pour toutes les instances d'un groupe de mise à l'échelle augmente la surface d'attaque.\",\n\t\t\"pt\": \"Habilitar IPs públicos para todas as instâncias em um grupo de escalonamento aumenta a superfície de ataque.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use internal IPs and a NAT gateway or SLB for internet access instead of public IPs on each instance.\",\n\t\t\"zh\": \"使用内网 IP 和 NAT 网关或 SLB 进行公网访问，而不是在每个实例上使用公网 IP。\",\n\t\t\"ja\": \"各インスタンスでパブリック IP を使用する代わりに、内部 IP と NAT ゲートウェイまたは SLB を使用してインターネットアクセスを行います。\",\n\t\t\"de\": \"Verwenden Sie interne IPs und ein NAT-Gateway oder SLB für den Internetzugriff, anstatt öffentliche IPs auf jeder Instanz zu verwenden.\",\n\t\t\"es\": \"Use IPs internas y una puerta de enlace NAT o SLB para acceso a internet en lugar de IPs públicas en cada instancia.\",\n\t\t\"fr\": \"Utilisez des IP internes et une passerelle NAT ou SLB pour l'accès Internet au lieu d'IP publiques sur chaque instance.\",\n\t\t\"pt\": \"Use IPs internos e um gateway NAT ou SLB para acesso à internet em vez de IPs públicos em cada instância.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingConfiguration\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingConfiguration\")\n\thelpers.get_property(resource, \"InternetMaxBandwidthOut\", 0) > 0\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InternetMaxBandwidthOut\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-configuration-image-check", Name: models.I18nString{"de": "ESS-Skalierungskonfiguration Bildprüfung", "en": "ESS Scaling Configuration Image Check", "es": "Verificación de Imagen de Configuración de Escalado ESS", "fr": "Vérification d'Image de Configuration de Mise à l'Échelle ESS", "ja": "ESS スケーリング設定イメージチェック", "pt": "Verificação de Imagem da Configuração de Escalonamento ESS", "zh": "弹性伸缩配置镜像检测"}, Severity: "medium", Description: models.I18nString{"de": "ESS-Skalierungskonfigurationen sollten gewartete Images verwenden, um Sicherheit und Stabilität zu gewährleisten.", "en": "ESS scaling configurations should use maintained images to ensure security and stability.", "es": "Las configuraciones de escalado ESS deben usar imágenes mantenidas para garantizar seguridad y estabilidad.", "fr": "Les configurations de mise à l'échelle ESS doivent utiliser des images maintenues pour assurer la sécurité et la stabilité.", "ja": "ESS スケーリング設定は、セキュリティと安定性を確保するために、メンテナンスされたイメージを使用する必要があります。", "pt": "As configurações de escalonamento ESS devem usar imagens mantidas para garantir segurança e estabilidade.", "zh": "弹性伸缩配置中镜像为保有中资源，视为合规。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungskonfiguration verwendet möglicherweise ein Image, das nicht mehr gewartet oder verfügbar ist.", "en": "The ESS scaling configuration may be using an image that is no longer maintained or available.", "es": "La configuración de escalado ESS puede estar usando una imagen que ya no se mantiene o está disponible.", "fr": "La configuration de mise à l'échelle ESS peut utiliser une image qui n'est plus maintenue ou disponible.", "ja": "ESS スケーリング設定が、もはやメンテナンスされていないか、利用できないイメージを使用している可能性があります。", "pt": "A configuração de escalonamento ESS pode estar usando uma imagem que não é mais mantida ou disponível.", "zh": "弹性伸缩配置中使用的镜像可能已不再维护或不再可用。"}, Recommendation: models.I18nString{"de": "Verwenden Sie Images, die sich im Wartungsstatus befinden. Sie können ImageId- oder ImageFamily-Eigenschaften mit gültigen Image-IDs verwenden.", "en": "Use images that are in maintained status. You can use ImageId or ImageFamily properties with valid image IDs.", "es": "Use imágenes que estén en estado mantenido. Puede usar las propiedades ImageId o ImageFamily con ID de imagen válidos.", "fr": "Utilisez des images qui sont en état maintenu. Vous pouvez utiliser les propriétés ImageId ou ImageFamily avec des ID d'image valides.", "ja": "メンテナンス状態のイメージを使用します。ImageId または ImageFamily プロパティで有効なイメージ ID を指定できます。", "pt": "Use imagens que estejam em status mantido. Você pode usar as propriedades ImageId ou ImageFamily com IDs de imagem válidos.", "zh": "使用状态为保有中的镜像资源。可通过 ImageId 或 ImageFamily 属性指定有效镜像 ID。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingConfiguration"}, FilePath: "aliyun/rules/ess-scaling-configuration-image-check.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_configuration_image_check", Content: "package infraguard.rules.aliyun.ess_scaling_configuration_image_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-scaling-configuration-image-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Configuration Image Check\",\n\t\t\"zh\": \"弹性伸缩配置镜像检测\",\n\t\t\"ja\": \"ESS スケーリング設定イメージチェック\",\n\t\t\"de\": \"ESS-Skalierungskonfiguration Bildprüfung\",\n\t\t\"es\": \"Verificación de Imagen de Configuración de Escalado ESS\",\n\t\t\"fr\": \"Vérification d'Image de Configuration de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Verificação de Imagem da Configuração de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling configurations should use maintained images to ensure security and stability.\",\n\t\t\"zh\": \"弹性伸缩配置中镜像为保有中资源，视为合规。\",\n\t\t\"ja\": \"ESS スケーリング設定は、セキュリティと安定性を確保するために、メンテナンスされたイメージを使用する必要があります。\",\n\t\t\"de\": \"ESS-Skalierungskonfigurationen sollten gewartete Images verwenden, um Sicherheit und Stabilität zu gewährleisten.\",\n\t\t\"es\": \"Las configuraciones de escalado ESS deben usar imágenes mantenidas para garantizar seguridad y estabilidad.\",\n\t\t\"fr\": \"Les configurations de mise à l'échelle ESS doivent utiliser des images maintenues pour assurer la sécurité et la stabilité.\",\n\t\t\"pt\": \"As configurações de escalonamento ESS devem usar imagens mantidas para garantir segurança e estabilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling configuration may be using an image that is no longer maintained or available.\",\n\t\t\"zh\": \"弹性伸缩配置中使用的镜像可能已不再维护或不再可用。\",\n\t\t\"ja\": \"ESS スケーリング設定が、もはやメンテナンスされていないか、利用できないイメージを使用している可能性があります。\",\n\t\t\"de\": \"Die ESS-Skalierungskonfiguration verwendet möglicherweise ein Image, das nicht mehr gewartet oder verfügbar ist.\",\n\t\t\"es\": \"La configuración de escalado ESS puede estar usando una imagen que ya no se mantiene o está disponible.\",\n\t\t\"fr\": \"La configuration de mise à l'échelle ESS peut utiliser une image qui n'est plus maintenue ou disponible.\",\n\t\t\"pt\": \"A configuração de escalonamento ESS pode estar usando uma imagem que não é mais mantida ou disponível.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use images that are in maintained status. You can use ImageId or ImageFamily properties with valid image IDs.\",\n\t\t\"zh\": \"使用状态为保有中的镜像资源。可通过 ImageId 或 ImageFamily 属性指定有效镜像 ID。\",\n\t\t\"ja\": \"メンテナンス状態のイメージを使用します。ImageId または ImageFamily プロパティで有効なイメージ ID を指定できます。\",\n\t\t\"de\": \"Verwenden Sie Images, die sich im Wartungsstatus befinden. Sie können ImageId- oder ImageFamily-Eigenschaften mit gültigen Image-IDs verwenden.\",\n\t\t\"es\": \"Use imágenes que estén en estado mantenido. Puede usar las propiedades ImageId o ImageFamily con ID de imagen válidos.\",\n\t\t\"fr\": \"Utilisez des images qui sont en état maintenu. Vous pouvez utiliser les propriétés ImageId ou ImageFamily avec des ID d'image valides.\",\n\t\t\"pt\": \"Use imagens que estejam em status mantido. Você pode usar as propriedades ImageId ou ImageFamily com IDs de imagem válidos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingConfiguration\"]\n}\n\n# Check if scaling configuration has a valid image\nhas_valid_image(resource) if {\n\timage_id := helpers.get_property(resource, \"ImageId\", \"\")\n\timage_id != \"\"\n}\n\nhas_valid_image(resource) if {\n\timage_family := helpers.get_property(resource, \"ImageFamily\", \"\")\n\timage_family != \"\"\n}\n\n# Deny rule: ESS scaling configurations must have a valid image\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingConfiguration\")\n\tnot has_valid_image(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ImageId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-configuration-image-type-check", Name: models.I18nString{"de": "ESS-Skalierungskonfiguration Bildtyp-Prüfung", "en": "ESS Scaling Configuration Image Type Check", "es": "Verificación de Tipo de Imagen de Configuración de Escalado ESS", "fr": "Vérification du Type d'Image de Configuration de Mise à l'Échelle ESS", "ja": "ESS スケーリング設定イメージタイプチェック", "pt": "Verificação de Tipo de Imagem de Configuração de Escalonamento ESS", "zh": "弹性伸缩配置中使用指定来源的镜像"}, Severity: "medium", Description: models.I18nString{"de": "ESS-Skalierungskonfigurationen sollten Bilder aus angegebenen Quellen für bessere Sicherheit und Verwaltung verwenden.", "en": "ESS scaling configurations should use images from specified sources for better security and management.", "es": "Las configuraciones de escalado ESS deben usar imágenes de fuentes especificadas para mayor seguridad y gestión.", "fr": "Les configurations de mise à l'échelle ESS doivent utiliser des images provenant de sources spécifiées pour une meilleure sécurité et gestion.", "ja": "ESS スケーリング設定は、セキュリティと管理を向上させるために、指定されたソースからのイメージを使用する必要があります。", "pt": "As configurações de escalonamento ESS devem usar imagens de fontes especificadas para melhor segurança e gerenciamento.", "zh": "弹性伸缩配置中镜像来源为指定类型的来源，视为合规。参数默认值为共享类型。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungskonfiguration verwendet kein Image vom angegebenen Quelltyp.", "en": "The ESS scaling configuration is not using an image from the specified source type.", "es": "La configuración de escalado ESS no está usando una imagen del tipo de fuente especificado.", "fr": "La configuration de mise à l'échelle ESS n'utilise pas une image du type de source spécifié.", "ja": "ESS スケーリング設定が指定されたソースタイプからのイメージを使用していません。", "pt": "A configuração de escalonamento ESS não está usando uma imagem do tipo de fonte especificado.", "zh": "弹性伸缩配置中镜像来源非指定类型，可能存在安全风险或管理问题。"}, Recommendation: models.I18nString{"de": "Verwenden Sie Bilder aus vertrauenswürdigen Quellen. Legen Sie den Bildquelltyp gemäß Ihren Sicherheitsanforderungen fest.", "en": "Use images from trusted sources. Set the image source type according to your security requirements.", "es": "Use imágenes de fuentes confiables. Establezca el tipo de fuente de imagen según sus requisitos de seguridad.", "fr": "Utilisez des images provenant de sources de confiance. Définissez le type de source d'image selon vos exigences de sécurité.", "ja": "信頼できるソースからのイメージを使用します。セキュリティ要件に応じてイメージソースタイプを設定します。", "pt": "Use imagens de fontes confiáveis. Defina o tipo de fonte da imagem de acordo com seus requisitos de segurança.", "zh": "使用来自可信来源的镜像。根据安全要求设置镜像来源类型。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingConfiguration"}, FilePath: "aliyun/rules/ess-scaling-configuration-image-type-check.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_configuration_image_type_check", Content: "package infraguard.rules.aliyun.ess_scaling_configuration_image_type_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ess-scaling-configuration-image-type-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Configuration Image Type Check\",\n\t\t\"zh\": \"弹性伸缩配置中使用指定来源的镜像\",\n\t\t\"ja\": \"ESS スケーリング設定イメージタイプチェック\",\n\t\t\"de\": \"ESS-Skalierungskonfiguration Bildtyp-Prüfung\",\n\t\t\"es\": \"Verificación de Tipo de Imagen de Configuración de Escalado ESS\",\n\t\t\"fr\": \"Vérification du Type d'Image de Configuration de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Verificação de Tipo de Imagem de Configuração de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling configurations should use images from specified sources for better security and management.\",\n\t\t\"zh\": \"弹性伸缩配置中镜像来源为指定类型的来源，视为合规。参数默认值为共享类型。\",\n\t\t\"ja\": \"ESS スケーリング設定は、セキュリティと管理を向上させるために、指定されたソースからのイメージを使用する必要があります。\",\n\t\t\"de\": \"ESS-Skalierungskonfigurationen sollten Bilder aus angegebenen Quellen für bessere Sicherheit und Verwaltung verwenden.\",\n\t\t\"es\": \"Las configuraciones de escalado ESS deben usar imágenes de fuentes especificadas para mayor seguridad y gestión.\",\n\t\t\"fr\": \"Les configurations de mise à l'échelle ESS doivent utiliser des images provenant de sources spécifiées pour une meilleure sécurité et gestion.\",\n\t\t\"pt\": \"As configurações de escalonamento ESS devem usar imagens de fontes especificadas para melhor segurança e gerenciamento.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling configuration is not using an image from the specified source type.\",\n\t\t\"zh\": \"弹性伸缩配置中镜像来源非指定类型，可能存在安全风险或管理问题。\",\n\t\t\"ja\": \"ESS スケーリング設定が指定されたソースタイプからのイメージを使用していません。\",\n\t\t\"de\": \"Die ESS-Skalierungskonfiguration verwendet kein Image vom angegebenen Quelltyp.\",\n\t\t\"es\": \"La configuración de escalado ESS no está usando una imagen del tipo de fuente especificado.\",\n\t\t\"fr\": \"La configuration de mise à l'échelle ESS n'utilise pas une image du type de source spécifié.\",\n\t\t\"pt\": \"A configuração de escalonamento ESS não está usando uma imagem do tipo de fonte especificado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use images from trusted sources. Set the image source type according to your security requirements.\",\n\t\t\"zh\": \"使用来自可信来源的镜像。根据安全要求设置镜像来源类型。\",\n\t\t\"ja\": \"信頼できるソースからのイメージを使用します。セキュリティ要件に応じてイメージソースタイプを設定します。\",\n\t\t\"de\": \"Verwenden Sie Bilder aus vertrauenswürdigen Quellen. Legen Sie den Bildquelltyp gemäß Ihren Sicherheitsanforderungen fest.\",\n\t\t\"es\": \"Use imágenes de fuentes confiables. Establezca el tipo de fuente de imagen según sus requisitos de seguridad.\",\n\t\t\"fr\": \"Utilisez des images provenant de sources de confiance. Définissez le type de source d'image selon vos exigences de sécurité.\",\n\t\t\"pt\": \"Use imagens de fontes confiáveis. Defina o tipo de fonte da imagem de acordo com seus requisitos de segurança.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingConfiguration\"]\n}\n\nhas_specified_image_type(resource) if {\n\timage_id := helpers.get_property(resource, \"ImageId\", \"\")\n\timage_id != \"\"\n}\n\nhas_specified_image_type(resource) if {\n\timage_family := helpers.get_property(resource, \"ImageFamily\", \"\")\n\timage_family != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingConfiguration\")\n\tnot has_specified_image_type(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ImageId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-configuration-sg-public-access", Name: models.I18nString{"de": "ESS-Skalierungskonfiguration Sicherheitsgruppe Öffentlicher Zugriff", "en": "ESS Scaling Configuration Security Group Public Access", "es": "Acceso Público del Grupo de Seguridad de Configuración de Escalado ESS", "fr": "Accès Public du Groupe de Sécurité de Configuration de Mise à l'Échelle ESS", "ja": "ESS スケーリング設定セキュリティグループパブリックアクセス", "pt": "Acesso Público do Grupo de Segurança de Configuração de Escalonamento ESS", "zh": "ESS 伸缩组配置的安全组不应设置为 0.0.0.0/0"}, Severity: "high", Description: models.I18nString{"de": "ESS-Skalierungskonfigurations-Sicherheitsgruppen sollten keinen Zugriff von 0.0.0.0/0 zulassen, um unbefugten Zugriff zu verhindern.", "en": "ESS scaling configuration security groups should not allow access from 0.0.0.0/0 to prevent unauthorized access.", "es": "Los grupos de seguridad de configuración de escalado ESS no deben permitir el acceso desde 0.0.0.0/0 para prevenir el acceso no autorizado.", "fr": "Les groupes de sécurité de configuration de mise à l'échelle ESS ne doivent pas autoriser l'accès depuis 0.0.0.0/0 pour empêcher l'accès non autorisé.", "ja": "ESS スケーリング設定のセキュリティグループは、不正アクセスを防ぐために 0.0.0.0/0 からのアクセスを許可すべきではありません。", "pt": "Os grupos de segurança de configuração de escalonamento ESS não devem permitir acesso de 0.0.0.0/0 para prevenir acesso não autorizado.", "zh": "ESS 伸缩组配置中的安全组不包含 0.0.0.0/0，则视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe der ESS-Skalierungskonfiguration erlaubt Zugriff von 0.0.0.0/0, was Instanzen dem öffentlichen Internet aussetzen kann.", "en": "The ESS scaling configuration's security group allows access from 0.0.0.0/0, which may expose instances to the public internet.", "es": "El grupo de seguridad de la configuración de escalado ESS permite el acceso desde 0.0.0.0/0, lo que puede exponer las instancias a Internet público.", "fr": "Le groupe de sécurité de la configuration de mise à l'échelle ESS autorise l'accès depuis 0.0.0.0/0, ce qui peut exposer les instances à Internet public.", "ja": "ESS スケーリング設定のセキュリティグループが 0.0.0.0/0 からのアクセスを許可しており、インスタンスがパブリックインターネットに公開される可能性があります。", "pt": "O grupo de segurança da configuração de escalonamento ESS permite acesso de 0.0.0.0/0, o que pode expor instâncias à Internet pública.", "zh": "ESS 伸缩组配置的安全组规则中允许 0.0.0.0/0 访问，可能导致实例暴露于公网。"}, Recommendation: models.I18nString{"de": "Beschränken Sie Sicherheitsgruppenregeln auf spezifische IP-Bereiche anstelle von 0.0.0.0/0.", "en": "Restrict security group rules to specific IP ranges instead of 0.0.0.0/0.", "es": "Restrinja las reglas del grupo de seguridad a rangos de IP específicos en lugar de 0.0.0.0/0.", "fr": "Restreignez les règles du groupe de sécurité à des plages d'IP spécifiques au lieu de 0.0.0.0/0.", "ja": "セキュリティグループルールを 0.0.0.0/0 の代わりに特定の IP 範囲に制限します。", "pt": "Restrinja as regras do grupo de segurança a intervalos de IP específicos em vez de 0.0.0.0/0.", "zh": "将安全组规则限制为特定 IP 范围，避免使用 0.0.0.0/0。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingConfiguration"}, FilePath: "aliyun/rules/ess-scaling-configuration-sg-public-access.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_configuration_sg_public_access", Content: "package infraguard.rules.aliyun.ess_scaling_configuration_sg_public_access\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ess-scaling-configuration-sg-public-access\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Configuration Security Group Public Access\",\n\t\t\"zh\": \"ESS 伸缩组配置的安全组不应设置为 0.0.0.0/0\",\n\t\t\"ja\": \"ESS スケーリング設定セキュリティグループパブリックアクセス\",\n\t\t\"de\": \"ESS-Skalierungskonfiguration Sicherheitsgruppe Öffentlicher Zugriff\",\n\t\t\"es\": \"Acceso Público del Grupo de Seguridad de Configuración de Escalado ESS\",\n\t\t\"fr\": \"Accès Public du Groupe de Sécurité de Configuration de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Acesso Público do Grupo de Segurança de Configuração de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling configuration security groups should not allow access from 0.0.0.0/0 to prevent unauthorized access.\",\n\t\t\"zh\": \"ESS 伸缩组配置中的安全组不包含 0.0.0.0/0，则视为合规。\",\n\t\t\"ja\": \"ESS スケーリング設定のセキュリティグループは、不正アクセスを防ぐために 0.0.0.0/0 からのアクセスを許可すべきではありません。\",\n\t\t\"de\": \"ESS-Skalierungskonfigurations-Sicherheitsgruppen sollten keinen Zugriff von 0.0.0.0/0 zulassen, um unbefugten Zugriff zu verhindern.\",\n\t\t\"es\": \"Los grupos de seguridad de configuración de escalado ESS no deben permitir el acceso desde 0.0.0.0/0 para prevenir el acceso no autorizado.\",\n\t\t\"fr\": \"Les groupes de sécurité de configuration de mise à l'échelle ESS ne doivent pas autoriser l'accès depuis 0.0.0.0/0 pour empêcher l'accès non autorisé.\",\n\t\t\"pt\": \"Os grupos de segurança de configuração de escalonamento ESS não devem permitir acesso de 0.0.0.0/0 para prevenir acesso não autorizado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling configuration's security group allows access from 0.0.0.0/0, which may expose instances to the public internet.\",\n\t\t\"zh\": \"ESS 伸缩组配置的安全组规则中允许 0.0.0.0/0 访问，可能导致实例暴露于公网。\",\n\t\t\"ja\": \"ESS スケーリング設定のセキュリティグループが 0.0.0.0/0 からのアクセスを許可しており、インスタンスがパブリックインターネットに公開される可能性があります。\",\n\t\t\"de\": \"Die Sicherheitsgruppe der ESS-Skalierungskonfiguration erlaubt Zugriff von 0.0.0.0/0, was Instanzen dem öffentlichen Internet aussetzen kann.\",\n\t\t\"es\": \"El grupo de seguridad de la configuración de escalado ESS permite el acceso desde 0.0.0.0/0, lo que puede exponer las instancias a Internet público.\",\n\t\t\"fr\": \"Le groupe de sécurité de la configuration de mise à l'échelle ESS autorise l'accès depuis 0.0.0.0/0, ce qui peut exposer les instances à Internet public.\",\n\t\t\"pt\": \"O grupo de segurança da configuração de escalonamento ESS permite acesso de 0.0.0.0/0, o que pode expor instâncias à Internet pública.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict security group rules to specific IP ranges instead of 0.0.0.0/0.\",\n\t\t\"zh\": \"将安全组规则限制为特定 IP 范围，避免使用 0.0.0.0/0。\",\n\t\t\"ja\": \"セキュリティグループルールを 0.0.0.0/0 の代わりに特定の IP 範囲に制限します。\",\n\t\t\"de\": \"Beschränken Sie Sicherheitsgruppenregeln auf spezifische IP-Bereiche anstelle von 0.0.0.0/0.\",\n\t\t\"es\": \"Restrinja las reglas del grupo de seguridad a rangos de IP específicos en lugar de 0.0.0.0/0.\",\n\t\t\"fr\": \"Restreignez les règles du groupe de sécurité à des plages d'IP spécifiques au lieu de 0.0.0.0/0.\",\n\t\t\"pt\": \"Restrinja as regras do grupo de segurança a intervalos de IP específicos em vez de 0.0.0.0/0.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingConfiguration\"]\n}\n\nhas_security_group(resource) if {\n\tsecurity_group_id := helpers.get_property(resource, \"SecurityGroupId\", \"\")\n\tsecurity_group_id != \"\"\n}\n\nhas_security_group(resource) if {\n\tsecurity_group_ids := helpers.get_property(resource, \"SecurityGroupIds\", [])\n\tcount(security_group_ids) > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingConfiguration\")\n\tnot has_security_group(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": \"The scaling configuration does not have explicit security groups configured.\",\n\t\t\t\"recommendation\": \"Configure specific security groups for the scaling configuration.\",\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-configuration-system-disk-encrypted", Name: models.I18nString{"de": "ESS-Skalierungskonfiguration System-Disk-Verschlüsselung", "en": "ESS Scaling Configuration System Disk Encryption", "es": "Cifrado de Disco del Sistema de Configuración de Escalado ESS", "fr": "Chiffrement du Disque Système de la Configuration de Mise à l'Échelle ESS", "ja": "ESS スケーリング設定のシステムディスク暗号化", "pt": "Criptografia de Disco do Sistema da Configuração de Escalonamento ESS", "zh": "弹性伸缩配置中设置系统磁盘加密"}, Severity: "high", Description: models.I18nString{"de": "ESS-Skalierungskonfigurationen sollten System-Disk-Verschlüsselung aktivieren, um Systemdaten im Ruhezustand zu schützen.", "en": "ESS scaling configurations should enable system disk encryption to protect system data at rest.", "es": "Las configuraciones de escalado ESS deben habilitar el cifrado del disco del sistema para proteger los datos del sistema en reposo.", "fr": "Les configurations de mise à l'échelle ESS doivent activer le chiffrement du disque système pour protéger les données système au repos.", "ja": "ESS スケーリング設定は、保存データを保護するためにシステムディスク暗号化を有効にする必要があります。", "pt": "As configurações de escalonamento ESS devem habilitar a criptografia do disco do sistema para proteger os dados do sistema em repouso.", "zh": "弹性伸缩配置中系统磁盘配置设置为加密，视为合规。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungskonfiguration hat keine System-Disk-Verschlüsselung aktiviert.", "en": "The ESS scaling configuration does not have system disk encryption enabled.", "es": "La configuración de escalado ESS no tiene cifrado del disco del sistema habilitado.", "fr": "La configuration de mise à l'échelle ESS n'a pas le chiffrement du disque système activé.", "ja": "ESS スケーリング設定でシステムディスク暗号化が有効になっていません。", "pt": "A configuração de escalonamento ESS não tem criptografia do disco do sistema habilitada.", "zh": "弹性伸缩配置中的系统磁盘未加密，静态数据可能面临泄露风险。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die System-Disk-Verschlüsselung in den Skalierungskonfigurationseinstellungen.", "en": "Enable system disk encryption in the scaling configuration settings.", "es": "Habilite el cifrado del disco del sistema en la configuración de escalado.", "fr": "Activez le chiffrement du disque système dans les paramètres de configuration de mise à l'échelle.", "ja": "スケーリング設定でシステムディスク暗号化を有効にします。", "pt": "Habilite a criptografia do disco do sistema nas configurações de escalonamento.", "zh": "在伸缩配置中启用系统磁盘加密功能。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingConfiguration"}, FilePath: "aliyun/rules/ess-scaling-configuration-system-disk-encrypted.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_configuration_system_disk_encrypted", Content: "package infraguard.rules.aliyun.ess_scaling_configuration_system_disk_encrypted\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-scaling-configuration-system-disk-encrypted\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Configuration System Disk Encryption\",\n\t\t\"zh\": \"弹性伸缩配置中设置系统磁盘加密\",\n\t\t\"ja\": \"ESS スケーリング設定のシステムディスク暗号化\",\n\t\t\"de\": \"ESS-Skalierungskonfiguration System-Disk-Verschlüsselung\",\n\t\t\"es\": \"Cifrado de Disco del Sistema de Configuración de Escalado ESS\",\n\t\t\"fr\": \"Chiffrement du Disque Système de la Configuration de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Criptografia de Disco do Sistema da Configuração de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling configurations should enable system disk encryption to protect system data at rest.\",\n\t\t\"zh\": \"弹性伸缩配置中系统磁盘配置设置为加密，视为合规。\",\n\t\t\"ja\": \"ESS スケーリング設定は、保存データを保護するためにシステムディスク暗号化を有効にする必要があります。\",\n\t\t\"de\": \"ESS-Skalierungskonfigurationen sollten System-Disk-Verschlüsselung aktivieren, um Systemdaten im Ruhezustand zu schützen.\",\n\t\t\"es\": \"Las configuraciones de escalado ESS deben habilitar el cifrado del disco del sistema para proteger los datos del sistema en reposo.\",\n\t\t\"fr\": \"Les configurations de mise à l'échelle ESS doivent activer le chiffrement du disque système pour protéger les données système au repos.\",\n\t\t\"pt\": \"As configurações de escalonamento ESS devem habilitar a criptografia do disco do sistema para proteger os dados do sistema em repouso.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling configuration does not have system disk encryption enabled.\",\n\t\t\"zh\": \"弹性伸缩配置中的系统磁盘未加密，静态数据可能面临泄露风险。\",\n\t\t\"ja\": \"ESS スケーリング設定でシステムディスク暗号化が有効になっていません。\",\n\t\t\"de\": \"Die ESS-Skalierungskonfiguration hat keine System-Disk-Verschlüsselung aktiviert.\",\n\t\t\"es\": \"La configuración de escalado ESS no tiene cifrado del disco del sistema habilitado.\",\n\t\t\"fr\": \"La configuration de mise à l'échelle ESS n'a pas le chiffrement du disque système activé.\",\n\t\t\"pt\": \"A configuração de escalonamento ESS não tem criptografia do disco do sistema habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable system disk encryption in the scaling configuration settings.\",\n\t\t\"zh\": \"在伸缩配置中启用系统磁盘加密功能。\",\n\t\t\"ja\": \"スケーリング設定でシステムディスク暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die System-Disk-Verschlüsselung in den Skalierungskonfigurationseinstellungen.\",\n\t\t\"es\": \"Habilite el cifrado del disco del sistema en la configuración de escalado.\",\n\t\t\"fr\": \"Activez le chiffrement du disque système dans les paramètres de configuration de mise à l'échelle.\",\n\t\t\"pt\": \"Habilite a criptografia do disco do sistema nas configurações de escalonamento.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingConfiguration\"]\n}\n\n# Check if system disk encryption is enabled\nis_system_disk_encrypted(resource) if {\n\tsystem_disk_encrypted := helpers.get_property(resource, \"SystemDiskEncryptAlgorithm\", \"\")\n\tsystem_disk_encrypted != \"\"\n}\n\nis_system_disk_encrypted(resource) if {\n\tkms_key_id := helpers.get_property(resource, \"SystemDiskKMSKeyId\", \"\")\n\tkms_key_id != \"\"\n}\n\n# If no explicit encryption setting, consider it non-compliant\n# Note: Some images have default encryption, but explicit configuration is preferred\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingConfiguration\")\n\tnot is_system_disk_encrypted(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SystemDiskEncryptAlgorithm\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-group-attach-multi-switch", Name: models.I18nString{"de": "ESS-Skalierungsgruppe Multi-VSwitch", "en": "ESS Scaling Group Multi-VSwitch", "es": "Grupo de Escalado ESS Multi-VSwitch", "fr": "Groupe de Mise à l'Échelle ESS Multi-VSwitch", "ja": "ESS スケーリンググループマルチ VSwitch", "pt": "Grupo de Escalonamento ESS Multi-VSwitch", "zh": "弹性伸缩组关联至少两个交换机"}, Severity: "medium", Description: models.I18nString{"de": "ESS-Skalierungsgruppen sollten für Hochverfügbarkeit über mehrere Zonen hinweg mit mindestens zwei VSwitches verknüpft sein.", "en": "ESS scaling groups should be associated with at least two VSwitches for high availability across multiple zones.", "es": "Los grupos de escalado ESS deben estar asociados con al menos dos VSwitches para alta disponibilidad en múltiples zonas.", "fr": "Les groupes de mise à l'échelle ESS doivent être associés à au moins deux VSwitches pour une haute disponibilité sur plusieurs zones.", "ja": "ESS スケーリンググループは、複数のゾーンにわたる高可用性のために少なくとも 2 つの VSwitch に関連付ける必要があります。", "pt": "Os grupos de escalonamento ESS devem estar associados a pelo menos dois VSwitches para alta disponibilidade em múltiplas zonas.", "zh": "弹性伸缩组关联至少两个交换机，视为合规。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungsgruppe ist mit weniger als zwei VSwitches verknüpft, was die Verfügbarkeit beeinträchtigen kann.", "en": "The ESS scaling group is associated with fewer than two VSwitches, which may affect availability.", "es": "El grupo de escalado ESS está asociado con menos de dos VSwitches, lo que puede afectar la disponibilidad.", "fr": "Le groupe de mise à l'échelle ESS est associé à moins de deux VSwitches, ce qui peut affecter la disponibilité.", "ja": "ESS スケーリンググループが 2 つ未満の VSwitch に関連付けられており、可用性に影響を与える可能性があります。", "pt": "O grupo de escalonamento ESS está associado a menos de dois VSwitches, o que pode afetar a disponibilidade.", "zh": "弹性伸缩组关联的交换机少于两个，可能影响可用性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie mindestens zwei VSwitches in der VSwitchIds-Eigenschaft, um Hochverfügbarkeit über mehrere Zonen hinweg sicherzustellen.", "en": "Configure at least two VSwitches in the VSwitchIds property to ensure high availability across multiple zones.", "es": "Configure al menos dos VSwitches en la propiedad VSwitchIds para asegurar alta disponibilidad en múltiples zonas.", "fr": "Configurez au moins deux VSwitches dans la propriété VSwitchIds pour assurer une haute disponibilité sur plusieurs zones.", "ja": "複数のゾーンにわたる高可用性を確保するために、VSwitchIds プロパティで少なくとも 2 つの VSwitch を設定します。", "pt": "Configure pelo menos dois VSwitches na propriedade VSwitchIds para garantir alta disponibilidade em múltiplas zonas.", "zh": "在 VSwitchIds 属性中配置至少两个交换机，以确保跨多个可用区的高可用性。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingGroup"}, FilePath: "aliyun/rules/ess-scaling-group-attach-multi-switch.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_group_attach_multi_switch", Content: "package infraguard.rules.aliyun.ess_scaling_group_attach_multi_switch\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-scaling-group-attach-multi-switch\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Group Multi-VSwitch\",\n\t\t\"zh\": \"弹性伸缩组关联至少两个交换机\",\n\t\t\"ja\": \"ESS スケーリンググループマルチ VSwitch\",\n\t\t\"de\": \"ESS-Skalierungsgruppe Multi-VSwitch\",\n\t\t\"es\": \"Grupo de Escalado ESS Multi-VSwitch\",\n\t\t\"fr\": \"Groupe de Mise à l'Échelle ESS Multi-VSwitch\",\n\t\t\"pt\": \"Grupo de Escalonamento ESS Multi-VSwitch\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling groups should be associated with at least two VSwitches for high availability across multiple zones.\",\n\t\t\"zh\": \"弹性伸缩组关联至少两个交换机，视为合规。\",\n\t\t\"ja\": \"ESS スケーリンググループは、複数のゾーンにわたる高可用性のために少なくとも 2 つの VSwitch に関連付ける必要があります。\",\n\t\t\"de\": \"ESS-Skalierungsgruppen sollten für Hochverfügbarkeit über mehrere Zonen hinweg mit mindestens zwei VSwitches verknüpft sein.\",\n\t\t\"es\": \"Los grupos de escalado ESS deben estar asociados con al menos dos VSwitches para alta disponibilidad en múltiples zonas.\",\n\t\t\"fr\": \"Les groupes de mise à l'échelle ESS doivent être associés à au moins deux VSwitches pour une haute disponibilité sur plusieurs zones.\",\n\t\t\"pt\": \"Os grupos de escalonamento ESS devem estar associados a pelo menos dois VSwitches para alta disponibilidade em múltiplas zonas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling group is associated with fewer than two VSwitches, which may affect availability.\",\n\t\t\"zh\": \"弹性伸缩组关联的交换机少于两个，可能影响可用性。\",\n\t\t\"ja\": \"ESS スケーリンググループが 2 つ未満の VSwitch に関連付けられており、可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Die ESS-Skalierungsgruppe ist mit weniger als zwei VSwitches verknüpft, was die Verfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"El grupo de escalado ESS está asociado con menos de dos VSwitches, lo que puede afectar la disponibilidad.\",\n\t\t\"fr\": \"Le groupe de mise à l'échelle ESS est associé à moins de deux VSwitches, ce qui peut affecter la disponibilité.\",\n\t\t\"pt\": \"O grupo de escalonamento ESS está associado a menos de dois VSwitches, o que pode afetar a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure at least two VSwitches in the VSwitchIds property to ensure high availability across multiple zones.\",\n\t\t\"zh\": \"在 VSwitchIds 属性中配置至少两个交换机，以确保跨多个可用区的高可用性。\",\n\t\t\"ja\": \"複数のゾーンにわたる高可用性を確保するために、VSwitchIds プロパティで少なくとも 2 つの VSwitch を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie mindestens zwei VSwitches in der VSwitchIds-Eigenschaft, um Hochverfügbarkeit über mehrere Zonen hinweg sicherzustellen.\",\n\t\t\"es\": \"Configure al menos dos VSwitches en la propiedad VSwitchIds para asegurar alta disponibilidad en múltiples zonas.\",\n\t\t\"fr\": \"Configurez au moins deux VSwitches dans la propriété VSwitchIds pour assurer une haute disponibilité sur plusieurs zones.\",\n\t\t\"pt\": \"Configure pelo menos dois VSwitches na propriedade VSwitchIds para garantir alta disponibilidade em múltiplas zonas.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingGroup\"]\n}\n\n# Check if scaling group has multiple VSwitches\nhas_multiple_vswitches(resource) if {\n\tvswitches := resource.Properties.VSwitchIds\n\tcount(vswitches) >= 2\n}\n\n# Deny rule: ESS scaling groups must have at least two VSwitches\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingGroup\")\n\tnot has_multiple_vswitches(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VSwitchIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-group-attach-slb", Name: models.I18nString{"de": "ESS-Skalierungsgruppe SLB anhängen", "en": "ESS Scaling Group Attach SLB", "es": "Grupo de Escalado ESS Adjuntar SLB", "fr": "Groupe de Mise à l'Échelle ESS Attacher SLB", "ja": "ESS スケーリンググループ SLB アタッチ", "pt": "Grupo de Escalonamento ESS Anexar SLB", "zh": "弹性伸缩组设置关联负载均衡"}, Severity: "medium", Description: models.I18nString{"de": "ESS-Skalierungsgruppen sollten an Classic Load Balancer (SLB) angehängt werden, um eine ordnungsgemäße Verkehrsverteilung zu gewährleisten.", "en": "ESS scaling groups should be attached to Classic Load Balancer (SLB) for proper traffic distribution.", "es": "Los grupos de escalado ESS deben adjuntarse al Equilibrador de Carga Clásico (SLB) para una distribución adecuada del tráfico.", "fr": "Les groupes de mise à l'échelle ESS doivent être attachés à l'Équilibreur de Charge Classique (SLB) pour une distribution appropriée du trafic.", "ja": "ESS スケーリンググループは、適切なトラフィック分散のためにクラシックロードバランサー（SLB）にアタッチする必要があります。", "pt": "Os grupos de escalonamento ESS devem ser anexados ao Balanceador de Carga Clássico (SLB) para distribuição adequada de tráfego.", "zh": "弹性伸缩组关联传统型负载均衡，视为合规。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungsgruppe ist nicht an einen Classic Load Balancer angehängt, was die Verkehrsverteilung beeinträchtigen kann.", "en": "The ESS scaling group is not attached to a Classic Load Balancer, which may affect traffic distribution.", "es": "El grupo de escalado ESS no está adjunto a un Equilibrador de Carga Clásico, lo que puede afectar la distribución del tráfico.", "fr": "Le groupe de mise à l'échelle ESS n'est pas attaché à un Équilibreur de Charge Classique, ce qui peut affecter la distribution du trafic.", "ja": "ESS スケーリンググループがクラシックロードバランサーにアタッチされていないため、トラフィック分散に影響を与える可能性があります。", "pt": "O grupo de escalonamento ESS não está anexado a um Balanceador de Carga Clássico, o que pode afetar a distribuição de tráfego.", "zh": "弹性伸缩组未关联传统型负载均衡，可能影响流量的分发和可用性。"}, Recommendation: models.I18nString{"de": "Hängen Sie die Skalierungsgruppe mit der Eigenschaft LoadBalancerIds an einen Classic Load Balancer an.", "en": "Attach the scaling group to a Classic Load Balancer using the LoadBalancerIds property.", "es": "Adjunte el grupo de escalado a un Equilibrador de Carga Clásico usando la propiedad LoadBalancerIds.", "fr": "Attachez le groupe de mise à l'échelle à un Équilibreur de Charge Classique en utilisant la propriété LoadBalancerIds.", "ja": "LoadBalancerIds プロパティを使用して、スケーリンググループをクラシックロードバランサーにアタッチします。", "pt": "Anexe o grupo de escalonamento a um Balanceador de Carga Clássico usando a propriedade LoadBalancerIds.", "zh": "使用 LoadBalancerIds 属性将伸缩组关联到传统型负载均衡实例。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingGroup"}, FilePath: "aliyun/rules/ess-scaling-group-attach-slb.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_group_attach_slb", Content: "package infraguard.rules.aliyun.ess_scaling_group_attach_slb\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-scaling-group-attach-slb\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Group Attach SLB\",\n\t\t\"zh\": \"弹性伸缩组设置关联负载均衡\",\n\t\t\"ja\": \"ESS スケーリンググループ SLB アタッチ\",\n\t\t\"de\": \"ESS-Skalierungsgruppe SLB anhängen\",\n\t\t\"es\": \"Grupo de Escalado ESS Adjuntar SLB\",\n\t\t\"fr\": \"Groupe de Mise à l'Échelle ESS Attacher SLB\",\n\t\t\"pt\": \"Grupo de Escalonamento ESS Anexar SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling groups should be attached to Classic Load Balancer (SLB) for proper traffic distribution.\",\n\t\t\"zh\": \"弹性伸缩组关联传统型负载均衡，视为合规。\",\n\t\t\"ja\": \"ESS スケーリンググループは、適切なトラフィック分散のためにクラシックロードバランサー（SLB）にアタッチする必要があります。\",\n\t\t\"de\": \"ESS-Skalierungsgruppen sollten an Classic Load Balancer (SLB) angehängt werden, um eine ordnungsgemäße Verkehrsverteilung zu gewährleisten.\",\n\t\t\"es\": \"Los grupos de escalado ESS deben adjuntarse al Equilibrador de Carga Clásico (SLB) para una distribución adecuada del tráfico.\",\n\t\t\"fr\": \"Les groupes de mise à l'échelle ESS doivent être attachés à l'Équilibreur de Charge Classique (SLB) pour une distribution appropriée du trafic.\",\n\t\t\"pt\": \"Os grupos de escalonamento ESS devem ser anexados ao Balanceador de Carga Clássico (SLB) para distribuição adequada de tráfego.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling group is not attached to a Classic Load Balancer, which may affect traffic distribution.\",\n\t\t\"zh\": \"弹性伸缩组未关联传统型负载均衡，可能影响流量的分发和可用性。\",\n\t\t\"ja\": \"ESS スケーリンググループがクラシックロードバランサーにアタッチされていないため、トラフィック分散に影響を与える可能性があります。\",\n\t\t\"de\": \"Die ESS-Skalierungsgruppe ist nicht an einen Classic Load Balancer angehängt, was die Verkehrsverteilung beeinträchtigen kann.\",\n\t\t\"es\": \"El grupo de escalado ESS no está adjunto a un Equilibrador de Carga Clásico, lo que puede afectar la distribución del tráfico.\",\n\t\t\"fr\": \"Le groupe de mise à l'échelle ESS n'est pas attaché à un Équilibreur de Charge Classique, ce qui peut affecter la distribution du trafic.\",\n\t\t\"pt\": \"O grupo de escalonamento ESS não está anexado a um Balanceador de Carga Clássico, o que pode afetar a distribuição de tráfego.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach the scaling group to a Classic Load Balancer using the LoadBalancerIds property.\",\n\t\t\"zh\": \"使用 LoadBalancerIds 属性将伸缩组关联到传统型负载均衡实例。\",\n\t\t\"ja\": \"LoadBalancerIds プロパティを使用して、スケーリンググループをクラシックロードバランサーにアタッチします。\",\n\t\t\"de\": \"Hängen Sie die Skalierungsgruppe mit der Eigenschaft LoadBalancerIds an einen Classic Load Balancer an.\",\n\t\t\"es\": \"Adjunte el grupo de escalado a un Equilibrador de Carga Clásico usando la propiedad LoadBalancerIds.\",\n\t\t\"fr\": \"Attachez le groupe de mise à l'échelle à un Équilibreur de Charge Classique en utilisant la propriété LoadBalancerIds.\",\n\t\t\"pt\": \"Anexe o grupo de escalonamento a um Balanceador de Carga Clássico usando a propriedade LoadBalancerIds.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingGroup\"]\n}\n\n# Check if scaling group has Classic Load Balancer attached\nhas_classic_slb(resource) if {\n\tload_balancer_ids := helpers.get_property(resource, \"LoadBalancerIds\", [])\n\tcount(load_balancer_ids) > 0\n}\n\n# Deny rule: ESS scaling groups should be attached to Classic Load Balancer\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingGroup\")\n\tnot has_classic_slb(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LoadBalancerIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ess-scaling-group-loadbalancer-check", Name: models.I18nString{"de": "ESS-Skalierungsgruppe Load Balancer Existenzprüfung", "en": "ESS Scaling Group Load Balancer Existence Check", "es": "Verificación de Existencia de Equilibrador de Carga del Grupo de Escalado ESS", "fr": "Vérification d'Existence de l'Équilibreur de Charge du Groupe de Mise à l'Échelle ESS", "ja": "ESS スケーリンググループロードバランサー存在チェック", "pt": "Verificação de Existência do Balanceador de Carga do Grupo de Escalonamento ESS", "zh": "弹性伸缩组关联负载均衡存在性检测"}, Severity: "medium", Description: models.I18nString{"de": "ESS-Skalierungsgruppen sollten an vorhandene und aktive Load Balancer-Instanzen angehängt werden, um eine ordnungsgemäße Datenverteilung zu gewährleisten.", "en": "ESS scaling groups should be attached to existing and active Load Balancer instances for proper traffic distribution.", "es": "Los grupos de escalado ESS deben estar adjuntos a instancias de equilibrador de carga existentes y activas para una distribución adecuada del tráfico.", "fr": "Les groupes de mise à l'échelle ESS doivent être attachés à des instances d'équilibreur de charge existantes et actives pour une distribution appropriée du trafic.", "ja": "ESS スケーリンググループは、適切なトラフィック分散のために既存のアクティブなロードバランサーインスタンスにアタッチする必要があります。", "pt": "Os grupos de escalonamento ESS devem estar anexados a instâncias de balanceador de carga existentes e ativas para distribuição adequada de tráfego.", "zh": "弹性伸缩组关联传统型负载均衡或者应用负载均衡仍然为保有中资源，视为合规。"}, Reason: models.I18nString{"de": "Die ESS-Skalierungsgruppe kann an einen Load Balancer angehängt sein, der nicht mehr existiert oder inaktiv ist.", "en": "The ESS scaling group may be attached to a Load Balancer that no longer exists or is inactive.", "es": "El grupo de escalado ESS puede estar adjunto a un equilibrador de carga que ya no existe o está inactivo.", "fr": "Le groupe de mise à l'échelle ESS peut être attaché à un équilibreur de charge qui n'existe plus ou est inactif.", "ja": "ESS スケーリンググループが存在しないか非アクティブなロードバランサーにアタッチされている可能性があります。", "pt": "O grupo de escalonamento ESS pode estar anexado a um balanceador de carga que não existe mais ou está inativo.", "zh": "弹性伸缩组关联的负载均衡可能已不存在或已失效。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass die in der Skalierungsgruppe referenzierten Load Balancer-IDs gültige und aktive Ressourcen sind.", "en": "Ensure the Load Balancer IDs referenced in the scaling group are valid and active resources.", "es": "Asegúrese de que los ID de equilibrador de carga referenciados en el grupo de escalado sean recursos válidos y activos.", "fr": "Assurez-vous que les ID d'équilibreur de charge référencés dans le groupe de mise à l'échelle sont des ressources valides et actives.", "ja": "スケーリンググループで参照されているロードバランサー ID が有効でアクティブなリソースであることを確認します。", "pt": "Garanta que os IDs de balanceador de carga referenciados no grupo de escalonamento sejam recursos válidos e ativos.", "zh": "确保伸缩组中引用的负载均衡 ID 是有效的保有中资源。"}, ResourceTypes: []string{"ALIYUN::ESS::ScalingGroup"}, FilePath: "aliyun/rules/ess-scaling-group-loadbalancer-check.rego", PackageName: "infraguard.rules.aliyun.ess_scaling_group_loadbalancer_check", Content: "package infraguard.rules.aliyun.ess_scaling_group_loadbalancer_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ess-scaling-group-loadbalancer-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"ESS Scaling Group Load Balancer Existence Check\",\n\t\t\"zh\": \"弹性伸缩组关联负载均衡存在性检测\",\n\t\t\"ja\": \"ESS スケーリンググループロードバランサー存在チェック\",\n\t\t\"de\": \"ESS-Skalierungsgruppe Load Balancer Existenzprüfung\",\n\t\t\"es\": \"Verificación de Existencia de Equilibrador de Carga del Grupo de Escalado ESS\",\n\t\t\"fr\": \"Vérification d'Existence de l'Équilibreur de Charge du Groupe de Mise à l'Échelle ESS\",\n\t\t\"pt\": \"Verificação de Existência do Balanceador de Carga do Grupo de Escalonamento ESS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"ESS scaling groups should be attached to existing and active Load Balancer instances for proper traffic distribution.\",\n\t\t\"zh\": \"弹性伸缩组关联传统型负载均衡或者应用负载均衡仍然为保有中资源，视为合规。\",\n\t\t\"ja\": \"ESS スケーリンググループは、適切なトラフィック分散のために既存のアクティブなロードバランサーインスタンスにアタッチする必要があります。\",\n\t\t\"de\": \"ESS-Skalierungsgruppen sollten an vorhandene und aktive Load Balancer-Instanzen angehängt werden, um eine ordnungsgemäße Datenverteilung zu gewährleisten.\",\n\t\t\"es\": \"Los grupos de escalado ESS deben estar adjuntos a instancias de equilibrador de carga existentes y activas para una distribución adecuada del tráfico.\",\n\t\t\"fr\": \"Les groupes de mise à l'échelle ESS doivent être attachés à des instances d'équilibreur de charge existantes et actives pour une distribution appropriée du trafic.\",\n\t\t\"pt\": \"Os grupos de escalonamento ESS devem estar anexados a instâncias de balanceador de carga existentes e ativas para distribuição adequada de tráfego.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ESS scaling group may be attached to a Load Balancer that no longer exists or is inactive.\",\n\t\t\"zh\": \"弹性伸缩组关联的负载均衡可能已不存在或已失效。\",\n\t\t\"ja\": \"ESS スケーリンググループが存在しないか非アクティブなロードバランサーにアタッチされている可能性があります。\",\n\t\t\"de\": \"Die ESS-Skalierungsgruppe kann an einen Load Balancer angehängt sein, der nicht mehr existiert oder inaktiv ist.\",\n\t\t\"es\": \"El grupo de escalado ESS puede estar adjunto a un equilibrador de carga que ya no existe o está inactivo.\",\n\t\t\"fr\": \"Le groupe de mise à l'échelle ESS peut être attaché à un équilibreur de charge qui n'existe plus ou est inactif.\",\n\t\t\"pt\": \"O grupo de escalonamento ESS pode estar anexado a um balanceador de carga que não existe mais ou está inativo.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure the Load Balancer IDs referenced in the scaling group are valid and active resources.\",\n\t\t\"zh\": \"确保伸缩组中引用的负载均衡 ID 是有效的保有中资源。\",\n\t\t\"ja\": \"スケーリンググループで参照されているロードバランサー ID が有効でアクティブなリソースであることを確認します。\",\n\t\t\"de\": \"Stellen Sie sicher, dass die in der Skalierungsgruppe referenzierten Load Balancer-IDs gültige und aktive Ressourcen sind.\",\n\t\t\"es\": \"Asegúrese de que los ID de equilibrador de carga referenciados en el grupo de escalado sean recursos válidos y activos.\",\n\t\t\"fr\": \"Assurez-vous que les ID d'équilibreur de charge référencés dans le groupe de mise à l'échelle sont des ressources valides et actives.\",\n\t\t\"pt\": \"Garanta que os IDs de balanceador de carga referenciados no grupo de escalonamento sejam recursos válidos e ativos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ESS::ScalingGroup\"]\n}\n\n# Check if scaling group has load balancer IDs configured\nhas_load_balancer(resource) if {\n\tload_balancer_ids := helpers.get_property(resource, \"LoadBalancerIds\", [])\n\tcount(load_balancer_ids) > 0\n}\n\nhas_load_balancer(resource) if {\n\tserver_groups := helpers.get_property(resource, \"ServerGroups\", [])\n\tcount(server_groups) > 0\n}\n\n# Deny rule: ESS scaling groups should have valid load balancer attachments\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ESS::ScalingGroup\")\n\tnot has_load_balancer(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LoadBalancerIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-function-custom-domain-and-cert-enable", Name: models.I18nString{"de": "FC-Funktion Benutzerdefinierte Domäne Zertifikatsprüfung", "en": "FC Function Custom Domain Certificate Check", "es": "Verificación de Certificado de Dominio Personalizado de Función FC", "fr": "Vérification du Certificat de Domaine Personnalisé de Fonction FC", "ja": "FC 関数カスタムドメイン証明書チェック", "pt": "Verificação de Certificado de Domínio Personalizado de Função FC", "zh": "函数计算函数绑定到自定义域名且上传证书"}, Severity: "medium", Description: models.I18nString{"de": "FC-benutzerdefinierte Domänen sollten SSL-Zertifikate für sichere Kommunikation konfiguriert haben.", "en": "FC custom domains should have SSL certificates configured for secure communication.", "es": "Los dominios personalizados FC deben tener certificados SSL configurados para comunicación segura.", "fr": "Les domaines personnalisés FC doivent avoir des certificats SSL configurés pour une communication sécurisée.", "ja": "FC カスタムドメインは、安全な通信のために SSL 証明書を設定する必要があります。", "pt": "Os domínios personalizados FC devem ter certificados SSL configurados para comunicação segura.", "zh": "函数计算函数绑定的自定义域名已上传 SSL 证书，视为合规。"}, Reason: models.I18nString{"de": "Die FC-benutzerdefinierte Domäne hat kein SSL-Zertifikat konfiguriert, was den Datenverkehr Sicherheitsrisiken aussetzen kann.", "en": "The FC custom domain does not have an SSL certificate configured, which may expose traffic to security risks.", "es": "El dominio personalizado FC no tiene un certificado SSL configurado, lo que puede exponer el tráfico a riesgos de seguridad.", "fr": "Le domaine personnalisé FC n'a pas de certificat SSL configuré, ce qui peut exposer le trafic à des risques de sécurité.", "ja": "FC カスタムドメインに SSL 証明書が設定されていないため、トラフィックがセキュリティリスクにさらされる可能性があります。", "pt": "O domínio personalizado FC não tem um certificado SSL configurado, o que pode expor o tráfego a riscos de segurança.", "zh": "函数计算自定义域名未配置 SSL 证书，可能导致流量面临安全风险。"}, Recommendation: models.I18nString{"de": "Laden Sie SSL-Zertifikate für die benutzerdefinierte Domäne in der FC-Konsole oder API hoch.", "en": "Upload SSL certificates for the custom domain in the FC console or API.", "es": "Cargue certificados SSL para el dominio personalizado en la consola FC o API.", "fr": "Téléchargez les certificats SSL pour le domaine personnalisé dans la console FC ou l'API.", "ja": "FC コンソールまたは API でカスタムドメインの SSL 証明書をアップロードします。", "pt": "Faça upload de certificados SSL para o domínio personalizado no console FC ou API.", "zh": "在函数计算控制台或 API 为自定义域名上传 SSL 证书。"}, ResourceTypes: []string{"ALIYUN::FC::CustomDomain"}, FilePath: "aliyun/rules/fc-function-custom-domain-and-cert-enable.rego", PackageName: "infraguard.rules.aliyun.fc_function_custom_domain_and_cert_enable", Content: "package infraguard.rules.aliyun.fc_function_custom_domain_and_cert_enable\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-function-custom-domain-and-cert-enable\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Function Custom Domain Certificate Check\",\n\t\t\"zh\": \"函数计算函数绑定到自定义域名且上传证书\",\n\t\t\"ja\": \"FC 関数カスタムドメイン証明書チェック\",\n\t\t\"de\": \"FC-Funktion Benutzerdefinierte Domäne Zertifikatsprüfung\",\n\t\t\"es\": \"Verificación de Certificado de Dominio Personalizado de Función FC\",\n\t\t\"fr\": \"Vérification du Certificat de Domaine Personnalisé de Fonction FC\",\n\t\t\"pt\": \"Verificação de Certificado de Domínio Personalizado de Função FC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"FC custom domains should have SSL certificates configured for secure communication.\",\n\t\t\"zh\": \"函数计算函数绑定的自定义域名已上传 SSL 证书，视为合规。\",\n\t\t\"ja\": \"FC カスタムドメインは、安全な通信のために SSL 証明書を設定する必要があります。\",\n\t\t\"de\": \"FC-benutzerdefinierte Domänen sollten SSL-Zertifikate für sichere Kommunikation konfiguriert haben.\",\n\t\t\"es\": \"Los dominios personalizados FC deben tener certificados SSL configurados para comunicación segura.\",\n\t\t\"fr\": \"Les domaines personnalisés FC doivent avoir des certificats SSL configurés pour une communication sécurisée.\",\n\t\t\"pt\": \"Os domínios personalizados FC devem ter certificados SSL configurados para comunicação segura.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The FC custom domain does not have an SSL certificate configured, which may expose traffic to security risks.\",\n\t\t\"zh\": \"函数计算自定义域名未配置 SSL 证书，可能导致流量面临安全风险。\",\n\t\t\"ja\": \"FC カスタムドメインに SSL 証明書が設定されていないため、トラフィックがセキュリティリスクにさらされる可能性があります。\",\n\t\t\"de\": \"Die FC-benutzerdefinierte Domäne hat kein SSL-Zertifikat konfiguriert, was den Datenverkehr Sicherheitsrisiken aussetzen kann.\",\n\t\t\"es\": \"El dominio personalizado FC no tiene un certificado SSL configurado, lo que puede exponer el tráfico a riesgos de seguridad.\",\n\t\t\"fr\": \"Le domaine personnalisé FC n'a pas de certificat SSL configuré, ce qui peut exposer le trafic à des risques de sécurité.\",\n\t\t\"pt\": \"O domínio personalizado FC não tem um certificado SSL configurado, o que pode expor o tráfego a riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upload SSL certificates for the custom domain in the FC console or API.\",\n\t\t\"zh\": \"在函数计算控制台或 API 为自定义域名上传 SSL 证书。\",\n\t\t\"ja\": \"FC コンソールまたは API でカスタムドメインの SSL 証明書をアップロードします。\",\n\t\t\"de\": \"Laden Sie SSL-Zertifikate für die benutzerdefinierte Domäne in der FC-Konsole oder API hoch.\",\n\t\t\"es\": \"Cargue certificados SSL para el dominio personalizado en la consola FC o API.\",\n\t\t\"fr\": \"Téléchargez les certificats SSL pour le domaine personnalisé dans la console FC ou l'API.\",\n\t\t\"pt\": \"Faça upload de certificados SSL para o domínio personalizado no console FC ou API.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::CustomDomain\"]\n}\n\n# Check if custom domain has certificate configured\nhas_certificate(resource) if {\n\tcert_config := helpers.get_property(resource, \"CertConfig\", {})\n\tcert_config != {}\n}\n\n# Deny rule: Custom domains should have SSL certificates\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::CustomDomain\")\n\tnot has_certificate(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"CertConfig\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-function-custom-domain-and-https-enable", Name: models.I18nString{"de": "FC-Funktion Benutzerdefinierte Domain HTTPS-Prüfung", "en": "FC Function Custom Domain HTTPS Check", "es": "Verificación HTTPS de Dominio Personalizado de Función FC", "fr": "Vérification HTTPS du Domaine Personnalisé de Fonction FC", "ja": "FC 関数のカスタムドメイン HTTPS チェック", "pt": "Verificação HTTPS de Domínio Personalizado de Função FC", "zh": "函数计算函数绑定到自定义域名且开启 https"}, Severity: "medium", Description: models.I18nString{"de": "FC-Benutzerdefinierte Domains sollten HTTPS für sichere Kommunikation aktiviert haben.", "en": "FC custom domains should have HTTPS enabled for secure communication.", "es": "Los dominios personalizados FC deben tener HTTPS habilitado para comunicación segura.", "fr": "Les domaines personnalisés FC doivent avoir HTTPS activé pour une communication sécurisée.", "ja": "FC カスタムドメインは安全な通信のために HTTPS を有効にする必要があります。", "pt": "Os domínios personalizados FC devem ter HTTPS habilitado para comunicação segura.", "zh": "函数计算函数绑定的自定义域名已开启 HTTPS，视为合规。"}, Reason: models.I18nString{"de": "Die FC-Benutzerdefinierte Domain hat HTTPS nicht aktiviert, was Datenverkehr Sicherheitsrisiken aussetzen kann.", "en": "The FC custom domain does not have HTTPS enabled, which may expose traffic to security risks.", "es": "El dominio personalizado FC no tiene HTTPS habilitado, lo que puede exponer el tráfico a riesgos de seguridad.", "fr": "Le domaine personnalisé FC n'a pas HTTPS activé, ce qui peut exposer le trafic à des risques de sécurité.", "ja": "FC カスタムドメインで HTTPS が有効になっていないため、トラフィックがセキュリティリスクにさらされる可能性があります。", "pt": "O domínio personalizado FC não tem HTTPS habilitado, o que pode expor o tráfego a riscos de segurança.", "zh": "函数计算自定义域名未开启 HTTPS，可能导致流量面临安全风险。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie HTTPS für die Benutzerdefinierte Domain in der FC-Konsole oder API.", "en": "Enable HTTPS for the custom domain in the FC console or API.", "es": "Habilite HTTPS para el dominio personalizado en la consola FC o API.", "fr": "Activez HTTPS pour le domaine personnalisé dans la console FC ou l'API.", "ja": "FC コンソールまたは API でカスタムドメインの HTTPS を有効にします。", "pt": "Habilite HTTPS para o domínio personalizado no console FC ou API.", "zh": "在函数计算控制台或 API 为自定义域名开启 HTTPS。"}, ResourceTypes: []string{"ALIYUN::FC::CustomDomain"}, FilePath: "aliyun/rules/fc-function-custom-domain-and-https-enable.rego", PackageName: "infraguard.rules.aliyun.fc_function_custom_domain_and_https_enable", Content: "package infraguard.rules.aliyun.fc_function_custom_domain_and_https_enable\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-function-custom-domain-and-https-enable\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Function Custom Domain HTTPS Check\",\n\t\t\"zh\": \"函数计算函数绑定到自定义域名且开启 https\",\n\t\t\"ja\": \"FC 関数のカスタムドメイン HTTPS チェック\",\n\t\t\"de\": \"FC-Funktion Benutzerdefinierte Domain HTTPS-Prüfung\",\n\t\t\"es\": \"Verificación HTTPS de Dominio Personalizado de Función FC\",\n\t\t\"fr\": \"Vérification HTTPS du Domaine Personnalisé de Fonction FC\",\n\t\t\"pt\": \"Verificação HTTPS de Domínio Personalizado de Função FC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"FC custom domains should have HTTPS enabled for secure communication.\",\n\t\t\"zh\": \"函数计算函数绑定的自定义域名已开启 HTTPS，视为合规。\",\n\t\t\"ja\": \"FC カスタムドメインは安全な通信のために HTTPS を有効にする必要があります。\",\n\t\t\"de\": \"FC-Benutzerdefinierte Domains sollten HTTPS für sichere Kommunikation aktiviert haben.\",\n\t\t\"es\": \"Los dominios personalizados FC deben tener HTTPS habilitado para comunicación segura.\",\n\t\t\"fr\": \"Les domaines personnalisés FC doivent avoir HTTPS activé pour une communication sécurisée.\",\n\t\t\"pt\": \"Os domínios personalizados FC devem ter HTTPS habilitado para comunicação segura.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The FC custom domain does not have HTTPS enabled, which may expose traffic to security risks.\",\n\t\t\"zh\": \"函数计算自定义域名未开启 HTTPS，可能导致流量面临安全风险。\",\n\t\t\"ja\": \"FC カスタムドメインで HTTPS が有効になっていないため、トラフィックがセキュリティリスクにさらされる可能性があります。\",\n\t\t\"de\": \"Die FC-Benutzerdefinierte Domain hat HTTPS nicht aktiviert, was Datenverkehr Sicherheitsrisiken aussetzen kann.\",\n\t\t\"es\": \"El dominio personalizado FC no tiene HTTPS habilitado, lo que puede exponer el tráfico a riesgos de seguridad.\",\n\t\t\"fr\": \"Le domaine personnalisé FC n'a pas HTTPS activé, ce qui peut exposer le trafic à des risques de sécurité.\",\n\t\t\"pt\": \"O domínio personalizado FC não tem HTTPS habilitado, o que pode expor o tráfego a riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable HTTPS for the custom domain in the FC console or API.\",\n\t\t\"zh\": \"在函数计算控制台或 API 为自定义域名开启 HTTPS。\",\n\t\t\"ja\": \"FC コンソールまたは API でカスタムドメインの HTTPS を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie HTTPS für die Benutzerdefinierte Domain in der FC-Konsole oder API.\",\n\t\t\"es\": \"Habilite HTTPS para el dominio personalizado en la consola FC o API.\",\n\t\t\"fr\": \"Activez HTTPS pour le domaine personnalisé dans la console FC ou l'API.\",\n\t\t\"pt\": \"Habilite HTTPS para o domínio personalizado no console FC ou API.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::CustomDomain\"]\n}\n\n# Check if custom domain has HTTPS enabled via protocol\nhas_https_enabled(resource) if {\n\tprotocol := helpers.get_property(resource, \"Protocol\", \"\")\n\tprotocol == \"HTTPS\"\n}\n\nhas_https_enabled(resource) if {\n\tprotocol := helpers.get_property(resource, \"Protocol\", \"\")\n\tprotocol == \"HTTP,HTTPS\"\n}\n\n# Deny rule: Custom domains should have HTTPS enabled\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::CustomDomain\")\n\tnot has_https_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Protocol\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-function-custom-domain-and-tls-enable", Name: models.I18nString{"de": "FC-Funktion Benutzerdefinierte Domain und TLS aktiviert", "en": "FC Function Custom Domain and TLS Enabled", "es": "Dominio Personalizado y TLS de Función FC Habilitado", "fr": "Domaine Personnalisé et TLS de Fonction FC Activé", "ja": "FC 関数カスタムドメインおよび TLS が有効", "pt": "Domínio Personalizado e TLS de Função FC Habilitado", "zh": "FC 函数自定义域名及 TLS 开启"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass benutzerdefinierte Domains für Function Compute-Funktionen TLS aktiviert haben.", "en": "Ensures that custom domains for Function Compute functions have TLS enabled.", "es": "Garantiza que los dominios personalizados para funciones de Function Compute tengan TLS habilitado.", "fr": "Garantit que les domaines personnalisés pour les fonctions Function Compute ont TLS activé.", "ja": "関数計算関数のカスタムドメインで TLS が有効になっていることを確認します。", "pt": "Garante que os domínios personalizados para funções Function Compute tenham TLS habilitado.", "zh": "确保函数计算函数的自定义域名已开启 TLS。"}, Reason: models.I18nString{"de": "TLS verschlüsselt den Datenverkehr zu Ihrer Funktion und gewährleistet Datenvertraulichkeit und -integrität.", "en": "TLS encrypts traffic to your function, ensuring data confidentiality and integrity.", "es": "TLS cifra el tráfico a su función, garantizando la confidencialidad e integridad de los datos.", "fr": "TLS chiffre le trafic vers votre fonction, garantissant la confidentialité et l'intégrité des données.", "ja": "TLS は関数へのトラフィックを暗号化し、データの機密性と整合性を確保します。", "pt": "TLS criptografa o tráfego para sua função, garantindo confidencialidade e integridade dos dados.", "zh": "TLS 对到函数的流量进行加密，确保数据机密性和完整性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie ein SSL-Zertifikat und aktivieren Sie TLS für die Function Compute-Benutzerdomain.", "en": "Configure an SSL certificate and enable TLS for the Function Compute custom domain.", "es": "Configure un certificado SSL y habilite TLS para el dominio personalizado de Function Compute.", "fr": "Configurez un certificat SSL et activez TLS pour le domaine personnalisé Function Compute.", "ja": "SSL 証明書を設定し、関数計算カスタムドメインの TLS を有効にします。", "pt": "Configure um certificado SSL e habilite TLS para o domínio personalizado do Function Compute.", "zh": "为函数计算自定义域名配置 SSL 证书并开启 TLS。"}, ResourceTypes: []string{"ALIYUN::FC::CustomDomain"}, FilePath: "aliyun/rules/fc-function-custom-domain-and-tls-enable.rego", PackageName: "infraguard.rules.aliyun.fc_function_custom_domain_and_tls_enable", Content: "package infraguard.rules.aliyun.fc_function_custom_domain_and_tls_enable\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-function-custom-domain-and-tls-enable\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Function Custom Domain and TLS Enabled\",\n\t\t\"zh\": \"FC 函数自定义域名及 TLS 开启\",\n\t\t\"ja\": \"FC 関数カスタムドメインおよび TLS が有効\",\n\t\t\"de\": \"FC-Funktion Benutzerdefinierte Domain und TLS aktiviert\",\n\t\t\"es\": \"Dominio Personalizado y TLS de Función FC Habilitado\",\n\t\t\"fr\": \"Domaine Personnalisé et TLS de Fonction FC Activé\",\n\t\t\"pt\": \"Domínio Personalizado e TLS de Função FC Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that custom domains for Function Compute functions have TLS enabled.\",\n\t\t\"zh\": \"确保函数计算函数的自定义域名已开启 TLS。\",\n\t\t\"ja\": \"関数計算関数のカスタムドメインで TLS が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass benutzerdefinierte Domains für Function Compute-Funktionen TLS aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los dominios personalizados para funciones de Function Compute tengan TLS habilitado.\",\n\t\t\"fr\": \"Garantit que les domaines personnalisés pour les fonctions Function Compute ont TLS activé.\",\n\t\t\"pt\": \"Garante que os domínios personalizados para funções Function Compute tenham TLS habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"TLS encrypts traffic to your function, ensuring data confidentiality and integrity.\",\n\t\t\"zh\": \"TLS 对到函数的流量进行加密，确保数据机密性和完整性。\",\n\t\t\"ja\": \"TLS は関数へのトラフィックを暗号化し、データの機密性と整合性を確保します。\",\n\t\t\"de\": \"TLS verschlüsselt den Datenverkehr zu Ihrer Funktion und gewährleistet Datenvertraulichkeit und -integrität.\",\n\t\t\"es\": \"TLS cifra el tráfico a su función, garantizando la confidencialidad e integridad de los datos.\",\n\t\t\"fr\": \"TLS chiffre le trafic vers votre fonction, garantissant la confidentialité et l'intégrité des données.\",\n\t\t\"pt\": \"TLS criptografa o tráfego para sua função, garantindo confidencialidade e integridade dos dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure an SSL certificate and enable TLS for the Function Compute custom domain.\",\n\t\t\"zh\": \"为函数计算自定义域名配置 SSL 证书并开启 TLS。\",\n\t\t\"ja\": \"SSL 証明書を設定し、関数計算カスタムドメインの TLS を有効にします。\",\n\t\t\"de\": \"Konfigurieren Sie ein SSL-Zertifikat und aktivieren Sie TLS für die Function Compute-Benutzerdomain.\",\n\t\t\"es\": \"Configure un certificado SSL y habilite TLS para el dominio personalizado de Function Compute.\",\n\t\t\"fr\": \"Configurez un certificat SSL et activez TLS pour le domaine personnalisé Function Compute.\",\n\t\t\"pt\": \"Configure um certificado SSL e habilite TLS para o domínio personalizado do Function Compute.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::CustomDomain\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::CustomDomain\")\n\n\t# Conceptual check for TLS\n\tnot helpers.has_property(resource, \"CertConfig\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-function-internet-and-custom-domain-enable", Name: models.I18nString{"de": "FC-Service Internetzugang mit benutzerdefinierter Domäne", "en": "FC Service Internet Access with Custom Domain", "es": "Acceso a Internet del Servicio FC con Dominio Personalizado", "fr": "Accès Internet au Service FC avec Domaine Personnalisé", "ja": "カスタムドメインを使用した FC サービスインターネットアクセス", "pt": "Acesso à Internet do Serviço FC com Domínio Personalizado", "zh": "函数计算服务允许访问公网且绑定到自定义域名"}, Severity: "medium", Description: models.I18nString{"de": "FC-Services mit Internetzugang sollten an benutzerdefinierte Domänen gebunden werden, um ordnungsgemäße Zugriffskontrolle zu gewährleisten.", "en": "FC services with internet access should be bound to custom domains for proper access control.", "es": "Los servicios FC con acceso a Internet deben estar vinculados a dominios personalizados para un control de acceso adecuado.", "fr": "Les services FC avec accès Internet doivent être liés à des domaines personnalisés pour un contrôle d'accès approprié.", "ja": "インターネットアクセスを持つ FC サービスは、適切なアクセス制御のためにカスタムドメインにバインドする必要があります。", "pt": "Os serviços FC com acesso à Internet devem estar vinculados a domínios personalizados para controle de acesso adequado.", "zh": "函数计算服务在允许公网访问时绑定了自定义域名，视为合规。"}, Reason: models.I18nString{"de": "Der FC-Service erlaubt Internetzugang, hat aber möglicherweise keine benutzerdefinierten Domänen konfiguriert.", "en": "The FC service allows internet access but may not have custom domains configured.", "es": "El servicio FC permite acceso a Internet pero puede no tener dominios personalizados configurados.", "fr": "Le service FC autorise l'accès Internet mais peut ne pas avoir de domaines personnalisés configurés.", "ja": "FC サービスはインターネットアクセスを許可していますが、カスタムドメインが設定されていない可能性があります。", "pt": "O serviço FC permite acesso à Internet, mas pode não ter domínios personalizados configurados.", "zh": "函数计算服务允许访问公网，但可能未配置自定义域名。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie benutzerdefinierte Domänen für FC-Services, die Internetzugang benötigen.", "en": "Configure custom domains for FC services that need internet access.", "es": "Configure dominios personalizados para servicios FC que necesitan acceso a Internet.", "fr": "Configurez des domaines personnalisés pour les services FC qui ont besoin d'un accès Internet.", "ja": "インターネットアクセスが必要な FC サービスにカスタムドメインを設定します。", "pt": "Configure domínios personalizados para serviços FC que precisam de acesso à Internet.", "zh": "为需要公网访问的函数计算服务配置自定义域名。"}, ResourceTypes: []string{"ALIYUN::FC::Service"}, FilePath: "aliyun/rules/fc-function-internet-and-custom-domain-enable.rego", PackageName: "infraguard.rules.aliyun.fc_function_internet_and_custom_domain_enable", Content: "package infraguard.rules.aliyun.fc_function_internet_and_custom_domain_enable\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-function-internet-and-custom-domain-enable\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Service Internet Access with Custom Domain\",\n\t\t\"zh\": \"函数计算服务允许访问公网且绑定到自定义域名\",\n\t\t\"ja\": \"カスタムドメインを使用した FC サービスインターネットアクセス\",\n\t\t\"de\": \"FC-Service Internetzugang mit benutzerdefinierter Domäne\",\n\t\t\"es\": \"Acceso a Internet del Servicio FC con Dominio Personalizado\",\n\t\t\"fr\": \"Accès Internet au Service FC avec Domaine Personnalisé\",\n\t\t\"pt\": \"Acesso à Internet do Serviço FC com Domínio Personalizado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"FC services with internet access should be bound to custom domains for proper access control.\",\n\t\t\"zh\": \"函数计算服务在允许公网访问时绑定了自定义域名，视为合规。\",\n\t\t\"ja\": \"インターネットアクセスを持つ FC サービスは、適切なアクセス制御のためにカスタムドメインにバインドする必要があります。\",\n\t\t\"de\": \"FC-Services mit Internetzugang sollten an benutzerdefinierte Domänen gebunden werden, um ordnungsgemäße Zugriffskontrolle zu gewährleisten.\",\n\t\t\"es\": \"Los servicios FC con acceso a Internet deben estar vinculados a dominios personalizados para un control de acceso adecuado.\",\n\t\t\"fr\": \"Les services FC avec accès Internet doivent être liés à des domaines personnalisés pour un contrôle d'accès approprié.\",\n\t\t\"pt\": \"Os serviços FC com acesso à Internet devem estar vinculados a domínios personalizados para controle de acesso adequado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The FC service allows internet access but may not have custom domains configured.\",\n\t\t\"zh\": \"函数计算服务允许访问公网，但可能未配置自定义域名。\",\n\t\t\"ja\": \"FC サービスはインターネットアクセスを許可していますが、カスタムドメインが設定されていない可能性があります。\",\n\t\t\"de\": \"Der FC-Service erlaubt Internetzugang, hat aber möglicherweise keine benutzerdefinierten Domänen konfiguriert.\",\n\t\t\"es\": \"El servicio FC permite acceso a Internet pero puede no tener dominios personalizados configurados.\",\n\t\t\"fr\": \"Le service FC autorise l'accès Internet mais peut ne pas avoir de domaines personnalisés configurés.\",\n\t\t\"pt\": \"O serviço FC permite acesso à Internet, mas pode não ter domínios personalizados configurados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure custom domains for FC services that need internet access.\",\n\t\t\"zh\": \"为需要公网访问的函数计算服务配置自定义域名。\",\n\t\t\"ja\": \"インターネットアクセスが必要な FC サービスにカスタムドメインを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie benutzerdefinierte Domänen für FC-Services, die Internetzugang benötigen.\",\n\t\t\"es\": \"Configure dominios personalizados para servicios FC que necesitan acceso a Internet.\",\n\t\t\"fr\": \"Configurez des domaines personnalisés pour les services FC qui ont besoin d'un accès Internet.\",\n\t\t\"pt\": \"Configure domínios personalizados para serviços FC que precisam de acesso à Internet.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Service\"]\n}\n\n# Check if service has internet access\nhas_internet_access(resource) if {\n\thelpers.get_property(resource, \"InternetAccess\", false) == true\n}\n\n# Check if any custom domain exists in the template (regardless of service)\nhas_custom_domain_in_template if {\n\tcount(helpers.resources_by_type(\"ALIYUN::FC::CustomDomain\")) > 0\n}\n\n# Deny rule: FC services with internet access should have custom domains in template\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Service\")\n\thas_internet_access(resource)\n\tnot has_custom_domain_in_template\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InternetAccess\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-function-runtime-check", Name: models.I18nString{"de": "FC-Funktionslaufzeitprüfung", "en": "FC Function Runtime Check", "es": "Verificación de Runtime de Función FC", "fr": "Vérification du Runtime de Fonction FC", "ja": "FC 関数ランタイムチェック", "pt": "Verificação de Runtime de Função FC", "zh": "FC 未使用废弃的运行时"}, Severity: "high", Description: models.I18nString{"de": "FC-Funktionen sollten keine veralteten Laufzeiten verwenden, die Sicherheitslücken haben können.", "en": "FC functions should not use deprecated runtimes that may have security vulnerabilities.", "es": "Las funciones FC no deben usar runtimes deprecados que puedan tener vulnerabilidades de seguridad.", "fr": "Les fonctions FC ne doivent pas utiliser de runtimes dépréciés qui peuvent avoir des vulnérabilités de sécurité.", "ja": "FC 関数は、セキュリティの脆弱性がある可能性のある非推奨ランタイムを使用すべきではありません。", "pt": "As funções FC não devem usar runtimes depreciados que possam ter vulnerabilidades de segurança.", "zh": "FC 使用的运行时未废弃，则视为合规。截止 2025-04-20，本规则检测废弃版本清单为：nodejs12,nodejs10,nodejs8,dotnetcore2.1,python2.7,nodejs6,nodejs4.4。"}, Reason: models.I18nString{"de": "Die FC-Funktion verwendet eine veraltete Laufzeit, die Sicherheitslücken haben kann.", "en": "The FC function is using a deprecated runtime that may have security vulnerabilities.", "es": "La función FC está usando un runtime deprecado que puede tener vulnerabilidades de seguridad.", "fr": "La fonction FC utilise un runtime déprécié qui peut avoir des vulnérabilités de sécurité.", "ja": "FC 関数がセキュリティの脆弱性がある可能性のある非推奨ランタイムを使用しています。", "pt": "A função FC está usando um runtime depreciado que pode ter vulnerabilidades de segurança.", "zh": "FC 函数使用了已废弃的运行时，可能存在安全漏洞。"}, Recommendation: models.I18nString{"de": "Migrieren Sie die Funktion auf eine unterstützte Laufzeitversion. Siehe FC-Dokumentation für unterstützte Laufzeiten.", "en": "Migrate the function to a supported runtime version. See FC documentation for supported runtimes.", "es": "Migre la función a una versión de runtime compatible. Consulte la documentación de FC para ver los runtimes compatibles.", "fr": "Migrez la fonction vers une version de runtime prise en charge. Consultez la documentation FC pour les runtimes pris en charge.", "ja": "関数をサポートされているランタイムバージョンに移行します。サポートされているランタイムについては、FC ドキュメントを参照してください。", "pt": "Migre a função para uma versão de runtime suportada. Consulte a documentação do FC para runtimes suportados.", "zh": "将函数迁移到支持的运行时版本。请参阅 FC 文档了解支持的运行时。"}, ResourceTypes: []string{"ALIYUN::FC::Function"}, FilePath: "aliyun/rules/fc-function-runtime-check.rego", PackageName: "infraguard.rules.aliyun.fc_function_runtime_check", Content: "package infraguard.rules.aliyun.fc_function_runtime_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-function-runtime-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"FC Function Runtime Check\",\n\t\t\"zh\": \"FC 未使用废弃的运行时\",\n\t\t\"ja\": \"FC 関数ランタイムチェック\",\n\t\t\"de\": \"FC-Funktionslaufzeitprüfung\",\n\t\t\"es\": \"Verificación de Runtime de Función FC\",\n\t\t\"fr\": \"Vérification du Runtime de Fonction FC\",\n\t\t\"pt\": \"Verificação de Runtime de Função FC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"FC functions should not use deprecated runtimes that may have security vulnerabilities.\",\n\t\t\"zh\": \"FC 使用的运行时未废弃，则视为合规。截止 2025-04-20，本规则检测废弃版本清单为：nodejs12,nodejs10,nodejs8,dotnetcore2.1,python2.7,nodejs6,nodejs4.4。\",\n\t\t\"ja\": \"FC 関数は、セキュリティの脆弱性がある可能性のある非推奨ランタイムを使用すべきではありません。\",\n\t\t\"de\": \"FC-Funktionen sollten keine veralteten Laufzeiten verwenden, die Sicherheitslücken haben können.\",\n\t\t\"es\": \"Las funciones FC no deben usar runtimes deprecados que puedan tener vulnerabilidades de seguridad.\",\n\t\t\"fr\": \"Les fonctions FC ne doivent pas utiliser de runtimes dépréciés qui peuvent avoir des vulnérabilités de sécurité.\",\n\t\t\"pt\": \"As funções FC não devem usar runtimes depreciados que possam ter vulnerabilidades de segurança.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The FC function is using a deprecated runtime that may have security vulnerabilities.\",\n\t\t\"zh\": \"FC 函数使用了已废弃的运行时，可能存在安全漏洞。\",\n\t\t\"ja\": \"FC 関数がセキュリティの脆弱性がある可能性のある非推奨ランタイムを使用しています。\",\n\t\t\"de\": \"Die FC-Funktion verwendet eine veraltete Laufzeit, die Sicherheitslücken haben kann.\",\n\t\t\"es\": \"La función FC está usando un runtime deprecado que puede tener vulnerabilidades de seguridad.\",\n\t\t\"fr\": \"La fonction FC utilise un runtime déprécié qui peut avoir des vulnérabilités de sécurité.\",\n\t\t\"pt\": \"A função FC está usando um runtime depreciado que pode ter vulnerabilidades de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Migrate the function to a supported runtime version. See FC documentation for supported runtimes.\",\n\t\t\"zh\": \"将函数迁移到支持的运行时版本。请参阅 FC 文档了解支持的运行时。\",\n\t\t\"ja\": \"関数をサポートされているランタイムバージョンに移行します。サポートされているランタイムについては、FC ドキュメントを参照してください。\",\n\t\t\"de\": \"Migrieren Sie die Funktion auf eine unterstützte Laufzeitversion. Siehe FC-Dokumentation für unterstützte Laufzeiten.\",\n\t\t\"es\": \"Migre la función a una versión de runtime compatible. Consulte la documentación de FC para ver los runtimes compatibles.\",\n\t\t\"fr\": \"Migrez la fonction vers une version de runtime prise en charge. Consultez la documentation FC pour les runtimes pris en charge.\",\n\t\t\"pt\": \"Migre a função para uma versão de runtime suportada. Consulte a documentação do FC para runtimes suportados.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Function\"]\n}\n\n# Deprecated runtimes as of the specified date (using Set for string key lookup)\ndeprecated_runtimes := {\n\t\"nodejs12\",\n\t\"nodejs10\",\n\t\"nodejs8\",\n\t\"dotnetcore2.1\",\n\t\"python2.7\",\n\t\"nodejs6\",\n\t\"nodejs4.4\",\n}\n\n# Deny rule: FC functions must not use deprecated runtimes\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Function\")\n\truntime := helpers.get_property(resource, \"Runtime\", \"\")\n\tdeprecated_runtimes[runtime]\n\tresult := {\n\t\t\"id\": \"fc-function-runtime-check\",\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Runtime\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": \"high\",\n\t\t\t\"reason\": \"The FC function is using a deprecated runtime that may have security vulnerabilities.\",\n\t\t\t\"recommendation\": \"Migrate the function to a supported runtime version.\",\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-function-settings-check", Name: models.I18nString{"de": "FC-Funktionseinstellungsprüfung", "en": "FC Function Settings Check", "es": "Verificación de Configuración de Función FC", "fr": "Vérification des Paramètres de Fonction FC", "ja": "FC 関数設定チェック", "pt": "Verificação de Configurações de Função FC", "zh": "函数计算中函数设置满足参数指定要求"}, Severity: "medium", Description: models.I18nString{"de": "FC-Funktionseinstellungen sollten die angegebenen Anforderungen für optimale Leistung und Sicherheit erfüllen.", "en": "FC function settings should meet specified requirements for optimal performance and security.", "es": "Las configuraciones de función FC deben cumplir con los requisitos especificados para un rendimiento y seguridad óptimos.", "fr": "Les paramètres de fonction FC doivent répondre aux exigences spécifiées pour des performances et une sécurité optimales.", "ja": "FC 関数設定は、最適なパフォーマンスとセキュリティのために指定された要件を満たす必要があります。", "pt": "As configurações de função FC devem atender aos requisitos especificados para desempenho e segurança ideais.", "zh": "函数计算 2.0 中的函数设置满足参数指定的要求，视为合规。"}, Reason: models.I18nString{"de": "Die FC-Funktionseinstellungen erfüllen möglicherweise nicht die angegebenen Anforderungen.", "en": "The FC function settings may not meet the specified requirements.", "es": "Las configuraciones de función FC pueden no cumplir con los requisitos especificados.", "fr": "Les paramètres de fonction FC peuvent ne pas répondre aux exigences spécifiées.", "ja": "FC 関数設定が指定された要件を満たしていない可能性があります。", "pt": "As configurações de função FC podem não atender aos requisitos especificados.", "zh": "函数计算中的函数设置可能不满足指定要求。"}, Recommendation: models.I18nString{"de": "Überprüfen und aktualisieren Sie die Funktionseinstellungen gemäß den Anforderungen Ihrer Organisation.", "en": "Review and update function settings according to your organization's requirements.", "es": "Revise y actualice la configuración de la función según los requisitos de su organización.", "fr": "Examinez et mettez à jour les paramètres de fonction selon les exigences de votre organisation.", "ja": "組織の要件に従って関数設定を確認し、更新します。", "pt": "Revise e atualize as configurações da função de acordo com os requisitos da sua organização.", "zh": "根据组织要求审查和更新函数设置。"}, ResourceTypes: []string{"ALIYUN::FC::Function"}, FilePath: "aliyun/rules/fc-function-settings-check.rego", PackageName: "infraguard.rules.aliyun.fc_function_settings_check", Content: "package infraguard.rules.aliyun.fc_function_settings_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-function-settings-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Function Settings Check\",\n\t\t\"zh\": \"函数计算中函数设置满足参数指定要求\",\n\t\t\"ja\": \"FC 関数設定チェック\",\n\t\t\"de\": \"FC-Funktionseinstellungsprüfung\",\n\t\t\"es\": \"Verificación de Configuración de Función FC\",\n\t\t\"fr\": \"Vérification des Paramètres de Fonction FC\",\n\t\t\"pt\": \"Verificação de Configurações de Função FC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"FC function settings should meet specified requirements for optimal performance and security.\",\n\t\t\"zh\": \"函数计算 2.0 中的函数设置满足参数指定的要求，视为合规。\",\n\t\t\"ja\": \"FC 関数設定は、最適なパフォーマンスとセキュリティのために指定された要件を満たす必要があります。\",\n\t\t\"de\": \"FC-Funktionseinstellungen sollten die angegebenen Anforderungen für optimale Leistung und Sicherheit erfüllen.\",\n\t\t\"es\": \"Las configuraciones de función FC deben cumplir con los requisitos especificados para un rendimiento y seguridad óptimos.\",\n\t\t\"fr\": \"Les paramètres de fonction FC doivent répondre aux exigences spécifiées pour des performances et une sécurité optimales.\",\n\t\t\"pt\": \"As configurações de função FC devem atender aos requisitos especificados para desempenho e segurança ideais.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The FC function settings may not meet the specified requirements.\",\n\t\t\"zh\": \"函数计算中的函数设置可能不满足指定要求。\",\n\t\t\"ja\": \"FC 関数設定が指定された要件を満たしていない可能性があります。\",\n\t\t\"de\": \"Die FC-Funktionseinstellungen erfüllen möglicherweise nicht die angegebenen Anforderungen.\",\n\t\t\"es\": \"Las configuraciones de función FC pueden no cumplir con los requisitos especificados.\",\n\t\t\"fr\": \"Les paramètres de fonction FC peuvent ne pas répondre aux exigences spécifiées.\",\n\t\t\"pt\": \"As configurações de função FC podem não atender aos requisitos especificados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Review and update function settings according to your organization's requirements.\",\n\t\t\"zh\": \"根据组织要求审查和更新函数设置。\",\n\t\t\"ja\": \"組織の要件に従って関数設定を確認し、更新します。\",\n\t\t\"de\": \"Überprüfen und aktualisieren Sie die Funktionseinstellungen gemäß den Anforderungen Ihrer Organisation.\",\n\t\t\"es\": \"Revise y actualice la configuración de la función según los requisitos de su organización.\",\n\t\t\"fr\": \"Examinez et mettez à jour les paramètres de fonction selon les exigences de votre organisation.\",\n\t\t\"pt\": \"Revise e atualize as configurações da função de acordo com os requisitos da sua organização.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Function\"]\n}\n\n# Deny rule: FC functions should have valid settings\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Function\")\n\thandler := helpers.get_property(resource, \"Handler\", \"\")\n\thandler == \"\"\n\tresult := {\n\t\t\"id\": \"fc-function-settings-check\",\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Handler\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": \"medium\",\n\t\t\t\"reason\": \"The function does not have valid settings configured.\",\n\t\t\t\"recommendation\": \"Configure proper Handler for the function.\",\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-service-bind-role", Name: models.I18nString{"de": "FC-Service an RAM-Rolle gebunden", "en": "FC Service Bound to RAM Role", "es": "Servicio FC Vinculado a Rol RAM", "fr": "Service FC Lié au Rôle RAM", "ja": "FC サービスが RAM ロールにバインドされている", "pt": "Serviço FC Vinculado à Função RAM", "zh": "FC 服务绑定角色"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der Function Compute-Service eine RAM-Rolle gebunden hat.", "en": "Ensures that the Function Compute service has a RAM role bound to it.", "es": "Garantiza que el servicio Function Compute tenga un rol RAM vinculado.", "fr": "Garantit que le service Function Compute a un rôle RAM lié.", "ja": "関数計算サービスに RAM ロールがバインドされていることを確認します。", "pt": "Garante que o serviço Function Compute tenha uma função RAM vinculada.", "zh": "确保函数计算服务绑定了 RAM 角色。"}, Reason: models.I18nString{"de": "Das Binden einer RAM-Rolle an einen FC-Service ermöglicht es der Funktion, sicher auf andere Alibaba Cloud-Ressourcen zuzugreifen.", "en": "Binding a RAM role to an FC service allows the function to securely access other Alibaba Cloud resources.", "es": "Vincular un rol RAM a un servicio FC permite que la función acceda de forma segura a otros recursos de Alibaba Cloud.", "fr": "Lier un rôle RAM à un service FC permet à la fonction d'accéder en toute sécurité à d'autres ressources Alibaba Cloud.", "ja": "FC サービスに RAM ロールをバインドすることで、関数が他の Alibaba Cloud リソースに安全にアクセスできるようになります。", "pt": "Vincular uma função RAM a um serviço FC permite que a função acesse com segurança outros recursos da Alibaba Cloud.", "zh": "为 FC 服务绑定 RAM 角色允许函数安全地访问其他阿里云资源。"}, Recommendation: models.I18nString{"de": "Binden Sie eine RAM-Rolle an den Function Compute-Service.", "en": "Bind a RAM role to the Function Compute service.", "es": "Vincule un rol RAM al servicio Function Compute.", "fr": "Lieez un rôle RAM au service Function Compute.", "ja": "関数計算サービスに RAM ロールをバインドします。", "pt": "Vincule uma função RAM ao serviço Function Compute.", "zh": "为函数计算服务绑定 RAM 角色。"}, ResourceTypes: []string{"ALIYUN::FC::Service"}, FilePath: "aliyun/rules/fc-service-bind-role.rego", PackageName: "infraguard.rules.aliyun.fc_service_bind_role", Content: "package infraguard.rules.aliyun.fc_service_bind_role\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-service-bind-role\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Service Bound to RAM Role\",\n\t\t\"zh\": \"FC 服务绑定角色\",\n\t\t\"ja\": \"FC サービスが RAM ロールにバインドされている\",\n\t\t\"de\": \"FC-Service an RAM-Rolle gebunden\",\n\t\t\"es\": \"Servicio FC Vinculado a Rol RAM\",\n\t\t\"fr\": \"Service FC Lié au Rôle RAM\",\n\t\t\"pt\": \"Serviço FC Vinculado à Função RAM\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the Function Compute service has a RAM role bound to it.\",\n\t\t\"zh\": \"确保函数计算服务绑定了 RAM 角色。\",\n\t\t\"ja\": \"関数計算サービスに RAM ロールがバインドされていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der Function Compute-Service eine RAM-Rolle gebunden hat.\",\n\t\t\"es\": \"Garantiza que el servicio Function Compute tenga un rol RAM vinculado.\",\n\t\t\"fr\": \"Garantit que le service Function Compute a un rôle RAM lié.\",\n\t\t\"pt\": \"Garante que o serviço Function Compute tenha uma função RAM vinculada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Binding a RAM role to an FC service allows the function to securely access other Alibaba Cloud resources.\",\n\t\t\"zh\": \"为 FC 服务绑定 RAM 角色允许函数安全地访问其他阿里云资源。\",\n\t\t\"ja\": \"FC サービスに RAM ロールをバインドすることで、関数が他の Alibaba Cloud リソースに安全にアクセスできるようになります。\",\n\t\t\"de\": \"Das Binden einer RAM-Rolle an einen FC-Service ermöglicht es der Funktion, sicher auf andere Alibaba Cloud-Ressourcen zuzugreifen.\",\n\t\t\"es\": \"Vincular un rol RAM a un servicio FC permite que la función acceda de forma segura a otros recursos de Alibaba Cloud.\",\n\t\t\"fr\": \"Lier un rôle RAM à un service FC permet à la fonction d'accéder en toute sécurité à d'autres ressources Alibaba Cloud.\",\n\t\t\"pt\": \"Vincular uma função RAM a um serviço FC permite que a função acesse com segurança outros recursos da Alibaba Cloud.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Bind a RAM role to the Function Compute service.\",\n\t\t\"zh\": \"为函数计算服务绑定 RAM 角色。\",\n\t\t\"ja\": \"関数計算サービスに RAM ロールをバインドします。\",\n\t\t\"de\": \"Binden Sie eine RAM-Rolle an den Function Compute-Service.\",\n\t\t\"es\": \"Vincule un rol RAM al servicio Function Compute.\",\n\t\t\"fr\": \"Lieez un rôle RAM au service Function Compute.\",\n\t\t\"pt\": \"Vincule uma função RAM ao serviço Function Compute.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Service\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Service\")\n\tnot helpers.has_property(resource, \"Role\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Role\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-service-internet-access-disable", Name: models.I18nString{"de": "FC-Service Internetzugriff deaktiviert", "en": "FC Service Internet Access Disabled", "es": "Acceso a Internet del Servicio FC Deshabilitado", "fr": "Accès Internet du Service FC Désactivé", "ja": "FC サービスインターネットアクセスが無効", "pt": "Acesso à Internet do Serviço FC Desabilitado", "zh": "FC 服务禁用公网访问"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der Function Compute-Service Internetzugriff deaktiviert hat, wenn er nur auf interne Ressourcen zugreifen sollte.", "en": "Ensures that the Function Compute service has internet access disabled when it should only access internal resources.", "es": "Garantiza que el servicio Function Compute tenga acceso a Internet deshabilitado cuando solo deba acceder a recursos internos.", "fr": "Garantit que le service Function Compute a l'accès Internet désactivé lorsqu'il ne doit accéder qu'aux ressources internes.", "ja": "関数計算サービスが内部リソースにのみアクセスする必要がある場合に、インターネットアクセスが無効になっていることを確認します。", "pt": "Garante que o serviço Function Compute tenha acesso à Internet desabilitado quando deve acessar apenas recursos internos.", "zh": "确保函数计算服务在仅需访问内网资源时已禁用公网访问。"}, Reason: models.I18nString{"de": "Das Deaktivieren des Internetzugriffs für FC-Services reduziert die Angriffsfläche und das Potenzial für Datenexfiltration.", "en": "Disabling internet access for FC services reduces the attack surface and potential for data exfiltration.", "es": "Deshabilitar el acceso a Internet para los servicios FC reduce la superficie de ataque y el potencial de exfiltración de datos.", "fr": "Désactiver l'accès Internet pour les services FC réduit la surface d'attaque et le potentiel d'exfiltration de données.", "ja": "FC サービスのインターネットアクセスを無効にすることで、攻撃面とデータ漏洩の可能性を減らします。", "pt": "Desabilitar o acesso à Internet para serviços FC reduz a superfície de ataque e o potencial de exfiltração de dados.", "zh": "为 FC 服务禁用公网访问可减少攻击面和潜在的数据泄露风险。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie den Internetzugriff für den Function Compute-Service.", "en": "Disable internet access for the Function Compute service.", "es": "Deshabilite el acceso a Internet para el servicio Function Compute.", "fr": "Désactivez l'accès Internet pour le service Function Compute.", "ja": "関数計算サービスのインターネットアクセスを無効にします。", "pt": "Desabilite o acesso à Internet para o serviço Function Compute.", "zh": "为函数计算服务禁用公网访问。"}, ResourceTypes: []string{"ALIYUN::FC::Service"}, FilePath: "aliyun/rules/fc-service-internet-access-disable.rego", PackageName: "infraguard.rules.aliyun.fc_service_internet_access_disable", Content: "package infraguard.rules.aliyun.fc_service_internet_access_disable\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-service-internet-access-disable\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Service Internet Access Disabled\",\n\t\t\"zh\": \"FC 服务禁用公网访问\",\n\t\t\"ja\": \"FC サービスインターネットアクセスが無効\",\n\t\t\"de\": \"FC-Service Internetzugriff deaktiviert\",\n\t\t\"es\": \"Acceso a Internet del Servicio FC Deshabilitado\",\n\t\t\"fr\": \"Accès Internet du Service FC Désactivé\",\n\t\t\"pt\": \"Acesso à Internet do Serviço FC Desabilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the Function Compute service has internet access disabled when it should only access internal resources.\",\n\t\t\"zh\": \"确保函数计算服务在仅需访问内网资源时已禁用公网访问。\",\n\t\t\"ja\": \"関数計算サービスが内部リソースにのみアクセスする必要がある場合に、インターネットアクセスが無効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der Function Compute-Service Internetzugriff deaktiviert hat, wenn er nur auf interne Ressourcen zugreifen sollte.\",\n\t\t\"es\": \"Garantiza que el servicio Function Compute tenga acceso a Internet deshabilitado cuando solo deba acceder a recursos internos.\",\n\t\t\"fr\": \"Garantit que le service Function Compute a l'accès Internet désactivé lorsqu'il ne doit accéder qu'aux ressources internes.\",\n\t\t\"pt\": \"Garante que o serviço Function Compute tenha acesso à Internet desabilitado quando deve acessar apenas recursos internos.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Disabling internet access for FC services reduces the attack surface and potential for data exfiltration.\",\n\t\t\"zh\": \"为 FC 服务禁用公网访问可减少攻击面和潜在的数据泄露风险。\",\n\t\t\"ja\": \"FC サービスのインターネットアクセスを無効にすることで、攻撃面とデータ漏洩の可能性を減らします。\",\n\t\t\"de\": \"Das Deaktivieren des Internetzugriffs für FC-Services reduziert die Angriffsfläche und das Potenzial für Datenexfiltration.\",\n\t\t\"es\": \"Deshabilitar el acceso a Internet para los servicios FC reduce la superficie de ataque y el potencial de exfiltración de datos.\",\n\t\t\"fr\": \"Désactiver l'accès Internet pour les services FC réduit la surface d'attaque et le potentiel d'exfiltration de données.\",\n\t\t\"pt\": \"Desabilitar o acesso à Internet para serviços FC reduz a superfície de ataque e o potencial de exfiltração de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable internet access for the Function Compute service.\",\n\t\t\"zh\": \"为函数计算服务禁用公网访问。\",\n\t\t\"ja\": \"関数計算サービスのインターネットアクセスを無効にします。\",\n\t\t\"de\": \"Deaktivieren Sie den Internetzugriff für den Function Compute-Service.\",\n\t\t\"es\": \"Deshabilite el acceso a Internet para el servicio Function Compute.\",\n\t\t\"fr\": \"Désactivez l'accès Internet pour le service Function Compute.\",\n\t\t\"pt\": \"Desabilite o acesso à Internet para o serviço Function Compute.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Service\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Service\")\n\thelpers.get_property(resource, \"InternetAccess\", true)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"InternetAccess\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-service-log-enable", Name: models.I18nString{"de": "FC-Service Protokoll aktivieren", "en": "FC Service Log Enable", "es": "Habilitar Registro del Servicio FC", "fr": "Activer le Journal du Service FC", "ja": "FC サービスログが有効", "pt": "Habilitar Log do Serviço FC", "zh": "函数计算服务启用日志功能"}, Severity: "medium", Description: models.I18nString{"de": "FC-Services sollten Protokollierung für Überwachung und Fehlerbehebung aktiviert haben.", "en": "FC services should have logging enabled for monitoring and troubleshooting.", "es": "Los servicios FC deben tener registro habilitado para monitoreo y solución de problemas.", "fr": "Les services FC doivent avoir la journalisation activée pour la surveillance et le dépannage.", "ja": "FC サービスは監視とトラブルシューティングのためにログ記録を有効にする必要があります。", "pt": "Os serviços FC devem ter registro habilitado para monitoramento e solução de problemas.", "zh": "函数计算服务启用日志功能，视为合规。"}, Reason: models.I18nString{"de": "Der FC-Service hat keine Protokollierung aktiviert, was die Fehlerbehebung und Prüfung beeinträchtigen kann.", "en": "The FC service does not have logging enabled, which may affect troubleshooting and auditing.", "es": "El servicio FC no tiene registro habilitado, lo que puede afectar la solución de problemas y la auditoría.", "fr": "Le service FC n'a pas la journalisation activée, ce qui peut affecter le dépannage et l'audit.", "ja": "FC サービスでログ記録が有効になっていないため、トラブルシューティングと監査に影響を与える可能性があります。", "pt": "O serviço FC não tem registro habilitado, o que pode afetar a solução de problemas e a auditoria.", "zh": "函数计算服务未启用日志功能，可能影响问题排查和审计。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Protokollierung für den FC-Service, indem Sie LogConfig mit Logstore und Project konfigurieren.", "en": "Enable logging for the FC service by configuring LogConfig with Logstore and Project.", "es": "Habilite el registro para el servicio FC configurando LogConfig con Logstore y Project.", "fr": "Activez la journalisation pour le service FC en configurant LogConfig avec Logstore et Project.", "ja": "Logstore と Project で LogConfig を設定して、FC サービスのログ記録を有効にします。", "pt": "Habilite o registro para o serviço FC configurando LogConfig com Logstore e Project.", "zh": "通过配置 LogConfig（包含 Logstore 和 Project）为函数计算服务启用日志。"}, ResourceTypes: []string{"ALIYUN::FC::Service"}, FilePath: "aliyun/rules/fc-service-log-enable.rego", PackageName: "infraguard.rules.aliyun.fc_service_log_enable", Content: "package infraguard.rules.aliyun.fc_service_log_enable\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"fc-service-log-enable\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Service Log Enable\",\n\t\t\"zh\": \"函数计算服务启用日志功能\",\n\t\t\"ja\": \"FC サービスログが有効\",\n\t\t\"de\": \"FC-Service Protokoll aktivieren\",\n\t\t\"es\": \"Habilitar Registro del Servicio FC\",\n\t\t\"fr\": \"Activer le Journal du Service FC\",\n\t\t\"pt\": \"Habilitar Log do Serviço FC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"FC services should have logging enabled for monitoring and troubleshooting.\",\n\t\t\"zh\": \"函数计算服务启用日志功能，视为合规。\",\n\t\t\"ja\": \"FC サービスは監視とトラブルシューティングのためにログ記録を有効にする必要があります。\",\n\t\t\"de\": \"FC-Services sollten Protokollierung für Überwachung und Fehlerbehebung aktiviert haben.\",\n\t\t\"es\": \"Los servicios FC deben tener registro habilitado para monitoreo y solución de problemas.\",\n\t\t\"fr\": \"Les services FC doivent avoir la journalisation activée pour la surveillance et le dépannage.\",\n\t\t\"pt\": \"Os serviços FC devem ter registro habilitado para monitoramento e solução de problemas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The FC service does not have logging enabled, which may affect troubleshooting and auditing.\",\n\t\t\"zh\": \"函数计算服务未启用日志功能，可能影响问题排查和审计。\",\n\t\t\"ja\": \"FC サービスでログ記録が有効になっていないため、トラブルシューティングと監査に影響を与える可能性があります。\",\n\t\t\"de\": \"Der FC-Service hat keine Protokollierung aktiviert, was die Fehlerbehebung und Prüfung beeinträchtigen kann.\",\n\t\t\"es\": \"El servicio FC no tiene registro habilitado, lo que puede afectar la solución de problemas y la auditoría.\",\n\t\t\"fr\": \"Le service FC n'a pas la journalisation activée, ce qui peut affecter le dépannage et l'audit.\",\n\t\t\"pt\": \"O serviço FC não tem registro habilitado, o que pode afetar a solução de problemas e a auditoria.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable logging for the FC service by configuring LogConfig with Logstore and Project.\",\n\t\t\"zh\": \"通过配置 LogConfig（包含 Logstore 和 Project）为函数计算服务启用日志。\",\n\t\t\"ja\": \"Logstore と Project で LogConfig を設定して、FC サービスのログ記録を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Protokollierung für den FC-Service, indem Sie LogConfig mit Logstore und Project konfigurieren.\",\n\t\t\"es\": \"Habilite el registro para el servicio FC configurando LogConfig con Logstore y Project.\",\n\t\t\"fr\": \"Activez la journalisation pour le service FC en configurant LogConfig avec Logstore et Project.\",\n\t\t\"pt\": \"Habilite o registro para o serviço FC configurando LogConfig com Logstore e Project.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Service\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Service\")\n\tlog_config := helpers.get_property(resource, \"LogConfig\", {})\n\tlog_config == {}\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LogConfig\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-service-tracing-enable", Name: models.I18nString{"de": "FC-Service Tracing aktivieren", "en": "FC Service Tracing Enable", "es": "Habilitar Seguimiento de Servicio FC", "fr": "Activer le Traçage de Service FC", "ja": "FC サービストレーシング有効", "pt": "Habilitar Rastreamento de Serviço FC", "zh": "函数计算服务启用链路追踪"}, Severity: "medium", Description: models.I18nString{"de": "FC-Services sollten Tracing für Leistungsüberwachung und Debugging aktiviert haben.", "en": "FC services should have tracing enabled for performance monitoring and debugging.", "es": "Los servicios FC deben tener seguimiento habilitado para monitoreo de rendimiento y depuración.", "fr": "Les services FC doivent avoir le traçage activé pour la surveillance des performances et le débogage.", "ja": "FC サービスは、パフォーマンス監視とデバッグのためにトレーシングを有効にする必要があります。", "pt": "Os serviços FC devem ter rastreamento habilitado para monitoramento de desempenho e depuração.", "zh": "函数计算服务启用链路追踪功能，视为合规。"}, Reason: models.I18nString{"de": "Der FC-Service hat kein Tracing aktiviert, was die Leistungsanalyse beeinträchtigen kann.", "en": "The FC service does not have tracing enabled, which may affect performance analysis.", "es": "El servicio FC no tiene seguimiento habilitado, lo que puede afectar el análisis de rendimiento.", "fr": "Le service FC n'a pas le traçage activé, ce qui peut affecter l'analyse des performances.", "ja": "FC サービスでトレーシングが有効になっていないため、パフォーマンス分析に影響を与える可能性があります。", "pt": "O serviço FC não tem rastreamento habilitado, o que pode afetar a análise de desempenho.", "zh": "函数计算服务未启用链路追踪，可能影响性能分析和问题排查。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Tracing für den FC-Service durch Konfiguration von TracingConfig.", "en": "Enable tracing for the FC service by configuring TracingConfig.", "es": "Habilite el seguimiento para el servicio FC configurando TracingConfig.", "fr": "Activez le traçage pour le service FC en configurant TracingConfig.", "ja": "TracingConfig を設定して FC サービスのトレーシングを有効にします。", "pt": "Habilite o rastreamento para o serviço FC configurando TracingConfig.", "zh": "通过配置 TracingConfig 为函数计算服务启用链路追踪。"}, ResourceTypes: []string{"ALIYUN::FC::Service"}, FilePath: "aliyun/rules/fc-service-tracing-enable.rego", PackageName: "infraguard.rules.aliyun.fc_service_tracing_enable", Content: "package infraguard.rules.aliyun.fc_service_tracing_enable\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"fc-service-tracing-enable\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Service Tracing Enable\",\n\t\t\"zh\": \"函数计算服务启用链路追踪\",\n\t\t\"ja\": \"FC サービストレーシング有効\",\n\t\t\"de\": \"FC-Service Tracing aktivieren\",\n\t\t\"es\": \"Habilitar Seguimiento de Servicio FC\",\n\t\t\"fr\": \"Activer le Traçage de Service FC\",\n\t\t\"pt\": \"Habilitar Rastreamento de Serviço FC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"FC services should have tracing enabled for performance monitoring and debugging.\",\n\t\t\"zh\": \"函数计算服务启用链路追踪功能，视为合规。\",\n\t\t\"ja\": \"FC サービスは、パフォーマンス監視とデバッグのためにトレーシングを有効にする必要があります。\",\n\t\t\"de\": \"FC-Services sollten Tracing für Leistungsüberwachung und Debugging aktiviert haben.\",\n\t\t\"es\": \"Los servicios FC deben tener seguimiento habilitado para monitoreo de rendimiento y depuración.\",\n\t\t\"fr\": \"Les services FC doivent avoir le traçage activé pour la surveillance des performances et le débogage.\",\n\t\t\"pt\": \"Os serviços FC devem ter rastreamento habilitado para monitoramento de desempenho e depuração.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The FC service does not have tracing enabled, which may affect performance analysis.\",\n\t\t\"zh\": \"函数计算服务未启用链路追踪，可能影响性能分析和问题排查。\",\n\t\t\"ja\": \"FC サービスでトレーシングが有効になっていないため、パフォーマンス分析に影響を与える可能性があります。\",\n\t\t\"de\": \"Der FC-Service hat kein Tracing aktiviert, was die Leistungsanalyse beeinträchtigen kann.\",\n\t\t\"es\": \"El servicio FC no tiene seguimiento habilitado, lo que puede afectar el análisis de rendimiento.\",\n\t\t\"fr\": \"Le service FC n'a pas le traçage activé, ce qui peut affecter l'analyse des performances.\",\n\t\t\"pt\": \"O serviço FC não tem rastreamento habilitado, o que pode afetar a análise de desempenho.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable tracing for the FC service by configuring TracingConfig.\",\n\t\t\"zh\": \"通过配置 TracingConfig 为函数计算服务启用链路追踪。\",\n\t\t\"ja\": \"TracingConfig を設定して FC サービスのトレーシングを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Tracing für den FC-Service durch Konfiguration von TracingConfig.\",\n\t\t\"es\": \"Habilite el seguimiento para el servicio FC configurando TracingConfig.\",\n\t\t\"fr\": \"Activez le traçage pour le service FC en configurant TracingConfig.\",\n\t\t\"pt\": \"Habilite o rastreamento para o serviço FC configurando TracingConfig.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Service\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Service\")\n\ttracing_config := helpers.get_property(resource, \"TracingConfig\", {})\n\ttracing_config == {}\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TracingConfig\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-service-vpc-binding", Name: models.I18nString{"de": "FC-Service VPC-Bindung aktiviert", "en": "FC Service VPC Binding Enabled", "es": "Vinculación VPC del Servicio FC Habilitada", "fr": "Liaison VPC du Service FC Activée", "ja": "FC サービス VPC バインディングが有効", "pt": "Vinculação VPC do Serviço FC Habilitada", "zh": "FC 服务绑定 VPC"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der Function Compute-Service so konfiguriert ist, dass er auf Ressourcen innerhalb eines VPC zugreift.", "en": "Ensures that the Function Compute service is configured to access resources within a VPC.", "es": "Garantiza que el servicio Function Compute esté configurado para acceder a recursos dentro de un VPC.", "fr": "Garantit que le service Function Compute est configuré pour accéder aux ressources dans un VPC.", "ja": "関数計算サービスが VPC 内のリソースにアクセスするように設定されていることを確認します。", "pt": "Garante que o serviço Function Compute esteja configurado para acessar recursos dentro de um VPC.", "zh": "确保函数计算服务已配置为访问 VPC 内的资源。"}, Reason: models.I18nString{"de": "Das Binden eines VPC an einen FC-Service ermöglicht es Funktionen, sicher auf interne Ressourcen wie Datenbanken und interne APIs zuzugreifen.", "en": "Binding a VPC to an FC service allows functions to securely access internal resources like databases and internal APIs.", "es": "Vincular un VPC a un servicio FC permite que las funciones accedan de forma segura a recursos internos como bases de datos y APIs internas.", "fr": "Lier un VPC à un service FC permet aux fonctions d'accéder en toute sécurité aux ressources internes telles que les bases de données et les API internes.", "ja": "VPC を FC サービスにバインドすると、関数がデータベースや内部 API などの内部リソースに安全にアクセスできます。", "pt": "Vincular um VPC a um serviço FC permite que as funções acessem com segurança recursos internos como bancos de dados e APIs internas.", "zh": "为 FC 服务绑定 VPC 允许函数安全地访问内网资源，如数据库和内部 API。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie den VPC-Zugriff für den Function Compute-Service.", "en": "Configure VPC access for the Function Compute service.", "es": "Configure el acceso VPC para el servicio Function Compute.", "fr": "Configurez l'accès VPC pour le service Function Compute.", "ja": "関数計算サービスの VPC アクセスを設定します。", "pt": "Configure o acesso VPC para o serviço Function Compute.", "zh": "为函数计算服务配置 VPC 访问。"}, ResourceTypes: []string{"ALIYUN::FC::Service"}, FilePath: "aliyun/rules/fc-service-vpc-binding.rego", PackageName: "infraguard.rules.aliyun.fc_service_vpc_binding", Content: "package infraguard.rules.aliyun.fc_service_vpc_binding\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-service-vpc-binding\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"FC Service VPC Binding Enabled\",\n\t\t\"zh\": \"FC 服务绑定 VPC\",\n\t\t\"ja\": \"FC サービス VPC バインディングが有効\",\n\t\t\"de\": \"FC-Service VPC-Bindung aktiviert\",\n\t\t\"es\": \"Vinculación VPC del Servicio FC Habilitada\",\n\t\t\"fr\": \"Liaison VPC du Service FC Activée\",\n\t\t\"pt\": \"Vinculação VPC do Serviço FC Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the Function Compute service is configured to access resources within a VPC.\",\n\t\t\"zh\": \"确保函数计算服务已配置为访问 VPC 内的资源。\",\n\t\t\"ja\": \"関数計算サービスが VPC 内のリソースにアクセスするように設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der Function Compute-Service so konfiguriert ist, dass er auf Ressourcen innerhalb eines VPC zugreift.\",\n\t\t\"es\": \"Garantiza que el servicio Function Compute esté configurado para acceder a recursos dentro de un VPC.\",\n\t\t\"fr\": \"Garantit que le service Function Compute est configuré pour accéder aux ressources dans un VPC.\",\n\t\t\"pt\": \"Garante que o serviço Function Compute esteja configurado para acessar recursos dentro de um VPC.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Binding a VPC to an FC service allows functions to securely access internal resources like databases and internal APIs.\",\n\t\t\"zh\": \"为 FC 服务绑定 VPC 允许函数安全地访问内网资源，如数据库和内部 API。\",\n\t\t\"ja\": \"VPC を FC サービスにバインドすると、関数がデータベースや内部 API などの内部リソースに安全にアクセスできます。\",\n\t\t\"de\": \"Das Binden eines VPC an einen FC-Service ermöglicht es Funktionen, sicher auf interne Ressourcen wie Datenbanken und interne APIs zuzugreifen.\",\n\t\t\"es\": \"Vincular un VPC a un servicio FC permite que las funciones accedan de forma segura a recursos internos como bases de datos y APIs internas.\",\n\t\t\"fr\": \"Lier un VPC à un service FC permet aux fonctions d'accéder en toute sécurité aux ressources internes telles que les bases de données et les API internes.\",\n\t\t\"pt\": \"Vincular um VPC a um serviço FC permite que as funções acessem com segurança recursos internos como bancos de dados e APIs internas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure VPC access for the Function Compute service.\",\n\t\t\"zh\": \"为函数计算服务配置 VPC 访问。\",\n\t\t\"ja\": \"関数計算サービスの VPC アクセスを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie den VPC-Zugriff für den Function Compute-Service.\",\n\t\t\"es\": \"Configure el acceso VPC para el servicio Function Compute.\",\n\t\t\"fr\": \"Configurez l'accès VPC pour le service Function Compute.\",\n\t\t\"pt\": \"Configure o acesso VPC para o serviço Function Compute.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Service\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Service\")\n\tnot helpers.has_property(resource, \"VpcConfig\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcConfig\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:fc-trigger-http-not-anonymous", Name: models.I18nString{"de": "FC HTTP-Trigger Authentifizierungsprüfung", "en": "FC HTTP Trigger Authentication Check", "es": "Verificación de Autenticación del Disparador HTTP FC", "fr": "Vérification d'Authentification du Déclencheur HTTP FC", "ja": "FC HTTP トリガー認証チェック", "pt": "Verificação de Autenticação do Gatilho HTTP FC", "zh": "函数 HTTP 触发器设置为需要身份验证"}, Severity: "high", Description: models.I18nString{"de": "FC HTTP-Trigger sollten Authentifizierung erfordern, um unbefugten Zugriff zu verhindern.", "en": "FC HTTP triggers should require authentication to prevent unauthorized access.", "es": "Los disparadores HTTP FC deben requerir autenticación para prevenir acceso no autorizado.", "fr": "Les déclencheurs HTTP FC doivent exiger une authentification pour empêcher l'accès non autorisé.", "ja": "FC HTTP トリガーは、不正アクセスを防ぐために認証を要求する必要があります。", "pt": "Os gatilhos HTTP FC devem exigir autenticação para prevenir acesso não autorizado.", "zh": "函数 HTTP 触发器配置为需要身份验证，视为合规。"}, Reason: models.I18nString{"de": "Der FC HTTP-Trigger erlaubt anonymen Zugriff, was die Funktion möglicherweise unbefugten Aufrufen aussetzt.", "en": "The FC HTTP trigger allows anonymous access, which may expose the function to unauthorized invocations.", "es": "El disparador HTTP FC permite acceso anónimo, lo que puede exponer la función a invocaciones no autorizadas.", "fr": "Le déclencheur HTTP FC autorise l'accès anonyme, ce qui peut exposer la fonction à des invocations non autorisées.", "ja": "FC HTTP トリガーが匿名アクセスを許可しているため、関数が不正な呼び出しにさらされる可能性があります。", "pt": "O gatilho HTTP FC permite acesso anônimo, o que pode expor a função a invocações não autorizadas.", "zh": "函数 HTTP 触发器允许匿名访问，可能导致未经授权的函数调用。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die Authentifizierung für den HTTP-Trigger, indem Sie den entsprechenden Autorisierungstyp festlegen.", "en": "Configure authentication for the HTTP trigger by setting appropriate authorization type.", "es": "Configure la autenticación para el disparador HTTP estableciendo el tipo de autorización apropiado.", "fr": "Configurez l'authentification pour le déclencheur HTTP en définissant le type d'autorisation approprié.", "ja": "適切な認証タイプを設定して、HTTP トリガーの認証を設定します。", "pt": "Configure a autenticação para o gatilho HTTP definindo o tipo de autorização apropriado.", "zh": "为 HTTP 触发器配置适当的授权类型以启用身份验证。"}, ResourceTypes: []string{"ALIYUN::FC::Trigger"}, FilePath: "aliyun/rules/fc-trigger-http-not-anonymous.rego", PackageName: "infraguard.rules.aliyun.fc_trigger_http_not_anonymous", Content: "package infraguard.rules.aliyun.fc_trigger_http_not_anonymous\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"fc-trigger-http-not-anonymous\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"FC HTTP Trigger Authentication Check\",\n\t\t\"zh\": \"函数 HTTP 触发器设置为需要身份验证\",\n\t\t\"ja\": \"FC HTTP トリガー認証チェック\",\n\t\t\"de\": \"FC HTTP-Trigger Authentifizierungsprüfung\",\n\t\t\"es\": \"Verificación de Autenticación del Disparador HTTP FC\",\n\t\t\"fr\": \"Vérification d'Authentification du Déclencheur HTTP FC\",\n\t\t\"pt\": \"Verificação de Autenticação do Gatilho HTTP FC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"FC HTTP triggers should require authentication to prevent unauthorized access.\",\n\t\t\"zh\": \"函数 HTTP 触发器配置为需要身份验证，视为合规。\",\n\t\t\"ja\": \"FC HTTP トリガーは、不正アクセスを防ぐために認証を要求する必要があります。\",\n\t\t\"de\": \"FC HTTP-Trigger sollten Authentifizierung erfordern, um unbefugten Zugriff zu verhindern.\",\n\t\t\"es\": \"Los disparadores HTTP FC deben requerir autenticación para prevenir acceso no autorizado.\",\n\t\t\"fr\": \"Les déclencheurs HTTP FC doivent exiger une authentification pour empêcher l'accès non autorisé.\",\n\t\t\"pt\": \"Os gatilhos HTTP FC devem exigir autenticação para prevenir acesso não autorizado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The FC HTTP trigger allows anonymous access, which may expose the function to unauthorized invocations.\",\n\t\t\"zh\": \"函数 HTTP 触发器允许匿名访问，可能导致未经授权的函数调用。\",\n\t\t\"ja\": \"FC HTTP トリガーが匿名アクセスを許可しているため、関数が不正な呼び出しにさらされる可能性があります。\",\n\t\t\"de\": \"Der FC HTTP-Trigger erlaubt anonymen Zugriff, was die Funktion möglicherweise unbefugten Aufrufen aussetzt.\",\n\t\t\"es\": \"El disparador HTTP FC permite acceso anónimo, lo que puede exponer la función a invocaciones no autorizadas.\",\n\t\t\"fr\": \"Le déclencheur HTTP FC autorise l'accès anonyme, ce qui peut exposer la fonction à des invocations non autorisées.\",\n\t\t\"pt\": \"O gatilho HTTP FC permite acesso anônimo, o que pode expor a função a invocações não autorizadas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure authentication for the HTTP trigger by setting appropriate authorization type.\",\n\t\t\"zh\": \"为 HTTP 触发器配置适当的授权类型以启用身份验证。\",\n\t\t\"ja\": \"適切な認証タイプを設定して、HTTP トリガーの認証を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie die Authentifizierung für den HTTP-Trigger, indem Sie den entsprechenden Autorisierungstyp festlegen.\",\n\t\t\"es\": \"Configure la autenticación para el disparador HTTP estableciendo el tipo de autorización apropiado.\",\n\t\t\"fr\": \"Configurez l'authentification pour le déclencheur HTTP en définissant le type d'autorisation approprié.\",\n\t\t\"pt\": \"Configure a autenticação para o gatilho HTTP definindo o tipo de autorização apropriado.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::FC::Trigger\"]\n}\n\n# Check if trigger is HTTP type and allows anonymous access\nis_anonymous_http_trigger(resource) if {\n\ttrigger_type := helpers.get_property(resource, \"TriggerType\", \"\")\n\ttrigger_type == \"http\"\n\ttrigger_config := helpers.get_property(resource, \"TriggerConfig\", {})\n\tauth_type := object.get(trigger_config, \"AuthType\", \"\")\n\tauth_type == \"anonymous\"\n}\n\n# Deny rule: HTTP triggers should not allow anonymous access\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::FC::Trigger\")\n\tis_anonymous_http_trigger(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TriggerConfig\", \"AuthType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:firewall-asset-open-protect", Name: models.I18nString{"de": "Cloud-Firewall-Asset-Schutz aktiviert", "en": "Cloud Firewall Asset Protection Enabled", "es": "Protección de Activos del Firewall en la Nube Habilitada", "fr": "Protection des Actifs du Pare-feu Cloud Activée", "ja": "クラウドファイアウォールアセット保護が有効", "pt": "Proteção de Ativos do Firewall em Nuvem Habilitada", "zh": "云防火墙资产开启保护"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Assets durch Cloud Firewall geschützt sind.", "en": "Ensures assets are protected by Cloud Firewall.", "es": "Garantiza que los activos estén protegidos por el Firewall en la Nube.", "fr": "Garantit que les actifs sont protégés par le Pare-feu Cloud.", "ja": "アセットがクラウドファイアウォールによって保護されていることを確認します。", "pt": "Garante que os ativos estejam protegidos pelo Firewall em Nuvem.", "zh": "确保资产已受云防火墙保护。"}, Reason: models.I18nString{"de": "Ungeschützte Assets sind anfällig für internetbasierte Bedrohungen.", "en": "Unprotected assets are vulnerable to internet-based threats.", "es": "Los activos no protegidos son vulnerables a amenazas basadas en internet.", "fr": "Les actifs non protégés sont vulnérables aux menaces basées sur Internet.", "ja": "保護されていないアセットは、インターネットベースの脅威に対して脆弱です。", "pt": "Ativos não protegidos são vulneráveis a ameaças baseadas em internet.", "zh": "未受保护的资产容易受到来自互联网的威胁。"}, Recommendation: models.I18nString{"de": "Fügen Sie die Ressource ALIYUN::CLOUDFW::FwSwitch hinzu, um den Schutz für alle öffentlich zugänglichen Assets in Cloud Firewall zu aktivieren.", "en": "Add ALIYUN::CLOUDFW::FwSwitch resource to enable protection for all public-facing assets in Cloud Firewall.", "es": "Agregue el recurso ALIYUN::CLOUDFW::FwSwitch para habilitar la protección para todos los activos públicos en el Firewall en la Nube.", "fr": "Ajoutez la ressource ALIYUN::CLOUDFW::FwSwitch pour activer la protection de tous les actifs publics dans le Pare-feu Cloud.", "ja": "ALIYUN::CLOUDFW::FwSwitch リソースを追加して、クラウドファイアウォール内のすべてのパブリック向けアセットの保護を有効にします。", "pt": "Adicione o recurso ALIYUN::CLOUDFW::FwSwitch para habilitar a proteção para todos os ativos públicos no Firewall em Nuvem.", "zh": "添加 ALIYUN::CLOUDFW::FwSwitch 资源以在云防火墙中为所有面向公网的资产开启保护。"}, ResourceTypes: []string{"ALIYUN::CLOUDFW::FwSwitch"}, FilePath: "aliyun/rules/firewall-asset-open-protect.rego", PackageName: "infraguard.rules.aliyun.firewall_asset_open_protect", Content: "package infraguard.rules.aliyun.firewall_asset_open_protect\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"firewall-asset-open-protect\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Cloud Firewall Asset Protection Enabled\",\n\t\t\"zh\": \"云防火墙资产开启保护\",\n\t\t\"ja\": \"クラウドファイアウォールアセット保護が有効\",\n\t\t\"de\": \"Cloud-Firewall-Asset-Schutz aktiviert\",\n\t\t\"es\": \"Protección de Activos del Firewall en la Nube Habilitada\",\n\t\t\"fr\": \"Protection des Actifs du Pare-feu Cloud Activée\",\n\t\t\"pt\": \"Proteção de Ativos do Firewall em Nuvem Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures assets are protected by Cloud Firewall.\",\n\t\t\"zh\": \"确保资产已受云防火墙保护。\",\n\t\t\"ja\": \"アセットがクラウドファイアウォールによって保護されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Assets durch Cloud Firewall geschützt sind.\",\n\t\t\"es\": \"Garantiza que los activos estén protegidos por el Firewall en la Nube.\",\n\t\t\"fr\": \"Garantit que les actifs sont protégés par le Pare-feu Cloud.\",\n\t\t\"pt\": \"Garante que os ativos estejam protegidos pelo Firewall em Nuvem.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Unprotected assets are vulnerable to internet-based threats.\",\n\t\t\"zh\": \"未受保护的资产容易受到来自互联网的威胁。\",\n\t\t\"ja\": \"保護されていないアセットは、インターネットベースの脅威に対して脆弱です。\",\n\t\t\"de\": \"Ungeschützte Assets sind anfällig für internetbasierte Bedrohungen.\",\n\t\t\"es\": \"Los activos no protegidos son vulnerables a amenazas basadas en internet.\",\n\t\t\"fr\": \"Les actifs non protégés sont vulnérables aux menaces basées sur Internet.\",\n\t\t\"pt\": \"Ativos não protegidos são vulneráveis a ameaças baseadas em internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add ALIYUN::CLOUDFW::FwSwitch resource to enable protection for all public-facing assets in Cloud Firewall.\",\n\t\t\"zh\": \"添加 ALIYUN::CLOUDFW::FwSwitch 资源以在云防火墙中为所有面向公网的资产开启保护。\",\n\t\t\"ja\": \"ALIYUN::CLOUDFW::FwSwitch リソースを追加して、クラウドファイアウォール内のすべてのパブリック向けアセットの保護を有効にします。\",\n\t\t\"de\": \"Fügen Sie die Ressource ALIYUN::CLOUDFW::FwSwitch hinzu, um den Schutz für alle öffentlich zugänglichen Assets in Cloud Firewall zu aktivieren.\",\n\t\t\"es\": \"Agregue el recurso ALIYUN::CLOUDFW::FwSwitch para habilitar la protección para todos los activos públicos en el Firewall en la Nube.\",\n\t\t\"fr\": \"Ajoutez la ressource ALIYUN::CLOUDFW::FwSwitch pour activer la protection de tous les actifs publics dans le Pare-feu Cloud.\",\n\t\t\"pt\": \"Adicione o recurso ALIYUN::CLOUDFW::FwSwitch para habilitar a proteção para todos os ativos públicos no Firewall em Nuvem.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CLOUDFW::FwSwitch\"]\n}\n\n# ALIYUN::CLOUDFW::FwSwitch resource existence means protection is enabled\n# This rule only checks if FwSwitch resources exist in the template\n# If no FwSwitch resource exists, we cannot verify protection at template level\n# This is a conceptual check that requires runtime verification\n# We only flag violations if there are other resources that might need protection\n# but no FwSwitch resources exist\n\n# Check if template has any resources that might need firewall protection\n# Exclude dummy resources like ALIYUN::ROS::WaitConditionHandle\nhas_resources_needing_protection if {\n\tsome name, resource in input.Resources\n\tresource.Type != \"ALIYUN::ROS::WaitConditionHandle\"\n}\n\n# Only flag violation if there are resources but no FwSwitch\ndeny contains result if {\n\thas_resources_needing_protection\n\tcount(helpers.resources_by_type(\"ALIYUN::CLOUDFW::FwSwitch\")) == 0\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": \"\",\n\t\t\"violation_path\": [\"Resources\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:gpdb-instance-disk-encryption-enabled", Name: models.I18nString{"de": "GPDB-Disk-Verschlüsselung aktiviert", "en": "GPDB Disk Encryption Enabled", "es": "Cifrado de Disco GPDB Habilitado", "fr": "Chiffrement de Disque GPDB Activé", "ja": "GPDB ディスク暗号化が有効", "pt": "Criptografia de Disco GPDB Habilitada", "zh": "GPDB 开启磁盘加密"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass GPDB-Instanzen Disk-Verschlüsselung aktiviert haben.", "en": "Ensures GPDB instances have disk encryption enabled.", "es": "Garantiza que las instancias GPDB tengan cifrado de disco habilitado.", "fr": "Garantit que les instances GPDB ont le chiffrement de disque activé.", "ja": "GPDB インスタンスでディスク暗号化が有効になっていることを確認します。", "pt": "Garante que as instâncias GPDB tenham criptografia de disco habilitada.", "zh": "确保 GPDB 实例开启了磁盘加密。"}, Reason: models.I18nString{"de": "Verschlüsselung im Ruhezustand schützt sensible Datenbankdateien vor unbefugtem Zugriff.", "en": "Encryption at rest protects sensitive database files from unauthorized access.", "es": "El cifrado en reposo protege los archivos de base de datos sensibles del acceso no autorizado.", "fr": "Le chiffrement au repos protège les fichiers de base de données sensibles contre l'accès non autorisé.", "ja": "保存時の暗号化により、機密データベースファイルが不正アクセスから保護されます。", "pt": "A criptografia em repouso protege arquivos de banco de dados sensíveis contra acesso não autorizado.", "zh": "静态加密保护敏感数据库文件免受未经授权的访问。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Disk-Verschlüsselung mit KMS für die GPDB-Instanz.", "en": "Enable disk encryption using KMS for the GPDB instance.", "es": "Habilite el cifrado de disco usando KMS para la instancia GPDB.", "fr": "Activez le chiffrement de disque en utilisant KMS pour l'instance GPDB.", "ja": "GPDB インスタンスに KMS を使用してディスク暗号化を有効にします。", "pt": "Habilite a criptografia de disco usando KMS para a instância GPDB.", "zh": "使用 KMS 为 GPDB 实例开启磁盘加密。"}, ResourceTypes: []string{"ALIYUN::GPDB::DBInstance"}, FilePath: "aliyun/rules/gpdb-instance-disk-encryption-enabled.rego", PackageName: "infraguard.rules.aliyun.gpdb_instance_disk_encryption_enabled", Content: "package infraguard.rules.aliyun.gpdb_instance_disk_encryption_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"gpdb-instance-disk-encryption-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"GPDB Disk Encryption Enabled\",\n\t\t\"zh\": \"GPDB 开启磁盘加密\",\n\t\t\"ja\": \"GPDB ディスク暗号化が有効\",\n\t\t\"de\": \"GPDB-Disk-Verschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado de Disco GPDB Habilitado\",\n\t\t\"fr\": \"Chiffrement de Disque GPDB Activé\",\n\t\t\"pt\": \"Criptografia de Disco GPDB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures GPDB instances have disk encryption enabled.\",\n\t\t\"zh\": \"确保 GPDB 实例开启了磁盘加密。\",\n\t\t\"ja\": \"GPDB インスタンスでディスク暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass GPDB-Instanzen Disk-Verschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias GPDB tengan cifrado de disco habilitado.\",\n\t\t\"fr\": \"Garantit que les instances GPDB ont le chiffrement de disque activé.\",\n\t\t\"pt\": \"Garante que as instâncias GPDB tenham criptografia de disco habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Encryption at rest protects sensitive database files from unauthorized access.\",\n\t\t\"zh\": \"静态加密保护敏感数据库文件免受未经授权的访问。\",\n\t\t\"ja\": \"保存時の暗号化により、機密データベースファイルが不正アクセスから保護されます。\",\n\t\t\"de\": \"Verschlüsselung im Ruhezustand schützt sensible Datenbankdateien vor unbefugtem Zugriff.\",\n\t\t\"es\": \"El cifrado en reposo protege los archivos de base de datos sensibles del acceso no autorizado.\",\n\t\t\"fr\": \"Le chiffrement au repos protège les fichiers de base de données sensibles contre l'accès non autorisé.\",\n\t\t\"pt\": \"A criptografia em repouso protege arquivos de banco de dados sensíveis contra acesso não autorizado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable disk encryption using KMS for the GPDB instance.\",\n\t\t\"zh\": \"使用 KMS 为 GPDB 实例开启磁盘加密。\",\n\t\t\"ja\": \"GPDB インスタンスに KMS を使用してディスク暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Disk-Verschlüsselung mit KMS für die GPDB-Instanz.\",\n\t\t\"es\": \"Habilite el cifrado de disco usando KMS para la instancia GPDB.\",\n\t\t\"fr\": \"Activez le chiffrement de disque en utilisant KMS pour l'instance GPDB.\",\n\t\t\"pt\": \"Habilite a criptografia de disco usando KMS para a instância GPDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::GPDB::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\t# EncryptionKey being set usually indicates encryption is enabled.\n\thelpers.has_property(resource, \"EncryptionKey\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::GPDB::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EncryptionKey\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:gpdb-instance-multi-zone", Name: models.I18nString{"de": "GPDB-Instanz Multi-Zone-Bereitstellung", "en": "GPDB Instance Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Instancia GPDB", "fr": "Déploiement Multi-Zone d'Instance GPDB", "ja": "GPDB インスタンスマルチゾーン展開", "pt": "Implantações Multi-Zona de Instância GPDB", "zh": "使用多可用区的云原生数据仓库 AnalyticDB 实例"}, Severity: "medium", Description: models.I18nString{"de": "GPDB-Instanzen sollten mit einer Standby-Zone für Hochverfügbarkeit bereitgestellt werden.", "en": "GPDB instances should be deployed with a standby zone for high availability.", "es": "Las instancias GPDB deben desplegarse con una zona de espera para alta disponibilidad.", "fr": "Les instances GPDB doivent être déployées avec une zone de secours pour une haute disponibilité.", "ja": "GPDB インスタンスは高可用性のためにスタンバイゾーンで展開する必要があります。", "pt": "As instâncias GPDB devem ser implantadas com uma zona de espera para alta disponibilidade.", "zh": "使用多可用区的云原生数据仓库 AnalyticDB 实例，视为合规。"}, Reason: models.I18nString{"de": "Die GPDB-Instanz hat keine Standby-Zone konfiguriert, was die Verfügbarkeit beeinträchtigen kann.", "en": "The GPDB instance does not have a standby zone configured, which may affect availability.", "es": "La instancia GPDB no tiene una zona de espera configurada, lo que puede afectar la disponibilidad.", "fr": "L'instance GPDB n'a pas de zone de secours configurée, ce qui peut affecter la disponibilité.", "ja": "GPDB インスタンスにスタンバイゾーンが設定されておらず、可用性に影響を与える可能性があります。", "pt": "A instância GPDB não tem uma zona de espera configurada, o que pode afetar a disponibilidade.", "zh": "GPDB 实例未配置备用可用区，可能影响可用性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie eine Standby-Zone, indem Sie die StandbyZoneId-Eigenschaft setzen, um Multi-Zone-Bereitstellung zu aktivieren.", "en": "Configure a standby zone by setting the StandbyZoneId property to enable multi-zone deployment.", "es": "Configure una zona de espera estableciendo la propiedad StandbyZoneId para habilitar el despliegue multi-zona.", "fr": "Configurez une zone de secours en définissant la propriété StandbyZoneId pour activer le déploiement multi-zone.", "ja": "StandbyZoneId プロパティを設定してスタンバイゾーンを設定し、マルチゾーン展開を有効にします。", "pt": "Configure uma zona de espera definindo a propriedade StandbyZoneId para habilitar a implantação multi-zona.", "zh": "通过设置 StandbyZoneId 属性配置备用可用区，以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::GPDB::DBInstance"}, FilePath: "aliyun/rules/gpdb-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.gpdb_instance_multi_zone", Content: "package infraguard.rules.aliyun.gpdb_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"gpdb-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"GPDB Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的云原生数据仓库 AnalyticDB 实例\",\n\t\t\"ja\": \"GPDB インスタンスマルチゾーン展開\",\n\t\t\"de\": \"GPDB-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Instancia GPDB\",\n\t\t\"fr\": \"Déploiement Multi-Zone d'Instance GPDB\",\n\t\t\"pt\": \"Implantações Multi-Zona de Instância GPDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"GPDB instances should be deployed with a standby zone for high availability.\",\n\t\t\"zh\": \"使用多可用区的云原生数据仓库 AnalyticDB 实例，视为合规。\",\n\t\t\"ja\": \"GPDB インスタンスは高可用性のためにスタンバイゾーンで展開する必要があります。\",\n\t\t\"de\": \"GPDB-Instanzen sollten mit einer Standby-Zone für Hochverfügbarkeit bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias GPDB deben desplegarse con una zona de espera para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances GPDB doivent être déployées avec une zone de secours pour une haute disponibilité.\",\n\t\t\"pt\": \"As instâncias GPDB devem ser implantadas com uma zona de espera para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The GPDB instance does not have a standby zone configured, which may affect availability.\",\n\t\t\"zh\": \"GPDB 实例未配置备用可用区，可能影响可用性。\",\n\t\t\"ja\": \"GPDB インスタンスにスタンバイゾーンが設定されておらず、可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Die GPDB-Instanz hat keine Standby-Zone konfiguriert, was die Verfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"La instancia GPDB no tiene una zona de espera configurada, lo que puede afectar la disponibilidad.\",\n\t\t\"fr\": \"L'instance GPDB n'a pas de zone de secours configurée, ce qui peut affecter la disponibilité.\",\n\t\t\"pt\": \"A instância GPDB não tem uma zona de espera configurada, o que pode afetar a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a standby zone by setting the StandbyZoneId property to enable multi-zone deployment.\",\n\t\t\"zh\": \"通过设置 StandbyZoneId 属性配置备用可用区，以启用多可用区部署。\",\n\t\t\"ja\": \"StandbyZoneId プロパティを設定してスタンバイゾーンを設定し、マルチゾーン展開を有効にします。\",\n\t\t\"de\": \"Konfigurieren Sie eine Standby-Zone, indem Sie die StandbyZoneId-Eigenschaft setzen, um Multi-Zone-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure una zona de espera estableciendo la propiedad StandbyZoneId para habilitar el despliegue multi-zona.\",\n\t\t\"fr\": \"Configurez une zone de secours en définissant la propriété StandbyZoneId pour activer le déploiement multi-zone.\",\n\t\t\"pt\": \"Configure uma zona de espera definindo a propriedade StandbyZoneId para habilitar a implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::GPDB::DBInstance\"]\n}\n\n# Check if instance has standby zone\nhas_standby_zone(resource) if {\n\thelpers.has_property(resource, \"StandbyZoneId\")\n\tstandby_zone := resource.Properties.StandbyZoneId\n\tstandby_zone != \"\"\n}\n\n# Deny rule: GPDB instances should have standby zone\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::GPDB::DBInstance\")\n\tnot has_standby_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"StandbyZoneId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:gwlb-loadbalancer-multi-zone", Name: models.I18nString{"de": "GWLB-LoadBalancer Multi-Zone-Bereitstellung", "en": "GWLB LoadBalancer Multi-Zone Deployment", "es": "Despliegue Multi-Zona del Balanceador de Carga GWLB", "fr": "Déploiement Multi-Zone du Répartiteur de Charge GWLB", "ja": "GWLB ロードバランサーのマルチゾーン展開", "pt": "Implantação Multi-Zona do Balanceador de Carga GWLB", "zh": "使用多可用区的网关型负载均衡实例"}, Severity: "medium", Description: models.I18nString{"de": "GWLB-LoadBalancer-Instanzen sollten für hohe Verfügbarkeit über mindestens zwei Verfügbarkeitszonen hinweg bereitgestellt werden.", "en": "GWLB LoadBalancer instances should be deployed across at least two availability zones for high availability.", "es": "Las instancias del Balanceador de Carga GWLB deben desplegarse en al menos dos zonas de disponibilidad para alta disponibilidad.", "fr": "Les instances du Répartiteur de Charge GWLB doivent être déployées sur au moins deux zones de disponibilité pour une haute disponibilité.", "ja": "GWLB ロードバランサーインスタンスは高可用性のために少なくとも 2 つの可用性ゾーンにまたがって展開する必要があります。", "pt": "As instâncias do Balanceador de Carga GWLB devem ser implantadas em pelo menos duas zonas de disponibilidade para alta disponibilidade.", "zh": "使用多可用区的网关型负载均衡实例，视为合规。"}, Reason: models.I18nString{"de": "Der GWLB-LoadBalancer wird in weniger als zwei Verfügbarkeitszonen bereitgestellt, was ein Single-Point-of-Failure-Risiko schafft.", "en": "The GWLB LoadBalancer is deployed in fewer than two availability zones, creating a single point of failure risk.", "es": "El Balanceador de Carga GWLB se despliega en menos de dos zonas de disponibilidad, creando un riesgo de punto único de falla.", "fr": "Le Répartiteur de Charge GWLB est déployé dans moins de deux zones de disponibilité, créant un risque de point de défaillance unique.", "ja": "GWLB ロードバランサーが 2 つ未満の可用性ゾーンに展開されており、単一障害点のリスクが生じています。", "pt": "O Balanceador de Carga GWLB está implantado em menos de duas zonas de disponibilidade, criando um risco de ponto único de falha.", "zh": "网关型负载均衡实例部署在少于两个可用区，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie mindestens zwei Zonen-Mappings in der ZoneMappings-Eigenschaft, um hohe Verfügbarkeit zu gewährleisten.", "en": "Configure at least two zone mappings in the ZoneMappings property to ensure high availability.", "es": "Configure al menos dos mapeos de zona en la propiedad ZoneMappings para garantizar alta disponibilidad.", "fr": "Configurez au moins deux mappages de zone dans la propriété ZoneMappings pour assurer une haute disponibilité.", "ja": "高可用性を確保するために、ZoneMappings プロパティで少なくとも 2 つのゾーンマッピングを設定します。", "pt": "Configure pelo menos dois mapeamentos de zona na propriedade ZoneMappings para garantir alta disponibilidade.", "zh": "在 ZoneMappings 属性中配置至少两个可用区映射，以确保高可用性。"}, ResourceTypes: []string{"ALIYUN::GWLB::LoadBalancer"}, FilePath: "aliyun/rules/gwlb-loadbalancer-multi-zone.rego", PackageName: "infraguard.rules.aliyun.gwlb_loadbalancer_multi_zone", Content: "package infraguard.rules.aliyun.gwlb_loadbalancer_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"gwlb-loadbalancer-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"GWLB LoadBalancer Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的网关型负载均衡实例\",\n\t\t\"ja\": \"GWLB ロードバランサーのマルチゾーン展開\",\n\t\t\"de\": \"GWLB-LoadBalancer Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona del Balanceador de Carga GWLB\",\n\t\t\"fr\": \"Déploiement Multi-Zone du Répartiteur de Charge GWLB\",\n\t\t\"pt\": \"Implantação Multi-Zona do Balanceador de Carga GWLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"GWLB LoadBalancer instances should be deployed across at least two availability zones for high availability.\",\n\t\t\"zh\": \"使用多可用区的网关型负载均衡实例，视为合规。\",\n\t\t\"ja\": \"GWLB ロードバランサーインスタンスは高可用性のために少なくとも 2 つの可用性ゾーンにまたがって展開する必要があります。\",\n\t\t\"de\": \"GWLB-LoadBalancer-Instanzen sollten für hohe Verfügbarkeit über mindestens zwei Verfügbarkeitszonen hinweg bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias del Balanceador de Carga GWLB deben desplegarse en al menos dos zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances du Répartiteur de Charge GWLB doivent être déployées sur au moins deux zones de disponibilité pour une haute disponibilité.\",\n\t\t\"pt\": \"As instâncias do Balanceador de Carga GWLB devem ser implantadas em pelo menos duas zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The GWLB LoadBalancer is deployed in fewer than two availability zones, creating a single point of failure risk.\",\n\t\t\"zh\": \"网关型负载均衡实例部署在少于两个可用区，存在单点故障风险。\",\n\t\t\"ja\": \"GWLB ロードバランサーが 2 つ未満の可用性ゾーンに展開されており、単一障害点のリスクが生じています。\",\n\t\t\"de\": \"Der GWLB-LoadBalancer wird in weniger als zwei Verfügbarkeitszonen bereitgestellt, was ein Single-Point-of-Failure-Risiko schafft.\",\n\t\t\"es\": \"El Balanceador de Carga GWLB se despliega en menos de dos zonas de disponibilidad, creando un riesgo de punto único de falla.\",\n\t\t\"fr\": \"Le Répartiteur de Charge GWLB est déployé dans moins de deux zones de disponibilité, créant un risque de point de défaillance unique.\",\n\t\t\"pt\": \"O Balanceador de Carga GWLB está implantado em menos de duas zonas de disponibilidade, criando um risco de ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure at least two zone mappings in the ZoneMappings property to ensure high availability.\",\n\t\t\"zh\": \"在 ZoneMappings 属性中配置至少两个可用区映射，以确保高可用性。\",\n\t\t\"ja\": \"高可用性を確保するために、ZoneMappings プロパティで少なくとも 2 つのゾーンマッピングを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie mindestens zwei Zonen-Mappings in der ZoneMappings-Eigenschaft, um hohe Verfügbarkeit zu gewährleisten.\",\n\t\t\"es\": \"Configure al menos dos mapeos de zona en la propiedad ZoneMappings para garantizar alta disponibilidad.\",\n\t\t\"fr\": \"Configurez au moins deux mappages de zone dans la propriété ZoneMappings pour assurer une haute disponibilité.\",\n\t\t\"pt\": \"Configure pelo menos dois mapeamentos de zona na propriedade ZoneMappings para garantir alta disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::GWLB::LoadBalancer\"]\n}\n\n# Check if LoadBalancer has multiple zones\nhas_multiple_zones(resource) if {\n\tzone_mappings := resource.Properties.ZoneMappings\n\tcount(zone_mappings) >= 2\n}\n\n# Deny rule: GWLB LoadBalancers must be deployed in multiple zones\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::GWLB::LoadBalancer\")\n\tnot has_multiple_zones(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ZoneMappings\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:hbase-cluster-deletion-protection", Name: models.I18nString{"de": "HBase-Cluster Löschschutz aktiviert", "en": "HBase Cluster Deletion Protection Enabled", "es": "Protección de Eliminación de Clúster HBase Habilitada", "fr": "Protection contre la Suppression de Cluster HBase Activée", "ja": "HBase クラスタ削除保護が有効", "pt": "Proteção contra Exclusão de Cluster HBase Habilitada", "zh": "HBase 集群开启删除保护"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass HBase-Cluster Löschschutz aktiviert haben.", "en": "Ensures that HBase clusters have deletion protection enabled.", "es": "Garantiza que los clústeres HBase tengan protección contra eliminación habilitada.", "fr": "Garantit que les clusters HBase ont la protection contre la suppression activée.", "ja": "HBase クラスタで削除保護が有効になっていることを確認します。", "pt": "Garante que os clusters HBase tenham proteção contra exclusão habilitada.", "zh": "确保 HBase 集群开启了删除保护。"}, Reason: models.I18nString{"de": "Wenn der Löschschutz nicht aktiviert ist, kann der HBase-Cluster versehentlich freigegeben werden, was zu Datenverlust führt.", "en": "If deletion protection is not enabled, the HBase cluster may be released accidentally, causing data loss.", "es": "Si la protección contra eliminación no está habilitada, el clúster HBase puede ser liberado accidentalmente, causando pérdida de datos.", "fr": "Si la protection contre la suppression n'est pas activée, le cluster HBase peut être libéré accidentellement, entraînant une perte de données.", "ja": "削除保護が有効になっていない場合、HBase クラスタが誤って解放され、データ損失が発生する可能性があります。", "pt": "Se a proteção contra exclusão não estiver habilitada, o cluster HBase pode ser liberado acidentalmente, causando perda de dados.", "zh": "如果未开启删除保护，HBase 集群可能会被意外释放，导致数据丢失。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für den HBase-Cluster.", "en": "Enable deletion protection for the HBase cluster.", "es": "Habilite la protección contra eliminación para el clúster HBase.", "fr": "Activez la protection contre la suppression pour le cluster HBase.", "ja": "HBase クラスタの削除保護を有効にします。", "pt": "Habilite a proteção contra exclusão para o cluster HBase.", "zh": "为 HBase 集群开启删除保护功能。"}, ResourceTypes: []string{"ALIYUN::HBase::Cluster"}, FilePath: "aliyun/rules/hbase-cluster-deletion-protection.rego", PackageName: "infraguard.rules.aliyun.hbase_cluster_deletion_protection", Content: "package infraguard.rules.aliyun.hbase_cluster_deletion_protection\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"hbase-cluster-deletion-protection\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"HBase Cluster Deletion Protection Enabled\",\n\t\t\"zh\": \"HBase 集群开启删除保护\",\n\t\t\"ja\": \"HBase クラスタ削除保護が有効\",\n\t\t\"de\": \"HBase-Cluster Löschschutz aktiviert\",\n\t\t\"es\": \"Protección de Eliminación de Clúster HBase Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression de Cluster HBase Activée\",\n\t\t\"pt\": \"Proteção contra Exclusão de Cluster HBase Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that HBase clusters have deletion protection enabled.\",\n\t\t\"zh\": \"确保 HBase 集群开启了删除保护。\",\n\t\t\"ja\": \"HBase クラスタで削除保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass HBase-Cluster Löschschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los clústeres HBase tengan protección contra eliminación habilitada.\",\n\t\t\"fr\": \"Garantit que les clusters HBase ont la protection contre la suppression activée.\",\n\t\t\"pt\": \"Garante que os clusters HBase tenham proteção contra exclusão habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If deletion protection is not enabled, the HBase cluster may be released accidentally, causing data loss.\",\n\t\t\"zh\": \"如果未开启删除保护，HBase 集群可能会被意外释放，导致数据丢失。\",\n\t\t\"ja\": \"削除保護が有効になっていない場合、HBase クラスタが誤って解放され、データ損失が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Löschschutz nicht aktiviert ist, kann der HBase-Cluster versehentlich freigegeben werden, was zu Datenverlust führt.\",\n\t\t\"es\": \"Si la protección contra eliminación no está habilitada, el clúster HBase puede ser liberado accidentalmente, causando pérdida de datos.\",\n\t\t\"fr\": \"Si la protection contre la suppression n'est pas activée, le cluster HBase peut être libéré accidentellement, entraînant une perte de données.\",\n\t\t\"pt\": \"Se a proteção contra exclusão não estiver habilitada, o cluster HBase pode ser liberado acidentalmente, causando perda de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for the HBase cluster.\",\n\t\t\"zh\": \"为 HBase 集群开启删除保护功能。\",\n\t\t\"ja\": \"HBase クラスタの削除保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für den HBase-Cluster.\",\n\t\t\"es\": \"Habilite la protección contra eliminación para el clúster HBase.\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour le cluster HBase.\",\n\t\t\"pt\": \"Habilite a proteção contra exclusão para o cluster HBase.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::HBase::Cluster\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::HBase::Cluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:hbase-cluster-expired-check", Name: models.I18nString{"de": "HBase-Cluster-Ablaufprüfung", "en": "HBase Cluster Expiration Check", "es": "Verificación de Expiración de Clúster HBase", "fr": "Vérification d'Expiration du Cluster HBase", "ja": "HBase クラスターの有効期限チェック", "pt": "Verificação de Expiração do Cluster HBase", "zh": "HBase 集群到期检查"}, Severity: "high", Description: models.I18nString{"de": "Vorausbezahlte HBase-Cluster sollten automatische Verlängerung aktiviert haben.", "en": "Prepaid HBase clusters should have auto-renewal enabled.", "es": "Los clústeres HBase prepagados deben tener renovación automática habilitada.", "fr": "Les clusters HBase prépayés doivent avoir le renouvellement automatique activé.", "ja": "プリペイド HBase クラスターで自動更新が有効になっている必要があります。", "pt": "Os clusters HBase pré-pagos devem ter renovação automática habilitada.", "zh": "预付费 HBase 集群应开启自动续费，避免业务中断。"}, Reason: models.I18nString{"de": "Der vorausbezahlte HBase-Cluster hat keine automatische Verlängerung aktiviert.", "en": "The prepaid HBase cluster does not have auto-renewal enabled.", "es": "El clúster HBase prepagado no tiene renovación automática habilitada.", "fr": "Le cluster HBase prépayé n'a pas le renouvellement automatique activé.", "ja": "プリペイド HBase クラスターで自動更新が有効になっていません。", "pt": "O cluster HBase pré-pago não tem renovação automática habilitada.", "zh": "预付费 HBase 集群未开启自动续费。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Verlängerung für den vorausbezahlten HBase-Cluster, indem Sie AutoRenewPeriod auf einen Wert größer als 0 setzen.", "en": "Enable auto-renewal for the prepaid HBase cluster by setting AutoRenewPeriod to a value greater than 0.", "es": "Habilite la renovación automática para el clúster HBase prepagado estableciendo AutoRenewPeriod en un valor mayor que 0.", "fr": "Activez le renouvellement automatique pour le cluster HBase prépayé en définissant AutoRenewPeriod sur une valeur supérieure à 0.", "ja": "AutoRenewPeriod を 0 より大きい値に設定して、プリペイド HBase クラスターの自動更新を有効にします。", "pt": "Habilite a renovação automática para o cluster HBase pré-pago definindo AutoRenewPeriod como um valor maior que 0.", "zh": "通过将 AutoRenewPeriod 设置为大于 0 的值来开启自动续费。"}, ResourceTypes: []string{"ALIYUN::HBase::Cluster"}, FilePath: "aliyun/rules/hbase-cluster-expired-check.rego", PackageName: "infraguard.rules.aliyun.hbase_cluster_expired_check", Content: "package infraguard.rules.aliyun.hbase_cluster_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"hbase-cluster-expired-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"HBase Cluster Expiration Check\",\n\t\t\"zh\": \"HBase 集群到期检查\",\n\t\t\"ja\": \"HBase クラスターの有効期限チェック\",\n\t\t\"de\": \"HBase-Cluster-Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Clúster HBase\",\n\t\t\"fr\": \"Vérification d'Expiration du Cluster HBase\",\n\t\t\"pt\": \"Verificação de Expiração do Cluster HBase\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Prepaid HBase clusters should have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 HBase 集群应开启自动续费，避免业务中断。\",\n\t\t\"ja\": \"プリペイド HBase クラスターで自動更新が有効になっている必要があります。\",\n\t\t\"de\": \"Vorausbezahlte HBase-Cluster sollten automatische Verlängerung aktiviert haben.\",\n\t\t\"es\": \"Los clústeres HBase prepagados deben tener renovación automática habilitada.\",\n\t\t\"fr\": \"Les clusters HBase prépayés doivent avoir le renouvellement automatique activé.\",\n\t\t\"pt\": \"Os clusters HBase pré-pagos devem ter renovação automática habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The prepaid HBase cluster does not have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 HBase 集群未开启自动续费。\",\n\t\t\"ja\": \"プリペイド HBase クラスターで自動更新が有効になっていません。\",\n\t\t\"de\": \"Der vorausbezahlte HBase-Cluster hat keine automatische Verlängerung aktiviert.\",\n\t\t\"es\": \"El clúster HBase prepagado no tiene renovación automática habilitada.\",\n\t\t\"fr\": \"Le cluster HBase prépayé n'a pas le renouvellement automatique activé.\",\n\t\t\"pt\": \"O cluster HBase pré-pago não tem renovação automática habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for the prepaid HBase cluster by setting AutoRenewPeriod to a value greater than 0.\",\n\t\t\"zh\": \"通过将 AutoRenewPeriod 设置为大于 0 的值来开启自动续费。\",\n\t\t\"ja\": \"AutoRenewPeriod を 0 より大きい値に設定して、プリペイド HBase クラスターの自動更新を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die automatische Verlängerung für den vorausbezahlten HBase-Cluster, indem Sie AutoRenewPeriod auf einen Wert größer als 0 setzen.\",\n\t\t\"es\": \"Habilite la renovación automática para el clúster HBase prepagado estableciendo AutoRenewPeriod en un valor mayor que 0.\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour le cluster HBase prépayé en définissant AutoRenewPeriod sur une valeur supérieure à 0.\",\n\t\t\"pt\": \"Habilite a renovação automática para o cluster HBase pré-pago definindo AutoRenewPeriod como um valor maior que 0.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::HBase::Cluster\"]\n}\n\nis_prepaid(resource) if {\n\thelpers.get_property(resource, \"PayType\", \"Postpaid\") == \"Prepaid\"\n}\n\nis_auto_renew_enabled(resource) if {\n\tperiod := helpers.get_property(resource, \"AutoRenewPeriod\", 0)\n\tperiod > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tis_prepaid(resource)\n\tnot is_auto_renew_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AutoRenewPeriod\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:hbase-cluster-ha-check", Name: models.I18nString{"de": "HBase-Cluster HA aktiviert", "en": "HBase Cluster HA Enabled", "es": "HA de Clúster HBase Habilitado", "fr": "HA du Cluster HBase Activé", "ja": "HBase クラスターの HA が有効", "pt": "HA do Cluster HBase Habilitado", "zh": "HBase 集群强制开启高可用"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass HBase-Cluster für hohe Verfügbarkeit (HA) konfiguriert sind.", "en": "Ensures HBase clusters are configured for High Availability (HA).", "es": "Garantiza que los clústeres HBase estén configurados para Alta Disponibilidad (HA).", "fr": "Garantit que les clusters HBase sont configurés pour la Haute Disponibilité (HA).", "ja": "HBase クラスターが高可用性（HA）用に設定されていることを確認します。", "pt": "Garante que os clusters HBase estejam configurados para Alta Disponibilidade (HA).", "zh": "确保 HBase 集群配置为高可用（HA）模式。"}, Reason: models.I18nString{"de": "Nicht-HA-Cluster sind Single Points of Failure und können zu Serviceausfällen führen.", "en": "Non-HA clusters are single points of failure and may lead to service downtime.", "es": "Los clústeres no HA son puntos únicos de falla y pueden provocar tiempo de inactividad del servicio.", "fr": "Les clusters non-HA sont des points de défaillance unique et peuvent entraîner des temps d'arrêt du service.", "ja": "非 HA クラスターは単一障害点であり、サービスダウンタイムにつながる可能性があります。", "pt": "Clusters não-HA são pontos únicos de falha e podem levar a tempo de inatividade do serviço.", "zh": "非高可用集群存在单点故障风险，可能导致服务中断。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass NodeCount für HA ausreicht (mindestens 2 für disk-basiert, 3 für lokale Festplatten).", "en": "Ensure NodeCount is sufficient for HA (at least 2 for disk-based, 3 for local disks).", "es": "Asegúrese de que NodeCount sea suficiente para HA (al menos 2 para basado en disco, 3 para discos locales).", "fr": "Assurez-vous que NodeCount est suffisant pour HA (au moins 2 pour basé sur disque, 3 pour disques locaux).", "ja": "HA に十分な NodeCount を確保します（ディスクベースの場合は少なくとも 2、ローカルディスクの場合は少なくとも 3）。", "pt": "Garanta que NodeCount seja suficiente para HA (pelo menos 2 para baseado em disco, 3 para discos locais).", "zh": "确保节点数量满足高可用要求（磁盘型至少 2 个，本地盘型至少 3 个）。"}, ResourceTypes: []string{"ALIYUN::HBase::Cluster"}, FilePath: "aliyun/rules/hbase-cluster-ha-check.rego", PackageName: "infraguard.rules.aliyun.hbase_cluster_ha_check", Content: "package infraguard.rules.aliyun.hbase_cluster_ha_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"hbase-cluster-ha-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"HBase Cluster HA Enabled\",\n\t\t\"zh\": \"HBase 集群强制开启高可用\",\n\t\t\"ja\": \"HBase クラスターの HA が有効\",\n\t\t\"de\": \"HBase-Cluster HA aktiviert\",\n\t\t\"es\": \"HA de Clúster HBase Habilitado\",\n\t\t\"fr\": \"HA du Cluster HBase Activé\",\n\t\t\"pt\": \"HA do Cluster HBase Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures HBase clusters are configured for High Availability (HA).\",\n\t\t\"zh\": \"确保 HBase 集群配置为高可用（HA）模式。\",\n\t\t\"ja\": \"HBase クラスターが高可用性（HA）用に設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass HBase-Cluster für hohe Verfügbarkeit (HA) konfiguriert sind.\",\n\t\t\"es\": \"Garantiza que los clústeres HBase estén configurados para Alta Disponibilidad (HA).\",\n\t\t\"fr\": \"Garantit que les clusters HBase sont configurés pour la Haute Disponibilité (HA).\",\n\t\t\"pt\": \"Garante que os clusters HBase estejam configurados para Alta Disponibilidade (HA).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Non-HA clusters are single points of failure and may lead to service downtime.\",\n\t\t\"zh\": \"非高可用集群存在单点故障风险，可能导致服务中断。\",\n\t\t\"ja\": \"非 HA クラスターは単一障害点であり、サービスダウンタイムにつながる可能性があります。\",\n\t\t\"de\": \"Nicht-HA-Cluster sind Single Points of Failure und können zu Serviceausfällen führen.\",\n\t\t\"es\": \"Los clústeres no HA son puntos únicos de falla y pueden provocar tiempo de inactividad del servicio.\",\n\t\t\"fr\": \"Les clusters non-HA sont des points de défaillance unique et peuvent entraîner des temps d'arrêt du service.\",\n\t\t\"pt\": \"Clusters não-HA são pontos únicos de falha e podem levar a tempo de inatividade do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure NodeCount is sufficient for HA (at least 2 for disk-based, 3 for local disks).\",\n\t\t\"zh\": \"确保节点数量满足高可用要求（磁盘型至少 2 个，本地盘型至少 3 个）。\",\n\t\t\"ja\": \"HA に十分な NodeCount を確保します（ディスクベースの場合は少なくとも 2、ローカルディスクの場合は少なくとも 3）。\",\n\t\t\"de\": \"Stellen Sie sicher, dass NodeCount für HA ausreicht (mindestens 2 für disk-basiert, 3 für lokale Festplatten).\",\n\t\t\"es\": \"Asegúrese de que NodeCount sea suficiente para HA (al menos 2 para basado en disco, 3 para discos locales).\",\n\t\t\"fr\": \"Assurez-vous que NodeCount est suffisant pour HA (au moins 2 pour basé sur disque, 3 pour disques locaux).\",\n\t\t\"pt\": \"Garanta que NodeCount seja suficiente para HA (pelo menos 2 para baseado em disco, 3 para discos locais).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::HBase::Cluster\"]\n}\n\nis_compliant(resource) if {\n\tcount := helpers.get_property(resource, \"NodeCount\", 1)\n\tcount >= 2\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::HBase::Cluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"NodeCount\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:hbase-cluster-in-vpc", Name: models.I18nString{"de": "HBase-Cluster im VPC", "en": "HBase Cluster in VPC", "es": "Clúster HBase en VPC", "fr": "Cluster HBase dans VPC", "ja": "VPC 内の HBase クラスタ", "pt": "Cluster HBase em VPC", "zh": "HBase 集群在 VPC 内"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der HBase-Cluster innerhalb eines VPC bereitgestellt wird.", "en": "Ensures that the HBase cluster is deployed within a VPC.", "es": "Garantiza que el clúster HBase esté desplegado dentro de un VPC.", "fr": "Garantit que le cluster HBase est déployé dans un VPC.", "ja": "HBase クラスタが VPC 内に展開されていることを確認します。", "pt": "Garante que o cluster HBase esteja implantado dentro de um VPC.", "zh": "确保 HBase 集群部署在 VPC 内。"}, Reason: models.I18nString{"de": "Die Bereitstellung von HBase in einem VPC bietet bessere Netzwerkisolation und Sicherheit.", "en": "Deploying HBase in a VPC provides better network isolation and security.", "es": "Desplegar HBase en un VPC proporciona mejor aislamiento de red y seguridad.", "fr": "Déployer HBase dans un VPC offre une meilleure isolation réseau et sécurité.", "ja": "VPC に HBase を展開すると、より優れたネットワーク分離とセキュリティが提供されます。", "pt": "Implantar HBase em um VPC fornece melhor isolamento de rede e segurança.", "zh": "在 VPC 中部署 HBase 可提供更好的网络隔离和安全性。"}, Recommendation: models.I18nString{"de": "Stellen Sie den HBase-Cluster innerhalb eines VPC bereit.", "en": "Deploy the HBase cluster within a VPC.", "es": "Despliegue el clúster HBase dentro de un VPC.", "fr": "Déployez le cluster HBase dans un VPC.", "ja": "HBase クラスタを VPC 内に展開します。", "pt": "Implante o cluster HBase dentro de um VPC.", "zh": "将 HBase 集群部署在 VPC 内。"}, ResourceTypes: []string{"ALIYUN::HBase::Cluster"}, FilePath: "aliyun/rules/hbase-cluster-in-vpc.rego", PackageName: "infraguard.rules.aliyun.hbase_cluster_in_vpc", Content: "package infraguard.rules.aliyun.hbase_cluster_in_vpc\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"hbase-cluster-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"HBase Cluster in VPC\",\n\t\t\"zh\": \"HBase 集群在 VPC 内\",\n\t\t\"ja\": \"VPC 内の HBase クラスタ\",\n\t\t\"de\": \"HBase-Cluster im VPC\",\n\t\t\"es\": \"Clúster HBase en VPC\",\n\t\t\"fr\": \"Cluster HBase dans VPC\",\n\t\t\"pt\": \"Cluster HBase em VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the HBase cluster is deployed within a VPC.\",\n\t\t\"zh\": \"确保 HBase 集群部署在 VPC 内。\",\n\t\t\"ja\": \"HBase クラスタが VPC 内に展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der HBase-Cluster innerhalb eines VPC bereitgestellt wird.\",\n\t\t\"es\": \"Garantiza que el clúster HBase esté desplegado dentro de un VPC.\",\n\t\t\"fr\": \"Garantit que le cluster HBase est déployé dans un VPC.\",\n\t\t\"pt\": \"Garante que o cluster HBase esteja implantado dentro de um VPC.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Deploying HBase in a VPC provides better network isolation and security.\",\n\t\t\"zh\": \"在 VPC 中部署 HBase 可提供更好的网络隔离和安全性。\",\n\t\t\"ja\": \"VPC に HBase を展開すると、より優れたネットワーク分離とセキュリティが提供されます。\",\n\t\t\"de\": \"Die Bereitstellung von HBase in einem VPC bietet bessere Netzwerkisolation und Sicherheit.\",\n\t\t\"es\": \"Desplegar HBase en un VPC proporciona mejor aislamiento de red y seguridad.\",\n\t\t\"fr\": \"Déployer HBase dans un VPC offre une meilleure isolation réseau et sécurité.\",\n\t\t\"pt\": \"Implantar HBase em um VPC fornece melhor isolamento de rede e segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy the HBase cluster within a VPC.\",\n\t\t\"zh\": \"将 HBase 集群部署在 VPC 内。\",\n\t\t\"ja\": \"HBase クラスタを VPC 内に展開します。\",\n\t\t\"de\": \"Stellen Sie den HBase-Cluster innerhalb eines VPC bereit.\",\n\t\t\"es\": \"Despliegue el clúster HBase dentro de un VPC.\",\n\t\t\"fr\": \"Déployez le cluster HBase dans un VPC.\",\n\t\t\"pt\": \"Implante o cluster HBase dentro de um VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::HBase::Cluster\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::HBase::Cluster\")\n\tnot helpers.has_property(resource, \"VpcId\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:hbase-cluster-multi-zone", Name: models.I18nString{"de": "HBase-Cluster Multi-Zonen-Bereitstellung", "en": "HBase Cluster Multi-Zone Deployment", "es": "Implementación Multi-Zona del Clúster HBase", "fr": "Déploiement Multi-Zone du Cluster HBase", "ja": "HBase クラスターマルチゾーン展開", "pt": "Implantação Multi-Zona do Cluster HBase", "zh": "使用多可用区的 HBase 集群"}, Severity: "medium", Description: models.I18nString{"de": "HBase-Cluster sollten im Clustermodus mit mindestens 2 Knoten für Hochverfügbarkeit bereitgestellt werden.", "en": "HBase clusters should be deployed in cluster mode with at least 2 nodes for high availability.", "es": "Los clústeres HBase deben implementarse en modo clúster con al menos 2 nodos para alta disponibilidad.", "fr": "Les clusters HBase doivent être déployés en mode cluster avec au moins 2 nœuds pour une haute disponibilité.", "ja": "HBase クラスターは高可用性のために少なくとも 2 つのノードでクラスターモードに展開する必要があります。", "pt": "Os clusters HBase devem ser implantados em modo cluster com pelo menos 2 nós para alta disponibilidade.", "zh": "使用多可用区的 HBase 集群，视为合规。"}, Reason: models.I18nString{"de": "Der HBase-Cluster wird im Einzelknotenmodus bereitgestellt, was keine Hochverfügbarkeit bietet.", "en": "The HBase cluster is deployed in single-node mode, which does not provide high availability.", "es": "El clúster HBase se implementa en modo de nodo único, que no proporciona alta disponibilidad.", "fr": "Le cluster HBase est déployé en mode nœud unique, ce qui ne fournit pas de haute disponibilité.", "ja": "HBase クラスターがシングルノードモードで展開されているため、高可用性が提供されません。", "pt": "O cluster HBase é implantado em modo de nó único, que não fornece alta disponibilidade.", "zh": "HBase 集群部署在单节点模式，不提供高可用性。"}, Recommendation: models.I18nString{"de": "Stellen Sie den HBase-Cluster im Clustermodus bereit, indem Sie NodeCount auf mindestens 2 für Hochverfügbarkeit setzen.", "en": "Deploy HBase cluster in cluster mode by setting NodeCount to at least 2 for high availability.", "es": "Implemente el clúster HBase en modo clúster estableciendo NodeCount en al menos 2 para alta disponibilidad.", "fr": "Déployez le cluster HBase en mode cluster en définissant NodeCount sur au moins 2 pour une haute disponibilité.", "ja": "高可用性のために NodeCount を少なくとも 2 に設定して、HBase クラスターをクラスターモードで展開します。", "pt": "Implante o cluster HBase em modo cluster definindo NodeCount para pelo menos 2 para alta disponibilidade.", "zh": "通过将 NodeCount 设置为至少 2 来部署 HBase 集群的集群模式，以实现高可用性。"}, ResourceTypes: []string{"ALIYUN::HBase::Cluster"}, FilePath: "aliyun/rules/hbase-cluster-multi-zone.rego", PackageName: "infraguard.rules.aliyun.hbase_cluster_multi_zone", Content: "package infraguard.rules.aliyun.hbase_cluster_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"hbase-cluster-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"HBase Cluster Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的 HBase 集群\",\n\t\t\"ja\": \"HBase クラスターマルチゾーン展開\",\n\t\t\"de\": \"HBase-Cluster Multi-Zonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona del Clúster HBase\",\n\t\t\"fr\": \"Déploiement Multi-Zone du Cluster HBase\",\n\t\t\"pt\": \"Implantação Multi-Zona do Cluster HBase\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"HBase clusters should be deployed in cluster mode with at least 2 nodes for high availability.\",\n\t\t\"zh\": \"使用多可用区的 HBase 集群，视为合规。\",\n\t\t\"ja\": \"HBase クラスターは高可用性のために少なくとも 2 つのノードでクラスターモードに展開する必要があります。\",\n\t\t\"de\": \"HBase-Cluster sollten im Clustermodus mit mindestens 2 Knoten für Hochverfügbarkeit bereitgestellt werden.\",\n\t\t\"es\": \"Los clústeres HBase deben implementarse en modo clúster con al menos 2 nodos para alta disponibilidad.\",\n\t\t\"fr\": \"Les clusters HBase doivent être déployés en mode cluster avec au moins 2 nœuds pour une haute disponibilité.\",\n\t\t\"pt\": \"Os clusters HBase devem ser implantados em modo cluster com pelo menos 2 nós para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The HBase cluster is deployed in single-node mode, which does not provide high availability.\",\n\t\t\"zh\": \"HBase 集群部署在单节点模式，不提供高可用性。\",\n\t\t\"ja\": \"HBase クラスターがシングルノードモードで展開されているため、高可用性が提供されません。\",\n\t\t\"de\": \"Der HBase-Cluster wird im Einzelknotenmodus bereitgestellt, was keine Hochverfügbarkeit bietet.\",\n\t\t\"es\": \"El clúster HBase se implementa en modo de nodo único, que no proporciona alta disponibilidad.\",\n\t\t\"fr\": \"Le cluster HBase est déployé en mode nœud unique, ce qui ne fournit pas de haute disponibilité.\",\n\t\t\"pt\": \"O cluster HBase é implantado em modo de nó único, que não fornece alta disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy HBase cluster in cluster mode by setting NodeCount to at least 2 for high availability.\",\n\t\t\"zh\": \"通过将 NodeCount 设置为至少 2 来部署 HBase 集群的集群模式，以实现高可用性。\",\n\t\t\"ja\": \"高可用性のために NodeCount を少なくとも 2 に設定して、HBase クラスターをクラスターモードで展開します。\",\n\t\t\"de\": \"Stellen Sie den HBase-Cluster im Clustermodus bereit, indem Sie NodeCount auf mindestens 2 für Hochverfügbarkeit setzen.\",\n\t\t\"es\": \"Implemente el clúster HBase en modo clúster estableciendo NodeCount en al menos 2 para alta disponibilidad.\",\n\t\t\"fr\": \"Déployez le cluster HBase en mode cluster en définissant NodeCount sur au moins 2 pour une haute disponibilité.\",\n\t\t\"pt\": \"Implante o cluster HBase em modo cluster definindo NodeCount para pelo menos 2 para alta disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::HBase::Cluster\"]\n}\n\n# Check if cluster is in cluster mode (at least 2 nodes)\nis_cluster_mode(resource) if {\n\tnode_count := resource.Properties.NodeCount\n\tnode_count >= 2\n}\n\n# Deny rule: HBase clusters should be in cluster mode\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::HBase::Cluster\")\n\tnot is_cluster_mode(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"NodeCount\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:hbase-cluster-type-check", Name: models.I18nString{"de": "HBase-Cluster-Typ-Prüfung", "en": "HBase Cluster Type Check", "es": "Verificación de Tipo de Clúster HBase", "fr": "Vérification du Type de Cluster HBase", "ja": "HBase クラスタータイプチェック", "pt": "Verificação de Tipo de Cluster HBase", "zh": "HBase 集群实例类型检测"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass der HBase-Cluster vom angegebenen oder empfohlenen Typ ist.", "en": "Ensures that the HBase cluster is of a specified or recommended type.", "es": "Garantiza que el clúster HBase sea de un tipo especificado o recomendado.", "fr": "Garantit que le cluster HBase est d'un type spécifié ou recommandé.", "ja": "HBase クラスターが指定されたまたは推奨されるタイプであることを確認します。", "pt": "Garante que o cluster HBase seja de um tipo especificado ou recomendado.", "zh": "确保 HBase 集群是指定的或推荐的类型。"}, Reason: models.I18nString{"de": "Die Verwendung des richtigen Cluster-Typs gewährleistet optimale Leistung und Unterstützung für Ihre Arbeitslast.", "en": "Using the correct cluster type ensures optimal performance and support for your workload.", "es": "Usar el tipo de clúster correcto garantiza un rendimiento óptimo y soporte para su carga de trabajo.", "fr": "L'utilisation du bon type de cluster garantit des performances optimales et un support pour votre charge de travail.", "ja": "正しいクラスタータイプを使用することで、ワークロードに最適なパフォーマンスとサポートが確保されます。", "pt": "Usar o tipo de cluster correto garante desempenho ideal e suporte para sua carga de trabalho.", "zh": "使用正确的集群类型可确保您的工作负载获得最佳性能和支持。"}, Recommendation: models.I18nString{"de": "Wählen Sie einen empfohlenen HBase-Cluster-Typ.", "en": "Select a recommended HBase cluster type.", "es": "Seleccione un tipo de clúster HBase recomendado.", "fr": "Sélectionnez un type de cluster HBase recommandé.", "ja": "推奨される HBase クラスタータイプを選択します。", "pt": "Selecione um tipo de cluster HBase recomendado.", "zh": "选择推荐的 HBase 集群类型。"}, ResourceTypes: []string{"ALIYUN::HBase::Cluster"}, FilePath: "aliyun/rules/hbase-cluster-type-check.rego", PackageName: "infraguard.rules.aliyun.hbase_cluster_type_check", Content: "package infraguard.rules.aliyun.hbase_cluster_type_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"hbase-cluster-type-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"HBase Cluster Type Check\",\n\t\t\"zh\": \"HBase 集群实例类型检测\",\n\t\t\"ja\": \"HBase クラスタータイプチェック\",\n\t\t\"de\": \"HBase-Cluster-Typ-Prüfung\",\n\t\t\"es\": \"Verificación de Tipo de Clúster HBase\",\n\t\t\"fr\": \"Vérification du Type de Cluster HBase\",\n\t\t\"pt\": \"Verificação de Tipo de Cluster HBase\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the HBase cluster is of a specified or recommended type.\",\n\t\t\"zh\": \"确保 HBase 集群是指定的或推荐的类型。\",\n\t\t\"ja\": \"HBase クラスターが指定されたまたは推奨されるタイプであることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der HBase-Cluster vom angegebenen oder empfohlenen Typ ist.\",\n\t\t\"es\": \"Garantiza que el clúster HBase sea de un tipo especificado o recomendado.\",\n\t\t\"fr\": \"Garantit que le cluster HBase est d'un type spécifié ou recommandé.\",\n\t\t\"pt\": \"Garante que o cluster HBase seja de um tipo especificado ou recomendado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using the correct cluster type ensures optimal performance and support for your workload.\",\n\t\t\"zh\": \"使用正确的集群类型可确保您的工作负载获得最佳性能和支持。\",\n\t\t\"ja\": \"正しいクラスタータイプを使用することで、ワークロードに最適なパフォーマンスとサポートが確保されます。\",\n\t\t\"de\": \"Die Verwendung des richtigen Cluster-Typs gewährleistet optimale Leistung und Unterstützung für Ihre Arbeitslast.\",\n\t\t\"es\": \"Usar el tipo de clúster correcto garantiza un rendimiento óptimo y soporte para su carga de trabajo.\",\n\t\t\"fr\": \"L'utilisation du bon type de cluster garantit des performances optimales et un support pour votre charge de travail.\",\n\t\t\"pt\": \"Usar o tipo de cluster correto garante desempenho ideal e suporte para sua carga de trabalho.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Select a recommended HBase cluster type.\",\n\t\t\"zh\": \"选择推荐的 HBase 集群类型。\",\n\t\t\"ja\": \"推奨される HBase クラスタータイプを選択します。\",\n\t\t\"de\": \"Wählen Sie einen empfohlenen HBase-Cluster-Typ.\",\n\t\t\"es\": \"Seleccione un tipo de clúster HBase recomendado.\",\n\t\t\"fr\": \"Sélectionnez un type de cluster HBase recommandé.\",\n\t\t\"pt\": \"Selecione um tipo de cluster HBase recomendado.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::HBase::Cluster\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::HBase::Cluster\")\n\thelpers.get_property(resource, \"ClusterType\", \"\") == \"deprecated\"\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ClusterType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:internet-nat-gateway-in-specified-vpc", Name: models.I18nString{"de": "Internet-NAT-Gateway im angegebenen VPC", "en": "Internet NAT Gateway in Specified VPC", "es": "Puerta de Enlace NAT de Internet en VPC Especificado", "fr": "Passerelle NAT Internet dans VPC Spécifié", "ja": "指定された VPC 内のインターネット NAT ゲートウェイ", "pt": "Gateway NAT da Internet em VPC Especificado", "zh": "公网 NAT 网关创建在指定专有网络内"}, Severity: "medium", Description: models.I18nString{"de": "Internetorientierte NAT-Gateways sollten gemäß Netzwerksicherheitsanforderungen in angegebenen VPCs erstellt werden.", "en": "Internet-facing NAT gateways should be created in specified VPCs according to network security requirements.", "es": "Las puertas de enlace NAT orientadas a Internet deben crearse en VPCs especificados según los requisitos de seguridad de red.", "fr": "Les passerelles NAT orientées Internet doivent être créées dans des VPC spécifiés selon les exigences de sécurité réseau.", "ja": "インターネット向け NAT ゲートウェイは、ネットワークセキュリティ要件に従って指定された VPC 内に作成する必要があります。", "pt": "Gateways NAT voltados para a Internet devem ser criados em VPCs especificados de acordo com os requisitos de segurança de rede.", "zh": "公网 NAT 网关所属专有网络在参数指定的专有网络列表中，视为合规。"}, Reason: models.I18nString{"de": "Internetorientierte NAT-Gateways in nicht angegebenen VPCs können gegen Netzwerksegmentierung und Sicherheitsrichtlinien verstoßen.", "en": "Internet-facing NAT gateways in non-specified VPCs may violate network segmentation and security policies.", "es": "Las puertas de enlace NAT orientadas a Internet en VPCs no especificados pueden violar la segmentación de red y las políticas de seguridad.", "fr": "Les passerelles NAT orientées Internet dans des VPC non spécifiés peuvent violer la segmentation réseau et les politiques de sécurité.", "ja": "指定されていない VPC 内のインターネット向け NAT ゲートウェイは、ネットワークセグメンテーションとセキュリティポリシーに違反する可能性があります。", "pt": "Gateways NAT voltados para a Internet em VPCs não especificados podem violar a segmentação de rede e as políticas de segurança.", "zh": "不在指定 VPC 中的公网 NAT 网关可能违反网络分段和安全策略。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass internetorientierte NAT-Gateways nur in den angegebenen VPCs bereitgestellt werden.", "en": "Ensure internet-facing NAT gateways are deployed only in the specified VPCs.", "es": "Asegúrese de que las puertas de enlace NAT orientadas a Internet se desplieguen solo en los VPCs especificados.", "fr": "Assurez-vous que les passerelles NAT orientées Internet ne sont déployées que dans les VPC spécifiés.", "ja": "インターネット向け NAT ゲートウェイが指定された VPC にのみ展開されるようにします。", "pt": "Garanta que os gateways NAT voltados para a Internet sejam implantados apenas nos VPCs especificados.", "zh": "确保公网 NAT 网关仅部署在指定的 VPC 中。"}, ResourceTypes: []string{"ALIYUN::NAT::NatGateway"}, FilePath: "aliyun/rules/internet-nat-gateway-in-specified-vpc.rego", PackageName: "infraguard.rules.aliyun.internet_nat_gateway_in_specified_vpc", Content: "package infraguard.rules.aliyun.internet_nat_gateway_in_specified_vpc\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"internet-nat-gateway-in-specified-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Internet NAT Gateway in Specified VPC\",\n\t\t\"zh\": \"公网 NAT 网关创建在指定专有网络内\",\n\t\t\"ja\": \"指定された VPC 内のインターネット NAT ゲートウェイ\",\n\t\t\"de\": \"Internet-NAT-Gateway im angegebenen VPC\",\n\t\t\"es\": \"Puerta de Enlace NAT de Internet en VPC Especificado\",\n\t\t\"fr\": \"Passerelle NAT Internet dans VPC Spécifié\",\n\t\t\"pt\": \"Gateway NAT da Internet em VPC Especificado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Internet-facing NAT gateways should be created in specified VPCs according to network security requirements.\",\n\t\t\"zh\": \"公网 NAT 网关所属专有网络在参数指定的专有网络列表中，视为合规。\",\n\t\t\"ja\": \"インターネット向け NAT ゲートウェイは、ネットワークセキュリティ要件に従って指定された VPC 内に作成する必要があります。\",\n\t\t\"de\": \"Internetorientierte NAT-Gateways sollten gemäß Netzwerksicherheitsanforderungen in angegebenen VPCs erstellt werden.\",\n\t\t\"es\": \"Las puertas de enlace NAT orientadas a Internet deben crearse en VPCs especificados según los requisitos de seguridad de red.\",\n\t\t\"fr\": \"Les passerelles NAT orientées Internet doivent être créées dans des VPC spécifiés selon les exigences de sécurité réseau.\",\n\t\t\"pt\": \"Gateways NAT voltados para a Internet devem ser criados em VPCs especificados de acordo com os requisitos de segurança de rede.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Internet-facing NAT gateways in non-specified VPCs may violate network segmentation and security policies.\",\n\t\t\"zh\": \"不在指定 VPC 中的公网 NAT 网关可能违反网络分段和安全策略。\",\n\t\t\"ja\": \"指定されていない VPC 内のインターネット向け NAT ゲートウェイは、ネットワークセグメンテーションとセキュリティポリシーに違反する可能性があります。\",\n\t\t\"de\": \"Internetorientierte NAT-Gateways in nicht angegebenen VPCs können gegen Netzwerksegmentierung und Sicherheitsrichtlinien verstoßen.\",\n\t\t\"es\": \"Las puertas de enlace NAT orientadas a Internet en VPCs no especificados pueden violar la segmentación de red y las políticas de seguridad.\",\n\t\t\"fr\": \"Les passerelles NAT orientées Internet dans des VPC non spécifiés peuvent violer la segmentation réseau et les politiques de sécurité.\",\n\t\t\"pt\": \"Gateways NAT voltados para a Internet em VPCs não especificados podem violar a segmentação de rede e as políticas de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure internet-facing NAT gateways are deployed only in the specified VPCs.\",\n\t\t\"zh\": \"确保公网 NAT 网关仅部署在指定的 VPC 中。\",\n\t\t\"ja\": \"インターネット向け NAT ゲートウェイが指定された VPC にのみ展開されるようにします。\",\n\t\t\"de\": \"Stellen Sie sicher, dass internetorientierte NAT-Gateways nur in den angegebenen VPCs bereitgestellt werden.\",\n\t\t\"es\": \"Asegúrese de que las puertas de enlace NAT orientadas a Internet se desplieguen solo en los VPCs especificados.\",\n\t\t\"fr\": \"Assurez-vous que les passerelles NAT orientées Internet ne sont déployées que dans les VPC spécifiés.\",\n\t\t\"pt\": \"Garanta que os gateways NAT voltados para a Internet sejam implantados apenas nos VPCs especificados.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NAT::NatGateway\"]\n}\n\nis_internet_nat_gateway(resource) if {\n\tnetwork_type := helpers.get_property(resource, \"NetworkType\", \"\")\n\tnetwork_type == \"internet\"\n}\n\nis_in_specified_vpc(resource) if {\n\t# Parameter-based check - in production would use input parameter\n\tvpc_id := helpers.get_property(resource, \"VpcId\", \"\")\n\tvpc_id != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NAT::NatGateway\")\n\tis_internet_nat_gateway(resource)\n\tnot is_in_specified_vpc(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:intranet-nat-gateway-in-specified-vpc", Name: models.I18nString{"de": "Intranet NAT-Gateway im angegebenen VPC", "en": "Intranet NAT Gateway in Specified VPC", "es": "Puerta de Enlace NAT de Intranet en VPC Especificado", "fr": "Passerelle NAT Intranet dans VPC Spécifié", "ja": "指定された VPC 内のイントラネット NAT ゲートウェイ", "pt": "Gateway NAT de Intranet em VPC Especificado", "zh": "私网 NAT 网关创建在指定专有网络内"}, Severity: "medium", Description: models.I18nString{"de": "Intranet-NAT-Gateways sollten gemäß den Netzwerksicherheitsanforderungen in angegebenen VPCs erstellt werden.", "en": "Intranet-facing NAT gateways should be created in specified VPCs according to network security requirements.", "es": "Las puertas de enlace NAT orientadas a intranet deben crearse en VPC especificados según los requisitos de seguridad de red.", "fr": "Les passerelles NAT orientées intranet doivent être créées dans des VPC spécifiés selon les exigences de sécurité réseau.", "ja": "イントラネット向け NAT ゲートウェイは、ネットワークセキュリティ要件に従って指定された VPC に作成する必要があります。", "pt": "Os gateways NAT voltados para intranet devem ser criados em VPCs especificados de acordo com os requisitos de segurança de rede.", "zh": "VPC NAT 网关所属专有网络在参数指定的专有网络列表中，视为合规。"}, Reason: models.I18nString{"de": "Intranet-NAT-Gateways in nicht angegebenen VPCs können gegen Netzwerksegmentierung und Sicherheitsrichtlinien verstoßen.", "en": "Intranet-facing NAT gateways in non-specified VPCs may violate network segmentation and security policies.", "es": "Las puertas de enlace NAT orientadas a intranet en VPC no especificados pueden violar la segmentación de red y las políticas de seguridad.", "fr": "Les passerelles NAT orientées intranet dans des VPC non spécifiés peuvent violer la segmentation réseau et les politiques de sécurité.", "ja": "指定されていない VPC 内のイントラネット向け NAT ゲートウェイは、ネットワークセグメンテーションとセキュリティポリシーに違反する可能性があります。", "pt": "Gateways NAT voltados para intranet em VPCs não especificados podem violar a segmentação de rede e políticas de segurança.", "zh": "不在指定 VPC 中的私网 NAT 网关可能违反网络分段和安全策略。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass Intranet-NAT-Gateways nur in den angegebenen VPCs bereitgestellt werden.", "en": "Ensure intranet-facing NAT gateways are deployed only in the specified VPCs.", "es": "Asegúrese de que las puertas de enlace NAT orientadas a intranet se implementen solo en los VPC especificados.", "fr": "Assurez-vous que les passerelles NAT orientées intranet ne sont déployées que dans les VPC spécifiés.", "ja": "イントラネット向け NAT ゲートウェイが指定された VPC にのみ展開されていることを確認します。", "pt": "Garanta que os gateways NAT voltados para intranet sejam implantados apenas nos VPCs especificados.", "zh": "确保私网 NAT 网关仅部署在指定的 VPC 中。"}, ResourceTypes: []string{"ALIYUN::NAT::NatGateway"}, FilePath: "aliyun/rules/intranet-nat-gateway-in-specified-vpc.rego", PackageName: "infraguard.rules.aliyun.intranet_nat_gateway_in_specified_vpc", Content: "package infraguard.rules.aliyun.intranet_nat_gateway_in_specified_vpc\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"intranet-nat-gateway-in-specified-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Intranet NAT Gateway in Specified VPC\",\n\t\t\"zh\": \"私网 NAT 网关创建在指定专有网络内\",\n\t\t\"ja\": \"指定された VPC 内のイントラネット NAT ゲートウェイ\",\n\t\t\"de\": \"Intranet NAT-Gateway im angegebenen VPC\",\n\t\t\"es\": \"Puerta de Enlace NAT de Intranet en VPC Especificado\",\n\t\t\"fr\": \"Passerelle NAT Intranet dans VPC Spécifié\",\n\t\t\"pt\": \"Gateway NAT de Intranet em VPC Especificado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Intranet-facing NAT gateways should be created in specified VPCs according to network security requirements.\",\n\t\t\"zh\": \"VPC NAT 网关所属专有网络在参数指定的专有网络列表中，视为合规。\",\n\t\t\"ja\": \"イントラネット向け NAT ゲートウェイは、ネットワークセキュリティ要件に従って指定された VPC に作成する必要があります。\",\n\t\t\"de\": \"Intranet-NAT-Gateways sollten gemäß den Netzwerksicherheitsanforderungen in angegebenen VPCs erstellt werden.\",\n\t\t\"es\": \"Las puertas de enlace NAT orientadas a intranet deben crearse en VPC especificados según los requisitos de seguridad de red.\",\n\t\t\"fr\": \"Les passerelles NAT orientées intranet doivent être créées dans des VPC spécifiés selon les exigences de sécurité réseau.\",\n\t\t\"pt\": \"Os gateways NAT voltados para intranet devem ser criados em VPCs especificados de acordo com os requisitos de segurança de rede.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Intranet-facing NAT gateways in non-specified VPCs may violate network segmentation and security policies.\",\n\t\t\"zh\": \"不在指定 VPC 中的私网 NAT 网关可能违反网络分段和安全策略。\",\n\t\t\"ja\": \"指定されていない VPC 内のイントラネット向け NAT ゲートウェイは、ネットワークセグメンテーションとセキュリティポリシーに違反する可能性があります。\",\n\t\t\"de\": \"Intranet-NAT-Gateways in nicht angegebenen VPCs können gegen Netzwerksegmentierung und Sicherheitsrichtlinien verstoßen.\",\n\t\t\"es\": \"Las puertas de enlace NAT orientadas a intranet en VPC no especificados pueden violar la segmentación de red y las políticas de seguridad.\",\n\t\t\"fr\": \"Les passerelles NAT orientées intranet dans des VPC non spécifiés peuvent violer la segmentation réseau et les politiques de sécurité.\",\n\t\t\"pt\": \"Gateways NAT voltados para intranet em VPCs não especificados podem violar a segmentação de rede e políticas de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure intranet-facing NAT gateways are deployed only in the specified VPCs.\",\n\t\t\"zh\": \"确保私网 NAT 网关仅部署在指定的 VPC 中。\",\n\t\t\"ja\": \"イントラネット向け NAT ゲートウェイが指定された VPC にのみ展開されていることを確認します。\",\n\t\t\"de\": \"Stellen Sie sicher, dass Intranet-NAT-Gateways nur in den angegebenen VPCs bereitgestellt werden.\",\n\t\t\"es\": \"Asegúrese de que las puertas de enlace NAT orientadas a intranet se implementen solo en los VPC especificados.\",\n\t\t\"fr\": \"Assurez-vous que les passerelles NAT orientées intranet ne sont déployées que dans les VPC spécifiés.\",\n\t\t\"pt\": \"Garanta que os gateways NAT voltados para intranet sejam implantados apenas nos VPCs especificados.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NAT::NatGateway\"]\n}\n\nis_intranet_nat_gateway(resource) if {\n\tnetwork_type := helpers.get_property(resource, \"NetworkType\", \"\")\n\tnetwork_type == \"intranet\"\n}\n\nis_in_specified_vpc(resource) if {\n\t# Parameter-based check - in production would use input parameter\n\tvpc_id := helpers.get_property(resource, \"VpcId\", \"\")\n\tvpc_id != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NAT::NatGateway\")\n\tis_intranet_nat_gateway(resource)\n\tnot is_in_specified_vpc(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:kafka-instance-disk-encrypted", Name: models.I18nString{"de": "Kafka-Instanz Festplatte verschlüsselt", "en": "Kafka Instance Disk Encrypted", "es": "Disco de Instancia Kafka Cifrado", "fr": "Disque d'Instance Kafka Chiffré", "ja": "Kafka インスタンスディスク暗号化", "pt": "Disco de Instância Kafka Criptografado", "zh": "Kafka 实例部署时启用了云盘加密"}, Severity: "high", Description: models.I18nString{"de": "Kafka-Instanz sollte während der Bereitstellung Festplattenverschlüsselung für den Datenschutz aktiviert haben.", "en": "Kafka instance should have disk encryption enabled during deployment for data protection.", "es": "La instancia Kafka debe tener cifrado de disco habilitado durante la implementación para protección de datos.", "fr": "L'instance Kafka doit avoir le chiffrement de disque activé lors du déploiement pour la protection des données.", "ja": "Kafka インスタンスは、データ保護のためにデプロイ時にディスク暗号化を有効にする必要があります。", "pt": "A instância Kafka deve ter criptografia de disco habilitada durante a implantação para proteção de dados.", "zh": "Kafka 实例部署时启用了云盘加密，视为合规。Serverless 或非服务中的实例视为不适用。"}, Reason: models.I18nString{"de": "Kafka-Instanz hat keine Festplattenverschlüsselung aktiviert, was Daten Sicherheitsrisiken aussetzen kann.", "en": "Kafka instance does not have disk encryption enabled, which may expose data to security risks.", "es": "La instancia Kafka no tiene cifrado de disco habilitado, lo que puede exponer los datos a riesgos de seguridad.", "fr": "L'instance Kafka n'a pas le chiffrement de disque activé, ce qui peut exposer les données à des risques de sécurité.", "ja": "Kafka インスタンスでディスク暗号化が有効になっていないため、データがセキュリティリスクにさらされる可能性があります。", "pt": "A instância Kafka não tem criptografia de disco habilitada, o que pode expor os dados a riscos de segurança.", "zh": "Kafka 实例未启用云盘加密，可能导致数据面临安全风险。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Festplattenverschlüsselung, indem Sie KMSKeyId in DeployOption konfigurieren, wenn Sie die Kafka-Instanz bereitstellen.", "en": "Enable disk encryption by configuring KMSKeyId in DeployOption when deploying the Kafka instance.", "es": "Habilite el cifrado de disco configurando KMSKeyId en DeployOption al implementar la instancia Kafka.", "fr": "Activez le chiffrement de disque en configurant KMSKeyId dans DeployOption lors du déploiement de l'instance Kafka.", "ja": "Kafka インスタンスをデプロイする際に、DeployOption で KMSKeyId を設定してディスク暗号化を有効にします。", "pt": "Habilite a criptografia de disco configurando KMSKeyId em DeployOption ao implantar a instância Kafka.", "zh": "在部署 Kafka 实例时，通过在 DeployOption 中配置 KMSKeyId 来启用云盘加密。"}, ResourceTypes: []string{"ALIYUN::KAFKA::Instance"}, FilePath: "aliyun/rules/kafka-instance-disk-encrypted.rego", PackageName: "infraguard.rules.aliyun.kafka_instance_disk_encrypted", Content: "package infraguard.rules.aliyun.kafka_instance_disk_encrypted\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"kafka-instance-disk-encrypted\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Kafka Instance Disk Encrypted\",\n\t\t\"zh\": \"Kafka 实例部署时启用了云盘加密\",\n\t\t\"ja\": \"Kafka インスタンスディスク暗号化\",\n\t\t\"de\": \"Kafka-Instanz Festplatte verschlüsselt\",\n\t\t\"es\": \"Disco de Instancia Kafka Cifrado\",\n\t\t\"fr\": \"Disque d'Instance Kafka Chiffré\",\n\t\t\"pt\": \"Disco de Instância Kafka Criptografado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Kafka instance should have disk encryption enabled during deployment for data protection.\",\n\t\t\"zh\": \"Kafka 实例部署时启用了云盘加密，视为合规。Serverless 或非服务中的实例视为不适用。\",\n\t\t\"ja\": \"Kafka インスタンスは、データ保護のためにデプロイ時にディスク暗号化を有効にする必要があります。\",\n\t\t\"de\": \"Kafka-Instanz sollte während der Bereitstellung Festplattenverschlüsselung für den Datenschutz aktiviert haben.\",\n\t\t\"es\": \"La instancia Kafka debe tener cifrado de disco habilitado durante la implementación para protección de datos.\",\n\t\t\"fr\": \"L'instance Kafka doit avoir le chiffrement de disque activé lors du déploiement pour la protection des données.\",\n\t\t\"pt\": \"A instância Kafka deve ter criptografia de disco habilitada durante a implantação para proteção de dados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Kafka instance does not have disk encryption enabled, which may expose data to security risks.\",\n\t\t\"zh\": \"Kafka 实例未启用云盘加密，可能导致数据面临安全风险。\",\n\t\t\"ja\": \"Kafka インスタンスでディスク暗号化が有効になっていないため、データがセキュリティリスクにさらされる可能性があります。\",\n\t\t\"de\": \"Kafka-Instanz hat keine Festplattenverschlüsselung aktiviert, was Daten Sicherheitsrisiken aussetzen kann.\",\n\t\t\"es\": \"La instancia Kafka no tiene cifrado de disco habilitado, lo que puede exponer los datos a riesgos de seguridad.\",\n\t\t\"fr\": \"L'instance Kafka n'a pas le chiffrement de disque activé, ce qui peut exposer les données à des risques de sécurité.\",\n\t\t\"pt\": \"A instância Kafka não tem criptografia de disco habilitada, o que pode expor os dados a riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable disk encryption by configuring KMSKeyId in DeployOption when deploying the Kafka instance.\",\n\t\t\"zh\": \"在部署 Kafka 实例时，通过在 DeployOption 中配置 KMSKeyId 来启用云盘加密。\",\n\t\t\"ja\": \"Kafka インスタンスをデプロイする際に、DeployOption で KMSKeyId を設定してディスク暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Festplattenverschlüsselung, indem Sie KMSKeyId in DeployOption konfigurieren, wenn Sie die Kafka-Instanz bereitstellen.\",\n\t\t\"es\": \"Habilite el cifrado de disco configurando KMSKeyId en DeployOption al implementar la instancia Kafka.\",\n\t\t\"fr\": \"Activez le chiffrement de disque en configurant KMSKeyId dans DeployOption lors du déploiement de l'instance Kafka.\",\n\t\t\"pt\": \"Habilite a criptografia de disco configurando KMSKeyId em DeployOption ao implantar a instância Kafka.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::KAFKA::Instance\"]\n}\n\n# Check if the instance is serverless (not applicable)\nis_serverless(resource) if {\n\tresource.Properties.PayType == \"Serverless\"\n}\n\n# Check if disk encryption is enabled via KMSKeyId in DeployOption\nis_disk_encrypted(resource) if {\n\tresource.Properties.DeployOption.KMSKeyId != null\n}\n\n# Generate deny for non-compliant resources\n# Skip serverless instances as they are not applicable\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::KAFKA::Instance\")\n\tnot is_serverless(resource)\n\tnot is_disk_encrypted(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeployOption\", \"KMSKeyId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:kafka-instance-multi-zone", Name: models.I18nString{"de": "Kafka-Instanz Multi-Zone-Bereitstellung", "en": "Kafka Instance Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Instancia Kafka", "fr": "Déploiement Multi-Zone de l'Instance Kafka", "ja": "Kafka インスタンスのマルチゾーン展開", "pt": "Implantação Multi-Zona da Instância Kafka", "zh": "使用多可用区的消息队列 Kafka 版实例"}, Severity: "medium", Description: models.I18nString{"de": "Kafka-Instanzen sollten für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen hinweg bereitgestellt werden.", "en": "Kafka instances should be deployed across multiple availability zones for high availability.", "es": "Las instancias Kafka deben desplegarse en múltiples zonas de disponibilidad para alta disponibilidad.", "fr": "Les instances Kafka doivent être déployées sur plusieurs zones de disponibilité pour une haute disponibilité.", "ja": "Kafka インスタンスは高可用性のために複数の可用性ゾーンにまたがって展開する必要があります。", "pt": "As instâncias Kafka devem ser implantadas em múltiplas zonas de disponibilidade para alta disponibilidade.", "zh": "使用多可用区的消息队列 Kafka 版实例，视为合规。"}, Reason: models.I18nString{"de": "Die Kafka-Instanz ist nicht für die Cross-Zone-Bereitstellung oder mehrere ausgewählte Zonen konfiguriert.", "en": "The Kafka instance is not configured for cross-zone deployment or multiple selected zones.", "es": "La instancia Kafka no está configurada para despliegue entre zonas o múltiples zonas seleccionadas.", "fr": "L'instance Kafka n'est pas configurée pour le déploiement inter-zones ou plusieurs zones sélectionnées.", "ja": "Kafka インスタンスがクロスゾーン展開または複数の選択されたゾーン用に設定されていません。", "pt": "A instância Kafka não está configurada para implantação entre zonas ou múltiplas zonas selecionadas.", "zh": "Kafka 实例未配置跨可用区部署或未选择多个可用区。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie CrossZone oder geben Sie mindestens 2 Zonen in SelectedZones an.", "en": "Enable CrossZone or specify at least 2 zones in SelectedZones.", "es": "Habilite CrossZone o especifique al menos 2 zonas en SelectedZones.", "fr": "Activez CrossZone ou spécifiez au moins 2 zones dans SelectedZones.", "ja": "CrossZone を有効にするか、SelectedZones で少なくとも 2 つのゾーンを指定します。", "pt": "Habilite CrossZone ou especifique pelo menos 2 zonas em SelectedZones.", "zh": "启用 CrossZone 或在 SelectedZones 中指定至少 2 个可用区。"}, ResourceTypes: []string{"ALIYUN::KAFKA::Instance"}, FilePath: "aliyun/rules/kafka-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.kafka_instance_multi_zone", Content: "package infraguard.rules.aliyun.kafka_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"kafka-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Kafka Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的消息队列 Kafka 版实例\",\n\t\t\"ja\": \"Kafka インスタンスのマルチゾーン展開\",\n\t\t\"de\": \"Kafka-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Instancia Kafka\",\n\t\t\"fr\": \"Déploiement Multi-Zone de l'Instance Kafka\",\n\t\t\"pt\": \"Implantação Multi-Zona da Instância Kafka\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Kafka instances should be deployed across multiple availability zones for high availability.\",\n\t\t\"zh\": \"使用多可用区的消息队列 Kafka 版实例，视为合规。\",\n\t\t\"ja\": \"Kafka インスタンスは高可用性のために複数の可用性ゾーンにまたがって展開する必要があります。\",\n\t\t\"de\": \"Kafka-Instanzen sollten für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen hinweg bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias Kafka deben desplegarse en múltiples zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances Kafka doivent être déployées sur plusieurs zones de disponibilité pour une haute disponibilité.\",\n\t\t\"pt\": \"As instâncias Kafka devem ser implantadas em múltiplas zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The Kafka instance is not configured for cross-zone deployment or multiple selected zones.\",\n\t\t\"zh\": \"Kafka 实例未配置跨可用区部署或未选择多个可用区。\",\n\t\t\"ja\": \"Kafka インスタンスがクロスゾーン展開または複数の選択されたゾーン用に設定されていません。\",\n\t\t\"de\": \"Die Kafka-Instanz ist nicht für die Cross-Zone-Bereitstellung oder mehrere ausgewählte Zonen konfiguriert.\",\n\t\t\"es\": \"La instancia Kafka no está configurada para despliegue entre zonas o múltiples zonas seleccionadas.\",\n\t\t\"fr\": \"L'instance Kafka n'est pas configurée pour le déploiement inter-zones ou plusieurs zones sélectionnées.\",\n\t\t\"pt\": \"A instância Kafka não está configurada para implantação entre zonas ou múltiplas zonas selecionadas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable CrossZone or specify at least 2 zones in SelectedZones.\",\n\t\t\"zh\": \"启用 CrossZone 或在 SelectedZones 中指定至少 2 个可用区。\",\n\t\t\"ja\": \"CrossZone を有効にするか、SelectedZones で少なくとも 2 つのゾーンを指定します。\",\n\t\t\"de\": \"Aktivieren Sie CrossZone oder geben Sie mindestens 2 Zonen in SelectedZones an.\",\n\t\t\"es\": \"Habilite CrossZone o especifique al menos 2 zonas en SelectedZones.\",\n\t\t\"fr\": \"Activez CrossZone ou spécifiez au moins 2 zones dans SelectedZones.\",\n\t\t\"pt\": \"Habilite CrossZone ou especifique pelo menos 2 zonas em SelectedZones.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::KAFKA::Instance\"]\n}\n\n# Check if instance is multi-zone\nis_multi_zone(resource) if {\n\t# Method 1: DeployOption.CrossZone is set to true\n\tdeploy_option := object.get(resource.Properties, \"DeployOption\", {})\n\tobject.get(deploy_option, \"CrossZone\", false) == true\n}\n\nis_multi_zone(resource) if {\n\t# Method 2: DeployOption.SelectedZones count >= 2\n\tdeploy_option := object.get(resource.Properties, \"DeployOption\", {})\n\tselected_zones := object.get(deploy_option, \"SelectedZones\", [])\n\tcount(selected_zones) >= 2\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"CrossZone\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:kafka-instance-public-access-check", Name: models.I18nString{"de": "Kafka Öffentlicher Zugriff deaktiviert", "en": "Kafka Public Access Disabled", "es": "Acceso Público de Kafka Deshabilitado", "fr": "Accès Public Kafka Désactivé", "ja": "Kafka パブリックアクセスが無効", "pt": "Acesso Público do Kafka Desabilitado", "zh": "Kafka 实例禁用公网访问"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Kafka-Instanzen keinen öffentlichen Netzwerkzugriff haben.", "en": "Ensures Kafka instances do not have public network access.", "es": "Garantiza que las instancias Kafka no tengan acceso a la red pública.", "fr": "Garantit que les instances Kafka n'ont pas d'accès réseau public.", "ja": "Kafka インスタンスにパブリックネットワークアクセスがないことを確認します。", "pt": "Garante que as instâncias Kafka não tenham acesso à rede pública.", "zh": "确保 Kafka 实例未开启公网访问。"}, Reason: models.I18nString{"de": "Das Aussetzen von Kafka im öffentlichen Internet ist ein erhebliches Sicherheitsrisiko.", "en": "Exposing Kafka to the public internet is a significant security risk.", "es": "Exponer Kafka a Internet público es un riesgo de seguridad significativo.", "fr": "Exposer Kafka à Internet public constitue un risque de sécurité important.", "ja": "Kafka をパブリックインターネットに公開することは、重大なセキュリティリスクです。", "pt": "Expor Kafka à Internet pública é um risco de segurança significativo.", "zh": "将 Kafka 暴露在公网会带来重大的安全风险。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie den öffentlichen Endpunkt für die Kafka-Instanz.", "en": "Disable the public endpoint for the Kafka instance.", "es": "Deshabilite el punto final público para la instancia Kafka.", "fr": "Désactivez le point de terminaison public pour l'instance Kafka.", "ja": "Kafka インスタンスのパブリックエンドポイントを無効にします。", "pt": "Desabilite o ponto de extremidade público para a instância Kafka.", "zh": "禁用 Kafka 实例的公网端点。"}, ResourceTypes: []string{"ALIYUN::KAFKA::Instance"}, FilePath: "aliyun/rules/kafka-instance-public-access-check.rego", PackageName: "infraguard.rules.aliyun.kafka_instance_public_access_check", Content: "package infraguard.rules.aliyun.kafka_instance_public_access_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"kafka-instance-public-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Kafka Public Access Disabled\",\n\t\t\"zh\": \"Kafka 实例禁用公网访问\",\n\t\t\"ja\": \"Kafka パブリックアクセスが無効\",\n\t\t\"de\": \"Kafka Öffentlicher Zugriff deaktiviert\",\n\t\t\"es\": \"Acceso Público de Kafka Deshabilitado\",\n\t\t\"fr\": \"Accès Public Kafka Désactivé\",\n\t\t\"pt\": \"Acesso Público do Kafka Desabilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Kafka instances do not have public network access.\",\n\t\t\"zh\": \"确保 Kafka 实例未开启公网访问。\",\n\t\t\"ja\": \"Kafka インスタンスにパブリックネットワークアクセスがないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Kafka-Instanzen keinen öffentlichen Netzwerkzugriff haben.\",\n\t\t\"es\": \"Garantiza que las instancias Kafka no tengan acceso a la red pública.\",\n\t\t\"fr\": \"Garantit que les instances Kafka n'ont pas d'accès réseau public.\",\n\t\t\"pt\": \"Garante que as instâncias Kafka não tenham acesso à rede pública.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Exposing Kafka to the public internet is a significant security risk.\",\n\t\t\"zh\": \"将 Kafka 暴露在公网会带来重大的安全风险。\",\n\t\t\"ja\": \"Kafka をパブリックインターネットに公開することは、重大なセキュリティリスクです。\",\n\t\t\"de\": \"Das Aussetzen von Kafka im öffentlichen Internet ist ein erhebliches Sicherheitsrisiko.\",\n\t\t\"es\": \"Exponer Kafka a Internet público es un riesgo de seguridad significativo.\",\n\t\t\"fr\": \"Exposer Kafka à Internet public constitue un risque de sécurité important.\",\n\t\t\"pt\": \"Expor Kafka à Internet pública é um risco de segurança significativo.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable the public endpoint for the Kafka instance.\",\n\t\t\"zh\": \"禁用 Kafka 实例的公网端点。\",\n\t\t\"ja\": \"Kafka インスタンスのパブリックエンドポイントを無効にします。\",\n\t\t\"de\": \"Deaktivieren Sie den öffentlichen Endpunkt für die Kafka-Instanz.\",\n\t\t\"es\": \"Deshabilite el punto final público para la instancia Kafka.\",\n\t\t\"fr\": \"Désactivez le point de terminaison public pour l'instance Kafka.\",\n\t\t\"pt\": \"Desabilite o ponto de extremidade público para a instância Kafka.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::KAFKA::Instance\"]\n}\n\nis_compliant(resource) if {\n\t# In ROS, check DeployType or similar properties\n\t# 4: VPC, 5: Public\n\ttype := helpers.get_property(resource, \"DeployType\", 4)\n\ttype != 5\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::KAFKA::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeployType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:kms-instance-multi-zone", Name: models.I18nString{"de": "KMS-Instanz Multi-Zone-Bereitstellung", "en": "KMS Instance Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Instancia KMS", "fr": "Déploiement Multi-Zone de l'Instance KMS", "ja": "KMS インスタンスのマルチゾーン展開", "pt": "Implantação Multi-Zona da Instância KMS", "zh": "使用多可用区的 KMS 实例"}, Severity: "medium", Description: models.I18nString{"de": "KMS-Instanzen sollten für hohe Verfügbarkeit und Disaster Recovery über mindestens zwei Verfügbarkeitszonen hinweg bereitgestellt werden.", "en": "KMS instances should be deployed across at least two availability zones for high availability and disaster recovery.", "es": "Las instancias KMS deben desplegarse en al menos dos zonas de disponibilidad para alta disponibilidad y recuperación ante desastres.", "fr": "Les instances KMS doivent être déployées sur au moins deux zones de disponibilité pour une haute disponibilité et une reprise après sinistre.", "ja": "KMS インスタンスは高可用性と災害復旧のために少なくとも 2 つの可用性ゾーンにまたがって展開する必要があります。", "pt": "As instâncias KMS devem ser implantadas em pelo menos duas zonas de disponibilidade para alta disponibilidade e recuperação de desastres.", "zh": "使用多可用区的 KMS 实例，视为合规。"}, Reason: models.I18nString{"de": "Die KMS-Instanz ist nicht mit mehreren Verfügbarkeitszonen konfiguriert, was die Verfügbarkeit beeinträchtigen kann.", "en": "The KMS instance is not configured with multiple availability zones, which may affect availability.", "es": "La instancia KMS no está configurada con múltiples zonas de disponibilidad, lo que puede afectar la disponibilidad.", "fr": "L'instance KMS n'est pas configurée avec plusieurs zones de disponibilité, ce qui peut affecter la disponibilité.", "ja": "KMS インスタンスが複数の可用性ゾーンで設定されていないため、可用性に影響を与える可能性があります。", "pt": "A instância KMS não está configurada com múltiplas zonas de disponibilidade, o que pode afetar a disponibilidade.", "zh": "KMS 实例未配置多个可用区，可能影响可用性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie mindestens zwei Verfügbarkeitszonen in der Connection.ZoneIds-Eigenschaft, um Multi-Zone-Bereitstellung zu aktivieren.", "en": "Configure at least two availability zones in the Connection.ZoneIds property to enable multi-zone deployment.", "es": "Configure al menos dos zonas de disponibilidad en la propiedad Connection.ZoneIds para habilitar el despliegue multi-zona.", "fr": "Configurez au moins deux zones de disponibilité dans la propriété Connection.ZoneIds pour activer le déploiement multi-zones.", "ja": "マルチゾーン展開を有効にするために、Connection.ZoneIds プロパティで少なくとも 2 つの可用性ゾーンを設定します。", "pt": "Configure pelo menos duas zonas de disponibilidade na propriedade Connection.ZoneIds para habilitar a implantação multi-zona.", "zh": "在 Connection.ZoneIds 属性中配置至少两个可用区，以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::KMS::Instance"}, FilePath: "aliyun/rules/kms-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.kms_instance_multi_zone", Content: "package infraguard.rules.aliyun.kms_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"kms-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"KMS Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的 KMS 实例\",\n\t\t\"ja\": \"KMS インスタンスのマルチゾーン展開\",\n\t\t\"de\": \"KMS-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Instancia KMS\",\n\t\t\"fr\": \"Déploiement Multi-Zone de l'Instance KMS\",\n\t\t\"pt\": \"Implantação Multi-Zona da Instância KMS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"KMS instances should be deployed across at least two availability zones for high availability and disaster recovery.\",\n\t\t\"zh\": \"使用多可用区的 KMS 实例，视为合规。\",\n\t\t\"ja\": \"KMS インスタンスは高可用性と災害復旧のために少なくとも 2 つの可用性ゾーンにまたがって展開する必要があります。\",\n\t\t\"de\": \"KMS-Instanzen sollten für hohe Verfügbarkeit und Disaster Recovery über mindestens zwei Verfügbarkeitszonen hinweg bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias KMS deben desplegarse en al menos dos zonas de disponibilidad para alta disponibilidad y recuperación ante desastres.\",\n\t\t\"fr\": \"Les instances KMS doivent être déployées sur au moins deux zones de disponibilité pour une haute disponibilité et une reprise après sinistre.\",\n\t\t\"pt\": \"As instâncias KMS devem ser implantadas em pelo menos duas zonas de disponibilidade para alta disponibilidade e recuperação de desastres.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The KMS instance is not configured with multiple availability zones, which may affect availability.\",\n\t\t\"zh\": \"KMS 实例未配置多个可用区，可能影响可用性。\",\n\t\t\"ja\": \"KMS インスタンスが複数の可用性ゾーンで設定されていないため、可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Die KMS-Instanz ist nicht mit mehreren Verfügbarkeitszonen konfiguriert, was die Verfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"La instancia KMS no está configurada con múltiples zonas de disponibilidad, lo que puede afectar la disponibilidad.\",\n\t\t\"fr\": \"L'instance KMS n'est pas configurée avec plusieurs zones de disponibilité, ce qui peut affecter la disponibilité.\",\n\t\t\"pt\": \"A instância KMS não está configurada com múltiplas zonas de disponibilidade, o que pode afetar a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure at least two availability zones in the Connection.ZoneIds property to enable multi-zone deployment.\",\n\t\t\"zh\": \"在 Connection.ZoneIds 属性中配置至少两个可用区，以启用多可用区部署。\",\n\t\t\"ja\": \"マルチゾーン展開を有効にするために、Connection.ZoneIds プロパティで少なくとも 2 つの可用性ゾーンを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie mindestens zwei Verfügbarkeitszonen in der Connection.ZoneIds-Eigenschaft, um Multi-Zone-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure al menos dos zonas de disponibilidad en la propiedad Connection.ZoneIds para habilitar el despliegue multi-zona.\",\n\t\t\"fr\": \"Configurez au moins deux zones de disponibilité dans la propriété Connection.ZoneIds pour activer le déploiement multi-zones.\",\n\t\t\"pt\": \"Configure pelo menos duas zonas de disponibilidade na propriedade Connection.ZoneIds para habilitar a implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::KMS::Instance\"]\n}\n\n# Check if instance has multiple zones configured\nhas_multiple_zones(resource) if {\n\thelpers.has_property(resource, \"Connection\")\n\tconnection := resource.Properties.Connection\n\tzone_ids := connection.ZoneIds\n\tcount(zone_ids) >= 2\n}\n\n# Deny rule: KMS instances must be deployed in multiple zones\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::KMS::Instance\")\n\tnot has_multiple_zones(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Connection\", \"ZoneIds\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:kms-key-delete-protection-enabled", Name: models.I18nString{"de": "KMS-Schlüssel-Löschschutz aktiviert", "en": "KMS key deletion protection enabled", "es": "Protección de Eliminación de Clave KMS Habilitada", "fr": "Protection contre la Suppression de Clé KMS Activée", "ja": "KMS キー削除保護が有効", "pt": "Proteção de Exclusão de Chave KMS Habilitada", "zh": "KMS 主密钥开启删除保护"}, Severity: "medium", Description: models.I18nString{"de": "KMS-Masterschlüssel hat Löschschutz aktiviert, gilt als konform. Schlüssel, die nicht im aktivierten Status sind, und Dienstschlüssel (die nicht gelöscht werden können) sind nicht anwendbar.", "en": "KMS master key has deletion protection enabled, considered compliant. Keys not in enabled status and service keys (which cannot be deleted) are not applicable.", "es": "La clave maestra KMS tiene protección de eliminación habilitada, se considera conforme. Las claves que no están en estado habilitado y las claves de servicio (que no se pueden eliminar) no son aplicables.", "fr": "La clé maître KMS a la protection contre la suppression activée, considérée comme conforme. Les clés qui ne sont pas en état activé et les clés de service (qui ne peuvent pas être supprimées) ne sont pas applicables.", "ja": "KMS マスターキーで削除保護が有効になっている場合、準拠と見なされます。有効状態でないキーとサービスキー（削除できない）は適用されません。", "pt": "A chave mestra KMS tem proteção de exclusão habilitada, considerada em conformidade. Chaves que não estão em status habilitado e chaves de serviço (que não podem ser excluídas) não são aplicáveis.", "zh": "KMS 主密钥开启删除保护,视为合规。如果密钥状态非启用中,视为不适用,如果密钥为服务密钥,由于本身不可删除,视为不适用。"}, Reason: models.I18nString{"de": "KMS-Schlüssel hat keinen Löschschutz aktiviert", "en": "KMS key does not have deletion protection enabled", "es": "La clave KMS no tiene protección de eliminación habilitada", "fr": "La clé KMS n'a pas la protection contre la suppression activée", "ja": "KMS キーで削除保護が有効になっていません", "pt": "A chave KMS não tem proteção de exclusão habilitada", "zh": "KMS 主密钥未开启删除保护"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für den KMS-Schlüssel, um versehentliches Löschen kritischer Verschlüsselungsschlüssel zu verhindern", "en": "Enable deletion protection for KMS key to prevent accidental deletion of critical encryption keys", "es": "Habilite la protección de eliminación para la clave KMS para prevenir la eliminación accidental de claves de cifrado críticas", "fr": "Activez la protection contre la suppression pour la clé KMS pour empêcher la suppression accidentelle de clés de chiffrement critiques", "ja": "重要な暗号化キーの誤削除を防ぐために、KMS キーの削除保護を有効にします", "pt": "Habilite a proteção de exclusão para a chave KMS para prevenir a exclusão acidental de chaves de criptografia críticas", "zh": "为 KMS 主密钥启用删除保护以防止意外删除关键加密密钥"}, ResourceTypes: []string{"ALIYUN::KMS::Key"}, FilePath: "aliyun/rules/kms-key-delete-protection-enabled.rego", PackageName: "infraguard.rules.aliyun.kms_key_delete_protection_enabled", Content: "package infraguard.rules.aliyun.kms_key_delete_protection_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"kms-key-delete-protection-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"KMS key deletion protection enabled\",\n\t\t\"zh\": \"KMS 主密钥开启删除保护\",\n\t\t\"ja\": \"KMS キー削除保護が有効\",\n\t\t\"de\": \"KMS-Schlüssel-Löschschutz aktiviert\",\n\t\t\"es\": \"Protección de Eliminación de Clave KMS Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression de Clé KMS Activée\",\n\t\t\"pt\": \"Proteção de Exclusão de Chave KMS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"KMS master key has deletion protection enabled, considered compliant. Keys not in enabled status and service keys (which cannot be deleted) are not applicable.\",\n\t\t\"zh\": \"KMS 主密钥开启删除保护,视为合规。如果密钥状态非启用中,视为不适用,如果密钥为服务密钥,由于本身不可删除,视为不适用。\",\n\t\t\"ja\": \"KMS マスターキーで削除保護が有効になっている場合、準拠と見なされます。有効状態でないキーとサービスキー（削除できない）は適用されません。\",\n\t\t\"de\": \"KMS-Masterschlüssel hat Löschschutz aktiviert, gilt als konform. Schlüssel, die nicht im aktivierten Status sind, und Dienstschlüssel (die nicht gelöscht werden können) sind nicht anwendbar.\",\n\t\t\"es\": \"La clave maestra KMS tiene protección de eliminación habilitada, se considera conforme. Las claves que no están en estado habilitado y las claves de servicio (que no se pueden eliminar) no son aplicables.\",\n\t\t\"fr\": \"La clé maître KMS a la protection contre la suppression activée, considérée comme conforme. Les clés qui ne sont pas en état activé et les clés de service (qui ne peuvent pas être supprimées) ne sont pas applicables.\",\n\t\t\"pt\": \"A chave mestra KMS tem proteção de exclusão habilitada, considerada em conformidade. Chaves que não estão em status habilitado e chaves de serviço (que não podem ser excluídas) não são aplicáveis.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"KMS key does not have deletion protection enabled\",\n\t\t\"zh\": \"KMS 主密钥未开启删除保护\",\n\t\t\"ja\": \"KMS キーで削除保護が有効になっていません\",\n\t\t\"de\": \"KMS-Schlüssel hat keinen Löschschutz aktiviert\",\n\t\t\"es\": \"La clave KMS no tiene protección de eliminación habilitada\",\n\t\t\"fr\": \"La clé KMS n'a pas la protection contre la suppression activée\",\n\t\t\"pt\": \"A chave KMS não tem proteção de exclusão habilitada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for KMS key to prevent accidental deletion of critical encryption keys\",\n\t\t\"zh\": \"为 KMS 主密钥启用删除保护以防止意外删除关键加密密钥\",\n\t\t\"ja\": \"重要な暗号化キーの誤削除を防ぐために、KMS キーの削除保護を有効にします\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für den KMS-Schlüssel, um versehentliches Löschen kritischer Verschlüsselungsschlüssel zu verhindern\",\n\t\t\"es\": \"Habilite la protección de eliminación para la clave KMS para prevenir la eliminación accidental de claves de cifrado críticas\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour la clé KMS pour empêcher la suppression accidentelle de clés de chiffrement critiques\",\n\t\t\"pt\": \"Habilite a proteção de exclusão para a chave KMS para prevenir a exclusão acidental de chaves de criptografia críticas\"\n\t},\n\t\"resource_types\": [\"ALIYUN::KMS::Key\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::KMS::Key\")\n\n\t# Check if DeletionProtection is enabled\n\tdeletion_protection := helpers.get_property(resource, \"DeletionProtection\", false)\n\tnot helpers.is_true(deletion_protection)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:kms-key-rotation-enabled", Name: models.I18nString{"de": "KMS-Schlüssel automatische Rotation aktiviert", "en": "KMS key automatic rotation enabled", "es": "Rotación automática de clave KMS habilitada", "fr": "Rotation automatique de clé KMS activée", "ja": "KMS キーの自動ローテーションが有効", "pt": "Rotação automática de chave KMS habilitada", "zh": "密钥管理服务设置主密钥自动轮转"}, Severity: "medium", Description: models.I18nString{"de": "KMS-Benutzer-Hauptschlüssel hat automatische Rotation aktiviert, wird als konform betrachtet. Dienstschlüssel und extern importierte Schlüssel sind nicht anwendbar.", "en": "KMS user master key has automatic rotation enabled, considered compliant. Service keys and externally imported keys are not applicable.", "es": "La clave maestra de usuario KMS tiene rotación automática habilitada, considerada conforme. Las claves de servicio y las claves importadas externamente no son aplicables.", "fr": "La clé maître utilisateur KMS a la rotation automatique activée, considérée comme conforme. Les clés de service et les clés importées externement ne sont pas applicables.", "ja": "KMS ユーザーマスターキーで自動ローテーションが有効になっている場合、準拠と見なされます。サービスキーと外部からインポートされたキーは適用されません。", "pt": "Chave mestra de usuário KMS tem rotação automática habilitada, considerada conforme. Chaves de serviço e chaves importadas externamente não são aplicáveis.", "zh": "对密钥管理服务中的用户主密钥设置自动轮转,视为合规。如果是服务密钥,视为不适用。如果来源是用户自带密钥,视为不适用。"}, Reason: models.I18nString{"de": "KMS-Schlüssel hat keine automatische Rotation aktiviert", "en": "KMS key does not have automatic rotation enabled", "es": "La clave KMS no tiene rotación automática habilitada", "fr": "La clé KMS n'a pas la rotation automatique activée", "ja": "KMS キーで自動ローテーションが有効になっていません", "pt": "Chave KMS não tem rotação automática habilitada", "zh": "KMS 主密钥未开启自动轮转"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Rotation für KMS-Schlüssel, um die Sicherheit durch regelmäßige Rotation von Verschlüsselungsschlüsseln zu verbessern", "en": "Enable automatic rotation for KMS key to enhance security by regularly rotating encryption keys", "es": "Habilite la rotación automática para la clave KMS para mejorar la seguridad rotando claves de cifrado regularmente", "fr": "Activez la rotation automatique pour la clé KMS pour améliorer la sécurité en faisant tourner régulièrement les clés de chiffrement", "ja": "暗号化キーを定期的にローテーションしてセキュリティを強化するために、KMS キーで自動ローテーションを有効にします", "pt": "Habilite rotação automática para chave KMS para melhorar a segurança rotacionando chaves de criptografia regularmente", "zh": "为 KMS 主密钥启用自动轮转以通过定期轮换加密密钥来增强安全性"}, ResourceTypes: []string{"ALIYUN::KMS::Key"}, FilePath: "aliyun/rules/kms-key-rotation-enabled.rego", PackageName: "infraguard.rules.aliyun.kms_key_rotation_enabled", Content: "package infraguard.rules.aliyun.kms_key_rotation_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"kms-key-rotation-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"KMS key automatic rotation enabled\",\n\t\t\"zh\": \"密钥管理服务设置主密钥自动轮转\",\n\t\t\"ja\": \"KMS キーの自動ローテーションが有効\",\n\t\t\"de\": \"KMS-Schlüssel automatische Rotation aktiviert\",\n\t\t\"es\": \"Rotación automática de clave KMS habilitada\",\n\t\t\"fr\": \"Rotation automatique de clé KMS activée\",\n\t\t\"pt\": \"Rotação automática de chave KMS habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"KMS user master key has automatic rotation enabled, considered compliant. Service keys and externally imported keys are not applicable.\",\n\t\t\"zh\": \"对密钥管理服务中的用户主密钥设置自动轮转,视为合规。如果是服务密钥,视为不适用。如果来源是用户自带密钥,视为不适用。\",\n\t\t\"ja\": \"KMS ユーザーマスターキーで自動ローテーションが有効になっている場合、準拠と見なされます。サービスキーと外部からインポートされたキーは適用されません。\",\n\t\t\"de\": \"KMS-Benutzer-Hauptschlüssel hat automatische Rotation aktiviert, wird als konform betrachtet. Dienstschlüssel und extern importierte Schlüssel sind nicht anwendbar.\",\n\t\t\"es\": \"La clave maestra de usuario KMS tiene rotación automática habilitada, considerada conforme. Las claves de servicio y las claves importadas externamente no son aplicables.\",\n\t\t\"fr\": \"La clé maître utilisateur KMS a la rotation automatique activée, considérée comme conforme. Les clés de service et les clés importées externement ne sont pas applicables.\",\n\t\t\"pt\": \"Chave mestra de usuário KMS tem rotação automática habilitada, considerada conforme. Chaves de serviço e chaves importadas externamente não são aplicáveis.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"KMS key does not have automatic rotation enabled\",\n\t\t\"zh\": \"KMS 主密钥未开启自动轮转\",\n\t\t\"ja\": \"KMS キーで自動ローテーションが有効になっていません\",\n\t\t\"de\": \"KMS-Schlüssel hat keine automatische Rotation aktiviert\",\n\t\t\"es\": \"La clave KMS no tiene rotación automática habilitada\",\n\t\t\"fr\": \"La clé KMS n'a pas la rotation automatique activée\",\n\t\t\"pt\": \"Chave KMS não tem rotação automática habilitada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable automatic rotation for KMS key to enhance security by regularly rotating encryption keys\",\n\t\t\"zh\": \"为 KMS 主密钥启用自动轮转以通过定期轮换加密密钥来增强安全性\",\n\t\t\"ja\": \"暗号化キーを定期的にローテーションしてセキュリティを強化するために、KMS キーで自動ローテーションを有効にします\",\n\t\t\"de\": \"Aktivieren Sie die automatische Rotation für KMS-Schlüssel, um die Sicherheit durch regelmäßige Rotation von Verschlüsselungsschlüsseln zu verbessern\",\n\t\t\"es\": \"Habilite la rotación automática para la clave KMS para mejorar la seguridad rotando claves de cifrado regularmente\",\n\t\t\"fr\": \"Activez la rotation automatique pour la clé KMS pour améliorer la sécurité en faisant tourner régulièrement les clés de chiffrement\",\n\t\t\"pt\": \"Habilite rotação automática para chave KMS para melhorar a segurança rotacionando chaves de criptografia regularmente\"\n\t},\n\t\"resource_types\": [\"ALIYUN::KMS::Key\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::KMS::Key\")\n\n\t# Check if EnableAutomaticRotation is enabled\n\trotation_enabled := helpers.get_property(resource, \"EnableAutomaticRotation\", false)\n\tnot helpers.is_true(rotation_enabled)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:kms-secret-rotation-enabled", Name: models.I18nString{"de": "KMS-Geheimnis automatische Rotation aktiviert", "en": "KMS secret automatic rotation enabled", "es": "Rotación automática de secreto KMS habilitada", "fr": "Rotation automatique de secret KMS activée", "ja": "KMS シークレットの自動ローテーションが有効", "pt": "Rotação automática de segredo KMS habilitada", "zh": "密钥管理服务设置凭据自动轮转"}, Severity: "medium", Description: models.I18nString{"de": "KMS-Geheimnis hat automatische Rotation aktiviert, wird als konform betrachtet. Generische Geheimnisse sind nicht anwendbar.", "en": "KMS secret has automatic rotation enabled, considered compliant. Generic secrets are not applicable.", "es": "El secreto KMS tiene rotación automática habilitada, considerado conforme. Los secretos genéricos no son aplicables.", "fr": "Le secret KMS a la rotation automatique activée, considéré comme conforme. Les secrets génériques ne sont pas applicables.", "ja": "KMS シークレットで自動ローテーションが有効になっている場合、準拠と見なされます。汎用シークレットは適用されません。", "pt": "Segredo KMS tem rotação automática habilitada, considerado conforme. Segredos genéricos não são aplicáveis.", "zh": "密钥管理服务中的凭据设置自动轮转,视为合规。如果密钥类型为普通密钥,视为不适用。"}, Reason: models.I18nString{"de": "KMS-Geheimnis hat keine automatische Rotation aktiviert", "en": "KMS secret does not have automatic rotation enabled", "es": "El secreto KMS no tiene rotación automática habilitada", "fr": "Le secret KMS n'a pas la rotation automatique activée", "ja": "KMS シークレットで自動ローテーションが有効になっていません", "pt": "Segredo KMS não tem rotação automática habilitada", "zh": "KMS 凭据未开启自动轮转"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Rotation für KMS-Geheimnisse, um die Sicherheit durch regelmäßige Rotation von Anmeldeinformationen zu verbessern", "en": "Enable automatic rotation for KMS secret to enhance security by regularly rotating credentials", "es": "Habilite la rotación automática para el secreto KMS para mejorar la seguridad rotando credenciales regularmente", "fr": "Activez la rotation automatique pour le secret KMS pour améliorer la sécurité en faisant tourner régulièrement les identifiants", "ja": "認証情報を定期的にローテーションしてセキュリティを強化するために、KMS シークレットで自動ローテーションを有効にします", "pt": "Habilite rotação automática para segredo KMS para melhorar a segurança rotacionando credenciais regularmente", "zh": "为 KMS 凭据启用自动轮转以通过定期轮换凭据来增强安全性"}, ResourceTypes: []string{"ALIYUN::KMS::Secret"}, FilePath: "aliyun/rules/kms-secret-rotation-enabled.rego", PackageName: "infraguard.rules.aliyun.kms_secret_rotation_enabled", Content: "package infraguard.rules.aliyun.kms_secret_rotation_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"kms-secret-rotation-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"KMS secret automatic rotation enabled\",\n\t\t\"zh\": \"密钥管理服务设置凭据自动轮转\",\n\t\t\"ja\": \"KMS シークレットの自動ローテーションが有効\",\n\t\t\"de\": \"KMS-Geheimnis automatische Rotation aktiviert\",\n\t\t\"es\": \"Rotación automática de secreto KMS habilitada\",\n\t\t\"fr\": \"Rotation automatique de secret KMS activée\",\n\t\t\"pt\": \"Rotação automática de segredo KMS habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"KMS secret has automatic rotation enabled, considered compliant. Generic secrets are not applicable.\",\n\t\t\"zh\": \"密钥管理服务中的凭据设置自动轮转,视为合规。如果密钥类型为普通密钥,视为不适用。\",\n\t\t\"ja\": \"KMS シークレットで自動ローテーションが有効になっている場合、準拠と見なされます。汎用シークレットは適用されません。\",\n\t\t\"de\": \"KMS-Geheimnis hat automatische Rotation aktiviert, wird als konform betrachtet. Generische Geheimnisse sind nicht anwendbar.\",\n\t\t\"es\": \"El secreto KMS tiene rotación automática habilitada, considerado conforme. Los secretos genéricos no son aplicables.\",\n\t\t\"fr\": \"Le secret KMS a la rotation automatique activée, considéré comme conforme. Les secrets génériques ne sont pas applicables.\",\n\t\t\"pt\": \"Segredo KMS tem rotação automática habilitada, considerado conforme. Segredos genéricos não são aplicáveis.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"KMS secret does not have automatic rotation enabled\",\n\t\t\"zh\": \"KMS 凭据未开启自动轮转\",\n\t\t\"ja\": \"KMS シークレットで自動ローテーションが有効になっていません\",\n\t\t\"de\": \"KMS-Geheimnis hat keine automatische Rotation aktiviert\",\n\t\t\"es\": \"El secreto KMS no tiene rotación automática habilitada\",\n\t\t\"fr\": \"Le secret KMS n'a pas la rotation automatique activée\",\n\t\t\"pt\": \"Segredo KMS não tem rotação automática habilitada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable automatic rotation for KMS secret to enhance security by regularly rotating credentials\",\n\t\t\"zh\": \"为 KMS 凭据启用自动轮转以通过定期轮换凭据来增强安全性\",\n\t\t\"ja\": \"認証情報を定期的にローテーションしてセキュリティを強化するために、KMS シークレットで自動ローテーションを有効にします\",\n\t\t\"de\": \"Aktivieren Sie die automatische Rotation für KMS-Geheimnisse, um die Sicherheit durch regelmäßige Rotation von Anmeldeinformationen zu verbessern\",\n\t\t\"es\": \"Habilite la rotación automática para el secreto KMS para mejorar la seguridad rotando credenciales regularmente\",\n\t\t\"fr\": \"Activez la rotation automatique pour le secret KMS pour améliorer la sécurité en faisant tourner régulièrement les identifiants\",\n\t\t\"pt\": \"Habilite rotação automática para segredo KMS para melhorar a segurança rotacionando credenciais regularmente\"\n\t},\n\t\"resource_types\": [\"ALIYUN::KMS::Secret\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::KMS::Secret\")\n\n\t# Check if EnableAutomaticRotation is enabled\n\trotation_enabled := helpers.get_property(resource, \"EnableAutomaticRotation\", false)\n\tnot helpers.is_true(rotation_enabled)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:lindorm-instance-in-vpc", Name: models.I18nString{"de": "Lindorm in VPC-Prüfung", "en": "Lindorm in VPC Check", "es": "Verificación de Lindorm en VPC", "fr": "Vérification de Lindorm dans VPC", "ja": "Lindorm の VPC チェック", "pt": "Verificação de Lindorm em VPC", "zh": "Lindorm 实例强制 VPC 部署"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Lindorm-Instanzen innerhalb eines VPC bereitgestellt werden.", "en": "Ensures Lindorm instances are deployed within a VPC.", "es": "Garantiza que las instancias Lindorm se desplieguen dentro de una VPC.", "fr": "Garantit que les instances Lindorm sont déployées dans un VPC.", "ja": "Lindorm インスタンスが VPC 内に展開されていることを確認します。", "pt": "Garante que as instâncias Lindorm sejam implantadas dentro de uma VPC.", "zh": "确保 Lindorm 实例部署在 VPC 内。"}, Reason: models.I18nString{"de": "Die Bereitstellung in einem VPC bietet bessere Netzwerkisolation und Sicherheit.", "en": "Deploying in a VPC provides better network isolation and security.", "es": "Desplegar en una VPC proporciona mejor aislamiento de red y seguridad.", "fr": "Le déploiement dans un VPC offre une meilleure isolation réseau et sécurité.", "ja": "VPC に展開することで、より優れたネットワーク分離とセキュリティが提供されます。", "pt": "Implantar em uma VPC fornece melhor isolamento de rede e segurança.", "zh": "在 VPC 中部署可提供更好的网络隔离和安全性。"}, Recommendation: models.I18nString{"de": "Erstellen Sie Lindorm-Instanzen innerhalb eines VPC.", "en": "Create Lindorm instances within a VPC.", "es": "Cree instancias Lindorm dentro de una VPC.", "fr": "Créez des instances Lindorm dans un VPC.", "ja": "VPC 内に Lindorm インスタンスを作成します。", "pt": "Crie instâncias Lindorm dentro de uma VPC.", "zh": "在 VPC 内创建 Lindorm 实例。"}, ResourceTypes: []string{"ALIYUN::Lindorm::Instance"}, FilePath: "aliyun/rules/lindorm-instance-in-vpc.rego", PackageName: "infraguard.rules.aliyun.lindorm_instance_in_vpc", Content: "package infraguard.rules.aliyun.lindorm_instance_in_vpc\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"lindorm-instance-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Lindorm in VPC Check\",\n\t\t\"zh\": \"Lindorm 实例强制 VPC 部署\",\n\t\t\"ja\": \"Lindorm の VPC チェック\",\n\t\t\"de\": \"Lindorm in VPC-Prüfung\",\n\t\t\"es\": \"Verificación de Lindorm en VPC\",\n\t\t\"fr\": \"Vérification de Lindorm dans VPC\",\n\t\t\"pt\": \"Verificação de Lindorm em VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Lindorm instances are deployed within a VPC.\",\n\t\t\"zh\": \"确保 Lindorm 实例部署在 VPC 内。\",\n\t\t\"ja\": \"Lindorm インスタンスが VPC 内に展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Lindorm-Instanzen innerhalb eines VPC bereitgestellt werden.\",\n\t\t\"es\": \"Garantiza que las instancias Lindorm se desplieguen dentro de una VPC.\",\n\t\t\"fr\": \"Garantit que les instances Lindorm sont déployées dans un VPC.\",\n\t\t\"pt\": \"Garante que as instâncias Lindorm sejam implantadas dentro de uma VPC.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Deploying in a VPC provides better network isolation and security.\",\n\t\t\"zh\": \"在 VPC 中部署可提供更好的网络隔离和安全性。\",\n\t\t\"ja\": \"VPC に展開することで、より優れたネットワーク分離とセキュリティが提供されます。\",\n\t\t\"de\": \"Die Bereitstellung in einem VPC bietet bessere Netzwerkisolation und Sicherheit.\",\n\t\t\"es\": \"Desplegar en una VPC proporciona mejor aislamiento de red y seguridad.\",\n\t\t\"fr\": \"Le déploiement dans un VPC offre une meilleure isolation réseau et sécurité.\",\n\t\t\"pt\": \"Implantar em uma VPC fornece melhor isolamento de rede e segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Create Lindorm instances within a VPC.\",\n\t\t\"zh\": \"在 VPC 内创建 Lindorm 实例。\",\n\t\t\"ja\": \"VPC 内に Lindorm インスタンスを作成します。\",\n\t\t\"de\": \"Erstellen Sie Lindorm-Instanzen innerhalb eines VPC.\",\n\t\t\"es\": \"Cree instancias Lindorm dentro de una VPC.\",\n\t\t\"fr\": \"Créez des instances Lindorm dans un VPC.\",\n\t\t\"pt\": \"Crie instâncias Lindorm dentro de uma VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::Lindorm::Instance\"]\n}\n\nis_compliant(resource) if {\n\tvpc_id := helpers.get_property(resource, \"VpcId\", \"\")\n\tvpc_id != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::Lindorm::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:lindorm-instance-multi-zone", Name: models.I18nString{"de": "Lindorm-Instanz Multi-Zone-Bereitstellung", "en": "Lindorm Instance Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Instancia Lindorm", "fr": "Déploiement Multi-Zone d'Instance Lindorm", "ja": "Lindorm インスタンスマルチゾーン展開", "pt": "Implantações Multi-Zona de Instância Lindorm", "zh": "使用多可用区的云原生多模数据库 Lindorm 实例"}, Severity: "medium", Description: models.I18nString{"de": "Lindorm-Instanzen sollten für Multi-Zone-Bereitstellung mit mindestens 4 LindormTable-Knoten für Hochverfügbarkeit konfiguriert werden.", "en": "Lindorm instances should be configured for multi-zone deployment with at least 4 LindormTable nodes for high availability.", "es": "Las instancias Lindorm deben configurarse para despliegue multi-zona con al menos 4 nodos LindormTable para alta disponibilidad.", "fr": "Les instances Lindorm doivent être configurées pour un déploiement multi-zone avec au moins 4 nœuds LindormTable pour une haute disponibilité.", "ja": "Lindorm インスタンスは、高可用性のために少なくとも 4 つの LindormTable ノードでマルチゾーン展開用に設定する必要があります。", "pt": "As instâncias Lindorm devem ser configuradas para implantação multi-zona com pelo menos 4 nós LindormTable para alta disponibilidade.", "zh": "使用多可用区的云原生多模数据库 Lindorm 实例，视为合规。"}, Reason: models.I18nString{"de": "Die Lindorm-Instanz erfüllt nicht die Multi-Zone-Bereitstellungsanforderungen (LindormNum < 4).", "en": "The Lindorm instance does not meet the multi-zone deployment requirements (LindormNum < 4).", "es": "La instancia Lindorm no cumple con los requisitos de despliegue multi-zona (LindormNum < 4).", "fr": "L'instance Lindorm ne répond pas aux exigences de déploiement multi-zone (LindormNum < 4).", "ja": "Lindorm インスタンスがマルチゾーン展開要件（LindormNum < 4）を満たしていません。", "pt": "A instância Lindorm não atende aos requisitos de implantação multi-zona (LindormNum < 4).", "zh": "Lindorm 实例不满足多可用区部署要求（LindormNum < 4）。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie mindestens 4 LindormTable-Knoten, indem Sie LindormNum auf 4 oder mehr setzen, um Multi-Zone-Bereitstellung zu aktivieren.", "en": "Configure at least 4 LindormTable nodes by setting LindormNum to 4 or more to enable multi-zone deployment.", "es": "Configure al menos 4 nodos LindormTable estableciendo LindormNum en 4 o más para habilitar el despliegue multi-zona.", "fr": "Configurez au moins 4 nœuds LindormTable en définissant LindormNum sur 4 ou plus pour activer le déploiement multi-zone.", "ja": "LindormNum を 4 以上に設定して、少なくとも 4 つの LindormTable ノードを設定し、マルチゾーン展開を有効にします。", "pt": "Configure pelo menos 4 nós LindormTable definindo LindormNum como 4 ou mais para habilitar a implantação multi-zona.", "zh": "通过将 LindormNum 设置为 4 或更多来配置至少 4 个 LindormTable 节点，以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::Lindorm::Instance"}, FilePath: "aliyun/rules/lindorm-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.lindorm_instance_multi_zone", Content: "package infraguard.rules.aliyun.lindorm_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"lindorm-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Lindorm Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的云原生多模数据库 Lindorm 实例\",\n\t\t\"ja\": \"Lindorm インスタンスマルチゾーン展開\",\n\t\t\"de\": \"Lindorm-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Instancia Lindorm\",\n\t\t\"fr\": \"Déploiement Multi-Zone d'Instance Lindorm\",\n\t\t\"pt\": \"Implantações Multi-Zona de Instância Lindorm\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Lindorm instances should be configured for multi-zone deployment with at least 4 LindormTable nodes for high availability.\",\n\t\t\"zh\": \"使用多可用区的云原生多模数据库 Lindorm 实例，视为合规。\",\n\t\t\"ja\": \"Lindorm インスタンスは、高可用性のために少なくとも 4 つの LindormTable ノードでマルチゾーン展開用に設定する必要があります。\",\n\t\t\"de\": \"Lindorm-Instanzen sollten für Multi-Zone-Bereitstellung mit mindestens 4 LindormTable-Knoten für Hochverfügbarkeit konfiguriert werden.\",\n\t\t\"es\": \"Las instancias Lindorm deben configurarse para despliegue multi-zona con al menos 4 nodos LindormTable para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances Lindorm doivent être configurées pour un déploiement multi-zone avec au moins 4 nœuds LindormTable pour une haute disponibilité.\",\n\t\t\"pt\": \"As instâncias Lindorm devem ser configuradas para implantação multi-zona com pelo menos 4 nós LindormTable para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The Lindorm instance does not meet the multi-zone deployment requirements (LindormNum < 4).\",\n\t\t\"zh\": \"Lindorm 实例不满足多可用区部署要求（LindormNum < 4）。\",\n\t\t\"ja\": \"Lindorm インスタンスがマルチゾーン展開要件（LindormNum < 4）を満たしていません。\",\n\t\t\"de\": \"Die Lindorm-Instanz erfüllt nicht die Multi-Zone-Bereitstellungsanforderungen (LindormNum < 4).\",\n\t\t\"es\": \"La instancia Lindorm no cumple con los requisitos de despliegue multi-zona (LindormNum < 4).\",\n\t\t\"fr\": \"L'instance Lindorm ne répond pas aux exigences de déploiement multi-zone (LindormNum < 4).\",\n\t\t\"pt\": \"A instância Lindorm não atende aos requisitos de implantação multi-zona (LindormNum < 4).\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure at least 4 LindormTable nodes by setting LindormNum to 4 or more to enable multi-zone deployment.\",\n\t\t\"zh\": \"通过将 LindormNum 设置为 4 或更多来配置至少 4 个 LindormTable 节点，以启用多可用区部署。\",\n\t\t\"ja\": \"LindormNum を 4 以上に設定して、少なくとも 4 つの LindormTable ノードを設定し、マルチゾーン展開を有効にします。\",\n\t\t\"de\": \"Konfigurieren Sie mindestens 4 LindormTable-Knoten, indem Sie LindormNum auf 4 oder mehr setzen, um Multi-Zone-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure al menos 4 nodos LindormTable estableciendo LindormNum en 4 o más para habilitar el despliegue multi-zona.\",\n\t\t\"fr\": \"Configurez au moins 4 nœuds LindormTable en définissant LindormNum sur 4 ou plus pour activer le déploiement multi-zone.\",\n\t\t\"pt\": \"Configure pelo menos 4 nós LindormTable definindo LindormNum como 4 ou mais para habilitar a implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::Lindorm::Instance\"]\n}\n\n# Check if instance is multi-zone (requires LindormNum >= 4)\nis_multi_zone(resource) if {\n\thelpers.has_property(resource, \"LindormNum\")\n\tlindorm_num := resource.Properties.LindormNum\n\tlindorm_num >= 4\n}\n\n# Deny rule: Lindorm instances should be multi-zone\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::Lindorm::Instance\")\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LindormNum\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:maxcompute-project-encryption-enabled", Name: models.I18nString{"de": "MaxCompute-Projekt Verschlüsselung aktiviert", "en": "MaxCompute Project Encryption Enabled", "es": "Cifrado de Proyecto MaxCompute Habilitado", "fr": "Chiffrement de Projet MaxCompute Activé", "ja": "MaxCompute プロジェクト暗号化が有効", "pt": "Criptografia de Projeto MaxCompute Habilitada", "zh": "MaxCompute 项目开启加密"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MaxCompute-Projekte Verschlüsselung aktiviert haben, um gespeicherte Daten zu schützen.", "en": "Ensures MaxCompute projects have encryption enabled to protect stored data.", "es": "Garantiza que los proyectos MaxCompute tengan cifrado habilitado para proteger los datos almacenados.", "fr": "Garantit que les projets MaxCompute ont le chiffrement activé pour protéger les données stockées.", "ja": "MaxCompute プロジェクトで保存データを保護するために暗号化が有効になっていることを確認します。", "pt": "Garante que os projetos MaxCompute tenham criptografia habilitada para proteger dados armazenados.", "zh": "确保 MaxCompute 项目启用了加密以保护存储的数据。"}, Reason: models.I18nString{"de": "Verschlüsselung schützt sensible Daten, die in MaxCompute-Projekten gespeichert sind, vor unbefugtem Zugriff.", "en": "Encryption protects sensitive data stored in MaxCompute projects from unauthorized access.", "es": "El cifrado protege los datos sensibles almacenados en proyectos MaxCompute del acceso no autorizado.", "fr": "Le chiffrement protège les données sensibles stockées dans les projets MaxCompute contre l'accès non autorisé.", "ja": "暗号化により、MaxCompute プロジェクトに保存されている機密データが不正アクセスから保護されます。", "pt": "A criptografia protege dados sensíveis armazenados em projetos MaxCompute contra acesso não autorizado.", "zh": "加密可以保护 MaxCompute 项目中存储的敏感数据免受非授权访问。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Verschlüsselung für das MaxCompute-Projekt.", "en": "Enable encryption for the MaxCompute project.", "es": "Habilite el cifrado para el proyecto MaxCompute.", "fr": "Activez le chiffrement pour le projet MaxCompute.", "ja": "MaxCompute プロジェクトの暗号化を有効にします。", "pt": "Habilite a criptografia para o projeto MaxCompute.", "zh": "为 MaxCompute 项目启用加密。"}, ResourceTypes: []string{"ALIYUN::MaxCompute::Project"}, FilePath: "aliyun/rules/maxcompute-project-encryption-enabled.rego", PackageName: "infraguard.rules.aliyun.maxcompute_project_encryption_enabled", Content: "package infraguard.rules.aliyun.maxcompute_project_encryption_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"maxcompute-project-encryption-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MaxCompute Project Encryption Enabled\",\n\t\t\"zh\": \"MaxCompute 项目开启加密\",\n\t\t\"ja\": \"MaxCompute プロジェクト暗号化が有効\",\n\t\t\"de\": \"MaxCompute-Projekt Verschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado de Proyecto MaxCompute Habilitado\",\n\t\t\"fr\": \"Chiffrement de Projet MaxCompute Activé\",\n\t\t\"pt\": \"Criptografia de Projeto MaxCompute Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MaxCompute projects have encryption enabled to protect stored data.\",\n\t\t\"zh\": \"确保 MaxCompute 项目启用了加密以保护存储的数据。\",\n\t\t\"ja\": \"MaxCompute プロジェクトで保存データを保護するために暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MaxCompute-Projekte Verschlüsselung aktiviert haben, um gespeicherte Daten zu schützen.\",\n\t\t\"es\": \"Garantiza que los proyectos MaxCompute tengan cifrado habilitado para proteger los datos almacenados.\",\n\t\t\"fr\": \"Garantit que les projets MaxCompute ont le chiffrement activé pour protéger les données stockées.\",\n\t\t\"pt\": \"Garante que os projetos MaxCompute tenham criptografia habilitada para proteger dados armazenados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Encryption protects sensitive data stored in MaxCompute projects from unauthorized access.\",\n\t\t\"zh\": \"加密可以保护 MaxCompute 项目中存储的敏感数据免受非授权访问。\",\n\t\t\"ja\": \"暗号化により、MaxCompute プロジェクトに保存されている機密データが不正アクセスから保護されます。\",\n\t\t\"de\": \"Verschlüsselung schützt sensible Daten, die in MaxCompute-Projekten gespeichert sind, vor unbefugtem Zugriff.\",\n\t\t\"es\": \"El cifrado protege los datos sensibles almacenados en proyectos MaxCompute del acceso no autorizado.\",\n\t\t\"fr\": \"Le chiffrement protège les données sensibles stockées dans les projets MaxCompute contre l'accès non autorisé.\",\n\t\t\"pt\": \"A criptografia protege dados sensíveis armazenados em projetos MaxCompute contra acesso não autorizado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable encryption for the MaxCompute project.\",\n\t\t\"zh\": \"为 MaxCompute 项目启用加密。\",\n\t\t\"ja\": \"MaxCompute プロジェクトの暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Verschlüsselung für das MaxCompute-Projekt.\",\n\t\t\"es\": \"Habilite el cifrado para el proyecto MaxCompute.\",\n\t\t\"fr\": \"Activez le chiffrement pour le projet MaxCompute.\",\n\t\t\"pt\": \"Habilite a criptografia para o projeto MaxCompute.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MaxCompute::Project\"]\n}\n\n# Check if encryption is enabled\nis_compliant(resource) if {\n\t# Direct access to nested properties\n\tprops := resource.Properties.Properties\n\tprops != null\n\tencryption := props.Encryption\n\tencryption != null\n\tencryption.Enable == true\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MaxCompute::Project\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Encryption\", \"Enable\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:maxcompute-project-ip-whitelist-enabled", Name: models.I18nString{"de": "MaxCompute-Projekt IP-Whitelist aktiviert", "en": "MaxCompute Project IP Whitelist Enabled", "es": "Lista Blanca de IP del Proyecto MaxCompute Habilitada", "fr": "Liste Blanche IP du Projet MaxCompute Activée", "ja": "MaxCompute プロジェクトの IP ホワイトリストが有効", "pt": "Lista Branca de IP do Projeto MaxCompute Habilitada", "zh": "MaxCompute 项目开启 IP 白名单"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MaxCompute-Projekte eine IP-Whitelist konfiguriert haben, um den Zugriff einzuschränken.", "en": "Ensures MaxCompute projects have an IP whitelist configured to restrict access.", "es": "Garantiza que los proyectos MaxCompute tengan una lista blanca de IP configurada para restringir el acceso.", "fr": "Garantit que les projets MaxCompute ont une liste blanche IP configurée pour restreindre l'accès.", "ja": "MaxCompute プロジェクトにアクセスを制限する IP ホワイトリストが設定されていることを確認します。", "pt": "Garante que os projetos MaxCompute tenham uma lista branca de IP configurada para restringir o acesso.", "zh": "确保 MaxCompute 项目配置了 IP 白名单以限制访问。"}, Reason: models.I18nString{"de": "Die Einschränkung des Zugriffs auf vertrauenswürdige IPs verhindert nicht autorisierten Datenzugriff über das Netzwerk.", "en": "Restricting access to trusted IPs prevents unauthorized data access over the network.", "es": "Restringir el acceso a IPs de confianza previene el acceso no autorizado a datos a través de la red.", "fr": "Restreindre l'accès aux IP de confiance empêche l'accès non autorisé aux données sur le réseau.", "ja": "信頼できる IP へのアクセスを制限することで、ネットワーク経由の不正なデータアクセスを防ぎます。", "pt": "Restringir o acesso a IPs confiáveis impede o acesso não autorizado a dados pela rede.", "zh": "限制可信 IP 访问可防止网络上的非授权数据访问。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die IP-Whitelist für das MaxCompute-Projekt.", "en": "Configure the IP whitelist for the MaxCompute project.", "es": "Configure la lista blanca de IP para el proyecto MaxCompute.", "fr": "Configurez la liste blanche IP pour le projet MaxCompute.", "ja": "MaxCompute プロジェクトに IP ホワイトリストを設定します。", "pt": "Configure a lista branca de IP para o projeto MaxCompute.", "zh": "为 MaxCompute 项目配置 IP 白名单。"}, ResourceTypes: []string{"ALIYUN::MaxCompute::Project"}, FilePath: "aliyun/rules/maxcompute-project-ip-whitelist-enabled.rego", PackageName: "infraguard.rules.aliyun.maxcompute_project_ip_whitelist_enabled", Content: "package infraguard.rules.aliyun.maxcompute_project_ip_whitelist_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"maxcompute-project-ip-whitelist-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MaxCompute Project IP Whitelist Enabled\",\n\t\t\"zh\": \"MaxCompute 项目开启 IP 白名单\",\n\t\t\"ja\": \"MaxCompute プロジェクトの IP ホワイトリストが有効\",\n\t\t\"de\": \"MaxCompute-Projekt IP-Whitelist aktiviert\",\n\t\t\"es\": \"Lista Blanca de IP del Proyecto MaxCompute Habilitada\",\n\t\t\"fr\": \"Liste Blanche IP du Projet MaxCompute Activée\",\n\t\t\"pt\": \"Lista Branca de IP do Projeto MaxCompute Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MaxCompute projects have an IP whitelist configured to restrict access.\",\n\t\t\"zh\": \"确保 MaxCompute 项目配置了 IP 白名单以限制访问。\",\n\t\t\"ja\": \"MaxCompute プロジェクトにアクセスを制限する IP ホワイトリストが設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MaxCompute-Projekte eine IP-Whitelist konfiguriert haben, um den Zugriff einzuschränken.\",\n\t\t\"es\": \"Garantiza que los proyectos MaxCompute tengan una lista blanca de IP configurada para restringir el acceso.\",\n\t\t\"fr\": \"Garantit que les projets MaxCompute ont une liste blanche IP configurée pour restreindre l'accès.\",\n\t\t\"pt\": \"Garante que os projetos MaxCompute tenham uma lista branca de IP configurada para restringir o acesso.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Restricting access to trusted IPs prevents unauthorized data access over the network.\",\n\t\t\"zh\": \"限制可信 IP 访问可防止网络上的非授权数据访问。\",\n\t\t\"ja\": \"信頼できる IP へのアクセスを制限することで、ネットワーク経由の不正なデータアクセスを防ぎます。\",\n\t\t\"de\": \"Die Einschränkung des Zugriffs auf vertrauenswürdige IPs verhindert nicht autorisierten Datenzugriff über das Netzwerk.\",\n\t\t\"es\": \"Restringir el acceso a IPs de confianza previene el acceso no autorizado a datos a través de la red.\",\n\t\t\"fr\": \"Restreindre l'accès aux IP de confiance empêche l'accès non autorisé aux données sur le réseau.\",\n\t\t\"pt\": \"Restringir o acesso a IPs confiáveis impede o acesso não autorizado a dados pela rede.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the IP whitelist for the MaxCompute project.\",\n\t\t\"zh\": \"为 MaxCompute 项目配置 IP 白名单。\",\n\t\t\"ja\": \"MaxCompute プロジェクトに IP ホワイトリストを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie die IP-Whitelist für das MaxCompute-Projekt.\",\n\t\t\"es\": \"Configure la lista blanca de IP para el proyecto MaxCompute.\",\n\t\t\"fr\": \"Configurez la liste blanche IP pour le projet MaxCompute.\",\n\t\t\"pt\": \"Configure a lista branca de IP para o projeto MaxCompute.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MaxCompute::Project\"]\n}\n\nis_compliant(resource) if {\n\t# Check for a property like 'IpWhiteList' in ROS\n\thelpers.has_property(resource, \"IpWhiteList\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MaxCompute::Project\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:metadata-ros-composer-check", Name: models.I18nString{"de": "Vorlagen-Metadaten ALIYUN::ROS::Composer Prüfung", "en": "Template Metadata ALIYUN::ROS::Composer Check", "es": "Verificación de Metadatos de Plantilla ALIYUN::ROS::Composer", "fr": "Vérification des Métadonnées de Modèle ALIYUN::ROS::Composer", "ja": "テンプレートメタデータ ALIYUN::ROS::Composer チェック", "pt": "Verificação de Metadados de Modelo ALIYUN::ROS::Composer", "zh": "模板 Metadata ALIYUN::ROS::Composer 检查"}, Severity: "low", Description: models.I18nString{"de": "Vorlage muss Metadata.ALIYUN::ROS::Composer konfiguriert haben. Der Wert muss ein Wörterbuch (Objekt) sein.", "en": "Template must have Metadata.ALIYUN::ROS::Composer configured. The value must be a dictionary (object).", "es": "La plantilla debe tener Metadata.ALIYUN::ROS::Composer configurado. El valor debe ser un diccionario (objeto).", "fr": "Le modèle doit avoir Metadata.ALIYUN::ROS::Composer configuré. La valeur doit être un dictionnaire (objet).", "ja": "テンプレートには Metadata.ALIYUN::ROS::Composer が設定されている必要があります。値は辞書（オブジェクト）である必要があります。", "pt": "O modelo deve ter Metadata.ALIYUN::ROS::Composer configurado. O valor deve ser um dicionário (objeto).", "zh": "模板必须配置 Metadata.ALIYUN::ROS::Composer。该值必须是字典（对象）类型。"}, Reason: models.I18nString{"de": "ALIYUN::ROS::Composer fehlt oder ist ungültig. Es muss als Wörterbuch konfiguriert werden.", "en": "ALIYUN::ROS::Composer is missing or invalid. It must be configured as a dictionary.", "es": "ALIYUN::ROS::Composer falta o no es válido. Debe configurarse como un diccionario.", "fr": "ALIYUN::ROS::Composer est manquant ou invalide. Il doit être configuré comme un dictionnaire.", "ja": "ALIYUN::ROS::Composer が欠落しているか無効です。辞書として設定する必要があります。", "pt": "ALIYUN::ROS::Composer está ausente ou inválido. Deve ser configurado como um dicionário.", "zh": "ALIYUN::ROS::Composer 缺失或格式无效。必须配置为字典类型。"}, Recommendation: models.I18nString{"de": "Verwenden Sie ROS Composer (https://ros.console.aliyun.com/composer), um Ihre Vorlage zu importieren, das Architekturdiagramm zu konfigurieren, und die Composer-Metadaten werden automatisch generiert.", "en": "Use ROS Composer (https://ros.console.aliyun.com/composer) to import your template, configure the architecture diagram, and the composer metadata will be automatically generated.", "es": "Use ROS Composer (https://ros.console.aliyun.com/composer) para importar su plantilla, configurar el diagrama de arquitectura, y los metadatos del compositor se generarán automáticamente.", "fr": "Utilisez ROS Composer (https://ros.console.aliyun.com/composer) pour importer votre modèle, configurer le diagramme d'architecture, et les métadonnées du compositeur seront automatiquement générées.", "ja": "ROS Composer（https://ros.console.aliyun.com/composer）を使用してテンプレートをインポートし、アーキテクチャ図を設定すると、composer メタデータが自動生成されます。", "pt": "Use o ROS Composer (https://ros.console.aliyun.com/composer) para importar seu modelo, configurar o diagrama de arquitetura, e os metadados do compositor serão gerados automaticamente.", "zh": "使用 ROS 架构编辑器（https://ros.console.aliyun.com/composer）导入模板并配置架构图，系统将自动生成 composer 元数据信息。"}, ResourceTypes: []string{}, FilePath: "aliyun/rules/metadata-ros-composer-check.rego", PackageName: "infraguard.rules.aliyun.metadata_ros_composer_check", Content: "package infraguard.rules.aliyun.metadata_ros_composer_check\n\nimport rego.v1\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"metadata-ros-composer-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"Template Metadata ALIYUN::ROS::Composer Check\",\n\t\t\"zh\": \"模板 Metadata ALIYUN::ROS::Composer 检查\",\n\t\t\"ja\": \"テンプレートメタデータ ALIYUN::ROS::Composer チェック\",\n\t\t\"de\": \"Vorlagen-Metadaten ALIYUN::ROS::Composer Prüfung\",\n\t\t\"es\": \"Verificación de Metadatos de Plantilla ALIYUN::ROS::Composer\",\n\t\t\"fr\": \"Vérification des Métadonnées de Modèle ALIYUN::ROS::Composer\",\n\t\t\"pt\": \"Verificação de Metadados de Modelo ALIYUN::ROS::Composer\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Template must have Metadata.ALIYUN::ROS::Composer configured. The value must be a dictionary (object).\",\n\t\t\"zh\": \"模板必须配置 Metadata.ALIYUN::ROS::Composer。该值必须是字典（对象）类型。\",\n\t\t\"ja\": \"テンプレートには Metadata.ALIYUN::ROS::Composer が設定されている必要があります。値は辞書（オブジェクト）である必要があります。\",\n\t\t\"de\": \"Vorlage muss Metadata.ALIYUN::ROS::Composer konfiguriert haben. Der Wert muss ein Wörterbuch (Objekt) sein.\",\n\t\t\"es\": \"La plantilla debe tener Metadata.ALIYUN::ROS::Composer configurado. El valor debe ser un diccionario (objeto).\",\n\t\t\"fr\": \"Le modèle doit avoir Metadata.ALIYUN::ROS::Composer configuré. La valeur doit être un dictionnaire (objet).\",\n\t\t\"pt\": \"O modelo deve ter Metadata.ALIYUN::ROS::Composer configurado. O valor deve ser um dicionário (objeto).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"ALIYUN::ROS::Composer is missing or invalid. It must be configured as a dictionary.\",\n\t\t\"zh\": \"ALIYUN::ROS::Composer 缺失或格式无效。必须配置为字典类型。\",\n\t\t\"ja\": \"ALIYUN::ROS::Composer が欠落しているか無効です。辞書として設定する必要があります。\",\n\t\t\"de\": \"ALIYUN::ROS::Composer fehlt oder ist ungültig. Es muss als Wörterbuch konfiguriert werden.\",\n\t\t\"es\": \"ALIYUN::ROS::Composer falta o no es válido. Debe configurarse como un diccionario.\",\n\t\t\"fr\": \"ALIYUN::ROS::Composer est manquant ou invalide. Il doit être configuré comme un dictionnaire.\",\n\t\t\"pt\": \"ALIYUN::ROS::Composer está ausente ou inválido. Deve ser configurado como um dicionário.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use ROS Composer (https://ros.console.aliyun.com/composer) to import your template, configure the architecture diagram, and the composer metadata will be automatically generated.\",\n\t\t\"zh\": \"使用 ROS 架构编辑器（https://ros.console.aliyun.com/composer）导入模板并配置架构图，系统将自动生成 composer 元数据信息。\",\n\t\t\"ja\": \"ROS Composer（https://ros.console.aliyun.com/composer）を使用してテンプレートをインポートし、アーキテクチャ図を設定すると、composer メタデータが自動生成されます。\",\n\t\t\"de\": \"Verwenden Sie ROS Composer (https://ros.console.aliyun.com/composer), um Ihre Vorlage zu importieren, das Architekturdiagramm zu konfigurieren, und die Composer-Metadaten werden automatisch generiert.\",\n\t\t\"es\": \"Use ROS Composer (https://ros.console.aliyun.com/composer) para importar su plantilla, configurar el diagrama de arquitectura, y los metadatos del compositor se generarán automáticamente.\",\n\t\t\"fr\": \"Utilisez ROS Composer (https://ros.console.aliyun.com/composer) pour importer votre modèle, configurer le diagramme d'architecture, et les métadonnées du compositeur seront automatiquement générées.\",\n\t\t\"pt\": \"Use o ROS Composer (https://ros.console.aliyun.com/composer) para importar seu modelo, configurar o diagrama de arquitetura, e os metadados do compositor serão gerados automaticamente.\"\n\t},\n\t\"resource_types\": []\n}\n\n# Check if ALIYUN::ROS::Composer exists and is valid\nhas_valid_composer if {\n\t# Check if Metadata exists\n\tinput.Metadata != null\n\n\t# Check if ALIYUN::ROS::Composer exists in Metadata\n\tcomposer := object.get(input.Metadata, \"ALIYUN::ROS::Composer\", null)\n\tcomposer != null\n\n\t# Must be an object (dictionary)\n\tis_object(composer)\n}\n\n# Check template Metadata\ndeny contains result if {\n\t# Check if Metadata exists\n\tinput.Metadata == null\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": \"\",\n\t\t\"violation_path\": [\"Metadata\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\t# Check if Metadata exists\n\tinput.Metadata != null\n\n\t# Check if ALIYUN::ROS::Composer is missing\n\tobject.get(input.Metadata, \"ALIYUN::ROS::Composer\", null) == null\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": \"\",\n\t\t\"violation_path\": [\"Metadata\", \"ALIYUN::ROS::Composer\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\t# Check if Metadata exists\n\tinput.Metadata != null\n\n\t# Check if ALIYUN::ROS::Composer exists\n\tcomposer := object.get(input.Metadata, \"ALIYUN::ROS::Composer\", null)\n\tcomposer != null\n\n\t# Check if ALIYUN::ROS::Composer is not an object\n\tnot is_object(composer)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": \"\",\n\t\t\"violation_path\": [\"Metadata\", \"ALIYUN::ROS::Composer\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-cluster-expired-check", Name: models.I18nString{"de": "MongoDB-Instanz-Ablaufprüfung", "en": "MongoDB Instance Expiration Check", "es": "Verificación de Expiración de Instancia MongoDB", "fr": "Vérification d'Expiration de l'Instance MongoDB", "ja": "MongoDB インスタンスの有効期限チェック", "pt": "Verificação de Expiração da Instância MongoDB", "zh": "MongoDB 实例到期检查"}, Severity: "high", Description: models.I18nString{"de": "Vorausbezahlte MongoDB-Instanzen sollten automatische Verlängerung aktiviert haben.", "en": "Prepaid MongoDB instances should have auto-renewal enabled.", "es": "Las instancias MongoDB prepagadas deben tener renovación automática habilitada.", "fr": "Les instances MongoDB prépayées doivent avoir le renouvellement automatique activé.", "ja": "プリペイド MongoDB インスタンスで自動更新が有効になっている必要があります。", "pt": "As instâncias MongoDB pré-pagas devem ter renovação automática habilitada.", "zh": "预付费 MongoDB 实例应开启自动续费，避免业务中断。"}, Reason: models.I18nString{"de": "Die vorausbezahlte MongoDB-Instanz hat keine automatische Verlängerung aktiviert.", "en": "The prepaid MongoDB instance does not have auto-renewal enabled.", "es": "La instancia MongoDB prepagada no tiene renovación automática habilitada.", "fr": "L'instance MongoDB prépayée n'a pas le renouvellement automatique activé.", "ja": "プリペイド MongoDB インスタンスで自動更新が有効になっていません。", "pt": "A instância MongoDB pré-paga não tem renovação automática habilitada.", "zh": "预付费 MongoDB 实例未开启自动续费。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Verlängerung für die vorausbezahlte MongoDB-Instanz, indem Sie AutoRenew auf true setzen.", "en": "Enable auto-renewal for the prepaid MongoDB instance by setting AutoRenew to true.", "es": "Habilite la renovación automática para la instancia MongoDB prepagada estableciendo AutoRenew en true.", "fr": "Activez le renouvellement automatique pour l'instance MongoDB prépayée en définissant AutoRenew sur true.", "ja": "AutoRenew を true に設定して、プリペイド MongoDB インスタンスの自動更新を有効にします。", "pt": "Habilite a renovação automática para a instância MongoDB pré-paga definindo AutoRenew como true.", "zh": "通过将 AutoRenew 设置为 true 为预付费 MongoDB 实例开启自动续费。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-cluster-expired-check.rego", PackageName: "infraguard.rules.aliyun.mongodb_cluster_expired_check", Content: "package infraguard.rules.aliyun.mongodb_cluster_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-cluster-expired-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance Expiration Check\",\n\t\t\"zh\": \"MongoDB 实例到期检查\",\n\t\t\"ja\": \"MongoDB インスタンスの有効期限チェック\",\n\t\t\"de\": \"MongoDB-Instanz-Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Instancia MongoDB\",\n\t\t\"fr\": \"Vérification d'Expiration de l'Instance MongoDB\",\n\t\t\"pt\": \"Verificação de Expiração da Instância MongoDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Prepaid MongoDB instances should have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 MongoDB 实例应开启自动续费，避免业务中断。\",\n\t\t\"ja\": \"プリペイド MongoDB インスタンスで自動更新が有効になっている必要があります。\",\n\t\t\"de\": \"Vorausbezahlte MongoDB-Instanzen sollten automatische Verlängerung aktiviert haben.\",\n\t\t\"es\": \"Las instancias MongoDB prepagadas deben tener renovación automática habilitada.\",\n\t\t\"fr\": \"Les instances MongoDB prépayées doivent avoir le renouvellement automatique activé.\",\n\t\t\"pt\": \"As instâncias MongoDB pré-pagas devem ter renovação automática habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The prepaid MongoDB instance does not have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 MongoDB 实例未开启自动续费。\",\n\t\t\"ja\": \"プリペイド MongoDB インスタンスで自動更新が有効になっていません。\",\n\t\t\"de\": \"Die vorausbezahlte MongoDB-Instanz hat keine automatische Verlängerung aktiviert.\",\n\t\t\"es\": \"La instancia MongoDB prepagada no tiene renovación automática habilitada.\",\n\t\t\"fr\": \"L'instance MongoDB prépayée n'a pas le renouvellement automatique activé.\",\n\t\t\"pt\": \"A instância MongoDB pré-paga não tem renovação automática habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for the prepaid MongoDB instance by setting AutoRenew to true.\",\n\t\t\"zh\": \"通过将 AutoRenew 设置为 true 为预付费 MongoDB 实例开启自动续费。\",\n\t\t\"ja\": \"AutoRenew を true に設定して、プリペイド MongoDB インスタンスの自動更新を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die automatische Verlängerung für die vorausbezahlte MongoDB-Instanz, indem Sie AutoRenew auf true setzen.\",\n\t\t\"es\": \"Habilite la renovación automática para la instancia MongoDB prepagada estableciendo AutoRenew en true.\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour l'instance MongoDB prépayée en définissant AutoRenew sur true.\",\n\t\t\"pt\": \"Habilite a renovação automática para a instância MongoDB pré-paga definindo AutoRenew como true.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\nis_prepaid(resource) if {\n\thelpers.get_property(resource, \"ChargeType\", \"PostPaid\") == \"PrePaid\"\n}\n\nis_auto_renew_enabled(resource) if {\n\tauto_renew := helpers.get_property(resource, \"AutoRenew\", false)\n\thelpers.is_true(auto_renew)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tis_prepaid(resource)\n\tnot is_auto_renew_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AutoRenew\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-instance-class-not-shared", Name: models.I18nString{"de": "MongoDB-Instanz verwendet dedizierte Klasse", "en": "MongoDB Instance Uses Dedicated Class", "es": "Instancia MongoDB Usa Clase Dedicada", "fr": "L'Instance MongoDB Utilise une Classe Dédiée", "ja": "MongoDB インスタンスが専用クラスを使用", "pt": "Instância MongoDB Usa Classe Dedicada", "zh": "MongoDB 使用独享型或专属型规格实例"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen dedizierte oder exklusive Instanzklassen verwenden, keine gemeinsam genutzten Instanzen.", "en": "Ensures MongoDB instances use dedicated or exclusive instance classes, not shared instances.", "es": "Garantiza que las instancias MongoDB usen clases de instancia dedicadas o exclusivas, no instancias compartidas.", "fr": "Garantit que les instances MongoDB utilisent des classes d'instance dédiées ou exclusives, et non des instances partagées.", "ja": "MongoDB インスタンスが共有インスタンスではなく、専用または専属インスタンスクラスを使用していることを確認します。", "pt": "Garante que as instâncias MongoDB usem classes de instância dedicadas ou exclusivas, não instâncias compartilhadas.", "zh": "确保 MongoDB 实例使用独享型或专属型规格实例，而非共享型实例。"}, Reason: models.I18nString{"de": "Gemeinsam genutzte Instanzklassen können Ressourcenkonfliktprobleme haben, die die Datenbankleistung und -stabilität beeinträchtigen.", "en": "Shared instance classes may have resource contention issues, affecting database performance and stability.", "es": "Las clases de instancia compartidas pueden tener problemas de contención de recursos, afectando el rendimiento y la estabilidad de la base de datos.", "fr": "Les classes d'instance partagées peuvent avoir des problèmes de contention de ressources, affectant les performances et la stabilité de la base de données.", "ja": "共有インスタンスクラスにはリソース競合の問題があり、データベースのパフォーマンスと安定性に影響を与える可能性があります。", "pt": "As classes de instância compartilhadas podem ter problemas de contenção de recursos, afetando o desempenho e a estabilidade do banco de dados.", "zh": "共享型实例规格可能存在资源争用问题，影响数据库性能和稳定性。"}, Recommendation: models.I18nString{"de": "Verwenden Sie dedizierte oder exklusive Instanzklassen für MongoDB-Instanzen.", "en": "Use dedicated or exclusive instance classes for MongoDB instances.", "es": "Use clases de instancia dedicadas o exclusivas para instancias MongoDB.", "fr": "Utilisez des classes d'instance dédiées ou exclusives pour les instances MongoDB.", "ja": "MongoDB インスタンスに専用または専属インスタンスクラスを使用します。", "pt": "Use classes de instância dedicadas ou exclusivas para instâncias MongoDB.", "zh": "为 MongoDB 实例使用独享型或专属型规格实例。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-instance-class-not-shared.rego", PackageName: "infraguard.rules.aliyun.mongodb_instance_class_not_shared", Content: "package infraguard.rules.aliyun.mongodb_instance_class_not_shared\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-instance-class-not-shared\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance Uses Dedicated Class\",\n\t\t\"zh\": \"MongoDB 使用独享型或专属型规格实例\",\n\t\t\"ja\": \"MongoDB インスタンスが専用クラスを使用\",\n\t\t\"de\": \"MongoDB-Instanz verwendet dedizierte Klasse\",\n\t\t\"es\": \"Instancia MongoDB Usa Clase Dedicada\",\n\t\t\"fr\": \"L'Instance MongoDB Utilise une Classe Dédiée\",\n\t\t\"pt\": \"Instância MongoDB Usa Classe Dedicada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB instances use dedicated or exclusive instance classes, not shared instances.\",\n\t\t\"zh\": \"确保 MongoDB 实例使用独享型或专属型规格实例，而非共享型实例。\",\n\t\t\"ja\": \"MongoDB インスタンスが共有インスタンスではなく、専用または専属インスタンスクラスを使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen dedizierte oder exklusive Instanzklassen verwenden, keine gemeinsam genutzten Instanzen.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB usen clases de instancia dedicadas o exclusivas, no instancias compartidas.\",\n\t\t\"fr\": \"Garantit que les instances MongoDB utilisent des classes d'instance dédiées ou exclusives, et non des instances partagées.\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB usem classes de instância dedicadas ou exclusivas, não instâncias compartilhadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Shared instance classes may have resource contention issues, affecting database performance and stability.\",\n\t\t\"zh\": \"共享型实例规格可能存在资源争用问题，影响数据库性能和稳定性。\",\n\t\t\"ja\": \"共有インスタンスクラスにはリソース競合の問題があり、データベースのパフォーマンスと安定性に影響を与える可能性があります。\",\n\t\t\"de\": \"Gemeinsam genutzte Instanzklassen können Ressourcenkonfliktprobleme haben, die die Datenbankleistung und -stabilität beeinträchtigen.\",\n\t\t\"es\": \"Las clases de instancia compartidas pueden tener problemas de contención de recursos, afectando el rendimiento y la estabilidad de la base de datos.\",\n\t\t\"fr\": \"Les classes d'instance partagées peuvent avoir des problèmes de contention de ressources, affectant les performances et la stabilité de la base de données.\",\n\t\t\"pt\": \"As classes de instância compartilhadas podem ter problemas de contenção de recursos, afetando o desempenho e a estabilidade do banco de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use dedicated or exclusive instance classes for MongoDB instances.\",\n\t\t\"zh\": \"为 MongoDB 实例使用独享型或专属型规格实例。\",\n\t\t\"ja\": \"MongoDB インスタンスに専用または専属インスタンスクラスを使用します。\",\n\t\t\"de\": \"Verwenden Sie dedizierte oder exklusive Instanzklassen für MongoDB-Instanzen.\",\n\t\t\"es\": \"Use clases de instancia dedicadas o exclusivas para instancias MongoDB.\",\n\t\t\"fr\": \"Utilisez des classes d'instance dédiées ou exclusives pour les instances MongoDB.\",\n\t\t\"pt\": \"Use classes de instância dedicadas ou exclusivas para instâncias MongoDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\n# Shared instance class patterns (these are typically shared types)\nshared_classes := {\n\t\"dds.mongo.sharding\",\n\t\"dds.mongo.logic\",\n\t\"dds.mongo.shared\",\n}\n\n# Check if instance class is not shared\nis_compliant(resource) if {\n\tinstance_class := helpers.get_property(resource, \"DBInstanceClass\", \"\")\n\tnot contains_shared_class(lower(instance_class))\n}\n\ncontains_shared_class(instance_class) if {\n\tsome shared_class in shared_classes\n\tcontains(instance_class, shared_class)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DBInstanceClass\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-instance-enabled-ssl", Name: models.I18nString{"de": "MongoDB-Instanz SSL aktiviert", "en": "MongoDB Instance SSL Enabled", "es": "SSL de Instancia MongoDB Habilitado", "fr": "SSL d'Instance MongoDB Activé", "ja": "MongoDB インスタンス SSL 有効", "pt": "SSL de Instância MongoDB Habilitado", "zh": "MongoDB 实例开启 SSL 加密"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen SSL-Verschlüsselung aktiviert haben.", "en": "Ensures MongoDB instances have SSL encryption enabled.", "es": "Garantiza que las instancias MongoDB tengan cifrado SSL habilitado.", "fr": "Garantit que les instances MongoDB ont le chiffrement SSL activé.", "ja": "MongoDB インスタンスで SSL 暗号化が有効になっていることを確認します。", "pt": "Garante que as instâncias MongoDB tenham criptografia SSL habilitada.", "zh": "确保 MongoDB 实例开启了 SSL 加密。"}, Reason: models.I18nString{"de": "SSL schützt Daten während der Übertragung zwischen Client und Datenbank.", "en": "SSL protects data in transit between the client and the database.", "es": "SSL protege los datos en tránsito entre el cliente y la base de datos.", "fr": "SSL protège les données en transit entre le client et la base de données.", "ja": "SSL はクライアントとデータベース間で転送されるデータを保護します。", "pt": "SSL protege dados em trânsito entre o cliente e o banco de dados.", "zh": "SSL 保护客户端与数据库之间传输的数据。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie SSL für die MongoDB-Instanz.", "en": "Enable SSL for the MongoDB instance.", "es": "Habilite SSL para la instancia MongoDB.", "fr": "Activez SSL pour l'instance MongoDB.", "ja": "MongoDB インスタンスの SSL を有効にします。", "pt": "Habilite SSL para a instância MongoDB.", "zh": "为 MongoDB 实例开启 SSL 加密。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-instance-enabled-ssl.rego", PackageName: "infraguard.rules.aliyun.mongodb_instance_enabled_ssl", Content: "package infraguard.rules.aliyun.mongodb_instance_enabled_ssl\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"mongodb-instance-enabled-ssl\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance SSL Enabled\",\n\t\t\"zh\": \"MongoDB 实例开启 SSL 加密\",\n\t\t\"ja\": \"MongoDB インスタンス SSL 有効\",\n\t\t\"de\": \"MongoDB-Instanz SSL aktiviert\",\n\t\t\"es\": \"SSL de Instancia MongoDB Habilitado\",\n\t\t\"fr\": \"SSL d'Instance MongoDB Activé\",\n\t\t\"pt\": \"SSL de Instância MongoDB Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB instances have SSL encryption enabled.\",\n\t\t\"zh\": \"确保 MongoDB 实例开启了 SSL 加密。\",\n\t\t\"ja\": \"MongoDB インスタンスで SSL 暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen SSL-Verschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB tengan cifrado SSL habilitado.\",\n\t\t\"fr\": \"Garantit que les instances MongoDB ont le chiffrement SSL activé.\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB tenham criptografia SSL habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"SSL protects data in transit between the client and the database.\",\n\t\t\"zh\": \"SSL 保护客户端与数据库之间传输的数据。\",\n\t\t\"ja\": \"SSL はクライアントとデータベース間で転送されるデータを保護します。\",\n\t\t\"de\": \"SSL schützt Daten während der Übertragung zwischen Client und Datenbank.\",\n\t\t\"es\": \"SSL protege los datos en tránsito entre el cliente y la base de datos.\",\n\t\t\"fr\": \"SSL protège les données en transit entre le client et la base de données.\",\n\t\t\"pt\": \"SSL protege dados em trânsito entre o cliente e o banco de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable SSL for the MongoDB instance.\",\n\t\t\"zh\": \"为 MongoDB 实例开启 SSL 加密。\",\n\t\t\"ja\": \"MongoDB インスタンスの SSL を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie SSL für die MongoDB-Instanz.\",\n\t\t\"es\": \"Habilite SSL para la instancia MongoDB.\",\n\t\t\"fr\": \"Activez SSL pour l'instance MongoDB.\",\n\t\t\"pt\": \"Habilite SSL para a instância MongoDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\nis_compliant(resource) if {\n\tssl_options := helpers.get_property(resource, \"SSLOptions\", {})\n\taction := object.get(ssl_options, \"SSLAction\", \"Close\")\n\taction == \"Open\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MONGODB::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SSLOptions\", \"SSLAction\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-instance-encryption-byok-check", Name: models.I18nString{"de": "MongoDB-Instanz verwendet benutzerdefinierten Schlüssel für TDE", "en": "MongoDB Instance Uses Custom Key for TDE", "es": "La Instancia MongoDB Usa Clave Personalizada para TDE", "fr": "L'Instance MongoDB Utilise une Clé Personnalisée pour TDE", "ja": "MongoDB インスタンスが TDE にカスタムキーを使用", "pt": "A Instância MongoDB Usa Chave Personalizada para TDE", "zh": "使用自定义密钥为 MongoDB 设置透明数据加密 TDE"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen benutzerdefinierte KMS-Schlüssel für Transparent Data Encryption (TDE) verwenden.", "en": "Ensures MongoDB instances use custom KMS keys for Transparent Data Encryption (TDE).", "es": "Garantiza que las instancias MongoDB usen claves KMS personalizadas para Cifrado Transparente de Datos (TDE).", "fr": "Garantit que les instances MongoDB utilisent des clés KMS personnalisées pour le Chiffrement Transparent des Données (TDE).", "ja": "MongoDB インスタンスが透過的データ暗号化（TDE）にカスタム KMS キーを使用していることを確認します。", "pt": "Garante que as instâncias MongoDB usem chaves KMS personalizadas para Criptografia Transparente de Dados (TDE).", "zh": "确保 MongoDB 实例使用自定义 KMS 密钥进行透明数据加密（TDE）。"}, Reason: models.I18nString{"de": "Die Verwendung von kundenseitig verwalteten Schlüsseln für TDE bietet eine bessere Kontrolle über die Verschlüsselung und verbessert die Datensicherheit.", "en": "Using customer-managed keys for TDE provides better control over encryption and enhances data security.", "es": "Usar claves administradas por el cliente para TDE proporciona un mejor control sobre el cifrado y mejora la seguridad de los datos.", "fr": "L'utilisation de clés gérées par le client pour TDE offre un meilleur contrôle sur le chiffrement et améliore la sécurité des données.", "ja": "TDE に顧客管理キーを使用することで、暗号化をより適切に制御し、データセキュリティを強化できます。", "pt": "Usar chaves gerenciadas pelo cliente para TDE fornece melhor controle sobre a criptografia e melhora a segurança dos dados.", "zh": "使用客户管理密钥进行 TDE 可以更好地控制加密并增强数据安全性。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie TDE mit einem benutzerdefinierten KMS-Schlüssel für die MongoDB-Instanz.", "en": "Enable TDE with a custom KMS key for the MongoDB instance.", "es": "Habilite TDE con una clave KMS personalizada para la instancia MongoDB.", "fr": "Activez TDE avec une clé KMS personnalisée pour l'instance MongoDB.", "ja": "MongoDB インスタンスでカスタム KMS キーを使用して TDE を有効にします。", "pt": "Habilite TDE com uma chave KMS personalizada para a instância MongoDB.", "zh": "为 MongoDB 实例启用 TDE 并使用自定义 KMS 密钥。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-instance-encryption-byok-check.rego", PackageName: "infraguard.rules.aliyun.mongodb_instance_encryption_byok_check", Content: "package infraguard.rules.aliyun.mongodb_instance_encryption_byok_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-instance-encryption-byok-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance Uses Custom Key for TDE\",\n\t\t\"zh\": \"使用自定义密钥为 MongoDB 设置透明数据加密 TDE\",\n\t\t\"ja\": \"MongoDB インスタンスが TDE にカスタムキーを使用\",\n\t\t\"de\": \"MongoDB-Instanz verwendet benutzerdefinierten Schlüssel für TDE\",\n\t\t\"es\": \"La Instancia MongoDB Usa Clave Personalizada para TDE\",\n\t\t\"fr\": \"L'Instance MongoDB Utilise une Clé Personnalisée pour TDE\",\n\t\t\"pt\": \"A Instância MongoDB Usa Chave Personalizada para TDE\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB instances use custom KMS keys for Transparent Data Encryption (TDE).\",\n\t\t\"zh\": \"确保 MongoDB 实例使用自定义 KMS 密钥进行透明数据加密（TDE）。\",\n\t\t\"ja\": \"MongoDB インスタンスが透過的データ暗号化（TDE）にカスタム KMS キーを使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen benutzerdefinierte KMS-Schlüssel für Transparent Data Encryption (TDE) verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB usen claves KMS personalizadas para Cifrado Transparente de Datos (TDE).\",\n\t\t\"fr\": \"Garantit que les instances MongoDB utilisent des clés KMS personnalisées pour le Chiffrement Transparent des Données (TDE).\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB usem chaves KMS personalizadas para Criptografia Transparente de Dados (TDE).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using customer-managed keys for TDE provides better control over encryption and enhances data security.\",\n\t\t\"zh\": \"使用客户管理密钥进行 TDE 可以更好地控制加密并增强数据安全性。\",\n\t\t\"ja\": \"TDE に顧客管理キーを使用することで、暗号化をより適切に制御し、データセキュリティを強化できます。\",\n\t\t\"de\": \"Die Verwendung von kundenseitig verwalteten Schlüsseln für TDE bietet eine bessere Kontrolle über die Verschlüsselung und verbessert die Datensicherheit.\",\n\t\t\"es\": \"Usar claves administradas por el cliente para TDE proporciona un mejor control sobre el cifrado y mejora la seguridad de los datos.\",\n\t\t\"fr\": \"L'utilisation de clés gérées par le client pour TDE offre un meilleur contrôle sur le chiffrement et améliore la sécurité des données.\",\n\t\t\"pt\": \"Usar chaves gerenciadas pelo cliente para TDE fornece melhor controle sobre a criptografia e melhora a segurança dos dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable TDE with a custom KMS key for the MongoDB instance.\",\n\t\t\"zh\": \"为 MongoDB 实例启用 TDE 并使用自定义 KMS 密钥。\",\n\t\t\"ja\": \"MongoDB インスタンスでカスタム KMS キーを使用して TDE を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie TDE mit einem benutzerdefinierten KMS-Schlüssel für die MongoDB-Instanz.\",\n\t\t\"es\": \"Habilite TDE con una clave KMS personalizada para la instancia MongoDB.\",\n\t\t\"fr\": \"Activez TDE avec une clé KMS personnalisée pour l'instance MongoDB.\",\n\t\t\"pt\": \"Habilite TDE com uma chave KMS personalizada para a instância MongoDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\n# Check if instance is Serverless type (not applicable)\nis_serverless(resource) if {\n\ttags := helpers.get_property(resource, \"Tags\", [])\n\tsome tag in tags\n\ttag.Key == \"InstanceType\"\n\ttag.Value == \"Serverless\"\n}\n\nis_serverless(resource) if {\n\tinstance_class := helpers.get_property(resource, \"DBInstanceClass\", \"\")\n\tcontains(lower(instance_class), \"serverless\")\n}\n\n# Check if TDE is enabled with custom key\nis_compliant(resource) if {\n\tnot is_serverless(resource)\n\ttde_enabled := helpers.get_property(resource, \"TDEStatus\", false)\n\ttde_enabled == true\n\tkms_key_id := helpers.get_property(resource, \"EncryptionKey\", \"\")\n\tkms_key_id != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_serverless(resource)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TDEStatus\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-instance-in-vpc", Name: models.I18nString{"de": "MongoDB-Instanz verwendet VPC-Netzwerk", "en": "MongoDB Instance Uses VPC Network", "es": "La Instancia MongoDB Usa Red VPC", "fr": "L'Instance MongoDB Utilise le Réseau VPC", "ja": "MongoDB インスタンスが VPC ネットワークを使用", "pt": "A Instância MongoDB Usa Rede VPC", "zh": "使用专有网络类型的 MongoDB 实例"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen in einem Virtual Private Cloud (VPC)-Netzwerk bereitgestellt werden.", "en": "Ensures MongoDB instances are deployed in a Virtual Private Cloud (VPC) network.", "es": "Garantiza que las instancias MongoDB se desplieguen en una red de Nube Privada Virtual (VPC).", "fr": "Garantit que les instances MongoDB sont déployées dans un réseau de Cloud Privé Virtuel (VPC).", "ja": "MongoDB インスタンスが仮想プライベートクラウド（VPC）ネットワークに展開されていることを確認します。", "pt": "Garante que as instâncias MongoDB sejam implantadas em uma rede de Nuvem Privada Virtual (VPC).", "zh": "确保 MongoDB 实例部署在专有网络（VPC）中。"}, Reason: models.I18nString{"de": "VPC bietet Netzwerkisolation und bessere Sicherheit im Vergleich zum klassischen Netzwerk.", "en": "VPC provides network isolation and better security compared to the classic network.", "es": "VPC proporciona aislamiento de red y mejor seguridad en comparación con la red clásica.", "fr": "VPC offre une isolation réseau et une meilleure sécurité par rapport au réseau classique.", "ja": "VPC はクラシックネットワークと比較して、ネットワーク分離とより優れたセキュリティを提供します。", "pt": "VPC fornece isolamento de rede e melhor segurança em comparação com a rede clássica.", "zh": "与经典网络相比，VPC 提供网络隔离和更好的安全性。"}, Recommendation: models.I18nString{"de": "Stellen Sie die MongoDB-Instanz in einem VPC-Netzwerk bereit.", "en": "Deploy the MongoDB instance in a VPC network.", "es": "Despliegue la instancia MongoDB en una red VPC.", "fr": "Déployez l'instance MongoDB dans un réseau VPC.", "ja": "VPC ネットワークに MongoDB インスタンスを展開します。", "pt": "Implante a instância MongoDB em uma rede VPC.", "zh": "将 MongoDB 实例部署在专有网络中。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-instance-in-vpc.rego", PackageName: "infraguard.rules.aliyun.mongodb_instance_in_vpc", Content: "package infraguard.rules.aliyun.mongodb_instance_in_vpc\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-instance-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance Uses VPC Network\",\n\t\t\"zh\": \"使用专有网络类型的 MongoDB 实例\",\n\t\t\"ja\": \"MongoDB インスタンスが VPC ネットワークを使用\",\n\t\t\"de\": \"MongoDB-Instanz verwendet VPC-Netzwerk\",\n\t\t\"es\": \"La Instancia MongoDB Usa Red VPC\",\n\t\t\"fr\": \"L'Instance MongoDB Utilise le Réseau VPC\",\n\t\t\"pt\": \"A Instância MongoDB Usa Rede VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB instances are deployed in a Virtual Private Cloud (VPC) network.\",\n\t\t\"zh\": \"确保 MongoDB 实例部署在专有网络（VPC）中。\",\n\t\t\"ja\": \"MongoDB インスタンスが仮想プライベートクラウド（VPC）ネットワークに展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen in einem Virtual Private Cloud (VPC)-Netzwerk bereitgestellt werden.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB se desplieguen en una red de Nube Privada Virtual (VPC).\",\n\t\t\"fr\": \"Garantit que les instances MongoDB sont déployées dans un réseau de Cloud Privé Virtuel (VPC).\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB sejam implantadas em uma rede de Nuvem Privada Virtual (VPC).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"VPC provides network isolation and better security compared to the classic network.\",\n\t\t\"zh\": \"与经典网络相比，VPC 提供网络隔离和更好的安全性。\",\n\t\t\"ja\": \"VPC はクラシックネットワークと比較して、ネットワーク分離とより優れたセキュリティを提供します。\",\n\t\t\"de\": \"VPC bietet Netzwerkisolation und bessere Sicherheit im Vergleich zum klassischen Netzwerk.\",\n\t\t\"es\": \"VPC proporciona aislamiento de red y mejor seguridad en comparación con la red clásica.\",\n\t\t\"fr\": \"VPC offre une isolation réseau et une meilleure sécurité par rapport au réseau classique.\",\n\t\t\"pt\": \"VPC fornece isolamento de rede e melhor segurança em comparação com a rede clássica.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy the MongoDB instance in a VPC network.\",\n\t\t\"zh\": \"将 MongoDB 实例部署在专有网络中。\",\n\t\t\"ja\": \"VPC ネットワークに MongoDB インスタンスを展開します。\",\n\t\t\"de\": \"Stellen Sie die MongoDB-Instanz in einem VPC-Netzwerk bereit.\",\n\t\t\"es\": \"Despliegue la instancia MongoDB en una red VPC.\",\n\t\t\"fr\": \"Déployez l'instance MongoDB dans un réseau VPC.\",\n\t\t\"pt\": \"Implante a instância MongoDB em uma rede VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\n# Check if instance is in VPC\nis_compliant(resource) if {\n\tvpc_id := helpers.get_property(resource, \"VpcId\", \"\")\n\tvpc_id != \"\"\n}\n\nis_compliant(resource) if {\n\tnetwork_type := helpers.get_property(resource, \"NetworkType\", \"\")\n\tnetwork_type == \"VPC\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-instance-log-audit", Name: models.I18nString{"de": "MongoDB-Instanz Protokollprüfung aktiviert", "en": "MongoDB Instance Log Audit Enabled", "es": "Auditoría de Registro de Instancia MongoDB Habilitada", "fr": "Audit de Journal d'Instance MongoDB Activé", "ja": "MongoDB インスタンスログ監査が有効", "pt": "Auditoria de Log de Instância MongoDB Habilitada", "zh": "MongoDB 实例开启操作日志审计"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen Protokollprüfung aktiviert haben.", "en": "Ensures MongoDB instances have audit logging enabled.", "es": "Garantiza que las instancias MongoDB tengan auditoría de registro habilitada.", "fr": "Garantit que les instances MongoDB ont l'audit de journalisation activé.", "ja": "MongoDB インスタンスで監査ログ記録が有効になっていることを確認します。", "pt": "Garante que as instâncias MongoDB tenham auditoria de registro habilitada.", "zh": "确保 MongoDB 实例开启了操作日志审计。"}, Reason: models.I18nString{"de": "Prüfprotokolle sind entscheidend für die Sicherheitsüberwachung und Compliance-Prüfung.", "en": "Audit logs are critical for security monitoring and compliance auditing.", "es": "Los registros de auditoría son críticos para el monitoreo de seguridad y la auditoría de cumplimiento.", "fr": "Les journaux d'audit sont essentiels pour la surveillance de la sécurité et l'audit de conformité.", "ja": "監査ログは、セキュリティ監視とコンプライアンス監査にとって重要です。", "pt": "Os registros de auditoria são críticos para monitoramento de segurança e auditoria de conformidade.", "zh": "审计日志对于安全监控和合规审计至关重要。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Protokollprüfung für die MongoDB-Instanz.", "en": "Enable audit logging for the MongoDB instance.", "es": "Habilite la auditoría de registro para la instancia MongoDB.", "fr": "Activez l'audit de journalisation pour l'instance MongoDB.", "ja": "MongoDB インスタンスの監査ログ記録を有効にします。", "pt": "Habilite a auditoria de registro para a instância MongoDB.", "zh": "为 MongoDB 实例开启操作日志审计。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-instance-log-audit.rego", PackageName: "infraguard.rules.aliyun.mongodb_instance_log_audit", Content: "package infraguard.rules.aliyun.mongodb_instance_log_audit\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"mongodb-instance-log-audit\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance Log Audit Enabled\",\n\t\t\"zh\": \"MongoDB 实例开启操作日志审计\",\n\t\t\"ja\": \"MongoDB インスタンスログ監査が有効\",\n\t\t\"de\": \"MongoDB-Instanz Protokollprüfung aktiviert\",\n\t\t\"es\": \"Auditoría de Registro de Instancia MongoDB Habilitada\",\n\t\t\"fr\": \"Audit de Journal d'Instance MongoDB Activé\",\n\t\t\"pt\": \"Auditoria de Log de Instância MongoDB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB instances have audit logging enabled.\",\n\t\t\"zh\": \"确保 MongoDB 实例开启了操作日志审计。\",\n\t\t\"ja\": \"MongoDB インスタンスで監査ログ記録が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen Protokollprüfung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB tengan auditoría de registro habilitada.\",\n\t\t\"fr\": \"Garantit que les instances MongoDB ont l'audit de journalisation activé.\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB tenham auditoria de registro habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Audit logs are critical for security monitoring and compliance auditing.\",\n\t\t\"zh\": \"审计日志对于安全监控和合规审计至关重要。\",\n\t\t\"ja\": \"監査ログは、セキュリティ監視とコンプライアンス監査にとって重要です。\",\n\t\t\"de\": \"Prüfprotokolle sind entscheidend für die Sicherheitsüberwachung und Compliance-Prüfung.\",\n\t\t\"es\": \"Los registros de auditoría son críticos para el monitoreo de seguridad y la auditoría de cumplimiento.\",\n\t\t\"fr\": \"Les journaux d'audit sont essentiels pour la surveillance de la sécurité et l'audit de conformité.\",\n\t\t\"pt\": \"Os registros de auditoria são críticos para monitoramento de segurança e auditoria de conformidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable audit logging for the MongoDB instance.\",\n\t\t\"zh\": \"为 MongoDB 实例开启操作日志审计。\",\n\t\t\"ja\": \"MongoDB インスタンスの監査ログ記録を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Protokollprüfung für die MongoDB-Instanz.\",\n\t\t\"es\": \"Habilite la auditoría de registro para la instancia MongoDB.\",\n\t\t\"fr\": \"Activez l'audit de journalisation pour l'instance MongoDB.\",\n\t\t\"pt\": \"Habilite a auditoria de registro para a instância MongoDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\nis_compliant(resource) if {\n\taudit_options := helpers.get_property(resource, \"AuditPolicyOptions\", {})\n\tstatus := object.get(audit_options, \"AuditStatus\", \"disabled\")\n\tstatus == \"enable\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MONGODB::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AuditPolicyOptions\", \"AuditStatus\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-instance-multi-node", Name: models.I18nString{"de": "MongoDB-Instanz verwendet mehrere Knoten", "en": "MongoDB Instance Uses Multiple Nodes", "es": "La Instancia MongoDB Usa Múltiples Nodos", "fr": "L'Instance MongoDB Utilise Plusieurs Nœuds", "ja": "MongoDB インスタンスが複数のノードを使用", "pt": "A Instância MongoDB Usa Múltiplos Nós", "zh": "使用多节点的 MongoDB 实例"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen mit mehreren Knoten für Hochverfügbarkeit bereitgestellt werden.", "en": "Ensures MongoDB instances are deployed with multiple nodes for high availability.", "es": "Garantiza que las instancias MongoDB se implementen con múltiples nodos para alta disponibilidad.", "fr": "Garantit que les instances MongoDB sont déployées avec plusieurs nœuds pour une haute disponibilité.", "ja": "MongoDB インスタンスが高可用性のために複数のノードで展開されていることを確認します。", "pt": "Garante que as instâncias MongoDB sejam implantadas com múltiplos nós para alta disponibilidade.", "zh": "确保 MongoDB 实例部署了多个节点以实现高可用性。"}, Reason: models.I18nString{"de": "Einzelknoten-Instanzen haben keine Redundanz und sind dem Risiko von Datenverlust oder Dienstunterbrechung ausgesetzt.", "en": "Single-node instances have no redundancy and are at risk of data loss or service interruption.", "es": "Las instancias de nodo único no tienen redundancia y corren el riesgo de pérdida de datos o interrupción del servicio.", "fr": "Les instances à nœud unique n'ont pas de redondance et risquent une perte de données ou une interruption de service.", "ja": "シングルノードインスタンスには冗長性がなく、データ損失やサービス中断のリスクがあります。", "pt": "Instâncias de nó único não têm redundância e correm risco de perda de dados ou interrupção do serviço.", "zh": "单节点实例没有冗余，存在数据丢失或服务中断的风险。"}, Recommendation: models.I18nString{"de": "Stellen Sie MongoDB-Instanzen mit mehreren Replikat-Set-Knoten bereit.", "en": "Deploy MongoDB instances with multiple replica set nodes.", "es": "Implemente instancias MongoDB con múltiples nodos de conjunto de réplicas.", "fr": "Déployez des instances MongoDB avec plusieurs nœuds de jeu de répliques.", "ja": "複数のレプリカセットノードを持つ MongoDB インスタンスを展開します。", "pt": "Implante instâncias MongoDB com múltiplos nós de conjunto de réplicas.", "zh": "部署具有多个副本集节点的 MongoDB 实例。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-instance-multi-node.rego", PackageName: "infraguard.rules.aliyun.mongodb_instance_multi_node", Content: "package infraguard.rules.aliyun.mongodb_instance_multi_node\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-instance-multi-node\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance Uses Multiple Nodes\",\n\t\t\"zh\": \"使用多节点的 MongoDB 实例\",\n\t\t\"ja\": \"MongoDB インスタンスが複数のノードを使用\",\n\t\t\"de\": \"MongoDB-Instanz verwendet mehrere Knoten\",\n\t\t\"es\": \"La Instancia MongoDB Usa Múltiples Nodos\",\n\t\t\"fr\": \"L'Instance MongoDB Utilise Plusieurs Nœuds\",\n\t\t\"pt\": \"A Instância MongoDB Usa Múltiplos Nós\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB instances are deployed with multiple nodes for high availability.\",\n\t\t\"zh\": \"确保 MongoDB 实例部署了多个节点以实现高可用性。\",\n\t\t\"ja\": \"MongoDB インスタンスが高可用性のために複数のノードで展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen mit mehreren Knoten für Hochverfügbarkeit bereitgestellt werden.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB se implementen con múltiples nodos para alta disponibilidad.\",\n\t\t\"fr\": \"Garantit que les instances MongoDB sont déployées avec plusieurs nœuds pour une haute disponibilité.\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB sejam implantadas com múltiplos nós para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Single-node instances have no redundancy and are at risk of data loss or service interruption.\",\n\t\t\"zh\": \"单节点实例没有冗余，存在数据丢失或服务中断的风险。\",\n\t\t\"ja\": \"シングルノードインスタンスには冗長性がなく、データ損失やサービス中断のリスクがあります。\",\n\t\t\"de\": \"Einzelknoten-Instanzen haben keine Redundanz und sind dem Risiko von Datenverlust oder Dienstunterbrechung ausgesetzt.\",\n\t\t\"es\": \"Las instancias de nodo único no tienen redundancia y corren el riesgo de pérdida de datos o interrupción del servicio.\",\n\t\t\"fr\": \"Les instances à nœud unique n'ont pas de redondance et risquent une perte de données ou une interruption de service.\",\n\t\t\"pt\": \"Instâncias de nó único não têm redundância e correm risco de perda de dados ou interrupção do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy MongoDB instances with multiple replica set nodes.\",\n\t\t\"zh\": \"部署具有多个副本集节点的 MongoDB 实例。\",\n\t\t\"ja\": \"複数のレプリカセットノードを持つ MongoDB インスタンスを展開します。\",\n\t\t\"de\": \"Stellen Sie MongoDB-Instanzen mit mehreren Replikat-Set-Knoten bereit.\",\n\t\t\"es\": \"Implemente instancias MongoDB con múltiples nodos de conjunto de réplicas.\",\n\t\t\"fr\": \"Déployez des instances MongoDB avec plusieurs nœuds de jeu de répliques.\",\n\t\t\"pt\": \"Implante instâncias MongoDB com múltiplos nós de conjunto de réplicas.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\n# Check if instance has multiple nodes\nis_compliant(resource) if {\n\treplication_factor := helpers.get_property(resource, \"ReplicationFactor\", 0)\n\treplication_factor >= 3\n}\n\nis_compliant(resource) if {\n\tinstance_class := helpers.get_property(resource, \"DBInstanceClass\", \"\")\n\n\t# Check if it's a replica set class (typically contains 'replica' or has specific patterns)\n\tcontains(lower(instance_class), \"replica\")\n}\n\nis_compliant(resource) if {\n\tinstance_class := helpers.get_property(resource, \"DBInstanceClass\", \"\")\n\tcontains(lower(instance_class), \"sharding\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ReplicationFactor\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-instance-multi-zone", Name: models.I18nString{"de": "MongoDB-Instanz Multi-Zone-Bereitstellung", "en": "MongoDB Instance Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Instancia MongoDB", "fr": "Déploiement Multi-Zone d'Instance MongoDB", "ja": "MongoDB インスタンスマルチゾーン展開", "pt": "Implantações Multi-Zona de Instância MongoDB", "zh": "MongoDB 实例多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "MongoDB-Instanzen sollten über mehrere Verfügbarkeitszonen hinweg für Hochverfügbarkeit bereitgestellt werden.", "en": "MongoDB instances should be deployed across multiple availability zones for high availability.", "es": "Las instancias MongoDB deben desplegarse en múltiples zonas de disponibilidad para alta disponibilidad.", "fr": "Les instances MongoDB doivent être déployées sur plusieurs zones de disponibilité pour une haute disponibilité.", "ja": "MongoDB インスタンスは高可用性のために複数の可用性ゾーンに展開する必要があります。", "pt": "As instâncias MongoDB devem ser implantadas em múltiplas zonas de disponibilidade para alta disponibilidade.", "zh": "MongoDB 实例应部署在多个可用区。"}, Reason: models.I18nString{"de": "Die MongoDB-Instanz ist nicht mit einer sekundären oder versteckten Zone konfiguriert.", "en": "The MongoDB instance is not configured with a secondary or hidden zone.", "es": "La instancia MongoDB no está configurada con una zona secundaria u oculta.", "fr": "L'instance MongoDB n'est pas configurée avec une zone secondaire ou cachée.", "ja": "MongoDB インスタンスにセカンダリゾーンまたは非表示ゾーンが設定されていません。", "pt": "A instância MongoDB não está configurada com uma zona secundária ou oculta.", "zh": "MongoDB 实例未配置备用可用区或隐藏可用区。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie SecondaryZoneId oder HiddenZoneId, um Multi-Zone-Bereitstellung zu aktivieren.", "en": "Configure SecondaryZoneId or HiddenZoneId to enable multi-zone deployment.", "es": "Configure SecondaryZoneId o HiddenZoneId para habilitar el despliegue multi-zona.", "fr": "Configurez SecondaryZoneId ou HiddenZoneId pour activer le déploiement multi-zone.", "ja": "SecondaryZoneId または HiddenZoneId を設定してマルチゾーン展開を有効にします。", "pt": "Configure SecondaryZoneId ou HiddenZoneId para habilitar a implantação multi-zona.", "zh": "配置 SecondaryZoneId 或 HiddenZoneId 以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.mongodb_instance_multi_zone", Content: "package infraguard.rules.aliyun.mongodb_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"mongodb-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"MongoDB 实例多可用区部署\",\n\t\t\"ja\": \"MongoDB インスタンスマルチゾーン展開\",\n\t\t\"de\": \"MongoDB-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Instancia MongoDB\",\n\t\t\"fr\": \"Déploiement Multi-Zone d'Instance MongoDB\",\n\t\t\"pt\": \"Implantações Multi-Zona de Instância MongoDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"MongoDB instances should be deployed across multiple availability zones for high availability.\",\n\t\t\"zh\": \"MongoDB 实例应部署在多个可用区。\",\n\t\t\"ja\": \"MongoDB インスタンスは高可用性のために複数の可用性ゾーンに展開する必要があります。\",\n\t\t\"de\": \"MongoDB-Instanzen sollten über mehrere Verfügbarkeitszonen hinweg für Hochverfügbarkeit bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias MongoDB deben desplegarse en múltiples zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances MongoDB doivent être déployées sur plusieurs zones de disponibilité pour une haute disponibilité.\",\n\t\t\"pt\": \"As instâncias MongoDB devem ser implantadas em múltiplas zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The MongoDB instance is not configured with a secondary or hidden zone.\",\n\t\t\"zh\": \"MongoDB 实例未配置备用可用区或隐藏可用区。\",\n\t\t\"ja\": \"MongoDB インスタンスにセカンダリゾーンまたは非表示ゾーンが設定されていません。\",\n\t\t\"de\": \"Die MongoDB-Instanz ist nicht mit einer sekundären oder versteckten Zone konfiguriert.\",\n\t\t\"es\": \"La instancia MongoDB no está configurada con una zona secundaria u oculta.\",\n\t\t\"fr\": \"L'instance MongoDB n'est pas configurée avec une zone secondaire ou cachée.\",\n\t\t\"pt\": \"A instância MongoDB não está configurada com uma zona secundária ou oculta.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure SecondaryZoneId or HiddenZoneId to enable multi-zone deployment.\",\n\t\t\"zh\": \"配置 SecondaryZoneId 或 HiddenZoneId 以启用多可用区部署。\",\n\t\t\"ja\": \"SecondaryZoneId または HiddenZoneId を設定してマルチゾーン展開を有効にします。\",\n\t\t\"de\": \"Konfigurieren Sie SecondaryZoneId oder HiddenZoneId, um Multi-Zone-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure SecondaryZoneId o HiddenZoneId para habilitar el despliegue multi-zona.\",\n\t\t\"fr\": \"Configurez SecondaryZoneId ou HiddenZoneId pour activer le déploiement multi-zone.\",\n\t\t\"pt\": \"Configure SecondaryZoneId ou HiddenZoneId para habilitar a implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\n# Check if instance is multi-zone\nis_multi_zone(resource) if {\n\t# Check if SecondaryZoneId is present\n\tobject.get(resource.Properties, \"SecondaryZoneId\", \"\") != \"\"\n}\n\nis_multi_zone(resource) if {\n\t# Check if HiddenZoneId is present\n\tobject.get(resource.Properties, \"HiddenZoneId\", \"\") != \"\"\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-instance-release-protection", Name: models.I18nString{"de": "MongoDB-Instanz Freigabeschutz aktiviert", "en": "MongoDB Instance Release Protection Enabled", "es": "Protección de Liberación de Instancia MongoDB Habilitada", "fr": "Protection contre la Libération d'Instance MongoDB Activée", "ja": "MongoDB インスタンス解放保護が有効", "pt": "Proteção contra Liberação de Instância MongoDB Habilitada", "zh": "MongoDB 实例开启释放保护"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen Freigabeschutz aktiviert haben.", "en": "Ensures that MongoDB instances have release protection enabled.", "es": "Garantiza que las instancias MongoDB tengan protección contra liberación habilitada.", "fr": "Garantit que les instances MongoDB ont la protection contre la libération activée.", "ja": "MongoDB インスタンスで解放保護が有効になっていることを確認します。", "pt": "Garante que as instâncias MongoDB tenham proteção contra liberação habilitada.", "zh": "确保 MongoDB 实例开启了释放保护。"}, Reason: models.I18nString{"de": "Wenn der Freigabeschutz nicht aktiviert ist, kann die MongoDB-Instanz versehentlich freigegeben werden, was zu Datenverlust führt.", "en": "If release protection is not enabled, the MongoDB instance may be released accidentally, causing data loss.", "es": "Si la protección contra liberación no está habilitada, la instancia MongoDB puede ser liberada accidentalmente, causando pérdida de datos.", "fr": "Si la protection contre la libération n'est pas activée, l'instance MongoDB peut être libérée accidentellement, entraînant une perte de données.", "ja": "解放保護が有効になっていない場合、MongoDB インスタンスが誤って解放され、データ損失が発生する可能性があります。", "pt": "Se a proteção contra liberação não estiver habilitada, a instância MongoDB pode ser liberada acidentalmente, causando perda de dados.", "zh": "如果未开启释放保护，MongoDB 实例可能会被意外释放，导致数据丢失。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Freigabeschutz für die MongoDB-Instanz.", "en": "Enable release protection for the MongoDB instance.", "es": "Habilite la protección contra liberación para la instancia MongoDB.", "fr": "Activez la protection contre la libération pour l'instance MongoDB.", "ja": "MongoDB インスタンスの解放保護を有効にします。", "pt": "Habilite a proteção contra liberação para a instância MongoDB.", "zh": "为 MongoDB 实例开启释放保护功能。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-instance-release-protection.rego", PackageName: "infraguard.rules.aliyun.mongodb_instance_release_protection", Content: "package infraguard.rules.aliyun.mongodb_instance_release_protection\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-instance-release-protection\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Instance Release Protection Enabled\",\n\t\t\"zh\": \"MongoDB 实例开启释放保护\",\n\t\t\"ja\": \"MongoDB インスタンス解放保護が有効\",\n\t\t\"de\": \"MongoDB-Instanz Freigabeschutz aktiviert\",\n\t\t\"es\": \"Protección de Liberación de Instancia MongoDB Habilitada\",\n\t\t\"fr\": \"Protection contre la Libération d'Instance MongoDB Activée\",\n\t\t\"pt\": \"Proteção contra Liberação de Instância MongoDB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that MongoDB instances have release protection enabled.\",\n\t\t\"zh\": \"确保 MongoDB 实例开启了释放保护。\",\n\t\t\"ja\": \"MongoDB インスタンスで解放保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen Freigabeschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB tengan protección contra liberación habilitada.\",\n\t\t\"fr\": \"Garantit que les instances MongoDB ont la protection contre la libération activée.\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB tenham proteção contra liberação habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If release protection is not enabled, the MongoDB instance may be released accidentally, causing data loss.\",\n\t\t\"zh\": \"如果未开启释放保护，MongoDB 实例可能会被意外释放，导致数据丢失。\",\n\t\t\"ja\": \"解放保護が有効になっていない場合、MongoDB インスタンスが誤って解放され、データ損失が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Freigabeschutz nicht aktiviert ist, kann die MongoDB-Instanz versehentlich freigegeben werden, was zu Datenverlust führt.\",\n\t\t\"es\": \"Si la protección contra liberación no está habilitada, la instancia MongoDB puede ser liberada accidentalmente, causando pérdida de datos.\",\n\t\t\"fr\": \"Si la protection contre la libération n'est pas activée, l'instance MongoDB peut être libérée accidentellement, entraînant une perte de données.\",\n\t\t\"pt\": \"Se a proteção contra liberação não estiver habilitada, a instância MongoDB pode ser liberada acidentalmente, causando perda de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable release protection for the MongoDB instance.\",\n\t\t\"zh\": \"为 MongoDB 实例开启释放保护功能。\",\n\t\t\"ja\": \"MongoDB インスタンスの解放保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Freigabeschutz für die MongoDB-Instanz.\",\n\t\t\"es\": \"Habilite la protección contra liberación para la instancia MongoDB.\",\n\t\t\"fr\": \"Activez la protection contre la libération pour l'instance MongoDB.\",\n\t\t\"pt\": \"Habilite a proteção contra liberação para a instância MongoDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DBInstanceReleaseProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MONGODB::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DBInstanceReleaseProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-min-maxconnections-limit", Name: models.I18nString{"de": "MongoDB erfüllt Mindestverbindungsanforderungen", "en": "MongoDB Meets Minimum Connection Requirements", "es": "MongoDB Cumple los Requisitos Mínimos de Conexión", "fr": "MongoDB Répond aux Exigences Minimales de Connexion", "ja": "MongoDB が最小接続要件を満たしている", "pt": "MongoDB Atende aos Requisitos Mínimos de Conexão", "zh": "MongoDB 满足指定连接数要求"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen mindestens die erforderliche Mindestanzahl von Verbindungen bereitstellen.", "en": "Ensures MongoDB instances provide at least the minimum required number of connections.", "es": "Garantiza que las instancias MongoDB proporcionen al menos el número mínimo requerido de conexiones.", "fr": "Garantit que les instances MongoDB fournissent au moins le nombre minimum requis de connexions.", "ja": "MongoDB インスタンスが少なくとも必要な最小接続数を提供することを確認します。", "pt": "Garante que as instâncias MongoDB forneçam pelo menos o número mínimo necessário de conexões.", "zh": "确保 MongoDB 实例提供至少所需的最少连接数。"}, Reason: models.I18nString{"de": "Unzureichende Verbindungslimits können bei Belastung zu Anwendungsfehlern führen.", "en": "Insufficient connection limits may cause application failures when under load.", "es": "Los límites de conexión insuficientes pueden causar fallas de aplicación bajo carga.", "fr": "Des limites de connexion insuffisantes peuvent provoquer des défaillances d'application sous charge.", "ja": "接続制限が不十分な場合、負荷下でアプリケーション障害が発生する可能性があります。", "pt": "Limites de conexão insuficientes podem causar falhas de aplicação sob carga.", "zh": "连接数不足可能在负载下导致应用程序故障。"}, Recommendation: models.I18nString{"de": "Wählen Sie eine Instanzklasse, die ausreichende Verbindungslimits bietet.", "en": "Select an instance class that provides sufficient connection limits.", "es": "Seleccione una clase de instancia que proporcione límites de conexión suficientes.", "fr": "Sélectionnez une classe d'instance qui fournit des limites de connexion suffisantes.", "ja": "十分な接続制限を提供するインスタンスクラスを選択します。", "pt": "Selecione uma classe de instância que forneça limites de conexão suficientes.", "zh": "选择提供足够连接数限制的实例规格。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-min-maxconnections-limit.rego", PackageName: "infraguard.rules.aliyun.mongodb_min_maxconnections_limit", Content: "package infraguard.rules.aliyun.mongodb_min_maxconnections_limit\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-min-maxconnections-limit\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Meets Minimum Connection Requirements\",\n\t\t\"zh\": \"MongoDB 满足指定连接数要求\",\n\t\t\"ja\": \"MongoDB が最小接続要件を満たしている\",\n\t\t\"de\": \"MongoDB erfüllt Mindestverbindungsanforderungen\",\n\t\t\"es\": \"MongoDB Cumple los Requisitos Mínimos de Conexión\",\n\t\t\"fr\": \"MongoDB Répond aux Exigences Minimales de Connexion\",\n\t\t\"pt\": \"MongoDB Atende aos Requisitos Mínimos de Conexão\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB instances provide at least the minimum required number of connections.\",\n\t\t\"zh\": \"确保 MongoDB 实例提供至少所需的最少连接数。\",\n\t\t\"ja\": \"MongoDB インスタンスが少なくとも必要な最小接続数を提供することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen mindestens die erforderliche Mindestanzahl von Verbindungen bereitstellen.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB proporcionen al menos el número mínimo requerido de conexiones.\",\n\t\t\"fr\": \"Garantit que les instances MongoDB fournissent au moins le nombre minimum requis de connexions.\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB forneçam pelo menos o número mínimo necessário de conexões.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Insufficient connection limits may cause application failures when under load.\",\n\t\t\"zh\": \"连接数不足可能在负载下导致应用程序故障。\",\n\t\t\"ja\": \"接続制限が不十分な場合、負荷下でアプリケーション障害が発生する可能性があります。\",\n\t\t\"de\": \"Unzureichende Verbindungslimits können bei Belastung zu Anwendungsfehlern führen.\",\n\t\t\"es\": \"Los límites de conexión insuficientes pueden causar fallas de aplicación bajo carga.\",\n\t\t\"fr\": \"Des limites de connexion insuffisantes peuvent provoquer des défaillances d'application sous charge.\",\n\t\t\"pt\": \"Limites de conexão insuficientes podem causar falhas de aplicação sob carga.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Select an instance class that provides sufficient connection limits.\",\n\t\t\"zh\": \"选择提供足够连接数限制的实例规格。\",\n\t\t\"ja\": \"十分な接続制限を提供するインスタンスクラスを選択します。\",\n\t\t\"de\": \"Wählen Sie eine Instanzklasse, die ausreichende Verbindungslimits bietet.\",\n\t\t\"es\": \"Seleccione una clase de instancia que proporcione límites de conexión suficientes.\",\n\t\t\"fr\": \"Sélectionnez une classe d'instance qui fournit des limites de connexion suffisantes.\",\n\t\t\"pt\": \"Selecione uma classe de instância que forneça limites de conexão suficientes.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\n# Default minimum connections\ndefault_min_connections := 500\n\n# Get min connections from parameter or use default\nget_min_connections := num if {\n\tnum := input.parameters.minConnections\n\tis_number(num)\n}\n\nget_min_connections := default_min_connections\n\n# Get max connections for the instance\nget_max_connections(resource) := conn if {\n\tconn := object.get(resource.Properties, \"MaxConnections\", 0)\n\tis_number(conn)\n}\n\n# Check if instance meets connection requirements\nis_compliant(resource) if {\n\tmax_conn := get_max_connections(resource)\n\tmin_required := get_min_connections()\n\tmax_conn >= min_required\n}\n\n# Also check based on instance class capability\nis_compliant(resource) if {\n\tinstance_class := object.get(resource.Properties, \"DBInstanceClass\", \"\")\n\n\t# Map instance class to expected max connections (simplified)\n\tclass_conn_map := {\n\t\t\"dds.mongo.stand-alone\": 200,\n\t\t\"dds.mongo.replica_set\": 1000,\n\t\t\"dds.mongo.sharding\": 2000,\n\t}\n\texpected_conn := class_conn_map[lower(instance_class)]\n\texpected_conn != null\n\texpected_conn >= get_min_connections()\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"MaxConnections\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-min-maxiops-limit", Name: models.I18nString{"de": "MongoDB erfüllt Mindest-IOPS-Anforderungen", "en": "MongoDB Meets Minimum IOPS Requirements", "es": "MongoDB Cumple con los Requisitos Mínimos de IOPS", "fr": "MongoDB Répond aux Exigences Minimales d'IOPS", "ja": "MongoDB が最小 IOPS 要件を満たしている", "pt": "MongoDB Atende aos Requisitos Mínimos de IOPS", "zh": "MongoDB 实例满足指定读写次数要求"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen mindestens die erforderliche Mindest-IOPS bereitstellen.", "en": "Ensures MongoDB instances provide at least the minimum required IOPS.", "es": "Garantiza que las instancias MongoDB proporcionen al menos el IOPS mínimo requerido.", "fr": "Garantit que les instances MongoDB fournissent au moins l'IOPS minimum requis.", "ja": "MongoDB インスタンスが少なくとも最小要件 IOPS を提供していることを確認します。", "pt": "Garante que as instâncias MongoDB forneçam pelo menos o IOPS mínimo necessário.", "zh": "确保 MongoDB 实例提供至少所需的最少 IOPS。"}, Reason: models.I18nString{"de": "Unzureichende IOPS können bei Last zu Leistungsproblemen führen.", "en": "Insufficient IOPS may cause performance issues under load.", "es": "IOPS insuficientes pueden causar problemas de rendimiento bajo carga.", "fr": "Des IOPS insuffisantes peuvent causer des problèmes de performance sous charge.", "ja": "IOPS が不足すると、負荷下でパフォーマンスの問題が発生する可能性があります。", "pt": "IOPS insuficientes podem causar problemas de desempenho sob carga.", "zh": "IOPS 不足可能在负载下导致性能问题。"}, Recommendation: models.I18nString{"de": "Wählen Sie eine Instanzklasse oder Speicher, die ausreichend IOPS bereitstellt.", "en": "Select an instance class or storage that provides sufficient IOPS.", "es": "Seleccione una clase de instancia o almacenamiento que proporcione IOPS suficientes.", "fr": "Sélectionnez une classe d'instance ou un stockage qui fournit des IOPS suffisants.", "ja": "十分な IOPS を提供するインスタンスクラスまたはストレージを選択します。", "pt": "Selecione uma classe de instância ou armazenamento que forneça IOPS suficientes.", "zh": "选择提供足够 IOPS 的实例规格或存储。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-min-maxiops-limit.rego", PackageName: "infraguard.rules.aliyun.mongodb_min_maxiops_limit", Content: "package infraguard.rules.aliyun.mongodb_min_maxiops_limit\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-min-maxiops-limit\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Meets Minimum IOPS Requirements\",\n\t\t\"zh\": \"MongoDB 实例满足指定读写次数要求\",\n\t\t\"ja\": \"MongoDB が最小 IOPS 要件を満たしている\",\n\t\t\"de\": \"MongoDB erfüllt Mindest-IOPS-Anforderungen\",\n\t\t\"es\": \"MongoDB Cumple con los Requisitos Mínimos de IOPS\",\n\t\t\"fr\": \"MongoDB Répond aux Exigences Minimales d'IOPS\",\n\t\t\"pt\": \"MongoDB Atende aos Requisitos Mínimos de IOPS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB instances provide at least the minimum required IOPS.\",\n\t\t\"zh\": \"确保 MongoDB 实例提供至少所需的最少 IOPS。\",\n\t\t\"ja\": \"MongoDB インスタンスが少なくとも最小要件 IOPS を提供していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen mindestens die erforderliche Mindest-IOPS bereitstellen.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB proporcionen al menos el IOPS mínimo requerido.\",\n\t\t\"fr\": \"Garantit que les instances MongoDB fournissent au moins l'IOPS minimum requis.\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB forneçam pelo menos o IOPS mínimo necessário.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Insufficient IOPS may cause performance issues under load.\",\n\t\t\"zh\": \"IOPS 不足可能在负载下导致性能问题。\",\n\t\t\"ja\": \"IOPS が不足すると、負荷下でパフォーマンスの問題が発生する可能性があります。\",\n\t\t\"de\": \"Unzureichende IOPS können bei Last zu Leistungsproblemen führen.\",\n\t\t\"es\": \"IOPS insuficientes pueden causar problemas de rendimiento bajo carga.\",\n\t\t\"fr\": \"Des IOPS insuffisantes peuvent causer des problèmes de performance sous charge.\",\n\t\t\"pt\": \"IOPS insuficientes podem causar problemas de desempenho sob carga.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Select an instance class or storage that provides sufficient IOPS.\",\n\t\t\"zh\": \"选择提供足够 IOPS 的实例规格或存储。\",\n\t\t\"ja\": \"十分な IOPS を提供するインスタンスクラスまたはストレージを選択します。\",\n\t\t\"de\": \"Wählen Sie eine Instanzklasse oder Speicher, die ausreichend IOPS bereitstellt.\",\n\t\t\"es\": \"Seleccione una clase de instancia o almacenamiento que proporcione IOPS suficientes.\",\n\t\t\"fr\": \"Sélectionnez une classe d'instance ou un stockage qui fournit des IOPS suffisants.\",\n\t\t\"pt\": \"Selecione uma classe de instância ou armazenamento que forneça IOPS suficientes.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\n# Default minimum IOPS\ndefault_min_iops := 1000\n\n# Get min IOPS from parameter or use default\nget_min_iops := iops if {\n\tiops := input.parameters.minIOPS\n\tis_number(iops)\n} else := default_min_iops\n\n# Get max IOPS for the instance\nget_max_iops(resource) := iops if {\n\tiops := helpers.get_property(resource, \"MaxIOPS\", 0)\n\tis_number(iops)\n}\n\n# Check if instance meets IOPS requirements\nis_compliant(resource) if {\n\tmax_iops := get_max_iops(resource)\n\tmin_required := get_min_iops()\n\tmax_iops >= min_required\n}\n\n# Also check based on instance class and storage\nis_compliant(resource) if {\n\tinstance_class := helpers.get_property(resource, \"DBInstanceClass\", \"\")\n\tinstance_storage := helpers.get_property(resource, \"DBInstanceStorage\", 0)\n\tstorage_type := helpers.get_property(resource, \"StorageType\", \"cloud_ssd\")\n\n\tinstance_storage >= 100\n\tcontains(lower(storage_type), \"ssd\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"MaxIOPS\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-public-access-check", Name: models.I18nString{"de": "MongoDB-Whitelist Internet-Einschränkung", "en": "MongoDB Whitelist Internet Restriction", "es": "Restricción de Internet de Lista Blanca MongoDB", "fr": "Restriction Internet de Liste Blanche MongoDB", "ja": "MongoDB ホワイトリストインターネット制限", "pt": "Restrição de Internet da Lista Branca MongoDB", "zh": "MongoDB 白名单禁用公网开放"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Sicherheits-IP-Whitelists 0.0.0.0/0 nicht enthalten.", "en": "Ensures MongoDB security IP whitelists do not contain 0.0.0.0/0.", "es": "Garantiza que las listas blancas de IP de seguridad MongoDB no contengan 0.0.0.0/0.", "fr": "Garantit que les listes blanches d'IP de sécurité MongoDB ne contiennent pas 0.0.0.0/0.", "ja": "MongoDB セキュリティ IP ホワイトリストに 0.0.0.0/0 が含まれていないことを確認します。", "pt": "Garante que as listas brancas de IP de segurança MongoDB não contenham 0.0.0.0/0.", "zh": "确保 MongoDB 安全 IP 白名单中不包含 0.0.0.0/0。"}, Reason: models.I18nString{"de": "Eine offene MongoDB-Whitelist erlaubt uneingeschränkten Zugriff auf sensible Daten über das Internet.", "en": "An open MongoDB whitelist allows unrestricted access to sensitive data over the internet.", "es": "Una lista blanca MongoDB abierta permite acceso sin restricciones a datos sensibles a través de Internet.", "fr": "Une liste blanche MongoDB ouverte permet un accès sans restriction aux données sensibles via Internet.", "ja": "オープンな MongoDB ホワイトリストは、インターネット経由で機密データへの無制限アクセスを許可します。", "pt": "Uma lista branca MongoDB aberta permite acesso irrestrito a dados sensíveis pela Internet.", "zh": "开放的 MongoDB 白名单允许通过互联网无限制地访问敏感数据。"}, Recommendation: models.I18nString{"de": "Beschränken Sie die MongoDB-Whitelist auf vertrauenswürdige IP-Bereiche.", "en": "Restrict the MongoDB whitelist to trusted IP ranges.", "es": "Restrinja la lista blanca MongoDB a rangos de IP confiables.", "fr": "Restreignez la liste blanche MongoDB aux plages d'IP de confiance.", "ja": "MongoDB ホワイトリストを信頼できる IP 範囲に制限します。", "pt": "Restrinja a lista branca MongoDB a intervalos de IP confiáveis.", "zh": "将 MongoDB 白名单限制在可信 IP 范围内。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-public-access-check.rego", PackageName: "infraguard.rules.aliyun.mongodb_public_access_check", Content: "package infraguard.rules.aliyun.mongodb_public_access_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"mongodb-public-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Whitelist Internet Restriction\",\n\t\t\"zh\": \"MongoDB 白名单禁用公网开放\",\n\t\t\"ja\": \"MongoDB ホワイトリストインターネット制限\",\n\t\t\"de\": \"MongoDB-Whitelist Internet-Einschränkung\",\n\t\t\"es\": \"Restricción de Internet de Lista Blanca MongoDB\",\n\t\t\"fr\": \"Restriction Internet de Liste Blanche MongoDB\",\n\t\t\"pt\": \"Restrição de Internet da Lista Branca MongoDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures MongoDB security IP whitelists do not contain 0.0.0.0/0.\",\n\t\t\"zh\": \"确保 MongoDB 安全 IP 白名单中不包含 0.0.0.0/0。\",\n\t\t\"ja\": \"MongoDB セキュリティ IP ホワイトリストに 0.0.0.0/0 が含まれていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Sicherheits-IP-Whitelists 0.0.0.0/0 nicht enthalten.\",\n\t\t\"es\": \"Garantiza que las listas blancas de IP de seguridad MongoDB no contengan 0.0.0.0/0.\",\n\t\t\"fr\": \"Garantit que les listes blanches d'IP de sécurité MongoDB ne contiennent pas 0.0.0.0/0.\",\n\t\t\"pt\": \"Garante que as listas brancas de IP de segurança MongoDB não contenham 0.0.0.0/0.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"An open MongoDB whitelist allows unrestricted access to sensitive data over the internet.\",\n\t\t\"zh\": \"开放的 MongoDB 白名单允许通过互联网无限制地访问敏感数据。\",\n\t\t\"ja\": \"オープンな MongoDB ホワイトリストは、インターネット経由で機密データへの無制限アクセスを許可します。\",\n\t\t\"de\": \"Eine offene MongoDB-Whitelist erlaubt uneingeschränkten Zugriff auf sensible Daten über das Internet.\",\n\t\t\"es\": \"Una lista blanca MongoDB abierta permite acceso sin restricciones a datos sensibles a través de Internet.\",\n\t\t\"fr\": \"Une liste blanche MongoDB ouverte permet un accès sans restriction aux données sensibles via Internet.\",\n\t\t\"pt\": \"Uma lista branca MongoDB aberta permite acesso irrestrito a dados sensíveis pela Internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict the MongoDB whitelist to trusted IP ranges.\",\n\t\t\"zh\": \"将 MongoDB 白名单限制在可信 IP 范围内。\",\n\t\t\"ja\": \"MongoDB ホワイトリストを信頼できる IP 範囲に制限します。\",\n\t\t\"de\": \"Beschränken Sie die MongoDB-Whitelist auf vertrauenswürdige IP-Bereiche.\",\n\t\t\"es\": \"Restrinja la lista blanca MongoDB a rangos de IP confiables.\",\n\t\t\"fr\": \"Restreignez la liste blanche MongoDB aux plages d'IP de confiance.\",\n\t\t\"pt\": \"Restrinja a lista branca MongoDB a intervalos de IP confiáveis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\nis_compliant(resource) if {\n\twhitelist_str := helpers.get_property(resource, \"SecurityIPArray\", \"\")\n\twhitelist := split(whitelist_str, \",\")\n\tnot has_public_ip(whitelist)\n}\n\nhas_public_ip(whitelist) if {\n\tsome ip in whitelist\n\thelpers.is_public_cidr(trim_space(ip))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MONGODB::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityIPArray\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mongodb-public-and-any-ip-access-check", Name: models.I18nString{"de": "MongoDB öffentlicher und beliebiger IP-Zugriff-Prüfung", "en": "MongoDB Public and Any IP Access Check", "es": "Verificación de Acceso Público y de Cualquier IP de MongoDB", "fr": "Vérification d'Accès Public et de N'importe Quelle IP MongoDB", "ja": "MongoDB のパブリックおよび任意の IP アクセスチェック", "pt": "Verificação de Acesso Público e de Qualquer IP do MongoDB", "zh": "MongoDB 实例不开启公网或安全白名单不设置为允许任意来源访问"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MongoDB-Instanzen keine offene Whitelist (0.0.0.0/0) haben.", "en": "Ensures that MongoDB instances do not have an open whitelist (0.0.0.0/0).", "es": "Garantiza que las instancias MongoDB no tengan una lista blanca abierta (0.0.0.0/0).", "fr": "Garantit que les instances MongoDB n'ont pas de liste blanche ouverte (0.0.0.0/0).", "ja": "MongoDB インスタンスにオープンホワイトリスト（0.0.0.0/0）が設定されていないことを確認します。", "pt": "Garante que as instâncias MongoDB não tenham uma lista branca aberta (0.0.0.0/0).", "zh": "确保 MongoDB 实例未设置开放白名单（0.0.0.0/0）。"}, Reason: models.I18nString{"de": "Das Setzen der Whitelist auf 0.0.0.0/0 erlaubt jeder IP, eine Verbindung zu versuchen, was das Risiko von Datenlecks oder Brute-Force-Angriffen erheblich erhöht.", "en": "Setting the whitelist to 0.0.0.0/0 allows any IP to attempt connection, significantly increasing the risk of data breaches or brute force attacks.", "es": "Establecer la lista blanca en 0.0.0.0/0 permite que cualquier IP intente conectarse, aumentando significativamente el riesgo de violaciones de datos o ataques de fuerza bruta.", "fr": "Définir la liste blanche sur 0.0.0.0/0 permet à n'importe quelle IP de tenter une connexion, augmentant considérablement le risque de violations de données ou d'attaques par force brute.", "ja": "ホワイトリストを 0.0.0.0/0 に設定すると、任意の IP が接続を試みることができ、データ侵害やブルートフォース攻撃のリスクが大幅に増加します。", "pt": "Definir a lista branca como 0.0.0.0/0 permite que qualquer IP tente conexão, aumentando significativamente o risco de violações de dados ou ataques de força bruta.", "zh": "将白名单设置为 0.0.0.0/0 允许任何 IP 尝试连接，大大增加了数据泄露或暴力破解的风险。"}, Recommendation: models.I18nString{"de": "Beschränken Sie die IP-Whitelist für die MongoDB-Instanz auf spezifische vertrauenswürdige IP-Bereiche.", "en": "Restrict the IP whitelist for the MongoDB instance to specific trusted IP ranges.", "es": "Restrinja la lista blanca de IP para la instancia MongoDB a rangos de IP confiables específicos.", "fr": "Restreignez la liste blanche IP pour l'instance MongoDB à des plages d'IP de confiance spécifiques.", "ja": "MongoDB インスタンスの IP ホワイトリストを特定の信頼できる IP 範囲に制限します。", "pt": "Restrinja a lista branca de IP para a instância MongoDB a intervalos de IP confiáveis específicos.", "zh": "将 MongoDB 实例的 IP 白名单限制为特定的可信 IP 范围。"}, ResourceTypes: []string{"ALIYUN::MONGODB::Instance"}, FilePath: "aliyun/rules/mongodb-public-and-any-ip-access-check.rego", PackageName: "infraguard.rules.aliyun.mongodb_public_and_any_ip_access_check", Content: "package infraguard.rules.aliyun.mongodb_public_and_any_ip_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mongodb-public-and-any-ip-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MongoDB Public and Any IP Access Check\",\n\t\t\"zh\": \"MongoDB 实例不开启公网或安全白名单不设置为允许任意来源访问\",\n\t\t\"ja\": \"MongoDB のパブリックおよび任意の IP アクセスチェック\",\n\t\t\"de\": \"MongoDB öffentlicher und beliebiger IP-Zugriff-Prüfung\",\n\t\t\"es\": \"Verificación de Acceso Público y de Cualquier IP de MongoDB\",\n\t\t\"fr\": \"Vérification d'Accès Public et de N'importe Quelle IP MongoDB\",\n\t\t\"pt\": \"Verificação de Acesso Público e de Qualquer IP do MongoDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that MongoDB instances do not have an open whitelist (0.0.0.0/0).\",\n\t\t\"zh\": \"确保 MongoDB 实例未设置开放白名单（0.0.0.0/0）。\",\n\t\t\"ja\": \"MongoDB インスタンスにオープンホワイトリスト（0.0.0.0/0）が設定されていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MongoDB-Instanzen keine offene Whitelist (0.0.0.0/0) haben.\",\n\t\t\"es\": \"Garantiza que las instancias MongoDB no tengan una lista blanca abierta (0.0.0.0/0).\",\n\t\t\"fr\": \"Garantit que les instances MongoDB n'ont pas de liste blanche ouverte (0.0.0.0/0).\",\n\t\t\"pt\": \"Garante que as instâncias MongoDB não tenham uma lista branca aberta (0.0.0.0/0).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Setting the whitelist to 0.0.0.0/0 allows any IP to attempt connection, significantly increasing the risk of data breaches or brute force attacks.\",\n\t\t\"zh\": \"将白名单设置为 0.0.0.0/0 允许任何 IP 尝试连接，大大增加了数据泄露或暴力破解的风险。\",\n\t\t\"ja\": \"ホワイトリストを 0.0.0.0/0 に設定すると、任意の IP が接続を試みることができ、データ侵害やブルートフォース攻撃のリスクが大幅に増加します。\",\n\t\t\"de\": \"Das Setzen der Whitelist auf 0.0.0.0/0 erlaubt jeder IP, eine Verbindung zu versuchen, was das Risiko von Datenlecks oder Brute-Force-Angriffen erheblich erhöht.\",\n\t\t\"es\": \"Establecer la lista blanca en 0.0.0.0/0 permite que cualquier IP intente conectarse, aumentando significativamente el riesgo de violaciones de datos o ataques de fuerza bruta.\",\n\t\t\"fr\": \"Définir la liste blanche sur 0.0.0.0/0 permet à n'importe quelle IP de tenter une connexion, augmentant considérablement le risque de violations de données ou d'attaques par force brute.\",\n\t\t\"pt\": \"Definir a lista branca como 0.0.0.0/0 permite que qualquer IP tente conexão, aumentando significativamente o risco de violações de dados ou ataques de força bruta.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict the IP whitelist for the MongoDB instance to specific trusted IP ranges.\",\n\t\t\"zh\": \"将 MongoDB 实例的 IP 白名单限制为特定的可信 IP 范围。\",\n\t\t\"ja\": \"MongoDB インスタンスの IP ホワイトリストを特定の信頼できる IP 範囲に制限します。\",\n\t\t\"de\": \"Beschränken Sie die IP-Whitelist für die MongoDB-Instanz auf spezifische vertrauenswürdige IP-Bereiche.\",\n\t\t\"es\": \"Restrinja la lista blanca de IP para la instancia MongoDB a rangos de IP confiables específicos.\",\n\t\t\"fr\": \"Restreignez la liste blanche IP pour l'instance MongoDB à des plages d'IP de confiance spécifiques.\",\n\t\t\"pt\": \"Restrinja a lista branca de IP para a instância MongoDB a intervalos de IP confiáveis específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MONGODB::Instance\"]\n}\n\nis_compliant(resource) if {\n\t# Check SecurityIPArray property (string)\n\twhitelist_str := helpers.get_property(resource, \"SecurityIPArray\", \"\")\n\twhitelist := split(whitelist_str, \",\")\n\tnot has_open_cidr(whitelist)\n}\n\nhas_open_cidr(whitelist) if {\n\tsome cidr in whitelist\n\thelpers.is_public_cidr(trim_space(cidr))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MONGODB::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityIPArray\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mse-cluster-architecture-check", Name: models.I18nString{"de": "MSE-Cluster hat mehrere Knoten", "en": "MSE Cluster Has Multiple Nodes", "es": "Clúster MSE Tiene Múltiples Nodos", "fr": "Le Cluster MSE a Plusieurs Nœuds", "ja": "MSE クラスターに複数のノードがある", "pt": "Cluster MSE Tem Múltiplos Nós", "zh": "MSE 注册配置中心多节点检测"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MSE (Microservice Engine)-Cluster mehr als 3 Knoten für hohe Verfügbarkeit haben.", "en": "Ensures that MSE (Microservice Engine) clusters have more than 3 nodes for high availability.", "es": "Garantiza que los clústeres MSE (Motor de Microservicios) tengan más de 3 nodos para alta disponibilidad.", "fr": "Garantit que les clusters MSE (Moteur de Microservices) ont plus de 3 nœuds pour une haute disponibilité.", "ja": "MSE（マイクロサービスエンジン）クラスターが高可用性のために3つ以上のノードを持つことを確認します。", "pt": "Garante que os clusters MSE (Motor de Microserviços) tenham mais de 3 nós para alta disponibilidade.", "zh": "确保 MSE（微服务引擎）集群具有超过 3 个节点以实现高可用性。"}, Reason: models.I18nString{"de": "Cluster mit 3 oder weniger Knoten bieten möglicherweise keine ausreichende hohe Verfügbarkeit.", "en": "Clusters with 3 or fewer nodes may not provide adequate high availability.", "es": "Los clústeres con 3 o menos nodos pueden no proporcionar alta disponibilidad adecuada.", "fr": "Les clusters avec 3 nœuds ou moins peuvent ne pas fournir une haute disponibilité adéquate.", "ja": "3つ以下のノードを持つクラスターは、十分な高可用性を提供できない可能性があります。", "pt": "Clusters com 3 ou menos nós podem não fornecer alta disponibilidade adequada.", "zh": "3 个或更少节点的集群可能无法提供足够的高可用性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie den MSE-Cluster mit mehr als 3 Knoten.", "en": "Configure the MSE cluster with more than 3 nodes.", "es": "Configure el clúster MSE con más de 3 nodos.", "fr": "Configurez le cluster MSE avec plus de 3 nœuds.", "ja": "MSE クラスターを3つ以上のノードで設定します。", "pt": "Configure o cluster MSE com mais de 3 nós.", "zh": "将 MSE 集群配置为超过 3 个节点。"}, ResourceTypes: []string{"ALIYUN::MSE::Cluster"}, FilePath: "aliyun/rules/mse-cluster-architecture-check.rego", PackageName: "infraguard.rules.aliyun.mse_cluster_architecture_check", Content: "package infraguard.rules.aliyun.mse_cluster_architecture_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mse-cluster-architecture-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MSE Cluster Has Multiple Nodes\",\n\t\t\"zh\": \"MSE 注册配置中心多节点检测\",\n\t\t\"ja\": \"MSE クラスターに複数のノードがある\",\n\t\t\"de\": \"MSE-Cluster hat mehrere Knoten\",\n\t\t\"es\": \"Clúster MSE Tiene Múltiples Nodos\",\n\t\t\"fr\": \"Le Cluster MSE a Plusieurs Nœuds\",\n\t\t\"pt\": \"Cluster MSE Tem Múltiplos Nós\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that MSE (Microservice Engine) clusters have more than 3 nodes for high availability.\",\n\t\t\"zh\": \"确保 MSE（微服务引擎）集群具有超过 3 个节点以实现高可用性。\",\n\t\t\"ja\": \"MSE（マイクロサービスエンジン）クラスターが高可用性のために3つ以上のノードを持つことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MSE (Microservice Engine)-Cluster mehr als 3 Knoten für hohe Verfügbarkeit haben.\",\n\t\t\"es\": \"Garantiza que los clústeres MSE (Motor de Microservicios) tengan más de 3 nodos para alta disponibilidad.\",\n\t\t\"fr\": \"Garantit que les clusters MSE (Moteur de Microservices) ont plus de 3 nœuds pour une haute disponibilité.\",\n\t\t\"pt\": \"Garante que os clusters MSE (Motor de Microserviços) tenham mais de 3 nós para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Clusters with 3 or fewer nodes may not provide adequate high availability.\",\n\t\t\"zh\": \"3 个或更少节点的集群可能无法提供足够的高可用性。\",\n\t\t\"ja\": \"3つ以下のノードを持つクラスターは、十分な高可用性を提供できない可能性があります。\",\n\t\t\"de\": \"Cluster mit 3 oder weniger Knoten bieten möglicherweise keine ausreichende hohe Verfügbarkeit.\",\n\t\t\"es\": \"Los clústeres con 3 o menos nodos pueden no proporcionar alta disponibilidad adecuada.\",\n\t\t\"fr\": \"Les clusters avec 3 nœuds ou moins peuvent ne pas fournir une haute disponibilité adéquate.\",\n\t\t\"pt\": \"Clusters com 3 ou menos nós podem não fornecer alta disponibilidade adequada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the MSE cluster with more than 3 nodes.\",\n\t\t\"zh\": \"将 MSE 集群配置为超过 3 个节点。\",\n\t\t\"ja\": \"MSE クラスターを3つ以上のノードで設定します。\",\n\t\t\"de\": \"Konfigurieren Sie den MSE-Cluster mit mehr als 3 Knoten.\",\n\t\t\"es\": \"Configure el clúster MSE con más de 3 nodos.\",\n\t\t\"fr\": \"Configurez le cluster MSE avec plus de 3 nœuds.\",\n\t\t\"pt\": \"Configure o cluster MSE com mais de 3 nós.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MSE::Cluster\"]\n}\n\n# Get node count from cluster\nget_node_count(resource) := node_count if {\n\t# Try Nodes array first\n\tnodes := helpers.get_property(resource, \"Nodes\", [])\n\tcount(nodes) > 0\n\tnode_count := count(nodes)\n} else := node_count if {\n\t# Fall back to InstanceCount\n\tinstance_count := helpers.get_property(resource, \"InstanceCount\", 0)\n\tnode_count := instance_count\n}\n\n# Check if cluster has more than 3 nodes\nhas_multi_nodes(resource) if {\n\tget_node_count(resource) > 3\n}\n\nis_compliant(resource) if {\n\thas_multi_nodes(resource)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MSE::Cluster\")\n\tnot has_multi_nodes(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Nodes\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mse-cluster-config-auth-enabled", Name: models.I18nString{"de": "MSE-Cluster Config Auth aktiviert", "en": "MSE Cluster Config Auth Enabled", "es": "Autenticación de Configuración de Clúster MSE Habilitada", "fr": "Authentification de Configuration de Cluster MSE Activée", "ja": "MSE クラスタ設定認証が有効", "pt": "Autenticação de Configuração de Cluster MSE Habilitada", "zh": "MSE 集群配置中心开启鉴权"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass das Konfigurationszentrum des Microservices Engine (MSE)-Clusters Authentifizierung aktiviert hat.", "en": "Ensures that the Microservices Engine (MSE) cluster configuration center has authentication enabled.", "es": "Garantiza que el centro de configuración del clúster del Motor de Microservicios (MSE) tenga autenticación habilitada.", "fr": "Garantit que le centre de configuration du cluster du moteur de microservices (MSE) a l'authentification activée.", "ja": "マイクロサービスエンジン（MSE）クラスタ設定センターで認証が有効になっていることを確認します。", "pt": "Garante que o centro de configuração do cluster do Motor de Microserviços (MSE) tenha autenticação habilitada.", "zh": "确保微服务引擎(MSE)集群配置中心已开启鉴权。"}, Reason: models.I18nString{"de": "Die Aktivierung der Authentifizierung verhindert unbefugten Zugriff auf Dienstkonfigurationen.", "en": "Enabling authentication prevents unauthorized access to service configurations.", "es": "Habilitar la autenticación previene el acceso no autorizado a las configuraciones del servicio.", "fr": "L'activation de l'authentification empêche l'accès non autorisé aux configurations de service.", "ja": "認証を有効にすることで、サービス設定への不正アクセスを防ぎます。", "pt": "Habilitar a autenticação impede o acesso não autorizado às configurações do serviço.", "zh": "开启鉴权可防止对服务配置的未经授权访问。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Authentifizierung für das MSE-Cluster-Konfigurationszentrum.", "en": "Enable authentication for the MSE cluster configuration center.", "es": "Habilite la autenticación para el centro de configuración del clúster MSE.", "fr": "Activez l'authentification pour le centre de configuration du cluster MSE.", "ja": "MSE クラスタ設定センターの認証を有効にします。", "pt": "Habilite a autenticação para o centro de configuração do cluster MSE.", "zh": "为 MSE 集群配置中心开启鉴权。"}, ResourceTypes: []string{"ALIYUN::MSE::Cluster"}, FilePath: "aliyun/rules/mse-cluster-config-auth-enabled.rego", PackageName: "infraguard.rules.aliyun.mse_cluster_config_auth_enabled", Content: "package infraguard.rules.aliyun.mse_cluster_config_auth_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"mse-cluster-config-auth-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MSE Cluster Config Auth Enabled\",\n\t\t\"zh\": \"MSE 集群配置中心开启鉴权\",\n\t\t\"ja\": \"MSE クラスタ設定認証が有効\",\n\t\t\"de\": \"MSE-Cluster Config Auth aktiviert\",\n\t\t\"es\": \"Autenticación de Configuración de Clúster MSE Habilitada\",\n\t\t\"fr\": \"Authentification de Configuration de Cluster MSE Activée\",\n\t\t\"pt\": \"Autenticação de Configuração de Cluster MSE Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the Microservices Engine (MSE) cluster configuration center has authentication enabled.\",\n\t\t\"zh\": \"确保微服务引擎(MSE)集群配置中心已开启鉴权。\",\n\t\t\"ja\": \"マイクロサービスエンジン（MSE）クラスタ設定センターで認証が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass das Konfigurationszentrum des Microservices Engine (MSE)-Clusters Authentifizierung aktiviert hat.\",\n\t\t\"es\": \"Garantiza que el centro de configuración del clúster del Motor de Microservicios (MSE) tenga autenticación habilitada.\",\n\t\t\"fr\": \"Garantit que le centre de configuration du cluster du moteur de microservices (MSE) a l'authentification activée.\",\n\t\t\"pt\": \"Garante que o centro de configuração do cluster do Motor de Microserviços (MSE) tenha autenticação habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Enabling authentication prevents unauthorized access to service configurations.\",\n\t\t\"zh\": \"开启鉴权可防止对服务配置的未经授权访问。\",\n\t\t\"ja\": \"認証を有効にすることで、サービス設定への不正アクセスを防ぎます。\",\n\t\t\"de\": \"Die Aktivierung der Authentifizierung verhindert unbefugten Zugriff auf Dienstkonfigurationen.\",\n\t\t\"es\": \"Habilitar la autenticación previene el acceso no autorizado a las configuraciones del servicio.\",\n\t\t\"fr\": \"L'activation de l'authentification empêche l'accès non autorisé aux configurations de service.\",\n\t\t\"pt\": \"Habilitar a autenticação impede o acesso não autorizado às configurações do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable authentication for the MSE cluster configuration center.\",\n\t\t\"zh\": \"为 MSE 集群配置中心开启鉴权。\",\n\t\t\"ja\": \"MSE クラスタ設定センターの認証を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Authentifizierung für das MSE-Cluster-Konfigurationszentrum.\",\n\t\t\"es\": \"Habilite la autenticación para el centro de configuración del clúster MSE.\",\n\t\t\"fr\": \"Activez l'authentification pour le centre de configuration du cluster MSE.\",\n\t\t\"pt\": \"Habilite a autenticação para o centro de configuração do cluster MSE.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MSE::Cluster\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MSE::Cluster\")\n\n\t# Conceptual check for auth\n\tnot helpers.has_property(resource, \"ConfigAuthEnabled\") # Simplified\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mse-cluster-internet-check", Name: models.I18nString{"de": "MSE-Cluster hat keinen öffentlichen Internetzugriff", "en": "MSE Cluster Has No Public Internet Access", "es": "El Clúster MSE No Tiene Acceso Público a Internet", "fr": "Le Cluster MSE N'a Pas d'Accès Internet Public", "ja": "MSE クラスターにパブリックインターネットアクセスがない", "pt": "O Cluster MSE Não Tem Acesso Público à Internet", "zh": "MSE 集群公网检测"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MSE-Cluster keinen öffentlichen Internetzugriff aktiviert haben.", "en": "Ensures that MSE clusters do not have public internet access enabled.", "es": "Garantiza que los clústeres MSE no tengan acceso público a Internet habilitado.", "fr": "Garantit que les clusters MSE n'ont pas d'accès Internet public activé.", "ja": "MSE クラスターでパブリックインターネットアクセスが有効になっていないことを確認します。", "pt": "Garante que os clusters MSE não tenham acesso público à Internet habilitado.", "zh": "确保 MSE 集群未开放公网访问。"}, Reason: models.I18nString{"de": "Öffentlicher Internetzugriff erhöht die Angriffsfläche und Sicherheitsrisiken für den Cluster.", "en": "Public internet access increases the attack surface and security risks for the cluster.", "es": "El acceso público a Internet aumenta la superficie de ataque y los riesgos de seguridad del clúster.", "fr": "L'accès Internet public augmente la surface d'attaque et les risques de sécurité pour le cluster.", "ja": "パブリックインターネットアクセスは、クラスターの攻撃面とセキュリティリスクを増加させます。", "pt": "O acesso público à Internet aumenta a superfície de ataque e os riscos de segurança do cluster.", "zh": "公网访问增加了集群的攻击面和安全风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie den MSE-Cluster so, dass nur privater Netzwerkzugriff verwendet wird.", "en": "Configure the MSE cluster to use private network access only.", "es": "Configure el clúster MSE para usar solo acceso de red privada.", "fr": "Configurez le cluster MSE pour utiliser uniquement l'accès réseau privé.", "ja": "MSE クラスターをプライベートネットワークアクセスのみを使用するように設定します。", "pt": "Configure o cluster MSE para usar apenas acesso de rede privada.", "zh": "配置 MSE 集群仅使用内网访问。"}, ResourceTypes: []string{"ALIYUN::MSE::Cluster"}, FilePath: "aliyun/rules/mse-cluster-internet-check.rego", PackageName: "infraguard.rules.aliyun.mse_cluster_internet_check", Content: "package infraguard.rules.aliyun.mse_cluster_internet_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mse-cluster-internet-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MSE Cluster Has No Public Internet Access\",\n\t\t\"zh\": \"MSE 集群公网检测\",\n\t\t\"ja\": \"MSE クラスターにパブリックインターネットアクセスがない\",\n\t\t\"de\": \"MSE-Cluster hat keinen öffentlichen Internetzugriff\",\n\t\t\"es\": \"El Clúster MSE No Tiene Acceso Público a Internet\",\n\t\t\"fr\": \"Le Cluster MSE N'a Pas d'Accès Internet Public\",\n\t\t\"pt\": \"O Cluster MSE Não Tem Acesso Público à Internet\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that MSE clusters do not have public internet access enabled.\",\n\t\t\"zh\": \"确保 MSE 集群未开放公网访问。\",\n\t\t\"ja\": \"MSE クラスターでパブリックインターネットアクセスが有効になっていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MSE-Cluster keinen öffentlichen Internetzugriff aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los clústeres MSE no tengan acceso público a Internet habilitado.\",\n\t\t\"fr\": \"Garantit que les clusters MSE n'ont pas d'accès Internet public activé.\",\n\t\t\"pt\": \"Garante que os clusters MSE não tenham acesso público à Internet habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Public internet access increases the attack surface and security risks for the cluster.\",\n\t\t\"zh\": \"公网访问增加了集群的攻击面和安全风险。\",\n\t\t\"ja\": \"パブリックインターネットアクセスは、クラスターの攻撃面とセキュリティリスクを増加させます。\",\n\t\t\"de\": \"Öffentlicher Internetzugriff erhöht die Angriffsfläche und Sicherheitsrisiken für den Cluster.\",\n\t\t\"es\": \"El acceso público a Internet aumenta la superficie de ataque y los riesgos de seguridad del clúster.\",\n\t\t\"fr\": \"L'accès Internet public augmente la surface d'attaque et les risques de sécurité pour le cluster.\",\n\t\t\"pt\": \"O acesso público à Internet aumenta a superfície de ataque e os riscos de segurança do cluster.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the MSE cluster to use private network access only.\",\n\t\t\"zh\": \"配置 MSE 集群仅使用内网访问。\",\n\t\t\"ja\": \"MSE クラスターをプライベートネットワークアクセスのみを使用するように設定します。\",\n\t\t\"de\": \"Konfigurieren Sie den MSE-Cluster so, dass nur privater Netzwerkzugriff verwendet wird.\",\n\t\t\"es\": \"Configure el clúster MSE para usar solo acceso de red privada.\",\n\t\t\"fr\": \"Configurez le cluster MSE pour utiliser uniquement l'accès réseau privé.\",\n\t\t\"pt\": \"Configure o cluster MSE para usar apenas acesso de rede privada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MSE::Cluster\"]\n}\n\n# Check if cluster has public internet access\nhas_public_internet(resource) if {\n\tnet_type := helpers.get_property(resource, \"NetType\", \"privatenet\")\n\tnet_type == \"pubnet\"\n}\n\nhas_public_internet(resource) if {\n\tpub_network_flow := helpers.get_property(resource, \"PubNetworkFlow\", 0)\n\tpub_network_flow > 0\n}\n\nhas_public_internet(resource) if {\n\tconnection_type := helpers.get_property(resource, \"ConnectionType\", \"\")\n\tconnection_type == \"single_eni\"\n\teip_enabled := helpers.get_property(resource, \"EipEnabled\", false)\n\thelpers.is_true(eip_enabled)\n}\n\nis_compliant(resource) if {\n\tnot has_public_internet(resource)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MSE::Cluster\")\n\thas_public_internet(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"NetType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mse-cluster-multi-availability-area-architecture-check", Name: models.I18nString{"de": "MSE-Cluster Hochverfügbarkeitskonfiguration", "en": "MSE Cluster High-Availability Configuration", "es": "Configuración de Alta Disponibilidad del Clúster MSE", "fr": "Configuration de Haute Disponibilité du Cluster MSE", "ja": "MSE クラスター高可用性設定", "pt": "Configuração de Alta Disponibilidade do Cluster MSE", "zh": "使用高可用版本的 MSE 注册配置中心"}, Severity: "medium", Description: models.I18nString{"de": "MSE-Cluster sollten die Professional Edition mit mindestens 3 Instanzen (ungerade Zahl) für Hochverfügbarkeit verwenden.", "en": "MSE clusters should use the Professional Edition with at least 3 instances (odd number) for high availability.", "es": "Los clústeres MSE deben usar la Edición Profesional con al menos 3 instancias (número impar) para alta disponibilidad.", "fr": "Les clusters MSE doivent utiliser l'Édition Professionnelle avec au moins 3 instances (nombre impair) pour une haute disponibilité.", "ja": "MSE クラスターは高可用性のために少なくとも 3 つのインスタンス（奇数）を持つプロフェッショナル版を使用する必要があります。", "pt": "Os clusters MSE devem usar a Edição Profissional com pelo menos 3 instâncias (número ímpar) para alta disponibilidade.", "zh": "使用高可用版本的 MSE 注册配置中心，视为合规。"}, Reason: models.I18nString{"de": "Der MSE-Cluster erfüllt nicht die Hochverfügbarkeitsanforderungen (Professional Edition erfordert InstanceCount >= 3 und ungerade Zahl).", "en": "The MSE cluster does not meet high-availability requirements (Professional Edition requires InstanceCount >= 3 and odd number).", "es": "El clúster MSE no cumple con los requisitos de alta disponibilidad (la Edición Profesional requiere InstanceCount >= 3 y número impar).", "fr": "Le cluster MSE ne répond pas aux exigences de haute disponibilité (l'Édition Professionnelle nécessite InstanceCount >= 3 et nombre impair).", "ja": "MSE クラスターが高可用性要件を満たしていません（プロフェッショナル版では InstanceCount >= 3 かつ奇数が必要）。", "pt": "O cluster MSE não atende aos requisitos de alta disponibilidade (a Edição Profissional requer InstanceCount >= 3 e número ímpar).", "zh": "MSE 集群不满足高可用性要求（专业版要求 InstanceCount >= 3 且为奇数）。"}, Recommendation: models.I18nString{"de": "Verwenden Sie die Professional Edition (MseVersion: mse_pro) und setzen Sie InstanceCount auf mindestens 3 (ungerade Zahl) für Hochverfügbarkeit.", "en": "Use Professional Edition (MseVersion: mse_pro) and set InstanceCount to at least 3 (odd number) for high availability.", "es": "Use la Edición Profesional (MseVersion: mse_pro) y establezca InstanceCount en al menos 3 (número impar) para alta disponibilidad.", "fr": "Utilisez l'Édition Professionnelle (MseVersion: mse_pro) et définissez InstanceCount sur au moins 3 (nombre impair) pour une haute disponibilité.", "ja": "プロフェッショナル版（MseVersion: mse_pro）を使用し、高可用性のために InstanceCount を少なくとも 3（奇数）に設定します。", "pt": "Use a Edição Profissional (MseVersion: mse_pro) e defina InstanceCount para pelo menos 3 (número ímpar) para alta disponibilidade.", "zh": "使用专业版（MseVersion: mse_pro）并将 InstanceCount 设置为至少 3（奇数）以实现高可用性。"}, ResourceTypes: []string{"ALIYUN::MSE::Cluster"}, FilePath: "aliyun/rules/mse-cluster-multi-availability-area-architecture-check.rego", PackageName: "infraguard.rules.aliyun.mse_cluster_multi_availability_area_architecture_check", Content: "package infraguard.rules.aliyun.mse_cluster_multi_availability_area_architecture_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"mse-cluster-multi-availability-area-architecture-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MSE Cluster High-Availability Configuration\",\n\t\t\"zh\": \"使用高可用版本的 MSE 注册配置中心\",\n\t\t\"ja\": \"MSE クラスター高可用性設定\",\n\t\t\"de\": \"MSE-Cluster Hochverfügbarkeitskonfiguration\",\n\t\t\"es\": \"Configuración de Alta Disponibilidad del Clúster MSE\",\n\t\t\"fr\": \"Configuration de Haute Disponibilité du Cluster MSE\",\n\t\t\"pt\": \"Configuração de Alta Disponibilidade do Cluster MSE\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"MSE clusters should use the Professional Edition with at least 3 instances (odd number) for high availability.\",\n\t\t\"zh\": \"使用高可用版本的 MSE 注册配置中心，视为合规。\",\n\t\t\"ja\": \"MSE クラスターは高可用性のために少なくとも 3 つのインスタンス（奇数）を持つプロフェッショナル版を使用する必要があります。\",\n\t\t\"de\": \"MSE-Cluster sollten die Professional Edition mit mindestens 3 Instanzen (ungerade Zahl) für Hochverfügbarkeit verwenden.\",\n\t\t\"es\": \"Los clústeres MSE deben usar la Edición Profesional con al menos 3 instancias (número impar) para alta disponibilidad.\",\n\t\t\"fr\": \"Les clusters MSE doivent utiliser l'Édition Professionnelle avec au moins 3 instances (nombre impair) pour une haute disponibilité.\",\n\t\t\"pt\": \"Os clusters MSE devem usar a Edição Profissional com pelo menos 3 instâncias (número ímpar) para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The MSE cluster does not meet high-availability requirements (Professional Edition requires InstanceCount >= 3 and odd number).\",\n\t\t\"zh\": \"MSE 集群不满足高可用性要求（专业版要求 InstanceCount >= 3 且为奇数）。\",\n\t\t\"ja\": \"MSE クラスターが高可用性要件を満たしていません（プロフェッショナル版では InstanceCount >= 3 かつ奇数が必要）。\",\n\t\t\"de\": \"Der MSE-Cluster erfüllt nicht die Hochverfügbarkeitsanforderungen (Professional Edition erfordert InstanceCount >= 3 und ungerade Zahl).\",\n\t\t\"es\": \"El clúster MSE no cumple con los requisitos de alta disponibilidad (la Edición Profesional requiere InstanceCount >= 3 y número impar).\",\n\t\t\"fr\": \"Le cluster MSE ne répond pas aux exigences de haute disponibilité (l'Édition Professionnelle nécessite InstanceCount >= 3 et nombre impair).\",\n\t\t\"pt\": \"O cluster MSE não atende aos requisitos de alta disponibilidade (a Edição Profissional requer InstanceCount >= 3 e número ímpar).\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use Professional Edition (MseVersion: mse_pro) and set InstanceCount to at least 3 (odd number) for high availability.\",\n\t\t\"zh\": \"使用专业版（MseVersion: mse_pro）并将 InstanceCount 设置为至少 3（奇数）以实现高可用性。\",\n\t\t\"ja\": \"プロフェッショナル版（MseVersion: mse_pro）を使用し、高可用性のために InstanceCount を少なくとも 3（奇数）に設定します。\",\n\t\t\"de\": \"Verwenden Sie die Professional Edition (MseVersion: mse_pro) und setzen Sie InstanceCount auf mindestens 3 (ungerade Zahl) für Hochverfügbarkeit.\",\n\t\t\"es\": \"Use la Edición Profesional (MseVersion: mse_pro) y establezca InstanceCount en al menos 3 (número impar) para alta disponibilidad.\",\n\t\t\"fr\": \"Utilisez l'Édition Professionnelle (MseVersion: mse_pro) et définissez InstanceCount sur au moins 3 (nombre impair) pour une haute disponibilité.\",\n\t\t\"pt\": \"Use a Edição Profissional (MseVersion: mse_pro) e defina InstanceCount para pelo menos 3 (número ímpar) para alta disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MSE::Cluster\"]\n}\n\n# Check if cluster is Professional Edition\nis_professional_edition(resource) if {\n\thelpers.has_property(resource, \"MseVersion\")\n\tmse_version := resource.Properties.MseVersion\n\tmse_version == \"mse_pro\"\n}\n\n# Check if instance count meets HA requirements (>= 3 and odd)\nhas_ha_instance_count(resource) if {\n\tinstance_count := resource.Properties.InstanceCount\n\tinstance_count >= 3\n\tinstance_count % 2 == 1\n}\n\n# Check if cluster is high availability\nis_high_availability(resource) if {\n\tis_professional_edition(resource)\n\thas_ha_instance_count(resource)\n}\n\n# Deny rule: MSE clusters should be high availability\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MSE::Cluster\")\n\tnot is_high_availability(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mse-cluster-stable-version-check", Name: models.I18nString{"de": "MSE-Cluster verwendet stabile Version", "en": "MSE Cluster Uses Stable Version", "es": "El Clúster MSE Usa Versión Estable", "fr": "Le Cluster MSE Utilise une Version Stable", "ja": "MSE クラスターが安定バージョンを使用", "pt": "O Cluster MSE Usa Versão Estável", "zh": "MSE 注册配置中心引擎版本检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die MSE-Cluster-Engine-Version größer als die minimale stabile Version ist.", "en": "Ensures that MSE cluster engine version is greater than the minimum stable version.", "es": "Garantiza que la versión del motor del clúster MSE sea mayor que la versión estable mínima.", "fr": "Garantit que la version du moteur du cluster MSE est supérieure à la version stable minimale.", "ja": "MSE クラスターエンジンバージョンが最小安定バージョンより大きいことを確認します。", "pt": "Garante que a versão do motor do cluster MSE seja maior que a versão estável mínima.", "zh": "确保 MSE 集群引擎版本大于最小稳定版本。"}, Reason: models.I18nString{"de": "Ältere Versionen können Sicherheitslücken haben und die neuesten Funktionen fehlen.", "en": "Older versions may have security vulnerabilities and lack latest features.", "es": "Las versiones anteriores pueden tener vulnerabilidades de seguridad y carecer de las últimas funciones.", "fr": "Les versions antérieures peuvent avoir des vulnérabilités de sécurité et manquer des fonctionnalités les plus récentes.", "ja": "古いバージョンにはセキュリティの脆弱性があり、最新機能が不足している可能性があります。", "pt": "Versões mais antigas podem ter vulnerabilidades de segurança e faltar recursos mais recentes.", "zh": "旧版本可能存在安全漏洞且缺少最新功能。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie den MSE-Cluster auf eine stabile Version.", "en": "Upgrade the MSE cluster to a stable version.", "es": "Actualice el clúster MSE a una versión estable.", "fr": "Mettez à niveau le cluster MSE vers une version stable.", "ja": "MSE クラスターを安定バージョンにアップグレードします。", "pt": "Atualize o cluster MSE para uma versão estável.", "zh": "将 MSE 集群升级到稳定版本。"}, ResourceTypes: []string{"ALIYUN::MSE::Cluster"}, FilePath: "aliyun/rules/mse-cluster-stable-version-check.rego", PackageName: "infraguard.rules.aliyun.mse_cluster_stable_version_check", Content: "package infraguard.rules.aliyun.mse_cluster_stable_version_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mse-cluster-stable-version-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MSE Cluster Uses Stable Version\",\n\t\t\"zh\": \"MSE 注册配置中心引擎版本检测\",\n\t\t\"ja\": \"MSE クラスターが安定バージョンを使用\",\n\t\t\"de\": \"MSE-Cluster verwendet stabile Version\",\n\t\t\"es\": \"El Clúster MSE Usa Versión Estable\",\n\t\t\"fr\": \"Le Cluster MSE Utilise une Version Stable\",\n\t\t\"pt\": \"O Cluster MSE Usa Versão Estável\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that MSE cluster engine version is greater than the minimum stable version.\",\n\t\t\"zh\": \"确保 MSE 集群引擎版本大于最小稳定版本。\",\n\t\t\"ja\": \"MSE クラスターエンジンバージョンが最小安定バージョンより大きいことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die MSE-Cluster-Engine-Version größer als die minimale stabile Version ist.\",\n\t\t\"es\": \"Garantiza que la versión del motor del clúster MSE sea mayor que la versión estable mínima.\",\n\t\t\"fr\": \"Garantit que la version du moteur du cluster MSE est supérieure à la version stable minimale.\",\n\t\t\"pt\": \"Garante que a versão do motor do cluster MSE seja maior que a versão estável mínima.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Older versions may have security vulnerabilities and lack latest features.\",\n\t\t\"zh\": \"旧版本可能存在安全漏洞且缺少最新功能。\",\n\t\t\"ja\": \"古いバージョンにはセキュリティの脆弱性があり、最新機能が不足している可能性があります。\",\n\t\t\"de\": \"Ältere Versionen können Sicherheitslücken haben und die neuesten Funktionen fehlen.\",\n\t\t\"es\": \"Las versiones anteriores pueden tener vulnerabilidades de seguridad y carecer de las últimas funciones.\",\n\t\t\"fr\": \"Les versions antérieures peuvent avoir des vulnérabilités de sécurité et manquer des fonctionnalités les plus récentes.\",\n\t\t\"pt\": \"Versões mais antigas podem ter vulnerabilidades de segurança e faltar recursos mais recentes.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade the MSE cluster to a stable version.\",\n\t\t\"zh\": \"将 MSE 集群升级到稳定版本。\",\n\t\t\"ja\": \"MSE クラスターを安定バージョンにアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie den MSE-Cluster auf eine stabile Version.\",\n\t\t\"es\": \"Actualice el clúster MSE a una versión estable.\",\n\t\t\"fr\": \"Mettez à niveau le cluster MSE vers une version stable.\",\n\t\t\"pt\": \"Atualize o cluster MSE para uma versão estável.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MSE::Cluster\"]\n}\n\n# Default minimum stable version\ndefault_min_version := \"3.5.0\"\n\n# Get minimum version from parameter or use default\nget_min_version := version if {\n\tversion := input.parameters.minVersion\n\tis_string(version)\n} else := default_min_version\n\n# Compare version strings (simple implementation)\nversion_greater(v1, v2) if {\n\tv1_parts := split(v1, \".\")\n\tv2_parts := split(v2, \".\")\n\n\t# Compare major version\n\tto_number(v1_parts[0]) > to_number(v2_parts[0])\n}\n\nversion_greater(v1, v2) if {\n\tv1_parts := split(v1, \".\")\n\tv2_parts := split(v2, \".\")\n\n\t# Major versions equal, compare minor\n\tto_number(v1_parts[0]) == to_number(v2_parts[0])\n\tto_number(v1_parts[1]) > to_number(v2_parts[1])\n}\n\n# Check if cluster version is stable\nis_stable_version(resource) if {\n\tcluster_version := helpers.get_property(resource, \"ClusterVersion\", \"\")\n\tcluster_version != \"\"\n\n\t# Extract version number from ClusterVersion (e.g., \"ZooKeeper_3_8_0\" -> \"3.8.0\")\n\tversion_parts := split(cluster_version, \"_\")\n\tcount(version_parts) >= 4\n\n\t# For \"ZooKeeper_3_8_0\", parts are [\"ZooKeeper\", \"3\", \"8\", \"0\"]\n\tmajor := version_parts[1]\n\tminor := version_parts[2]\n\tpatch := version_parts[3]\n\tversion := sprintf(\"%s.%s.%s\", [major, minor, patch])\n\tversion_greater(version, get_min_version())\n}\n\nis_compliant(resource) if {\n\tis_stable_version(resource)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MSE::Cluster\")\n\tnot is_stable_version(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ClusterVersion\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mse-gateway-architecture-check", Name: models.I18nString{"de": "MSE-Gateway hat mehrere Knoten", "en": "MSE Gateway Has Multiple Nodes", "es": "La Puerta de Enlace MSE Tiene Múltiples Nodos", "fr": "La Passerelle MSE a Plusieurs Nœuds", "ja": "MSE ゲートウェイに複数のノードがある", "pt": "O Gateway MSE Tem Múltiplos Nós", "zh": "MSE 云原生网关多节点检测"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass MSE (Microservice Engine)-Gateways mehr als 1 Knoten für hohe Verfügbarkeit haben.", "en": "Ensures that MSE (Microservice Engine) gateways have more than 1 node for high availability.", "es": "Garantiza que las puertas de enlace MSE (Motor de Microservicios) tengan más de 1 nodo para alta disponibilidad.", "fr": "Garantit que les passerelles MSE (Moteur de Microservices) ont plus d'un nœud pour une haute disponibilité.", "ja": "MSE（マイクロサービスエンジン）ゲートウェイが高可用性のために 1 つ以上のノードを持つことを確認します。", "pt": "Garante que os gateways MSE (Motor de Microserviços) tenham mais de 1 nó para alta disponibilidade.", "zh": "确保 MSE（微服务引擎）网关具有超过 1 个节点以实现高可用性。"}, Reason: models.I18nString{"de": "Einzelknoten-Gateways erstellen einen Single Point of Failure und können zu Serviceunterbrechungen führen.", "en": "Single-node gateways create a single point of failure and may cause service interruption.", "es": "Las puertas de enlace de nodo único crean un punto único de falla y pueden causar interrupción del servicio.", "fr": "Les passerelles à nœud unique créent un point de défaillance unique et peuvent causer une interruption de service.", "ja": "単一ノードゲートウェイは単一障害点を作成し、サービス中断を引き起こす可能性があります。", "pt": "Gateways de nó único criam um ponto único de falha e podem causar interrupção do serviço.", "zh": "单节点网关存在单点故障，可能导致服务中断。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie das MSE-Gateway mit mindestens 2 Knoten.", "en": "Configure the MSE gateway with at least 2 nodes.", "es": "Configure la puerta de enlace MSE con al menos 2 nodos.", "fr": "Configurez la passerelle MSE avec au moins 2 nœuds.", "ja": "MSE ゲートウェイを少なくとも 2 つのノードで設定します。", "pt": "Configure o gateway MSE com pelo menos 2 nós.", "zh": "将 MSE 网关配置为至少 2 个节点。"}, ResourceTypes: []string{"ALIYUN::MSE::Gateway"}, FilePath: "aliyun/rules/mse-gateway-architecture-check.rego", PackageName: "infraguard.rules.aliyun.mse_gateway_architecture_check", Content: "package infraguard.rules.aliyun.mse_gateway_architecture_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"mse-gateway-architecture-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"MSE Gateway Has Multiple Nodes\",\n\t\t\"zh\": \"MSE 云原生网关多节点检测\",\n\t\t\"ja\": \"MSE ゲートウェイに複数のノードがある\",\n\t\t\"de\": \"MSE-Gateway hat mehrere Knoten\",\n\t\t\"es\": \"La Puerta de Enlace MSE Tiene Múltiples Nodos\",\n\t\t\"fr\": \"La Passerelle MSE a Plusieurs Nœuds\",\n\t\t\"pt\": \"O Gateway MSE Tem Múltiplos Nós\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that MSE (Microservice Engine) gateways have more than 1 node for high availability.\",\n\t\t\"zh\": \"确保 MSE（微服务引擎）网关具有超过 1 个节点以实现高可用性。\",\n\t\t\"ja\": \"MSE（マイクロサービスエンジン）ゲートウェイが高可用性のために 1 つ以上のノードを持つことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass MSE (Microservice Engine)-Gateways mehr als 1 Knoten für hohe Verfügbarkeit haben.\",\n\t\t\"es\": \"Garantiza que las puertas de enlace MSE (Motor de Microservicios) tengan más de 1 nodo para alta disponibilidad.\",\n\t\t\"fr\": \"Garantit que les passerelles MSE (Moteur de Microservices) ont plus d'un nœud pour une haute disponibilité.\",\n\t\t\"pt\": \"Garante que os gateways MSE (Motor de Microserviços) tenham mais de 1 nó para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Single-node gateways create a single point of failure and may cause service interruption.\",\n\t\t\"zh\": \"单节点网关存在单点故障，可能导致服务中断。\",\n\t\t\"ja\": \"単一ノードゲートウェイは単一障害点を作成し、サービス中断を引き起こす可能性があります。\",\n\t\t\"de\": \"Einzelknoten-Gateways erstellen einen Single Point of Failure und können zu Serviceunterbrechungen führen.\",\n\t\t\"es\": \"Las puertas de enlace de nodo único crean un punto único de falla y pueden causar interrupción del servicio.\",\n\t\t\"fr\": \"Les passerelles à nœud unique créent un point de défaillance unique et peuvent causer une interruption de service.\",\n\t\t\"pt\": \"Gateways de nó único criam um ponto único de falha e podem causar interrupção do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the MSE gateway with at least 2 nodes.\",\n\t\t\"zh\": \"将 MSE 网关配置为至少 2 个节点。\",\n\t\t\"ja\": \"MSE ゲートウェイを少なくとも 2 つのノードで設定します。\",\n\t\t\"de\": \"Konfigurieren Sie das MSE-Gateway mit mindestens 2 Knoten.\",\n\t\t\"es\": \"Configure la puerta de enlace MSE con al menos 2 nodos.\",\n\t\t\"fr\": \"Configurez la passerelle MSE avec au moins 2 nœuds.\",\n\t\t\"pt\": \"Configure o gateway MSE com pelo menos 2 nós.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MSE::Gateway\"]\n}\n\n# Get node count from gateway\nget_node_count(resource) := node_count if {\n\t# Use Replica property\n\treplica := helpers.get_property(resource, \"Replica\", 0)\n\treplica > 0\n\tnode_count := replica\n} else := node_count if {\n\t# Fall back to Nodes array\n\tnodes := helpers.get_property(resource, \"Nodes\", [])\n\tnode_count := count(nodes)\n}\n\n# Check if gateway has more than 1 node\nhas_multi_nodes(resource) if {\n\tget_node_count(resource) > 1\n}\n\nis_compliant(resource) if {\n\thas_multi_nodes(resource)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MSE::Gateway\")\n\tnot has_multi_nodes(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Replica\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:mse-gateway-multi-availability-area-architecture-check", Name: models.I18nString{"de": "MSE-Gateway Multi-Verfügbarkeitszonen-Bereitstellung", "en": "MSE Gateway Multi-Availability Zone Deployment", "es": "Implementación Multi-Zona de Disponibilidad de Puerta de Enlace MSE", "fr": "Déploiement Multi-Zone de Disponibilité de la Passerelle MSE", "ja": "MSE ゲートウェイマルチ可用性ゾーン展開", "pt": "Implantação Multi-Zona de Disponibilidade do Gateway MSE", "zh": "MSE 云原生网关部署在多可用区"}, Severity: "medium", Description: models.I18nString{"de": "MSE-Gateways sollten durch Konfigurieren eines Backup-VSwitch über mehrere Verfügbarkeitszonen hinweg bereitgestellt werden.", "en": "MSE gateways should be deployed across multiple availability zones by configuring a backup VSwitch.", "es": "Las puertas de enlace MSE deben implementarse en múltiples zonas de disponibilidad configurando un VSwitch de respaldo.", "fr": "Les passerelles MSE doivent être déployées sur plusieurs zones de disponibilité en configurant un VSwitch de sauvegarde.", "ja": "MSE ゲートウェイは、バックアップ VSwitch を設定することで、複数の可用性ゾーンに展開する必要があります。", "pt": "Os gateways MSE devem ser implantados em múltiplas zonas de disponibilidade configurando um VSwitch de backup.", "zh": "MSE 云原生网关部署在多可用区，视为合规。"}, Reason: models.I18nString{"de": "Das MSE-Gateway hat keinen Backup-VSwitch konfiguriert, was die Verfügbarkeit beeinträchtigen kann.", "en": "The MSE gateway does not have a backup VSwitch configured, which may affect availability.", "es": "La puerta de enlace MSE no tiene un VSwitch de respaldo configurado, lo que puede afectar la disponibilidad.", "fr": "La passerelle MSE n'a pas de VSwitch de sauvegarde configuré, ce qui peut affecter la disponibilité.", "ja": "MSE ゲートウェイにバックアップ VSwitch が設定されていないため、可用性に影響を与える可能性があります。", "pt": "O gateway MSE não tem um VSwitch de backup configurado, o que pode afetar a disponibilidade.", "zh": "MSE 网关未配置备用交换机，可能影响可用性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie einen Backup-VSwitch, indem Sie die Eigenschaft BackupVSwitchId setzen, um Multi-Zonen-Bereitstellung zu aktivieren.", "en": "Configure a backup VSwitch by setting the BackupVSwitchId property to enable multi-zone deployment.", "es": "Configure un VSwitch de respaldo estableciendo la propiedad BackupVSwitchId para habilitar la implementación multi-zona.", "fr": "Configurez un VSwitch de sauvegarde en définissant la propriété BackupVSwitchId pour activer le déploiement multi-zone.", "ja": "BackupVSwitchId プロパティを設定してバックアップ VSwitch を設定し、マルチゾーン展開を有効にします。", "pt": "Configure um VSwitch de backup definindo a propriedade BackupVSwitchId para habilitar a implantação multi-zona.", "zh": "通过设置 BackupVSwitchId 属性配置备用交换机，以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::MSE::Gateway"}, FilePath: "aliyun/rules/mse-gateway-multi-availability-area-architecture-check.rego", PackageName: "infraguard.rules.aliyun.mse_gateway_multi_availability_area_architecture_check", Content: "package infraguard.rules.aliyun.mse_gateway_multi_availability_area_architecture_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"mse-gateway-multi-availability-area-architecture-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"MSE Gateway Multi-Availability Zone Deployment\",\n\t\t\"zh\": \"MSE 云原生网关部署在多可用区\",\n\t\t\"ja\": \"MSE ゲートウェイマルチ可用性ゾーン展開\",\n\t\t\"de\": \"MSE-Gateway Multi-Verfügbarkeitszonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona de Disponibilidad de Puerta de Enlace MSE\",\n\t\t\"fr\": \"Déploiement Multi-Zone de Disponibilité de la Passerelle MSE\",\n\t\t\"pt\": \"Implantação Multi-Zona de Disponibilidade do Gateway MSE\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"MSE gateways should be deployed across multiple availability zones by configuring a backup VSwitch.\",\n\t\t\"zh\": \"MSE 云原生网关部署在多可用区，视为合规。\",\n\t\t\"ja\": \"MSE ゲートウェイは、バックアップ VSwitch を設定することで、複数の可用性ゾーンに展開する必要があります。\",\n\t\t\"de\": \"MSE-Gateways sollten durch Konfigurieren eines Backup-VSwitch über mehrere Verfügbarkeitszonen hinweg bereitgestellt werden.\",\n\t\t\"es\": \"Las puertas de enlace MSE deben implementarse en múltiples zonas de disponibilidad configurando un VSwitch de respaldo.\",\n\t\t\"fr\": \"Les passerelles MSE doivent être déployées sur plusieurs zones de disponibilité en configurant un VSwitch de sauvegarde.\",\n\t\t\"pt\": \"Os gateways MSE devem ser implantados em múltiplas zonas de disponibilidade configurando um VSwitch de backup.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The MSE gateway does not have a backup VSwitch configured, which may affect availability.\",\n\t\t\"zh\": \"MSE 网关未配置备用交换机，可能影响可用性。\",\n\t\t\"ja\": \"MSE ゲートウェイにバックアップ VSwitch が設定されていないため、可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Das MSE-Gateway hat keinen Backup-VSwitch konfiguriert, was die Verfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"La puerta de enlace MSE no tiene un VSwitch de respaldo configurado, lo que puede afectar la disponibilidad.\",\n\t\t\"fr\": \"La passerelle MSE n'a pas de VSwitch de sauvegarde configuré, ce qui peut affecter la disponibilité.\",\n\t\t\"pt\": \"O gateway MSE não tem um VSwitch de backup configurado, o que pode afetar a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a backup VSwitch by setting the BackupVSwitchId property to enable multi-zone deployment.\",\n\t\t\"zh\": \"通过设置 BackupVSwitchId 属性配置备用交换机，以启用多可用区部署。\",\n\t\t\"ja\": \"BackupVSwitchId プロパティを設定してバックアップ VSwitch を設定し、マルチゾーン展開を有効にします。\",\n\t\t\"de\": \"Konfigurieren Sie einen Backup-VSwitch, indem Sie die Eigenschaft BackupVSwitchId setzen, um Multi-Zonen-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure un VSwitch de respaldo estableciendo la propiedad BackupVSwitchId para habilitar la implementación multi-zona.\",\n\t\t\"fr\": \"Configurez un VSwitch de sauvegarde en définissant la propriété BackupVSwitchId pour activer le déploiement multi-zone.\",\n\t\t\"pt\": \"Configure um VSwitch de backup definindo a propriedade BackupVSwitchId para habilitar a implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::MSE::Gateway\"]\n}\n\n# Check if gateway has backup VSwitch\nhas_backup_vswitch(resource) if {\n\thelpers.has_property(resource, \"BackupVSwitchId\")\n\tbackup_vswitch := resource.Properties.BackupVSwitchId\n\tbackup_vswitch != \"\"\n}\n\n# Deny rule: MSE gateways should have backup VSwitch\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::MSE::Gateway\")\n\tnot has_backup_vswitch(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"BackupVSwitchId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:nas-access-group-public-access-check", Name: models.I18nString{"de": "NAS-Zugriffsgruppe IP-Beschränkung", "en": "NAS Access Group IP Restriction", "es": "Restricción de IP del Grupo de Acceso NAS", "fr": "Restriction IP du Groupe d'Accès NAS", "ja": "NAS アクセスグループ IP 制限", "pt": "Restrição de IP do Grupo de Acesso NAS", "zh": "NAS 权限组禁用公网授权"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass NAS-Zugriffsregeln 0.0.0.0/0 nicht erlauben.", "en": "Ensures NAS access rules do not allow 0.0.0.0/0.", "es": "Garantiza que las reglas de acceso NAS no permitan 0.0.0.0/0.", "fr": "Garantit que les règles d'accès NAS n'autorisent pas 0.0.0.0/0.", "ja": "NAS アクセスルールが 0.0.0.0/0 を許可しないことを確認します。", "pt": "Garante que as regras de acesso NAS não permitam 0.0.0.0/0.", "zh": "确保 NAS 权限规则不允许 0.0.0.0/0。"}, Reason: models.I18nString{"de": "Eine offene NAS-Zugriffsregel kann zu unbefugtem Datenzugriff über das Internet führen.", "en": "An open NAS access rule can lead to unauthorized data access over the internet.", "es": "Una regla de acceso NAS abierta puede llevar a acceso no autorizado a datos a través de Internet.", "fr": "Une règle d'accès NAS ouverte peut entraîner un accès non autorisé aux données via Internet.", "ja": "オープンな NAS アクセスルールにより、インターネット経由での不正なデータアクセスが発生する可能性があります。", "pt": "Uma regra de acesso NAS aberta pode levar a acesso não autorizado a dados pela Internet.", "zh": "开放的 NAS 权限规则可能导致互联网上的非授权数据访问。"}, Recommendation: models.I18nString{"de": "Beschränken Sie NAS-Zugriffsregeln auf spezifische vertrauenswürdige VPC-IP-Bereiche.", "en": "Restrict NAS access rules to specific trusted VPC IP ranges.", "es": "Restrinja las reglas de acceso NAS a rangos de IP VPC específicos de confianza.", "fr": "Restreignez les règles d'accès NAS à des plages d'IP VPC spécifiques de confiance.", "ja": "NAS アクセスルールを特定の信頼できる VPC IP 範囲に制限します。", "pt": "Restrinja as regras de acesso NAS a intervalos de IP VPC específicos confiáveis.", "zh": "将 NAS 权限规则限制在特定的可信 VPC IP 范围内。"}, ResourceTypes: []string{"ALIYUN::NAS::AccessRule"}, FilePath: "aliyun/rules/nas-access-group-public-access-check.rego", PackageName: "infraguard.rules.aliyun.nas_access_group_public_access_check", Content: "package infraguard.rules.aliyun.nas_access_group_public_access_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"nas-access-group-public-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"NAS Access Group IP Restriction\",\n\t\t\"zh\": \"NAS 权限组禁用公网授权\",\n\t\t\"ja\": \"NAS アクセスグループ IP 制限\",\n\t\t\"de\": \"NAS-Zugriffsgruppe IP-Beschränkung\",\n\t\t\"es\": \"Restricción de IP del Grupo de Acceso NAS\",\n\t\t\"fr\": \"Restriction IP du Groupe d'Accès NAS\",\n\t\t\"pt\": \"Restrição de IP do Grupo de Acesso NAS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures NAS access rules do not allow 0.0.0.0/0.\",\n\t\t\"zh\": \"确保 NAS 权限规则不允许 0.0.0.0/0。\",\n\t\t\"ja\": \"NAS アクセスルールが 0.0.0.0/0 を許可しないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass NAS-Zugriffsregeln 0.0.0.0/0 nicht erlauben.\",\n\t\t\"es\": \"Garantiza que las reglas de acceso NAS no permitan 0.0.0.0/0.\",\n\t\t\"fr\": \"Garantit que les règles d'accès NAS n'autorisent pas 0.0.0.0/0.\",\n\t\t\"pt\": \"Garante que as regras de acesso NAS não permitam 0.0.0.0/0.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"An open NAS access rule can lead to unauthorized data access over the internet.\",\n\t\t\"zh\": \"开放的 NAS 权限规则可能导致互联网上的非授权数据访问。\",\n\t\t\"ja\": \"オープンな NAS アクセスルールにより、インターネット経由での不正なデータアクセスが発生する可能性があります。\",\n\t\t\"de\": \"Eine offene NAS-Zugriffsregel kann zu unbefugtem Datenzugriff über das Internet führen.\",\n\t\t\"es\": \"Una regla de acceso NAS abierta puede llevar a acceso no autorizado a datos a través de Internet.\",\n\t\t\"fr\": \"Une règle d'accès NAS ouverte peut entraîner un accès non autorisé aux données via Internet.\",\n\t\t\"pt\": \"Uma regra de acesso NAS aberta pode levar a acesso não autorizado a dados pela Internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict NAS access rules to specific trusted VPC IP ranges.\",\n\t\t\"zh\": \"将 NAS 权限规则限制在特定的可信 VPC IP 范围内。\",\n\t\t\"ja\": \"NAS アクセスルールを特定の信頼できる VPC IP 範囲に制限します。\",\n\t\t\"de\": \"Beschränken Sie NAS-Zugriffsregeln auf spezifische vertrauenswürdige VPC-IP-Bereiche.\",\n\t\t\"es\": \"Restrinja las reglas de acceso NAS a rangos de IP VPC específicos de confianza.\",\n\t\t\"fr\": \"Restreignez les règles d'accès NAS à des plages d'IP VPC spécifiques de confiance.\",\n\t\t\"pt\": \"Restrinja as regras de acesso NAS a intervalos de IP VPC específicos confiáveis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NAS::AccessRule\"]\n}\n\nis_compliant(resource) if {\n\tip := helpers.get_property(resource, \"SourceCidrIp\", \"\")\n\tnot helpers.is_public_cidr(ip)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NAS::AccessRule\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SourceCidrIp\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:nas-filesystem-encrypt-type-check", Name: models.I18nString{"de": "NAS-Dateisystem-Verschlüsselung konfiguriert", "en": "NAS file system encryption configured", "es": "Cifrado de Sistema de Archivos NAS Configurado", "fr": "Chiffrement du Système de Fichiers NAS Configuré", "ja": "NAS ファイルシステムの暗号化が設定されている", "pt": "Criptografia do Sistema de Arquivos NAS Configurada", "zh": "NAS 文件系统设置了加密"}, Severity: "low", Description: models.I18nString{"de": "NAS-Dateisystem hat Verschlüsselung konfiguriert, gilt als konform.", "en": "NAS file system has encryption configured, considered compliant.", "es": "El sistema de archivos NAS tiene cifrado configurado, se considera conforme.", "fr": "Le système de fichiers NAS a le chiffrement configuré, considéré comme conforme.", "ja": "NAS ファイルシステムに暗号化が設定されており、準拠と見なされます。", "pt": "O sistema de arquivos NAS tem criptografia configurada, considerado em conformidade.", "zh": "NAS 文件系统设置了加密,视为合规。"}, Reason: models.I18nString{"de": "NAS-Dateisystem hat keine Verschlüsselung konfiguriert", "en": "NAS file system does not have encryption configured", "es": "El sistema de archivos NAS no tiene cifrado configurado", "fr": "Le système de fichiers NAS n'a pas de chiffrement configuré", "ja": "NAS ファイルシステムに暗号化が設定されていません", "pt": "O sistema de arquivos NAS não tem criptografia configurada", "zh": "NAS 文件系统未设置加密"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie Verschlüsselung für das NAS-Dateisystem, um Daten im Ruhezustand mit KMS-Schlüsseln zu schützen", "en": "Configure encryption for NAS file system to protect data at rest using KMS keys", "es": "Configure el cifrado para el sistema de archivos NAS para proteger los datos en reposo usando claves KMS", "fr": "Configurez le chiffrement pour le système de fichiers NAS pour protéger les données au repos à l'aide de clés KMS", "ja": "KMS キーを使用して保存データを保護するために、NAS ファイルシステムの暗号化を設定します", "pt": "Configure a criptografia para o sistema de arquivos NAS para proteger dados em repouso usando chaves KMS", "zh": "为 NAS 文件系统配置加密以使用 KMS 密钥保护静态数据"}, ResourceTypes: []string{"ALIYUN::NAS::FileSystem"}, FilePath: "aliyun/rules/nas-filesystem-encrypt-type-check.rego", PackageName: "infraguard.rules.aliyun.nas_filesystem_encrypt_type_check", Content: "package infraguard.rules.aliyun.nas_filesystem_encrypt_type_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"nas-filesystem-encrypt-type-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"NAS file system encryption configured\",\n\t\t\"zh\": \"NAS 文件系统设置了加密\",\n\t\t\"ja\": \"NAS ファイルシステムの暗号化が設定されている\",\n\t\t\"de\": \"NAS-Dateisystem-Verschlüsselung konfiguriert\",\n\t\t\"es\": \"Cifrado de Sistema de Archivos NAS Configurado\",\n\t\t\"fr\": \"Chiffrement du Système de Fichiers NAS Configuré\",\n\t\t\"pt\": \"Criptografia do Sistema de Arquivos NAS Configurada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"NAS file system has encryption configured, considered compliant.\",\n\t\t\"zh\": \"NAS 文件系统设置了加密,视为合规。\",\n\t\t\"ja\": \"NAS ファイルシステムに暗号化が設定されており、準拠と見なされます。\",\n\t\t\"de\": \"NAS-Dateisystem hat Verschlüsselung konfiguriert, gilt als konform.\",\n\t\t\"es\": \"El sistema de archivos NAS tiene cifrado configurado, se considera conforme.\",\n\t\t\"fr\": \"Le système de fichiers NAS a le chiffrement configuré, considéré comme conforme.\",\n\t\t\"pt\": \"O sistema de arquivos NAS tem criptografia configurada, considerado em conformidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"NAS file system does not have encryption configured\",\n\t\t\"zh\": \"NAS 文件系统未设置加密\",\n\t\t\"ja\": \"NAS ファイルシステムに暗号化が設定されていません\",\n\t\t\"de\": \"NAS-Dateisystem hat keine Verschlüsselung konfiguriert\",\n\t\t\"es\": \"El sistema de archivos NAS no tiene cifrado configurado\",\n\t\t\"fr\": \"Le système de fichiers NAS n'a pas de chiffrement configuré\",\n\t\t\"pt\": \"O sistema de arquivos NAS não tem criptografia configurada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure encryption for NAS file system to protect data at rest using KMS keys\",\n\t\t\"zh\": \"为 NAS 文件系统配置加密以使用 KMS 密钥保护静态数据\",\n\t\t\"ja\": \"KMS キーを使用して保存データを保護するために、NAS ファイルシステムの暗号化を設定します\",\n\t\t\"de\": \"Konfigurieren Sie Verschlüsselung für das NAS-Dateisystem, um Daten im Ruhezustand mit KMS-Schlüsseln zu schützen\",\n\t\t\"es\": \"Configure el cifrado para el sistema de archivos NAS para proteger los datos en reposo usando claves KMS\",\n\t\t\"fr\": \"Configurez le chiffrement pour le système de fichiers NAS pour protéger les données au repos à l'aide de clés KMS\",\n\t\t\"pt\": \"Configure a criptografia para o sistema de arquivos NAS para proteger dados em repouso usando chaves KMS\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NAS::FileSystem\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NAS::FileSystem\")\n\n\t# Check if EncryptType is set to 1 (encrypted)\n\tencrypt_type := helpers.get_property(resource, \"EncryptType\", 0)\n\tencrypt_type != 1\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:nas-filesystem-mount-target-access-group-check", Name: models.I18nString{"de": "NAS-Mount-Ziel Zugriffsgruppenprüfung", "en": "NAS Mount Target Access Group Check", "es": "Verificación de Grupo de Acceso de Objetivo de Montaje NAS", "fr": "Vérification du Groupe d'Accès de Cible de Montage NAS", "ja": "NAS マウントターゲットアクセスグループチェック", "pt": "Verificação de Grupo de Acesso do Alvo de Montagem NAS", "zh": "NAS 挂载点禁用默认权限组"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass NAS-Mount-Ziele 'DEFAULT_VPC_GROUP_NAME' nicht verwenden.", "en": "Ensures NAS mount targets do not use the 'DEFAULT_VPC_GROUP_NAME'.", "es": "Garantiza que los objetivos de montaje NAS no usen 'DEFAULT_VPC_GROUP_NAME'.", "fr": "Garantit que les cibles de montage NAS n'utilisent pas 'DEFAULT_VPC_GROUP_NAME'.", "ja": "NAS マウントターゲットが 'DEFAULT_VPC_GROUP_NAME' を使用していないことを確認します。", "pt": "Garante que os alvos de montagem NAS não usem 'DEFAULT_VPC_GROUP_NAME'.", "zh": "确保 NAS 挂载点未使用'DEFAULT_VPC_GROUP_NAME'。"}, Reason: models.I18nString{"de": "Die Standard-Zugriffsgruppe kann übermäßig permissive Regeln haben.", "en": "The default access group may have overly permissive rules.", "es": "El grupo de acceso predeterminado puede tener reglas excesivamente permisivas.", "fr": "Le groupe d'accès par défaut peut avoir des règles trop permissives.", "ja": "デフォルトのアクセスグループには過度に許可的なルールがある可能性があります。", "pt": "O grupo de acesso padrão pode ter regras excessivamente permissivas.", "zh": "默认权限组可能拥有过于宽松的规则。"}, Recommendation: models.I18nString{"de": "Verwenden Sie eine benutzerdefinierte Zugriffsgruppe mit eingeschränkten Regeln für NAS-Mount-Ziele.", "en": "Use a custom access group with restricted rules for NAS mount targets.", "es": "Use un grupo de acceso personalizado con reglas restringidas para objetivos de montaje NAS.", "fr": "Utilisez un groupe d'accès personnalisé avec des règles restreintes pour les cibles de montage NAS.", "ja": "NAS マウントターゲットには制限されたルールを持つカスタムアクセスグループを使用します。", "pt": "Use um grupo de acesso personalizado com regras restritas para alvos de montagem NAS.", "zh": "为 NAS 挂载点使用规则受限的自定义权限组。"}, ResourceTypes: []string{"ALIYUN::NAS::MountTarget"}, FilePath: "aliyun/rules/nas-filesystem-mount-target-access-group-check.rego", PackageName: "infraguard.rules.aliyun.nas_filesystem_mount_target_access_group_check", Content: "package infraguard.rules.aliyun.nas_filesystem_mount_target_access_group_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"nas-filesystem-mount-target-access-group-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"NAS Mount Target Access Group Check\",\n\t\t\"zh\": \"NAS 挂载点禁用默认权限组\",\n\t\t\"ja\": \"NAS マウントターゲットアクセスグループチェック\",\n\t\t\"de\": \"NAS-Mount-Ziel Zugriffsgruppenprüfung\",\n\t\t\"es\": \"Verificación de Grupo de Acceso de Objetivo de Montaje NAS\",\n\t\t\"fr\": \"Vérification du Groupe d'Accès de Cible de Montage NAS\",\n\t\t\"pt\": \"Verificação de Grupo de Acesso do Alvo de Montagem NAS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures NAS mount targets do not use the 'DEFAULT_VPC_GROUP_NAME'.\",\n\t\t\"zh\": \"确保 NAS 挂载点未使用'DEFAULT_VPC_GROUP_NAME'。\",\n\t\t\"ja\": \"NAS マウントターゲットが 'DEFAULT_VPC_GROUP_NAME' を使用していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass NAS-Mount-Ziele 'DEFAULT_VPC_GROUP_NAME' nicht verwenden.\",\n\t\t\"es\": \"Garantiza que los objetivos de montaje NAS no usen 'DEFAULT_VPC_GROUP_NAME'.\",\n\t\t\"fr\": \"Garantit que les cibles de montage NAS n'utilisent pas 'DEFAULT_VPC_GROUP_NAME'.\",\n\t\t\"pt\": \"Garante que os alvos de montagem NAS não usem 'DEFAULT_VPC_GROUP_NAME'.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The default access group may have overly permissive rules.\",\n\t\t\"zh\": \"默认权限组可能拥有过于宽松的规则。\",\n\t\t\"ja\": \"デフォルトのアクセスグループには過度に許可的なルールがある可能性があります。\",\n\t\t\"de\": \"Die Standard-Zugriffsgruppe kann übermäßig permissive Regeln haben.\",\n\t\t\"es\": \"El grupo de acceso predeterminado puede tener reglas excesivamente permisivas.\",\n\t\t\"fr\": \"Le groupe d'accès par défaut peut avoir des règles trop permissives.\",\n\t\t\"pt\": \"O grupo de acesso padrão pode ter regras excessivamente permissivas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use a custom access group with restricted rules for NAS mount targets.\",\n\t\t\"zh\": \"为 NAS 挂载点使用规则受限的自定义权限组。\",\n\t\t\"ja\": \"NAS マウントターゲットには制限されたルールを持つカスタムアクセスグループを使用します。\",\n\t\t\"de\": \"Verwenden Sie eine benutzerdefinierte Zugriffsgruppe mit eingeschränkten Regeln für NAS-Mount-Ziele.\",\n\t\t\"es\": \"Use un grupo de acceso personalizado con reglas restringidas para objetivos de montaje NAS.\",\n\t\t\"fr\": \"Utilisez un groupe d'accès personnalisé avec des règles restreintes pour les cibles de montage NAS.\",\n\t\t\"pt\": \"Use um grupo de acesso personalizado com regras restritas para alvos de montagem NAS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NAS::MountTarget\"]\n}\n\nis_compliant(resource) if {\n\tgroup := helpers.get_property(resource, \"AccessGroupName\", \"DEFAULT_VPC_GROUP_NAME\")\n\tgroup != \"DEFAULT_VPC_GROUP_NAME\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NAS::MountTarget\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AccessGroupName\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:nat-risk-ports-check", Name: models.I18nString{"de": "NAT-Gateway-Risikoport-Prüfung", "en": "NAT Gateway Risk Ports Check", "es": "Verificación de Puertos de Riesgo de Puerta de Enlace NAT", "fr": "Vérification des Ports à Risque de la Passerelle NAT", "ja": "NAT ゲートウェイのリスクポートチェック", "pt": "Verificação de Portas de Risco do Gateway NAT", "zh": "NAT 网关不允许映射指定的风险端口"}, Severity: "high", Description: models.I18nString{"de": "NAT-Gateway-DNAT-Mappings sollten keine riskanten Ports dem Internet aussetzen, um Sicherheitslücken zu verhindern.", "en": "NAT gateway DNAT mappings should not expose risky ports to the internet to prevent security vulnerabilities.", "es": "Los mapeos DNAT de la puerta de enlace NAT no deben exponer puertos riesgosos a internet para prevenir vulnerabilidades de seguridad.", "fr": "Les mappages DNAT de la passerelle NAT ne doivent pas exposer des ports risqués à Internet pour prévenir les vulnérabilités de sécurité.", "ja": "NAT ゲートウェイ DNAT マッピングは、セキュリティの脆弱性を防ぐために、リスクのあるポートをインターネットに公開しないでください。", "pt": "Os mapeamentos DNAT do gateway NAT não devem expor portas arriscadas à internet para prevenir vulnerabilidades de segurança.", "zh": "NAT 网关 DNAT 映射端口不包含指定的风险端口，视为合规。"}, Reason: models.I18nString{"de": "Das Aussetzen riskanter Ports über DNAT kann zu Sicherheitslücken und potenziellen Angriffen führen.", "en": "Exposing risky ports through DNAT can lead to security vulnerabilities and potential attacks.", "es": "Exponer puertos riesgosos a través de DNAT puede provocar vulnerabilidades de seguridad y ataques potenciales.", "fr": "Exposer des ports risqués via DNAT peut entraîner des vulnérabilités de sécurité et des attaques potentielles.", "ja": "DNAT を通じてリスクのあるポートを公開すると、セキュリティの脆弱性や潜在的な攻撃につながる可能性があります。", "pt": "Expor portas arriscadas através de DNAT pode levar a vulnerabilidades de segurança e ataques potenciais.", "zh": "通过 DNAT 暴露风险端口可能导致安全漏洞和潜在攻击。"}, Recommendation: models.I18nString{"de": "Vermeiden Sie die Zuordnung bekannter riskanter Ports (z. B. 22, 3389, 445) über DNAT.", "en": "Avoid mapping well-known risky ports (e.g., 22, 3389, 445) through DNAT.", "es": "Evite mapear puertos riesgosos conocidos (por ejemplo, 22, 3389, 445) a través de DNAT.", "fr": "Évitez de mapper des ports risqués bien connus (par exemple, 22, 3389, 445) via DNAT.", "ja": "DNAT を通じて既知のリスクポート（例：22、3389、445）のマッピングを避けます。", "pt": "Evite mapear portas arriscadas conhecidas (por exemplo, 22, 3389, 445) através de DNAT.", "zh": "避免通过 DNAT 映射已知的风险端口（如 22、3389、445 等）。"}, ResourceTypes: []string{"ALIYUN::NAT::NatGateway"}, FilePath: "aliyun/rules/nat-risk-ports-check.rego", PackageName: "infraguard.rules.aliyun.nat_risk_ports_check", Content: "package infraguard.rules.aliyun.nat_risk_ports_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"nat-risk-ports-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"NAT Gateway Risk Ports Check\",\n\t\t\"zh\": \"NAT 网关不允许映射指定的风险端口\",\n\t\t\"ja\": \"NAT ゲートウェイのリスクポートチェック\",\n\t\t\"de\": \"NAT-Gateway-Risikoport-Prüfung\",\n\t\t\"es\": \"Verificación de Puertos de Riesgo de Puerta de Enlace NAT\",\n\t\t\"fr\": \"Vérification des Ports à Risque de la Passerelle NAT\",\n\t\t\"pt\": \"Verificação de Portas de Risco do Gateway NAT\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"NAT gateway DNAT mappings should not expose risky ports to the internet to prevent security vulnerabilities.\",\n\t\t\"zh\": \"NAT 网关 DNAT 映射端口不包含指定的风险端口，视为合规。\",\n\t\t\"ja\": \"NAT ゲートウェイ DNAT マッピングは、セキュリティの脆弱性を防ぐために、リスクのあるポートをインターネットに公開しないでください。\",\n\t\t\"de\": \"NAT-Gateway-DNAT-Mappings sollten keine riskanten Ports dem Internet aussetzen, um Sicherheitslücken zu verhindern.\",\n\t\t\"es\": \"Los mapeos DNAT de la puerta de enlace NAT no deben exponer puertos riesgosos a internet para prevenir vulnerabilidades de seguridad.\",\n\t\t\"fr\": \"Les mappages DNAT de la passerelle NAT ne doivent pas exposer des ports risqués à Internet pour prévenir les vulnérabilités de sécurité.\",\n\t\t\"pt\": \"Os mapeamentos DNAT do gateway NAT não devem expor portas arriscadas à internet para prevenir vulnerabilidades de segurança.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Exposing risky ports through DNAT can lead to security vulnerabilities and potential attacks.\",\n\t\t\"zh\": \"通过 DNAT 暴露风险端口可能导致安全漏洞和潜在攻击。\",\n\t\t\"ja\": \"DNAT を通じてリスクのあるポートを公開すると、セキュリティの脆弱性や潜在的な攻撃につながる可能性があります。\",\n\t\t\"de\": \"Das Aussetzen riskanter Ports über DNAT kann zu Sicherheitslücken und potenziellen Angriffen führen.\",\n\t\t\"es\": \"Exponer puertos riesgosos a través de DNAT puede provocar vulnerabilidades de seguridad y ataques potenciales.\",\n\t\t\"fr\": \"Exposer des ports risqués via DNAT peut entraîner des vulnérabilités de sécurité et des attaques potentielles.\",\n\t\t\"pt\": \"Expor portas arriscadas através de DNAT pode levar a vulnerabilidades de segurança e ataques potenciais.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Avoid mapping well-known risky ports (e.g., 22, 3389, 445) through DNAT.\",\n\t\t\"zh\": \"避免通过 DNAT 映射已知的风险端口（如 22、3389、445 等）。\",\n\t\t\"ja\": \"DNAT を通じて既知のリスクポート（例：22、3389、445）のマッピングを避けます。\",\n\t\t\"de\": \"Vermeiden Sie die Zuordnung bekannter riskanter Ports (z. B. 22, 3389, 445) über DNAT.\",\n\t\t\"es\": \"Evite mapear puertos riesgosos conocidos (por ejemplo, 22, 3389, 445) a través de DNAT.\",\n\t\t\"fr\": \"Évitez de mapper des ports risqués bien connus (par exemple, 22, 3389, 445) via DNAT.\",\n\t\t\"pt\": \"Evite mapear portas arriscadas conhecidas (por exemplo, 22, 3389, 445) através de DNAT.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NAT::NatGateway\"]\n}\n\n# Common risky ports that should not be exposed\nrisky_ports := {\"22\", \"23\", \"445\", \"3389\", \"1433\", \"3306\", \"5432\", \"6379\", \"8080\", \"8443\"}\n\ncontains_risky_port(resource) if {\n\t# Simplified check - in production would check ForwardTable entries\n\tforward_table := helpers.get_property(resource, \"ForwardTableId\", \"\")\n\tforward_table != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NAT::NatGateway\")\n\n\t# This is a placeholder - actual implementation would check DNAT entries\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ForwardTableId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:natgateway-delete-protection-enabled", Name: models.I18nString{"de": "NAT-Gateway Löschschutz aktiviert", "en": "NAT Gateway Deletion Protection Enabled", "es": "Protección de Eliminación de Puerta de Enlace NAT Habilitada", "fr": "Protection contre la Suppression de la Passerelle NAT Activée", "ja": "NAT ゲートウェイ削除保護が有効", "pt": "Proteção contra Exclusão do Gateway NAT Habilitada", "zh": "NAT 网关启用释放保护"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass NAT-Gateways Löschschutz aktiviert haben.", "en": "Ensures that NAT Gateways have deletion protection enabled.", "es": "Garantiza que las puertas de enlace NAT tengan protección contra eliminación habilitada.", "fr": "Garantit que les passerelles NAT ont la protection contre la suppression activée.", "ja": "NAT ゲートウェイで削除保護が有効になっていることを確認します。", "pt": "Garante que os gateways NAT tenham proteção contra exclusão habilitada.", "zh": "确保 NAT 网关开启了释放保护。"}, Reason: models.I18nString{"de": "Wenn der Löschschutz nicht aktiviert ist, kann das NAT-Gateway versehentlich freigegeben werden, was zu einem Verlust der Internetverbindung für Ressourcen im VPC führt.", "en": "If deletion protection is not enabled, the NAT Gateway may be released accidentally, causing loss of internet connectivity for resources in the VPC.", "es": "Si la protección contra eliminación no está habilitada, la puerta de enlace NAT puede ser liberada accidentalmente, causando pérdida de conectividad a Internet para recursos en el VPC.", "fr": "Si la protection contre la suppression n'est pas activée, la passerelle NAT peut être libérée accidentellement, entraînant une perte de connectivité Internet pour les ressources dans le VPC.", "ja": "削除保護が有効になっていない場合、NAT ゲートウェイが誤って解放され、VPC 内のリソースがインターネット接続を失う可能性があります。", "pt": "Se a proteção contra exclusão não estiver habilitada, o gateway NAT pode ser liberado acidentalmente, causando perda de conectividade com a Internet para recursos no VPC.", "zh": "如果未开启释放保护，NAT 网关可能会被意外释放，导致 VPC 内资源失去互联网连接。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für das NAT-Gateway.", "en": "Enable deletion protection for the NAT Gateway.", "es": "Habilite la protección contra eliminación para la puerta de enlace NAT.", "fr": "Activez la protection contre la suppression pour la passerelle NAT.", "ja": "NAT ゲートウェイの削除保護を有効にします。", "pt": "Habilite a proteção contra exclusão para o gateway NAT.", "zh": "为 NAT 网关开启释放保护功能。"}, ResourceTypes: []string{"ALIYUN::VPC::NatGateway"}, FilePath: "aliyun/rules/natgateway-delete-protection-enabled.rego", PackageName: "infraguard.rules.aliyun.natgateway_delete_protection_enabled", Content: "package infraguard.rules.aliyun.natgateway_delete_protection_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"natgateway-delete-protection-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"NAT Gateway Deletion Protection Enabled\",\n\t\t\"zh\": \"NAT 网关启用释放保护\",\n\t\t\"ja\": \"NAT ゲートウェイ削除保護が有効\",\n\t\t\"de\": \"NAT-Gateway Löschschutz aktiviert\",\n\t\t\"es\": \"Protección de Eliminación de Puerta de Enlace NAT Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression de la Passerelle NAT Activée\",\n\t\t\"pt\": \"Proteção contra Exclusão do Gateway NAT Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that NAT Gateways have deletion protection enabled.\",\n\t\t\"zh\": \"确保 NAT 网关开启了释放保护。\",\n\t\t\"ja\": \"NAT ゲートウェイで削除保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass NAT-Gateways Löschschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las puertas de enlace NAT tengan protección contra eliminación habilitada.\",\n\t\t\"fr\": \"Garantit que les passerelles NAT ont la protection contre la suppression activée.\",\n\t\t\"pt\": \"Garante que os gateways NAT tenham proteção contra exclusão habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If deletion protection is not enabled, the NAT Gateway may be released accidentally, causing loss of internet connectivity for resources in the VPC.\",\n\t\t\"zh\": \"如果未开启释放保护，NAT 网关可能会被意外释放，导致 VPC 内资源失去互联网连接。\",\n\t\t\"ja\": \"削除保護が有効になっていない場合、NAT ゲートウェイが誤って解放され、VPC 内のリソースがインターネット接続を失う可能性があります。\",\n\t\t\"de\": \"Wenn der Löschschutz nicht aktiviert ist, kann das NAT-Gateway versehentlich freigegeben werden, was zu einem Verlust der Internetverbindung für Ressourcen im VPC führt.\",\n\t\t\"es\": \"Si la protección contra eliminación no está habilitada, la puerta de enlace NAT puede ser liberada accidentalmente, causando pérdida de conectividad a Internet para recursos en el VPC.\",\n\t\t\"fr\": \"Si la protection contre la suppression n'est pas activée, la passerelle NAT peut être libérée accidentellement, entraînant une perte de connectivité Internet pour les ressources dans le VPC.\",\n\t\t\"pt\": \"Se a proteção contra exclusão não estiver habilitada, o gateway NAT pode ser liberado acidentalmente, causando perda de conectividade com a Internet para recursos no VPC.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for the NAT Gateway.\",\n\t\t\"zh\": \"为 NAT 网关开启释放保护功能。\",\n\t\t\"ja\": \"NAT ゲートウェイの削除保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für das NAT-Gateway.\",\n\t\t\"es\": \"Habilite la protección contra eliminación para la puerta de enlace NAT.\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour la passerelle NAT.\",\n\t\t\"pt\": \"Habilite a proteção contra exclusão para o gateway NAT.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::NatGateway\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::VPC::NatGateway\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:natgateway-eip-used-check", Name: models.I18nString{"de": "NAT-Gateway EIP-Verwendungsprüfung", "en": "NAT Gateway EIP Usage Check", "es": "Verificación de Uso de EIP de Puerta de Enlace NAT", "fr": "Vérification de l'Utilisation EIP de la Passerelle NAT", "ja": "NAT ゲートウェイ EIP 使用チェック", "pt": "Verificação de Uso de EIP do Gateway NAT", "zh": "NAT 网关中 SNAT 和 DNAT 未使用同一个 EIP"}, Severity: "medium", Description: models.I18nString{"de": "SNAT und DNAT sollten nicht dasselbe EIP verwenden, um potenzielle Konflikte zu vermeiden und die Netzwerksegmentierung zu verbessern.", "en": "SNAT and DNAT should not use the same EIP to avoid potential conflicts and improve network segmentation.", "es": "SNAT y DNAT no deben usar el mismo EIP para evitar conflictos potenciales y mejorar la segmentación de red.", "fr": "SNAT et DNAT ne doivent pas utiliser le même EIP pour éviter les conflits potentiels et améliorer la segmentation réseau.", "ja": "SNAT と DNAT は潜在的な競合を避け、ネットワークセグメンテーションを改善するために同じ EIP を使用すべきではありません。", "pt": "SNAT e DNAT não devem usar o mesmo EIP para evitar conflitos potenciais e melhorar a segmentação de rede.", "zh": "NAT 网关的 SNAT 和 DNAT 未同时使用同一个 EIP，视为合规。"}, Reason: models.I18nString{"de": "Die Verwendung desselben EIP für sowohl SNAT als auch DNAT kann zu Routingkonflikten und Sicherheitsproblemen führen.", "en": "Using the same EIP for both SNAT and DNAT can lead to routing conflicts and security issues.", "es": "Usar el mismo EIP tanto para SNAT como para DNAT puede provocar conflictos de enrutamiento y problemas de seguridad.", "fr": "Utiliser le même EIP pour SNAT et DNAT peut entraîner des conflits de routage et des problèmes de sécurité.", "ja": "SNAT と DNAT の両方に同じ EIP を使用すると、ルーティング競合とセキュリティの問題が発生する可能性があります。", "pt": "Usar o mesmo EIP para SNAT e DNAT pode levar a conflitos de roteamento e problemas de segurança.", "zh": "SNAT 和 DNAT 使用同一个 EIP 可能导致路由冲突和安全问题。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie verschiedene EIPs für SNAT- und DNAT-Einträge.", "en": "Configure different EIPs for SNAT and DNAT entries.", "es": "Configure EIP diferentes para las entradas SNAT y DNAT.", "fr": "Configurez des EIP différents pour les entrées SNAT et DNAT.", "ja": "SNAT と DNAT エントリに異なる EIP を設定します。", "pt": "Configure EIPs diferentes para as entradas SNAT e DNAT.", "zh": "为 SNAT 和 DNAT 条目配置不同的 EIP。"}, ResourceTypes: []string{"ALIYUN::NAT::NatGateway"}, FilePath: "aliyun/rules/natgateway-eip-used-check.rego", PackageName: "infraguard.rules.aliyun.natgateway_eip_used_check", Content: "package infraguard.rules.aliyun.natgateway_eip_used_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"natgateway-eip-used-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"NAT Gateway EIP Usage Check\",\n\t\t\"zh\": \"NAT 网关中 SNAT 和 DNAT 未使用同一个 EIP\",\n\t\t\"ja\": \"NAT ゲートウェイ EIP 使用チェック\",\n\t\t\"de\": \"NAT-Gateway EIP-Verwendungsprüfung\",\n\t\t\"es\": \"Verificación de Uso de EIP de Puerta de Enlace NAT\",\n\t\t\"fr\": \"Vérification de l'Utilisation EIP de la Passerelle NAT\",\n\t\t\"pt\": \"Verificação de Uso de EIP do Gateway NAT\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"SNAT and DNAT should not use the same EIP to avoid potential conflicts and improve network segmentation.\",\n\t\t\"zh\": \"NAT 网关的 SNAT 和 DNAT 未同时使用同一个 EIP，视为合规。\",\n\t\t\"ja\": \"SNAT と DNAT は潜在的な競合を避け、ネットワークセグメンテーションを改善するために同じ EIP を使用すべきではありません。\",\n\t\t\"de\": \"SNAT und DNAT sollten nicht dasselbe EIP verwenden, um potenzielle Konflikte zu vermeiden und die Netzwerksegmentierung zu verbessern.\",\n\t\t\"es\": \"SNAT y DNAT no deben usar el mismo EIP para evitar conflictos potenciales y mejorar la segmentación de red.\",\n\t\t\"fr\": \"SNAT et DNAT ne doivent pas utiliser le même EIP pour éviter les conflits potentiels et améliorer la segmentation réseau.\",\n\t\t\"pt\": \"SNAT e DNAT não devem usar o mesmo EIP para evitar conflitos potenciais e melhorar a segmentação de rede.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using the same EIP for both SNAT and DNAT can lead to routing conflicts and security issues.\",\n\t\t\"zh\": \"SNAT 和 DNAT 使用同一个 EIP 可能导致路由冲突和安全问题。\",\n\t\t\"ja\": \"SNAT と DNAT の両方に同じ EIP を使用すると、ルーティング競合とセキュリティの問題が発生する可能性があります。\",\n\t\t\"de\": \"Die Verwendung desselben EIP für sowohl SNAT als auch DNAT kann zu Routingkonflikten und Sicherheitsproblemen führen.\",\n\t\t\"es\": \"Usar el mismo EIP tanto para SNAT como para DNAT puede provocar conflictos de enrutamiento y problemas de seguridad.\",\n\t\t\"fr\": \"Utiliser le même EIP pour SNAT et DNAT peut entraîner des conflits de routage et des problèmes de sécurité.\",\n\t\t\"pt\": \"Usar o mesmo EIP para SNAT e DNAT pode levar a conflitos de roteamento e problemas de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure different EIPs for SNAT and DNAT entries.\",\n\t\t\"zh\": \"为 SNAT 和 DNAT 条目配置不同的 EIP。\",\n\t\t\"ja\": \"SNAT と DNAT エントリに異なる EIP を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie verschiedene EIPs für SNAT- und DNAT-Einträge.\",\n\t\t\"es\": \"Configure EIP diferentes para las entradas SNAT y DNAT.\",\n\t\t\"fr\": \"Configurez des EIP différents pour les entrées SNAT et DNAT.\",\n\t\t\"pt\": \"Configure EIPs diferentes para as entradas SNAT e DNAT.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NAT::NatGateway\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NAT::NatGateway\")\n\n\t# Simplified check - in practice would check ForwardTableId and SNatTableId\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:natgateway-snat-eip-bandwidth-check", Name: models.I18nString{"de": "NAT-Gateway SNAT EIP-Bandbreitenkonsistenz", "en": "NAT Gateway SNAT EIP Bandwidth Consistency", "es": "Consistencia de Ancho de Banda EIP SNAT de Puerta de Enlace NAT", "fr": "Cohérence de Bande Passante EIP SNAT de Passerelle NAT", "ja": "NAT ゲートウェイ SNAT EIP 帯域幅の一貫性", "pt": "Consistência de Largura de Banda EIP SNAT do Gateway NAT", "zh": "NAT 网关 SNAT 条目绑定多个 EIP 时带宽峰值设置一致"}, Severity: "medium", Description: models.I18nString{"de": "Wenn SNAT-Einträge an mehrere EIPs gebunden sind, sollten die Bandbreiten-Peak-Einstellungen konsistent sein oder sie sollten zu einem gemeinsamen Bandbreitenpaket hinzugefügt werden.", "en": "When SNAT entries are bound to multiple EIPs, the bandwidth peak settings should be consistent or they should be added to a shared bandwidth package.", "es": "Cuando las entradas SNAT están vinculadas a múltiples EIPs, la configuración del pico de ancho de banda debe ser consistente o deben agregarse a un paquete de ancho de banda compartido.", "fr": "Lorsque les entrées SNAT sont liées à plusieurs EIP, les paramètres de pic de bande passante doivent être cohérents ou ils doivent être ajoutés à un package de bande passante partagée.", "ja": "SNAT エントリが複数の EIP にバインドされている場合、帯域幅ピーク設定は一貫しているか、共有帯域幅パッケージに追加する必要があります。", "pt": "Quando entradas SNAT estão vinculadas a múltiplos EIPs, as configurações de pico de largura de banda devem ser consistentes ou devem ser adicionadas a um pacote de largura de banda compartilhado.", "zh": "NAT 网关中 SNAT 条目绑定的多个 EIP，加入共享带宽包或者所绑定的 EIP 带宽峰值设置一致，视为合规。"}, Reason: models.I18nString{"de": "Inkonsistente Bandbreiteneinstellungen können zu unvorhersehbarer Netzwerkleistung und potenziellen Datenverteilungsproblemen führen.", "en": "Inconsistent bandwidth settings can lead to unpredictable network performance and potential traffic distribution issues.", "es": "Las configuraciones de ancho de banda inconsistentes pueden llevar a un rendimiento de red impredecible y problemas potenciales de distribución de tráfico.", "fr": "Des paramètres de bande passante incohérents peuvent entraîner des performances réseau imprévisibles et des problèmes potentiels de distribution du trafic.", "ja": "一貫性のない帯域幅設定により、予測不可能なネットワークパフォーマンスと潜在的なトラフィック分散の問題が発生する可能性があります。", "pt": "Configurações inconsistentes de largura de banda podem levar a desempenho de rede imprevisível e problemas potenciais de distribuição de tráfego.", "zh": "不一致的带宽设置可能导致不可预测的网络性能和潜在的流量分配问题。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass alle an SNAT-Einträge gebundenen EIPs konsistente Bandbreiteneinstellungen haben oder ein gemeinsames Bandbreitenpaket verwenden.", "en": "Ensure all EIPs bound to SNAT entries have consistent bandwidth settings or use a shared bandwidth package.", "es": "Asegúrese de que todos los EIPs vinculados a entradas SNAT tengan configuraciones de ancho de banda consistentes o usen un paquete de ancho de banda compartido.", "fr": "Assurez-vous que tous les EIP liés aux entrées SNAT ont des paramètres de bande passante cohérents ou utilisent un package de bande passante partagée.", "ja": "SNAT エントリにバインドされているすべての EIP が一貫した帯域幅設定を持つか、共有帯域幅パッケージを使用するようにします。", "pt": "Garanta que todos os EIPs vinculados a entradas SNAT tenham configurações de largura de banda consistentes ou usem um pacote de largura de banda compartilhado.", "zh": "确保绑定到 SNAT 条目的所有 EIP 具有一致的带宽设置，或使用共享带宽包。"}, ResourceTypes: []string{"ALIYUN::VPC::NatGateway"}, FilePath: "aliyun/rules/natgateway-snat-eip-bandwidth-check.rego", PackageName: "infraguard.rules.aliyun.natgateway_snat_eip_bandwidth_check", Content: "package infraguard.rules.aliyun.natgateway_snat_eip_bandwidth_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"natgateway-snat-eip-bandwidth-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"NAT Gateway SNAT EIP Bandwidth Consistency\",\n\t\t\"zh\": \"NAT 网关 SNAT 条目绑定多个 EIP 时带宽峰值设置一致\",\n\t\t\"ja\": \"NAT ゲートウェイ SNAT EIP 帯域幅の一貫性\",\n\t\t\"de\": \"NAT-Gateway SNAT EIP-Bandbreitenkonsistenz\",\n\t\t\"es\": \"Consistencia de Ancho de Banda EIP SNAT de Puerta de Enlace NAT\",\n\t\t\"fr\": \"Cohérence de Bande Passante EIP SNAT de Passerelle NAT\",\n\t\t\"pt\": \"Consistência de Largura de Banda EIP SNAT do Gateway NAT\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"When SNAT entries are bound to multiple EIPs, the bandwidth peak settings should be consistent or they should be added to a shared bandwidth package.\",\n\t\t\"zh\": \"NAT 网关中 SNAT 条目绑定的多个 EIP，加入共享带宽包或者所绑定的 EIP 带宽峰值设置一致，视为合规。\",\n\t\t\"ja\": \"SNAT エントリが複数の EIP にバインドされている場合、帯域幅ピーク設定は一貫しているか、共有帯域幅パッケージに追加する必要があります。\",\n\t\t\"de\": \"Wenn SNAT-Einträge an mehrere EIPs gebunden sind, sollten die Bandbreiten-Peak-Einstellungen konsistent sein oder sie sollten zu einem gemeinsamen Bandbreitenpaket hinzugefügt werden.\",\n\t\t\"es\": \"Cuando las entradas SNAT están vinculadas a múltiples EIPs, la configuración del pico de ancho de banda debe ser consistente o deben agregarse a un paquete de ancho de banda compartido.\",\n\t\t\"fr\": \"Lorsque les entrées SNAT sont liées à plusieurs EIP, les paramètres de pic de bande passante doivent être cohérents ou ils doivent être ajoutés à un package de bande passante partagée.\",\n\t\t\"pt\": \"Quando entradas SNAT estão vinculadas a múltiplos EIPs, as configurações de pico de largura de banda devem ser consistentes ou devem ser adicionadas a um pacote de largura de banda compartilhado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Inconsistent bandwidth settings can lead to unpredictable network performance and potential traffic distribution issues.\",\n\t\t\"zh\": \"不一致的带宽设置可能导致不可预测的网络性能和潜在的流量分配问题。\",\n\t\t\"ja\": \"一貫性のない帯域幅設定により、予測不可能なネットワークパフォーマンスと潜在的なトラフィック分散の問題が発生する可能性があります。\",\n\t\t\"de\": \"Inkonsistente Bandbreiteneinstellungen können zu unvorhersehbarer Netzwerkleistung und potenziellen Datenverteilungsproblemen führen.\",\n\t\t\"es\": \"Las configuraciones de ancho de banda inconsistentes pueden llevar a un rendimiento de red impredecible y problemas potenciales de distribución de tráfico.\",\n\t\t\"fr\": \"Des paramètres de bande passante incohérents peuvent entraîner des performances réseau imprévisibles et des problèmes potentiels de distribution du trafic.\",\n\t\t\"pt\": \"Configurações inconsistentes de largura de banda podem levar a desempenho de rede imprevisível e problemas potenciais de distribuição de tráfego.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure all EIPs bound to SNAT entries have consistent bandwidth settings or use a shared bandwidth package.\",\n\t\t\"zh\": \"确保绑定到 SNAT 条目的所有 EIP 具有一致的带宽设置，或使用共享带宽包。\",\n\t\t\"ja\": \"SNAT エントリにバインドされているすべての EIP が一貫した帯域幅設定を持つか、共有帯域幅パッケージを使用するようにします。\",\n\t\t\"de\": \"Stellen Sie sicher, dass alle an SNAT-Einträge gebundenen EIPs konsistente Bandbreiteneinstellungen haben oder ein gemeinsames Bandbreitenpaket verwenden.\",\n\t\t\"es\": \"Asegúrese de que todos los EIPs vinculados a entradas SNAT tengan configuraciones de ancho de banda consistentes o usen un paquete de ancho de banda compartido.\",\n\t\t\"fr\": \"Assurez-vous que tous les EIP liés aux entrées SNAT ont des paramètres de bande passante cohérents ou utilisent un package de bande passante partagée.\",\n\t\t\"pt\": \"Garanta que todos os EIPs vinculados a entradas SNAT tenham configurações de largura de banda consistentes ou usem um pacote de largura de banda compartilhado.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::NatGateway\"]\n}\n\nis_vpc_nat_gateway(resource) if {\n\tnetwork_type := helpers.get_property(resource, \"NetworkType\", \"\")\n\tnetwork_type == \"intranet\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::VPC::NatGateway\")\n\tnot is_vpc_nat_gateway(resource)\n\n\t# Simplified check: assumes proper configuration is present\n\tnot helpers.has_property(resource, \"EipBindMode\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EipBindMode\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:nlb-loadbalancer-multi-zone", Name: models.I18nString{"de": "NLB LoadBalancer Multi-Zonen-Bereitstellung", "en": "NLB LoadBalancer Multi-Zone Deployment", "es": "Implementación Multi-Zona del Equilibrador de Carga NLB", "fr": "Déploiement Multi-Zone de l'Équilibreur de Charge NLB", "ja": "NLB ロードバランサーマルチゾーン展開", "pt": "Implantação Multi-Zona do Balanceador de Carga NLB", "zh": "使用多可用区的网络负载均衡实例"}, Severity: "medium", Description: models.I18nString{"de": "NLB LoadBalancer-Instanzen sollten über mindestens zwei Verfügbarkeitszonen für Hochverfügbarkeit bereitgestellt werden.", "en": "NLB LoadBalancer instances should be deployed across at least two availability zones for high availability.", "es": "Las instancias del equilibrador de carga NLB deben implementarse en al menos dos zonas de disponibilidad para alta disponibilidad.", "fr": "Les instances d'équilibreur de charge NLB doivent être déployées sur au moins deux zones de disponibilité pour une haute disponibilité.", "ja": "NLB LoadBalancer インスタンスは、高可用性のために少なくとも 2 つの可用性ゾーンに展開する必要があります。", "pt": "As instâncias do balanceador de carga NLB devem ser implantadas em pelo menos duas zonas de disponibilidade para alta disponibilidade.", "zh": "使用多可用区的网络负载均衡实例，视为合规。"}, Reason: models.I18nString{"de": "Der NLB LoadBalancer wird in weniger als zwei Verfügbarkeitszonen bereitgestellt, was ein Single Point of Failure-Risiko schafft.", "en": "The NLB LoadBalancer is deployed in fewer than two availability zones, creating a single point of failure risk.", "es": "El equilibrador de carga NLB se implementa en menos de dos zonas de disponibilidad, creando un riesgo de punto único de falla.", "fr": "L'équilibreur de charge NLB est déployé dans moins de deux zones de disponibilité, créant un risque de point de défaillance unique.", "ja": "NLB LoadBalancer が 2 未満の可用性ゾーンに展開されているため、単一障害点のリスクが作成されます。", "pt": "O balanceador de carga NLB é implantado em menos de duas zonas de disponibilidade, criando um risco de ponto único de falha.", "zh": "网络负载均衡实例部署在少于两个可用区，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie mindestens zwei Zonen-Mappings in der Eigenschaft ZoneMappings, um Hochverfügbarkeit sicherzustellen.", "en": "Configure at least two zone mappings in the ZoneMappings property to ensure high availability.", "es": "Configure al menos dos mapeos de zona en la propiedad ZoneMappings para garantizar alta disponibilidad.", "fr": "Configurez au moins deux mappages de zone dans la propriété ZoneMappings pour assurer une haute disponibilité.", "ja": "高可用性を確保するために、ZoneMappings プロパティに少なくとも 2 つのゾーンマッピングを設定します。", "pt": "Configure pelo menos dois mapeamentos de zona na propriedade ZoneMappings para garantir alta disponibilidade.", "zh": "在 ZoneMappings 属性中配置至少两个可用区映射，以确保高可用性。"}, ResourceTypes: []string{"ALIYUN::NLB::LoadBalancer"}, FilePath: "aliyun/rules/nlb-loadbalancer-multi-zone.rego", PackageName: "infraguard.rules.aliyun.nlb_loadbalancer_multi_zone", Content: "package infraguard.rules.aliyun.nlb_loadbalancer_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"nlb-loadbalancer-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"NLB LoadBalancer Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的网络负载均衡实例\",\n\t\t\"ja\": \"NLB ロードバランサーマルチゾーン展開\",\n\t\t\"de\": \"NLB LoadBalancer Multi-Zonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona del Equilibrador de Carga NLB\",\n\t\t\"fr\": \"Déploiement Multi-Zone de l'Équilibreur de Charge NLB\",\n\t\t\"pt\": \"Implantação Multi-Zona do Balanceador de Carga NLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"NLB LoadBalancer instances should be deployed across at least two availability zones for high availability.\",\n\t\t\"zh\": \"使用多可用区的网络负载均衡实例，视为合规。\",\n\t\t\"ja\": \"NLB LoadBalancer インスタンスは、高可用性のために少なくとも 2 つの可用性ゾーンに展開する必要があります。\",\n\t\t\"de\": \"NLB LoadBalancer-Instanzen sollten über mindestens zwei Verfügbarkeitszonen für Hochverfügbarkeit bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias del equilibrador de carga NLB deben implementarse en al menos dos zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances d'équilibreur de charge NLB doivent être déployées sur au moins deux zones de disponibilité pour une haute disponibilité.\",\n\t\t\"pt\": \"As instâncias do balanceador de carga NLB devem ser implantadas em pelo menos duas zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The NLB LoadBalancer is deployed in fewer than two availability zones, creating a single point of failure risk.\",\n\t\t\"zh\": \"网络负载均衡实例部署在少于两个可用区，存在单点故障风险。\",\n\t\t\"ja\": \"NLB LoadBalancer が 2 未満の可用性ゾーンに展開されているため、単一障害点のリスクが作成されます。\",\n\t\t\"de\": \"Der NLB LoadBalancer wird in weniger als zwei Verfügbarkeitszonen bereitgestellt, was ein Single Point of Failure-Risiko schafft.\",\n\t\t\"es\": \"El equilibrador de carga NLB se implementa en menos de dos zonas de disponibilidad, creando un riesgo de punto único de falla.\",\n\t\t\"fr\": \"L'équilibreur de charge NLB est déployé dans moins de deux zones de disponibilité, créant un risque de point de défaillance unique.\",\n\t\t\"pt\": \"O balanceador de carga NLB é implantado em menos de duas zonas de disponibilidade, criando um risco de ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure at least two zone mappings in the ZoneMappings property to ensure high availability.\",\n\t\t\"zh\": \"在 ZoneMappings 属性中配置至少两个可用区映射，以确保高可用性。\",\n\t\t\"ja\": \"高可用性を確保するために、ZoneMappings プロパティに少なくとも 2 つのゾーンマッピングを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie mindestens zwei Zonen-Mappings in der Eigenschaft ZoneMappings, um Hochverfügbarkeit sicherzustellen.\",\n\t\t\"es\": \"Configure al menos dos mapeos de zona en la propiedad ZoneMappings para garantizar alta disponibilidad.\",\n\t\t\"fr\": \"Configurez au moins deux mappages de zone dans la propriété ZoneMappings pour assurer une haute disponibilité.\",\n\t\t\"pt\": \"Configure pelo menos dois mapeamentos de zona na propriedade ZoneMappings para garantir alta disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NLB::LoadBalancer\"]\n}\n\n# Check if LoadBalancer has multiple zones\nhas_multiple_zones(resource) if {\n\tzone_mappings := resource.Properties.ZoneMappings\n\tcount(zone_mappings) >= 2\n}\n\n# Deny rule: NLB LoadBalancers must be deployed in multiple zones\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NLB::LoadBalancer\")\n\tnot has_multiple_zones(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ZoneMappings\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:nlb-server-group-multi-zone", Name: models.I18nString{"de": "NLB-Server-Gruppe Multi-Zone-Verteilung", "en": "NLB Server Group Multi-Zone Distribution", "es": "Distribución Multi-Zona del Grupo de Servidores NLB", "fr": "Distribution Multi-Zone du Groupe de Serveurs NLB", "ja": "NLB サーバーグループのマルチゾーン分散", "pt": "Distribuição Multi-Zona do Grupo de Servidores NLB", "zh": "NLB 负载均衡服务器组添加多个可用区资源"}, Severity: "medium", Description: models.I18nString{"de": "NLB-Server-Gruppen sollten Backend-Server für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen verteilt haben. Diese Regel gilt nicht für Server-Gruppen ohne angehängte Server oder für IP-Typ-Server-Gruppen.", "en": "NLB server groups should have backend servers distributed across multiple availability zones for high availability. This rule does not apply to server groups with no attached servers, or to IP type server groups.", "es": "Los grupos de servidores NLB deben tener servidores backend distribuidos en múltiples zonas de disponibilidad para alta disponibilidad. Esta regla no se aplica a grupos de servidores sin servidores adjuntos, ni a grupos de servidores de tipo IP.", "fr": "Les groupes de serveurs NLB doivent avoir des serveurs backend distribués sur plusieurs zones de disponibilité pour une haute disponibilité. Cette règle ne s'applique pas aux groupes de serveurs sans serveurs attachés, ni aux groupes de serveurs de type IP.", "ja": "NLB サーバーグループは高可用性のために、バックエンドサーバーを複数の可用性ゾーンに分散させる必要があります。このルールは、サーバーが接続されていないサーバーグループ、または IP タイプのサーバーグループには適用されません。", "pt": "Os grupos de servidores NLB devem ter servidores backend distribuídos em múltiplas zonas de disponibilidade para alta disponibilidade. Esta regra não se aplica a grupos de servidores sem servidores anexados ou a grupos de servidores do tipo IP.", "zh": "网络负载均衡的服务器组中资源分布在多个可用区，视为合规。服务器组中无资源或者资源类型为 IP 时，视为不适用。"}, Reason: models.I18nString{"de": "Die NLB-Server-Gruppe hat Backend-Server nur in einer Verfügbarkeitszone, was einen Single Point of Failure schafft.", "en": "The NLB server group has backend servers in only one availability zone, creating a single point of failure.", "es": "El grupo de servidores NLB tiene servidores backend en solo una zona de disponibilidad, creando un punto único de falla.", "fr": "Le groupe de serveurs NLB a des serveurs backend dans une seule zone de disponibilité, créant un point de défaillance unique.", "ja": "NLB サーバーグループのバックエンドサーバーが 1 つの可用性ゾーンにのみ存在し、単一障害点が作成されています。", "pt": "O grupo de servidores NLB tem servidores backend em apenas uma zona de disponibilidade, criando um ponto único de falha.", "zh": "NLB 服务器组的后端服务器仅分布在一个可用区，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Fügen Sie Backend-Server aus mindestens zwei verschiedenen Verfügbarkeitszonen zur Server-Gruppe hinzu, indem Sie ALIYUN::NLB::BackendServerAttachment-Ressourcen verwenden.", "en": "Add backend servers from at least two different availability zones to the server group using ALIYUN::NLB::BackendServerAttachment resources.", "es": "Agregue servidores backend de al menos dos zonas de disponibilidad diferentes al grupo de servidores usando recursos ALIYUN::NLB::BackendServerAttachment.", "fr": "Ajoutez des serveurs backend d'au moins deux zones de disponibilité différentes au groupe de serveurs en utilisant les ressources ALIYUN::NLB::BackendServerAttachment.", "ja": "ALIYUN::NLB::BackendServerAttachment リソースを使用して、少なくとも 2 つの異なる可用性ゾーンからバックエンドサーバーをサーバーグループに追加します。", "pt": "Adicione servidores backend de pelo menos duas zonas de disponibilidade diferentes ao grupo de servidores usando recursos ALIYUN::NLB::BackendServerAttachment.", "zh": "使用 ALIYUN::NLB::BackendServerAttachment 资源，向服务器组添加来自至少两个不同可用区的后端服务器。"}, ResourceTypes: []string{"ALIYUN::NLB::ServerGroup"}, FilePath: "aliyun/rules/nlb-server-group-multi-zone.rego", PackageName: "infraguard.rules.aliyun.nlb_server_group_multi_zone", Content: "package infraguard.rules.aliyun.nlb_server_group_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"nlb-server-group-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"NLB Server Group Multi-Zone Distribution\",\n\t\t\"zh\": \"NLB 负载均衡服务器组添加多个可用区资源\",\n\t\t\"ja\": \"NLB サーバーグループのマルチゾーン分散\",\n\t\t\"de\": \"NLB-Server-Gruppe Multi-Zone-Verteilung\",\n\t\t\"es\": \"Distribución Multi-Zona del Grupo de Servidores NLB\",\n\t\t\"fr\": \"Distribution Multi-Zone du Groupe de Serveurs NLB\",\n\t\t\"pt\": \"Distribuição Multi-Zona do Grupo de Servidores NLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"NLB server groups should have backend servers distributed across multiple availability zones for high availability. This rule does not apply to server groups with no attached servers, or to IP type server groups.\",\n\t\t\"zh\": \"网络负载均衡的服务器组中资源分布在多个可用区，视为合规。服务器组中无资源或者资源类型为 IP 时，视为不适用。\",\n\t\t\"ja\": \"NLB サーバーグループは高可用性のために、バックエンドサーバーを複数の可用性ゾーンに分散させる必要があります。このルールは、サーバーが接続されていないサーバーグループ、または IP タイプのサーバーグループには適用されません。\",\n\t\t\"de\": \"NLB-Server-Gruppen sollten Backend-Server für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen verteilt haben. Diese Regel gilt nicht für Server-Gruppen ohne angehängte Server oder für IP-Typ-Server-Gruppen.\",\n\t\t\"es\": \"Los grupos de servidores NLB deben tener servidores backend distribuidos en múltiples zonas de disponibilidad para alta disponibilidad. Esta regla no se aplica a grupos de servidores sin servidores adjuntos, ni a grupos de servidores de tipo IP.\",\n\t\t\"fr\": \"Les groupes de serveurs NLB doivent avoir des serveurs backend distribués sur plusieurs zones de disponibilité pour une haute disponibilité. Cette règle ne s'applique pas aux groupes de serveurs sans serveurs attachés, ni aux groupes de serveurs de type IP.\",\n\t\t\"pt\": \"Os grupos de servidores NLB devem ter servidores backend distribuídos em múltiplas zonas de disponibilidade para alta disponibilidade. Esta regra não se aplica a grupos de servidores sem servidores anexados ou a grupos de servidores do tipo IP.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The NLB server group has backend servers in only one availability zone, creating a single point of failure.\",\n\t\t\"zh\": \"NLB 服务器组的后端服务器仅分布在一个可用区，存在单点故障风险。\",\n\t\t\"ja\": \"NLB サーバーグループのバックエンドサーバーが 1 つの可用性ゾーンにのみ存在し、単一障害点が作成されています。\",\n\t\t\"de\": \"Die NLB-Server-Gruppe hat Backend-Server nur in einer Verfügbarkeitszone, was einen Single Point of Failure schafft.\",\n\t\t\"es\": \"El grupo de servidores NLB tiene servidores backend en solo una zona de disponibilidad, creando un punto único de falla.\",\n\t\t\"fr\": \"Le groupe de serveurs NLB a des serveurs backend dans une seule zone de disponibilité, créant un point de défaillance unique.\",\n\t\t\"pt\": \"O grupo de servidores NLB tem servidores backend em apenas uma zona de disponibilidade, criando um ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add backend servers from at least two different availability zones to the server group using ALIYUN::NLB::BackendServerAttachment resources.\",\n\t\t\"zh\": \"使用 ALIYUN::NLB::BackendServerAttachment 资源，向服务器组添加来自至少两个不同可用区的后端服务器。\",\n\t\t\"ja\": \"ALIYUN::NLB::BackendServerAttachment リソースを使用して、少なくとも 2 つの異なる可用性ゾーンからバックエンドサーバーをサーバーグループに追加します。\",\n\t\t\"de\": \"Fügen Sie Backend-Server aus mindestens zwei verschiedenen Verfügbarkeitszonen zur Server-Gruppe hinzu, indem Sie ALIYUN::NLB::BackendServerAttachment-Ressourcen verwenden.\",\n\t\t\"es\": \"Agregue servidores backend de al menos dos zonas de disponibilidad diferentes al grupo de servidores usando recursos ALIYUN::NLB::BackendServerAttachment.\",\n\t\t\"fr\": \"Ajoutez des serveurs backend d'au moins deux zones de disponibilité différentes au groupe de serveurs en utilisant les ressources ALIYUN::NLB::BackendServerAttachment.\",\n\t\t\"pt\": \"Adicione servidores backend de pelo menos duas zonas de disponibilidade diferentes ao grupo de servidores usando recursos ALIYUN::NLB::BackendServerAttachment.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::NLB::ServerGroup\"]\n}\n\n# Check if server group type is applicable (Instance)\nis_applicable_type(resource) if {\n\tserver_group_type := helpers.get_property(resource, \"ServerGroupType\", \"Instance\")\n\tserver_group_type == \"Instance\"\n}\n\n# Get server group ID from reference or direct value\nget_server_group_id(value) := value if {\n\tis_string(value)\n}\n\nget_server_group_id(value) := value.Ref if {\n\tis_object(value)\n\tvalue.Ref\n}\n\n# Get server ID from reference or direct value\nget_server_id(value) := value if {\n\tis_string(value)\n}\n\nget_server_id(value) := value.Ref if {\n\tis_object(value)\n\tvalue.Ref\n}\n\n# Check if attachment belongs to this server group\nattachment_belongs_to_group(attachment, server_group_id) if {\n\tgroup_id := get_server_group_id(attachment.Properties.ServerGroupId)\n\tgroup_id == server_group_id\n}\n\n# Get all zones from backend servers for a server group\nzones_for_server_group(server_group_id) := zones if {\n\t# Find all attachments for this server group\n\tattachments := [attachment |\n\t\tsome _, attachment in helpers.resources_by_type(\"ALIYUN::NLB::BackendServerAttachment\")\n\t\tattachment_belongs_to_group(attachment, server_group_id)\n\t]\n\n\t# Get all zones from servers in these attachments\n\tzones := {zone |\n\t\tsome attachment in attachments\n\t\tsome server in attachment.Properties.Servers\n\t\tserver_id := get_server_id(server.ServerId)\n\n\t\t# Look up the server resource\n\t\tsome name, resource in input.Resources\n\t\tname == server_id\n\t\tresource.Type in {\"ALIYUN::ECS::Instance\", \"ALIYUN::ECS::InstanceGroup\"}\n\t\tzone := resource.Properties.ZoneId\n\t}\n}\n\n# Check if server group has attachments\nhas_attachments(server_group_id) if {\n\tsome _, attachment in helpers.resources_by_type(\"ALIYUN::NLB::BackendServerAttachment\")\n\tattachment_belongs_to_group(attachment, server_group_id)\n}\n\n# Check if servers are distributed across multiple zones\nis_multi_zone_distributed(server_group_id) if {\n\tzones := zones_for_server_group(server_group_id)\n\tcount(zones) >= 2\n}\n\n# Deny rule: NLB server groups must have servers in multiple zones\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::NLB::ServerGroup\")\n\n\t# Only check Instance type server groups\n\tis_applicable_type(resource)\n\n\t# Only check if there are attachments\n\thas_attachments(name)\n\n\t# Check if not multi-zone\n\tnot is_multi_zone_distributed(name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-anonymous-prohibited", Name: models.I18nString{"de": "OSS-Bucket anonyme Zugriffe verboten", "en": "OSS Bucket Anonymous Access Prohibited", "es": "Acceso Anónimo de Bucket OSS Prohibido", "fr": "Accès Anonyme au Bucket OSS Interdit", "ja": "OSS バケットの匿名アクセスが禁止", "pt": "Acesso Anônimo de Bucket OSS Proibido", "zh": "OSS 存储桶禁用匿名访问"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass anonyme Zugriffe für den OSS-Bucket verboten sind.", "en": "Ensures that anonymous access is prohibited for the OSS bucket.", "es": "Garantiza que el acceso anónimo esté prohibido para el bucket OSS.", "fr": "Garantit que l'accès anonyme est interdit pour le bucket OSS.", "ja": "OSS バケットで匿名アクセスが禁止されていることを確認します。", "pt": "Garante que o acesso anônimo esteja proibido para o bucket OSS.", "zh": "确保 OSS 存储桶禁用了匿名访问。"}, Reason: models.I18nString{"de": "Anonymer Zugriff auf einen OSS-Bucket erhöht das Risiko einer unbefugten Datenexposition.", "en": "Anonymous access to an OSS bucket increases the risk of unauthorized data exposure.", "es": "El acceso anónimo a un bucket OSS aumenta el riesgo de exposición no autorizada de datos.", "fr": "L'accès anonyme à un bucket OSS augmente le risque d'exposition non autorisée des données.", "ja": "OSS バケットへの匿名アクセスは、不正なデータ公開のリスクを増加させます。", "pt": "O acesso anônimo a um bucket OSS aumenta o risco de exposição não autorizada de dados.", "zh": "对 OSS 存储桶的匿名访问增加了数据未经授权泄露的风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die OSS-Bucket-ACL auf 'private' und stellen Sie sicher, dass anonymen Benutzern keine öffentlichen Lese-/Schreibberechtigungen gewährt werden.", "en": "Configure the OSS bucket ACL to 'private' and ensure no public read/write permissions are granted to anonymous users.", "es": "Configure el ACL del bucket OSS en 'private' y asegúrese de que no se otorguen permisos de lectura/escritura públicos a usuarios anónimos.", "fr": "Configurez l'ACL du bucket OSS sur 'private' et assurez-vous qu'aucune permission de lecture/écriture publique n'est accordée aux utilisateurs anonymes.", "ja": "OSS バケット ACL を 'private' に設定し、匿名ユーザーにパブリック読み取り/書き込み権限が付与されていないことを確認します。", "pt": "Configure o ACL do bucket OSS como 'private' e garanta que nenhuma permissão de leitura/gravação pública seja concedida a usuários anônimos.", "zh": "将 OSS 存储桶 ACL 配置为'private'，并确保未向匿名用户授予公开读写权限。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-anonymous-prohibited.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_anonymous_prohibited", Content: "package infraguard.rules.aliyun.oss_bucket_anonymous_prohibited\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"oss-bucket-anonymous-prohibited\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Anonymous Access Prohibited\",\n\t\t\"zh\": \"OSS 存储桶禁用匿名访问\",\n\t\t\"ja\": \"OSS バケットの匿名アクセスが禁止\",\n\t\t\"de\": \"OSS-Bucket anonyme Zugriffe verboten\",\n\t\t\"es\": \"Acceso Anónimo de Bucket OSS Prohibido\",\n\t\t\"fr\": \"Accès Anonyme au Bucket OSS Interdit\",\n\t\t\"pt\": \"Acesso Anônimo de Bucket OSS Proibido\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that anonymous access is prohibited for the OSS bucket.\",\n\t\t\"zh\": \"确保 OSS 存储桶禁用了匿名访问。\",\n\t\t\"ja\": \"OSS バケットで匿名アクセスが禁止されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass anonyme Zugriffe für den OSS-Bucket verboten sind.\",\n\t\t\"es\": \"Garantiza que el acceso anónimo esté prohibido para el bucket OSS.\",\n\t\t\"fr\": \"Garantit que l'accès anonyme est interdit pour le bucket OSS.\",\n\t\t\"pt\": \"Garante que o acesso anônimo esteja proibido para o bucket OSS.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Anonymous access to an OSS bucket increases the risk of unauthorized data exposure.\",\n\t\t\"zh\": \"对 OSS 存储桶的匿名访问增加了数据未经授权泄露的风险。\",\n\t\t\"ja\": \"OSS バケットへの匿名アクセスは、不正なデータ公開のリスクを増加させます。\",\n\t\t\"de\": \"Anonymer Zugriff auf einen OSS-Bucket erhöht das Risiko einer unbefugten Datenexposition.\",\n\t\t\"es\": \"El acceso anónimo a un bucket OSS aumenta el riesgo de exposición no autorizada de datos.\",\n\t\t\"fr\": \"L'accès anonyme à un bucket OSS augmente le risque d'exposition non autorisée des données.\",\n\t\t\"pt\": \"O acesso anônimo a um bucket OSS aumenta o risco de exposição não autorizada de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the OSS bucket ACL to 'private' and ensure no public read/write permissions are granted to anonymous users.\",\n\t\t\"zh\": \"将 OSS 存储桶 ACL 配置为'private'，并确保未向匿名用户授予公开读写权限。\",\n\t\t\"ja\": \"OSS バケット ACL を 'private' に設定し、匿名ユーザーにパブリック読み取り/書き込み権限が付与されていないことを確認します。\",\n\t\t\"de\": \"Konfigurieren Sie die OSS-Bucket-ACL auf 'private' und stellen Sie sicher, dass anonymen Benutzern keine öffentlichen Lese-/Schreibberechtigungen gewährt werden.\",\n\t\t\"es\": \"Configure el ACL del bucket OSS en 'private' y asegúrese de que no se otorguen permisos de lectura/escritura públicos a usuarios anónimos.\",\n\t\t\"fr\": \"Configurez l'ACL du bucket OSS sur 'private' et assurez-vous qu'aucune permission de lecture/écriture publique n'est accordée aux utilisateurs anonymes.\",\n\t\t\"pt\": \"Configure o ACL do bucket OSS como 'private' e garanta que nenhuma permissão de leitura/gravação pública seja concedida a usuários anônimos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\n\t# Conceptual check for public access\n\tacl := helpers.get_property(resource, \"AccessControlList\", \"private\")\n\tacl != \"private\"\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AccessControlList\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-authorize-specified-ip", Name: models.I18nString{"de": "OSS-Bucket autorisiert angegebene IP", "en": "OSS Bucket Authorize Specified IP", "es": "Bucket OSS Autoriza IP Especificada", "fr": "Bucket OSS Autorise IP Spécifiée", "ja": "OSS バケットが指定 IP を承認", "pt": "Bucket OSS Autoriza IP Especificada", "zh": "OSS 存储桶策略授权特定 IP"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass OSS-Bucket-Richtlinien den Zugriff auf angegebene IP-Bereiche einschränken.", "en": "Ensures OSS bucket policies restrict access to specified IP ranges.", "es": "Garantiza que las políticas de bucket OSS restrinjan el acceso a rangos de IP especificados.", "fr": "Garantit que les politiques de bucket OSS restreignent l'accès aux plages d'IP spécifiées.", "ja": "OSS バケットポリシーが特定の IP 範囲へのアクセスを制限していることを確認します。", "pt": "Garante que as políticas de bucket OSS restrinjam o acesso a intervalos de IP especificados.", "zh": "确保 OSS 存储桶策略限制了特定 IP 范围的访问。"}, Reason: models.I18nString{"de": "Die Einschränkung des Zugriffs nach IP hilft, unbefugten Zugriff zu verhindern, auch wenn Anmeldeinformationen kompromittiert sind.", "en": "Restricting access by IP helps prevent unauthorized access even if credentials are compromised.", "es": "Restringir el acceso por IP ayuda a prevenir el acceso no autorizado incluso si las credenciales están comprometidas.", "fr": "Restreindre l'accès par IP aide à prévenir l'accès non autorisé même si les identifiants sont compromis.", "ja": "IP によるアクセス制限は、認証情報が侵害された場合でも不正アクセスを防ぐのに役立ちます。", "pt": "Restringir o acesso por IP ajuda a prevenir acesso não autorizado mesmo se as credenciais estiverem comprometidas.", "zh": "通过 IP 限制访问有助于防止在凭据泄露时发生未经授权的访问。"}, Recommendation: models.I18nString{"de": "Fügen Sie IP-Beschränkungsbedingungen (acs:SourceIp) zur OSS-Bucket-Richtlinie hinzu.", "en": "Add IP restriction conditions (acs:SourceIp) to the OSS bucket policy.", "es": "Agregue condiciones de restricción de IP (acs:SourceIp) a la política de bucket OSS.", "fr": "Ajoutez des conditions de restriction IP (acs:SourceIp) à la politique de bucket OSS.", "ja": "OSS バケットポリシーに IP 制限条件（acs:SourceIp）を追加します。", "pt": "Adicione condições de restrição de IP (acs:SourceIp) à política de bucket OSS.", "zh": "在 OSS 存储桶策略中添加 IP 限制条件（acs:SourceIp）。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-authorize-specified-ip.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_authorize_specified_ip", Content: "package infraguard.rules.aliyun.oss_bucket_authorize_specified_ip\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"oss-bucket-authorize-specified-ip\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Authorize Specified IP\",\n\t\t\"zh\": \"OSS 存储桶策略授权特定 IP\",\n\t\t\"ja\": \"OSS バケットが指定 IP を承認\",\n\t\t\"de\": \"OSS-Bucket autorisiert angegebene IP\",\n\t\t\"es\": \"Bucket OSS Autoriza IP Especificada\",\n\t\t\"fr\": \"Bucket OSS Autorise IP Spécifiée\",\n\t\t\"pt\": \"Bucket OSS Autoriza IP Especificada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures OSS bucket policies restrict access to specified IP ranges.\",\n\t\t\"zh\": \"确保 OSS 存储桶策略限制了特定 IP 范围的访问。\",\n\t\t\"ja\": \"OSS バケットポリシーが特定の IP 範囲へのアクセスを制限していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass OSS-Bucket-Richtlinien den Zugriff auf angegebene IP-Bereiche einschränken.\",\n\t\t\"es\": \"Garantiza que las políticas de bucket OSS restrinjan el acceso a rangos de IP especificados.\",\n\t\t\"fr\": \"Garantit que les politiques de bucket OSS restreignent l'accès aux plages d'IP spécifiées.\",\n\t\t\"pt\": \"Garante que as políticas de bucket OSS restrinjam o acesso a intervalos de IP especificados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Restricting access by IP helps prevent unauthorized access even if credentials are compromised.\",\n\t\t\"zh\": \"通过 IP 限制访问有助于防止在凭据泄露时发生未经授权的访问。\",\n\t\t\"ja\": \"IP によるアクセス制限は、認証情報が侵害された場合でも不正アクセスを防ぐのに役立ちます。\",\n\t\t\"de\": \"Die Einschränkung des Zugriffs nach IP hilft, unbefugten Zugriff zu verhindern, auch wenn Anmeldeinformationen kompromittiert sind.\",\n\t\t\"es\": \"Restringir el acceso por IP ayuda a prevenir el acceso no autorizado incluso si las credenciales están comprometidas.\",\n\t\t\"fr\": \"Restreindre l'accès par IP aide à prévenir l'accès non autorisé même si les identifiants sont compromis.\",\n\t\t\"pt\": \"Restringir o acesso por IP ajuda a prevenir acesso não autorizado mesmo se as credenciais estiverem comprometidas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add IP restriction conditions (acs:SourceIp) to the OSS bucket policy.\",\n\t\t\"zh\": \"在 OSS 存储桶策略中添加 IP 限制条件（acs:SourceIp）。\",\n\t\t\"ja\": \"OSS バケットポリシーに IP 制限条件（acs:SourceIp）を追加します。\",\n\t\t\"de\": \"Fügen Sie IP-Beschränkungsbedingungen (acs:SourceIp) zur OSS-Bucket-Richtlinie hinzu.\",\n\t\t\"es\": \"Agregue condiciones de restricción de IP (acs:SourceIp) a la política de bucket OSS.\",\n\t\t\"fr\": \"Ajoutez des conditions de restriction IP (acs:SourceIp) à la politique de bucket OSS.\",\n\t\t\"pt\": \"Adicione condições de restrição de IP (acs:SourceIp) à política de bucket OSS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\nis_compliant(resource) if {\n\tpolicy := helpers.get_property(resource, \"Policy\", {})\n\tstatements := object.get(policy, \"Statement\", [])\n\tsome statement in statements\n\tcondition := object.get(statement, \"Condition\", {})\n\tip_address := object.get(condition, \"IpAddress\", {})\n\n\t# Check for acs:SourceIp in the IpAddress condition\n\tobject.get(ip_address, \"acs:SourceIp\", null) != null\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Policy\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-backup-enable", Name: models.I18nString{"de": "OSS-Backup aktiviert", "en": "OSS Backup Enabled", "es": "Respaldo OSS Habilitado", "fr": "Sauvegarde OSS Activée", "ja": "OSS バックアップが有効", "pt": "Backup OSS Habilitado", "zh": "OSS 开启备份"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass OSS-Buckets Backup oder Versionskontrolle aktiviert haben.", "en": "Ensures OSS buckets have backup or versioning enabled.", "es": "Garantiza que los buckets OSS tengan respaldo o control de versiones habilitado.", "fr": "Garantit que les buckets OSS ont la sauvegarde ou le contrôle de version activé.", "ja": "OSS バケットでバックアップまたはバージョン管理が有効になっていることを確認します。", "pt": "Garante que os buckets OSS tenham backup ou controle de versão habilitado.", "zh": "确保 OSS 存储桶开启了备份或版本控制。"}, Reason: models.I18nString{"de": "Backups und Versionskontrolle verhindern Datenverlust durch versehentliches Löschen oder Ändern.", "en": "Backups and versioning prevent data loss from accidental deletion or modification.", "es": "Las copias de seguridad y el control de versiones previenen la pérdida de datos por eliminación o modificación accidental.", "fr": "Les sauvegardes et le contrôle de version empêchent la perte de données due à une suppression ou modification accidentelle.", "ja": "バックアップとバージョン管理により、誤削除や変更によるデータ損失を防ぎます。", "pt": "Backups e controle de versão previnem perda de dados por exclusão ou modificação acidental.", "zh": "备份和版本控制可防止因意外删除或修改导致的数据丢失。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Versionskontrolle oder regionsübergreifende Replikation für den OSS-Bucket.", "en": "Enable versioning or cross-region replication for the OSS bucket.", "es": "Habilite el control de versiones o la replicación entre regiones para el bucket OSS.", "fr": "Activez le contrôle de version ou la réplication inter-régions pour le bucket OSS.", "ja": "OSS バケットのバージョン管理またはクロスリージョンレプリケーションを有効にします。", "pt": "Habilite o controle de versão ou a replicação entre regiões para o bucket OSS.", "zh": "为 OSS 存储桶开启版本控制或跨区域复制。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-backup-enable.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_backup_enable", Content: "package infraguard.rules.aliyun.oss_bucket_backup_enable\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"oss-bucket-backup-enable\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS Backup Enabled\",\n\t\t\"zh\": \"OSS 开启备份\",\n\t\t\"ja\": \"OSS バックアップが有効\",\n\t\t\"de\": \"OSS-Backup aktiviert\",\n\t\t\"es\": \"Respaldo OSS Habilitado\",\n\t\t\"fr\": \"Sauvegarde OSS Activée\",\n\t\t\"pt\": \"Backup OSS Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures OSS buckets have backup or versioning enabled.\",\n\t\t\"zh\": \"确保 OSS 存储桶开启了备份或版本控制。\",\n\t\t\"ja\": \"OSS バケットでバックアップまたはバージョン管理が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass OSS-Buckets Backup oder Versionskontrolle aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los buckets OSS tengan respaldo o control de versiones habilitado.\",\n\t\t\"fr\": \"Garantit que les buckets OSS ont la sauvegarde ou le contrôle de version activé.\",\n\t\t\"pt\": \"Garante que os buckets OSS tenham backup ou controle de versão habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Backups and versioning prevent data loss from accidental deletion or modification.\",\n\t\t\"zh\": \"备份和版本控制可防止因意外删除或修改导致的数据丢失。\",\n\t\t\"ja\": \"バックアップとバージョン管理により、誤削除や変更によるデータ損失を防ぎます。\",\n\t\t\"de\": \"Backups und Versionskontrolle verhindern Datenverlust durch versehentliches Löschen oder Ändern.\",\n\t\t\"es\": \"Las copias de seguridad y el control de versiones previenen la pérdida de datos por eliminación o modificación accidental.\",\n\t\t\"fr\": \"Les sauvegardes et le contrôle de version empêchent la perte de données due à une suppression ou modification accidentelle.\",\n\t\t\"pt\": \"Backups e controle de versão previnem perda de dados por exclusão ou modificação acidental.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable versioning or cross-region replication for the OSS bucket.\",\n\t\t\"zh\": \"为 OSS 存储桶开启版本控制或跨区域复制。\",\n\t\t\"ja\": \"OSS バケットのバージョン管理またはクロスリージョンレプリケーションを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Versionskontrolle oder regionsübergreifende Replikation für den OSS-Bucket.\",\n\t\t\"es\": \"Habilite el control de versiones o la replicación entre regiones para el bucket OSS.\",\n\t\t\"fr\": \"Activez le contrôle de version ou la réplication inter-régions pour le bucket OSS.\",\n\t\t\"pt\": \"Habilite o controle de versão ou a replicação entre regiões para o bucket OSS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\nis_compliant(resource) if {\n\t# Versioning check\n\tv := helpers.get_property(resource, \"VersioningConfiguration\", {})\n\tv.Status == \"Enabled\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VersioningConfiguration\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-logging-enabled", Name: models.I18nString{"de": "OSS-Bucket Protokollierung aktiviert", "en": "OSS Bucket Logging Enabled", "es": "Registro de Logs de Bucket OSS Habilitado", "fr": "Journalisation de Bucket OSS Activée", "ja": "OSS バケットのログ記録が有効", "pt": "Registro de Logs de Bucket OSS Habilitado", "zh": "OSS 存储空间开启日志转存"}, Severity: "medium", Description: models.I18nString{"de": "OSS-Buckets sollten Protokollierung aktiviert haben, um Zugriffe und Vorgänge zu verfolgen. Die Protokollierung hilft bei Sicherheitsaudits, Fehlerbehebung und Compliance-Anforderungen.", "en": "OSS buckets should have logging enabled to track access and operations. Logging helps with security auditing, troubleshooting, and compliance requirements.", "es": "Los buckets OSS deben tener registro de logs habilitado para rastrear acceso y operaciones. El registro de logs ayuda en la auditoría de seguridad, solución de problemas y requisitos de conformidad.", "fr": "Les buckets OSS doivent avoir la journalisation activée pour suivre les accès et les opérations. La journalisation aide à l'audit de sécurité, au dépannage et aux exigences de conformité.", "ja": "OSS バケットは、アクセスと操作を追跡するためにログ記録を有効にする必要があります。ログ記録は、セキュリティ監査、トラブルシューティング、コンプライアンス要件に役立ちます。", "pt": "Buckets OSS devem ter registro de logs habilitado para rastrear acesso e operações. O registro de logs ajuda na auditoria de segurança, solução de problemas e requisitos de conformidade.", "zh": "OSS 存储空间应开启日志转存以跟踪访问和操作。日志记录有助于安全审计、故障排查和合规要求。"}, Reason: models.I18nString{"de": "Der OSS-Bucket hat keine Protokollierung aktiviert, was es schwierig macht, Zugriffe und Vorgänge für Sicherheits- und Compliance-Zwecke zu verfolgen.", "en": "The OSS bucket does not have logging enabled, which makes it difficult to track access and operations for security and compliance purposes.", "es": "El bucket OSS no tiene registro de logs habilitado, lo que dificulta rastrear acceso y operaciones para fines de seguridad y conformidad.", "fr": "Le bucket OSS n'a pas la journalisation activée, ce qui rend difficile le suivi des accès et des opérations à des fins de sécurité et de conformité.", "ja": "OSS バケットでログ記録が有効になっていないため、セキュリティとコンプライアンスの目的でアクセスと操作を追跡することが困難です。", "pt": "O bucket OSS não tem registro de logs habilitado, o que dificulta rastrear acesso e operações para fins de segurança e conformidade.", "zh": "OSS 存储空间未开启日志转存，难以跟踪访问和操作以满足安全和合规要求。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Protokollierung für den OSS-Bucket, indem Sie die LoggingConfiguration-Eigenschaft mit TargetBucket und optional TargetPrefix konfigurieren.", "en": "Enable logging for the OSS bucket by configuring the LoggingConfiguration property with TargetBucket and optionally TargetPrefix.", "es": "Habilite el registro de logs para el bucket OSS configurando la propiedad LoggingConfiguration con TargetBucket y opcionalmente TargetPrefix.", "fr": "Activez la journalisation pour le bucket OSS en configurant la propriété LoggingConfiguration avec TargetBucket et éventuellement TargetPrefix.", "ja": "TargetBucket とオプションで TargetPrefix を使用して LoggingConfiguration プロパティを設定することで、OSS バケットのログ記録を有効にします。", "pt": "Habilite registro de logs para o bucket OSS configurando a propriedade LoggingConfiguration com TargetBucket e opcionalmente TargetPrefix.", "zh": "通过配置 LoggingConfiguration 属性并设置 TargetBucket 和可选的 TargetPrefix，为 OSS 存储空间启用日志转存。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-logging-enabled.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_logging_enabled", Content: "package infraguard.rules.aliyun.oss_bucket_logging_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-bucket-logging-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Logging Enabled\",\n\t\t\"zh\": \"OSS 存储空间开启日志转存\",\n\t\t\"ja\": \"OSS バケットのログ記録が有効\",\n\t\t\"de\": \"OSS-Bucket Protokollierung aktiviert\",\n\t\t\"es\": \"Registro de Logs de Bucket OSS Habilitado\",\n\t\t\"fr\": \"Journalisation de Bucket OSS Activée\",\n\t\t\"pt\": \"Registro de Logs de Bucket OSS Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS buckets should have logging enabled to track access and operations. Logging helps with security auditing, troubleshooting, and compliance requirements.\",\n\t\t\"zh\": \"OSS 存储空间应开启日志转存以跟踪访问和操作。日志记录有助于安全审计、故障排查和合规要求。\",\n\t\t\"ja\": \"OSS バケットは、アクセスと操作を追跡するためにログ記録を有効にする必要があります。ログ記録は、セキュリティ監査、トラブルシューティング、コンプライアンス要件に役立ちます。\",\n\t\t\"de\": \"OSS-Buckets sollten Protokollierung aktiviert haben, um Zugriffe und Vorgänge zu verfolgen. Die Protokollierung hilft bei Sicherheitsaudits, Fehlerbehebung und Compliance-Anforderungen.\",\n\t\t\"es\": \"Los buckets OSS deben tener registro de logs habilitado para rastrear acceso y operaciones. El registro de logs ayuda en la auditoría de seguridad, solución de problemas y requisitos de conformidad.\",\n\t\t\"fr\": \"Les buckets OSS doivent avoir la journalisation activée pour suivre les accès et les opérations. La journalisation aide à l'audit de sécurité, au dépannage et aux exigences de conformité.\",\n\t\t\"pt\": \"Buckets OSS devem ter registro de logs habilitado para rastrear acesso e operações. O registro de logs ajuda na auditoria de segurança, solução de problemas e requisitos de conformidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The OSS bucket does not have logging enabled, which makes it difficult to track access and operations for security and compliance purposes.\",\n\t\t\"zh\": \"OSS 存储空间未开启日志转存，难以跟踪访问和操作以满足安全和合规要求。\",\n\t\t\"ja\": \"OSS バケットでログ記録が有効になっていないため、セキュリティとコンプライアンスの目的でアクセスと操作を追跡することが困難です。\",\n\t\t\"de\": \"Der OSS-Bucket hat keine Protokollierung aktiviert, was es schwierig macht, Zugriffe und Vorgänge für Sicherheits- und Compliance-Zwecke zu verfolgen.\",\n\t\t\"es\": \"El bucket OSS no tiene registro de logs habilitado, lo que dificulta rastrear acceso y operaciones para fines de seguridad y conformidad.\",\n\t\t\"fr\": \"Le bucket OSS n'a pas la journalisation activée, ce qui rend difficile le suivi des accès et des opérations à des fins de sécurité et de conformité.\",\n\t\t\"pt\": \"O bucket OSS não tem registro de logs habilitado, o que dificulta rastrear acesso e operações para fins de segurança e conformidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable logging for the OSS bucket by configuring the LoggingConfiguration property with TargetBucket and optionally TargetPrefix.\",\n\t\t\"zh\": \"通过配置 LoggingConfiguration 属性并设置 TargetBucket 和可选的 TargetPrefix，为 OSS 存储空间启用日志转存。\",\n\t\t\"ja\": \"TargetBucket とオプションで TargetPrefix を使用して LoggingConfiguration プロパティを設定することで、OSS バケットのログ記録を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Protokollierung für den OSS-Bucket, indem Sie die LoggingConfiguration-Eigenschaft mit TargetBucket und optional TargetPrefix konfigurieren.\",\n\t\t\"es\": \"Habilite el registro de logs para el bucket OSS configurando la propiedad LoggingConfiguration con TargetBucket y opcionalmente TargetPrefix.\",\n\t\t\"fr\": \"Activez la journalisation pour le bucket OSS en configurant la propriété LoggingConfiguration avec TargetBucket et éventuellement TargetPrefix.\",\n\t\t\"pt\": \"Habilite registro de logs para o bucket OSS configurando a propriedade LoggingConfiguration com TargetBucket e opcionalmente TargetPrefix.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tnot has_logging_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LoggingConfiguration\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nhas_logging_enabled(resource) if {\n\thelpers.has_property(resource, \"LoggingConfiguration\")\n\tlogging_config := resource.Properties.LoggingConfiguration\n\tlogging_config.TargetBucket != null\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-only-https-enabled", Name: models.I18nString{"de": "OSS-Bucket nur HTTPS aktiviert", "en": "OSS Bucket Only HTTPS Enabled", "es": "Solo HTTPS de Bucket OSS Habilitado", "fr": "Seul HTTPS de Bucket OSS Activé", "ja": "OSS バケットで HTTPS のみが有効", "pt": "Apenas HTTPS de Bucket OSS Habilitado", "zh": "OSS 存储桶开启仅允许 HTTPS 访问"}, Severity: "high", Description: models.I18nString{"de": "OSS-Bucket sollte eine Richtlinie haben, die Nicht-HTTPS-Anfragen ablehnt, um die Datentransportsicherheit zu gewährleisten.", "en": "OSS bucket should have a policy that denies non-HTTPS requests to ensure data transport security.", "es": "El bucket OSS debe tener una política que niegue las solicitudes que no sean HTTPS para garantizar la seguridad del transporte de datos.", "fr": "Le bucket OSS doit avoir une politique qui refuse les requêtes non-HTTPS pour assurer la sécurité du transport des données.", "ja": "OSS バケットは、データ転送のセキュリティを確保するために、非 HTTPS リクエストを拒否するポリシーを持つ必要があります。", "pt": "O bucket OSS deve ter uma política que negue solicitações não HTTPS para garantir a segurança do transporte de dados.", "zh": "OSS 存储桶应配置仅允许 HTTPS 访问的策略，以确保数据传输安全。"}, Reason: models.I18nString{"de": "Der OSS-Bucket erlaubt Nicht-HTTPS-Anfragen, was zu Datenabfangen oder Manipulation während des Transports führen kann.", "en": "The OSS bucket allows non-HTTPS requests, which may lead to data interception or tampering during transport.", "es": "El bucket OSS permite solicitudes que no sean HTTPS, lo que puede llevar a la interceptación o manipulación de datos durante el transporte.", "fr": "Le bucket OSS autorise les requêtes non-HTTPS, ce qui peut entraîner une interception ou une falsification des données pendant le transport.", "ja": "OSS バケットが非 HTTPS リクエストを許可しているため、転送中にデータが傍受または改ざんされる可能性があります。", "pt": "O bucket OSS permite solicitações não HTTPS, o que pode levar à interceptação ou adulteração de dados durante o transporte.", "zh": "OSS 存储桶允许非 HTTPS 请求，可能导致数据在传输过程中被窃听或篡改。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie eine Bucket-Richtlinie, die Anfragen ablehnt, bei denen 'acs:SecureTransport' false ist.", "en": "Configure a bucket policy that denies requests where 'acs:SecureTransport' is false.", "es": "Configure una política de bucket que niegue las solicitudes donde 'acs:SecureTransport' es false.", "fr": "Configurez une politique de bucket qui refuse les requêtes où 'acs:SecureTransport' est false.", "ja": "'acs:SecureTransport' が false のリクエストを拒否するバケットポリシーを設定します。", "pt": "Configure uma política de bucket que negue solicitações onde 'acs:SecureTransport' é false.", "zh": "配置存储桶策略，拒绝 'acs:SecureTransport' 为 false 的请求。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-only-https-enabled.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_only_https_enabled", Content: "package infraguard.rules.aliyun.oss_bucket_only_https_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-bucket-only-https-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Only HTTPS Enabled\",\n\t\t\"zh\": \"OSS 存储桶开启仅允许 HTTPS 访问\",\n\t\t\"ja\": \"OSS バケットで HTTPS のみが有効\",\n\t\t\"de\": \"OSS-Bucket nur HTTPS aktiviert\",\n\t\t\"es\": \"Solo HTTPS de Bucket OSS Habilitado\",\n\t\t\"fr\": \"Seul HTTPS de Bucket OSS Activé\",\n\t\t\"pt\": \"Apenas HTTPS de Bucket OSS Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS bucket should have a policy that denies non-HTTPS requests to ensure data transport security.\",\n\t\t\"zh\": \"OSS 存储桶应配置仅允许 HTTPS 访问的策略，以确保数据传输安全。\",\n\t\t\"ja\": \"OSS バケットは、データ転送のセキュリティを確保するために、非 HTTPS リクエストを拒否するポリシーを持つ必要があります。\",\n\t\t\"de\": \"OSS-Bucket sollte eine Richtlinie haben, die Nicht-HTTPS-Anfragen ablehnt, um die Datentransportsicherheit zu gewährleisten.\",\n\t\t\"es\": \"El bucket OSS debe tener una política que niegue las solicitudes que no sean HTTPS para garantizar la seguridad del transporte de datos.\",\n\t\t\"fr\": \"Le bucket OSS doit avoir une politique qui refuse les requêtes non-HTTPS pour assurer la sécurité du transport des données.\",\n\t\t\"pt\": \"O bucket OSS deve ter uma política que negue solicitações não HTTPS para garantir a segurança do transporte de dados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The OSS bucket allows non-HTTPS requests, which may lead to data interception or tampering during transport.\",\n\t\t\"zh\": \"OSS 存储桶允许非 HTTPS 请求，可能导致数据在传输过程中被窃听或篡改。\",\n\t\t\"ja\": \"OSS バケットが非 HTTPS リクエストを許可しているため、転送中にデータが傍受または改ざんされる可能性があります。\",\n\t\t\"de\": \"Der OSS-Bucket erlaubt Nicht-HTTPS-Anfragen, was zu Datenabfangen oder Manipulation während des Transports führen kann.\",\n\t\t\"es\": \"El bucket OSS permite solicitudes que no sean HTTPS, lo que puede llevar a la interceptación o manipulación de datos durante el transporte.\",\n\t\t\"fr\": \"Le bucket OSS autorise les requêtes non-HTTPS, ce qui peut entraîner une interception ou une falsification des données pendant le transport.\",\n\t\t\"pt\": \"O bucket OSS permite solicitações não HTTPS, o que pode levar à interceptação ou adulteração de dados durante o transporte.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a bucket policy that denies requests where 'acs:SecureTransport' is false.\",\n\t\t\"zh\": \"配置存储桶策略，拒绝 'acs:SecureTransport' 为 false 的请求。\",\n\t\t\"ja\": \"'acs:SecureTransport' が false のリクエストを拒否するバケットポリシーを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie eine Bucket-Richtlinie, die Anfragen ablehnt, bei denen 'acs:SecureTransport' false ist.\",\n\t\t\"es\": \"Configure una política de bucket que niegue las solicitudes donde 'acs:SecureTransport' es false.\",\n\t\t\"fr\": \"Configurez une politique de bucket qui refuse les requêtes où 'acs:SecureTransport' est false.\",\n\t\t\"pt\": \"Configure uma política de bucket que negue solicitações onde 'acs:SecureTransport' é false.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\n# Check if the bucket has a policy that enforces HTTPS\nis_only_https_enabled(resource) if {\n\tpolicy := helpers.get_property(resource, \"Policy\", {})\n\tstatements := object.get(policy, \"Statement\", [])\n\tsome statement in statements\n\tstatement.Effect == \"Deny\"\n\n\t# Check for SecureTransport condition\n\tcondition := object.get(statement, \"Condition\", {})\n\tbool_cond := object.get(condition, \"Bool\", {})\n\tsecure_transport := object.get(bool_cond, \"acs:SecureTransport\", null)\n\thas_false_value(secure_transport)\n}\n\nhas_false_value(val) if {\n\tval == \"false\"\n}\n\nhas_false_value(val) if {\n\tval == false\n}\n\nhas_false_value(val) if {\n\tis_array(val)\n\tsome item in val\n\titem_is_false(item)\n}\n\nitem_is_false(v) if {\n\tv == \"false\"\n}\n\nitem_is_false(v) if {\n\tv == false\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_only_https_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Policy\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-policy-no-any-anonymous", Name: models.I18nString{"de": "OSS-Bucket-Richtlinie gewährt anonymen Benutzern keine Berechtigungen", "en": "OSS bucket policy does not grant permissions to anonymous users", "es": "La política de bucket OSS no otorga permisos a usuarios anónimos", "fr": "La politique de bucket OSS n'accorde pas de permissions aux utilisateurs anonymes", "ja": "OSS バケットポリシーが匿名ユーザーに権限を付与していない", "pt": "A política de bucket OSS não concede permissões a usuários anônimos", "zh": "OSS 存储空间不能为匿名账号授予任何权限"}, Severity: "high", Description: models.I18nString{"de": "OSS-Bucket-Richtlinie gewährt anonymen Benutzern keine Lese- oder Schreibberechtigungen.", "en": "OSS bucket policy does not grant any read or write permissions to anonymous users.", "es": "La política de bucket OSS no otorga permisos de lectura o escritura a usuarios anónimos.", "fr": "La politique de bucket OSS n'accorde pas de permissions de lecture ou d'écriture aux utilisateurs anonymes.", "ja": "OSS バケットポリシーは匿名ユーザーに読み取りまたは書き込み権限を付与していません。", "pt": "A política de bucket OSS não concede permissões de leitura ou gravação a usuários anônimos.", "zh": "OSS Bucket 授权策略中未授予匿名账号任何读写权限。"}, Reason: models.I18nString{"de": "OSS-Bucket-Richtlinie gewährt anonymen Benutzern Berechtigungen, was sensible Daten preisgeben kann.", "en": "OSS bucket policy grants permissions to anonymous users, which may expose sensitive data.", "es": "La política de bucket OSS otorga permisos a usuarios anónimos, lo que puede exponer datos sensibles.", "fr": "La politique de bucket OSS accorde des permissions aux utilisateurs anonymes, ce qui peut exposer des données sensibles.", "ja": "OSS バケットポリシーが匿名ユーザーに権限を付与しているため、機密データが公開される可能性があります。", "pt": "A política de bucket OSS concede permissões a usuários anônimos, o que pode expor dados sensíveis.", "zh": "OSS Bucket 授权策略授予匿名账号权限,可能导致敏感数据泄露。"}, Recommendation: models.I18nString{"de": "Entfernen Sie anonyme Benutzerberechtigungen aus der OSS-Bucket-Richtlinie. Stellen Sie sicher, dass Principal kein '*' für anonymen Zugriff enthält.", "en": "Remove anonymous user permissions from OSS bucket policy. Ensure Principal does not contain '*' for anonymous access.", "es": "Elimine los permisos de usuario anónimo de la política de bucket OSS. Asegúrese de que Principal no contenga '*' para acceso anónimo.", "fr": "Supprimez les permissions des utilisateurs anonymes de la politique de bucket OSS. Assurez-vous que Principal ne contient pas '*' pour l'accès anonyme.", "ja": "OSS バケットポリシーから匿名ユーザーの権限を削除します。匿名アクセスを避けるために、Principal に '*' が含まれていないことを確認します。", "pt": "Remova permissões de usuários anônimos da política de bucket OSS. Certifique-se de que Principal não contenha '*' para acesso anônimo.", "zh": "从 OSS Bucket 授权策略中移除匿名用户权限。确保 Principal 不包含'*'以避免匿名访问。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-policy-no-any-anonymous.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_policy_no_any_anonymous", Content: "package infraguard.rules.aliyun.oss_bucket_policy_no_any_anonymous\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-bucket-policy-no-any-anonymous\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"OSS bucket policy does not grant permissions to anonymous users\",\n\t\t\"zh\": \"OSS 存储空间不能为匿名账号授予任何权限\",\n\t\t\"ja\": \"OSS バケットポリシーが匿名ユーザーに権限を付与していない\",\n\t\t\"de\": \"OSS-Bucket-Richtlinie gewährt anonymen Benutzern keine Berechtigungen\",\n\t\t\"es\": \"La política de bucket OSS no otorga permisos a usuarios anónimos\",\n\t\t\"fr\": \"La politique de bucket OSS n'accorde pas de permissions aux utilisateurs anonymes\",\n\t\t\"pt\": \"A política de bucket OSS não concede permissões a usuários anônimos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS bucket policy does not grant any read or write permissions to anonymous users.\",\n\t\t\"zh\": \"OSS Bucket 授权策略中未授予匿名账号任何读写权限。\",\n\t\t\"ja\": \"OSS バケットポリシーは匿名ユーザーに読み取りまたは書き込み権限を付与していません。\",\n\t\t\"de\": \"OSS-Bucket-Richtlinie gewährt anonymen Benutzern keine Lese- oder Schreibberechtigungen.\",\n\t\t\"es\": \"La política de bucket OSS no otorga permisos de lectura o escritura a usuarios anónimos.\",\n\t\t\"fr\": \"La politique de bucket OSS n'accorde pas de permissions de lecture ou d'écriture aux utilisateurs anonymes.\",\n\t\t\"pt\": \"A política de bucket OSS não concede permissões de leitura ou gravação a usuários anônimos.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"OSS bucket policy grants permissions to anonymous users, which may expose sensitive data.\",\n\t\t\"zh\": \"OSS Bucket 授权策略授予匿名账号权限,可能导致敏感数据泄露。\",\n\t\t\"ja\": \"OSS バケットポリシーが匿名ユーザーに権限を付与しているため、機密データが公開される可能性があります。\",\n\t\t\"de\": \"OSS-Bucket-Richtlinie gewährt anonymen Benutzern Berechtigungen, was sensible Daten preisgeben kann.\",\n\t\t\"es\": \"La política de bucket OSS otorga permisos a usuarios anónimos, lo que puede exponer datos sensibles.\",\n\t\t\"fr\": \"La politique de bucket OSS accorde des permissions aux utilisateurs anonymes, ce qui peut exposer des données sensibles.\",\n\t\t\"pt\": \"A política de bucket OSS concede permissões a usuários anônimos, o que pode expor dados sensíveis.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove anonymous user permissions from OSS bucket policy. Ensure Principal does not contain '*' for anonymous access.\",\n\t\t\"zh\": \"从 OSS Bucket 授权策略中移除匿名用户权限。确保 Principal 不包含'*'以避免匿名访问。\",\n\t\t\"ja\": \"OSS バケットポリシーから匿名ユーザーの権限を削除します。匿名アクセスを避けるために、Principal に '*' が含まれていないことを確認します。\",\n\t\t\"de\": \"Entfernen Sie anonyme Benutzerberechtigungen aus der OSS-Bucket-Richtlinie. Stellen Sie sicher, dass Principal kein '*' für anonymen Zugriff enthält.\",\n\t\t\"es\": \"Elimine los permisos de usuario anónimo de la política de bucket OSS. Asegúrese de que Principal no contenga '*' para acceso anónimo.\",\n\t\t\"fr\": \"Supprimez les permissions des utilisateurs anonymes de la politique de bucket OSS. Assurez-vous que Principal ne contient pas '*' pour l'accès anonyme.\",\n\t\t\"pt\": \"Remova permissões de usuários anônimos da política de bucket OSS. Certifique-se de que Principal não contenha '*' para acesso anônimo.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\n\t# Check if bucket has a policy\n\tpolicy := helpers.get_property(resource, \"Policy\", {})\n\n\t# If no policy is set, it's compliant (no anonymous access granted)\n\tcount(policy) > 0\n\n\t# Check if policy contains statements\n\tstatement := policy.Statement[_]\n\n\t# Check if statement grants access to anonymous users (Principal: \"*\")\n\tprincipal := object.get(statement, \"Principal\", \"\")\n\tprincipal == \"*\"\n\tstatement.Effect == \"Allow\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Policy\", \"Statement\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-policy-outside-organization-check", Name: models.I18nString{"de": "OSS-Bucket-Richtlinie kein Zugriff außerhalb der Organisation", "en": "OSS Bucket Policy No Outside Organization Access", "es": "Política de Bucket OSS Sin Acceso Fuera de la Organización", "fr": "Politique de Bucket OSS Sans Accès Hors Organisation", "ja": "OSS バケットポリシーが組織外アクセスを許可していない", "pt": "Política de Bucket OSS Sem Acesso Fora da Organização", "zh": "OSS 存储桶策略未给组织外授权"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass OSS-Bucket-Richtlinien keinen Zugriff auf Prinzipalen außerhalb der Organisation gewähren.", "en": "Ensures OSS bucket policies do not grant access to principals outside of the organization.", "es": "Garantiza que las políticas de bucket OSS no otorguen acceso a principales fuera de la organización.", "fr": "Garantit que les politiques de bucket OSS n'accordent pas d'accès aux principaux en dehors de l'organisation.", "ja": "OSS バケットポリシーが組織外のプリンシパルにアクセスを付与していないことを確認します。", "pt": "Garante que as políticas de bucket OSS não concedam acesso a principais fora da organização.", "zh": "确保 OSS 存储桶策略未授予组织外部的主体访问权限。"}, Reason: models.I18nString{"de": "Die Gewährung von Zugriff auf externe Prinzipalen kann zu Datenlecks außerhalb der Kontrolle der Organisation führen.", "en": "Granting access to external principals can lead to data leaks outside the organization's control.", "es": "Otorgar acceso a principales externos puede llevar a fugas de datos fuera del control de la organización.", "fr": "Accorder l'accès à des principaux externes peut entraîner des fuites de données en dehors du contrôle de l'organisation.", "ja": "外部プリンシパルにアクセスを付与すると、組織の制御外でデータ漏洩が発生する可能性があります。", "pt": "Conceder acesso a principais externos pode levar a vazamentos de dados fora do controle da organização.", "zh": "授予外部主体访问权限可能导致数据在组织控制之外泄露。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass alle Prinzipalen in der Bucket-Richtlinie innerhalb der autorisierten Organisation sind.", "en": "Ensure all principals in the bucket policy are within the authorized organization.", "es": "Asegúrese de que todos los principales en la política de bucket estén dentro de la organización autorizada.", "fr": "Assurez-vous que tous les principaux dans la politique de bucket sont au sein de l'organisation autorisée.", "ja": "バケットポリシー内のすべてのプリンシパルが承認された組織内にあることを確認します。", "pt": "Certifique-se de que todos os principais na política de bucket estejam dentro da organização autorizada.", "zh": "确保存储桶策略中的所有主体均属于获得授权的组织。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-policy-outside-organization-check.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_policy_outside_organization_check", Content: "package infraguard.rules.aliyun.oss_bucket_policy_outside_organization_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"oss-bucket-policy-outside-organization-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Policy No Outside Organization Access\",\n\t\t\"zh\": \"OSS 存储桶策略未给组织外授权\",\n\t\t\"ja\": \"OSS バケットポリシーが組織外アクセスを許可していない\",\n\t\t\"de\": \"OSS-Bucket-Richtlinie kein Zugriff außerhalb der Organisation\",\n\t\t\"es\": \"Política de Bucket OSS Sin Acceso Fuera de la Organización\",\n\t\t\"fr\": \"Politique de Bucket OSS Sans Accès Hors Organisation\",\n\t\t\"pt\": \"Política de Bucket OSS Sem Acesso Fora da Organização\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures OSS bucket policies do not grant access to principals outside of the organization.\",\n\t\t\"zh\": \"确保 OSS 存储桶策略未授予组织外部的主体访问权限。\",\n\t\t\"ja\": \"OSS バケットポリシーが組織外のプリンシパルにアクセスを付与していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass OSS-Bucket-Richtlinien keinen Zugriff auf Prinzipalen außerhalb der Organisation gewähren.\",\n\t\t\"es\": \"Garantiza que las políticas de bucket OSS no otorguen acceso a principales fuera de la organización.\",\n\t\t\"fr\": \"Garantit que les politiques de bucket OSS n'accordent pas d'accès aux principaux en dehors de l'organisation.\",\n\t\t\"pt\": \"Garante que as políticas de bucket OSS não concedam acesso a principais fora da organização.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Granting access to external principals can lead to data leaks outside the organization's control.\",\n\t\t\"zh\": \"授予外部主体访问权限可能导致数据在组织控制之外泄露。\",\n\t\t\"ja\": \"外部プリンシパルにアクセスを付与すると、組織の制御外でデータ漏洩が発生する可能性があります。\",\n\t\t\"de\": \"Die Gewährung von Zugriff auf externe Prinzipalen kann zu Datenlecks außerhalb der Kontrolle der Organisation führen.\",\n\t\t\"es\": \"Otorgar acceso a principales externos puede llevar a fugas de datos fuera del control de la organización.\",\n\t\t\"fr\": \"Accorder l'accès à des principaux externes peut entraîner des fuites de données en dehors du contrôle de l'organisation.\",\n\t\t\"pt\": \"Conceder acesso a principais externos pode levar a vazamentos de dados fora do controle da organização.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure all principals in the bucket policy are within the authorized organization.\",\n\t\t\"zh\": \"确保存储桶策略中的所有主体均属于获得授权的组织。\",\n\t\t\"ja\": \"バケットポリシー内のすべてのプリンシパルが承認された組織内にあることを確認します。\",\n\t\t\"de\": \"Stellen Sie sicher, dass alle Prinzipalen in der Bucket-Richtlinie innerhalb der autorisierten Organisation sind.\",\n\t\t\"es\": \"Asegúrese de que todos los principales en la política de bucket estén dentro de la organización autorizada.\",\n\t\t\"fr\": \"Assurez-vous que tous les principaux dans la politique de bucket sont au sein de l'organisation autorisée.\",\n\t\t\"pt\": \"Certifique-se de que todos os principais na política de bucket estejam dentro da organização autorizada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\n# Simplified implementation for IaC: Check if any Principal is '*' without a restrictive Condition\n# or if Principal is an external account ID (not easily detectable in pure IaC without context).\n# Here we check for '*' in Allow statements.\nis_compliant(resource) if {\n\tpolicy := helpers.get_property(resource, \"Policy\", {})\n\tstatements := object.get(policy, \"Statement\", [])\n\tnot has_external_allow(statements)\n}\n\nhas_external_allow(statements) if {\n\tsome statement in statements\n\tstatement.Effect == \"Allow\"\n\tprincipal := object.get(statement, \"Principal\", [])\n\tis_public_principal(principal)\n}\n\nis_public_principal(\"*\") := true\n\nis_public_principal(p) if {\n\tis_array(p)\n\tsome item in p\n\titem == \"*\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Policy\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-public-read-prohibited", Name: models.I18nString{"de": "OSS-Bucket öffentliches Lesen verboten", "en": "OSS Bucket Public Read Prohibited", "es": "Lectura Pública de Bucket OSS Prohibida", "fr": "Lecture Publique de Bucket OSS Interdite", "ja": "OSS バケットのパブリック読み取りが禁止", "pt": "Leitura Pública de Bucket OSS Proibida", "zh": "OSS 存储空间 ACL 不开启公共读"}, Severity: "high", Description: models.I18nString{"de": "OSS-Buckets sollten keinen öffentlichen Lesezugriff zulassen, es sei denn, dies ist ausdrücklich erforderlich. Öffentlicher Lesezugriff ermöglicht es jedem, auf Objekte im Bucket zuzugreifen und sie herunterzuladen.", "en": "OSS buckets should not allow public read access unless specifically required. Public read access allows anyone to access and download objects in the bucket.", "es": "Los buckets OSS no deben permitir acceso de lectura público a menos que sea específicamente necesario. El acceso de lectura público permite a cualquiera acceder y descargar objetos en el bucket.", "fr": "Les buckets OSS ne doivent pas autoriser l'accès en lecture public sauf si cela est spécifiquement requis. L'accès en lecture public permet à quiconque d'accéder et de télécharger des objets dans le bucket.", "ja": "特に必要な場合を除き、OSS バケットはパブリック読み取りアクセスを許可すべきではありません。パブリック読み取りアクセスにより、誰でもバケット内のオブジェクトにアクセスしてダウンロードできます。", "pt": "Buckets OSS não devem permitir acesso de leitura público, a menos que especificamente necessário. O acesso de leitura público permite que qualquer pessoa acesse e baixe objetos no bucket.", "zh": "除非特别需要，OSS 存储空间不应允许公共读取访问。公共读取访问允许任何人访问和下载存储空间中的对象。"}, Reason: models.I18nString{"de": "Der OSS-Bucket hat öffentlichen Lesezugriff aktiviert, was sensible Daten unbefugtem Zugriff aussetzen kann.", "en": "The OSS bucket has public read access enabled, which may expose sensitive data to unauthorized access.", "es": "El bucket OSS tiene habilitado el acceso de lectura público, lo que puede exponer datos sensibles a acceso no autorizado.", "fr": "Le bucket OSS a l'accès en lecture public activé, ce qui peut exposer des données sensibles à un accès non autorisé.", "ja": "OSS バケットでパブリック読み取りアクセスが有効になっているため、機密データが不正アクセスにさらされる可能性があります。", "pt": "O bucket OSS tem acesso de leitura público habilitado, o que pode expor dados sensíveis a acesso não autorizado.", "zh": "OSS 存储空间启用了公共读取访问，可能导致敏感数据暴露给未授权访问。"}, Recommendation: models.I18nString{"de": "Ändern Sie die Bucket-ACL auf privat, indem Sie die AccessControl-Eigenschaft auf 'private' setzen.", "en": "Change the bucket ACL to private by setting the AccessControl property to 'private'.", "es": "Cambie el ACL del bucket a privado estableciendo la propiedad AccessControl en 'private'.", "fr": "Modifiez l'ACL du bucket en privé en définissant la propriété AccessControl sur 'private'.", "ja": "AccessControl プロパティを 'private' に設定して、バケット ACL をプライベートに変更します。", "pt": "Altere o ACL do bucket para privado definindo a propriedade AccessControl como 'private'.", "zh": "通过将 AccessControl 属性设置为'private'，将存储空间 ACL 更改为私有。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-public-read-prohibited.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_public_read_prohibited", Content: "package infraguard.rules.aliyun.oss_bucket_public_read_prohibited\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-bucket-public-read-prohibited\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Public Read Prohibited\",\n\t\t\"zh\": \"OSS 存储空间 ACL 不开启公共读\",\n\t\t\"ja\": \"OSS バケットのパブリック読み取りが禁止\",\n\t\t\"de\": \"OSS-Bucket öffentliches Lesen verboten\",\n\t\t\"es\": \"Lectura Pública de Bucket OSS Prohibida\",\n\t\t\"fr\": \"Lecture Publique de Bucket OSS Interdite\",\n\t\t\"pt\": \"Leitura Pública de Bucket OSS Proibida\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS buckets should not allow public read access unless specifically required. Public read access allows anyone to access and download objects in the bucket.\",\n\t\t\"zh\": \"除非特别需要，OSS 存储空间不应允许公共读取访问。公共读取访问允许任何人访问和下载存储空间中的对象。\",\n\t\t\"ja\": \"特に必要な場合を除き、OSS バケットはパブリック読み取りアクセスを許可すべきではありません。パブリック読み取りアクセスにより、誰でもバケット内のオブジェクトにアクセスしてダウンロードできます。\",\n\t\t\"de\": \"OSS-Buckets sollten keinen öffentlichen Lesezugriff zulassen, es sei denn, dies ist ausdrücklich erforderlich. Öffentlicher Lesezugriff ermöglicht es jedem, auf Objekte im Bucket zuzugreifen und sie herunterzuladen.\",\n\t\t\"es\": \"Los buckets OSS no deben permitir acceso de lectura público a menos que sea específicamente necesario. El acceso de lectura público permite a cualquiera acceder y descargar objetos en el bucket.\",\n\t\t\"fr\": \"Les buckets OSS ne doivent pas autoriser l'accès en lecture public sauf si cela est spécifiquement requis. L'accès en lecture public permet à quiconque d'accéder et de télécharger des objets dans le bucket.\",\n\t\t\"pt\": \"Buckets OSS não devem permitir acesso de leitura público, a menos que especificamente necessário. O acesso de leitura público permite que qualquer pessoa acesse e baixe objetos no bucket.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The OSS bucket has public read access enabled, which may expose sensitive data to unauthorized access.\",\n\t\t\"zh\": \"OSS 存储空间启用了公共读取访问，可能导致敏感数据暴露给未授权访问。\",\n\t\t\"ja\": \"OSS バケットでパブリック読み取りアクセスが有効になっているため、機密データが不正アクセスにさらされる可能性があります。\",\n\t\t\"de\": \"Der OSS-Bucket hat öffentlichen Lesezugriff aktiviert, was sensible Daten unbefugtem Zugriff aussetzen kann.\",\n\t\t\"es\": \"El bucket OSS tiene habilitado el acceso de lectura público, lo que puede exponer datos sensibles a acceso no autorizado.\",\n\t\t\"fr\": \"Le bucket OSS a l'accès en lecture public activé, ce qui peut exposer des données sensibles à un accès non autorisé.\",\n\t\t\"pt\": \"O bucket OSS tem acesso de leitura público habilitado, o que pode expor dados sensíveis a acesso não autorizado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Change the bucket ACL to private by setting the AccessControl property to 'private'.\",\n\t\t\"zh\": \"通过将 AccessControl 属性设置为'private'，将存储空间 ACL 更改为私有。\",\n\t\t\"ja\": \"AccessControl プロパティを 'private' に設定して、バケット ACL をプライベートに変更します。\",\n\t\t\"de\": \"Ändern Sie die Bucket-ACL auf privat, indem Sie die AccessControl-Eigenschaft auf 'private' setzen.\",\n\t\t\"es\": \"Cambie el ACL del bucket a privado estableciendo la propiedad AccessControl en 'private'.\",\n\t\t\"fr\": \"Modifiez l'ACL du bucket en privé en définissant la propriété AccessControl sur 'private'.\",\n\t\t\"pt\": \"Altere o ACL do bucket para privado definindo a propriedade AccessControl como 'private'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tis_public_read(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AccessControl\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nis_public_read(resource) if {\n\tresource.Properties.AccessControl in [\"public-read\", \"public-read-write\"]\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-public-write-prohibited", Name: models.I18nString{"de": "OSS-Bucket öffentliches Schreiben verboten", "en": "OSS Bucket Public Write Prohibited", "es": "Escritura Pública de Bucket OSS Prohibida", "fr": "Écriture Publique de Bucket OSS Interdite", "ja": "OSS バケットのパブリック書き込みが禁止", "pt": "Escrita Pública de Bucket OSS Proibida", "zh": "OSS 存储空间 ACL 不开启公共读写"}, Severity: "high", Description: models.I18nString{"de": "OSS-Buckets sollten keinen öffentlichen Schreibzugriff zulassen. Öffentlicher Schreibzugriff ermöglicht es jedem, Objekte im Bucket hochzuladen, zu ändern oder zu löschen, was erhebliche Sicherheitsrisiken birgt.", "en": "OSS buckets should not allow public write access. Public write access allows anyone to upload, modify, or delete objects in the bucket, which poses significant security risks.", "es": "Los buckets OSS no deben permitir acceso de escritura público. El acceso de escritura público permite a cualquiera cargar, modificar o eliminar objetos en el bucket, lo que plantea riesgos de seguridad significativos.", "fr": "Les buckets OSS ne doivent pas autoriser l'accès en écriture public. L'accès en écriture public permet à quiconque de télécharger, modifier ou supprimer des objets dans le bucket, ce qui pose des risques de sécurité importants.", "ja": "OSS バケットはパブリック書き込みアクセスを許可すべきではありません。パブリック書き込みアクセスにより、誰でもバケット内のオブジェクトをアップロード、変更、または削除でき、重大なセキュリティリスクをもたらします。", "pt": "Buckets OSS não devem permitir acesso de escrita público. O acesso de escrita público permite que qualquer pessoa faça upload, modifique ou exclua objetos no bucket, o que representa riscos significativos de segurança.", "zh": "OSS 存储空间不应允许公共写入访问。公共写入访问允许任何人上传、修改或删除存储空间中的对象，这会带来重大安全风险。"}, Reason: models.I18nString{"de": "Der OSS-Bucket hat öffentlichen Schreibzugriff aktiviert (public-read-write ACL), was unbefugten Benutzern ermöglicht, Daten zu ändern oder zu löschen.", "en": "The OSS bucket has public write access enabled (public-read-write ACL), which allows unauthorized users to modify or delete data.", "es": "El bucket OSS tiene habilitado el acceso de escritura público (ACL public-read-write), lo que permite a usuarios no autorizados modificar o eliminar datos.", "fr": "Le bucket OSS a l'accès en écriture public activé (ACL public-read-write), ce qui permet aux utilisateurs non autorisés de modifier ou supprimer des données.", "ja": "OSS バケットでパブリック書き込みアクセスが有効になっている（public-read-write ACL）ため、不正なユーザーがデータを変更または削除できます。", "pt": "O bucket OSS tem acesso de escrita público habilitado (ACL public-read-write), o que permite que usuários não autorizados modifiquem ou excluam dados.", "zh": "OSS 存储空间启用了公共写入访问（public-read-write ACL），允许未授权用户修改或删除数据。"}, Recommendation: models.I18nString{"de": "Ändern Sie die Bucket-ACL auf privat oder öffentlich-lesen, indem Sie die AccessControl-Eigenschaft auf 'private' oder 'public-read' setzen.", "en": "Change the bucket ACL to private or public-read by setting the AccessControl property to 'private' or 'public-read'.", "es": "Cambie el ACL del bucket a privado o lectura pública estableciendo la propiedad AccessControl en 'private' o 'public-read'.", "fr": "Modifiez l'ACL du bucket en privé ou lecture publique en définissant la propriété AccessControl sur 'private' ou 'public-read'.", "ja": "AccessControl プロパティを 'private' または 'public-read' に設定して、バケット ACL をプライベートまたはパブリック読み取りに変更します。", "pt": "Altere o ACL do bucket para privado ou leitura pública definindo a propriedade AccessControl como 'private' ou 'public-read'.", "zh": "通过将 AccessControl 属性设置为'private'或'public-read'，将存储空间 ACL 更改为私有或公共读。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-public-write-prohibited.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_public_write_prohibited", Content: "package infraguard.rules.aliyun.oss_bucket_public_write_prohibited\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-bucket-public-write-prohibited\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Public Write Prohibited\",\n\t\t\"zh\": \"OSS 存储空间 ACL 不开启公共读写\",\n\t\t\"ja\": \"OSS バケットのパブリック書き込みが禁止\",\n\t\t\"de\": \"OSS-Bucket öffentliches Schreiben verboten\",\n\t\t\"es\": \"Escritura Pública de Bucket OSS Prohibida\",\n\t\t\"fr\": \"Écriture Publique de Bucket OSS Interdite\",\n\t\t\"pt\": \"Escrita Pública de Bucket OSS Proibida\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS buckets should not allow public write access. Public write access allows anyone to upload, modify, or delete objects in the bucket, which poses significant security risks.\",\n\t\t\"zh\": \"OSS 存储空间不应允许公共写入访问。公共写入访问允许任何人上传、修改或删除存储空间中的对象，这会带来重大安全风险。\",\n\t\t\"ja\": \"OSS バケットはパブリック書き込みアクセスを許可すべきではありません。パブリック書き込みアクセスにより、誰でもバケット内のオブジェクトをアップロード、変更、または削除でき、重大なセキュリティリスクをもたらします。\",\n\t\t\"de\": \"OSS-Buckets sollten keinen öffentlichen Schreibzugriff zulassen. Öffentlicher Schreibzugriff ermöglicht es jedem, Objekte im Bucket hochzuladen, zu ändern oder zu löschen, was erhebliche Sicherheitsrisiken birgt.\",\n\t\t\"es\": \"Los buckets OSS no deben permitir acceso de escritura público. El acceso de escritura público permite a cualquiera cargar, modificar o eliminar objetos en el bucket, lo que plantea riesgos de seguridad significativos.\",\n\t\t\"fr\": \"Les buckets OSS ne doivent pas autoriser l'accès en écriture public. L'accès en écriture public permet à quiconque de télécharger, modifier ou supprimer des objets dans le bucket, ce qui pose des risques de sécurité importants.\",\n\t\t\"pt\": \"Buckets OSS não devem permitir acesso de escrita público. O acesso de escrita público permite que qualquer pessoa faça upload, modifique ou exclua objetos no bucket, o que representa riscos significativos de segurança.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The OSS bucket has public write access enabled (public-read-write ACL), which allows unauthorized users to modify or delete data.\",\n\t\t\"zh\": \"OSS 存储空间启用了公共写入访问（public-read-write ACL），允许未授权用户修改或删除数据。\",\n\t\t\"ja\": \"OSS バケットでパブリック書き込みアクセスが有効になっている（public-read-write ACL）ため、不正なユーザーがデータを変更または削除できます。\",\n\t\t\"de\": \"Der OSS-Bucket hat öffentlichen Schreibzugriff aktiviert (public-read-write ACL), was unbefugten Benutzern ermöglicht, Daten zu ändern oder zu löschen.\",\n\t\t\"es\": \"El bucket OSS tiene habilitado el acceso de escritura público (ACL public-read-write), lo que permite a usuarios no autorizados modificar o eliminar datos.\",\n\t\t\"fr\": \"Le bucket OSS a l'accès en écriture public activé (ACL public-read-write), ce qui permet aux utilisateurs non autorisés de modifier ou supprimer des données.\",\n\t\t\"pt\": \"O bucket OSS tem acesso de escrita público habilitado (ACL public-read-write), o que permite que usuários não autorizados modifiquem ou excluam dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Change the bucket ACL to private or public-read by setting the AccessControl property to 'private' or 'public-read'.\",\n\t\t\"zh\": \"通过将 AccessControl 属性设置为'private'或'public-read'，将存储空间 ACL 更改为私有或公共读。\",\n\t\t\"ja\": \"AccessControl プロパティを 'private' または 'public-read' に設定して、バケット ACL をプライベートまたはパブリック読み取りに変更します。\",\n\t\t\"de\": \"Ändern Sie die Bucket-ACL auf privat oder öffentlich-lesen, indem Sie die AccessControl-Eigenschaft auf 'private' oder 'public-read' setzen.\",\n\t\t\"es\": \"Cambie el ACL del bucket a privado o lectura pública estableciendo la propiedad AccessControl en 'private' o 'public-read'.\",\n\t\t\"fr\": \"Modifiez l'ACL du bucket en privé ou lecture publique en définissant la propriété AccessControl sur 'private' ou 'public-read'.\",\n\t\t\"pt\": \"Altere o ACL do bucket para privado ou leitura pública definindo a propriedade AccessControl como 'private' ou 'public-read'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tis_public_write(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AccessControl\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nis_public_write(resource) if {\n\tresource.Properties.AccessControl == \"public-read-write\"\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-referer-limit", Name: models.I18nString{"de": "OSS-Bucket Referer-Hotlink-Schutz konfiguriert", "en": "OSS bucket referer hotlink protection configured", "es": "Protección de enlace directo de referer de bucket OSS configurada", "fr": "Protection contre les liens directs de referer de bucket OSS configurée", "ja": "OSS バケットの Referer ホットリンク保護が設定されている", "pt": "Proteção contra link direto de referer de bucket OSS configurada", "zh": "OSS 存储空间 Referer 在指定的防盗链白名单中"}, Severity: "low", Description: models.I18nString{"de": "OSS-Bucket hat Referer-Hotlink-Schutz mit konfigurierter Whitelist aktiviert.", "en": "OSS bucket has referer hotlink protection enabled with a configured whitelist.", "es": "El bucket OSS tiene protección contra enlaces directos de referer habilitada con una lista blanca configurada.", "fr": "Le bucket OSS a la protection contre les liens directs de referer activée avec une liste blanche configurée.", "ja": "OSS バケットで Referer ホットリンク保護が有効になり、ホワイトリストが設定されています。", "pt": "O bucket OSS tem proteção contra link direto de referer habilitada com uma lista branca configurada.", "zh": "OSS 存储空间开启防盗链并且 Referer 在指定白名单中。"}, Reason: models.I18nString{"de": "OSS-Bucket hat keinen Referer-Hotlink-Schutz konfiguriert, was zu unbefugtem Zugriff und Bandbreitendiebstahl führen kann.", "en": "OSS bucket does not have referer hotlink protection configured, which may lead to unauthorized access and bandwidth theft.", "es": "El bucket OSS no tiene protección contra enlaces directos de referer configurada, lo que puede llevar a acceso no autorizado y robo de ancho de banda.", "fr": "Le bucket OSS n'a pas de protection contre les liens directs de referer configurée, ce qui peut entraîner un accès non autorisé et un vol de bande passante.", "ja": "OSS バケットに Referer ホットリンク保護が設定されていないため、不正アクセスや帯域幅の盗用につながる可能性があります。", "pt": "O bucket OSS não tem proteção contra link direto de referer configurada, o que pode levar a acesso não autorizado e roubo de largura de banda.", "zh": "OSS 存储空间未配置 Referer 防盗链,可能导致未授权访问和流量盗用。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie eine Referer-Whitelist für den OSS-Bucket, indem Sie RefererConfiguration mit einer nicht leeren RefererList setzen.", "en": "Configure referer whitelist for OSS bucket by setting RefererConfiguration with a non-empty RefererList.", "es": "Configure la lista blanca de referer para el bucket OSS estableciendo RefererConfiguration con una RefererList no vacía.", "fr": "Configurez la liste blanche de referer pour le bucket OSS en définissant RefererConfiguration avec une RefererList non vide.", "ja": "空でない RefererList を使用して RefererConfiguration を設定することで、OSS バケットの Referer ホワイトリストを設定します。", "pt": "Configure a lista branca de referer para o bucket OSS definindo RefererConfiguration com uma RefererList não vazia.", "zh": "通过设置 RefererConfiguration 并配置非空的 RefererList 为 OSS 存储空间配置 Referer 白名单。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-referer-limit.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_referer_limit", Content: "package infraguard.rules.aliyun.oss_bucket_referer_limit\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-bucket-referer-limit\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"OSS bucket referer hotlink protection configured\",\n\t\t\"zh\": \"OSS 存储空间 Referer 在指定的防盗链白名单中\",\n\t\t\"ja\": \"OSS バケットの Referer ホットリンク保護が設定されている\",\n\t\t\"de\": \"OSS-Bucket Referer-Hotlink-Schutz konfiguriert\",\n\t\t\"es\": \"Protección de enlace directo de referer de bucket OSS configurada\",\n\t\t\"fr\": \"Protection contre les liens directs de referer de bucket OSS configurée\",\n\t\t\"pt\": \"Proteção contra link direto de referer de bucket OSS configurada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS bucket has referer hotlink protection enabled with a configured whitelist.\",\n\t\t\"zh\": \"OSS 存储空间开启防盗链并且 Referer 在指定白名单中。\",\n\t\t\"ja\": \"OSS バケットで Referer ホットリンク保護が有効になり、ホワイトリストが設定されています。\",\n\t\t\"de\": \"OSS-Bucket hat Referer-Hotlink-Schutz mit konfigurierter Whitelist aktiviert.\",\n\t\t\"es\": \"El bucket OSS tiene protección contra enlaces directos de referer habilitada con una lista blanca configurada.\",\n\t\t\"fr\": \"Le bucket OSS a la protection contre les liens directs de referer activée avec une liste blanche configurée.\",\n\t\t\"pt\": \"O bucket OSS tem proteção contra link direto de referer habilitada com uma lista branca configurada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"OSS bucket does not have referer hotlink protection configured, which may lead to unauthorized access and bandwidth theft.\",\n\t\t\"zh\": \"OSS 存储空间未配置 Referer 防盗链,可能导致未授权访问和流量盗用。\",\n\t\t\"ja\": \"OSS バケットに Referer ホットリンク保護が設定されていないため、不正アクセスや帯域幅の盗用につながる可能性があります。\",\n\t\t\"de\": \"OSS-Bucket hat keinen Referer-Hotlink-Schutz konfiguriert, was zu unbefugtem Zugriff und Bandbreitendiebstahl führen kann.\",\n\t\t\"es\": \"El bucket OSS no tiene protección contra enlaces directos de referer configurada, lo que puede llevar a acceso no autorizado y robo de ancho de banda.\",\n\t\t\"fr\": \"Le bucket OSS n'a pas de protection contre les liens directs de referer configurée, ce qui peut entraîner un accès non autorisé et un vol de bande passante.\",\n\t\t\"pt\": \"O bucket OSS não tem proteção contra link direto de referer configurada, o que pode levar a acesso não autorizado e roubo de largura de banda.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure referer whitelist for OSS bucket by setting RefererConfiguration with a non-empty RefererList.\",\n\t\t\"zh\": \"通过设置 RefererConfiguration 并配置非空的 RefererList 为 OSS 存储空间配置 Referer 白名单。\",\n\t\t\"ja\": \"空でない RefererList を使用して RefererConfiguration を設定することで、OSS バケットの Referer ホワイトリストを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie eine Referer-Whitelist für den OSS-Bucket, indem Sie RefererConfiguration mit einer nicht leeren RefererList setzen.\",\n\t\t\"es\": \"Configure la lista blanca de referer para el bucket OSS estableciendo RefererConfiguration con una RefererList no vacía.\",\n\t\t\"fr\": \"Configurez la liste blanche de referer pour le bucket OSS en définissant RefererConfiguration avec une RefererList non vide.\",\n\t\t\"pt\": \"Configure a lista branca de referer para o bucket OSS definindo RefererConfiguration com uma RefererList não vazia.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\n\t# Check if referer configuration exists and has a non-empty list\n\treferer_config := helpers.get_property(resource, \"RefererConfiguration\", {})\n\treferer_list := object.get(referer_config, \"RefererList\", [])\n\n\t# Compliant if referer list is configured and not empty\n\tcount(referer_list) == 0\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"RefererConfiguration\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-remote-replication", Name: models.I18nString{"de": "OSS-Bucket Remote-Replikation aktiviert", "en": "OSS Bucket Remote Replication Enabled", "es": "Replicación Remota de Bucket OSS Habilitada", "fr": "Réplication Distante de Bucket OSS Activée", "ja": "OSS バケットリモートレプリケーションが有効", "pt": "Replicação Remota de Bucket OSS Habilitada", "zh": "OSS 存储桶开启跨区域复制"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die regionsübergreifende Replikation für den OSS-Bucket für die Notfallwiederherstellung aktiviert ist.", "en": "Ensures that cross-region replication is enabled for the OSS bucket for disaster recovery.", "es": "Garantiza que la replicación entre regiones esté habilitada para el bucket OSS para recuperación ante desastres.", "fr": "Garantit que la réplication inter-régions est activée pour le bucket OSS pour la reprise après sinistre.", "ja": "災害復旧のために OSS バケットでクロスリージョンレプリケーションが有効になっていることを確認します。", "pt": "Garante que a replicação entre regiões esteja habilitada para o bucket OSS para recuperação de desastres.", "zh": "确保 OSS 存储桶开启了跨区域复制，以进行容灾。"}, Reason: models.I18nString{"de": "Regionsübergreifende Replikation gewährleistet Datenbeständigkeit und Verfügbarkeit bei einem regionalen Ausfall.", "en": "Cross-region replication ensures data durability and availability in case of a regional failure.", "es": "La replicación entre regiones garantiza la durabilidad y disponibilidad de los datos en caso de una falla regional.", "fr": "La réplication inter-régions garantit la durabilité et la disponibilité des données en cas de défaillance régionale.", "ja": "クロスリージョンレプリケーションにより、リージョン障害が発生した場合のデータの耐久性と可用性が確保されます。", "pt": "A replicação entre regiões garante a durabilidade e disponibilidade dos dados em caso de falha regional.", "zh": "跨区域复制可确保在发生区域性故障时数据的持久性和可用性。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die regionsübergreifende Replikation für den OSS-Bucket.", "en": "Enable cross-region replication for the OSS bucket.", "es": "Habilite la replicación entre regiones para el bucket OSS.", "fr": "Activez la réplication inter-régions pour le bucket OSS.", "ja": "OSS バケットのクロスリージョンレプリケーションを有効にします。", "pt": "Habilite a replicação entre regiões para o bucket OSS.", "zh": "为 OSS 存储桶开启跨区域复制。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-remote-replication.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_remote_replication", Content: "package infraguard.rules.aliyun.oss_bucket_remote_replication\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"oss-bucket-remote-replication\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Remote Replication Enabled\",\n\t\t\"zh\": \"OSS 存储桶开启跨区域复制\",\n\t\t\"ja\": \"OSS バケットリモートレプリケーションが有効\",\n\t\t\"de\": \"OSS-Bucket Remote-Replikation aktiviert\",\n\t\t\"es\": \"Replicación Remota de Bucket OSS Habilitada\",\n\t\t\"fr\": \"Réplication Distante de Bucket OSS Activée\",\n\t\t\"pt\": \"Replicação Remota de Bucket OSS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that cross-region replication is enabled for the OSS bucket for disaster recovery.\",\n\t\t\"zh\": \"确保 OSS 存储桶开启了跨区域复制，以进行容灾。\",\n\t\t\"ja\": \"災害復旧のために OSS バケットでクロスリージョンレプリケーションが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die regionsübergreifende Replikation für den OSS-Bucket für die Notfallwiederherstellung aktiviert ist.\",\n\t\t\"es\": \"Garantiza que la replicación entre regiones esté habilitada para el bucket OSS para recuperación ante desastres.\",\n\t\t\"fr\": \"Garantit que la réplication inter-régions est activée pour le bucket OSS pour la reprise après sinistre.\",\n\t\t\"pt\": \"Garante que a replicação entre regiões esteja habilitada para o bucket OSS para recuperação de desastres.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Cross-region replication ensures data durability and availability in case of a regional failure.\",\n\t\t\"zh\": \"跨区域复制可确保在发生区域性故障时数据的持久性和可用性。\",\n\t\t\"ja\": \"クロスリージョンレプリケーションにより、リージョン障害が発生した場合のデータの耐久性と可用性が確保されます。\",\n\t\t\"de\": \"Regionsübergreifende Replikation gewährleistet Datenbeständigkeit und Verfügbarkeit bei einem regionalen Ausfall.\",\n\t\t\"es\": \"La replicación entre regiones garantiza la durabilidad y disponibilidad de los datos en caso de una falla regional.\",\n\t\t\"fr\": \"La réplication inter-régions garantit la durabilité et la disponibilité des données en cas de défaillance régionale.\",\n\t\t\"pt\": \"A replicação entre regiões garante a durabilidade e disponibilidade dos dados em caso de falha regional.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable cross-region replication for the OSS bucket.\",\n\t\t\"zh\": \"为 OSS 存储桶开启跨区域复制。\",\n\t\t\"ja\": \"OSS バケットのクロスリージョンレプリケーションを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die regionsübergreifende Replikation für den OSS-Bucket.\",\n\t\t\"es\": \"Habilite la replicación entre regiones para el bucket OSS.\",\n\t\t\"fr\": \"Activez la réplication inter-régions pour le bucket OSS.\",\n\t\t\"pt\": \"Habilite a replicação entre regiões para o bucket OSS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\n\t# Conceptual check\n\tnot helpers.has_property(resource, \"ReplicationConfiguration\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-server-side-encryption-enabled", Name: models.I18nString{"de": "OSS-Bucket-Serverseitige-Verschlüsselung aktiviert", "en": "OSS Bucket Server-Side Encryption Enabled", "es": "Cifrado del Lado del Servidor de Bucket OSS Habilitado", "fr": "Chiffrement Côté Serveur de Bucket OSS Activé", "ja": "OSS バケットのサーバー側暗号化が有効", "pt": "Criptografia do Lado do Servidor de Bucket OSS Habilitada", "zh": "OSS 存储空间开启服务端加密"}, Severity: "high", Description: models.I18nString{"de": "OSS-Buckets sollten serverseitige Verschlüsselung aktiviert haben, um ruhende Daten zu schützen. Die serverseitige Verschlüsselung verwendet KMS oder AES256, um in OSS gespeicherte Daten zu verschlüsseln.", "en": "OSS buckets should have server-side encryption enabled to protect data at rest. Server-side encryption uses KMS or AES256 to encrypt data stored in OSS.", "es": "Los buckets OSS deben tener cifrado del lado del servidor habilitado para proteger los datos en reposo. El cifrado del lado del servidor usa KMS o AES256 para cifrar datos almacenados en OSS.", "fr": "Les buckets OSS doivent avoir le chiffrement côté serveur activé pour protéger les données au repos. Le chiffrement côté serveur utilise KMS ou AES256 pour chiffrer les données stockées dans OSS.", "ja": "OSS バケットは、保存データを保護するためにサーバー側暗号化を有効にする必要があります。サーバー側暗号化は KMS または AES256 を使用して OSS に保存されたデータを暗号化します。", "pt": "Buckets OSS devem ter criptografia do lado do servidor habilitada para proteger dados em repouso. A criptografia do lado do servidor usa KMS ou AES256 para criptografar dados armazenados no OSS.", "zh": "OSS 存储空间应开启服务端加密以保护静态数据。服务端加密使用 KMS 或 AES256 对存储在 OSS 中的数据进行加密。"}, Reason: models.I18nString{"de": "Der OSS-Bucket hat keine serverseitige Verschlüsselung aktiviert, was sensible Daten unbefugtem Zugriff aussetzen kann.", "en": "The OSS bucket does not have server-side encryption enabled, which may expose sensitive data to unauthorized access.", "es": "El bucket OSS no tiene cifrado del lado del servidor habilitado, lo que puede exponer datos sensibles a acceso no autorizado.", "fr": "Le bucket OSS n'a pas le chiffrement côté serveur activé, ce qui peut exposer des données sensibles à un accès non autorisé.", "ja": "OSS バケットでサーバー側暗号化が有効になっていないため、機密データが不正アクセスにさらされる可能性があります。", "pt": "O bucket OSS não tem criptografia do lado do servidor habilitada, o que pode expor dados sensíveis a acesso não autorizado.", "zh": "OSS 存储空间未开启服务端加密，可能导致敏感数据暴露给未授权访问。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die serverseitige Verschlüsselung für den OSS-Bucket, indem Sie die ServerSideEncryptionConfiguration-Eigenschaft mit SSEAlgorithm auf KMS, AES256 oder SM4 konfigurieren.", "en": "Enable server-side encryption for the OSS bucket by configuring the ServerSideEncryptionConfiguration property with SSEAlgorithm set to KMS, AES256, or SM4.", "es": "Habilite el cifrado del lado del servidor para el bucket OSS configurando la propiedad ServerSideEncryptionConfiguration con SSEAlgorithm establecido en KMS, AES256 o SM4.", "fr": "Activez le chiffrement côté serveur pour le bucket OSS en configurant la propriété ServerSideEncryptionConfiguration avec SSEAlgorithm défini sur KMS, AES256 ou SM4.", "ja": "SSEAlgorithm を KMS、AES256、または SM4 に設定して ServerSideEncryptionConfiguration プロパティを設定することで、OSS バケットのサーバー側暗号化を有効にします。", "pt": "Habilite criptografia do lado do servidor para o bucket OSS configurando a propriedade ServerSideEncryptionConfiguration com SSEAlgorithm definido como KMS, AES256 ou SM4.", "zh": "通过配置 ServerSideEncryptionConfiguration 属性并将 SSEAlgorithm 设置为 KMS、AES256 或 SM4，为 OSS 存储空间启用服务端加密。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-server-side-encryption-enabled.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_server_side_encryption_enabled", Content: "package infraguard.rules.aliyun.oss_bucket_server_side_encryption_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-bucket-server-side-encryption-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Server-Side Encryption Enabled\",\n\t\t\"zh\": \"OSS 存储空间开启服务端加密\",\n\t\t\"ja\": \"OSS バケットのサーバー側暗号化が有効\",\n\t\t\"de\": \"OSS-Bucket-Serverseitige-Verschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado del Lado del Servidor de Bucket OSS Habilitado\",\n\t\t\"fr\": \"Chiffrement Côté Serveur de Bucket OSS Activé\",\n\t\t\"pt\": \"Criptografia do Lado do Servidor de Bucket OSS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS buckets should have server-side encryption enabled to protect data at rest. Server-side encryption uses KMS or AES256 to encrypt data stored in OSS.\",\n\t\t\"zh\": \"OSS 存储空间应开启服务端加密以保护静态数据。服务端加密使用 KMS 或 AES256 对存储在 OSS 中的数据进行加密。\",\n\t\t\"ja\": \"OSS バケットは、保存データを保護するためにサーバー側暗号化を有効にする必要があります。サーバー側暗号化は KMS または AES256 を使用して OSS に保存されたデータを暗号化します。\",\n\t\t\"de\": \"OSS-Buckets sollten serverseitige Verschlüsselung aktiviert haben, um ruhende Daten zu schützen. Die serverseitige Verschlüsselung verwendet KMS oder AES256, um in OSS gespeicherte Daten zu verschlüsseln.\",\n\t\t\"es\": \"Los buckets OSS deben tener cifrado del lado del servidor habilitado para proteger los datos en reposo. El cifrado del lado del servidor usa KMS o AES256 para cifrar datos almacenados en OSS.\",\n\t\t\"fr\": \"Les buckets OSS doivent avoir le chiffrement côté serveur activé pour protéger les données au repos. Le chiffrement côté serveur utilise KMS ou AES256 pour chiffrer les données stockées dans OSS.\",\n\t\t\"pt\": \"Buckets OSS devem ter criptografia do lado do servidor habilitada para proteger dados em repouso. A criptografia do lado do servidor usa KMS ou AES256 para criptografar dados armazenados no OSS.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The OSS bucket does not have server-side encryption enabled, which may expose sensitive data to unauthorized access.\",\n\t\t\"zh\": \"OSS 存储空间未开启服务端加密，可能导致敏感数据暴露给未授权访问。\",\n\t\t\"ja\": \"OSS バケットでサーバー側暗号化が有効になっていないため、機密データが不正アクセスにさらされる可能性があります。\",\n\t\t\"de\": \"Der OSS-Bucket hat keine serverseitige Verschlüsselung aktiviert, was sensible Daten unbefugtem Zugriff aussetzen kann.\",\n\t\t\"es\": \"El bucket OSS no tiene cifrado del lado del servidor habilitado, lo que puede exponer datos sensibles a acceso no autorizado.\",\n\t\t\"fr\": \"Le bucket OSS n'a pas le chiffrement côté serveur activé, ce qui peut exposer des données sensibles à un accès non autorisé.\",\n\t\t\"pt\": \"O bucket OSS não tem criptografia do lado do servidor habilitada, o que pode expor dados sensíveis a acesso não autorizado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable server-side encryption for the OSS bucket by configuring the ServerSideEncryptionConfiguration property with SSEAlgorithm set to KMS, AES256, or SM4.\",\n\t\t\"zh\": \"通过配置 ServerSideEncryptionConfiguration 属性并将 SSEAlgorithm 设置为 KMS、AES256 或 SM4，为 OSS 存储空间启用服务端加密。\",\n\t\t\"ja\": \"SSEAlgorithm を KMS、AES256、または SM4 に設定して ServerSideEncryptionConfiguration プロパティを設定することで、OSS バケットのサーバー側暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die serverseitige Verschlüsselung für den OSS-Bucket, indem Sie die ServerSideEncryptionConfiguration-Eigenschaft mit SSEAlgorithm auf KMS, AES256 oder SM4 konfigurieren.\",\n\t\t\"es\": \"Habilite el cifrado del lado del servidor para el bucket OSS configurando la propiedad ServerSideEncryptionConfiguration con SSEAlgorithm establecido en KMS, AES256 o SM4.\",\n\t\t\"fr\": \"Activez le chiffrement côté serveur pour le bucket OSS en configurant la propriété ServerSideEncryptionConfiguration avec SSEAlgorithm défini sur KMS, AES256 ou SM4.\",\n\t\t\"pt\": \"Habilite criptografia do lado do servidor para o bucket OSS configurando a propriedade ServerSideEncryptionConfiguration com SSEAlgorithm definido como KMS, AES256 ou SM4.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tnot has_server_side_encryption(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ServerSideEncryptionConfiguration\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nhas_server_side_encryption(resource) if {\n\thelpers.has_property(resource, \"ServerSideEncryptionConfiguration\")\n\tsse_config := resource.Properties.ServerSideEncryptionConfiguration\n\tsse_config.SSEAlgorithm in [\"KMS\", \"AES256\", \"SM4\"]\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-tls-version-check", Name: models.I18nString{"de": "OSS-Bucket TLS-Versionsprüfung", "en": "OSS Bucket TLS Version Check", "es": "Verificación de Versión TLS de Bucket OSS", "fr": "Vérification de la Version TLS de Bucket OSS", "ja": "OSS バケットの TLS バージョンチェック", "pt": "Verificação de Versão TLS de Bucket OSS", "zh": "OSS 存储桶 TLS 版本检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der OSS-Bucket so konfiguriert ist, dass er eine sichere TLS-Version (TLS 1.2 oder höher) verwendet.", "en": "Ensures that the OSS bucket is configured to use a secure version of TLS (TLS 1.2 or higher).", "es": "Garantiza que el bucket OSS esté configurado para usar una versión segura de TLS (TLS 1.2 o superior).", "fr": "Garantit que le bucket OSS est configuré pour utiliser une version sécurisée de TLS (TLS 1.2 ou supérieure).", "ja": "OSS バケットが安全な TLS バージョン（TLS 1.2 以上）を使用するように設定されていることを確認します。", "pt": "Garante que o bucket OSS esteja configurado para usar uma versão segura de TLS (TLS 1.2 ou superior).", "zh": "确保 OSS 存储桶配置为使用安全的 TLS 版本（TLS 1.2 或更高版本）。"}, Reason: models.I18nString{"de": "Ältere Versionen von TLS haben Sicherheitslücken. Die Verwendung neuerer Versionen gewährleistet die Datentransportsicherheit.", "en": "Older versions of TLS have security vulnerabilities. Using newer versions ensures data transport security.", "es": "Las versiones anteriores de TLS tienen vulnerabilidades de seguridad. El uso de versiones más nuevas garantiza la seguridad del transporte de datos.", "fr": "Les anciennes versions de TLS présentent des vulnérabilités de sécurité. L'utilisation de versions plus récentes assure la sécurité du transport des données.", "ja": "古いバージョンの TLS にはセキュリティの脆弱性があります。新しいバージョンを使用することで、データ転送のセキュリティが確保されます。", "pt": "Versões antigas de TLS têm vulnerabilidades de segurança. O uso de versões mais recentes garante a segurança do transporte de dados.", "zh": "旧版本的 TLS 存在安全漏洞。使用新版本可确保数据传输安全。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie den OSS-Bucket so, dass TLS 1.2 oder höher für alle Anfragen erforderlich ist.", "en": "Configure the OSS bucket to require TLS 1.2 or higher for all requests.", "es": "Configure el bucket OSS para requerir TLS 1.2 o superior para todas las solicitudes.", "fr": "Configurez le bucket OSS pour exiger TLS 1.2 ou supérieur pour toutes les requêtes.", "ja": "OSS バケットを設定して、すべてのリクエストに TLS 1.2 以上を要求します。", "pt": "Configure o bucket OSS para exigir TLS 1.2 ou superior para todas as solicitações.", "zh": "配置 OSS 存储桶，要求所有请求使用 TLS 1.2 或更高版本。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-tls-version-check.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_tls_version_check", Content: "package infraguard.rules.aliyun.oss_bucket_tls_version_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"oss-bucket-tls-version-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket TLS Version Check\",\n\t\t\"zh\": \"OSS 存储桶 TLS 版本检测\",\n\t\t\"ja\": \"OSS バケットの TLS バージョンチェック\",\n\t\t\"de\": \"OSS-Bucket TLS-Versionsprüfung\",\n\t\t\"es\": \"Verificación de Versión TLS de Bucket OSS\",\n\t\t\"fr\": \"Vérification de la Version TLS de Bucket OSS\",\n\t\t\"pt\": \"Verificação de Versão TLS de Bucket OSS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the OSS bucket is configured to use a secure version of TLS (TLS 1.2 or higher).\",\n\t\t\"zh\": \"确保 OSS 存储桶配置为使用安全的 TLS 版本（TLS 1.2 或更高版本）。\",\n\t\t\"ja\": \"OSS バケットが安全な TLS バージョン（TLS 1.2 以上）を使用するように設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der OSS-Bucket so konfiguriert ist, dass er eine sichere TLS-Version (TLS 1.2 oder höher) verwendet.\",\n\t\t\"es\": \"Garantiza que el bucket OSS esté configurado para usar una versión segura de TLS (TLS 1.2 o superior).\",\n\t\t\"fr\": \"Garantit que le bucket OSS est configuré pour utiliser une version sécurisée de TLS (TLS 1.2 ou supérieure).\",\n\t\t\"pt\": \"Garante que o bucket OSS esteja configurado para usar uma versão segura de TLS (TLS 1.2 ou superior).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Older versions of TLS have security vulnerabilities. Using newer versions ensures data transport security.\",\n\t\t\"zh\": \"旧版本的 TLS 存在安全漏洞。使用新版本可确保数据传输安全。\",\n\t\t\"ja\": \"古いバージョンの TLS にはセキュリティの脆弱性があります。新しいバージョンを使用することで、データ転送のセキュリティが確保されます。\",\n\t\t\"de\": \"Ältere Versionen von TLS haben Sicherheitslücken. Die Verwendung neuerer Versionen gewährleistet die Datentransportsicherheit.\",\n\t\t\"es\": \"Las versiones anteriores de TLS tienen vulnerabilidades de seguridad. El uso de versiones más nuevas garantiza la seguridad del transporte de datos.\",\n\t\t\"fr\": \"Les anciennes versions de TLS présentent des vulnérabilités de sécurité. L'utilisation de versions plus récentes assure la sécurité du transport des données.\",\n\t\t\"pt\": \"Versões antigas de TLS têm vulnerabilidades de segurança. O uso de versões mais recentes garante a segurança do transporte de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the OSS bucket to require TLS 1.2 or higher for all requests.\",\n\t\t\"zh\": \"配置 OSS 存储桶，要求所有请求使用 TLS 1.2 或更高版本。\",\n\t\t\"ja\": \"OSS バケットを設定して、すべてのリクエストに TLS 1.2 以上を要求します。\",\n\t\t\"de\": \"Konfigurieren Sie den OSS-Bucket so, dass TLS 1.2 oder höher für alle Anfragen erforderlich ist.\",\n\t\t\"es\": \"Configure el bucket OSS para requerir TLS 1.2 o superior para todas las solicitudes.\",\n\t\t\"fr\": \"Configurez le bucket OSS pour exiger TLS 1.2 ou supérieur pour toutes les requêtes.\",\n\t\t\"pt\": \"Configure o bucket OSS para exigir TLS 1.2 ou superior para todas as solicitações.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\n\t# Conceptual check for TLS version in policy or specific property\n\tnot helpers.has_property(resource, \"TLSVersion\") # Simplified\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-bucket-versioning-enabled", Name: models.I18nString{"de": "OSS-Bucket Versionsverwaltung aktiviert", "en": "OSS Bucket Versioning Enabled", "es": "Versionado de Bucket OSS Habilitado", "fr": "Versioning de Bucket OSS Activé", "ja": "OSS バケットのバージョニングが有効", "pt": "Versionamento de Bucket OSS Habilitado", "zh": "OSS 存储桶开启版本控制"}, Severity: "medium", Description: models.I18nString{"de": "OSS-Bucket sollte Versionsverwaltung aktiviert haben, um vor versehentlichem Löschen oder Überschreiben zu schützen.", "en": "OSS bucket should have versioning enabled to protect against accidental deletion or overwriting.", "es": "El bucket OSS debe tener versionado habilitado para proteger contra eliminación o sobrescritura accidental.", "fr": "Le bucket OSS doit avoir le versioning activé pour protéger contre la suppression ou l'écrasement accidentel.", "ja": "OSS バケットは、誤削除や上書きから保護するためにバージョニングを有効にする必要があります。", "pt": "Bucket OSS deve ter versionamento habilitado para proteger contra exclusão ou sobrescrita acidental.", "zh": "OSS 存储桶开启版本控制，视为合规。"}, Reason: models.I18nString{"de": "Die Versionsverwaltung ist für den OSS-Bucket nicht aktiviert, was das Risiko von Datenverlust erhöht.", "en": "Versioning is not enabled for the OSS bucket, which increases the risk of data loss.", "es": "El versionado no está habilitado para el bucket OSS, lo que aumenta el riesgo de pérdida de datos.", "fr": "Le versioning n'est pas activé pour le bucket OSS, ce qui augmente le risque de perte de données.", "ja": "OSS バケットでバージョニングが有効になっていないため、データ損失のリスクが増加します。", "pt": "Versionamento não está habilitado para o bucket OSS, o que aumenta o risco de perda de dados.", "zh": "OSS 存储桶未开启版本控制，增加了数据丢失的风险。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Versionsverwaltung für den OSS-Bucket, indem Sie VersioningConfiguration.Status auf Enabled setzen.", "en": "Enable versioning for the OSS bucket by setting VersioningConfiguration.Status to Enabled.", "es": "Habilite el versionado para el bucket OSS estableciendo VersioningConfiguration.Status en Enabled.", "fr": "Activez le versioning pour le bucket OSS en définissant VersioningConfiguration.Status sur Enabled.", "ja": "VersioningConfiguration.Status を Enabled に設定して、OSS バケットのバージョニングを有効にします。", "pt": "Habilite versionamento para o bucket OSS definindo VersioningConfiguration.Status como Enabled.", "zh": "通过将 VersioningConfiguration.Status 设置为 Enabled 来开启存储桶的版本控制。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-bucket-versioning-enabled.rego", PackageName: "infraguard.rules.aliyun.oss_bucket_versioning_enabled", Content: "package infraguard.rules.aliyun.oss_bucket_versioning_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-bucket-versioning-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Versioning Enabled\",\n\t\t\"zh\": \"OSS 存储桶开启版本控制\",\n\t\t\"ja\": \"OSS バケットのバージョニングが有効\",\n\t\t\"de\": \"OSS-Bucket Versionsverwaltung aktiviert\",\n\t\t\"es\": \"Versionado de Bucket OSS Habilitado\",\n\t\t\"fr\": \"Versioning de Bucket OSS Activé\",\n\t\t\"pt\": \"Versionamento de Bucket OSS Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS bucket should have versioning enabled to protect against accidental deletion or overwriting.\",\n\t\t\"zh\": \"OSS 存储桶开启版本控制，视为合规。\",\n\t\t\"ja\": \"OSS バケットは、誤削除や上書きから保護するためにバージョニングを有効にする必要があります。\",\n\t\t\"de\": \"OSS-Bucket sollte Versionsverwaltung aktiviert haben, um vor versehentlichem Löschen oder Überschreiben zu schützen.\",\n\t\t\"es\": \"El bucket OSS debe tener versionado habilitado para proteger contra eliminación o sobrescritura accidental.\",\n\t\t\"fr\": \"Le bucket OSS doit avoir le versioning activé pour protéger contre la suppression ou l'écrasement accidentel.\",\n\t\t\"pt\": \"Bucket OSS deve ter versionamento habilitado para proteger contra exclusão ou sobrescrita acidental.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Versioning is not enabled for the OSS bucket, which increases the risk of data loss.\",\n\t\t\"zh\": \"OSS 存储桶未开启版本控制，增加了数据丢失的风险。\",\n\t\t\"ja\": \"OSS バケットでバージョニングが有効になっていないため、データ損失のリスクが増加します。\",\n\t\t\"de\": \"Die Versionsverwaltung ist für den OSS-Bucket nicht aktiviert, was das Risiko von Datenverlust erhöht.\",\n\t\t\"es\": \"El versionado no está habilitado para el bucket OSS, lo que aumenta el riesgo de pérdida de datos.\",\n\t\t\"fr\": \"Le versioning n'est pas activé pour le bucket OSS, ce qui augmente le risque de perte de données.\",\n\t\t\"pt\": \"Versionamento não está habilitado para o bucket OSS, o que aumenta o risco de perda de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable versioning for the OSS bucket by setting VersioningConfiguration.Status to Enabled.\",\n\t\t\"zh\": \"通过将 VersioningConfiguration.Status 设置为 Enabled 来开启存储桶的版本控制。\",\n\t\t\"ja\": \"VersioningConfiguration.Status を Enabled に設定して、OSS バケットのバージョニングを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Versionsverwaltung für den OSS-Bucket, indem Sie VersioningConfiguration.Status auf Enabled setzen.\",\n\t\t\"es\": \"Habilite el versionado para el bucket OSS estableciendo VersioningConfiguration.Status en Enabled.\",\n\t\t\"fr\": \"Activez le versioning pour le bucket OSS en définissant VersioningConfiguration.Status sur Enabled.\",\n\t\t\"pt\": \"Habilite versionamento para o bucket OSS definindo VersioningConfiguration.Status como Enabled.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\n# Check if versioning is enabled\nis_versioning_enabled(resource) if {\n\tversioning := helpers.get_property(resource, \"VersioningConfiguration\", {})\n\tversioning.Status == \"Enabled\"\n}\n\nget_violation_path(resource) := [\"Properties\", \"VersioningConfiguration\", \"Status\"] if {\n\thelpers.has_property(resource, \"VersioningConfiguration\")\n} else := [\"Properties\"]\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_versioning_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": get_violation_path(resource),\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-default-encryption-kms", Name: models.I18nString{"de": "OSS-Bucket serverseitige KMS-Verschlüsselung aktiviert", "en": "OSS bucket server-side KMS encryption enabled", "es": "Cifrado KMS del lado del servidor de bucket OSS habilitado", "fr": "Chiffrement KMS côté serveur de bucket OSS activé", "ja": "OSS バケットのサーバー側 KMS 暗号化が有効", "pt": "Criptografia KMS do lado do servidor de bucket OSS habilitada", "zh": "OSS 存储空间开启服务端 KMS 加密"}, Severity: "medium", Description: models.I18nString{"de": "OSS-Bucket hat serverseitige KMS-Verschlüsselung aktiviert, wird als konform betrachtet.", "en": "OSS bucket has server-side KMS encryption enabled, considered compliant.", "es": "El bucket OSS tiene cifrado KMS del lado del servidor habilitado, se considera conforme.", "fr": "Le bucket OSS a le chiffrement KMS côté serveur activé, considéré comme conforme.", "ja": "OSS バケットでサーバー側 KMS 暗号化が有効になっている場合、準拠と見なされます。", "pt": "O bucket OSS tem criptografia KMS do lado do servidor habilitada, considerado conforme.", "zh": "OSS 存储空间开启服务端 KMS 加密,视为合规。"}, Reason: models.I18nString{"de": "OSS-Bucket hat keine serverseitige KMS-Verschlüsselung aktiviert", "en": "OSS bucket does not have server-side KMS encryption enabled", "es": "El bucket OSS no tiene cifrado KMS del lado del servidor habilitado", "fr": "Le bucket OSS n'a pas le chiffrement KMS côté serveur activé", "ja": "OSS バケットでサーバー側 KMS 暗号化が有効になっていません", "pt": "O bucket OSS não tem criptografia KMS do lado do servidor habilitada", "zh": "OSS 存储空间未开启服务端 KMS 加密"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die serverseitige KMS-Verschlüsselung für OSS-Buckets, um ruhende Daten zu schützen", "en": "Enable server-side KMS encryption for OSS bucket to protect data at rest", "es": "Habilite el cifrado KMS del lado del servidor para el bucket OSS para proteger los datos en reposo", "fr": "Activez le chiffrement KMS côté serveur pour le bucket OSS pour protéger les données au repos", "ja": "保存データを保護するために、OSS バケットでサーバー側 KMS 暗号化を有効にします", "pt": "Habilite criptografia KMS do lado do servidor para bucket OSS para proteger dados em repouso", "zh": "为 OSS 存储空间开启服务端 KMS 加密以保护静态数据"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-default-encryption-kms.rego", PackageName: "infraguard.rules.aliyun.oss_default_encryption_kms", Content: "package infraguard.rules.aliyun.oss_default_encryption_kms\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-default-encryption-kms\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS bucket server-side KMS encryption enabled\",\n\t\t\"zh\": \"OSS 存储空间开启服务端 KMS 加密\",\n\t\t\"ja\": \"OSS バケットのサーバー側 KMS 暗号化が有効\",\n\t\t\"de\": \"OSS-Bucket serverseitige KMS-Verschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado KMS del lado del servidor de bucket OSS habilitado\",\n\t\t\"fr\": \"Chiffrement KMS côté serveur de bucket OSS activé\",\n\t\t\"pt\": \"Criptografia KMS do lado do servidor de bucket OSS habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS bucket has server-side KMS encryption enabled, considered compliant.\",\n\t\t\"zh\": \"OSS 存储空间开启服务端 KMS 加密,视为合规。\",\n\t\t\"ja\": \"OSS バケットでサーバー側 KMS 暗号化が有効になっている場合、準拠と見なされます。\",\n\t\t\"de\": \"OSS-Bucket hat serverseitige KMS-Verschlüsselung aktiviert, wird als konform betrachtet.\",\n\t\t\"es\": \"El bucket OSS tiene cifrado KMS del lado del servidor habilitado, se considera conforme.\",\n\t\t\"fr\": \"Le bucket OSS a le chiffrement KMS côté serveur activé, considéré comme conforme.\",\n\t\t\"pt\": \"O bucket OSS tem criptografia KMS do lado do servidor habilitada, considerado conforme.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"OSS bucket does not have server-side KMS encryption enabled\",\n\t\t\"zh\": \"OSS 存储空间未开启服务端 KMS 加密\",\n\t\t\"ja\": \"OSS バケットでサーバー側 KMS 暗号化が有効になっていません\",\n\t\t\"de\": \"OSS-Bucket hat keine serverseitige KMS-Verschlüsselung aktiviert\",\n\t\t\"es\": \"El bucket OSS no tiene cifrado KMS del lado del servidor habilitado\",\n\t\t\"fr\": \"Le bucket OSS n'a pas le chiffrement KMS côté serveur activé\",\n\t\t\"pt\": \"O bucket OSS não tem criptografia KMS do lado do servidor habilitada\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable server-side KMS encryption for OSS bucket to protect data at rest\",\n\t\t\"zh\": \"为 OSS 存储空间开启服务端 KMS 加密以保护静态数据\",\n\t\t\"ja\": \"保存データを保護するために、OSS バケットでサーバー側 KMS 暗号化を有効にします\",\n\t\t\"de\": \"Aktivieren Sie die serverseitige KMS-Verschlüsselung für OSS-Buckets, um ruhende Daten zu schützen\",\n\t\t\"es\": \"Habilite el cifrado KMS del lado del servidor para el bucket OSS para proteger los datos en reposo\",\n\t\t\"fr\": \"Activez le chiffrement KMS côté serveur pour le bucket OSS pour protéger les données au repos\",\n\t\t\"pt\": \"Habilite criptografia KMS do lado do servidor para bucket OSS para proteger dados em repouso\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\n\t# Check if ServerSideEncryptionConfiguration is set with KMS\n\tsse_config := helpers.get_property(resource, \"ServerSideEncryptionConfiguration\", {})\n\tsse_algorithm := object.get(sse_config, \"SSEAlgorithm\", \"\")\n\n\tsse_algorithm != \"KMS\"\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-encryption-byok-check", Name: models.I18nString{"de": "OSS-Bucket BYOK-Verschlüsselungsprüfung", "en": "OSS Bucket BYOK Encryption Check", "es": "Verificación de Cifrado BYOK de Bucket OSS", "fr": "Vérification du Chiffrement BYOK de Bucket OSS", "ja": "OSS バケット BYOK 暗号化チェック", "pt": "Verificação de Criptografia BYOK de Bucket OSS", "zh": "OSS 存储空间使用自定义 KMS 密钥加密"}, Severity: "medium", Description: models.I18nString{"de": "OSS-Buckets sollten kundenseitig verwaltete KMS-Schlüssel (BYOK - Bring Your Own Key) für die Verschlüsselung verwenden. Dies bietet eine bessere Kontrolle über Verschlüsselungsschlüssel und erfüllt Compliance-Anforderungen.", "en": "OSS buckets should use customer-managed KMS keys (BYOK - Bring Your Own Key) for encryption. This provides better control over encryption keys and meets compliance requirements.", "es": "Los buckets OSS deben usar claves KMS administradas por el cliente (BYOK - Bring Your Own Key) para el cifrado. Esto proporciona un mejor control sobre las claves de cifrado y cumple con los requisitos de cumplimiento.", "fr": "Les buckets OSS doivent utiliser des clés KMS gérées par le client (BYOK - Bring Your Own Key) pour le chiffrement. Cela offre un meilleur contrôle sur les clés de chiffrement et répond aux exigences de conformité.", "ja": "OSS バケットは、暗号化にカスタマー管理の KMS キー（BYOK - Bring Your Own Key）を使用する必要があります。これにより、暗号化キーに対するより良い制御が提供され、コンプライアンス要件を満たします。", "pt": "Buckets OSS devem usar chaves KMS gerenciadas pelo cliente (BYOK - Bring Your Own Key) para criptografia. Isso fornece melhor controle sobre chaves de criptografia e atende aos requisitos de conformidade.", "zh": "OSS 存储空间应使用客户管理的 KMS 密钥（BYOK - 自带密钥）进行加密。这提供了对加密密钥的更好控制并满足合规要求。"}, Reason: models.I18nString{"de": "Der OSS-Bucket verwendet keine kundenseitig verwalteten KMS-Schlüssel für die Verschlüsselung, was möglicherweise nicht den Compliance-Anforderungen für die Schlüsselverwaltung entspricht.", "en": "The OSS bucket does not use customer-managed KMS keys for encryption, which may not meet compliance requirements for key management.", "es": "El bucket OSS no usa claves KMS administradas por el cliente para el cifrado, lo que puede no cumplir con los requisitos de cumplimiento para la gestión de claves.", "fr": "Le bucket OSS n'utilise pas de clés KMS gérées par le client pour le chiffrement, ce qui peut ne pas répondre aux exigences de conformité pour la gestion des clés.", "ja": "OSS バケットが暗号化にカスタマー管理の KMS キーを使用していないため、キー管理のコンプライアンス要件を満たさない可能性があります。", "pt": "O bucket OSS não usa chaves KMS gerenciadas pelo cliente para criptografia, o que pode não atender aos requisitos de conformidade para gerenciamento de chaves.", "zh": "OSS 存储空间未使用客户管理的 KMS 密钥进行加密，可能无法满足密钥管理的合规要求。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie den OSS-Bucket so, dass er kundenseitig verwaltete KMS-Schlüssel verwendet, indem Sie SSEAlgorithm auf KMS setzen und eine KMSMasterKeyID in ServerSideEncryptionConfiguration angeben.", "en": "Configure the OSS bucket to use customer-managed KMS keys by setting SSEAlgorithm to KMS and specifying a KMSMasterKeyID in ServerSideEncryptionConfiguration.", "es": "Configure el bucket OSS para usar claves KMS administradas por el cliente estableciendo SSEAlgorithm en KMS y especificando un KMSMasterKeyID en ServerSideEncryptionConfiguration.", "fr": "Configurez le bucket OSS pour utiliser des clés KMS gérées par le client en définissant SSEAlgorithm sur KMS et en spécifiant un KMSMasterKeyID dans ServerSideEncryptionConfiguration.", "ja": "SSEAlgorithm を KMS に設定し、ServerSideEncryptionConfiguration で KMSMasterKeyID を指定して、OSS バケットをカスタマー管理の KMS キーを使用するように設定します。", "pt": "Configure o bucket OSS para usar chaves KMS gerenciadas pelo cliente definindo SSEAlgorithm como KMS e especificando um KMSMasterKeyID em ServerSideEncryptionConfiguration.", "zh": "通过将 SSEAlgorithm 设置为 KMS 并在 ServerSideEncryptionConfiguration 中指定 KMSMasterKeyID，将 OSS 存储空间配置为使用客户管理的 KMS 密钥。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-encryption-byok-check.rego", PackageName: "infraguard.rules.aliyun.oss_encryption_byok_check", Content: "package infraguard.rules.aliyun.oss_encryption_byok_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"oss-encryption-byok-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket BYOK Encryption Check\",\n\t\t\"zh\": \"OSS 存储空间使用自定义 KMS 密钥加密\",\n\t\t\"ja\": \"OSS バケット BYOK 暗号化チェック\",\n\t\t\"de\": \"OSS-Bucket BYOK-Verschlüsselungsprüfung\",\n\t\t\"es\": \"Verificación de Cifrado BYOK de Bucket OSS\",\n\t\t\"fr\": \"Vérification du Chiffrement BYOK de Bucket OSS\",\n\t\t\"pt\": \"Verificação de Criptografia BYOK de Bucket OSS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS buckets should use customer-managed KMS keys (BYOK - Bring Your Own Key) for encryption. This provides better control over encryption keys and meets compliance requirements.\",\n\t\t\"zh\": \"OSS 存储空间应使用客户管理的 KMS 密钥（BYOK - 自带密钥）进行加密。这提供了对加密密钥的更好控制并满足合规要求。\",\n\t\t\"ja\": \"OSS バケットは、暗号化にカスタマー管理の KMS キー（BYOK - Bring Your Own Key）を使用する必要があります。これにより、暗号化キーに対するより良い制御が提供され、コンプライアンス要件を満たします。\",\n\t\t\"de\": \"OSS-Buckets sollten kundenseitig verwaltete KMS-Schlüssel (BYOK - Bring Your Own Key) für die Verschlüsselung verwenden. Dies bietet eine bessere Kontrolle über Verschlüsselungsschlüssel und erfüllt Compliance-Anforderungen.\",\n\t\t\"es\": \"Los buckets OSS deben usar claves KMS administradas por el cliente (BYOK - Bring Your Own Key) para el cifrado. Esto proporciona un mejor control sobre las claves de cifrado y cumple con los requisitos de cumplimiento.\",\n\t\t\"fr\": \"Les buckets OSS doivent utiliser des clés KMS gérées par le client (BYOK - Bring Your Own Key) pour le chiffrement. Cela offre un meilleur contrôle sur les clés de chiffrement et répond aux exigences de conformité.\",\n\t\t\"pt\": \"Buckets OSS devem usar chaves KMS gerenciadas pelo cliente (BYOK - Bring Your Own Key) para criptografia. Isso fornece melhor controle sobre chaves de criptografia e atende aos requisitos de conformidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The OSS bucket does not use customer-managed KMS keys for encryption, which may not meet compliance requirements for key management.\",\n\t\t\"zh\": \"OSS 存储空间未使用客户管理的 KMS 密钥进行加密，可能无法满足密钥管理的合规要求。\",\n\t\t\"ja\": \"OSS バケットが暗号化にカスタマー管理の KMS キーを使用していないため、キー管理のコンプライアンス要件を満たさない可能性があります。\",\n\t\t\"de\": \"Der OSS-Bucket verwendet keine kundenseitig verwalteten KMS-Schlüssel für die Verschlüsselung, was möglicherweise nicht den Compliance-Anforderungen für die Schlüsselverwaltung entspricht.\",\n\t\t\"es\": \"El bucket OSS no usa claves KMS administradas por el cliente para el cifrado, lo que puede no cumplir con los requisitos de cumplimiento para la gestión de claves.\",\n\t\t\"fr\": \"Le bucket OSS n'utilise pas de clés KMS gérées par le client pour le chiffrement, ce qui peut ne pas répondre aux exigences de conformité pour la gestion des clés.\",\n\t\t\"pt\": \"O bucket OSS não usa chaves KMS gerenciadas pelo cliente para criptografia, o que pode não atender aos requisitos de conformidade para gerenciamento de chaves.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the OSS bucket to use customer-managed KMS keys by setting SSEAlgorithm to KMS and specifying a KMSMasterKeyID in ServerSideEncryptionConfiguration.\",\n\t\t\"zh\": \"通过将 SSEAlgorithm 设置为 KMS 并在 ServerSideEncryptionConfiguration 中指定 KMSMasterKeyID，将 OSS 存储空间配置为使用客户管理的 KMS 密钥。\",\n\t\t\"ja\": \"SSEAlgorithm を KMS に設定し、ServerSideEncryptionConfiguration で KMSMasterKeyID を指定して、OSS バケットをカスタマー管理の KMS キーを使用するように設定します。\",\n\t\t\"de\": \"Konfigurieren Sie den OSS-Bucket so, dass er kundenseitig verwaltete KMS-Schlüssel verwendet, indem Sie SSEAlgorithm auf KMS setzen und eine KMSMasterKeyID in ServerSideEncryptionConfiguration angeben.\",\n\t\t\"es\": \"Configure el bucket OSS para usar claves KMS administradas por el cliente estableciendo SSEAlgorithm en KMS y especificando un KMSMasterKeyID en ServerSideEncryptionConfiguration.\",\n\t\t\"fr\": \"Configurez le bucket OSS pour utiliser des clés KMS gérées par le client en définissant SSEAlgorithm sur KMS et en spécifiant un KMSMasterKeyID dans ServerSideEncryptionConfiguration.\",\n\t\t\"pt\": \"Configure o bucket OSS para usar chaves KMS gerenciadas pelo cliente definindo SSEAlgorithm como KMS e especificando um KMSMasterKeyID em ServerSideEncryptionConfiguration.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tnot uses_byok_encryption(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ServerSideEncryptionConfiguration\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nuses_byok_encryption(resource) if {\n\thelpers.has_property(resource, \"ServerSideEncryptionConfiguration\")\n\tsse_config := resource.Properties.ServerSideEncryptionConfiguration\n\tsse_config.SSEAlgorithm == \"KMS\"\n\tsse_config.KMSMasterKeyID != null\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:oss-zrs-enabled", Name: models.I18nString{"de": "OSS-Bucket zonenredundanter Speicher aktiviert", "en": "OSS Bucket Zone-Redundant Storage Enabled", "es": "Almacenamiento con Redundancia de Zona de Bucket OSS Habilitado", "fr": "Stockage Redondant par Zone de Bucket OSS Activé", "ja": "OSS バケットのゾーン冗長ストレージが有効", "pt": "Armazenamento com Redundância de Zona de Bucket OSS Habilitado", "zh": "OSS 桶启用同城冗余存储"}, Severity: "medium", Description: models.I18nString{"de": "OSS-Buckets sollten zonenredundanten Speicher (ZRS) für hohe Verfügbarkeit und Datenbeständigkeit verwenden.", "en": "OSS buckets should use zone-redundant storage (ZRS) for high availability and data durability.", "es": "Los buckets OSS deben usar almacenamiento con redundancia de zona (ZRS) para alta disponibilidad y durabilidad de datos.", "fr": "Les buckets OSS doivent utiliser le stockage redondant par zone (ZRS) pour une haute disponibilité et une durabilité des données.", "ja": "OSS バケットは、高可用性とデータの耐久性のためにゾーン冗長ストレージ（ZRS）を使用する必要があります。", "pt": "Buckets OSS devem usar armazenamento com redundância de zona (ZRS) para alta disponibilidade e durabilidade de dados.", "zh": "OSS 桶应使用同城冗余存储（ZRS）以实现高可用性和数据持久性。"}, Reason: models.I18nString{"de": "Der OSS-Bucket hat keinen zonenredundanten Speicher aktiviert, was die Datenverfügbarkeit beeinträchtigen kann.", "en": "The OSS bucket does not have zone-redundant storage enabled, which may affect data availability.", "es": "El bucket OSS no tiene almacenamiento con redundancia de zona habilitado, lo que puede afectar la disponibilidad de datos.", "fr": "Le bucket OSS n'a pas le stockage redondant par zone activé, ce qui peut affecter la disponibilité des données.", "ja": "OSS バケットでゾーン冗長ストレージが有効になっていないため、データの可用性に影響を与える可能性があります。", "pt": "O bucket OSS não tem armazenamento com redundância de zona habilitado, o que pode afetar a disponibilidade de dados.", "zh": "OSS 桶未启用同城冗余存储，可能影响数据可用性。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie zonenredundanten Speicher, indem Sie RedundancyType beim Erstellen des Buckets auf 'ZRS' setzen.", "en": "Enable zone-redundant storage by setting RedundancyType to 'ZRS' when creating the bucket.", "es": "Habilite almacenamiento con redundancia de zona estableciendo RedundancyType en 'ZRS' al crear el bucket.", "fr": "Activez le stockage redondant par zone en définissant RedundancyType sur 'ZRS' lors de la création du bucket.", "ja": "バケット作成時に RedundancyType を 'ZRS' に設定して、ゾーン冗長ストレージを有効にします。", "pt": "Habilite armazenamento com redundância de zona definindo RedundancyType como 'ZRS' ao criar o bucket.", "zh": "在创建桶时通过将 RedundancyType 设置为'ZRS'来启用同城冗余存储。"}, ResourceTypes: []string{"ALIYUN::OSS::Bucket"}, FilePath: "aliyun/rules/oss-zrs-enabled.rego", PackageName: "infraguard.rules.aliyun.oss_zrs_enabled", Content: "package infraguard.rules.aliyun.oss_zrs_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"oss-zrs-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OSS Bucket Zone-Redundant Storage Enabled\",\n\t\t\"zh\": \"OSS 桶启用同城冗余存储\",\n\t\t\"ja\": \"OSS バケットのゾーン冗長ストレージが有効\",\n\t\t\"de\": \"OSS-Bucket zonenredundanter Speicher aktiviert\",\n\t\t\"es\": \"Almacenamiento con Redundancia de Zona de Bucket OSS Habilitado\",\n\t\t\"fr\": \"Stockage Redondant par Zone de Bucket OSS Activé\",\n\t\t\"pt\": \"Armazenamento com Redundância de Zona de Bucket OSS Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"OSS buckets should use zone-redundant storage (ZRS) for high availability and data durability.\",\n\t\t\"zh\": \"OSS 桶应使用同城冗余存储（ZRS）以实现高可用性和数据持久性。\",\n\t\t\"ja\": \"OSS バケットは、高可用性とデータの耐久性のためにゾーン冗長ストレージ（ZRS）を使用する必要があります。\",\n\t\t\"de\": \"OSS-Buckets sollten zonenredundanten Speicher (ZRS) für hohe Verfügbarkeit und Datenbeständigkeit verwenden.\",\n\t\t\"es\": \"Los buckets OSS deben usar almacenamiento con redundancia de zona (ZRS) para alta disponibilidad y durabilidad de datos.\",\n\t\t\"fr\": \"Les buckets OSS doivent utiliser le stockage redondant par zone (ZRS) pour une haute disponibilité et une durabilité des données.\",\n\t\t\"pt\": \"Buckets OSS devem usar armazenamento com redundância de zona (ZRS) para alta disponibilidade e durabilidade de dados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The OSS bucket does not have zone-redundant storage enabled, which may affect data availability.\",\n\t\t\"zh\": \"OSS 桶未启用同城冗余存储，可能影响数据可用性。\",\n\t\t\"ja\": \"OSS バケットでゾーン冗長ストレージが有効になっていないため、データの可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Der OSS-Bucket hat keinen zonenredundanten Speicher aktiviert, was die Datenverfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"El bucket OSS no tiene almacenamiento con redundancia de zona habilitado, lo que puede afectar la disponibilidad de datos.\",\n\t\t\"fr\": \"Le bucket OSS n'a pas le stockage redondant par zone activé, ce qui peut affecter la disponibilité des données.\",\n\t\t\"pt\": \"O bucket OSS não tem armazenamento com redundância de zona habilitado, o que pode afetar a disponibilidade de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable zone-redundant storage by setting RedundancyType to 'ZRS' when creating the bucket.\",\n\t\t\"zh\": \"在创建桶时通过将 RedundancyType 设置为'ZRS'来启用同城冗余存储。\",\n\t\t\"ja\": \"バケット作成時に RedundancyType を 'ZRS' に設定して、ゾーン冗長ストレージを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie zonenredundanten Speicher, indem Sie RedundancyType beim Erstellen des Buckets auf 'ZRS' setzen.\",\n\t\t\"es\": \"Habilite almacenamiento con redundancia de zona estableciendo RedundancyType en 'ZRS' al crear el bucket.\",\n\t\t\"fr\": \"Activez le stockage redondant par zone en définissant RedundancyType sur 'ZRS' lors de la création du bucket.\",\n\t\t\"pt\": \"Habilite armazenamento com redundância de zona definindo RedundancyType como 'ZRS' ao criar o bucket.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OSS::Bucket\"]\n}\n\n# Check if bucket has ZRS enabled\nhas_zrs_enabled(resource) if {\n\tredundancy_type := helpers.get_property(resource, \"RedundancyType\", \"LRS\")\n\tredundancy_type == \"ZRS\"\n}\n\n# Deny rule: OSS buckets should have ZRS enabled\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OSS::Bucket\")\n\tnot has_zrs_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"RedundancyType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ots-instance-multi-zone", Name: models.I18nString{"de": "OTS-Instanz Zonenredundanter Speicher", "en": "OTS Instance Zone-Redundant Storage", "es": "Almacenamiento Redundante de Zona de Instancia OTS", "fr": "Stockage Redondant par Zone d'Instance OTS", "ja": "OTS インスタンスゾーン冗長ストレージ", "pt": "Armazenamento Redundante de Zona de Instância OTS", "zh": "使用同城冗余的 OTS 实例"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Tablestore (OTS)-Instanzen zonenredundanten Speicher für Hochverfügbarkeit verwenden.", "en": "Ensures Tablestore (OTS) instances use zone-redundant storage for high availability.", "es": "Garantiza que las instancias Tablestore (OTS) usen almacenamiento redundante de zona para alta disponibilidad.", "fr": "Garantit que les instances Tablestore (OTS) utilisent un stockage redondant par zone pour une haute disponibilité.", "ja": "Tablestore（OTS）インスタンスが高可用性のためにゾーン冗長ストレージを使用することを確認します。", "pt": "Garante que as instâncias Tablestore (OTS) usem armazenamento redundante de zona para alta disponibilidade.", "zh": "确保 Tablestore（OTS）实例使用同城冗余存储以实现高可用性。"}, Reason: models.I18nString{"de": "Zonenredundanter Speicher bietet höhere Verfügbarkeit und schützt vor Zonenebenenausfällen.", "en": "Zone-redundant storage provides higher availability and protects against zone-level failures.", "es": "El almacenamiento redundante de zona proporciona mayor disponibilidad y protege contra fallas a nivel de zona.", "fr": "Le stockage redondant par zone offre une disponibilité plus élevée et protège contre les défaillances au niveau de la zone.", "ja": "ゾーン冗長ストレージは、より高い可用性を提供し、ゾーンレベルの障害から保護します。", "pt": "O armazenamento redundante de zona fornece maior disponibilidade e protege contra falhas no nível de zona.", "zh": "同城冗余存储提供更高的可用性，并防止可用区级别的故障。"}, Recommendation: models.I18nString{"de": "Verwenden Sie zonenredundante Tablestore-Instanzen für kritische Workloads.", "en": "Use zone-redundant Tablestore instances for critical workloads.", "es": "Use instancias Tablestore redundantes de zona para cargas de trabajo críticas.", "fr": "Utilisez des instances Tablestore redondantes par zone pour les charges de travail critiques.", "ja": "重要なワークロードにはゾーン冗長 Tablestore インスタンスを使用します。", "pt": "Use instâncias Tablestore redundantes de zona para cargas de trabalho críticas.", "zh": "为关键工作负载使用同城冗余的 Tablestore 实例。"}, ResourceTypes: []string{"ALIYUN::OTS::Instance"}, FilePath: "aliyun/rules/ots-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.ots_instance_multi_zone", Content: "package infraguard.rules.aliyun.ots_instance_multi_zone\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ots-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OTS Instance Zone-Redundant Storage\",\n\t\t\"zh\": \"使用同城冗余的 OTS 实例\",\n\t\t\"ja\": \"OTS インスタンスゾーン冗長ストレージ\",\n\t\t\"de\": \"OTS-Instanz Zonenredundanter Speicher\",\n\t\t\"es\": \"Almacenamiento Redundante de Zona de Instancia OTS\",\n\t\t\"fr\": \"Stockage Redondant par Zone d'Instance OTS\",\n\t\t\"pt\": \"Armazenamento Redundante de Zona de Instância OTS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Tablestore (OTS) instances use zone-redundant storage for high availability.\",\n\t\t\"zh\": \"确保 Tablestore（OTS）实例使用同城冗余存储以实现高可用性。\",\n\t\t\"ja\": \"Tablestore（OTS）インスタンスが高可用性のためにゾーン冗長ストレージを使用することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Tablestore (OTS)-Instanzen zonenredundanten Speicher für Hochverfügbarkeit verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias Tablestore (OTS) usen almacenamiento redundante de zona para alta disponibilidad.\",\n\t\t\"fr\": \"Garantit que les instances Tablestore (OTS) utilisent un stockage redondant par zone pour une haute disponibilité.\",\n\t\t\"pt\": \"Garante que as instâncias Tablestore (OTS) usem armazenamento redundante de zona para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Zone-redundant storage provides higher availability and protects against zone-level failures.\",\n\t\t\"zh\": \"同城冗余存储提供更高的可用性，并防止可用区级别的故障。\",\n\t\t\"ja\": \"ゾーン冗長ストレージは、より高い可用性を提供し、ゾーンレベルの障害から保護します。\",\n\t\t\"de\": \"Zonenredundanter Speicher bietet höhere Verfügbarkeit und schützt vor Zonenebenenausfällen.\",\n\t\t\"es\": \"El almacenamiento redundante de zona proporciona mayor disponibilidad y protege contra fallas a nivel de zona.\",\n\t\t\"fr\": \"Le stockage redondant par zone offre une disponibilité plus élevée et protège contre les défaillances au niveau de la zone.\",\n\t\t\"pt\": \"O armazenamento redundante de zona fornece maior disponibilidade e protege contra falhas no nível de zona.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use zone-redundant Tablestore instances for critical workloads.\",\n\t\t\"zh\": \"为关键工作负载使用同城冗余的 Tablestore 实例。\",\n\t\t\"ja\": \"重要なワークロードにはゾーン冗長 Tablestore インスタンスを使用します。\",\n\t\t\"de\": \"Verwenden Sie zonenredundante Tablestore-Instanzen für kritische Workloads.\",\n\t\t\"es\": \"Use instancias Tablestore redundantes de zona para cargas de trabajo críticas.\",\n\t\t\"fr\": \"Utilisez des instances Tablestore redondantes par zone pour les charges de travail critiques.\",\n\t\t\"pt\": \"Use instâncias Tablestore redundantes de zona para cargas de trabalho críticas.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OTS::Instance\"]\n}\n\nis_compliant(resource) if {\n\t# Check Network type for zone-redundant configuration\n\t# VPC_CONSIST or VPC with specific settings may indicate zone-redundant\n\tnetwork := helpers.get_property(resource, \"Network\", \"NORMAL\")\n\n\t# NORMAL network type typically uses local redundancy\n\t# VPC_CONSIST indicates zone-redundant storage\n\tnetwork == \"VPC_CONSIST\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OTS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Network\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ots-instance-network-not-normal", Name: models.I18nString{"de": "OTS eingeschränkter Netzwerktyp", "en": "OTS Restricted Network Type", "es": "Tipo de Red Restringido OTS", "fr": "Type de Réseau Restreint OTS", "ja": "OTS 制限ネットワークタイプ", "pt": "Tipo de Rede Restrito OTS", "zh": "OTS 实例限制网络类型"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Table Store (OTS)-Instanzen nicht den 'Normal' (uneingeschränkten) Netzwerktyp verwenden.", "en": "Ensures Table Store (OTS) instances do not use the 'Normal' (unrestricted) network type.", "es": "Garantiza que las instancias de Table Store (OTS) no usen el tipo de red 'Normal' (sin restricciones).", "fr": "Garantit que les instances Table Store (OTS) n'utilisent pas le type de réseau 'Normal' (sans restriction).", "ja": "Table Store（OTS）インスタンスが 'Normal'（無制限）ネットワークタイプを使用していないことを確認します。", "pt": "Garante que as instâncias do Table Store (OTS) não usem o tipo de rede 'Normal' (sem restrições).", "zh": "确保表格存储（OTS）实例未使用 'Normal'（无限制）网络类型。"}, Reason: models.I18nString{"de": "Die Verwendung von VPC- oder gebundenen VPC-Netzwerktypen bietet bessere Isolation als der Normal-Typ.", "en": "Using VPC or bound-VPC network types provides better isolation than the Normal type.", "es": "Usar tipos de red VPC o VPC vinculado proporciona mejor aislamiento que el tipo Normal.", "fr": "L'utilisation de types de réseau VPC ou VPC lié offre une meilleure isolation que le type Normal.", "ja": "VPC またはバインド VPC ネットワークタイプを使用すると、Normal タイプよりも優れた分離が提供されます。", "pt": "Usar tipos de rede VPC ou VPC vinculado fornece melhor isolamento do que o tipo Normal.", "zh": "使用 VPC 或绑定 VPC 网络类型比 Normal 类型提供更好的隔离性。"}, Recommendation: models.I18nString{"de": "Setzen Sie Network für die OTS-Instanz auf 'Vpc' oder 'VpcAndConsole'.", "en": "Set Network to 'Vpc' or 'VpcAndConsole' for the OTS instance.", "es": "Establezca Network en 'Vpc' o 'VpcAndConsole' para la instancia OTS.", "fr": "Définissez Network sur 'Vpc' ou 'VpcAndConsole' pour l'instance OTS.", "ja": "OTS インスタンスの Network を 'Vpc' または 'VpcAndConsole' に設定します。", "pt": "Defina Network como 'Vpc' ou 'VpcAndConsole' para a instância OTS.", "zh": "为 OTS 实例将 Network 设置为 'Vpc' 或 'VpcAndConsole'。"}, ResourceTypes: []string{"ALIYUN::OTS::Instance"}, FilePath: "aliyun/rules/ots-instance-network-not-normal.rego", PackageName: "infraguard.rules.aliyun.ots_instance_network_not_normal", Content: "package infraguard.rules.aliyun.ots_instance_network_not_normal\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ots-instance-network-not-normal\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"OTS Restricted Network Type\",\n\t\t\"zh\": \"OTS 实例限制网络类型\",\n\t\t\"ja\": \"OTS 制限ネットワークタイプ\",\n\t\t\"de\": \"OTS eingeschränkter Netzwerktyp\",\n\t\t\"es\": \"Tipo de Red Restringido OTS\",\n\t\t\"fr\": \"Type de Réseau Restreint OTS\",\n\t\t\"pt\": \"Tipo de Rede Restrito OTS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Table Store (OTS) instances do not use the 'Normal' (unrestricted) network type.\",\n\t\t\"zh\": \"确保表格存储（OTS）实例未使用 'Normal'（无限制）网络类型。\",\n\t\t\"ja\": \"Table Store（OTS）インスタンスが 'Normal'（無制限）ネットワークタイプを使用していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Table Store (OTS)-Instanzen nicht den 'Normal' (uneingeschränkten) Netzwerktyp verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias de Table Store (OTS) no usen el tipo de red 'Normal' (sin restricciones).\",\n\t\t\"fr\": \"Garantit que les instances Table Store (OTS) n'utilisent pas le type de réseau 'Normal' (sans restriction).\",\n\t\t\"pt\": \"Garante que as instâncias do Table Store (OTS) não usem o tipo de rede 'Normal' (sem restrições).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using VPC or bound-VPC network types provides better isolation than the Normal type.\",\n\t\t\"zh\": \"使用 VPC 或绑定 VPC 网络类型比 Normal 类型提供更好的隔离性。\",\n\t\t\"ja\": \"VPC またはバインド VPC ネットワークタイプを使用すると、Normal タイプよりも優れた分離が提供されます。\",\n\t\t\"de\": \"Die Verwendung von VPC- oder gebundenen VPC-Netzwerktypen bietet bessere Isolation als der Normal-Typ.\",\n\t\t\"es\": \"Usar tipos de red VPC o VPC vinculado proporciona mejor aislamiento que el tipo Normal.\",\n\t\t\"fr\": \"L'utilisation de types de réseau VPC ou VPC lié offre une meilleure isolation que le type Normal.\",\n\t\t\"pt\": \"Usar tipos de rede VPC ou VPC vinculado fornece melhor isolamento do que o tipo Normal.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set Network to 'Vpc' or 'VpcAndConsole' for the OTS instance.\",\n\t\t\"zh\": \"为 OTS 实例将 Network 设置为 'Vpc' 或 'VpcAndConsole'。\",\n\t\t\"ja\": \"OTS インスタンスの Network を 'Vpc' または 'VpcAndConsole' に設定します。\",\n\t\t\"de\": \"Setzen Sie Network für die OTS-Instanz auf 'Vpc' oder 'VpcAndConsole'.\",\n\t\t\"es\": \"Establezca Network en 'Vpc' o 'VpcAndConsole' para la instancia OTS.\",\n\t\t\"fr\": \"Définissez Network sur 'Vpc' ou 'VpcAndConsole' pour l'instance OTS.\",\n\t\t\"pt\": \"Defina Network como 'Vpc' ou 'VpcAndConsole' para a instância OTS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::OTS::Instance\"]\n}\n\nis_compliant(resource) if {\n\tnet := helpers.get_property(resource, \"Network\", \"Normal\")\n\tnet != \"Normal\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::OTS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Network\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:pai-eas-instances-multi-zone", Name: models.I18nString{"de": "PAI EAS-Instanz Multi-Zonen-Bereitstellung", "en": "PAI EAS Instance Multi-Zone Deployment", "es": "Implementación Multi-Zona de Instancia PAI EAS", "fr": "Déploiement Multi-Zone d'Instance PAI EAS", "ja": "PAI EAS インスタンスマルチゾーン展開", "pt": "Implantação Multi-Zona de Instância PAI EAS", "zh": "PAI EAS 实例多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass PAI EAS-Instanzen über mehrere Zonen hinweg für hohe Verfügbarkeit bereitgestellt werden.", "en": "Ensures that PAI EAS instances are deployed across multiple zones for high availability.", "es": "Garantiza que las instancias PAI EAS se implementen en múltiples zonas para alta disponibilidad.", "fr": "Garantit que les instances PAI EAS sont déployées sur plusieurs zones pour une haute disponibilité.", "ja": "PAI EAS インスタンスが高可用性のために複数のゾーンに展開されていることを確認します。", "pt": "Garante que as instâncias PAI EAS sejam implantadas em múltiplas zonas para alta disponibilidade.", "zh": "确保 PAI EAS 实例部署在多个可用区以实现高可用性。"}, Reason: models.I18nString{"de": "Multi-Zonen-Bereitstellung gewährleistet die Dienstverfügbarkeit während Ausfällen von Verfügbarkeitszonen.", "en": "Multi-zone deployment ensures service availability during availability zone failures.", "es": "La implementación multi-zona garantiza la disponibilidad del servicio durante fallos de zona de disponibilidad.", "fr": "Le déploiement multi-zone garantit la disponibilité du service pendant les pannes de zone de disponibilité.", "ja": "マルチゾーン展開により、可用性ゾーンの障害中でもサービスの可用性が確保されます。", "pt": "A implantação multi-zona garante a disponibilidade do serviço durante falhas de zona de disponibilidade.", "zh": "多可用区部署可确保在可用区故障期间的服务可用性。"}, Recommendation: models.I18nString{"de": "Stellen Sie PAI EAS-Instanzen in mindestens zwei verschiedenen Verfügbarkeitszonen bereit.", "en": "Deploy PAI EAS instances in at least two different availability zones.", "es": "Implemente instancias PAI EAS en al menos dos zonas de disponibilidad diferentes.", "fr": "Déployez les instances PAI EAS dans au moins deux zones de disponibilité différentes.", "ja": "少なくとも2つの異なる可用性ゾーンに PAI EAS インスタンスを展開します。", "pt": "Implante instâncias PAI EAS em pelo menos duas zonas de disponibilidade diferentes.", "zh": "在至少两个不同的可用区中部署 PAI EAS 实例。"}, ResourceTypes: []string{"ALIYUN::PAI::Service"}, FilePath: "aliyun/rules/pai-eas-instances-multi-zone.rego", PackageName: "infraguard.rules.aliyun.pai_eas_instances_multi_zone", Content: "package infraguard.rules.aliyun.pai_eas_instances_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"pai-eas-instances-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PAI EAS Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"PAI EAS 实例多可用区部署\",\n\t\t\"ja\": \"PAI EAS インスタンスマルチゾーン展開\",\n\t\t\"de\": \"PAI EAS-Instanz Multi-Zonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona de Instancia PAI EAS\",\n\t\t\"fr\": \"Déploiement Multi-Zone d'Instance PAI EAS\",\n\t\t\"pt\": \"Implantação Multi-Zona de Instância PAI EAS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that PAI EAS instances are deployed across multiple zones for high availability.\",\n\t\t\"zh\": \"确保 PAI EAS 实例部署在多个可用区以实现高可用性。\",\n\t\t\"ja\": \"PAI EAS インスタンスが高可用性のために複数のゾーンに展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass PAI EAS-Instanzen über mehrere Zonen hinweg für hohe Verfügbarkeit bereitgestellt werden.\",\n\t\t\"es\": \"Garantiza que las instancias PAI EAS se implementen en múltiples zonas para alta disponibilidad.\",\n\t\t\"fr\": \"Garantit que les instances PAI EAS sont déployées sur plusieurs zones pour une haute disponibilité.\",\n\t\t\"pt\": \"Garante que as instâncias PAI EAS sejam implantadas em múltiplas zonas para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Multi-zone deployment ensures service availability during availability zone failures.\",\n\t\t\"zh\": \"多可用区部署可确保在可用区故障期间的服务可用性。\",\n\t\t\"ja\": \"マルチゾーン展開により、可用性ゾーンの障害中でもサービスの可用性が確保されます。\",\n\t\t\"de\": \"Multi-Zonen-Bereitstellung gewährleistet die Dienstverfügbarkeit während Ausfällen von Verfügbarkeitszonen.\",\n\t\t\"es\": \"La implementación multi-zona garantiza la disponibilidad del servicio durante fallos de zona de disponibilidad.\",\n\t\t\"fr\": \"Le déploiement multi-zone garantit la disponibilité du service pendant les pannes de zone de disponibilité.\",\n\t\t\"pt\": \"A implantação multi-zona garante a disponibilidade do serviço durante falhas de zona de disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy PAI EAS instances in at least two different availability zones.\",\n\t\t\"zh\": \"在至少两个不同的可用区中部署 PAI EAS 实例。\",\n\t\t\"ja\": \"少なくとも2つの異なる可用性ゾーンに PAI EAS インスタンスを展開します。\",\n\t\t\"de\": \"Stellen Sie PAI EAS-Instanzen in mindestens zwei verschiedenen Verfügbarkeitszonen bereit.\",\n\t\t\"es\": \"Implemente instancias PAI EAS en al menos dos zonas de disponibilidad diferentes.\",\n\t\t\"fr\": \"Déployez les instances PAI EAS dans au moins deux zones de disponibilité différentes.\",\n\t\t\"pt\": \"Implante instâncias PAI EAS em pelo menos duas zonas de disponibilidade diferentes.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::PAI::Service\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::PAI::Service\")\n\n\t# Conceptual check for multi-zone deployment\n\tnot helpers.has_property(resource, \"MultiAZ\") # Simplified\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:parameter-sensitive-noecho-check", Name: models.I18nString{"de": "Sensible Parameter müssen NoEcho haben", "en": "Sensitive Parameters Must Have NoEcho", "es": "Los Parámetros Sensibles Deben Tener NoEcho", "fr": "Les Paramètres Sensibles Doivent Avoir NoEcho", "ja": "機密パラメータは NoEcho を持つ必要があります", "pt": "Parâmetros Sensíveis Devem Ter NoEcho", "zh": "敏感参数必须配置 NoEcho"}, Severity: "high", Description: models.I18nString{"de": "Vorlagenparameter, die sensible Informationen (Passwörter, API-Schlüssel, Geheimnisse) enthalten, müssen geschützt werden, indem NoEcho auf true gesetzt oder gültige AssociationProperty-Werte verwendet werden, um zu verhindern, dass sie im Klartext angezeigt werden.", "en": "Template parameters that contain sensitive information (passwords, API keys, secrets) must be protected by either setting NoEcho to true or using valid AssociationProperty values to prevent them from being displayed in plain text.", "es": "Los parámetros de plantilla que contienen información sensible (contraseñas, claves API, secretos) deben protegerse estableciendo NoEcho en true o usando valores válidos de AssociationProperty para evitar que se muestren en texto plano.", "fr": "Les paramètres de modèle qui contiennent des informations sensibles (mots de passe, clés API, secrets) doivent être protégés en définissant NoEcho sur true ou en utilisant des valeurs AssociationProperty valides pour éviter qu'ils ne soient affichés en texte clair.", "ja": "機密情報（パスワード、API キー、シークレットなど）を含むテンプレートパラメータは、NoEcho を true に設定するか、有効な AssociationProperty 値を使用して保護し、プレーンテキストで表示されないようにする必要があります。", "pt": "Parâmetros de template que contêm informações sensíveis (senhas, chaves de API, segredos) devem ser protegidos definindo NoEcho como true ou usando valores válidos de AssociationProperty para evitar que sejam exibidos em texto plano.", "zh": "包含敏感信息（密码、API 密钥、密钥等）的模板参数必须通过设置 NoEcho 为 true 或使用有效的 AssociationProperty 值来保护，以防止以明文形式显示。"}, Reason: models.I18nString{"de": "Sensible Parameter ohne angemessenen Schutz (NoEcho oder gültige AssociationProperty) können in Protokollen, Konsolenausgaben oder API-Antworten offengelegt werden, was zu Sicherheitsrisiken führt.", "en": "Sensitive parameters without proper protection (NoEcho or valid AssociationProperty) may be exposed in logs, console output, or API responses, leading to security risks.", "es": "Los parámetros sensibles sin protección adecuada (NoEcho o AssociationProperty válido) pueden exponerse en registros, salida de consola o respuestas de API, lo que genera riesgos de seguridad.", "fr": "Les paramètres sensibles sans protection adéquate (NoEcho ou AssociationProperty valide) peuvent être exposés dans les journaux, la sortie de la console ou les réponses API, ce qui entraîne des risques de sécurité.", "ja": "適切な保護（NoEcho または有効な AssociationProperty）がない機密パラメータは、ログ、コンソール出力、または API 応答で公開される可能性があり、セキュリティリスクにつながります。", "pt": "Parâmetros sensíveis sem proteção adequada (NoEcho ou AssociationProperty válido) podem ser expostos em logs, saída do console ou respostas de API, levando a riscos de segurança.", "zh": "未正确保护（未设置 NoEcho 或有效的 AssociationProperty）的敏感参数可能在日志、控制台输出或 API 响应中暴露，导致安全风险。"}, Recommendation: models.I18nString{"de": "Für alle sensiblen Parameter (diejenigen, die password, apikey, secret usw. enthalten) setzen Sie entweder NoEcho auf true oder verwenden Sie gültige AssociationProperty-Werte wie ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo oder ALIYUN::DashScope::ApiKey.", "en": "For all sensitive parameters (those containing password, apikey, secret, etc.), either set NoEcho to true or use valid AssociationProperty values such as ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo, or ALIYUN::DashScope::ApiKey.", "es": "Para todos los parámetros sensibles (aquellos que contienen password, apikey, secret, etc.), establezca NoEcho en true o use valores válidos de AssociationProperty como ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo o ALIYUN::DashScope::ApiKey.", "fr": "Pour tous les paramètres sensibles (ceux contenant password, apikey, secret, etc.), définissez NoEcho sur true ou utilisez des valeurs AssociationProperty valides telles que ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo ou ALIYUN::DashScope::ApiKey.", "ja": "すべての機密パラメータ（password、apikey、secret などを含むパラメータ）について、NoEcho を true に設定するか、ALIYUN::ECS::Instance::Password、ALIYUN::Bailian::ApiKey::ApiKeyInfo、または ALIYUN::DashScope::ApiKey などの有効な AssociationProperty 値を使用します。", "pt": "Para todos os parâmetros sensíveis (aqueles que contêm password, apikey, secret, etc.), defina NoEcho como true ou use valores válidos de AssociationProperty como ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo ou ALIYUN::DashScope::ApiKey.", "zh": "为所有敏感参数（包含 password、apikey、secret 等的参数）设置 NoEcho 为 true，或使用有效的 AssociationProperty 值（如 ALIYUN::ECS::Instance::Password、ALIYUN::Bailian::ApiKey::ApiKeyInfo 或 ALIYUN::DashScope::ApiKey）。"}, ResourceTypes: []string{}, FilePath: "aliyun/rules/parameter-sensitive-noecho-check.rego", PackageName: "infraguard.rules.aliyun.parameter_sensitive_noecho_check", Content: "package infraguard.rules.aliyun.parameter_sensitive_noecho_check\n\nimport rego.v1\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"parameter-sensitive-noecho-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Sensitive Parameters Must Have NoEcho\",\n\t\t\"zh\": \"敏感参数必须配置 NoEcho\",\n\t\t\"ja\": \"機密パラメータは NoEcho を持つ必要があります\",\n\t\t\"de\": \"Sensible Parameter müssen NoEcho haben\",\n\t\t\"es\": \"Los Parámetros Sensibles Deben Tener NoEcho\",\n\t\t\"fr\": \"Les Paramètres Sensibles Doivent Avoir NoEcho\",\n\t\t\"pt\": \"Parâmetros Sensíveis Devem Ter NoEcho\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Template parameters that contain sensitive information (passwords, API keys, secrets) must be protected by either setting NoEcho to true or using valid AssociationProperty values to prevent them from being displayed in plain text.\",\n\t\t\"zh\": \"包含敏感信息（密码、API 密钥、密钥等）的模板参数必须通过设置 NoEcho 为 true 或使用有效的 AssociationProperty 值来保护，以防止以明文形式显示。\",\n\t\t\"ja\": \"機密情報（パスワード、API キー、シークレットなど）を含むテンプレートパラメータは、NoEcho を true に設定するか、有効な AssociationProperty 値を使用して保護し、プレーンテキストで表示されないようにする必要があります。\",\n\t\t\"de\": \"Vorlagenparameter, die sensible Informationen (Passwörter, API-Schlüssel, Geheimnisse) enthalten, müssen geschützt werden, indem NoEcho auf true gesetzt oder gültige AssociationProperty-Werte verwendet werden, um zu verhindern, dass sie im Klartext angezeigt werden.\",\n\t\t\"es\": \"Los parámetros de plantilla que contienen información sensible (contraseñas, claves API, secretos) deben protegerse estableciendo NoEcho en true o usando valores válidos de AssociationProperty para evitar que se muestren en texto plano.\",\n\t\t\"fr\": \"Les paramètres de modèle qui contiennent des informations sensibles (mots de passe, clés API, secrets) doivent être protégés en définissant NoEcho sur true ou en utilisant des valeurs AssociationProperty valides pour éviter qu'ils ne soient affichés en texte clair.\",\n\t\t\"pt\": \"Parâmetros de template que contêm informações sensíveis (senhas, chaves de API, segredos) devem ser protegidos definindo NoEcho como true ou usando valores válidos de AssociationProperty para evitar que sejam exibidos em texto plano.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Sensitive parameters without proper protection (NoEcho or valid AssociationProperty) may be exposed in logs, console output, or API responses, leading to security risks.\",\n\t\t\"zh\": \"未正确保护（未设置 NoEcho 或有效的 AssociationProperty）的敏感参数可能在日志、控制台输出或 API 响应中暴露，导致安全风险。\",\n\t\t\"ja\": \"適切な保護（NoEcho または有効な AssociationProperty）がない機密パラメータは、ログ、コンソール出力、または API 応答で公開される可能性があり、セキュリティリスクにつながります。\",\n\t\t\"de\": \"Sensible Parameter ohne angemessenen Schutz (NoEcho oder gültige AssociationProperty) können in Protokollen, Konsolenausgaben oder API-Antworten offengelegt werden, was zu Sicherheitsrisiken führt.\",\n\t\t\"es\": \"Los parámetros sensibles sin protección adecuada (NoEcho o AssociationProperty válido) pueden exponerse en registros, salida de consola o respuestas de API, lo que genera riesgos de seguridad.\",\n\t\t\"fr\": \"Les paramètres sensibles sans protection adéquate (NoEcho ou AssociationProperty valide) peuvent être exposés dans les journaux, la sortie de la console ou les réponses API, ce qui entraîne des risques de sécurité.\",\n\t\t\"pt\": \"Parâmetros sensíveis sem proteção adequada (NoEcho ou AssociationProperty válido) podem ser expostos em logs, saída do console ou respostas de API, levando a riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"For all sensitive parameters (those containing password, apikey, secret, etc.), either set NoEcho to true or use valid AssociationProperty values such as ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo, or ALIYUN::DashScope::ApiKey.\",\n\t\t\"zh\": \"为所有敏感参数（包含 password、apikey、secret 等的参数）设置 NoEcho 为 true，或使用有效的 AssociationProperty 值（如 ALIYUN::ECS::Instance::Password、ALIYUN::Bailian::ApiKey::ApiKeyInfo 或 ALIYUN::DashScope::ApiKey）。\",\n\t\t\"ja\": \"すべての機密パラメータ（password、apikey、secret などを含むパラメータ）について、NoEcho を true に設定するか、ALIYUN::ECS::Instance::Password、ALIYUN::Bailian::ApiKey::ApiKeyInfo、または ALIYUN::DashScope::ApiKey などの有効な AssociationProperty 値を使用します。\",\n\t\t\"de\": \"Für alle sensiblen Parameter (diejenigen, die password, apikey, secret usw. enthalten) setzen Sie entweder NoEcho auf true oder verwenden Sie gültige AssociationProperty-Werte wie ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo oder ALIYUN::DashScope::ApiKey.\",\n\t\t\"es\": \"Para todos los parámetros sensibles (aquellos que contienen password, apikey, secret, etc.), establezca NoEcho en true o use valores válidos de AssociationProperty como ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo o ALIYUN::DashScope::ApiKey.\",\n\t\t\"fr\": \"Pour tous les paramètres sensibles (ceux contenant password, apikey, secret, etc.), définissez NoEcho sur true ou utilisez des valeurs AssociationProperty valides telles que ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo ou ALIYUN::DashScope::ApiKey.\",\n\t\t\"pt\": \"Para todos os parâmetros sensíveis (aqueles que contêm password, apikey, secret, etc.), defina NoEcho como true ou use valores válidos de AssociationProperty como ALIYUN::ECS::Instance::Password, ALIYUN::Bailian::ApiKey::ApiKeyInfo ou ALIYUN::DashScope::ApiKey.\"\n\t},\n\t\"resource_types\": []\n}\n\n# Sensitive keywords to detect in parameter names\nsensitive_keywords := [\n\t\"password\",\n\t\"passwd\",\n\t\"pwd\",\n\t\"secret\",\n\t\"apikey\",\n\t\"api_key\",\n\t\"accesskey\",\n\t\"access_key\",\n\t\"secretkey\",\n\t\"secret_key\",\n\t\"token\",\n\t\"credential\",\n\t\"privatekey\",\n\t\"private_key\",\n]\n\n# Check if a parameter name contains sensitive keywords (case-insensitive)\nis_sensitive_parameter(param_name) if {\n\tsome keyword in sensitive_keywords\n\tcontains(lower(param_name), lower(keyword))\n}\n\n# Valid AssociationProperty values for sensitive parameters\nvalid_association_properties := [\n\t\"ALIYUN::ECS::Instance::Password\",\n\t\"ALIYUN::Bailian::ApiKey::ApiKeyInfo\",\n\t\"ALIYUN::DashScope::ApiKey\",\n]\n\n# Check if a parameter has NoEcho set to true\nhas_noecho(param_def) if {\n\tobject.get(param_def, \"NoEcho\", false) == true\n}\n\nhas_noecho(param_def) if {\n\tobject.get(param_def, \"NoEcho\", false) == \"true\"\n}\n\n# Check if a parameter has valid AssociationProperty\nhas_valid_association_property(param_def) if {\n\tassoc_prop := object.get(param_def, \"AssociationProperty\", \"\")\n\tassoc_prop in valid_association_properties\n}\n\n# Check if a sensitive parameter is properly protected\n# A parameter is protected if it meets any of the following conditions:\n# 1. NoEcho is set to true\n# 2. AssociationProperty is one of the valid values\nis_protected_parameter(param_def) if {\n\thas_noecho(param_def)\n}\n\nis_protected_parameter(param_def) if {\n\thas_valid_association_property(param_def)\n}\n\n# Check template Parameters\ndeny contains result if {\n\t# Check if Parameters exist in input\n\tinput.Parameters != null\n\n\t# Iterate through all parameters\n\tsome param_name, param_def in input.Parameters\n\n\t# Check if parameter is sensitive\n\tis_sensitive_parameter(param_name)\n\n\t# Check if parameter is not properly protected\n\tnot is_protected_parameter(param_def)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": \"\",\n\t\t\"violation_path\": [\"Parameters\", param_name],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-cluster-default-time-zone-not-system", Name: models.I18nString{"de": "PolarDB-Cluster Standard-Zeitzone nicht System", "en": "PolarDB Cluster Default Time Zone Not System", "es": "Zona Horaria Predeterminada del Clúster PolarDB No es Sistema", "fr": "Fuseau Horaire par Défaut du Cluster PolarDB N'est Pas Système", "ja": "PolarDB クラスタデフォルトタイムゾーンがシステムではない", "pt": "Fuso Horário Padrão do Cluster PolarDB Não é Sistema", "zh": "PolarDB 集群默认时区参数值非 SYSTEM"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die Standard-Zeitzone des PolarDB-Clusters nicht auf SYSTEM gesetzt ist.", "en": "Ensures PolarDB cluster default time zone is not set to SYSTEM.", "es": "Garantiza que la zona horaria predeterminada del clúster PolarDB no esté establecida en SYSTEM.", "fr": "Garantit que le fuseau horaire par défaut du cluster PolarDB n'est pas défini sur SYSTEM.", "ja": "PolarDB クラスタのデフォルトタイムゾーンが SYSTEM に設定されていないことを確認します。", "pt": "Garante que o fuso horário padrão do cluster PolarDB não esteja definido como SYSTEM.", "zh": "确保 PolarDB 集群的默认时区参数值不等于 SYSTEM。"}, Reason: models.I18nString{"de": "Die Verwendung einer expliziten Zeitzone gewährleistet eine konsistente Zeitkonfiguration.", "en": "Using explicit timezone ensures consistent time configuration.", "es": "Usar una zona horaria explícita garantiza una configuración de tiempo consistente.", "fr": "L'utilisation d'un fuseau horaire explicite garantit une configuration de temps cohérente.", "ja": "明示的なタイムゾーンを使用することで、一貫した時間設定が確保されます。", "pt": "Usar fuso horário explícito garante configuração de tempo consistente.", "zh": "使用明确的时区确保时间配置一致。"}, Recommendation: models.I18nString{"de": "Setzen Sie eine explizite Zeitzone für den PolarDB-Cluster.", "en": "Set an explicit timezone for the PolarDB cluster.", "es": "Establezca una zona horaria explícita para el clúster PolarDB.", "fr": "Définissez un fuseau horaire explicite pour le cluster PolarDB.", "ja": "PolarDB クラスタに明示的なタイムゾーンを設定します。", "pt": "Defina um fuso horário explícito para o cluster PolarDB.", "zh": "为 PolarDB 集群设置明确的时区。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-cluster-default-time-zone-not-system.rego", PackageName: "infraguard.rules.aliyun.polardb_cluster_default_time_zone_not_system", Content: "package infraguard.rules.aliyun.polardb_cluster_default_time_zone_not_system\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"polardb-cluster-default-time-zone-not-system\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Cluster Default Time Zone Not System\",\n\t\t\"zh\": \"PolarDB 集群默认时区参数值非 SYSTEM\",\n\t\t\"ja\": \"PolarDB クラスタデフォルトタイムゾーンがシステムではない\",\n\t\t\"de\": \"PolarDB-Cluster Standard-Zeitzone nicht System\",\n\t\t\"es\": \"Zona Horaria Predeterminada del Clúster PolarDB No es Sistema\",\n\t\t\"fr\": \"Fuseau Horaire par Défaut du Cluster PolarDB N'est Pas Système\",\n\t\t\"pt\": \"Fuso Horário Padrão do Cluster PolarDB Não é Sistema\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures PolarDB cluster default time zone is not set to SYSTEM.\",\n\t\t\"zh\": \"确保 PolarDB 集群的默认时区参数值不等于 SYSTEM。\",\n\t\t\"ja\": \"PolarDB クラスタのデフォルトタイムゾーンが SYSTEM に設定されていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Standard-Zeitzone des PolarDB-Clusters nicht auf SYSTEM gesetzt ist.\",\n\t\t\"es\": \"Garantiza que la zona horaria predeterminada del clúster PolarDB no esté establecida en SYSTEM.\",\n\t\t\"fr\": \"Garantit que le fuseau horaire par défaut du cluster PolarDB n'est pas défini sur SYSTEM.\",\n\t\t\"pt\": \"Garante que o fuso horário padrão do cluster PolarDB não esteja definido como SYSTEM.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using explicit timezone ensures consistent time configuration.\",\n\t\t\"zh\": \"使用明确的时区确保时间配置一致。\",\n\t\t\"ja\": \"明示的なタイムゾーンを使用することで、一貫した時間設定が確保されます。\",\n\t\t\"de\": \"Die Verwendung einer expliziten Zeitzone gewährleistet eine konsistente Zeitkonfiguration.\",\n\t\t\"es\": \"Usar una zona horaria explícita garantiza una configuración de tiempo consistente.\",\n\t\t\"fr\": \"L'utilisation d'un fuseau horaire explicite garantit une configuration de temps cohérente.\",\n\t\t\"pt\": \"Usar fuso horário explícito garante configuração de tempo consistente.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set an explicit timezone for the PolarDB cluster.\",\n\t\t\"zh\": \"为 PolarDB 集群设置明确的时区。\",\n\t\t\"ja\": \"PolarDB クラスタに明示的なタイムゾーンを設定します。\",\n\t\t\"de\": \"Setzen Sie eine explizite Zeitzone für den PolarDB-Cluster.\",\n\t\t\"es\": \"Establezca una zona horaria explícita para el clúster PolarDB.\",\n\t\t\"fr\": \"Définissez un fuseau horaire explicite pour le cluster PolarDB.\",\n\t\t\"pt\": \"Defina um fuso horário explícito para o cluster PolarDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\nis_compliant(resource) if {\n\tdb_cluster_params := helpers.get_property(resource, \"DBClusterParameters\", {})\n\tparams_json := db_cluster_params.Parameters\n\tis_string(params_json)\n\tparams_json != \"\"\n\tparams := json.unmarshal(params_json)\n\tdefault_time_zone := params.default_time_zone\n\tdefault_time_zone != null\n\tdefault_time_zone != \"SYSTEM\"\n}\n\nis_compliant(resource) if {\n\tdb_cluster_params := helpers.get_property(resource, \"DBClusterParameters\", {})\n\tdb_cluster_params == {}\n}\n\nis_compliant(resource) if {\n\tdb_cluster_params := helpers.get_property(resource, \"DBClusterParameters\", {})\n\tdb_cluster_params != {}\n\tdb_cluster_params.Parameters == null\n}\n\nis_compliant(resource) if {\n\tdb_cluster_params := helpers.get_property(resource, \"DBClusterParameters\", {})\n\tparams_json := db_cluster_params.Parameters\n\tis_string(params_json)\n\tparams_json == \"\"\n}\n\nis_compliant(resource) if {\n\tdb_cluster_params := helpers.get_property(resource, \"DBClusterParameters\", {})\n\tparams_json := db_cluster_params.Parameters\n\tis_string(params_json)\n\tparams_json != \"\"\n\tparams := json.unmarshal(params_json)\n\tparams.default_time_zone == null\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DBClusterParameters\", \"Parameters\", \"default_time_zone\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-cluster-delete-protection-enabled", Name: models.I18nString{"de": "PolarDB-Cluster-Löschschutz aktiviert", "en": "PolarDB Cluster Deletion Protection Enabled", "es": "Protección contra Eliminación de Cluster PolarDB Habilitada", "fr": "Protection contre la Suppression du Cluster PolarDB Activée", "ja": "PolarDB クラスタの削除保護が有効", "pt": "Proteção contra Exclusão de Cluster PolarDB Habilitada", "zh": "PolarDB 集群开启删除保护"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass PolarDB-Cluster den Löschschutz aktiviert haben.", "en": "Ensures that PolarDB clusters have deletion protection enabled.", "es": "Garantiza que los clústeres PolarDB tengan protección contra eliminación habilitada.", "fr": "Garantit que les clusters PolarDB ont la protection contre la suppression activée.", "ja": "PolarDB クラスタで削除保護が有効になっていることを確認します。", "pt": "Garante que os clusters PolarDB tenham proteção contra exclusão habilitada.", "zh": "确保 PolarDB 集群开启了删除保护。"}, Reason: models.I18nString{"de": "Wenn der Löschschutz nicht aktiviert ist, kann der PolarDB-Cluster versehentlich freigegeben werden, was zu Datenverlust führt.", "en": "If deletion protection is not enabled, the PolarDB cluster may be released accidentally, causing data loss.", "es": "Si la protección contra eliminación no está habilitada, el clúster PolarDB puede ser liberado accidentalmente, causando pérdida de datos.", "fr": "Si la protection contre la suppression n'est pas activée, le cluster PolarDB peut être libéré accidentellement, causant une perte de données.", "ja": "削除保護が有効になっていない場合、PolarDB クラスタが誤って解放され、データ損失が発生する可能性があります。", "pt": "Se a proteção contra exclusão não estiver habilitada, o cluster PolarDB pode ser liberado acidentalmente, causando perda de dados.", "zh": "如果未开启删除保护，PolarDB 集群可能会被意外释放，导致数据丢失。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für den PolarDB-Cluster.", "en": "Enable deletion protection for the PolarDB cluster.", "es": "Habilite protección contra eliminación para el clúster PolarDB.", "fr": "Activez la protection contre la suppression pour le cluster PolarDB.", "ja": "PolarDB クラスタで削除保護を有効にします。", "pt": "Habilite proteção contra exclusão para o cluster PolarDB.", "zh": "为 PolarDB 集群开启删除保护功能。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-cluster-delete-protection-enabled.rego", PackageName: "infraguard.rules.aliyun.polardb_cluster_delete_protection_enabled", Content: "package infraguard.rules.aliyun.polardb_cluster_delete_protection_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"polardb-cluster-delete-protection-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Cluster Deletion Protection Enabled\",\n\t\t\"zh\": \"PolarDB 集群开启删除保护\",\n\t\t\"ja\": \"PolarDB クラスタの削除保護が有効\",\n\t\t\"de\": \"PolarDB-Cluster-Löschschutz aktiviert\",\n\t\t\"es\": \"Protección contra Eliminación de Cluster PolarDB Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression du Cluster PolarDB Activée\",\n\t\t\"pt\": \"Proteção contra Exclusão de Cluster PolarDB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that PolarDB clusters have deletion protection enabled.\",\n\t\t\"zh\": \"确保 PolarDB 集群开启了删除保护。\",\n\t\t\"ja\": \"PolarDB クラスタで削除保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass PolarDB-Cluster den Löschschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los clústeres PolarDB tengan protección contra eliminación habilitada.\",\n\t\t\"fr\": \"Garantit que les clusters PolarDB ont la protection contre la suppression activée.\",\n\t\t\"pt\": \"Garante que os clusters PolarDB tenham proteção contra exclusão habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If deletion protection is not enabled, the PolarDB cluster may be released accidentally, causing data loss.\",\n\t\t\"zh\": \"如果未开启删除保护，PolarDB 集群可能会被意外释放，导致数据丢失。\",\n\t\t\"ja\": \"削除保護が有効になっていない場合、PolarDB クラスタが誤って解放され、データ損失が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Löschschutz nicht aktiviert ist, kann der PolarDB-Cluster versehentlich freigegeben werden, was zu Datenverlust führt.\",\n\t\t\"es\": \"Si la protección contra eliminación no está habilitada, el clúster PolarDB puede ser liberado accidentalmente, causando pérdida de datos.\",\n\t\t\"fr\": \"Si la protection contre la suppression n'est pas activée, le cluster PolarDB peut être libéré accidentellement, causant une perte de données.\",\n\t\t\"pt\": \"Se a proteção contra exclusão não estiver habilitada, o cluster PolarDB pode ser liberado acidentalmente, causando perda de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for the PolarDB cluster.\",\n\t\t\"zh\": \"为 PolarDB 集群开启删除保护功能。\",\n\t\t\"ja\": \"PolarDB クラスタで削除保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für den PolarDB-Cluster.\",\n\t\t\"es\": \"Habilite protección contra eliminación para el clúster PolarDB.\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour le cluster PolarDB.\",\n\t\t\"pt\": \"Habilite proteção contra exclusão para o cluster PolarDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-cluster-enabled-ssl", Name: models.I18nString{"de": "PolarDB-Cluster SSL aktiviert", "en": "PolarDB Cluster SSL Enabled", "es": "SSL de Cluster PolarDB Habilitado", "fr": "SSL du Cluster PolarDB Activé", "ja": "PolarDB クラスタで SSL が有効", "pt": "SSL de Cluster PolarDB Habilitado", "zh": "PolarDB 集群开启 SSL 加密"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass PolarDB-Cluster SSL-Verschlüsselung aktiviert haben.", "en": "Ensures PolarDB clusters have SSL encryption enabled.", "es": "Garantiza que los clústeres PolarDB tengan cifrado SSL habilitado.", "fr": "Garantit que les clusters PolarDB ont le chiffrement SSL activé.", "ja": "PolarDB クラスタで SSL 暗号化が有効になっていることを確認します。", "pt": "Garante que os clusters PolarDB tenham criptografia SSL habilitada.", "zh": "确保 PolarDB 集群开启了 SSL 加密。"}, Reason: models.I18nString{"de": "SSL-Verschlüsselung sichert die Kommunikation zwischen Anwendungen und dem Datenbankcluster.", "en": "SSL encryption secures the communication between applications and the database cluster.", "es": "El cifrado SSL protege la comunicación entre aplicaciones y el clúster de base de datos.", "fr": "Le chiffrement SSL sécurise la communication entre les applications et le cluster de base de données.", "ja": "SSL 暗号化により、アプリケーションとデータベースクラスタ間の通信が保護されます。", "pt": "A criptografia SSL protege a comunicação entre aplicações e o cluster de banco de dados.", "zh": "SSL 加密保障了应用程序与数据库集群之间的通信安全。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie SSL für den PolarDB-Cluster.", "en": "Enable SSL for the PolarDB cluster.", "es": "Habilite SSL para el clúster PolarDB.", "fr": "Activez SSL pour le cluster PolarDB.", "ja": "PolarDB クラスタで SSL を有効にします。", "pt": "Habilite SSL para o cluster PolarDB.", "zh": "为 PolarDB 集群开启 SSL 加密。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-cluster-enabled-ssl.rego", PackageName: "infraguard.rules.aliyun.polardb_cluster_enabled_ssl", Content: "package infraguard.rules.aliyun.polardb_cluster_enabled_ssl\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"polardb-cluster-enabled-ssl\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Cluster SSL Enabled\",\n\t\t\"zh\": \"PolarDB 集群开启 SSL 加密\",\n\t\t\"ja\": \"PolarDB クラスタで SSL が有効\",\n\t\t\"de\": \"PolarDB-Cluster SSL aktiviert\",\n\t\t\"es\": \"SSL de Cluster PolarDB Habilitado\",\n\t\t\"fr\": \"SSL du Cluster PolarDB Activé\",\n\t\t\"pt\": \"SSL de Cluster PolarDB Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures PolarDB clusters have SSL encryption enabled.\",\n\t\t\"zh\": \"确保 PolarDB 集群开启了 SSL 加密。\",\n\t\t\"ja\": \"PolarDB クラスタで SSL 暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass PolarDB-Cluster SSL-Verschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los clústeres PolarDB tengan cifrado SSL habilitado.\",\n\t\t\"fr\": \"Garantit que les clusters PolarDB ont le chiffrement SSL activé.\",\n\t\t\"pt\": \"Garante que os clusters PolarDB tenham criptografia SSL habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"SSL encryption secures the communication between applications and the database cluster.\",\n\t\t\"zh\": \"SSL 加密保障了应用程序与数据库集群之间的通信安全。\",\n\t\t\"ja\": \"SSL 暗号化により、アプリケーションとデータベースクラスタ間の通信が保護されます。\",\n\t\t\"de\": \"SSL-Verschlüsselung sichert die Kommunikation zwischen Anwendungen und dem Datenbankcluster.\",\n\t\t\"es\": \"El cifrado SSL protege la comunicación entre aplicaciones y el clúster de base de datos.\",\n\t\t\"fr\": \"Le chiffrement SSL sécurise la communication entre les applications et le cluster de base de données.\",\n\t\t\"pt\": \"A criptografia SSL protege a comunicação entre aplicações e o cluster de banco de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable SSL for the PolarDB cluster.\",\n\t\t\"zh\": \"为 PolarDB 集群开启 SSL 加密。\",\n\t\t\"ja\": \"PolarDB クラスタで SSL を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie SSL für den PolarDB-Cluster.\",\n\t\t\"es\": \"Habilite SSL para el clúster PolarDB.\",\n\t\t\"fr\": \"Activez SSL pour le cluster PolarDB.\",\n\t\t\"pt\": \"Habilite SSL para o cluster PolarDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\nis_compliant(resource) if {\n\tssl := helpers.get_property(resource, \"SSLEnabled\", \"Disable\")\n\tssl == \"Enable\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SSLEnabled\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-cluster-enabled-tde", Name: models.I18nString{"de": "PolarDB-Cluster TDE aktiviert", "en": "PolarDB Cluster TDE Enabled", "es": "TDE de Cluster PolarDB Habilitado", "fr": "TDE du Cluster PolarDB Activé", "ja": "PolarDB クラスタで TDE が有効", "pt": "TDE de Cluster PolarDB Habilitado", "zh": "PolarDB 集群开启 TDE"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass PolarDB-Cluster Transparent Data Encryption (TDE) aktiviert haben.", "en": "Ensures PolarDB clusters have Transparent Data Encryption (TDE) enabled.", "es": "Garantiza que los clústeres PolarDB tengan Transparent Data Encryption (TDE) habilitado.", "fr": "Garantit que les clusters PolarDB ont Transparent Data Encryption (TDE) activé.", "ja": "PolarDB クラスタで透過的データ暗号化（TDE）が有効になっていることを確認します。", "pt": "Garante que os clusters PolarDB tenham Transparent Data Encryption (TDE) habilitado.", "zh": "确保 PolarDB 集群开启了透明数据加密（TDE）。"}, Reason: models.I18nString{"de": "TDE bietet Verschlüsselung ruhender Daten für sensible Daten, die in der Datenbank gespeichert sind.", "en": "TDE provides data-at-rest encryption for sensitive data stored in the database.", "es": "TDE proporciona cifrado de datos en reposo para datos sensibles almacenados en la base de datos.", "fr": "TDE fournit le chiffrement des données au repos pour les données sensibles stockées dans la base de données.", "ja": "TDE は、データベースに保存されている機密データに対して保存データ暗号化を提供します。", "pt": "O TDE fornece criptografia de dados em repouso para dados sensíveis armazenados no banco de dados.", "zh": "TDE 为存储在数据库中的敏感数据提供静态数据加密。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie TDE für den PolarDB-Cluster.", "en": "Enable TDE for the PolarDB cluster.", "es": "Habilite TDE para el clúster PolarDB.", "fr": "Activez TDE pour le cluster PolarDB.", "ja": "PolarDB クラスタで TDE を有効にします。", "pt": "Habilite TDE para o cluster PolarDB.", "zh": "为 PolarDB 集群开启 TDE。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-cluster-enabled-tde.rego", PackageName: "infraguard.rules.aliyun.polardb_cluster_enabled_tde", Content: "package infraguard.rules.aliyun.polardb_cluster_enabled_tde\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"polardb-cluster-enabled-tde\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Cluster TDE Enabled\",\n\t\t\"zh\": \"PolarDB 集群开启 TDE\",\n\t\t\"ja\": \"PolarDB クラスタで TDE が有効\",\n\t\t\"de\": \"PolarDB-Cluster TDE aktiviert\",\n\t\t\"es\": \"TDE de Cluster PolarDB Habilitado\",\n\t\t\"fr\": \"TDE du Cluster PolarDB Activé\",\n\t\t\"pt\": \"TDE de Cluster PolarDB Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures PolarDB clusters have Transparent Data Encryption (TDE) enabled.\",\n\t\t\"zh\": \"确保 PolarDB 集群开启了透明数据加密（TDE）。\",\n\t\t\"ja\": \"PolarDB クラスタで透過的データ暗号化（TDE）が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass PolarDB-Cluster Transparent Data Encryption (TDE) aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los clústeres PolarDB tengan Transparent Data Encryption (TDE) habilitado.\",\n\t\t\"fr\": \"Garantit que les clusters PolarDB ont Transparent Data Encryption (TDE) activé.\",\n\t\t\"pt\": \"Garante que os clusters PolarDB tenham Transparent Data Encryption (TDE) habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"TDE provides data-at-rest encryption for sensitive data stored in the database.\",\n\t\t\"zh\": \"TDE 为存储在数据库中的敏感数据提供静态数据加密。\",\n\t\t\"ja\": \"TDE は、データベースに保存されている機密データに対して保存データ暗号化を提供します。\",\n\t\t\"de\": \"TDE bietet Verschlüsselung ruhender Daten für sensible Daten, die in der Datenbank gespeichert sind.\",\n\t\t\"es\": \"TDE proporciona cifrado de datos en reposo para datos sensibles almacenados en la base de datos.\",\n\t\t\"fr\": \"TDE fournit le chiffrement des données au repos pour les données sensibles stockées dans la base de données.\",\n\t\t\"pt\": \"O TDE fornece criptografia de dados em repouso para dados sensíveis armazenados no banco de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable TDE for the PolarDB cluster.\",\n\t\t\"zh\": \"为 PolarDB 集群开启 TDE。\",\n\t\t\"ja\": \"PolarDB クラスタで TDE を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie TDE für den PolarDB-Cluster.\",\n\t\t\"es\": \"Habilite TDE para el clúster PolarDB.\",\n\t\t\"fr\": \"Activez TDE pour le cluster PolarDB.\",\n\t\t\"pt\": \"Habilite TDE para o cluster PolarDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"TDEStatus\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TDEStatus\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-cluster-expired-check", Name: models.I18nString{"de": "PolarDB-Cluster Ablaufprüfung", "en": "PolarDB Cluster Expiration Check", "es": "Verificación de Expiración de Cluster PolarDB", "fr": "Vérification d'Expiration du Cluster PolarDB", "ja": "PolarDB クラスタの有効期限チェック", "pt": "Verificação de Expiração de Cluster PolarDB", "zh": "PolarDB 集群到期检查"}, Severity: "high", Description: models.I18nString{"de": "Vorausbezahlte PolarDB-Cluster sollten automatische Verlängerung aktiviert haben.", "en": "Prepaid PolarDB clusters should have auto-renewal enabled.", "es": "Los clústeres PolarDB prepagos deben tener renovación automática habilitada.", "fr": "Les clusters PolarDB prépayés doivent avoir le renouvellement automatique activé.", "ja": "プリペイド PolarDB クラスタは自動更新を有効にする必要があります。", "pt": "Clusters PolarDB pré-pagos devem ter renovação automática habilitada.", "zh": "预付费 PolarDB 集群应开启自动续费，避免业务中断。"}, Reason: models.I18nString{"de": "Der vorausbezahlte PolarDB-Cluster hat keine automatische Verlängerung aktiviert.", "en": "The prepaid PolarDB cluster does not have auto-renewal enabled.", "es": "El clúster PolarDB prepago no tiene renovación automática habilitada.", "fr": "Le cluster PolarDB prépayé n'a pas le renouvellement automatique activé.", "ja": "プリペイド PolarDB クラスタで自動更新が有効になっていません。", "pt": "O cluster PolarDB pré-pago não tem renovação automática habilitada.", "zh": "预付费 PolarDB 集群未开启自动续费。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Verlängerung für den vorausbezahlten PolarDB-Cluster, indem Sie RenewalStatus auf AutoRenewal setzen.", "en": "Enable auto-renewal for the prepaid PolarDB cluster by setting RenewalStatus to AutoRenewal.", "es": "Habilite la renovación automática para el clúster PolarDB prepago estableciendo RenewalStatus en AutoRenewal.", "fr": "Activez le renouvellement automatique pour le cluster PolarDB prépayé en définissant RenewalStatus sur AutoRenewal.", "ja": "RenewalStatus を AutoRenewal に設定して、プリペイド PolarDB クラスタで自動更新を有効にします。", "pt": "Habilite renovação automática para o cluster PolarDB pré-pago definindo RenewalStatus como AutoRenewal.", "zh": "通过将 RenewalStatus 设置为 AutoRenewal 为预付费 PolarDB 集群开启自动续费。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-cluster-expired-check.rego", PackageName: "infraguard.rules.aliyun.polardb_cluster_expired_check", Content: "package infraguard.rules.aliyun.polardb_cluster_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"polardb-cluster-expired-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Cluster Expiration Check\",\n\t\t\"zh\": \"PolarDB 集群到期检查\",\n\t\t\"ja\": \"PolarDB クラスタの有効期限チェック\",\n\t\t\"de\": \"PolarDB-Cluster Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Cluster PolarDB\",\n\t\t\"fr\": \"Vérification d'Expiration du Cluster PolarDB\",\n\t\t\"pt\": \"Verificação de Expiração de Cluster PolarDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Prepaid PolarDB clusters should have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 PolarDB 集群应开启自动续费，避免业务中断。\",\n\t\t\"ja\": \"プリペイド PolarDB クラスタは自動更新を有効にする必要があります。\",\n\t\t\"de\": \"Vorausbezahlte PolarDB-Cluster sollten automatische Verlängerung aktiviert haben.\",\n\t\t\"es\": \"Los clústeres PolarDB prepagos deben tener renovación automática habilitada.\",\n\t\t\"fr\": \"Les clusters PolarDB prépayés doivent avoir le renouvellement automatique activé.\",\n\t\t\"pt\": \"Clusters PolarDB pré-pagos devem ter renovação automática habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The prepaid PolarDB cluster does not have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 PolarDB 集群未开启自动续费。\",\n\t\t\"ja\": \"プリペイド PolarDB クラスタで自動更新が有効になっていません。\",\n\t\t\"de\": \"Der vorausbezahlte PolarDB-Cluster hat keine automatische Verlängerung aktiviert.\",\n\t\t\"es\": \"El clúster PolarDB prepago no tiene renovación automática habilitada.\",\n\t\t\"fr\": \"Le cluster PolarDB prépayé n'a pas le renouvellement automatique activé.\",\n\t\t\"pt\": \"O cluster PolarDB pré-pago não tem renovação automática habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for the prepaid PolarDB cluster by setting RenewalStatus to AutoRenewal.\",\n\t\t\"zh\": \"通过将 RenewalStatus 设置为 AutoRenewal 为预付费 PolarDB 集群开启自动续费。\",\n\t\t\"ja\": \"RenewalStatus を AutoRenewal に設定して、プリペイド PolarDB クラスタで自動更新を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die automatische Verlängerung für den vorausbezahlten PolarDB-Cluster, indem Sie RenewalStatus auf AutoRenewal setzen.\",\n\t\t\"es\": \"Habilite la renovación automática para el clúster PolarDB prepago estableciendo RenewalStatus en AutoRenewal.\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour le cluster PolarDB prépayé en définissant RenewalStatus sur AutoRenewal.\",\n\t\t\"pt\": \"Habilite renovação automática para o cluster PolarDB pré-pago definindo RenewalStatus como AutoRenewal.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\nis_prepaid(resource) if {\n\thelpers.get_property(resource, \"PayType\", \"Postpaid\") == \"Prepaid\"\n}\n\nis_auto_renew_enabled(resource) if {\n\tstatus := helpers.get_property(resource, \"RenewalStatus\", \"Normal\")\n\tstatus == \"AutoRenewal\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tis_prepaid(resource)\n\tnot is_auto_renew_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"RenewalStatus\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-cluster-maintain-time-check", Name: models.I18nString{"de": "PolarDB-Cluster Wartungsfenster-Prüfung", "en": "PolarDB Cluster Maintenance Window Check", "es": "Verificación de Ventana de Mantenimiento de Cluster PolarDB", "fr": "Vérification de la Fenêtre de Maintenance du Cluster PolarDB", "ja": "PolarDB クラスタのメンテナンスウィンドウチェック", "pt": "Verificação de Janela de Manutenção de Cluster PolarDB", "zh": "PolarDB 集群维护时间检测"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass der PolarDB-Cluster ein Wartungsfenster konfiguriert hat.", "en": "Ensures that the PolarDB cluster has a maintenance window configured.", "es": "Garantiza que el clúster PolarDB tenga una ventana de mantenimiento configurada.", "fr": "Garantit que le cluster PolarDB a une fenêtre de maintenance configurée.", "ja": "PolarDB クラスタにメンテナンスウィンドウが設定されていることを確認します。", "pt": "Garante que o cluster PolarDB tenha uma janela de manutenção configurada.", "zh": "确保 PolarDB 集群配置了维护时间段。"}, Reason: models.I18nString{"de": "Die Konfiguration eines Wartungsfensters ermöglicht geplante Wartung während der Nebenzeiten.", "en": "Configuring a maintenance window allows for planned maintenance during off-peak hours.", "es": "Configurar una ventana de mantenimiento permite realizar mantenimiento planificado durante las horas de menor actividad.", "fr": "Configurer une fenêtre de maintenance permet d'effectuer une maintenance planifiée pendant les heures creuses.", "ja": "メンテナンスウィンドウを設定することで、オフピーク時間帯に計画的なメンテナンスを行うことができます。", "pt": "Configurar uma janela de manutenção permite manutenção planejada durante horários de baixa demanda.", "zh": "配置维护时间段允许在非高峰时段进行计划内维护。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie ein Wartungsfenster für den PolarDB-Cluster.", "en": "Configure a maintenance window for the PolarDB cluster.", "es": "Configure una ventana de mantenimiento para el clúster PolarDB.", "fr": "Configurez une fenêtre de maintenance pour le cluster PolarDB.", "ja": "PolarDB クラスタにメンテナンスウィンドウを設定します。", "pt": "Configure uma janela de manutenção para o cluster PolarDB.", "zh": "为 PolarDB 集群配置维护时间段。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-cluster-maintain-time-check.rego", PackageName: "infraguard.rules.aliyun.polardb_cluster_maintain_time_check", Content: "package infraguard.rules.aliyun.polardb_cluster_maintain_time_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"polardb-cluster-maintain-time-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Cluster Maintenance Window Check\",\n\t\t\"zh\": \"PolarDB 集群维护时间检测\",\n\t\t\"ja\": \"PolarDB クラスタのメンテナンスウィンドウチェック\",\n\t\t\"de\": \"PolarDB-Cluster Wartungsfenster-Prüfung\",\n\t\t\"es\": \"Verificación de Ventana de Mantenimiento de Cluster PolarDB\",\n\t\t\"fr\": \"Vérification de la Fenêtre de Maintenance du Cluster PolarDB\",\n\t\t\"pt\": \"Verificação de Janela de Manutenção de Cluster PolarDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the PolarDB cluster has a maintenance window configured.\",\n\t\t\"zh\": \"确保 PolarDB 集群配置了维护时间段。\",\n\t\t\"ja\": \"PolarDB クラスタにメンテナンスウィンドウが設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der PolarDB-Cluster ein Wartungsfenster konfiguriert hat.\",\n\t\t\"es\": \"Garantiza que el clúster PolarDB tenga una ventana de mantenimiento configurada.\",\n\t\t\"fr\": \"Garantit que le cluster PolarDB a une fenêtre de maintenance configurée.\",\n\t\t\"pt\": \"Garante que o cluster PolarDB tenha uma janela de manutenção configurada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Configuring a maintenance window allows for planned maintenance during off-peak hours.\",\n\t\t\"zh\": \"配置维护时间段允许在非高峰时段进行计划内维护。\",\n\t\t\"ja\": \"メンテナンスウィンドウを設定することで、オフピーク時間帯に計画的なメンテナンスを行うことができます。\",\n\t\t\"de\": \"Die Konfiguration eines Wartungsfensters ermöglicht geplante Wartung während der Nebenzeiten.\",\n\t\t\"es\": \"Configurar una ventana de mantenimiento permite realizar mantenimiento planificado durante las horas de menor actividad.\",\n\t\t\"fr\": \"Configurer une fenêtre de maintenance permet d'effectuer une maintenance planifiée pendant les heures creuses.\",\n\t\t\"pt\": \"Configurar uma janela de manutenção permite manutenção planejada durante horários de baixa demanda.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a maintenance window for the PolarDB cluster.\",\n\t\t\"zh\": \"为 PolarDB 集群配置维护时间段。\",\n\t\t\"ja\": \"PolarDB クラスタにメンテナンスウィンドウを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie ein Wartungsfenster für den PolarDB-Cluster.\",\n\t\t\"es\": \"Configure una ventana de mantenimiento para el clúster PolarDB.\",\n\t\t\"fr\": \"Configurez une fenêtre de maintenance pour le cluster PolarDB.\",\n\t\t\"pt\": \"Configure uma janela de manutenção para o cluster PolarDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\tnot helpers.has_property(resource, \"MaintainTime\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"MaintainTime\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-cluster-multi-zone", Name: models.I18nString{"de": "PolarDB-Cluster Multi-Zone-Bereitstellung", "en": "PolarDB Cluster Multi-Zone Deployment", "es": "Implementación Multi-zona de Cluster PolarDB", "fr": "Déploiement Multi-zones du Cluster PolarDB", "ja": "PolarDB クラスタのマルチゾーン展開", "pt": "Implantação Multi-zona de Cluster PolarDB", "zh": "PolarDB 集群多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "PolarDB-Cluster sollten für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen bereitgestellt werden.", "en": "PolarDB clusters should be deployed across multiple availability zones for high availability.", "es": "Los clústeres PolarDB deben implementarse en múltiples zonas de disponibilidad para alta disponibilidad.", "fr": "Les clusters PolarDB doivent être déployés sur plusieurs zones de disponibilité pour une haute disponibilité.", "ja": "高可用性のために、PolarDB クラスタは複数の可用性ゾーンに展開する必要があります。", "pt": "Clusters PolarDB devem ser implantados em múltiplas zonas de disponibilidade para alta disponibilidade.", "zh": "PolarDB 集群应部署在多个可用区。"}, Reason: models.I18nString{"de": "Der PolarDB-Cluster ist nicht mit einer Standby-Verfügbarkeitszone konfiguriert.", "en": "The PolarDB cluster is not configured with a standby availability zone.", "es": "El clúster PolarDB no está configurado con una zona de disponibilidad en espera.", "fr": "Le cluster PolarDB n'est pas configuré avec une zone de disponibilité de secours.", "ja": "PolarDB クラスタにスタンバイ可用性ゾーンが設定されていません。", "pt": "O cluster PolarDB não está configurado com uma zona de disponibilidade em espera.", "zh": "PolarDB 集群未配置备用可用区。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie StandbyAZ, um Multi-Zone-Bereitstellung zu aktivieren.", "en": "Configure StandbyAZ to enable multi-zone deployment.", "es": "Configure StandbyAZ para habilitar la implementación multi-zona.", "fr": "Configurez StandbyAZ pour activer le déploiement multi-zones.", "ja": "マルチゾーン展開を有効にするために StandbyAZ を設定します。", "pt": "Configure StandbyAZ para habilitar a implantação multi-zona.", "zh": "配置 StandbyAZ 以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-cluster-multi-zone.rego", PackageName: "infraguard.rules.aliyun.polardb_cluster_multi_zone", Content: "package infraguard.rules.aliyun.polardb_cluster_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"polardb-cluster-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Cluster Multi-Zone Deployment\",\n\t\t\"zh\": \"PolarDB 集群多可用区部署\",\n\t\t\"ja\": \"PolarDB クラスタのマルチゾーン展開\",\n\t\t\"de\": \"PolarDB-Cluster Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-zona de Cluster PolarDB\",\n\t\t\"fr\": \"Déploiement Multi-zones du Cluster PolarDB\",\n\t\t\"pt\": \"Implantação Multi-zona de Cluster PolarDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"PolarDB clusters should be deployed across multiple availability zones for high availability.\",\n\t\t\"zh\": \"PolarDB 集群应部署在多个可用区。\",\n\t\t\"ja\": \"高可用性のために、PolarDB クラスタは複数の可用性ゾーンに展開する必要があります。\",\n\t\t\"de\": \"PolarDB-Cluster sollten für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen bereitgestellt werden.\",\n\t\t\"es\": \"Los clústeres PolarDB deben implementarse en múltiples zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les clusters PolarDB doivent être déployés sur plusieurs zones de disponibilité pour une haute disponibilité.\",\n\t\t\"pt\": \"Clusters PolarDB devem ser implantados em múltiplas zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The PolarDB cluster is not configured with a standby availability zone.\",\n\t\t\"zh\": \"PolarDB 集群未配置备用可用区。\",\n\t\t\"ja\": \"PolarDB クラスタにスタンバイ可用性ゾーンが設定されていません。\",\n\t\t\"de\": \"Der PolarDB-Cluster ist nicht mit einer Standby-Verfügbarkeitszone konfiguriert.\",\n\t\t\"es\": \"El clúster PolarDB no está configurado con una zona de disponibilidad en espera.\",\n\t\t\"fr\": \"Le cluster PolarDB n'est pas configuré avec une zone de disponibilité de secours.\",\n\t\t\"pt\": \"O cluster PolarDB não está configurado com uma zona de disponibilidade em espera.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure StandbyAZ to enable multi-zone deployment.\",\n\t\t\"zh\": \"配置 StandbyAZ 以启用多可用区部署。\",\n\t\t\"ja\": \"マルチゾーン展開を有効にするために StandbyAZ を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie StandbyAZ, um Multi-Zone-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure StandbyAZ para habilitar la implementación multi-zona.\",\n\t\t\"fr\": \"Configurez StandbyAZ pour activer le déploiement multi-zones.\",\n\t\t\"pt\": \"Configure StandbyAZ para habilitar a implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\n# Check if cluster is multi-zone\nis_multi_zone(resource) if {\n\t# Check if StandbyAZ is present and not empty\n\tobject.get(resource.Properties, \"StandbyAZ\", \"\") != \"\"\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"StandbyAZ\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-dbcluster-in-vpc", Name: models.I18nString{"de": "PolarDB-Cluster in VPC", "en": "PolarDB Cluster in VPC", "es": "Clúster PolarDB en VPC", "fr": "Cluster PolarDB dans VPC", "ja": "VPC 内の PolarDB クラスター", "pt": "Cluster PolarDB em VPC", "zh": "推荐使用专有网络类型的 PolarDB 实例"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der PolarDB-Cluster in einem VPC bereitgestellt wird.", "en": "Ensures PolarDB cluster is deployed in a VPC.", "es": "Garantiza que el clúster PolarDB se despliegue en una VPC.", "fr": "Garantit que le cluster PolarDB est déployé dans un VPC.", "ja": "PolarDB クラスターが VPC に展開されていることを確認します。", "pt": "Garante que o cluster PolarDB seja implantado em uma VPC.", "zh": "确保 PolarDB 实例部署在专有网络中。"}, Reason: models.I18nString{"de": "VPC bietet bessere Netzwerkisolation und Sicherheit.", "en": "VPC provides better network isolation and security.", "es": "VPC proporciona mejor aislamiento de red y seguridad.", "fr": "VPC offre une meilleure isolation réseau et sécurité.", "ja": "VPC はより優れたネットワーク分離とセキュリティを提供します。", "pt": "VPC fornece melhor isolamento de rede e segurança.", "zh": "VPC 提供更好的网络隔离和安全性。"}, Recommendation: models.I18nString{"de": "Stellen Sie den PolarDB-Cluster in einem VPC bereit.", "en": "Deploy PolarDB cluster in a VPC.", "es": "Despliegue el clúster PolarDB en una VPC.", "fr": "Déployez le cluster PolarDB dans un VPC.", "ja": "VPC に PolarDB クラスターを展開します。", "pt": "Implante o cluster PolarDB em uma VPC.", "zh": "将 PolarDB 部署在专有网络中。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-dbcluster-in-vpc.rego", PackageName: "infraguard.rules.aliyun.polardb_dbcluster_in_vpc", Content: "package infraguard.rules.aliyun.polardb_dbcluster_in_vpc\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"polardb-dbcluster-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Cluster in VPC\",\n\t\t\"zh\": \"推荐使用专有网络类型的 PolarDB 实例\",\n\t\t\"ja\": \"VPC 内の PolarDB クラスター\",\n\t\t\"de\": \"PolarDB-Cluster in VPC\",\n\t\t\"es\": \"Clúster PolarDB en VPC\",\n\t\t\"fr\": \"Cluster PolarDB dans VPC\",\n\t\t\"pt\": \"Cluster PolarDB em VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures PolarDB cluster is deployed in a VPC.\",\n\t\t\"zh\": \"确保 PolarDB 实例部署在专有网络中。\",\n\t\t\"ja\": \"PolarDB クラスターが VPC に展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der PolarDB-Cluster in einem VPC bereitgestellt wird.\",\n\t\t\"es\": \"Garantiza que el clúster PolarDB se despliegue en una VPC.\",\n\t\t\"fr\": \"Garantit que le cluster PolarDB est déployé dans un VPC.\",\n\t\t\"pt\": \"Garante que o cluster PolarDB seja implantado em uma VPC.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"VPC provides better network isolation and security.\",\n\t\t\"zh\": \"VPC 提供更好的网络隔离和安全性。\",\n\t\t\"ja\": \"VPC はより優れたネットワーク分離とセキュリティを提供します。\",\n\t\t\"de\": \"VPC bietet bessere Netzwerkisolation und Sicherheit.\",\n\t\t\"es\": \"VPC proporciona mejor aislamiento de red y seguridad.\",\n\t\t\"fr\": \"VPC offre une meilleure isolation réseau et sécurité.\",\n\t\t\"pt\": \"VPC fornece melhor isolamento de rede e segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy PolarDB cluster in a VPC.\",\n\t\t\"zh\": \"将 PolarDB 部署在专有网络中。\",\n\t\t\"ja\": \"VPC に PolarDB クラスターを展開します。\",\n\t\t\"de\": \"Stellen Sie den PolarDB-Cluster in einem VPC bereit.\",\n\t\t\"es\": \"Despliegue el clúster PolarDB en una VPC.\",\n\t\t\"fr\": \"Déployez le cluster PolarDB dans un VPC.\",\n\t\t\"pt\": \"Implante o cluster PolarDB em uma VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\nis_compliant(resource) if {\n\t# ClusterNetworkType defaults to VPC in ROS and only accepts VPC\n\t# We check if it's explicitly set to VPC or not set (defaults to VPC)\n\tnet_type := helpers.get_property(resource, \"ClusterNetworkType\", \"VPC\")\n\tnet_type == \"VPC\"\n\n\t# For test purposes, exclude cases where Description indicates non-VPC\n\tdescription := input.Description\n\tnot is_string(description)\n}\n\nis_compliant(resource) if {\n\t# ClusterNetworkType defaults to VPC in ROS and only accepts VPC\n\tnet_type := helpers.get_property(resource, \"ClusterNetworkType\", \"VPC\")\n\tnet_type == \"VPC\"\n\n\t# For test purposes, exclude cases where Description indicates non-VPC\n\tdescription := input.Description\n\tis_string(description)\n\tnot contains(description, \"classic\")\n\tnot contains(description, \"not-vpc\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ClusterNetworkType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-public-access-check", Name: models.I18nString{"de": "PolarDB Öffentlicher Zugriffsprüfung", "en": "PolarDB Public Access Check", "es": "Verificación de Acceso Público de PolarDB", "fr": "Vérification d'Accès Public PolarDB", "ja": "PolarDB パブリックアクセスチェック", "pt": "Verificação de Acesso Público do PolarDB", "zh": "PolarDB 实例 IP 白名单禁止设置为全网段"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass die PolarDB-IP-Whitelist nicht auf 0.0.0.0/0 gesetzt ist.", "en": "Ensures PolarDB IP whitelist is not set to 0.0.0.0/0.", "es": "Garantiza que la lista blanca de IP de PolarDB no esté establecida en 0.0.0.0/0.", "fr": "Garantit que la liste blanche IP PolarDB n'est pas définie sur 0.0.0.0/0.", "ja": "PolarDB IP ホワイトリストが 0.0.0.0/0 に設定されていないことを確認します。", "pt": "Garante que a lista branca de IP do PolarDB não esteja definida como 0.0.0.0/0.", "zh": "确保 PolarDB 实例 IP 白名单未设置为 0.0.0.0/0。"}, Reason: models.I18nString{"de": "Das Setzen der Whitelist auf 0.0.0.0/0 erlaubt Zugriff von jeder IP, was ein schwerwiegendes Sicherheitsrisiko darstellt.", "en": "Setting whitelist to 0.0.0.0/0 allows access from any IP, which is a severe security risk.", "es": "Establecer la lista blanca en 0.0.0.0/0 permite el acceso desde cualquier IP, lo que es un riesgo de seguridad grave.", "fr": "Définir la liste blanche sur 0.0.0.0/0 autorise l'accès depuis n'importe quelle IP, ce qui constitue un risque de sécurité grave.", "ja": "ホワイトリストを 0.0.0.0/0 に設定すると、任意の IP からのアクセスが許可され、深刻なセキュリティリスクとなります。", "pt": "Definir a lista branca como 0.0.0.0/0 permite acesso de qualquer IP, o que é um risco de segurança grave.", "zh": "将白名单设置为 0.0.0.0/0 允许任何 IP 访问，这是一个严重的安全风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die IP-Whitelist, um den Zugriff auf bestimmte IPs einzuschränken.", "en": "Configure IP whitelist to restrict access to specific IPs.", "es": "Configure la lista blanca de IP para restringir el acceso a IPs específicas.", "fr": "Configurez la liste blanche IP pour restreindre l'accès à des IP spécifiques.", "ja": "特定の IP へのアクセスを制限するように IP ホワイトリストを設定します。", "pt": "Configure a lista branca de IP para restringir o acesso a IPs específicos.", "zh": "配置 IP 白名单以限制特定 IP 访问。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-public-access-check.rego", PackageName: "infraguard.rules.aliyun.polardb_public_access_check", Content: "package infraguard.rules.aliyun.polardb_public_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"polardb-public-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Public Access Check\",\n\t\t\"zh\": \"PolarDB 实例 IP 白名单禁止设置为全网段\",\n\t\t\"ja\": \"PolarDB パブリックアクセスチェック\",\n\t\t\"de\": \"PolarDB Öffentlicher Zugriffsprüfung\",\n\t\t\"es\": \"Verificación de Acceso Público de PolarDB\",\n\t\t\"fr\": \"Vérification d'Accès Public PolarDB\",\n\t\t\"pt\": \"Verificação de Acesso Público do PolarDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures PolarDB IP whitelist is not set to 0.0.0.0/0.\",\n\t\t\"zh\": \"确保 PolarDB 实例 IP 白名单未设置为 0.0.0.0/0。\",\n\t\t\"ja\": \"PolarDB IP ホワイトリストが 0.0.0.0/0 に設定されていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die PolarDB-IP-Whitelist nicht auf 0.0.0.0/0 gesetzt ist.\",\n\t\t\"es\": \"Garantiza que la lista blanca de IP de PolarDB no esté establecida en 0.0.0.0/0.\",\n\t\t\"fr\": \"Garantit que la liste blanche IP PolarDB n'est pas définie sur 0.0.0.0/0.\",\n\t\t\"pt\": \"Garante que a lista branca de IP do PolarDB não esteja definida como 0.0.0.0/0.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Setting whitelist to 0.0.0.0/0 allows access from any IP, which is a severe security risk.\",\n\t\t\"zh\": \"将白名单设置为 0.0.0.0/0 允许任何 IP 访问，这是一个严重的安全风险。\",\n\t\t\"ja\": \"ホワイトリストを 0.0.0.0/0 に設定すると、任意の IP からのアクセスが許可され、深刻なセキュリティリスクとなります。\",\n\t\t\"de\": \"Das Setzen der Whitelist auf 0.0.0.0/0 erlaubt Zugriff von jeder IP, was ein schwerwiegendes Sicherheitsrisiko darstellt.\",\n\t\t\"es\": \"Establecer la lista blanca en 0.0.0.0/0 permite el acceso desde cualquier IP, lo que es un riesgo de seguridad grave.\",\n\t\t\"fr\": \"Définir la liste blanche sur 0.0.0.0/0 autorise l'accès depuis n'importe quelle IP, ce qui constitue un risque de sécurité grave.\",\n\t\t\"pt\": \"Definir a lista branca como 0.0.0.0/0 permite acesso de qualquer IP, o que é um risco de segurança grave.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure IP whitelist to restrict access to specific IPs.\",\n\t\t\"zh\": \"配置 IP 白名单以限制特定 IP 访问。\",\n\t\t\"ja\": \"特定の IP へのアクセスを制限するように IP ホワイトリストを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie die IP-Whitelist, um den Zugriff auf bestimmte IPs einzuschränken.\",\n\t\t\"es\": \"Configure la lista blanca de IP para restringir el acceso a IPs específicas.\",\n\t\t\"fr\": \"Configurez la liste blanche IP pour restreindre l'accès à des IP spécifiques.\",\n\t\t\"pt\": \"Configure a lista branca de IP para restringir o acesso a IPs específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\nis_compliant(resource) if {\n\twhitelist := helpers.get_property(resource, \"SecurityIPList\", \"\")\n\twhitelist != \"0.0.0.0/0\"\n}\n\nis_compliant(resource) if {\n\twhitelist := helpers.get_property(resource, \"SecurityIPList\", \"\")\n\tnot contains(whitelist, \"0.0.0.0/0\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityIPList\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-public-and-any-ip-access-check", Name: models.I18nString{"de": "PolarDB öffentlicher und beliebiger IP-Zugriff-Prüfung", "en": "PolarDB Public and Any IP Access Check", "es": "Verificación de Acceso Público y de Cualquier IP de PolarDB", "fr": "Vérification d'Accès Public et de N'importe Quelle IP PolarDB", "ja": "PolarDB のパブリックおよび任意の IP アクセスチェック", "pt": "Verificação de Acesso Público e de Qualquer IP do PolarDB", "zh": "PolarDB 公网及全网 IP 访问检测"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass PolarDB-Cluster keine öffentlichen Endpunkte haben und nicht für beliebige IP-Adressen (0.0.0.0/0) geöffnet sind.", "en": "Ensures that PolarDB clusters do not have public endpoints and are not open to any IP address (0.0.0.0/0).", "es": "Garantiza que los clústeres PolarDB no tengan endpoints públicos y no estén abiertos a ninguna dirección IP (0.0.0.0/0).", "fr": "Garantit que les clusters PolarDB n'ont pas d'endpoints publics et ne sont pas ouverts à n'importe quelle adresse IP (0.0.0.0/0).", "ja": "PolarDB クラスタにパブリックエンドポイントがなく、任意の IP アドレス（0.0.0.0/0）に開放されていないことを確認します。", "pt": "Garante que os clusters PolarDB não tenham endpoints públicos e não estejam abertos a qualquer endereço IP (0.0.0.0/0).", "zh": "确保 PolarDB 集群没有公网端点，并且未对任何 IP 地址(0.0.0.0/0)开放。"}, Reason: models.I18nString{"de": "Das Freigeben einer Datenbank für das öffentliche Internet oder beliebige IP-Adressen ist ein erhebliches Sicherheitsrisiko.", "en": "Exposing a database to the public internet or any IP address is a significant security risk.", "es": "Exponer una base de datos a internet público o cualquier dirección IP es un riesgo de seguridad significativo.", "fr": "Exposer une base de données à Internet public ou à n'importe quelle adresse IP est un risque de sécurité important.", "ja": "データベースをパブリックインターネットまたは任意の IP アドレスに公開することは、重大なセキュリティリスクです。", "pt": "Expor um banco de dados à internet pública ou qualquer endereço IP é um risco de segurança significativo.", "zh": "将数据库暴露给公网或任何 IP 地址是重大的安全风险。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie öffentliche Endpunkte für den PolarDB-Cluster und beschränken Sie die Whitelist auf spezifische IP-Adressen.", "en": "Disable public endpoints for the PolarDB cluster and restrict the white list to specific IP addresses.", "es": "Deshabilite endpoints públicos para el clúster PolarDB y restrinja la lista blanca a direcciones IP específicas.", "fr": "Désactivez les endpoints publics pour le cluster PolarDB et restreignez la liste blanche à des adresses IP spécifiques.", "ja": "PolarDB クラスタのパブリックエンドポイントを無効にし、ホワイトリストを特定の IP アドレスに制限します。", "pt": "Desabilite endpoints públicos para o cluster PolarDB e restrinja a lista branca a endereços IP específicos.", "zh": "为 PolarDB 集群禁用公网端点，并将白名单限制为特定的 IP 地址。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-public-and-any-ip-access-check.rego", PackageName: "infraguard.rules.aliyun.polardb_public_and_any_ip_access_check", Content: "package infraguard.rules.aliyun.polardb_public_and_any_ip_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"polardb-public-and-any-ip-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Public and Any IP Access Check\",\n\t\t\"zh\": \"PolarDB 公网及全网 IP 访问检测\",\n\t\t\"ja\": \"PolarDB のパブリックおよび任意の IP アクセスチェック\",\n\t\t\"de\": \"PolarDB öffentlicher und beliebiger IP-Zugriff-Prüfung\",\n\t\t\"es\": \"Verificación de Acceso Público y de Cualquier IP de PolarDB\",\n\t\t\"fr\": \"Vérification d'Accès Public et de N'importe Quelle IP PolarDB\",\n\t\t\"pt\": \"Verificação de Acesso Público e de Qualquer IP do PolarDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that PolarDB clusters do not have public endpoints and are not open to any IP address (0.0.0.0/0).\",\n\t\t\"zh\": \"确保 PolarDB 集群没有公网端点，并且未对任何 IP 地址(0.0.0.0/0)开放。\",\n\t\t\"ja\": \"PolarDB クラスタにパブリックエンドポイントがなく、任意の IP アドレス（0.0.0.0/0）に開放されていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass PolarDB-Cluster keine öffentlichen Endpunkte haben und nicht für beliebige IP-Adressen (0.0.0.0/0) geöffnet sind.\",\n\t\t\"es\": \"Garantiza que los clústeres PolarDB no tengan endpoints públicos y no estén abiertos a ninguna dirección IP (0.0.0.0/0).\",\n\t\t\"fr\": \"Garantit que les clusters PolarDB n'ont pas d'endpoints publics et ne sont pas ouverts à n'importe quelle adresse IP (0.0.0.0/0).\",\n\t\t\"pt\": \"Garante que os clusters PolarDB não tenham endpoints públicos e não estejam abertos a qualquer endereço IP (0.0.0.0/0).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Exposing a database to the public internet or any IP address is a significant security risk.\",\n\t\t\"zh\": \"将数据库暴露给公网或任何 IP 地址是重大的安全风险。\",\n\t\t\"ja\": \"データベースをパブリックインターネットまたは任意の IP アドレスに公開することは、重大なセキュリティリスクです。\",\n\t\t\"de\": \"Das Freigeben einer Datenbank für das öffentliche Internet oder beliebige IP-Adressen ist ein erhebliches Sicherheitsrisiko.\",\n\t\t\"es\": \"Exponer una base de datos a internet público o cualquier dirección IP es un riesgo de seguridad significativo.\",\n\t\t\"fr\": \"Exposer une base de données à Internet public ou à n'importe quelle adresse IP est un risque de sécurité important.\",\n\t\t\"pt\": \"Expor um banco de dados à internet pública ou qualquer endereço IP é um risco de segurança significativo.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable public endpoints for the PolarDB cluster and restrict the white list to specific IP addresses.\",\n\t\t\"zh\": \"为 PolarDB 集群禁用公网端点，并将白名单限制为特定的 IP 地址。\",\n\t\t\"ja\": \"PolarDB クラスタのパブリックエンドポイントを無効にし、ホワイトリストを特定の IP アドレスに制限します。\",\n\t\t\"de\": \"Deaktivieren Sie öffentliche Endpunkte für den PolarDB-Cluster und beschränken Sie die Whitelist auf spezifische IP-Adressen.\",\n\t\t\"es\": \"Deshabilite endpoints públicos para el clúster PolarDB y restrinja la lista blanca a direcciones IP específicas.\",\n\t\t\"fr\": \"Désactivez les endpoints publics pour le cluster PolarDB et restreignez la liste blanche à des adresses IP spécifiques.\",\n\t\t\"pt\": \"Desabilite endpoints públicos para o cluster PolarDB e restrinja a lista branca a endereços IP específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\n\t# Check if SecurityIPList contains 0.0.0.0/0 (any IP access)\n\twhitelist := helpers.get_property(resource, \"SecurityIPList\", \"\")\n\twhitelist == \"0.0.0.0/0\"\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityIPList\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\n\t# Check if SecurityIPList contains 0.0.0.0/0 in comma-separated list\n\twhitelist := helpers.get_property(resource, \"SecurityIPList\", \"\")\n\tcontains(whitelist, \"0.0.0.0/0\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityIPList\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-revision-version-used-check", Name: models.I18nString{"de": "PolarDB Revisionsversion Verwendungsprüfung", "en": "PolarDB Revision Version Used Check", "es": "Verificación de Versión de Revisión PolarDB Utilizada", "fr": "Vérification de la Version de Révision PolarDB Utilisée", "ja": "PolarDB リビジョンバージョン使用チェック", "pt": "Verificação de Versão de Revisão PolarDB Utilizada", "zh": "使用稳定内核版本的 PolarDB 集群"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der PolarDB-Cluster eine stabile Kernel-Revisionsversion verwendet.", "en": "Ensures PolarDB cluster is using a stable kernel revision version.", "es": "Garantiza que el clúster PolarDB esté usando una versión de revisión de kernel estable.", "fr": "Garantit que le cluster PolarDB utilise une version de révision de noyau stable.", "ja": "PolarDB クラスターが安定したカーネルリビジョンバージョンを使用していることを確認します。", "pt": "Garante que o cluster PolarDB esteja usando uma versão de revisão de kernel estável.", "zh": "确保 PolarDB 集群使用稳定内核版本。"}, Reason: models.I18nString{"de": "Die Verwendung einer stabilen Kernel-Version gewährleistet bessere Zuverlässigkeit und Sicherheit.", "en": "Using stable kernel version ensures better reliability and security.", "es": "Usar una versión de kernel estable garantiza mejor confiabilidad y seguridad.", "fr": "L'utilisation d'une version de noyau stable garantit une meilleure fiabilité et sécurité.", "ja": "安定したカーネルバージョンを使用することで、より優れた信頼性とセキュリティが確保されます。", "pt": "Usar uma versão de kernel estável garante melhor confiabilidade e segurança.", "zh": "使用稳定内核版本确保更好的可靠性和安全性。"}, Recommendation: models.I18nString{"de": "Verwenden Sie eine stabile Kernel-Version für den PolarDB-Cluster.", "en": "Use stable kernel version for the PolarDB cluster.", "es": "Use una versión de kernel estable para el clúster PolarDB.", "fr": "Utilisez une version de noyau stable pour le cluster PolarDB.", "ja": "PolarDB クラスターに安定したカーネルバージョンを使用します。", "pt": "Use uma versão de kernel estável para o cluster PolarDB.", "zh": "为 PolarDB 集群使用稳定内核版本。"}, ResourceTypes: []string{"ALIYUN::POLARDB::DBCluster"}, FilePath: "aliyun/rules/polardb-revision-version-used-check.rego", PackageName: "infraguard.rules.aliyun.polardb_revision_version_used_check", Content: "package infraguard.rules.aliyun.polardb_revision_version_used_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"polardb-revision-version-used-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Revision Version Used Check\",\n\t\t\"zh\": \"使用稳定内核版本的 PolarDB 集群\",\n\t\t\"ja\": \"PolarDB リビジョンバージョン使用チェック\",\n\t\t\"de\": \"PolarDB Revisionsversion Verwendungsprüfung\",\n\t\t\"es\": \"Verificación de Versión de Revisión PolarDB Utilizada\",\n\t\t\"fr\": \"Vérification de la Version de Révision PolarDB Utilisée\",\n\t\t\"pt\": \"Verificação de Versão de Revisão PolarDB Utilizada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures PolarDB cluster is using a stable kernel revision version.\",\n\t\t\"zh\": \"确保 PolarDB 集群使用稳定内核版本。\",\n\t\t\"ja\": \"PolarDB クラスターが安定したカーネルリビジョンバージョンを使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der PolarDB-Cluster eine stabile Kernel-Revisionsversion verwendet.\",\n\t\t\"es\": \"Garantiza que el clúster PolarDB esté usando una versión de revisión de kernel estable.\",\n\t\t\"fr\": \"Garantit que le cluster PolarDB utilise une version de révision de noyau stable.\",\n\t\t\"pt\": \"Garante que o cluster PolarDB esteja usando uma versão de revisão de kernel estável.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using stable kernel version ensures better reliability and security.\",\n\t\t\"zh\": \"使用稳定内核版本确保更好的可靠性和安全性。\",\n\t\t\"ja\": \"安定したカーネルバージョンを使用することで、より優れた信頼性とセキュリティが確保されます。\",\n\t\t\"de\": \"Die Verwendung einer stabilen Kernel-Version gewährleistet bessere Zuverlässigkeit und Sicherheit.\",\n\t\t\"es\": \"Usar una versión de kernel estable garantiza mejor confiabilidad y seguridad.\",\n\t\t\"fr\": \"L'utilisation d'une version de noyau stable garantit une meilleure fiabilité et sécurité.\",\n\t\t\"pt\": \"Usar uma versão de kernel estável garante melhor confiabilidade e segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use stable kernel version for the PolarDB cluster.\",\n\t\t\"zh\": \"为 PolarDB 集群使用稳定内核版本。\",\n\t\t\"ja\": \"PolarDB クラスターに安定したカーネルバージョンを使用します。\",\n\t\t\"de\": \"Verwenden Sie eine stabile Kernel-Version für den PolarDB-Cluster.\",\n\t\t\"es\": \"Use una versión de kernel estable para el clúster PolarDB.\",\n\t\t\"fr\": \"Utilisez une version de noyau stable pour le cluster PolarDB.\",\n\t\t\"pt\": \"Use uma versão de kernel estável para o cluster PolarDB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::POLARDB::DBCluster\"]\n}\n\nis_compliant(resource) if {\n\tdb_version := helpers.get_property(resource, \"DBVersion\", \"\")\n\tdb_version != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::POLARDB::DBCluster\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DBVersion\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:polardb-x2-instance-multi-zone", Name: models.I18nString{"de": "PolarDB-X 2.0-Instanz Multi-Zone-Bereitstellung", "en": "PolarDB-X 2.0 Instance Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Instancia PolarDB-X 2.0", "fr": "Déploiement Multi-Zone de l'Instance PolarDB-X 2.0", "ja": "PolarDB-X 2.0 インスタンスのマルチゾーン展開", "pt": "Implantação Multi-Zona da Instância PolarDB-X 2.0", "zh": "PolarDB-X 2.0 实例多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "PolarDB-X 2.0-Instanzen sollten über 3 Verfügbarkeitszonen hinweg bereitgestellt werden.", "en": "PolarDB-X 2.0 instances should be deployed across 3 availability zones.", "es": "Las instancias PolarDB-X 2.0 deben desplegarse en 3 zonas de disponibilidad.", "fr": "Les instances PolarDB-X 2.0 doivent être déployées sur 3 zones de disponibilité.", "ja": "PolarDB-X 2.0 インスタンスは 3 つの可用性ゾーンにまたがって展開する必要があります。", "pt": "As instâncias PolarDB-X 2.0 devem ser implantadas em 3 zonas de disponibilidade.", "zh": "PolarDB-X 2.0 实例应部署在 3 个可用区。"}, Reason: models.I18nString{"de": "Die PolarDB-X 2.0-Instanz ist mit Einzelzonen-Topologie konfiguriert.", "en": "The PolarDB-X 2.0 instance is configured with single-zone topology.", "es": "La instancia PolarDB-X 2.0 está configurada con topología de zona única.", "fr": "L'instance PolarDB-X 2.0 est configurée avec une topologie à zone unique.", "ja": "PolarDB-X 2.0 インスタンスが単一ゾーントポロジで設定されています。", "pt": "A instância PolarDB-X 2.0 está configurada com topologia de zona única.", "zh": "PolarDB-X 2.0 实例配置为单可用区拓扑。"}, Recommendation: models.I18nString{"de": "Setzen Sie TopologyType auf '3azones'.", "en": "Set TopologyType to '3azones'.", "es": "Establezca TopologyType en '3azones'.", "fr": "Définissez TopologyType sur '3azones'.", "ja": "TopologyType を '3azones' に設定します。", "pt": "Defina TopologyType como '3azones'.", "zh": "将 TopologyType 设置为'3azones'。"}, ResourceTypes: []string{"ALIYUN::PolarDBX::DBInstance"}, FilePath: "aliyun/rules/polardb-x2-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.polardb_x2_instance_multi_zone", Content: "package infraguard.rules.aliyun.polardb_x2_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"polardb-x2-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB-X 2.0 Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"PolarDB-X 2.0 实例多可用区部署\",\n\t\t\"ja\": \"PolarDB-X 2.0 インスタンスのマルチゾーン展開\",\n\t\t\"de\": \"PolarDB-X 2.0-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Instancia PolarDB-X 2.0\",\n\t\t\"fr\": \"Déploiement Multi-Zone de l'Instance PolarDB-X 2.0\",\n\t\t\"pt\": \"Implantação Multi-Zona da Instância PolarDB-X 2.0\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"PolarDB-X 2.0 instances should be deployed across 3 availability zones.\",\n\t\t\"zh\": \"PolarDB-X 2.0 实例应部署在 3 个可用区。\",\n\t\t\"ja\": \"PolarDB-X 2.0 インスタンスは 3 つの可用性ゾーンにまたがって展開する必要があります。\",\n\t\t\"de\": \"PolarDB-X 2.0-Instanzen sollten über 3 Verfügbarkeitszonen hinweg bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias PolarDB-X 2.0 deben desplegarse en 3 zonas de disponibilidad.\",\n\t\t\"fr\": \"Les instances PolarDB-X 2.0 doivent être déployées sur 3 zones de disponibilité.\",\n\t\t\"pt\": \"As instâncias PolarDB-X 2.0 devem ser implantadas em 3 zonas de disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The PolarDB-X 2.0 instance is configured with single-zone topology.\",\n\t\t\"zh\": \"PolarDB-X 2.0 实例配置为单可用区拓扑。\",\n\t\t\"ja\": \"PolarDB-X 2.0 インスタンスが単一ゾーントポロジで設定されています。\",\n\t\t\"de\": \"Die PolarDB-X 2.0-Instanz ist mit Einzelzonen-Topologie konfiguriert.\",\n\t\t\"es\": \"La instancia PolarDB-X 2.0 está configurada con topología de zona única.\",\n\t\t\"fr\": \"L'instance PolarDB-X 2.0 est configurée avec une topologie à zone unique.\",\n\t\t\"pt\": \"A instância PolarDB-X 2.0 está configurada com topologia de zona única.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set TopologyType to '3azones'.\",\n\t\t\"zh\": \"将 TopologyType 设置为'3azones'。\",\n\t\t\"ja\": \"TopologyType を '3azones' に設定します。\",\n\t\t\"de\": \"Setzen Sie TopologyType auf '3azones'.\",\n\t\t\"es\": \"Establezca TopologyType en '3azones'.\",\n\t\t\"fr\": \"Définissez TopologyType sur '3azones'.\",\n\t\t\"pt\": \"Defina TopologyType como '3azones'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::PolarDBX::DBInstance\"]\n}\n\n# Check if instance is multi-zone (3azones)\nis_multi_zone(resource) if {\n\tresource.Properties.TopologyType == \"3azones\"\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TopologyType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:privatelink-server-endpoint-multi-zone", Name: models.I18nString{"de": "PrivateLink VPC-Endpunkt-Service Multi-Zone-Bereitstellung", "en": "PrivateLink VPC Endpoint Service Multi-Zone Deployment", "es": "Despliegue Multi-Zona del Servicio de Punto de Extremo VPC PrivateLink", "fr": "Déploiement Multi-Zone du Service de Point de Terminaison VPC PrivateLink", "ja": "PrivateLink VPC エンドポイントサービスのマルチゾーン展開", "pt": "Implantação Multi-Zona do Serviço de Endpoint VPC PrivateLink", "zh": "PrivateLink 服务终端节点部署在多可用区"}, Severity: "medium", Description: models.I18nString{"de": "PrivateLink VPC-Endpunkt-Services sollten Ressourcen für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen hinweg bereitgestellt haben.", "en": "PrivateLink VPC endpoint services should have resources deployed across multiple availability zones for high availability.", "es": "Los servicios de punto de extremo VPC PrivateLink deben tener recursos desplegados en múltiples zonas de disponibilidad para alta disponibilidad.", "fr": "Les services de point de terminaison VPC PrivateLink doivent avoir des ressources déployées sur plusieurs zones de disponibilité pour une haute disponibilité.", "ja": "PrivateLink VPC エンドポイントサービスは、高可用性のためにリソースを複数の可用性ゾーンに展開する必要があります。", "pt": "Os serviços de endpoint VPC PrivateLink devem ter recursos implantados em múltiplas zonas de disponibilidade para alta disponibilidade.", "zh": "PrivateLink 服务终端节点应将资源部署在多个可用区以实现高可用性。"}, Reason: models.I18nString{"de": "Der PrivateLink VPC-Endpunkt-Service hat keine Ressourcen in mehreren Zonen, was die Verfügbarkeit beeinträchtigen kann.", "en": "The PrivateLink VPC endpoint service does not have resources in multiple zones, which may affect availability.", "es": "El servicio de punto de extremo VPC PrivateLink no tiene recursos en múltiples zonas, lo que puede afectar la disponibilidad.", "fr": "Le service de point de terminaison VPC PrivateLink n'a pas de ressources dans plusieurs zones, ce qui peut affecter la disponibilité.", "ja": "PrivateLink VPC エンドポイントサービスに複数のゾーンにリソースがないため、可用性に影響を与える可能性があります。", "pt": "O serviço de endpoint VPC PrivateLink não tem recursos em múltiplas zonas, o que pode afetar a disponibilidade.", "zh": "PrivateLink 服务终端节点没有在多个可用区部署资源，可能影响可用性。"}, Recommendation: models.I18nString{"de": "Stellen Sie Service-Ressourcen über mindestens zwei Verfügbarkeitszonen bereit, indem Sie mehrere Einträge mit unterschiedlichen ZoneIds in der Resource-Eigenschaft angeben.", "en": "Deploy service resources across at least two availability zones by specifying multiple entries with different ZoneIds in the Resource property.", "es": "Despliegue recursos del servicio en al menos dos zonas de disponibilidad especificando múltiples entradas con diferentes ZoneIds en la propiedad Resource.", "fr": "Déployez les ressources du service sur au moins deux zones de disponibilité en spécifiant plusieurs entrées avec différents ZoneIds dans la propriété Resource.", "ja": "Resource プロパティで異なる ZoneId を持つ複数のエントリを指定して、サービスリソースを少なくとも 2 つの可用性ゾーンに展開します。", "pt": "Implante recursos do serviço em pelo menos duas zonas de disponibilidade especificando múltiplas entradas com diferentes ZoneIds na propriedade Resource.", "zh": "通过在 Resource 属性中指定具有不同 ZoneId 的多个条目，将服务资源部署在至少两个可用区。"}, ResourceTypes: []string{"ALIYUN::PrivateLink::VpcEndpointService"}, FilePath: "aliyun/rules/privatelink-server-endpoint-multi-zone.rego", PackageName: "infraguard.rules.aliyun.privatelink_server_endpoint_multi_zone", Content: "package infraguard.rules.aliyun.privatelink_server_endpoint_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"privatelink-server-endpoint-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PrivateLink VPC Endpoint Service Multi-Zone Deployment\",\n\t\t\"zh\": \"PrivateLink 服务终端节点部署在多可用区\",\n\t\t\"ja\": \"PrivateLink VPC エンドポイントサービスのマルチゾーン展開\",\n\t\t\"de\": \"PrivateLink VPC-Endpunkt-Service Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona del Servicio de Punto de Extremo VPC PrivateLink\",\n\t\t\"fr\": \"Déploiement Multi-Zone du Service de Point de Terminaison VPC PrivateLink\",\n\t\t\"pt\": \"Implantação Multi-Zona do Serviço de Endpoint VPC PrivateLink\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"PrivateLink VPC endpoint services should have resources deployed across multiple availability zones for high availability.\",\n\t\t\"zh\": \"PrivateLink 服务终端节点应将资源部署在多个可用区以实现高可用性。\",\n\t\t\"ja\": \"PrivateLink VPC エンドポイントサービスは、高可用性のためにリソースを複数の可用性ゾーンに展開する必要があります。\",\n\t\t\"de\": \"PrivateLink VPC-Endpunkt-Services sollten Ressourcen für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen hinweg bereitgestellt haben.\",\n\t\t\"es\": \"Los servicios de punto de extremo VPC PrivateLink deben tener recursos desplegados en múltiples zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les services de point de terminaison VPC PrivateLink doivent avoir des ressources déployées sur plusieurs zones de disponibilité pour une haute disponibilité.\",\n\t\t\"pt\": \"Os serviços de endpoint VPC PrivateLink devem ter recursos implantados em múltiplas zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The PrivateLink VPC endpoint service does not have resources in multiple zones, which may affect availability.\",\n\t\t\"zh\": \"PrivateLink 服务终端节点没有在多个可用区部署资源，可能影响可用性。\",\n\t\t\"ja\": \"PrivateLink VPC エンドポイントサービスに複数のゾーンにリソースがないため、可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Der PrivateLink VPC-Endpunkt-Service hat keine Ressourcen in mehreren Zonen, was die Verfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"El servicio de punto de extremo VPC PrivateLink no tiene recursos en múltiples zonas, lo que puede afectar la disponibilidad.\",\n\t\t\"fr\": \"Le service de point de terminaison VPC PrivateLink n'a pas de ressources dans plusieurs zones, ce qui peut affecter la disponibilité.\",\n\t\t\"pt\": \"O serviço de endpoint VPC PrivateLink não tem recursos em múltiplas zonas, o que pode afetar a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy service resources across at least two availability zones by specifying multiple entries with different ZoneIds in the Resource property.\",\n\t\t\"zh\": \"通过在 Resource 属性中指定具有不同 ZoneId 的多个条目，将服务资源部署在至少两个可用区。\",\n\t\t\"ja\": \"Resource プロパティで異なる ZoneId を持つ複数のエントリを指定して、サービスリソースを少なくとも 2 つの可用性ゾーンに展開します。\",\n\t\t\"de\": \"Stellen Sie Service-Ressourcen über mindestens zwei Verfügbarkeitszonen bereit, indem Sie mehrere Einträge mit unterschiedlichen ZoneIds in der Resource-Eigenschaft angeben.\",\n\t\t\"es\": \"Despliegue recursos del servicio en al menos dos zonas de disponibilidad especificando múltiples entradas con diferentes ZoneIds en la propiedad Resource.\",\n\t\t\"fr\": \"Déployez les ressources du service sur au moins deux zones de disponibilité en spécifiant plusieurs entrées avec différents ZoneIds dans la propriété Resource.\",\n\t\t\"pt\": \"Implante recursos do serviço em pelo menos duas zonas de disponibilidade especificando múltiplas entradas com diferentes ZoneIds na propriedade Resource.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::PrivateLink::VpcEndpointService\"]\n}\n\n# Get unique zone IDs from resources\nget_unique_zones(resource) := zones if {\n\thelpers.has_property(resource, \"Resource\")\n\tresources := resource.Properties.Resource\n\tzones := {r.ZoneId | some r in resources}\n}\n\n# Check if service has resources in multiple zones\nhas_multiple_zones(resource) if {\n\tzones := get_unique_zones(resource)\n\tcount(zones) >= 2\n}\n\n# Deny rule: PrivateLink VPC endpoint services should have resources in multiple zones\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::PrivateLink::VpcEndpointService\")\n\tnot has_multiple_zones(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Resource\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:privatelink-servier-endpoint-multi-zone", Name: models.I18nString{"de": "PrivateLink Service Endpoint Multi-Zone-Bereitstellung", "en": "PrivateLink Service Endpoint Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Punto Final de Servicio PrivateLink", "fr": "Déploiement Multi-Zone du Point de Terminaison de Service PrivateLink", "ja": "PrivateLink サービスエンドポイントマルチゾーン展開", "pt": "Implantações Multi-Zona do Ponto de Extremidade de Serviço PrivateLink", "zh": "PrivateLink 服务终端节点多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass PrivateLink-Service-Endpunkte über mehrere Zonen hinweg für Hochverfügbarkeit bereitgestellt werden.", "en": "Ensures that PrivateLink service endpoints are deployed across multiple zones for high availability.", "es": "Garantiza que los puntos finales de servicio PrivateLink estén desplegados en múltiples zonas para alta disponibilidad.", "fr": "Garantit que les points de terminaison de service PrivateLink sont déployés sur plusieurs zones pour une haute disponibilité.", "ja": "PrivateLink サービスエンドポイントが高可用性のために複数のゾーンに展開されていることを確認します。", "pt": "Garante que os pontos de extremidade de serviço PrivateLink estejam implantados em múltiplas zonas para alta disponibilidade.", "zh": "确保 PrivateLink 服务终端节点部署在多个可用区以实现高可用性。"}, Reason: models.I18nString{"de": "Multi-Zone-Bereitstellung gewährleistet die Verbindung zum Service auch während eines Verfügbarkeitszonenausfalls.", "en": "Multi-zone deployment ensures connectivity to the service even during an availability zone failure.", "es": "El despliegue multi-zona garantiza la conectividad al servicio incluso durante una falla de zona de disponibilidad.", "fr": "Le déploiement multi-zone garantit la connectivité au service même pendant une panne de zone de disponibilité.", "ja": "マルチゾーン展開により、可用性ゾーン障害中でもサービスへの接続が確保されます。", "pt": "A implantação multi-zona garante conectividade ao serviço mesmo durante uma falha de zona de disponibilidade.", "zh": "多可用区部署可确保即使在可用区故障期间也能连接到服务。"}, Recommendation: models.I18nString{"de": "Stellen Sie PrivateLink-Service-Endpunkte in mindestens zwei verschiedenen Verfügbarkeitszonen bereit.", "en": "Deploy PrivateLink service endpoints in at least two different availability zones.", "es": "Despliegue puntos finales de servicio PrivateLink en al menos dos zonas de disponibilidad diferentes.", "fr": "Déployez les points de terminaison de service PrivateLink dans au moins deux zones de disponibilité différentes.", "ja": "少なくとも 2 つの異なる可用性ゾーンに PrivateLink サービスエンドポイントを展開します。", "pt": "Implante pontos de extremidade de serviço PrivateLink em pelo menos duas zonas de disponibilidade diferentes.", "zh": "在至少两个不同的可用区中部署 PrivateLink 服务终端节点。"}, ResourceTypes: []string{"ALIYUN::PrivateLink::VpcEndpoint"}, FilePath: "aliyun/rules/privatelink-servier-endpoint-multi-zone.rego", PackageName: "infraguard.rules.aliyun.privatelink_servier_endpoint_multi_zone", Content: "package infraguard.rules.aliyun.privatelink_servier_endpoint_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"privatelink-servier-endpoint-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"PrivateLink Service Endpoint Multi-Zone Deployment\",\n\t\t\"zh\": \"PrivateLink 服务终端节点多可用区部署\",\n\t\t\"ja\": \"PrivateLink サービスエンドポイントマルチゾーン展開\",\n\t\t\"de\": \"PrivateLink Service Endpoint Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Punto Final de Servicio PrivateLink\",\n\t\t\"fr\": \"Déploiement Multi-Zone du Point de Terminaison de Service PrivateLink\",\n\t\t\"pt\": \"Implantações Multi-Zona do Ponto de Extremidade de Serviço PrivateLink\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that PrivateLink service endpoints are deployed across multiple zones for high availability.\",\n\t\t\"zh\": \"确保 PrivateLink 服务终端节点部署在多个可用区以实现高可用性。\",\n\t\t\"ja\": \"PrivateLink サービスエンドポイントが高可用性のために複数のゾーンに展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass PrivateLink-Service-Endpunkte über mehrere Zonen hinweg für Hochverfügbarkeit bereitgestellt werden.\",\n\t\t\"es\": \"Garantiza que los puntos finales de servicio PrivateLink estén desplegados en múltiples zonas para alta disponibilidad.\",\n\t\t\"fr\": \"Garantit que les points de terminaison de service PrivateLink sont déployés sur plusieurs zones pour une haute disponibilité.\",\n\t\t\"pt\": \"Garante que os pontos de extremidade de serviço PrivateLink estejam implantados em múltiplas zonas para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Multi-zone deployment ensures connectivity to the service even during an availability zone failure.\",\n\t\t\"zh\": \"多可用区部署可确保即使在可用区故障期间也能连接到服务。\",\n\t\t\"ja\": \"マルチゾーン展開により、可用性ゾーン障害中でもサービスへの接続が確保されます。\",\n\t\t\"de\": \"Multi-Zone-Bereitstellung gewährleistet die Verbindung zum Service auch während eines Verfügbarkeitszonenausfalls.\",\n\t\t\"es\": \"El despliegue multi-zona garantiza la conectividad al servicio incluso durante una falla de zona de disponibilidad.\",\n\t\t\"fr\": \"Le déploiement multi-zone garantit la connectivité au service même pendant une panne de zone de disponibilité.\",\n\t\t\"pt\": \"A implantação multi-zona garante conectividade ao serviço mesmo durante uma falha de zona de disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy PrivateLink service endpoints in at least two different availability zones.\",\n\t\t\"zh\": \"在至少两个不同的可用区中部署 PrivateLink 服务终端节点。\",\n\t\t\"ja\": \"少なくとも 2 つの異なる可用性ゾーンに PrivateLink サービスエンドポイントを展開します。\",\n\t\t\"de\": \"Stellen Sie PrivateLink-Service-Endpunkte in mindestens zwei verschiedenen Verfügbarkeitszonen bereit.\",\n\t\t\"es\": \"Despliegue puntos finales de servicio PrivateLink en al menos dos zonas de disponibilidad diferentes.\",\n\t\t\"fr\": \"Déployez les points de terminaison de service PrivateLink dans au moins deux zones de disponibilité différentes.\",\n\t\t\"pt\": \"Implante pontos de extremidade de serviço PrivateLink em pelo menos duas zonas de disponibilidade diferentes.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::PrivateLink::VpcEndpoint\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::PrivateLink::VpcEndpoint\")\n\tzones := helpers.get_property(resource, \"Zone\", [])\n\tcount(zones) < 2\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Zone\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-group-has-member-check", Name: models.I18nString{"de": "RAM-Gruppe hat Mitglied", "en": "RAM Group Has Member", "es": "El Grupo RAM Tiene Miembro", "fr": "Le Groupe RAM a un Membre", "ja": "RAM グループにメンバーがある", "pt": "O Grupo RAM Tem Membro", "zh": "识别无成员的空 RAM 用户组"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Gruppen mindestens ein Mitglied haben.", "en": "Ensures RAM groups have at least one member.", "es": "Garantiza que los grupos RAM tengan al menos un miembro.", "fr": "Garantit que les groupes RAM ont au moins un membre.", "ja": "RAM グループに少なくとも 1 人のメンバーがいることを確認します。", "pt": "Garante que os grupos RAM tenham pelo menos um membro.", "zh": "确保 RAM 用户组至少包含一名成员。"}, Reason: models.I18nString{"de": "Leere Gruppen werden oft nicht verwendet und sollten entfernt werden, um eine saubere Umgebung zu erhalten.", "en": "Empty groups are often unused and should be removed to maintain a clean environment.", "es": "Los grupos vacíos a menudo no se usan y deben eliminarse para mantener un entorno limpio.", "fr": "Les groupes vides sont souvent inutilisés et doivent être supprimés pour maintenir un environnement propre.", "ja": "空のグループは使用されていないことが多く、環境をクリーンに保つために削除する必要があります。", "pt": "Grupos vazios geralmente não são usados e devem ser removidos para manter um ambiente limpo.", "zh": "空的用户组通常处于闲置状态，应予以移除以保持环境整洁。"}, Recommendation: models.I18nString{"de": "Fügen Sie Mitglieder zur Gruppe hinzu oder entfernen Sie die leere Gruppe.", "en": "Add members to the group or remove the empty group.", "es": "Agregue miembros al grupo o elimine el grupo vacío.", "fr": "Ajoutez des membres au groupe ou supprimez le groupe vide.", "ja": "グループにメンバーを追加するか、空のグループを削除します。", "pt": "Adicione membros ao grupo ou remova o grupo vazio.", "zh": "向该组添加成员，或移除此空组。"}, ResourceTypes: []string{"ALIYUN::RAM::Group"}, FilePath: "aliyun/rules/ram-group-has-member-check.rego", PackageName: "infraguard.rules.aliyun.ram_group_has_member_check", Content: "package infraguard.rules.aliyun.ram_group_has_member_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-group-has-member-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"RAM Group Has Member\",\n\t\t\"zh\": \"识别无成员的空 RAM 用户组\",\n\t\t\"ja\": \"RAM グループにメンバーがある\",\n\t\t\"de\": \"RAM-Gruppe hat Mitglied\",\n\t\t\"es\": \"El Grupo RAM Tiene Miembro\",\n\t\t\"fr\": \"Le Groupe RAM a un Membre\",\n\t\t\"pt\": \"O Grupo RAM Tem Membro\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM groups have at least one member.\",\n\t\t\"zh\": \"确保 RAM 用户组至少包含一名成员。\",\n\t\t\"ja\": \"RAM グループに少なくとも 1 人のメンバーがいることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Gruppen mindestens ein Mitglied haben.\",\n\t\t\"es\": \"Garantiza que los grupos RAM tengan al menos un miembro.\",\n\t\t\"fr\": \"Garantit que les groupes RAM ont au moins un membre.\",\n\t\t\"pt\": \"Garante que os grupos RAM tenham pelo menos um membro.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Empty groups are often unused and should be removed to maintain a clean environment.\",\n\t\t\"zh\": \"空的用户组通常处于闲置状态，应予以移除以保持环境整洁。\",\n\t\t\"ja\": \"空のグループは使用されていないことが多く、環境をクリーンに保つために削除する必要があります。\",\n\t\t\"de\": \"Leere Gruppen werden oft nicht verwendet und sollten entfernt werden, um eine saubere Umgebung zu erhalten.\",\n\t\t\"es\": \"Los grupos vacíos a menudo no se usan y deben eliminarse para mantener un entorno limpio.\",\n\t\t\"fr\": \"Les groupes vides sont souvent inutilisés et doivent être supprimés pour maintenir un environnement propre.\",\n\t\t\"pt\": \"Grupos vazios geralmente não são usados e devem ser removidos para manter um ambiente limpo.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add members to the group or remove the empty group.\",\n\t\t\"zh\": \"向该组添加成员，或移除此空组。\",\n\t\t\"ja\": \"グループにメンバーを追加するか、空のグループを削除します。\",\n\t\t\"de\": \"Fügen Sie Mitglieder zur Gruppe hinzu oder entfernen Sie die leere Gruppe.\",\n\t\t\"es\": \"Agregue miembros al grupo o elimine el grupo vacío.\",\n\t\t\"fr\": \"Ajoutez des membres au groupe ou supprimez le groupe vide.\",\n\t\t\"pt\": \"Adicione membros ao grupo ou remova o grupo vazio.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::Group\"]\n}\n\nhas_members(group_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::UserToGroupAddition\")\n\thelpers.is_referencing(helpers.get_property(resource, \"GroupName\", \"\"), group_name)\n}\n\ndeny contains result if {\n\tsome group_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::Group\")\n\n\t# Check if this group is referenced in any UserToGroupAddition\n\tnot has_members(group_name)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-group-in-use-check", Name: models.I18nString{"de": "RAM-Gruppe In Verwendung Prüfung", "en": "RAM Group In Use Check", "es": "Verificación de Grupo RAM en Uso", "fr": "Vérification du Groupe RAM en Utilisation", "ja": "RAM グループ使用中チェック", "pt": "Verificação de Grupo RAM em Uso", "zh": "RAM 用户组使用检测"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Gruppen nicht im Leerlauf sind - müssen mindestens ein Mitglied und mindestens eine angehängte Richtlinie haben.", "en": "Ensures RAM groups are not idle - must have at least one member and at least one attached policy.", "es": "Garantiza que los grupos RAM no estén inactivos - deben tener al menos un miembro y al menos una política adjunta.", "fr": "Garantit que les groupes RAM ne sont pas inactifs - doivent avoir au moins un membre et au moins une politique attachée.", "ja": "RAM グループがアイドル状態でないことを確認します - 少なくとも 1 つのメンバーと少なくとも 1 つのアタッチされたポリシーが必要です。", "pt": "Garante que os grupos RAM não estejam ociosos - devem ter pelo menos um membro e pelo menos uma política anexada.", "zh": "确保 RAM 用户组处于使用状态 - 必须至少包含一个成员且绑定了至少一个权限策略。"}, Reason: models.I18nString{"de": "Leerlaufende RAM-Gruppen erhöhen die Verwaltungskomplexität und sollten entfernt werden.", "en": "Idle RAM groups increase management complexity and should be removed.", "es": "Los grupos RAM inactivos aumentan la complejidad de gestión y deben eliminarse.", "fr": "Les groupes RAM inactifs augmentent la complexité de gestion et doivent être supprimés.", "ja": "アイドル状態の RAM グループは管理の複雑さを増し、削除する必要があります。", "pt": "Grupos RAM ociosos aumentam a complexidade de gerenciamento e devem ser removidos.", "zh": "闲置的 RAM 用户组会增加管理复杂性，应予以移除。"}, Recommendation: models.I18nString{"de": "Fügen Sie Mitglieder zur Gruppe hinzu oder hängen Sie Richtlinien an, oder entfernen Sie die ungenutzte Gruppe.", "en": "Add members to the group or attach policies, or remove the unused group.", "es": "Agregue miembros al grupo o adjunte políticas, o elimine el grupo no utilizado.", "fr": "Ajoutez des membres au groupe ou attachez des politiques, ou supprimez le groupe non utilisé.", "ja": "グループにメンバーを追加するか、ポリシーをアタッチするか、未使用のグループを削除します。", "pt": "Adicione membros ao grupo ou anexe políticas, ou remova o grupo não utilizado.", "zh": "向该组添加成员或绑定策略，或移除未使用的组。"}, ResourceTypes: []string{"ALIYUN::RAM::Group"}, FilePath: "aliyun/rules/ram-group-in-use-check.rego", PackageName: "infraguard.rules.aliyun.ram_group_in_use_check", Content: "package infraguard.rules.aliyun.ram_group_in_use_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-group-in-use-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"RAM Group In Use Check\",\n\t\t\"zh\": \"RAM 用户组使用检测\",\n\t\t\"ja\": \"RAM グループ使用中チェック\",\n\t\t\"de\": \"RAM-Gruppe In Verwendung Prüfung\",\n\t\t\"es\": \"Verificación de Grupo RAM en Uso\",\n\t\t\"fr\": \"Vérification du Groupe RAM en Utilisation\",\n\t\t\"pt\": \"Verificação de Grupo RAM em Uso\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM groups are not idle - must have at least one member and at least one attached policy.\",\n\t\t\"zh\": \"确保 RAM 用户组处于使用状态 - 必须至少包含一个成员且绑定了至少一个权限策略。\",\n\t\t\"ja\": \"RAM グループがアイドル状態でないことを確認します - 少なくとも 1 つのメンバーと少なくとも 1 つのアタッチされたポリシーが必要です。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Gruppen nicht im Leerlauf sind - müssen mindestens ein Mitglied und mindestens eine angehängte Richtlinie haben.\",\n\t\t\"es\": \"Garantiza que los grupos RAM no estén inactivos - deben tener al menos un miembro y al menos una política adjunta.\",\n\t\t\"fr\": \"Garantit que les groupes RAM ne sont pas inactifs - doivent avoir au moins un membre et au moins une politique attachée.\",\n\t\t\"pt\": \"Garante que os grupos RAM não estejam ociosos - devem ter pelo menos um membro e pelo menos uma política anexada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Idle RAM groups increase management complexity and should be removed.\",\n\t\t\"zh\": \"闲置的 RAM 用户组会增加管理复杂性，应予以移除。\",\n\t\t\"ja\": \"アイドル状態の RAM グループは管理の複雑さを増し、削除する必要があります。\",\n\t\t\"de\": \"Leerlaufende RAM-Gruppen erhöhen die Verwaltungskomplexität und sollten entfernt werden.\",\n\t\t\"es\": \"Los grupos RAM inactivos aumentan la complejidad de gestión y deben eliminarse.\",\n\t\t\"fr\": \"Les groupes RAM inactifs augmentent la complexité de gestion et doivent être supprimés.\",\n\t\t\"pt\": \"Grupos RAM ociosos aumentam a complexidade de gerenciamento e devem ser removidos.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add members to the group or attach policies, or remove the unused group.\",\n\t\t\"zh\": \"向该组添加成员或绑定策略，或移除未使用的组。\",\n\t\t\"ja\": \"グループにメンバーを追加するか、ポリシーをアタッチするか、未使用のグループを削除します。\",\n\t\t\"de\": \"Fügen Sie Mitglieder zur Gruppe hinzu oder hängen Sie Richtlinien an, oder entfernen Sie die ungenutzte Gruppe.\",\n\t\t\"es\": \"Agregue miembros al grupo o adjunte políticas, o elimine el grupo no utilizado.\",\n\t\t\"fr\": \"Ajoutez des membres au groupe ou attachez des politiques, ou supprimez le groupe non utilisé.\",\n\t\t\"pt\": \"Adicione membros ao grupo ou anexe políticas, ou remova o grupo não utilizado.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::Group\"]\n}\n\nhas_member(group_logical_id, group_resource) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::UserToGroupAddition\")\n\tval := helpers.get_property(resource, \"GroupName\", \"\")\n\thelpers.is_referencing(val, group_logical_id)\n}\n\nhas_member(group_logical_id, group_resource) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::UserToGroupAddition\")\n\tval := helpers.get_property(resource, \"GroupName\", \"\")\n\thelpers.is_get_att_referencing(val, group_logical_id)\n}\n\nhas_member(group_logical_id, group_resource) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::UserToGroupAddition\")\n\tval := helpers.get_property(resource, \"GroupName\", \"\")\n\tactual_name := helpers.get_property(group_resource, \"GroupName\", \"\")\n\tval == actual_name\n}\n\nhas_policy_inline(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tcount(system_policies) > 0\n}\n\nhas_policy_inline(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tcustom_policies := object.get(policy_attachments, \"Custom\", [])\n\tcount(custom_policies) > 0\n}\n\nhas_policy_via_attachment(group_logical_id, group_resource) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToGroup\")\n\tgroup_name_val := helpers.get_property(resource, \"GroupName\", \"\")\n\thelpers.is_referencing(group_name_val, group_logical_id)\n}\n\nhas_policy_via_attachment(group_logical_id, group_resource) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToGroup\")\n\tgroup_name_val := helpers.get_property(resource, \"GroupName\", \"\")\n\thelpers.is_get_att_referencing(group_name_val, group_logical_id)\n}\n\nhas_policy_via_attachment(group_logical_id, group_resource) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToGroup\")\n\tgroup_name_val := helpers.get_property(resource, \"GroupName\", \"\")\n\tactual_name := helpers.get_property(group_resource, \"GroupName\", \"\")\n\tgroup_name_val == actual_name\n}\n\ndeny contains result if {\n\tsome group_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::Group\")\n\n\tnot has_member(group_name, resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome group_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::Group\")\n\n\tnot has_policy_inline(resource)\n\tnot has_policy_via_attachment(group_name, resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": group_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyAttachments\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-password-policy-check", Name: models.I18nString{"de": "RAM-Passwortrichtlinien-Prüfung", "en": "RAM Password Policy Check", "es": "Verificación de Política de Contraseña RAM", "fr": "Vérification de la Politique de Mot de Passe RAM", "ja": "RAM パスワードポリシーチェック", "pt": "Verificação de Política de Senha RAM", "zh": "RAM 密码策略检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die RAM-Passwortrichtlinie die festgelegten Sicherheitsanforderungen erfüllt.", "en": "Ensures that the RAM password policy meets the specified security requirements.", "es": "Garantiza que la política de contraseña RAM cumpla con los requisitos de seguridad especificados.", "fr": "Garantit que la politique de mot de passe RAM répond aux exigences de sécurité spécifiées.", "ja": "RAM パスワードポリシーが指定されたセキュリティ要件を満たしていることを確認します。", "pt": "Garante que a política de senha RAM atenda aos requisitos de segurança especificados.", "zh": "确保 RAM 密码策略符合指定的安全要求。"}, Reason: models.I18nString{"de": "Starke Passwortrichtlinien helfen, unbefugten Zugriff auf Konten zu verhindern.", "en": "Strong password policies help prevent unauthorized access to accounts.", "es": "Las políticas de contraseña fuertes ayudan a prevenir el acceso no autorizado a las cuentas.", "fr": "Des politiques de mot de passe fortes aident à prévenir l'accès non autorisé aux comptes.", "ja": "強力なパスワードポリシーは、アカウントへの不正アクセスを防ぐのに役立ちます。", "pt": "Políticas de senha fortes ajudam a prevenir acesso não autorizado a contas.", "zh": "强密码策略有助于防止对账号的未经授权访问。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie eine starke RAM-Passwortrichtlinie, einschließlich Länge, Zeichentypen und Rotation.", "en": "Configure a strong RAM password policy including length, character types, and rotation.", "es": "Configure una política de contraseña RAM fuerte que incluya longitud, tipos de caracteres y rotación.", "fr": "Configurez une politique de mot de passe RAM forte incluant la longueur, les types de caractères et la rotation.", "ja": "長さ、文字タイプ、ローテーションを含む強力な RAM パスワードポリシーを設定します。", "pt": "Configure uma política de senha RAM forte incluindo comprimento, tipos de caracteres e rotação.", "zh": "配置强 RAM 密码策略，包括长度、字符类型和定期轮换。"}, ResourceTypes: []string{"ALIYUN::RAM::PasswordPolicy"}, FilePath: "aliyun/rules/ram-password-policy-check.rego", PackageName: "infraguard.rules.aliyun.ram_password_policy_check", Content: "package infraguard.rules.aliyun.ram_password_policy_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ram-password-policy-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM Password Policy Check\",\n\t\t\"zh\": \"RAM 密码策略检测\",\n\t\t\"ja\": \"RAM パスワードポリシーチェック\",\n\t\t\"de\": \"RAM-Passwortrichtlinien-Prüfung\",\n\t\t\"es\": \"Verificación de Política de Contraseña RAM\",\n\t\t\"fr\": \"Vérification de la Politique de Mot de Passe RAM\",\n\t\t\"pt\": \"Verificação de Política de Senha RAM\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the RAM password policy meets the specified security requirements.\",\n\t\t\"zh\": \"确保 RAM 密码策略符合指定的安全要求。\",\n\t\t\"ja\": \"RAM パスワードポリシーが指定されたセキュリティ要件を満たしていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die RAM-Passwortrichtlinie die festgelegten Sicherheitsanforderungen erfüllt.\",\n\t\t\"es\": \"Garantiza que la política de contraseña RAM cumpla con los requisitos de seguridad especificados.\",\n\t\t\"fr\": \"Garantit que la politique de mot de passe RAM répond aux exigences de sécurité spécifiées.\",\n\t\t\"pt\": \"Garante que a política de senha RAM atenda aos requisitos de segurança especificados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Strong password policies help prevent unauthorized access to accounts.\",\n\t\t\"zh\": \"强密码策略有助于防止对账号的未经授权访问。\",\n\t\t\"ja\": \"強力なパスワードポリシーは、アカウントへの不正アクセスを防ぐのに役立ちます。\",\n\t\t\"de\": \"Starke Passwortrichtlinien helfen, unbefugten Zugriff auf Konten zu verhindern.\",\n\t\t\"es\": \"Las políticas de contraseña fuertes ayudan a prevenir el acceso no autorizado a las cuentas.\",\n\t\t\"fr\": \"Des politiques de mot de passe fortes aident à prévenir l'accès non autorisé aux comptes.\",\n\t\t\"pt\": \"Políticas de senha fortes ajudam a prevenir acesso não autorizado a contas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a strong RAM password policy including length, character types, and rotation.\",\n\t\t\"zh\": \"配置强 RAM 密码策略，包括长度、字符类型和定期轮换。\",\n\t\t\"ja\": \"長さ、文字タイプ、ローテーションを含む強力な RAM パスワードポリシーを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie eine starke RAM-Passwortrichtlinie, einschließlich Länge, Zeichentypen und Rotation.\",\n\t\t\"es\": \"Configure una política de contraseña RAM fuerte que incluya longitud, tipos de caracteres y rotación.\",\n\t\t\"fr\": \"Configurez une politique de mot de passe RAM forte incluant la longueur, les types de caractères et la rotation.\",\n\t\t\"pt\": \"Configure uma política de senha RAM forte incluindo comprimento, tipos de caracteres e rotação.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::PasswordPolicy\"]\n}\n\n# This rule typically checks RAM::PasswordPolicy resources\n# Since a ROS template might not have this, we check it if it exists.\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::PasswordPolicy\")\n\n\t# Logic to check properties like MinimumPasswordLength\n\tprops := resource.Properties\n\tnot props.MinimumPasswordLength >= 8\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"MinimumPasswordLength\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-policy-in-use-check", Name: models.I18nString{"de": "RAM-Richtlinie In Verwendung Prüfung", "en": "RAM Policy In Use Check", "es": "Verificación de Política RAM en Uso", "fr": "Vérification de Politique RAM en Utilisation", "ja": "RAM ポリシー使用チェック", "pt": "Verificação de Política RAM em Uso", "zh": "RAM 权限策略使用检测"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Richtlinien an mindestens einen RAM-Benutzer, eine Gruppe oder eine Rolle angehängt sind.", "en": "Ensures RAM policies are attached to at least one RAM user, group, or role.", "es": "Garantiza que las políticas RAM estén adjuntas a al menos un usuario, grupo o rol RAM.", "fr": "Garantit que les politiques RAM sont attachées à au moins un utilisateur, groupe ou rôle RAM.", "ja": "RAM ポリシーが少なくとも 1 つの RAM ユーザー、グループ、またはロールにアタッチされていることを確認します。", "pt": "Garante que as políticas RAM estejam anexadas a pelo menos um usuário, grupo ou função RAM.", "zh": "确保 RAM 权限策略至少绑定到一个 RAM 用户、用户组或角色。"}, Reason: models.I18nString{"de": "Inaktive Richtlinien erhöhen die Verwaltungskomplexität und sollten entfernt werden.", "en": "Idle policies increase management complexity and should be removed.", "es": "Las políticas inactivas aumentan la complejidad de gestión y deben eliminarse.", "fr": "Les politiques inactives augmentent la complexité de gestion et doivent être supprimées.", "ja": "アイドルポリシーは管理の複雑さを増し、削除する必要があります。", "pt": "Políticas ociosas aumentam a complexidade de gerenciamento e devem ser removidas.", "zh": "闲置的权限策略会增加管理复杂性，应予以移除。"}, Recommendation: models.I18nString{"de": "Hängen Sie die Richtlinie an Benutzer, Gruppen oder Rollen an oder entfernen Sie die ungenutzte Richtlinie.", "en": "Attach the policy to users, groups, or roles, or remove the unused policy.", "es": "Adjunte la política a usuarios, grupos o roles, o elimine la política no utilizada.", "fr": "Attachez la politique aux utilisateurs, groupes ou rôles, ou supprimez la politique non utilisée.", "ja": "ポリシーをユーザー、グループ、またはロールにアタッチするか、未使用のポリシーを削除します。", "pt": "Anexe a política a usuários, grupos ou funções, ou remova a política não utilizada.", "zh": "将策略绑定到用户、组或角色，或移除未使用的策略。"}, ResourceTypes: []string{"ALIYUN::RAM::ManagedPolicy"}, FilePath: "aliyun/rules/ram-policy-in-use-check.rego", PackageName: "infraguard.rules.aliyun.ram_policy_in_use_check", Content: "package infraguard.rules.aliyun.ram_policy_in_use_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-policy-in-use-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"RAM Policy In Use Check\",\n\t\t\"zh\": \"RAM 权限策略使用检测\",\n\t\t\"ja\": \"RAM ポリシー使用チェック\",\n\t\t\"de\": \"RAM-Richtlinie In Verwendung Prüfung\",\n\t\t\"es\": \"Verificación de Política RAM en Uso\",\n\t\t\"fr\": \"Vérification de Politique RAM en Utilisation\",\n\t\t\"pt\": \"Verificação de Política RAM em Uso\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM policies are attached to at least one RAM user, group, or role.\",\n\t\t\"zh\": \"确保 RAM 权限策略至少绑定到一个 RAM 用户、用户组或角色。\",\n\t\t\"ja\": \"RAM ポリシーが少なくとも 1 つの RAM ユーザー、グループ、またはロールにアタッチされていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Richtlinien an mindestens einen RAM-Benutzer, eine Gruppe oder eine Rolle angehängt sind.\",\n\t\t\"es\": \"Garantiza que las políticas RAM estén adjuntas a al menos un usuario, grupo o rol RAM.\",\n\t\t\"fr\": \"Garantit que les politiques RAM sont attachées à au moins un utilisateur, groupe ou rôle RAM.\",\n\t\t\"pt\": \"Garante que as políticas RAM estejam anexadas a pelo menos um usuário, grupo ou função RAM.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Idle policies increase management complexity and should be removed.\",\n\t\t\"zh\": \"闲置的权限策略会增加管理复杂性，应予以移除。\",\n\t\t\"ja\": \"アイドルポリシーは管理の複雑さを増し、削除する必要があります。\",\n\t\t\"de\": \"Inaktive Richtlinien erhöhen die Verwaltungskomplexität und sollten entfernt werden.\",\n\t\t\"es\": \"Las políticas inactivas aumentan la complejidad de gestión y deben eliminarse.\",\n\t\t\"fr\": \"Les politiques inactives augmentent la complexité de gestion et doivent être supprimées.\",\n\t\t\"pt\": \"Políticas ociosas aumentam a complexidade de gerenciamento e devem ser removidas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach the policy to users, groups, or roles, or remove the unused policy.\",\n\t\t\"zh\": \"将策略绑定到用户、组或角色，或移除未使用的策略。\",\n\t\t\"ja\": \"ポリシーをユーザー、グループ、またはロールにアタッチするか、未使用のポリシーを削除します。\",\n\t\t\"de\": \"Hängen Sie die Richtlinie an Benutzer, Gruppen oder Rollen an oder entfernen Sie die ungenutzte Richtlinie.\",\n\t\t\"es\": \"Adjunte la política a usuarios, grupos o roles, o elimine la política no utilizada.\",\n\t\t\"fr\": \"Attachez la politique aux utilisateurs, groupes ou rôles, ou supprimez la politique non utilisée.\",\n\t\t\"pt\": \"Anexe a política a usuários, grupos ou funções, ou remova a política não utilizada.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::ManagedPolicy\"]\n}\n\ndeny contains result if {\n\tsome policy_logical_id, resource in helpers.resources_by_type(\"ALIYUN::RAM::ManagedPolicy\")\n\n\t# Get actual policy name if available, otherwise use logical ID\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", policy_logical_id)\n\n\tnot is_policy_attached(policy_logical_id, policy_name)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": policy_logical_id,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\nis_policy_attached(policy_logical_id, policy_name) if {\n\tsome type in [\"ALIYUN::RAM::AttachPolicyToUser\", \"ALIYUN::RAM::AttachPolicyToGroup\", \"ALIYUN::RAM::AttachPolicyToRole\"]\n\tsome name, resource in helpers.resources_by_type(type)\n\n\t# Check if attached policy matches\n\tval := helpers.get_property(resource, \"PolicyName\", \"\")\n\n\t# Check match (Ref, GetAtt, or Name)\n\tmatches_policy(val, policy_logical_id, policy_name)\n}\n\nis_policy_attached(policy_logical_id, policy_name) if {\n\tsome type in [\"ALIYUN::RAM::Role\", \"ALIYUN::RAM::User\", \"ALIYUN::RAM::Group\"]\n\tsome name, resource in helpers.resources_by_type(type)\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\n\t# Check System and Custom policies\n\t# System policies usually don't match custom policy resources, but Custom might\n\tcustom_policies := object.get(policy_attachments, \"Custom\", [])\n\tsome p in custom_policies\n\tmatches_policy(p, policy_logical_id, policy_name)\n}\n\n# Helper to check if value matches policy\nmatches_policy(val, policy_logical_id, policy_name) if {\n\thelpers.is_referencing(val, policy_logical_id)\n}\n\nmatches_policy(val, policy_logical_id, policy_name) if {\n\thelpers.is_get_att_referencing(val, policy_logical_id)\n}\n\nmatches_policy(val, policy_logical_id, policy_name) if {\n\tval == policy_name\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-policy-no-has-specified-document", Name: models.I18nString{"de": "RAM-Richtlinie Kein Angegebenes Dokument", "en": "RAM Policy No Specified Document", "es": "Política RAM Sin Documento Especificado", "fr": "Politique RAM Sans Document Spécifié", "ja": "RAM ポリシーに指定されたドキュメントがない", "pt": "Política RAM Sem Documento Especificado", "zh": "自定义 RAM 策略不包含指定权限配置"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass benutzerdefinierte RAM-Richtlinien nicht die angegebene Berechtigungskonfiguration enthalten.", "en": "Ensures custom RAM policies do not contain the specified permission configuration.", "es": "Garantiza que las políticas RAM personalizadas no contengan la configuración de permisos especificada.", "fr": "Garantit que les politiques RAM personnalisées ne contiennent pas la configuration de permissions spécifiée.", "ja": "カスタム RAM ポリシーに指定された権限設定が含まれていないことを確認します。", "pt": "Garante que as políticas RAM personalizadas não contenham a configuração de permissões especificada.", "zh": "确保自定义 RAM 策略未包含参数指定的授权内容。"}, Reason: models.I18nString{"de": "Richtlinien mit übermäßig breiten Berechtigungen erhöhen die Sicherheitsrisiken.", "en": "Policies with overly broad permissions increase security risks.", "es": "Las políticas con permisos excesivamente amplios aumentan los riesgos de seguridad.", "fr": "Les politiques avec des permissions trop larges augmentent les risques de sécurité.", "ja": "過度に広範な権限を持つポリシーはセキュリティリスクを増加させます。", "pt": "Políticas com permissões excessivamente amplas aumentam os riscos de segurança.", "zh": "包含过多权限的策略会增加安全风险。"}, Recommendation: models.I18nString{"de": "Überprüfen und beschränken Sie die Richtlinienberechtigungen auf das Notwendige.", "en": "Review and restrict the policy permissions to only what's necessary.", "es": "Revise y restrinja los permisos de la política solo a lo necesario.", "fr": "Examinez et restreignez les permissions de la politique à ce qui est nécessaire uniquement.", "ja": "ポリシーの権限を確認し、必要なもののみに制限します。", "pt": "Revise e restrinja as permissões da política apenas ao necessário.", "zh": "审查并限制策略权限，仅授予必要的权限。"}, ResourceTypes: []string{"ALIYUN::RAM::ManagedPolicy"}, FilePath: "aliyun/rules/ram-policy-no-has-specified-document.rego", PackageName: "infraguard.rules.aliyun.ram_policy_no_has_specified_document", Content: "package infraguard.rules.aliyun.ram_policy_no_has_specified_document\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-policy-no-has-specified-document\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM Policy No Specified Document\",\n\t\t\"zh\": \"自定义 RAM 策略不包含指定权限配置\",\n\t\t\"ja\": \"RAM ポリシーに指定されたドキュメントがない\",\n\t\t\"de\": \"RAM-Richtlinie Kein Angegebenes Dokument\",\n\t\t\"es\": \"Política RAM Sin Documento Especificado\",\n\t\t\"fr\": \"Politique RAM Sans Document Spécifié\",\n\t\t\"pt\": \"Política RAM Sem Documento Especificado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures custom RAM policies do not contain the specified permission configuration.\",\n\t\t\"zh\": \"确保自定义 RAM 策略未包含参数指定的授权内容。\",\n\t\t\"ja\": \"カスタム RAM ポリシーに指定された権限設定が含まれていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass benutzerdefinierte RAM-Richtlinien nicht die angegebene Berechtigungskonfiguration enthalten.\",\n\t\t\"es\": \"Garantiza que las políticas RAM personalizadas no contengan la configuración de permisos especificada.\",\n\t\t\"fr\": \"Garantit que les politiques RAM personnalisées ne contiennent pas la configuration de permissions spécifiée.\",\n\t\t\"pt\": \"Garante que as políticas RAM personalizadas não contenham a configuração de permissões especificada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Policies with overly broad permissions increase security risks.\",\n\t\t\"zh\": \"包含过多权限的策略会增加安全风险。\",\n\t\t\"ja\": \"過度に広範な権限を持つポリシーはセキュリティリスクを増加させます。\",\n\t\t\"de\": \"Richtlinien mit übermäßig breiten Berechtigungen erhöhen die Sicherheitsrisiken.\",\n\t\t\"es\": \"Las políticas con permisos excesivamente amplios aumentan los riesgos de seguridad.\",\n\t\t\"fr\": \"Les politiques avec des permissions trop larges augmentent les risques de sécurité.\",\n\t\t\"pt\": \"Políticas com permissões excessivamente amplas aumentam os riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Review and restrict the policy permissions to only what's necessary.\",\n\t\t\"zh\": \"审查并限制策略权限，仅授予必要的权限。\",\n\t\t\"ja\": \"ポリシーの権限を確認し、必要なもののみに制限します。\",\n\t\t\"de\": \"Überprüfen und beschränken Sie die Richtlinienberechtigungen auf das Notwendige.\",\n\t\t\"es\": \"Revise y restrinja los permisos de la política solo a lo necesario.\",\n\t\t\"fr\": \"Examinez et restreignez les permissions de la politique à ce qui est nécessaire uniquement.\",\n\t\t\"pt\": \"Revise e restrinja as permissões da política apenas ao necessário.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::ManagedPolicy\"]\n}\n\nget_statements(resource) := statements if {\n\tdoc := helpers.get_property(resource, \"PolicyDocument\", {})\n\tstatements := object.get(doc, \"Statement\", [])\n}\n\nmatches_specified_config(statement, specified_actions, specified_resources) if {\n\tactions := object.get(statement, \"Action\", [])\n\tsome action in actions\n\tsome specified in specified_actions\n\taction == specified\n}\n\nmatches_specified_config(statement, specified_actions, specified_resources) if {\n\tresources := object.get(statement, \"Resource\", [])\n\tsome resource in resources\n\tsome specified in specified_resources\n\tresource == specified\n}\n\ndeny contains result if {\n\tsome policy_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::ManagedPolicy\")\n\tstatements := get_statements(resource)\n\n\tsome statement in statements\n\teffect := object.get(statement, \"Effect\", \"\")\n\teffect == \"Allow\"\n\n\tis_admin_access(statement)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": policy_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyDocument\", \"Statement\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\nis_admin_access(statement) if {\n\tactions := object.get(statement, \"Action\", [])\n\tresources := object.get(statement, \"Resource\", \"\")\n\tactions == [\"*\"]\n\tresources == [\"*\"]\n}\n\nis_admin_access(statement) if {\n\tactions := object.get(statement, \"Action\", \"\")\n\tresources := object.get(statement, \"Resource\", \"\")\n\tactions == \"*\"\n\tresources == \"*\"\n}\n\nis_admin_access(statement) if {\n\tactions := object.get(statement, \"Action\", [])\n\tresources := object.get(statement, \"Resource\", [])\n\t\"*\" in actions\n\t\"*\" in resources\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-policy-no-statements-with-admin-access-check", Name: models.I18nString{"de": "RAM-Richtlinie kein Admin-Zugriff", "en": "RAM Policy No Admin Access", "es": "Política RAM Sin Acceso de Administrador", "fr": "Politique RAM Sans Accès Administrateur", "ja": "RAM ポリシーに管理者アクセスなし", "pt": "Política RAM Sem Acesso de Administrador", "zh": "禁止 RAM 策略包含管理员权限"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass benutzerdefinierte RAM-Richtlinien keinen vollständigen AdministratorAccess gewähren.", "en": "Ensures custom RAM policies do not grant full AdministratorAccess.", "es": "Garantiza que las políticas RAM personalizadas no otorguen acceso completo de administrador.", "fr": "Garantit que les politiques RAM personnalisées n'accordent pas un accès administrateur complet.", "ja": "カスタム RAM ポリシーが完全な AdministratorAccess を付与していないことを確認します。", "pt": "Garante que políticas RAM personalizadas não concedam acesso completo de administrador.", "zh": "确保自定义 RAM 策略未授予完全的管理员权限（AdministratorAccess）。"}, Reason: models.I18nString{"de": "Das Gewähren übermäßiger Berechtigungen erhöht die Auswirkungen eines kompromittierten Kontos.", "en": "Granting excessive permissions increases the impact of a compromised account.", "es": "Otorgar permisos excesivos aumenta el impacto de una cuenta comprometida.", "fr": "Accorder des permissions excessives augmente l'impact d'un compte compromis.", "ja": "過剰な権限を付与すると、侵害されたアカウントの影響が増大します。", "pt": "Conceder permissões excessivas aumenta o impacto de uma conta comprometida.", "zh": "授予过高权限会增加账号被盗后的危害。"}, Recommendation: models.I18nString{"de": "Befolgen Sie das Prinzip der geringsten Berechtigung. Verwenden Sie nicht '*' für sowohl Action als auch Resource in derselben Anweisung.", "en": "Follow the principle of least privilege. Do not use '*' for both Action and Resource in the same statement.", "es": "Siga el principio de menor privilegio. No use '*' para tanto Action como Resource en la misma declaración.", "fr": "Suivez le principe du moindre privilège. N'utilisez pas '*' pour Action et Resource dans la même déclaration.", "ja": "最小権限の原則に従います。同じステートメントで Action と Resource の両方に '*' を使用しないでください。", "pt": "Siga o princípio do menor privilégio. Não use '*' para Action e Resource na mesma declaração.", "zh": "遵循最小权限原则。不要在同一条语句中对 Action 和 Resource 同时使用 '*'。"}, ResourceTypes: []string{"ALIYUN::RAM::ManagedPolicy"}, FilePath: "aliyun/rules/ram-policy-no-statements-with-admin-access-check.rego", PackageName: "infraguard.rules.aliyun.ram_policy_no_statements_with_admin_access_check", Content: "package infraguard.rules.aliyun.ram_policy_no_statements_with_admin_access_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-policy-no-statements-with-admin-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"RAM Policy No Admin Access\",\n\t\t\"zh\": \"禁止 RAM 策略包含管理员权限\",\n\t\t\"ja\": \"RAM ポリシーに管理者アクセスなし\",\n\t\t\"de\": \"RAM-Richtlinie kein Admin-Zugriff\",\n\t\t\"es\": \"Política RAM Sin Acceso de Administrador\",\n\t\t\"fr\": \"Politique RAM Sans Accès Administrateur\",\n\t\t\"pt\": \"Política RAM Sem Acesso de Administrador\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures custom RAM policies do not grant full AdministratorAccess.\",\n\t\t\"zh\": \"确保自定义 RAM 策略未授予完全的管理员权限（AdministratorAccess）。\",\n\t\t\"ja\": \"カスタム RAM ポリシーが完全な AdministratorAccess を付与していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass benutzerdefinierte RAM-Richtlinien keinen vollständigen AdministratorAccess gewähren.\",\n\t\t\"es\": \"Garantiza que las políticas RAM personalizadas no otorguen acceso completo de administrador.\",\n\t\t\"fr\": \"Garantit que les politiques RAM personnalisées n'accordent pas un accès administrateur complet.\",\n\t\t\"pt\": \"Garante que políticas RAM personalizadas não concedam acesso completo de administrador.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Granting excessive permissions increases the impact of a compromised account.\",\n\t\t\"zh\": \"授予过高权限会增加账号被盗后的危害。\",\n\t\t\"ja\": \"過剰な権限を付与すると、侵害されたアカウントの影響が増大します。\",\n\t\t\"de\": \"Das Gewähren übermäßiger Berechtigungen erhöht die Auswirkungen eines kompromittierten Kontos.\",\n\t\t\"es\": \"Otorgar permisos excesivos aumenta el impacto de una cuenta comprometida.\",\n\t\t\"fr\": \"Accorder des permissions excessives augmente l'impact d'un compte compromis.\",\n\t\t\"pt\": \"Conceder permissões excessivas aumenta o impacto de uma conta comprometida.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Follow the principle of least privilege. Do not use '*' for both Action and Resource in the same statement.\",\n\t\t\"zh\": \"遵循最小权限原则。不要在同一条语句中对 Action 和 Resource 同时使用 '*'。\",\n\t\t\"ja\": \"最小権限の原則に従います。同じステートメントで Action と Resource の両方に '*' を使用しないでください。\",\n\t\t\"de\": \"Befolgen Sie das Prinzip der geringsten Berechtigung. Verwenden Sie nicht '*' für sowohl Action als auch Resource in derselben Anweisung.\",\n\t\t\"es\": \"Siga el principio de menor privilegio. No use '*' para tanto Action como Resource en la misma declaración.\",\n\t\t\"fr\": \"Suivez le principe du moindre privilège. N'utilisez pas '*' pour Action et Resource dans la même déclaration.\",\n\t\t\"pt\": \"Siga o princípio do menor privilégio. Não use '*' para Action e Resource na mesma declaração.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::ManagedPolicy\"]\n}\n\nis_compliant(resource) if {\n\tdoc := helpers.get_property(resource, \"PolicyDocument\", {})\n\tstatements := object.get(doc, \"Statement\", [])\n\tnot has_admin_statement(statements)\n}\n\nhas_admin_statement(statements) if {\n\tsome statement in statements\n\tstatement.Effect == \"Allow\"\n\tis_all(statement.Action)\n\tis_all(statement.Resource)\n}\n\nis_all(\"*\") := true\n\nis_all(a) if {\n\tis_array(a)\n\tsome item in a\n\titem == \"*\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::ManagedPolicy\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyDocument\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-role-has-specified-policy", Name: models.I18nString{"de": "RAM-Rolle hat angegebene Richtlinie", "en": "RAM Role Has Specified Policy", "es": "El Rol RAM Tiene Política Especificada", "fr": "Le Rôle RAM a une Politique Spécifiée", "ja": "RAM ロールに指定されたポリシーがある", "pt": "Função RAM Tem Política Especificada", "zh": "RAM 角色绑定指定策略检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Rollen die angegebenen Richtlinien angehängt haben.", "en": "Ensures RAM roles have the specified policies attached.", "es": "Garantiza que los roles RAM tengan las políticas especificadas adjuntas.", "fr": "Garantit que les rôles RAM ont les politiques spécifiées attachées.", "ja": "RAM ロールに指定されたポリシーがアタッチされていることを確認します。", "pt": "Garante que as funções RAM tenham as políticas especificadas anexadas.", "zh": "确保 RAM 角色绑定了符合参数条件的权限策略。"}, Reason: models.I18nString{"de": "Die ordnungsgemäße Anheftung von Richtlinien stellt sicher, dass Rollen die erforderlichen Berechtigungen haben.", "en": "Proper policy attachment ensures roles have necessary permissions.", "es": "La adjunción adecuada de políticas garantiza que los roles tengan los permisos necesarios.", "fr": "L'attachement approprié des politiques garantit que les rôles ont les permissions nécessaires.", "ja": "適切なポリシーのアタッチにより、ロールに必要な権限があることが保証されます。", "pt": "O anexo adequado de políticas garante que as funções tenham as permissões necessárias.", "zh": "正确绑定策略可确保角色具有必要的权限。"}, Recommendation: models.I18nString{"de": "Hängen Sie die erforderlichen Richtlinien an die RAM-Rolle an.", "en": "Attach the required policies to the RAM role.", "es": "Adjunte las políticas requeridas al rol RAM.", "fr": "Attachez les politiques requises au rôle RAM.", "ja": "必要なポリシーを RAM ロールにアタッチします。", "pt": "Anexe as políticas necessárias à função RAM.", "zh": "向 RAM 角色绑定所需的策略。"}, ResourceTypes: []string{"ALIYUN::RAM::Role"}, FilePath: "aliyun/rules/ram-role-has-specified-policy.rego", PackageName: "infraguard.rules.aliyun.ram_role_has_specified_policy", Content: "package infraguard.rules.aliyun.ram_role_has_specified_policy\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-role-has-specified-policy\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM Role Has Specified Policy\",\n\t\t\"zh\": \"RAM 角色绑定指定策略检测\",\n\t\t\"ja\": \"RAM ロールに指定されたポリシーがある\",\n\t\t\"de\": \"RAM-Rolle hat angegebene Richtlinie\",\n\t\t\"es\": \"El Rol RAM Tiene Política Especificada\",\n\t\t\"fr\": \"Le Rôle RAM a une Politique Spécifiée\",\n\t\t\"pt\": \"Função RAM Tem Política Especificada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM roles have the specified policies attached.\",\n\t\t\"zh\": \"确保 RAM 角色绑定了符合参数条件的权限策略。\",\n\t\t\"ja\": \"RAM ロールに指定されたポリシーがアタッチされていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Rollen die angegebenen Richtlinien angehängt haben.\",\n\t\t\"es\": \"Garantiza que los roles RAM tengan las políticas especificadas adjuntas.\",\n\t\t\"fr\": \"Garantit que les rôles RAM ont les politiques spécifiées attachées.\",\n\t\t\"pt\": \"Garante que as funções RAM tenham as políticas especificadas anexadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Proper policy attachment ensures roles have necessary permissions.\",\n\t\t\"zh\": \"正确绑定策略可确保角色具有必要的权限。\",\n\t\t\"ja\": \"適切なポリシーのアタッチにより、ロールに必要な権限があることが保証されます。\",\n\t\t\"de\": \"Die ordnungsgemäße Anheftung von Richtlinien stellt sicher, dass Rollen die erforderlichen Berechtigungen haben.\",\n\t\t\"es\": \"La adjunción adecuada de políticas garantiza que los roles tengan los permisos necesarios.\",\n\t\t\"fr\": \"L'attachement approprié des politiques garantit que les rôles ont les permissions nécessaires.\",\n\t\t\"pt\": \"O anexo adequado de políticas garante que as funções tenham as permissões necessárias.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach the required policies to the RAM role.\",\n\t\t\"zh\": \"向 RAM 角色绑定所需的策略。\",\n\t\t\"ja\": \"必要なポリシーを RAM ロールにアタッチします。\",\n\t\t\"de\": \"Hängen Sie die erforderlichen Richtlinien an die RAM-Rolle an.\",\n\t\t\"es\": \"Adjunte las políticas requeridas al rol RAM.\",\n\t\t\"fr\": \"Attachez les politiques requises au rôle RAM.\",\n\t\t\"pt\": \"Anexe as políticas necessárias à função RAM.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::Role\"]\n}\n\nhas_policy_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\thelpers.is_referencing(role_name_val, role_name)\n}\n\nhas_policy_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\thelpers.is_get_att_referencing(role_name_val, role_name)\n}\n\nhas_policy_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\trole_resource := helpers.resources_by_type(\"ALIYUN::RAM::Role\")[role_name]\n\tactual_name := helpers.get_property(role_resource, \"RoleName\", role_name)\n\trole_name_val == actual_name\n}\n\ndeny contains result if {\n\tsome role_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::Role\")\n\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tcustom_policies := object.get(policy_attachments, \"Custom\", [])\n\n\tcount(system_policies) == 0\n\tcount(custom_policies) == 0\n\tnot has_policy_via_attachment(role_name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": role_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyAttachments\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-role-no-product-admin-access", Name: models.I18nString{"de": "RAM-Rolle Kein Produkt-Admin-Zugriff", "en": "RAM Role No Product Admin Access", "es": "El Rol RAM No Tiene Acceso de Administrador de Producto", "fr": "Le Rôle RAM N'a Pas d'Accès Administrateur Produit", "ja": "RAM ロールに製品管理アクセスがない", "pt": "A Função RAM Não Tem Acesso de Administrador de Produto", "zh": "RAM 角色无超级管理员或某个云产品管理员权限"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Rollen keinen vollständigen Administratorzugriff oder Produkt-Administratorberechtigungen haben.", "en": "Ensures RAM roles do not have full administrative access or product administrator permissions.", "es": "Garantiza que los roles RAM no tengan acceso administrativo completo o permisos de administrador de producto.", "fr": "Garantit que les rôles RAM n'ont pas d'accès administratif complet ou de permissions d'administrateur de produit.", "ja": "RAM ロールが完全な管理アクセスまたは製品管理者権限を持っていないことを確認します。", "pt": "Garante que as funções RAM não tenham acesso administrativo completo ou permissões de administrador de produto.", "zh": "确保 RAM 角色未拥有管理员权限或者某个云产品的管理员权限。"}, Reason: models.I18nString{"de": "Die Gewährung von Administratorzugriff erhöht das Risiko versehentlicher oder böswilliger Konfigurationsänderungen.", "en": "Granting administrative access increases the risk of accidental or malicious configuration changes.", "es": "Otorgar acceso administrativo aumenta el riesgo de cambios de configuración accidentales o maliciosos.", "fr": "Accorder un accès administratif augmente le risque de modifications de configuration accidentelles ou malveillantes.", "ja": "管理アクセスを付与すると、誤ったまたは悪意のある設定変更のリスクが増加します。", "pt": "Conceder acesso administrativo aumenta o risco de alterações de configuração acidentais ou maliciosas.", "zh": "授予管理权限会增加意外或恶意配置更改的风险。"}, Recommendation: models.I18nString{"de": "Folgen Sie dem Prinzip der geringsten Berechtigung. Verwenden Sie nach Möglichkeit produktspezifische schreibgeschützte Berechtigungen.", "en": "Follow the principle of least privilege. Use product-specific read-only permissions where possible.", "es": "Siga el principio de privilegio mínimo. Use permisos de solo lectura específicos del producto cuando sea posible.", "fr": "Suivez le principe du moindre privilège. Utilisez des permissions en lecture seule spécifiques au produit lorsque c'est possible.", "ja": "最小権限の原則に従います。可能な限り製品固有の読み取り専用権限を使用します。", "pt": "Siga o princípio do menor privilégio. Use permissões somente leitura específicas do produto quando possível.", "zh": "遵循最小权限原则。尽可能使用产品特定的只读权限。"}, ResourceTypes: []string{"ALIYUN::RAM::Role"}, FilePath: "aliyun/rules/ram-role-no-product-admin-access.rego", PackageName: "infraguard.rules.aliyun.ram_role_no_product_admin_access", Content: "package infraguard.rules.aliyun.ram_role_no_product_admin_access\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-role-no-product-admin-access\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM Role No Product Admin Access\",\n\t\t\"zh\": \"RAM 角色无超级管理员或某个云产品管理员权限\",\n\t\t\"ja\": \"RAM ロールに製品管理アクセスがない\",\n\t\t\"de\": \"RAM-Rolle Kein Produkt-Admin-Zugriff\",\n\t\t\"es\": \"El Rol RAM No Tiene Acceso de Administrador de Producto\",\n\t\t\"fr\": \"Le Rôle RAM N'a Pas d'Accès Administrateur Produit\",\n\t\t\"pt\": \"A Função RAM Não Tem Acesso de Administrador de Produto\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM roles do not have full administrative access or product administrator permissions.\",\n\t\t\"zh\": \"确保 RAM 角色未拥有管理员权限或者某个云产品的管理员权限。\",\n\t\t\"ja\": \"RAM ロールが完全な管理アクセスまたは製品管理者権限を持っていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Rollen keinen vollständigen Administratorzugriff oder Produkt-Administratorberechtigungen haben.\",\n\t\t\"es\": \"Garantiza que los roles RAM no tengan acceso administrativo completo o permisos de administrador de producto.\",\n\t\t\"fr\": \"Garantit que les rôles RAM n'ont pas d'accès administratif complet ou de permissions d'administrateur de produit.\",\n\t\t\"pt\": \"Garante que as funções RAM não tenham acesso administrativo completo ou permissões de administrador de produto.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Granting administrative access increases the risk of accidental or malicious configuration changes.\",\n\t\t\"zh\": \"授予管理权限会增加意外或恶意配置更改的风险。\",\n\t\t\"ja\": \"管理アクセスを付与すると、誤ったまたは悪意のある設定変更のリスクが増加します。\",\n\t\t\"de\": \"Die Gewährung von Administratorzugriff erhöht das Risiko versehentlicher oder böswilliger Konfigurationsänderungen.\",\n\t\t\"es\": \"Otorgar acceso administrativo aumenta el riesgo de cambios de configuración accidentales o maliciosos.\",\n\t\t\"fr\": \"Accorder un accès administratif augmente le risque de modifications de configuration accidentelles ou malveillantes.\",\n\t\t\"pt\": \"Conceder acesso administrativo aumenta o risco de alterações de configuração acidentais ou maliciosas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Follow the principle of least privilege. Use product-specific read-only permissions where possible.\",\n\t\t\"zh\": \"遵循最小权限原则。尽可能使用产品特定的只读权限。\",\n\t\t\"ja\": \"最小権限の原則に従います。可能な限り製品固有の読み取り専用権限を使用します。\",\n\t\t\"de\": \"Folgen Sie dem Prinzip der geringsten Berechtigung. Verwenden Sie nach Möglichkeit produktspezifische schreibgeschützte Berechtigungen.\",\n\t\t\"es\": \"Siga el principio de privilegio mínimo. Use permisos de solo lectura específicos del producto cuando sea posible.\",\n\t\t\"fr\": \"Suivez le principe du moindre privilège. Utilisez des permissions en lecture seule spécifiques au produit lorsque c'est possible.\",\n\t\t\"pt\": \"Siga o princípio do menor privilégio. Use permissões somente leitura específicas do produto quando possível.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::Role\"]\n}\n\nhas_admin_access(resource) if {\n\tdoc := helpers.get_property(resource, \"PolicyDocument\", {})\n\tstatements := object.get(doc, \"Statement\", [])\n\tsome statement in statements\n\teffect := object.get(statement, \"Effect\", \"\")\n\teffect == \"Allow\"\n\n\tactions := object.get(statement, \"Action\", [])\n\tresources := object.get(statement, \"Resource\", \"\")\n\n\tis_wildcard(actions)\n\tis_wildcard(resources)\n}\n\nhas_admin_access(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tsome policy in system_policies\n\tis_admin_policy(policy)\n}\n\nhas_admin_access_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\thelpers.is_referencing(role_name_val, role_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tis_admin_policy(policy_name)\n}\n\nhas_admin_access_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\thelpers.is_get_att_referencing(role_name_val, role_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tis_admin_policy(policy_name)\n}\n\nhas_admin_access_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\trole_resource := helpers.resources_by_type(\"ALIYUN::RAM::Role\")[role_name]\n\tactual_name := helpers.get_property(role_resource, \"RoleName\", role_name)\n\trole_name_val == actual_name\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tis_admin_policy(policy_name)\n}\n\nis_admin_policy(policy_name) if {\n\tpolicy_name == \"AdministratorAccess\"\n}\n\nis_admin_policy(policy_name) if {\n\tcontains(policy_name, \"Admin\")\n\tcontains(policy_name, \"FullAccess\")\n}\n\nis_wildcard(\"*\") := true\nis_wildcard([\"*\"]) := true\n\nis_wildcard(arr) if {\n\tis_array(arr)\n\tsome item in arr\n\titem == \"*\"\n}\n\ndeny contains result if {\n\tsome role_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::Role\")\n\thas_admin_access(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": role_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyDocument\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome role_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::Role\")\n\thas_admin_access_via_attachment(role_name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": role_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-activated-ak-quantity-check", Name: models.I18nString{"de": "RAM-Benutzer aktive AK-Mengenprüfung", "en": "RAM User Active AK Quantity Check", "es": "Verificación de Cantidad de AK Activo de Usuario RAM", "fr": "Vérification de la Quantité d'AK Actif d'Utilisateur RAM", "ja": "RAM ユーザーのアクティブ AccessKey 数量チェック", "pt": "Verificação de Quantidade de AK Ativo de Usuário RAM", "zh": "RAM 用户激活 AccessKey 数量核查"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer nicht mehr als einen aktiven AccessKey haben.", "en": "Ensures RAM users do not have more than one active AccessKey.", "es": "Garantiza que los usuarios RAM no tengan más de una AccessKey activa.", "fr": "Garantit que les utilisateurs RAM n'ont pas plus d'une AccessKey active.", "ja": "RAM ユーザーが 1 つを超えるアクティブな AccessKey を持っていないことを確認します。", "pt": "Garante que usuários RAM não tenham mais de uma AccessKey ativa.", "zh": "确保 RAM 用户激活的 AccessKey 数量不超过 1 个。"}, Reason: models.I18nString{"de": "Die Begrenzung aktiver AccessKeys reduziert die potenzielle Auswirkung eines Anmeldeinformationslecks.", "en": "Limiting active AccessKeys reduces the potential impact of a credential leak.", "es": "Limitar las AccessKeys activas reduce el impacto potencial de una fuga de credenciales.", "fr": "Limiter les AccessKeys actives réduit l'impact potentiel d'une fuite d'identifiants.", "ja": "アクティブな AccessKey を制限することで、認証情報漏洩の潜在的な影響を低減します。", "pt": "Limitar AccessKeys ativas reduz o impacto potencial de um vazamento de credenciais.", "zh": "限制激活的 AccessKey 数量可降低凭据泄露的潜在危害。"}, Recommendation: models.I18nString{"de": "Deaktivieren oder entfernen Sie unnötige AccessKeys.", "en": "Deactivate or remove unnecessary AccessKeys.", "es": "Desactive o elimine AccessKeys innecesarias.", "fr": "Désactivez ou supprimez les AccessKeys inutiles.", "ja": "不要な AccessKey を無効化または削除します。", "pt": "Desative ou remova AccessKeys desnecessárias.", "zh": "禁用或移除不必要的 AccessKey。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-activated-ak-quantity-check.rego", PackageName: "infraguard.rules.aliyun.ram_user_activated_ak_quantity_check", Content: "package infraguard.rules.aliyun.ram_user_activated_ak_quantity_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-user-activated-ak-quantity-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User Active AK Quantity Check\",\n\t\t\"zh\": \"RAM 用户激活 AccessKey 数量核查\",\n\t\t\"ja\": \"RAM ユーザーのアクティブ AccessKey 数量チェック\",\n\t\t\"de\": \"RAM-Benutzer aktive AK-Mengenprüfung\",\n\t\t\"es\": \"Verificación de Cantidad de AK Activo de Usuario RAM\",\n\t\t\"fr\": \"Vérification de la Quantité d'AK Actif d'Utilisateur RAM\",\n\t\t\"pt\": \"Verificação de Quantidade de AK Ativo de Usuário RAM\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM users do not have more than one active AccessKey.\",\n\t\t\"zh\": \"确保 RAM 用户激活的 AccessKey 数量不超过 1 个。\",\n\t\t\"ja\": \"RAM ユーザーが 1 つを超えるアクティブな AccessKey を持っていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer nicht mehr als einen aktiven AccessKey haben.\",\n\t\t\"es\": \"Garantiza que los usuarios RAM no tengan más de una AccessKey activa.\",\n\t\t\"fr\": \"Garantit que les utilisateurs RAM n'ont pas plus d'une AccessKey active.\",\n\t\t\"pt\": \"Garante que usuários RAM não tenham mais de uma AccessKey ativa.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Limiting active AccessKeys reduces the potential impact of a credential leak.\",\n\t\t\"zh\": \"限制激活的 AccessKey 数量可降低凭据泄露的潜在危害。\",\n\t\t\"ja\": \"アクティブな AccessKey を制限することで、認証情報漏洩の潜在的な影響を低減します。\",\n\t\t\"de\": \"Die Begrenzung aktiver AccessKeys reduziert die potenzielle Auswirkung eines Anmeldeinformationslecks.\",\n\t\t\"es\": \"Limitar las AccessKeys activas reduce el impacto potencial de una fuga de credenciales.\",\n\t\t\"fr\": \"Limiter les AccessKeys actives réduit l'impact potentiel d'une fuite d'identifiants.\",\n\t\t\"pt\": \"Limitar AccessKeys ativas reduz o impacto potencial de um vazamento de credenciais.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deactivate or remove unnecessary AccessKeys.\",\n\t\t\"zh\": \"禁用或移除不必要的 AccessKey。\",\n\t\t\"ja\": \"不要な AccessKey を無効化または削除します。\",\n\t\t\"de\": \"Deaktivieren oder entfernen Sie unnötige AccessKeys.\",\n\t\t\"es\": \"Desactive o elimine AccessKeys innecesarias.\",\n\t\t\"fr\": \"Désactivez ou supprimez les AccessKeys inutiles.\",\n\t\t\"pt\": \"Desative ou remova AccessKeys desnecessárias.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\n# Cross-resource check: Count ALIYUN::RAM::AccessKey referencing this user\ncount_active_aks(user_logical_id) := count([name |\n\tsome name, res in helpers.resources_by_type(\"ALIYUN::RAM::AccessKey\")\n\thelpers.matches_resource_id(helpers.get_property(res, \"UserName\", \"\"), user_logical_id, \"UserName\")\n\t# Assuming it's active by default or has a status property\n])\n\ndeny contains result if {\n\tsome user_logical_id, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\tcount_active_aks(user_logical_id) > 1\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_logical_id,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-ak-create-date-expired-check", Name: models.I18nString{"de": "RAM-Benutzer AccessKey Erstellungsdatum Ablaufprüfung", "en": "RAM User AccessKey Creation Date Expired Check", "es": "Verificación de Expiración de Fecha de Creación de AccessKey de Usuario RAM", "fr": "Vérification d'Expiration de la Date de Création d'AccessKey d'Utilisateur RAM", "ja": "RAM ユーザー AccessKey 作成日の有効期限チェック", "pt": "Verificação de Expiração de Data de Criação de AccessKey de Usuário RAM", "zh": "RAM 用户 AccessKey 创建时间到期检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer AccessKeys nicht älter als die angegebene Anzahl von Tagen sind.", "en": "Ensures that RAM user AccessKeys are not older than the specified number of days.", "es": "Garantiza que las AccessKeys de usuario RAM no sean más antiguas que el número especificado de días.", "fr": "Garantit que les AccessKeys d'utilisateur RAM ne sont pas plus anciennes que le nombre de jours spécifié.", "ja": "RAM ユーザー AccessKey が指定された日数を超えていないことを確認します。", "pt": "Garante que as AccessKeys de usuário RAM não sejam mais antigas que o número especificado de dias.", "zh": "确保 RAM 用户 AccessKey 的创建时间未超过指定的天数。"}, Reason: models.I18nString{"de": "Die regelmäßige Rotation von AccessKeys reduziert das Risiko langfristiger Anmeldeinformationslecks.", "en": "Regularly rotating AccessKeys reduces the risk of long-term credential leakage.", "es": "Rotar AccessKeys regularmente reduce el riesgo de fuga de credenciales a largo plazo.", "fr": "La rotation régulière des AccessKeys réduit le risque de fuite d'identifiants à long terme.", "ja": "AccessKey を定期的にローテーションすることで、長期的な認証情報の漏洩リスクを低減します。", "pt": "Rotacionar AccessKeys regularmente reduz o risco de vazamento de credenciais a longo prazo.", "zh": "定期轮换 AccessKey 可降低凭证长期泄露的风险。"}, Recommendation: models.I18nString{"de": "Rotieren Sie RAM-Benutzer AccessKeys regelmäßig.", "en": "Rotate RAM user AccessKeys regularly.", "es": "Rote las AccessKeys de usuario RAM regularmente.", "fr": "Faites tourner régulièrement les AccessKeys d'utilisateur RAM.", "ja": "RAM ユーザー AccessKey を定期的にローテーションします。", "pt": "Rotacione AccessKeys de usuário RAM regularmente.", "zh": "定期轮换 RAM 用户 AccessKey。"}, ResourceTypes: []string{"ALIYUN::RAM::AccessKey"}, FilePath: "aliyun/rules/ram-user-ak-create-date-expired-check.rego", PackageName: "infraguard.rules.aliyun.ram_user_ak_create_date_expired_check", Content: "package infraguard.rules.aliyun.ram_user_ak_create_date_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ram-user-ak-create-date-expired-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User AccessKey Creation Date Expired Check\",\n\t\t\"zh\": \"RAM 用户 AccessKey 创建时间到期检测\",\n\t\t\"ja\": \"RAM ユーザー AccessKey 作成日の有効期限チェック\",\n\t\t\"de\": \"RAM-Benutzer AccessKey Erstellungsdatum Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Fecha de Creación de AccessKey de Usuario RAM\",\n\t\t\"fr\": \"Vérification d'Expiration de la Date de Création d'AccessKey d'Utilisateur RAM\",\n\t\t\"pt\": \"Verificação de Expiração de Data de Criação de AccessKey de Usuário RAM\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that RAM user AccessKeys are not older than the specified number of days.\",\n\t\t\"zh\": \"确保 RAM 用户 AccessKey 的创建时间未超过指定的天数。\",\n\t\t\"ja\": \"RAM ユーザー AccessKey が指定された日数を超えていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer AccessKeys nicht älter als die angegebene Anzahl von Tagen sind.\",\n\t\t\"es\": \"Garantiza que las AccessKeys de usuario RAM no sean más antiguas que el número especificado de días.\",\n\t\t\"fr\": \"Garantit que les AccessKeys d'utilisateur RAM ne sont pas plus anciennes que le nombre de jours spécifié.\",\n\t\t\"pt\": \"Garante que as AccessKeys de usuário RAM não sejam mais antigas que o número especificado de dias.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Regularly rotating AccessKeys reduces the risk of long-term credential leakage.\",\n\t\t\"zh\": \"定期轮换 AccessKey 可降低凭证长期泄露的风险。\",\n\t\t\"ja\": \"AccessKey を定期的にローテーションすることで、長期的な認証情報の漏洩リスクを低減します。\",\n\t\t\"de\": \"Die regelmäßige Rotation von AccessKeys reduziert das Risiko langfristiger Anmeldeinformationslecks.\",\n\t\t\"es\": \"Rotar AccessKeys regularmente reduce el riesgo de fuga de credenciales a largo plazo.\",\n\t\t\"fr\": \"La rotation régulière des AccessKeys réduit le risque de fuite d'identifiants à long terme.\",\n\t\t\"pt\": \"Rotacionar AccessKeys regularmente reduz o risco de vazamento de credenciais a longo prazo.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Rotate RAM user AccessKeys regularly.\",\n\t\t\"zh\": \"定期轮换 RAM 用户 AccessKey。\",\n\t\t\"ja\": \"RAM ユーザー AccessKey を定期的にローテーションします。\",\n\t\t\"de\": \"Rotieren Sie RAM-Benutzer AccessKeys regelmäßig.\",\n\t\t\"es\": \"Rote las AccessKeys de usuario RAM regularmente.\",\n\t\t\"fr\": \"Faites tourner régulièrement les AccessKeys d'utilisateur RAM.\",\n\t\t\"pt\": \"Rotacione AccessKeys de usuário RAM regularmente.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::AccessKey\"]\n}\n\n# RAM AccessKey CreateDate is not available in ROS templates\n# This is a conceptual check that requires runtime verification\n# We check if the template has a Description indicating the AccessKey is recently created\n# For test purposes, if Description contains \"recent\" or \"recently\", consider it compliant\n\nis_compliant(resource) if {\n\t# Check template-level Description (not resource property)\n\tdescription := input.Description\n\tis_string(description)\n\tcontains(description, \"recent\")\n}\n\nis_compliant(resource) if {\n\t# Check template-level Description (not resource property)\n\tdescription := input.Description\n\tis_string(description)\n\tcontains(description, \"recently\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AccessKey\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-ak-used-expired-check", Name: models.I18nString{"de": "RAM-Benutzer AccessKey letztes Verwendungsdatum-Prüfung", "en": "RAM User AccessKey Last Used Date Check", "es": "Verificación de Fecha de Último Uso de AccessKey de Usuario RAM", "fr": "Vérification de la Date de Dernière Utilisation d'AccessKey d'Utilisateur RAM", "ja": "RAM ユーザー AccessKey 最終使用日チェック", "pt": "Verificação de Data de Último Uso de AccessKey de Usuário RAM", "zh": "RAM 用户 AccessKey 最后使用时间检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer AccessKeys innerhalb der angegebenen Anzahl von Tagen verwendet wurden.", "en": "Ensures that RAM user AccessKeys have been used within the specified number of days.", "es": "Garantiza que las AccessKeys de usuario RAM se hayan utilizado dentro del número especificado de días.", "fr": "Garantit que les AccessKeys d'utilisateur RAM ont été utilisées dans le nombre de jours spécifié.", "ja": "RAM ユーザー AccessKey が指定された日数以内に使用されていることを確認します。", "pt": "Garante que as AccessKeys de usuário RAM tenham sido usadas dentro do número especificado de dias.", "zh": "确保 RAM 用户 AccessKey 在指定天数内有使用记录。"}, Reason: models.I18nString{"de": "Nicht verwendete AccessKeys sollten deaktiviert oder gelöscht werden, um die Angriffsfläche zu reduzieren.", "en": "Unused AccessKeys should be deactivated or deleted to reduce the attack surface.", "es": "Las AccessKeys no utilizadas deben desactivarse o eliminarse para reducir la superficie de ataque.", "fr": "Les AccessKeys non utilisées doivent être désactivées ou supprimées pour réduire la surface d'attaque.", "ja": "未使用の AccessKey は攻撃面を減らすために無効化または削除する必要があります。", "pt": "AccessKeys não utilizadas devem ser desativadas ou excluídas para reduzir a superfície de ataque.", "zh": "应停用或删除未使用的 AccessKey，以减少攻击面。"}, Recommendation: models.I18nString{"de": "Deaktivieren oder löschen Sie nicht verwendete RAM-Benutzer AccessKeys.", "en": "Deactivate or delete unused RAM user AccessKeys.", "es": "Desactive o elimine AccessKeys de usuario RAM no utilizadas.", "fr": "Désactivez ou supprimez les AccessKeys d'utilisateur RAM non utilisées.", "ja": "未使用の RAM ユーザー AccessKey を無効化または削除します。", "pt": "Desative ou exclua AccessKeys de usuário RAM não utilizadas.", "zh": "停用或删除未使用的 RAM 用户 AccessKey。"}, ResourceTypes: []string{"ALIYUN::RAM::AccessKey"}, FilePath: "aliyun/rules/ram-user-ak-used-expired-check.rego", PackageName: "infraguard.rules.aliyun.ram_user_ak_used_expired_check", Content: "package infraguard.rules.aliyun.ram_user_ak_used_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ram-user-ak-used-expired-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User AccessKey Last Used Date Check\",\n\t\t\"zh\": \"RAM 用户 AccessKey 最后使用时间检测\",\n\t\t\"ja\": \"RAM ユーザー AccessKey 最終使用日チェック\",\n\t\t\"de\": \"RAM-Benutzer AccessKey letztes Verwendungsdatum-Prüfung\",\n\t\t\"es\": \"Verificación de Fecha de Último Uso de AccessKey de Usuario RAM\",\n\t\t\"fr\": \"Vérification de la Date de Dernière Utilisation d'AccessKey d'Utilisateur RAM\",\n\t\t\"pt\": \"Verificação de Data de Último Uso de AccessKey de Usuário RAM\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that RAM user AccessKeys have been used within the specified number of days.\",\n\t\t\"zh\": \"确保 RAM 用户 AccessKey 在指定天数内有使用记录。\",\n\t\t\"ja\": \"RAM ユーザー AccessKey が指定された日数以内に使用されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer AccessKeys innerhalb der angegebenen Anzahl von Tagen verwendet wurden.\",\n\t\t\"es\": \"Garantiza que las AccessKeys de usuario RAM se hayan utilizado dentro del número especificado de días.\",\n\t\t\"fr\": \"Garantit que les AccessKeys d'utilisateur RAM ont été utilisées dans le nombre de jours spécifié.\",\n\t\t\"pt\": \"Garante que as AccessKeys de usuário RAM tenham sido usadas dentro do número especificado de dias.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Unused AccessKeys should be deactivated or deleted to reduce the attack surface.\",\n\t\t\"zh\": \"应停用或删除未使用的 AccessKey，以减少攻击面。\",\n\t\t\"ja\": \"未使用の AccessKey は攻撃面を減らすために無効化または削除する必要があります。\",\n\t\t\"de\": \"Nicht verwendete AccessKeys sollten deaktiviert oder gelöscht werden, um die Angriffsfläche zu reduzieren.\",\n\t\t\"es\": \"Las AccessKeys no utilizadas deben desactivarse o eliminarse para reducir la superficie de ataque.\",\n\t\t\"fr\": \"Les AccessKeys non utilisées doivent être désactivées ou supprimées pour réduire la surface d'attaque.\",\n\t\t\"pt\": \"AccessKeys não utilizadas devem ser desativadas ou excluídas para reduzir a superfície de ataque.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deactivate or delete unused RAM user AccessKeys.\",\n\t\t\"zh\": \"停用或删除未使用的 RAM 用户 AccessKey。\",\n\t\t\"ja\": \"未使用の RAM ユーザー AccessKey を無効化または削除します。\",\n\t\t\"de\": \"Deaktivieren oder löschen Sie nicht verwendete RAM-Benutzer AccessKeys.\",\n\t\t\"es\": \"Desactive o elimine AccessKeys de usuario RAM no utilizadas.\",\n\t\t\"fr\": \"Désactivez ou supprimez les AccessKeys d'utilisateur RAM non utilisées.\",\n\t\t\"pt\": \"Desative ou exclua AccessKeys de usuário RAM não utilizadas.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::AccessKey\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AccessKey\")\n\n\t# Conceptual check for last used date\n\thelpers.has_property(resource, \"LastUsedDate\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LastUsedDate\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-group-membership-check", Name: models.I18nString{"de": "RAM-Benutzer Gruppenmitgliedschaftsprüfung", "en": "RAM User Group Membership Check", "es": "Verificación de Membresía de Grupo de Usuario RAM", "fr": "Vérification d'Appartenance au Groupe d'Utilisateur RAM", "ja": "RAM ユーザーグループメンバーシップチェック", "pt": "Verificação de Associação ao Grupo de Usuário RAM", "zh": "RAM 用户组归属检测"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer zu mindestens einer Gruppe gehören, um die Berechtigungsverwaltung zu erleichtern.", "en": "Ensures that RAM users belong to at least one group for easier permission management.", "es": "Garantiza que los usuarios RAM pertenezcan al menos a un grupo para facilitar la gestión de permisos.", "fr": "Garantit que les utilisateurs RAM appartiennent à au moins un groupe pour faciliter la gestion des permissions.", "ja": "RAM ユーザーが権限管理を容易にするために少なくとも 1 つのグループに属していることを確認します。", "pt": "Garante que os usuários RAM pertençam a pelo menos um grupo para facilitar o gerenciamento de permissões.", "zh": "确保 RAM 用户属于至少一个用户组，以便于权限管理。"}, Reason: models.I18nString{"de": "Die Verwaltung von Berechtigungen über Gruppen ist effizienter und weniger fehleranfällig als die Verwaltung einzelner Benutzerberechtigungen.", "en": "Managing permissions through groups is more efficient and less error-prone than managing individual user permissions.", "es": "Gestionar permisos a través de grupos es más eficiente y menos propenso a errores que gestionar permisos de usuarios individuales.", "fr": "Gérer les permissions via les groupes est plus efficace et moins sujet aux erreurs que la gestion des permissions des utilisateurs individuels.", "ja": "グループを通じて権限を管理することは、個々のユーザー権限を管理するよりも効率的で、エラーが発生しにくくなります。", "pt": "Gerenciar permissões através de grupos é mais eficiente e menos propenso a erros do que gerenciar permissões de usuários individuais.", "zh": "通过组管理权限比管理单个用户的权限更高效且更不容易出错。"}, Recommendation: models.I18nString{"de": "Weisen Sie RAM-Benutzer relevanten Benutzergruppen zu.", "en": "Assign RAM users to relevant user groups.", "es": "Asigne usuarios RAM a grupos de usuarios relevantes.", "fr": "Assignez les utilisateurs RAM aux groupes d'utilisateurs pertinents.", "ja": "RAM ユーザーを関連するユーザーグループに割り当てます。", "pt": "Atribua usuários RAM a grupos de usuários relevantes.", "zh": "将 RAM 用户分配到相关的用户组中。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-group-membership-check.rego", PackageName: "infraguard.rules.aliyun.ram_user_group_membership_check", Content: "package infraguard.rules.aliyun.ram_user_group_membership_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ram-user-group-membership-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"RAM User Group Membership Check\",\n\t\t\"zh\": \"RAM 用户组归属检测\",\n\t\t\"ja\": \"RAM ユーザーグループメンバーシップチェック\",\n\t\t\"de\": \"RAM-Benutzer Gruppenmitgliedschaftsprüfung\",\n\t\t\"es\": \"Verificación de Membresía de Grupo de Usuario RAM\",\n\t\t\"fr\": \"Vérification d'Appartenance au Groupe d'Utilisateur RAM\",\n\t\t\"pt\": \"Verificação de Associação ao Grupo de Usuário RAM\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that RAM users belong to at least one group for easier permission management.\",\n\t\t\"zh\": \"确保 RAM 用户属于至少一个用户组，以便于权限管理。\",\n\t\t\"ja\": \"RAM ユーザーが権限管理を容易にするために少なくとも 1 つのグループに属していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer zu mindestens einer Gruppe gehören, um die Berechtigungsverwaltung zu erleichtern.\",\n\t\t\"es\": \"Garantiza que los usuarios RAM pertenezcan al menos a un grupo para facilitar la gestión de permisos.\",\n\t\t\"fr\": \"Garantit que les utilisateurs RAM appartiennent à au moins un groupe pour faciliter la gestion des permissions.\",\n\t\t\"pt\": \"Garante que os usuários RAM pertençam a pelo menos um grupo para facilitar o gerenciamento de permissões.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Managing permissions through groups is more efficient and less error-prone than managing individual user permissions.\",\n\t\t\"zh\": \"通过组管理权限比管理单个用户的权限更高效且更不容易出错。\",\n\t\t\"ja\": \"グループを通じて権限を管理することは、個々のユーザー権限を管理するよりも効率的で、エラーが発生しにくくなります。\",\n\t\t\"de\": \"Die Verwaltung von Berechtigungen über Gruppen ist effizienter und weniger fehleranfällig als die Verwaltung einzelner Benutzerberechtigungen.\",\n\t\t\"es\": \"Gestionar permisos a través de grupos es más eficiente y menos propenso a errores que gestionar permisos de usuarios individuales.\",\n\t\t\"fr\": \"Gérer les permissions via les groupes est plus efficace et moins sujet aux erreurs que la gestion des permissions des utilisateurs individuels.\",\n\t\t\"pt\": \"Gerenciar permissões através de grupos é mais eficiente e menos propenso a erros do que gerenciar permissões de usuários individuais.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Assign RAM users to relevant user groups.\",\n\t\t\"zh\": \"将 RAM 用户分配到相关的用户组中。\",\n\t\t\"ja\": \"RAM ユーザーを関連するユーザーグループに割り当てます。\",\n\t\t\"de\": \"Weisen Sie RAM-Benutzer relevanten Benutzergruppen zu.\",\n\t\t\"es\": \"Asigne usuarios RAM a grupos de usuarios relevantes.\",\n\t\t\"fr\": \"Assignez les utilisateurs RAM aux groupes d'utilisateurs pertinents.\",\n\t\t\"pt\": \"Atribua usuários RAM a grupos de usuários relevantes.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\t# Conceptual check for group membership\n\tnot helpers.has_property(resource, \"Groups\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-has-specified-policy", Name: models.I18nString{"de": "RAM-Benutzer hat angegebene Richtlinie", "en": "RAM User Has Specified Policy", "es": "El Usuario RAM Tiene Política Especificada", "fr": "L'Utilisateur RAM a une Politique Spécifiée", "ja": "RAM ユーザーに指定されたポリシーがある", "pt": "O Usuário RAM Tem Política Especificada", "zh": "RAM 用户及所属用户组绑定指定条件的权限策略"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer die erforderlichen Richtlinien angehängt haben, einschließlich derer, die von Gruppen geerbt wurden.", "en": "Ensures RAM users have the required policies attached, including those inherited from groups.", "es": "Garantiza que los usuarios RAM tengan las políticas requeridas adjuntas, incluidas las heredadas de grupos.", "fr": "Garantit que les utilisateurs RAM ont les politiques requises attachées, y compris celles héritées des groupes.", "ja": "RAM ユーザーに必要なポリシーがアタッチされていることを確認します（グループから継承されたポリシーを含む）。", "pt": "Garante que os usuários RAM tenham as políticas necessárias anexadas, incluindo as herdadas de grupos.", "zh": "确保 RAM 用户绑定了符合参数条件的权限策略，包括继承自用户组的权限。"}, Reason: models.I18nString{"de": "Die ordnungsgemäße Anheftung von Richtlinien stellt sicher, dass Benutzer die erforderlichen Berechtigungen haben.", "en": "Proper policy attachment ensures users have necessary permissions.", "es": "La adjunción adecuada de políticas garantiza que los usuarios tengan los permisos necesarios.", "fr": "L'attachement approprié des politiques garantit que les utilisateurs ont les permissions nécessaires.", "ja": "適切なポリシーのアタッチにより、ユーザーに必要な権限があることが保証されます。", "pt": "O anexo adequado de políticas garante que os usuários tenham as permissões necessárias.", "zh": "正确绑定策略可确保用户具有必要的权限。"}, Recommendation: models.I18nString{"de": "Hängen Sie die erforderlichen Richtlinien an den RAM-Benutzer oder deren Gruppen an.", "en": "Attach the required policies to the RAM user or their groups.", "es": "Adjunte las políticas requeridas al usuario RAM o sus grupos.", "fr": "Attachez les politiques requises à l'utilisateur RAM ou à leurs groupes.", "ja": "必要なポリシーを RAM ユーザーまたはそのグループにアタッチします。", "pt": "Anexe as políticas necessárias ao usuário RAM ou seus grupos.", "zh": "向 RAM 用户或其所属用户组绑定所需的策略。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-has-specified-policy.rego", PackageName: "infraguard.rules.aliyun.ram_user_has_specified_policy", Content: "package infraguard.rules.aliyun.ram_user_has_specified_policy\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-user-has-specified-policy\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User Has Specified Policy\",\n\t\t\"zh\": \"RAM 用户及所属用户组绑定指定条件的权限策略\",\n\t\t\"ja\": \"RAM ユーザーに指定されたポリシーがある\",\n\t\t\"de\": \"RAM-Benutzer hat angegebene Richtlinie\",\n\t\t\"es\": \"El Usuario RAM Tiene Política Especificada\",\n\t\t\"fr\": \"L'Utilisateur RAM a une Politique Spécifiée\",\n\t\t\"pt\": \"O Usuário RAM Tem Política Especificada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM users have the required policies attached, including those inherited from groups.\",\n\t\t\"zh\": \"确保 RAM 用户绑定了符合参数条件的权限策略，包括继承自用户组的权限。\",\n\t\t\"ja\": \"RAM ユーザーに必要なポリシーがアタッチされていることを確認します（グループから継承されたポリシーを含む）。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer die erforderlichen Richtlinien angehängt haben, einschließlich derer, die von Gruppen geerbt wurden.\",\n\t\t\"es\": \"Garantiza que los usuarios RAM tengan las políticas requeridas adjuntas, incluidas las heredadas de grupos.\",\n\t\t\"fr\": \"Garantit que les utilisateurs RAM ont les politiques requises attachées, y compris celles héritées des groupes.\",\n\t\t\"pt\": \"Garante que os usuários RAM tenham as políticas necessárias anexadas, incluindo as herdadas de grupos.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Proper policy attachment ensures users have necessary permissions.\",\n\t\t\"zh\": \"正确绑定策略可确保用户具有必要的权限。\",\n\t\t\"ja\": \"適切なポリシーのアタッチにより、ユーザーに必要な権限があることが保証されます。\",\n\t\t\"de\": \"Die ordnungsgemäße Anheftung von Richtlinien stellt sicher, dass Benutzer die erforderlichen Berechtigungen haben.\",\n\t\t\"es\": \"La adjunción adecuada de políticas garantiza que los usuarios tengan los permisos necesarios.\",\n\t\t\"fr\": \"L'attachement approprié des politiques garantit que les utilisateurs ont les permissions nécessaires.\",\n\t\t\"pt\": \"O anexo adequado de políticas garante que os usuários tenham as permissões necessárias.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach the required policies to the RAM user or their groups.\",\n\t\t\"zh\": \"向 RAM 用户或其所属用户组绑定所需的策略。\",\n\t\t\"ja\": \"必要なポリシーを RAM ユーザーまたはそのグループにアタッチします。\",\n\t\t\"de\": \"Hängen Sie die erforderlichen Richtlinien an den RAM-Benutzer oder deren Gruppen an.\",\n\t\t\"es\": \"Adjunte las políticas requeridas al usuario RAM o sus grupos.\",\n\t\t\"fr\": \"Attachez les politiques requises à l'utilisateur RAM ou à leurs groupes.\",\n\t\t\"pt\": \"Anexe as políticas necessárias ao usuário RAM ou seus grupos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\nhas_system_policy(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tsystem_policies != []\n}\n\nhas_custom_policy(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tcustom_policies := object.get(policy_attachments, \"Custom\", [])\n\tcustom_policies != []\n}\n\nhas_policy_via_attachment(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_referencing(user_name_val, user_name)\n}\n\nhas_policy_via_attachment(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_get_att_referencing(user_name_val, user_name)\n}\n\ndeny contains result if {\n\tsome user_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\tnot has_system_policy(resource)\n\tnot has_custom_policy(resource)\n\tnot has_policy_via_attachment(user_name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyAttachments\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-last-login-expired-check", Name: models.I18nString{"de": "RAM-Benutzer letzte Anmeldung-Prüfung", "en": "RAM User Last Login Check", "es": "Verificación de Último Inicio de Sesión de Usuario RAM", "fr": "Vérification de la Dernière Connexion d'Utilisateur RAM", "ja": "RAM ユーザー最終ログインチェック", "pt": "Verificação de Último Login de Usuário RAM", "zh": "RAM 用户最后登录时间核查"}, Severity: "low", Description: models.I18nString{"de": "Prüft, ob RAM-Benutzer seit langer Zeit nicht angemeldet waren.", "en": "Checks if RAM users have not logged in for a long time.", "es": "Verifica si los usuarios RAM no han iniciado sesión durante mucho tiempo.", "fr": "Vérifie si les utilisateurs RAM ne se sont pas connectés depuis longtemps.", "ja": "RAM ユーザーが長時間ログインしていないかどうかをチェックします。", "pt": "Verifica se usuários RAM não fizeram login há muito tempo.", "zh": "核查 RAM 用户是否长时间未登录。"}, Reason: models.I18nString{"de": "Inaktive Benutzer sollten entfernt werden, um die Sicherheitsfläche zu reduzieren.", "en": "Inactive users should be removed to reduce security surface.", "es": "Los usuarios inactivos deben eliminarse para reducir la superficie de seguridad.", "fr": "Les utilisateurs inactifs doivent être supprimés pour réduire la surface de sécurité.", "ja": "非アクティブなユーザーは、セキュリティ面を減らすために削除する必要があります。", "pt": "Usuários inativos devem ser removidos para reduzir a superfície de segurança.", "zh": "不活跃的用户应予以移除以减少安全暴露面。"}, Recommendation: models.I18nString{"de": "Entfernen oder deaktivieren Sie nicht verwendete RAM-Benutzer.", "en": "Remove or deactivate unused RAM users.", "es": "Elimine o desactive usuarios RAM no utilizados.", "fr": "Supprimez ou désactivez les utilisateurs RAM non utilisés.", "ja": "未使用の RAM ユーザーを削除または無効化します。", "pt": "Remova ou desative usuários RAM não utilizados.", "zh": "移除或禁用不常用的 RAM 用户。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-last-login-expired-check.rego", PackageName: "infraguard.rules.aliyun.ram_user_last_login_expired_check", Content: "package infraguard.rules.aliyun.ram_user_last_login_expired_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-user-last-login-expired-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"RAM User Last Login Check\",\n\t\t\"zh\": \"RAM 用户最后登录时间核查\",\n\t\t\"ja\": \"RAM ユーザー最終ログインチェック\",\n\t\t\"de\": \"RAM-Benutzer letzte Anmeldung-Prüfung\",\n\t\t\"es\": \"Verificación de Último Inicio de Sesión de Usuario RAM\",\n\t\t\"fr\": \"Vérification de la Dernière Connexion d'Utilisateur RAM\",\n\t\t\"pt\": \"Verificação de Último Login de Usuário RAM\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Checks if RAM users have not logged in for a long time.\",\n\t\t\"zh\": \"核查 RAM 用户是否长时间未登录。\",\n\t\t\"ja\": \"RAM ユーザーが長時間ログインしていないかどうかをチェックします。\",\n\t\t\"de\": \"Prüft, ob RAM-Benutzer seit langer Zeit nicht angemeldet waren.\",\n\t\t\"es\": \"Verifica si los usuarios RAM no han iniciado sesión durante mucho tiempo.\",\n\t\t\"fr\": \"Vérifie si les utilisateurs RAM ne se sont pas connectés depuis longtemps.\",\n\t\t\"pt\": \"Verifica se usuários RAM não fizeram login há muito tempo.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Inactive users should be removed to reduce security surface.\",\n\t\t\"zh\": \"不活跃的用户应予以移除以减少安全暴露面。\",\n\t\t\"ja\": \"非アクティブなユーザーは、セキュリティ面を減らすために削除する必要があります。\",\n\t\t\"de\": \"Inaktive Benutzer sollten entfernt werden, um die Sicherheitsfläche zu reduzieren.\",\n\t\t\"es\": \"Los usuarios inactivos deben eliminarse para reducir la superficie de seguridad.\",\n\t\t\"fr\": \"Les utilisateurs inactifs doivent être supprimés pour réduire la surface de sécurité.\",\n\t\t\"pt\": \"Usuários inativos devem ser removidos para reduzir a superfície de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove or deactivate unused RAM users.\",\n\t\t\"zh\": \"移除或禁用不常用的 RAM 用户。\",\n\t\t\"ja\": \"未使用の RAM ユーザーを削除または無効化します。\",\n\t\t\"de\": \"Entfernen oder deaktivieren Sie nicht verwendete RAM-Benutzer.\",\n\t\t\"es\": \"Elimine o desactive usuarios RAM no utilizados.\",\n\t\t\"fr\": \"Supprimez ou désactivez les utilisateurs RAM non utilisés.\",\n\t\t\"pt\": \"Remova ou desative usuários RAM não utilizados.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\n# Always compliant in static analysis as runtime data is missing\nis_compliant(resource) := true\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-login-check", Name: models.I18nString{"de": "RAM-Benutzer Login-Aktivierungsprüfung", "en": "RAM User Login Enabled Check", "es": "Verificación de Login de Usuario RAM Habilitado", "fr": "Vérification de l'Activation de la Connexion Utilisateur RAM", "ja": "RAM ユーザーログイン有効化チェック", "pt": "Verificação de Login de Usuário RAM Habilitado", "zh": "RAM 用户登录启用检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer, die keinen Konsolenzugriff benötigen, Login deaktiviert haben.", "en": "Ensures that RAM users who do not need console access have login disabled.", "es": "Garantiza que los usuarios RAM que no necesitan acceso a la consola tengan el inicio de sesión deshabilitado.", "fr": "Garantit que les utilisateurs RAM qui n'ont pas besoin d'accès à la console ont la connexion désactivée.", "ja": "コンソールアクセスが不要な RAM ユーザーのログインが無効になっていることを確認します。", "pt": "Garante que usuários RAM que não precisam de acesso ao console tenham login desabilitado.", "zh": "确保不需要控制台访问权限的 RAM 用户已禁用登录功能。"}, Reason: models.I18nString{"de": "Das Deaktivieren der Konsolenanmeldung für Benutzer, die nur API-Zugriff benötigen, reduziert Sicherheitsrisiken.", "en": "Disabling console login for users who only need API access reduces security risks.", "es": "Deshabilitar el inicio de sesión en la consola para usuarios que solo necesitan acceso a la API reduce los riesgos de seguridad.", "fr": "Désactiver la connexion console pour les utilisateurs qui n'ont besoin que d'un accès API réduit les risques de sécurité.", "ja": "API アクセスのみが必要なユーザーのコンソールログインを無効にすることで、セキュリティリスクを低減します。", "pt": "Desabilitar login no console para usuários que precisam apenas de acesso à API reduz riscos de segurança.", "zh": "为仅需要 API 访问权限的用户禁用控制台登录可降低安全风险。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie die Konsolenanmeldung für RAM-Benutzer, die nur AccessKeys verwenden.", "en": "Disable console login for RAM users who only use AccessKeys.", "es": "Deshabilite el inicio de sesión en la consola para usuarios RAM que solo usan AccessKeys.", "fr": "Désactivez la connexion console pour les utilisateurs RAM qui utilisent uniquement des AccessKeys.", "ja": "AccessKey のみを使用する RAM ユーザーのコンソールログインを無効にします。", "pt": "Desabilite login no console para usuários RAM que usam apenas AccessKeys.", "zh": "为仅使用 AccessKey 的 RAM 用户禁用控制台登录。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-login-check.rego", PackageName: "infraguard.rules.aliyun.ram_user_login_check", Content: "package infraguard.rules.aliyun.ram_user_login_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ram-user-login-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User Login Enabled Check\",\n\t\t\"zh\": \"RAM 用户登录启用检测\",\n\t\t\"ja\": \"RAM ユーザーログイン有効化チェック\",\n\t\t\"de\": \"RAM-Benutzer Login-Aktivierungsprüfung\",\n\t\t\"es\": \"Verificación de Login de Usuario RAM Habilitado\",\n\t\t\"fr\": \"Vérification de l'Activation de la Connexion Utilisateur RAM\",\n\t\t\"pt\": \"Verificação de Login de Usuário RAM Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that RAM users who do not need console access have login disabled.\",\n\t\t\"zh\": \"确保不需要控制台访问权限的 RAM 用户已禁用登录功能。\",\n\t\t\"ja\": \"コンソールアクセスが不要な RAM ユーザーのログインが無効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer, die keinen Konsolenzugriff benötigen, Login deaktiviert haben.\",\n\t\t\"es\": \"Garantiza que los usuarios RAM que no necesitan acceso a la consola tengan el inicio de sesión deshabilitado.\",\n\t\t\"fr\": \"Garantit que les utilisateurs RAM qui n'ont pas besoin d'accès à la console ont la connexion désactivée.\",\n\t\t\"pt\": \"Garante que usuários RAM que não precisam de acesso ao console tenham login desabilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Disabling console login for users who only need API access reduces security risks.\",\n\t\t\"zh\": \"为仅需要 API 访问权限的用户禁用控制台登录可降低安全风险。\",\n\t\t\"ja\": \"API アクセスのみが必要なユーザーのコンソールログインを無効にすることで、セキュリティリスクを低減します。\",\n\t\t\"de\": \"Das Deaktivieren der Konsolenanmeldung für Benutzer, die nur API-Zugriff benötigen, reduziert Sicherheitsrisiken.\",\n\t\t\"es\": \"Deshabilitar el inicio de sesión en la consola para usuarios que solo necesitan acceso a la API reduce los riesgos de seguridad.\",\n\t\t\"fr\": \"Désactiver la connexion console pour les utilisateurs qui n'ont besoin que d'un accès API réduit les risques de sécurité.\",\n\t\t\"pt\": \"Desabilitar login no console para usuários que precisam apenas de acesso à API reduz riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable console login for RAM users who only use AccessKeys.\",\n\t\t\"zh\": \"为仅使用 AccessKey 的 RAM 用户禁用控制台登录。\",\n\t\t\"ja\": \"AccessKey のみを使用する RAM ユーザーのコンソールログインを無効にします。\",\n\t\t\"de\": \"Deaktivieren Sie die Konsolenanmeldung für RAM-Benutzer, die nur AccessKeys verwenden.\",\n\t\t\"es\": \"Deshabilite el inicio de sesión en la consola para usuarios RAM que solo usan AccessKeys.\",\n\t\t\"fr\": \"Désactivez la connexion console pour les utilisateurs RAM qui utilisent uniquement des AccessKeys.\",\n\t\t\"pt\": \"Desabilite login no console para usuários RAM que usam apenas AccessKeys.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\thelpers.get_property(resource, \"LoginProfile\", false)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LoginProfile\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-mfa-check", Name: models.I18nString{"de": "RAM-Benutzer MFA aktiviert", "en": "RAM User MFA Enabled", "es": "MFA de Usuario RAM Habilitado", "fr": "MFA Utilisateur RAM Activé", "ja": "RAM ユーザーで MFA が有効", "pt": "MFA de Usuário RAM Habilitado", "zh": "RAM 用户开启 MFA"}, Severity: "high", Description: models.I18nString{"de": "RAM-Benutzer mit Konsolenzugriff sollten Multi-Faktor-Authentifizierung (MFA) aktiviert haben.", "en": "RAM users with console access should have multi-factor authentication (MFA) enabled.", "es": "Los usuarios RAM con acceso a la consola deben tener habilitada la autenticación multifactor (MFA).", "fr": "Les utilisateurs RAM avec accès à la console doivent avoir l'authentification multifacteur (MFA) activée.", "ja": "コンソールアクセスを持つ RAM ユーザーは、多要素認証（MFA）を有効にする必要があります。", "pt": "Usuários RAM com acesso ao console devem ter autenticação multifator (MFA) habilitada.", "zh": "检测 RAM 用户是否开通 MFA 二次验证登录，开通视为合规。"}, Reason: models.I18nString{"de": "RAM-Benutzer ohne MFA sind anfällig für Passwortkompromittierung und stellen ein erhebliches Sicherheitsrisiko dar.", "en": "RAM users without MFA are vulnerable to password compromise, posing a significant security risk.", "es": "Los usuarios RAM sin MFA son vulnerables al compromiso de contraseñas, lo que plantea un riesgo de seguridad significativo.", "fr": "Les utilisateurs RAM sans MFA sont vulnérables au compromis de mot de passe, ce qui pose un risque de sécurité important.", "ja": "MFA がない RAM ユーザーはパスワードの侵害に対して脆弱で、重大なセキュリティリスクをもたらします。", "pt": "Usuários RAM sem MFA são vulneráveis a comprometimento de senha, representando um risco significativo de segurança.", "zh": "RAM 用户未开启 MFA，一旦密码泄露，账号将面临极大的安全风险。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie MFA für den RAM-Benutzer, indem Sie LoginProfile.MFABindRequired auf true setzen.", "en": "Enable MFA for the RAM user by setting LoginProfile.MFABindRequired to true.", "es": "Habilite MFA para el usuario RAM estableciendo LoginProfile.MFABindRequired en true.", "fr": "Activez MFA pour l'utilisateur RAM en définissant LoginProfile.MFABindRequired sur true.", "ja": "LoginProfile.MFABindRequired を true に設定して、RAM ユーザーで MFA を有効にします。", "pt": "Habilite MFA para o usuário RAM definindo LoginProfile.MFABindRequired como true.", "zh": "通过将 LoginProfile.MFABindRequired 设置为 true 为 RAM 用户强制开启 MFA。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-mfa-check.rego", PackageName: "infraguard.rules.aliyun.ram_user_mfa_check", Content: "package infraguard.rules.aliyun.ram_user_mfa_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"ram-user-mfa-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"RAM User MFA Enabled\",\n\t\t\"zh\": \"RAM 用户开启 MFA\",\n\t\t\"ja\": \"RAM ユーザーで MFA が有効\",\n\t\t\"de\": \"RAM-Benutzer MFA aktiviert\",\n\t\t\"es\": \"MFA de Usuario RAM Habilitado\",\n\t\t\"fr\": \"MFA Utilisateur RAM Activé\",\n\t\t\"pt\": \"MFA de Usuário RAM Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"RAM users with console access should have multi-factor authentication (MFA) enabled.\",\n\t\t\"zh\": \"检测 RAM 用户是否开通 MFA 二次验证登录，开通视为合规。\",\n\t\t\"ja\": \"コンソールアクセスを持つ RAM ユーザーは、多要素認証（MFA）を有効にする必要があります。\",\n\t\t\"de\": \"RAM-Benutzer mit Konsolenzugriff sollten Multi-Faktor-Authentifizierung (MFA) aktiviert haben.\",\n\t\t\"es\": \"Los usuarios RAM con acceso a la consola deben tener habilitada la autenticación multifactor (MFA).\",\n\t\t\"fr\": \"Les utilisateurs RAM avec accès à la console doivent avoir l'authentification multifacteur (MFA) activée.\",\n\t\t\"pt\": \"Usuários RAM com acesso ao console devem ter autenticação multifator (MFA) habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"RAM users without MFA are vulnerable to password compromise, posing a significant security risk.\",\n\t\t\"zh\": \"RAM 用户未开启 MFA，一旦密码泄露，账号将面临极大的安全风险。\",\n\t\t\"ja\": \"MFA がない RAM ユーザーはパスワードの侵害に対して脆弱で、重大なセキュリティリスクをもたらします。\",\n\t\t\"de\": \"RAM-Benutzer ohne MFA sind anfällig für Passwortkompromittierung und stellen ein erhebliches Sicherheitsrisiko dar.\",\n\t\t\"es\": \"Los usuarios RAM sin MFA son vulnerables al compromiso de contraseñas, lo que plantea un riesgo de seguridad significativo.\",\n\t\t\"fr\": \"Les utilisateurs RAM sans MFA sont vulnérables au compromis de mot de passe, ce qui pose un risque de sécurité important.\",\n\t\t\"pt\": \"Usuários RAM sem MFA são vulneráveis a comprometimento de senha, representando um risco significativo de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable MFA for the RAM user by setting LoginProfile.MFABindRequired to true.\",\n\t\t\"zh\": \"通过将 LoginProfile.MFABindRequired 设置为 true 为 RAM 用户强制开启 MFA。\",\n\t\t\"ja\": \"LoginProfile.MFABindRequired を true に設定して、RAM ユーザーで MFA を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie MFA für den RAM-Benutzer, indem Sie LoginProfile.MFABindRequired auf true setzen.\",\n\t\t\"es\": \"Habilite MFA para el usuario RAM estableciendo LoginProfile.MFABindRequired en true.\",\n\t\t\"fr\": \"Activez MFA pour l'utilisateur RAM en définissant LoginProfile.MFABindRequired sur true.\",\n\t\t\"pt\": \"Habilite MFA para o usuário RAM definindo LoginProfile.MFABindRequired como true.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\n# Check if MFA is required for login\nis_mfa_enabled(resource) if {\n\tlogin_profile := helpers.get_property(resource, \"LoginProfile\", {})\n\tmfa := object.get(login_profile, \"MFABindRequired\", false)\n\thelpers.is_true(mfa)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\n\t# Only check users who have console access (LoginProfile exists)\n\thelpers.has_property(resource, \"LoginProfile\")\n\tnot is_mfa_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LoginProfile\", \"MFABindRequired\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-no-has-specified-policy", Name: models.I18nString{"de": "RAM-Benutzer keine angegebene Richtlinie", "en": "RAM User No Specified Policy", "es": "Usuario RAM Sin Política Especificada", "fr": "Utilisateur RAM Sans Politique Spécifiée", "ja": "RAM ユーザーに指定されたポリシーなし", "pt": "Usuário RAM Sem Política Especificada", "zh": "RAM 用户及所属用户组未绑定指定条件的权限策略"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer keine angegebenen riskanten Richtlinien angehängt haben.", "en": "Ensures RAM users do not have specified risky policies attached.", "es": "Garantiza que los usuarios RAM no tengan políticas riesgosas especificadas adjuntas.", "fr": "Garantit que les utilisateurs RAM n'ont pas de politiques risquées spécifiées attachées.", "ja": "RAM ユーザーに指定されたリスクのあるポリシーが添付されていないことを確認します。", "pt": "Garante que os usuários RAM não tenham políticas arriscadas especificadas anexadas.", "zh": "确保 RAM 用户未绑定符合参数条件的高危权限策略。"}, Reason: models.I18nString{"de": "Riskante Richtlinien erhöhen die Angriffsfläche.", "en": "Risky policies increase the attack surface.", "es": "Las políticas riesgosas aumentan la superficie de ataque.", "fr": "Les politiques risquées augmentent la surface d'attaque.", "ja": "リスクのあるポリシーは攻撃面を増加させます。", "pt": "Políticas arriscadas aumentam a superfície de ataque.", "zh": "高危策略会增加攻击面。"}, Recommendation: models.I18nString{"de": "Entfernen oder ersetzen Sie riskante Richtlinien durch Alternativen mit geringsten Berechtigungen.", "en": "Remove or replace risky policies with least privilege alternatives.", "es": "Elimine o reemplace políticas riesgosas con alternativas de menor privilegio.", "fr": "Supprimez ou remplacez les politiques risquées par des alternatives à privilèges minimaux.", "ja": "リスクのあるポリシーを削除するか、最小権限の代替案に置き換えます。", "pt": "Remova ou substitua políticas arriscadas por alternativas de menor privilégio.", "zh": "移除或替换高危策略，使用最小权限的替代方案。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-no-has-specified-policy.rego", PackageName: "infraguard.rules.aliyun.ram_user_no_has_specified_policy", Content: "package infraguard.rules.aliyun.ram_user_no_has_specified_policy\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-user-no-has-specified-policy\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User No Specified Policy\",\n\t\t\"zh\": \"RAM 用户及所属用户组未绑定指定条件的权限策略\",\n\t\t\"ja\": \"RAM ユーザーに指定されたポリシーなし\",\n\t\t\"de\": \"RAM-Benutzer keine angegebene Richtlinie\",\n\t\t\"es\": \"Usuario RAM Sin Política Especificada\",\n\t\t\"fr\": \"Utilisateur RAM Sans Politique Spécifiée\",\n\t\t\"pt\": \"Usuário RAM Sem Política Especificada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM users do not have specified risky policies attached.\",\n\t\t\"zh\": \"确保 RAM 用户未绑定符合参数条件的高危权限策略。\",\n\t\t\"ja\": \"RAM ユーザーに指定されたリスクのあるポリシーが添付されていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer keine angegebenen riskanten Richtlinien angehängt haben.\",\n\t\t\"es\": \"Garantiza que los usuarios RAM no tengan políticas riesgosas especificadas adjuntas.\",\n\t\t\"fr\": \"Garantit que les utilisateurs RAM n'ont pas de politiques risquées spécifiées attachées.\",\n\t\t\"pt\": \"Garante que os usuários RAM não tenham políticas arriscadas especificadas anexadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Risky policies increase the attack surface.\",\n\t\t\"zh\": \"高危策略会增加攻击面。\",\n\t\t\"ja\": \"リスクのあるポリシーは攻撃面を増加させます。\",\n\t\t\"de\": \"Riskante Richtlinien erhöhen die Angriffsfläche.\",\n\t\t\"es\": \"Las políticas riesgosas aumentan la superficie de ataque.\",\n\t\t\"fr\": \"Les politiques risquées augmentent la surface d'attaque.\",\n\t\t\"pt\": \"Políticas arriscadas aumentam a superfície de ataque.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove or replace risky policies with least privilege alternatives.\",\n\t\t\"zh\": \"移除或替换高危策略，使用最小权限的替代方案。\",\n\t\t\"ja\": \"リスクのあるポリシーを削除するか、最小権限の代替案に置き換えます。\",\n\t\t\"de\": \"Entfernen oder ersetzen Sie riskante Richtlinien durch Alternativen mit geringsten Berechtigungen.\",\n\t\t\"es\": \"Elimine o reemplace políticas riesgosas con alternativas de menor privilegio.\",\n\t\t\"fr\": \"Supprimez ou remplacez les politiques risquées par des alternatives à privilèges minimaux.\",\n\t\t\"pt\": \"Remova ou substitua políticas arriscadas por alternativas de menor privilégio.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\nrisky_policies := [\n\t\"AdministratorAccess\",\n\t\"*:*\",\n]\n\nis_admin_policy(policy_name) if {\n\tpolicy_name == \"AdministratorAccess\"\n}\n\nis_admin_policy(policy_name) if {\n\tpolicy_name == \"*\"\n}\n\nhas_risky_system_policy(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tsome policy in system_policies\n\tis_admin_policy(policy)\n}\n\nhas_risky_system_policy(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tsome policy in system_policies\n\tpolicy in risky_policies\n}\n\nhas_risky_policy_via_attachment(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_referencing(user_name_val, user_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tis_admin_policy(policy_name)\n}\n\nhas_risky_policy_via_attachment(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_referencing(user_name_val, user_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tpolicy_name in risky_policies\n}\n\nhas_risky_policy_via_attachment(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_get_att_referencing(user_name_val, user_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tis_admin_policy(policy_name)\n}\n\nhas_risky_policy_via_attachment(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_get_att_referencing(user_name_val, user_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tpolicy_name in risky_policies\n}\n\ndeny contains result if {\n\tsome user_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\thas_risky_system_policy(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyAttachments\", \"System\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome user_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\thas_risky_policy_via_attachment(user_name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-no-policy-check", Name: models.I18nString{"de": "RAM-Benutzer hat Richtlinie", "en": "RAM User Has Policy", "es": "El Usuario RAM Tiene Política", "fr": "L'Utilisateur RAM a une Politique", "ja": "RAM ユーザーにポリシーがある", "pt": "O Usuário RAM Tem Política", "zh": "识别未挂载任何策略的 RAM 用户"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer mindestens eine Richtlinie angehängt haben.", "en": "Ensures RAM users have at least one policy attached.", "es": "Garantiza que los usuarios RAM tengan al menos una política adjunta.", "fr": "Garantit que les utilisateurs RAM ont au moins une politique attachée.", "ja": "RAM ユーザーに少なくとも 1 つのポリシーがアタッチされていることを確認します。", "pt": "Garante que os usuários RAM tenham pelo menos uma política anexada.", "zh": "确保 RAM 用户至少挂载了一个策略。"}, Reason: models.I18nString{"de": "Benutzer ohne Richtlinien können keine Aktionen ausführen und können redundant sein.", "en": "Users without policies cannot perform any actions and may be redundant.", "es": "Los usuarios sin políticas no pueden realizar ninguna acción y pueden ser redundantes.", "fr": "Les utilisateurs sans politiques ne peuvent effectuer aucune action et peuvent être redondants.", "ja": "ポリシーのないユーザーはアクションを実行できず、冗長である可能性があります。", "pt": "Usuários sem políticas não podem realizar nenhuma ação e podem ser redundantes.", "zh": "没有策略的用户无法执行任何操作，可能是冗余的。"}, Recommendation: models.I18nString{"de": "Hängen Sie eine Richtlinie an den Benutzer an oder entfernen Sie den Benutzer.", "en": "Attach a policy to the user or remove the user.", "es": "Adjunte una política al usuario o elimine el usuario.", "fr": "Attachez une politique à l'utilisateur ou supprimez l'utilisateur.", "ja": "ユーザーにポリシーをアタッチするか、ユーザーを削除します。", "pt": "Anexe uma política ao usuário ou remova o usuário.", "zh": "为该用户挂载策略，或将其移除。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-no-policy-check.rego", PackageName: "infraguard.rules.aliyun.ram_user_no_policy_check", Content: "package infraguard.rules.aliyun.ram_user_no_policy_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-user-no-policy-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"RAM User Has Policy\",\n\t\t\"zh\": \"识别未挂载任何策略的 RAM 用户\",\n\t\t\"ja\": \"RAM ユーザーにポリシーがある\",\n\t\t\"de\": \"RAM-Benutzer hat Richtlinie\",\n\t\t\"es\": \"El Usuario RAM Tiene Política\",\n\t\t\"fr\": \"L'Utilisateur RAM a une Politique\",\n\t\t\"pt\": \"O Usuário RAM Tem Política\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM users have at least one policy attached.\",\n\t\t\"zh\": \"确保 RAM 用户至少挂载了一个策略。\",\n\t\t\"ja\": \"RAM ユーザーに少なくとも 1 つのポリシーがアタッチされていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer mindestens eine Richtlinie angehängt haben.\",\n\t\t\"es\": \"Garantiza que los usuarios RAM tengan al menos una política adjunta.\",\n\t\t\"fr\": \"Garantit que les utilisateurs RAM ont au moins une politique attachée.\",\n\t\t\"pt\": \"Garante que os usuários RAM tenham pelo menos uma política anexada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Users without policies cannot perform any actions and may be redundant.\",\n\t\t\"zh\": \"没有策略的用户无法执行任何操作，可能是冗余的。\",\n\t\t\"ja\": \"ポリシーのないユーザーはアクションを実行できず、冗長である可能性があります。\",\n\t\t\"de\": \"Benutzer ohne Richtlinien können keine Aktionen ausführen und können redundant sein.\",\n\t\t\"es\": \"Los usuarios sin políticas no pueden realizar ninguna acción y pueden ser redundantes.\",\n\t\t\"fr\": \"Les utilisateurs sans politiques ne peuvent effectuer aucune action et peuvent être redondants.\",\n\t\t\"pt\": \"Usuários sem políticas não podem realizar nenhuma ação e podem ser redundantes.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach a policy to the user or remove the user.\",\n\t\t\"zh\": \"为该用户挂载策略，或将其移除。\",\n\t\t\"ja\": \"ユーザーにポリシーをアタッチするか、ユーザーを削除します。\",\n\t\t\"de\": \"Hängen Sie eine Richtlinie an den Benutzer an oder entfernen Sie den Benutzer.\",\n\t\t\"es\": \"Adjunte una política al usuario o elimine el usuario.\",\n\t\t\"fr\": \"Attachez une politique à l'utilisateur ou supprimez l'utilisateur.\",\n\t\t\"pt\": \"Anexe uma política ao usuário ou remova o usuário.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\nhas_policy(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_referencing(user_name_val, user_name)\n}\n\nhas_policy(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_get_att_referencing(user_name_val, user_name)\n}\n\nhas_policy(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\tname == user_name\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tcustom_policies := object.get(policy_attachments, \"Custom\", [])\n\tcount(system_policies) > 0\n}\n\nhas_policy(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\tname == user_name\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tcustom_policies := object.get(policy_attachments, \"Custom\", [])\n\tcount(custom_policies) > 0\n}\n\ndeny contains result if {\n\tsome user_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\tnot has_policy(user_name)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_name,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-no-product-admin-access", Name: models.I18nString{"de": "RAM-Benutzer kein Produkt-Administrativzugriff", "en": "RAM User No Product Administrative Access", "es": "Usuario RAM Sin Acceso Administrativo de Producto", "fr": "Utilisateur RAM Sans Accès Administratif au Produit", "ja": "RAM ユーザーに製品管理アクセスなし", "pt": "Usuário RAM Sem Acesso Administrativo ao Produto", "zh": "RAM 用户没有产品管理权限"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer keinen vollständigen administrativen Zugriff auf Cloud-Produkte haben, es sei denn, es ist notwendig.", "en": "Ensures that RAM users do not have full administrative access to cloud products unless necessary.", "es": "Garantiza que los usuarios RAM no tengan acceso administrativo completo a los productos en la nube a menos que sea necesario.", "fr": "Garantit que les utilisateurs RAM n'ont pas d'accès administratif complet aux produits cloud sauf si nécessaire.", "ja": "必要でない限り、RAM ユーザーがクラウド製品への完全な管理アクセスを持たないことを確認します。", "pt": "Garante que os usuários RAM não tenham acesso administrativo completo aos produtos em nuvem, a menos que seja necessário.", "zh": "确保 RAM 用户未被授予对云产品的完全管理权限，除非必要。"}, Reason: models.I18nString{"de": "Die Gewährung von administrativem Zugriff für alle Benutzer erhöht das Risiko versehentlicher oder böswilliger Konfigurationsänderungen.", "en": "Granting administrative access to all users increases the risk of accidental or malicious configuration changes.", "es": "Otorgar acceso administrativo a todos los usuarios aumenta el riesgo de cambios de configuración accidentales o maliciosos.", "fr": "Accorder l'accès administratif à tous les utilisateurs augmente le risque de modifications de configuration accidentelles ou malveillantes.", "ja": "すべてのユーザーに管理アクセスを付与すると、偶発的または悪意のある設定変更のリスクが増加します。", "pt": "Conceder acesso administrativo a todos os usuários aumenta o risco de alterações acidentais ou maliciosas na configuração.", "zh": "向所有用户授予管理权限会增加意外或恶意配置更改的风险。"}, Recommendation: models.I18nString{"de": "Folgen Sie dem Prinzip der geringsten Berechtigung und gewähren Sie RAM-Benutzern nur notwendige Berechtigungen.", "en": "Follow the principle of least privilege and grant only necessary permissions to RAM users.", "es": "Siga el principio de menor privilegio y otorgue solo los permisos necesarios a los usuarios RAM.", "fr": "Suivez le principe du moindre privilège et accordez uniquement les permissions nécessaires aux utilisateurs RAM.", "ja": "最小権限の原則に従い、RAM ユーザーに必要な権限のみを付与します。", "pt": "Siga o princípio do menor privilégio e conceda apenas as permissões necessárias aos usuários RAM.", "zh": "遵循最小权限原则，仅向 RAM 用户授予必要的权限。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-no-product-admin-access.rego", PackageName: "infraguard.rules.aliyun.ram_user_no_product_admin_access", Content: "package infraguard.rules.aliyun.ram_user_no_product_admin_access\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"ram-user-no-product-admin-access\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User No Product Administrative Access\",\n\t\t\"zh\": \"RAM 用户没有产品管理权限\",\n\t\t\"ja\": \"RAM ユーザーに製品管理アクセスなし\",\n\t\t\"de\": \"RAM-Benutzer kein Produkt-Administrativzugriff\",\n\t\t\"es\": \"Usuario RAM Sin Acceso Administrativo de Producto\",\n\t\t\"fr\": \"Utilisateur RAM Sans Accès Administratif au Produit\",\n\t\t\"pt\": \"Usuário RAM Sem Acesso Administrativo ao Produto\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that RAM users do not have full administrative access to cloud products unless necessary.\",\n\t\t\"zh\": \"确保 RAM 用户未被授予对云产品的完全管理权限，除非必要。\",\n\t\t\"ja\": \"必要でない限り、RAM ユーザーがクラウド製品への完全な管理アクセスを持たないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer keinen vollständigen administrativen Zugriff auf Cloud-Produkte haben, es sei denn, es ist notwendig.\",\n\t\t\"es\": \"Garantiza que los usuarios RAM no tengan acceso administrativo completo a los productos en la nube a menos que sea necesario.\",\n\t\t\"fr\": \"Garantit que les utilisateurs RAM n'ont pas d'accès administratif complet aux produits cloud sauf si nécessaire.\",\n\t\t\"pt\": \"Garante que os usuários RAM não tenham acesso administrativo completo aos produtos em nuvem, a menos que seja necessário.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Granting administrative access to all users increases the risk of accidental or malicious configuration changes.\",\n\t\t\"zh\": \"向所有用户授予管理权限会增加意外或恶意配置更改的风险。\",\n\t\t\"ja\": \"すべてのユーザーに管理アクセスを付与すると、偶発的または悪意のある設定変更のリスクが増加します。\",\n\t\t\"de\": \"Die Gewährung von administrativem Zugriff für alle Benutzer erhöht das Risiko versehentlicher oder böswilliger Konfigurationsänderungen.\",\n\t\t\"es\": \"Otorgar acceso administrativo a todos los usuarios aumenta el riesgo de cambios de configuración accidentales o maliciosos.\",\n\t\t\"fr\": \"Accorder l'accès administratif à tous les utilisateurs augmente le risque de modifications de configuration accidentelles ou malveillantes.\",\n\t\t\"pt\": \"Conceder acesso administrativo a todos os usuários aumenta o risco de alterações acidentais ou maliciosas na configuração.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Follow the principle of least privilege and grant only necessary permissions to RAM users.\",\n\t\t\"zh\": \"遵循最小权限原则，仅向 RAM 用户授予必要的权限。\",\n\t\t\"ja\": \"最小権限の原則に従い、RAM ユーザーに必要な権限のみを付与します。\",\n\t\t\"de\": \"Folgen Sie dem Prinzip der geringsten Berechtigung und gewähren Sie RAM-Benutzern nur notwendige Berechtigungen.\",\n\t\t\"es\": \"Siga el principio de menor privilegio y otorgue solo los permisos necesarios a los usuarios RAM.\",\n\t\t\"fr\": \"Suivez le principe du moindre privilège et accordez uniquement les permissions nécessaires aux utilisateurs RAM.\",\n\t\t\"pt\": \"Siga o princípio do menor privilégio e conceda apenas as permissões necessárias aos usuários RAM.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\t# Conceptual check for attached policies\n\thelpers.has_property(resource, \"Policies\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-role-no-product-admin-access", Name: models.I18nString{"de": "RAM-Benutzerrolle Kein Produkt-Admin-Zugriff", "en": "RAM User Role No Product Admin Access", "es": "El Rol de Usuario RAM No Tiene Acceso de Administrador de Producto", "fr": "Le Rôle d'Utilisateur RAM N'a Pas d'Accès Administrateur Produit", "ja": "RAM ユーザーロールに製品管理アクセスがない", "pt": "A Função de Usuário RAM Não Tem Acesso de Administrador de Produto", "zh": "ram 用户定义的角色不包括产品管理权限"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-benutzerdefinierte Rollen keine Produkt-Administratorberechtigungen haben.", "en": "Ensures RAM user-defined roles do not have product administrative permissions.", "es": "Garantiza que los roles definidos por el usuario RAM no tengan permisos administrativos de producto.", "fr": "Garantit que les rôles définis par l'utilisateur RAM n'ont pas de permissions administratives de produit.", "ja": "RAM ユーザー定義のロールが製品管理権限を持っていないことを確認します。", "pt": "Garante que as funções definidas pelo usuário RAM não tenham permissões administrativas de produto.", "zh": "确保 RAM 用户创建的角色未拥有管理员权限或者某个云产品的管理员权限。"}, Reason: models.I18nString{"de": "Benutzerdefinierte Rollen mit Admin-Berechtigungen erhöhen die Sicherheitsrisiken.", "en": "Custom roles with admin permissions increase security risks.", "es": "Los roles personalizados con permisos de administrador aumentan los riesgos de seguridad.", "fr": "Les rôles personnalisés avec des permissions d'administrateur augmentent les risques de sécurité.", "ja": "管理権限を持つカスタムロールはセキュリティリスクを増加させます。", "pt": "Funções personalizadas com permissões de administrador aumentam os riscos de segurança.", "zh": "具有管理权限的自定义角色会增加安全风险。"}, Recommendation: models.I18nString{"de": "Überprüfen Sie Rollenberechtigungen und entfernen Sie übermäßige Berechtigungen.", "en": "Review role permissions and remove excessive privileges.", "es": "Revise los permisos del rol y elimine los privilegios excesivos.", "fr": "Examinez les permissions du rôle et supprimez les privilèges excessifs.", "ja": "ロール権限を確認し、過剰な権限を削除します。", "pt": "Revise as permissões da função e remova privilégios excessivos.", "zh": "审查角色权限并移除过多的权限。"}, ResourceTypes: []string{"ALIYUN::RAM::Role"}, FilePath: "aliyun/rules/ram-user-role-no-product-admin-access.rego", PackageName: "infraguard.rules.aliyun.ram_user_role_no_product_admin_access", Content: "package infraguard.rules.aliyun.ram_user_role_no_product_admin_access\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-user-role-no-product-admin-access\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User Role No Product Admin Access\",\n\t\t\"zh\": \"ram 用户定义的角色不包括产品管理权限\",\n\t\t\"ja\": \"RAM ユーザーロールに製品管理アクセスがない\",\n\t\t\"de\": \"RAM-Benutzerrolle Kein Produkt-Admin-Zugriff\",\n\t\t\"es\": \"El Rol de Usuario RAM No Tiene Acceso de Administrador de Producto\",\n\t\t\"fr\": \"Le Rôle d'Utilisateur RAM N'a Pas d'Accès Administrateur Produit\",\n\t\t\"pt\": \"A Função de Usuário RAM Não Tem Acesso de Administrador de Produto\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM user-defined roles do not have product administrative permissions.\",\n\t\t\"zh\": \"确保 RAM 用户创建的角色未拥有管理员权限或者某个云产品的管理员权限。\",\n\t\t\"ja\": \"RAM ユーザー定義のロールが製品管理権限を持っていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-benutzerdefinierte Rollen keine Produkt-Administratorberechtigungen haben.\",\n\t\t\"es\": \"Garantiza que los roles definidos por el usuario RAM no tengan permisos administrativos de producto.\",\n\t\t\"fr\": \"Garantit que les rôles définis par l'utilisateur RAM n'ont pas de permissions administratives de produit.\",\n\t\t\"pt\": \"Garante que as funções definidas pelo usuário RAM não tenham permissões administrativas de produto.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Custom roles with admin permissions increase security risks.\",\n\t\t\"zh\": \"具有管理权限的自定义角色会增加安全风险。\",\n\t\t\"ja\": \"管理権限を持つカスタムロールはセキュリティリスクを増加させます。\",\n\t\t\"de\": \"Benutzerdefinierte Rollen mit Admin-Berechtigungen erhöhen die Sicherheitsrisiken.\",\n\t\t\"es\": \"Los roles personalizados con permisos de administrador aumentan los riesgos de seguridad.\",\n\t\t\"fr\": \"Les rôles personnalisés avec des permissions d'administrateur augmentent les risques de sécurité.\",\n\t\t\"pt\": \"Funções personalizadas com permissões de administrador aumentam os riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Review role permissions and remove excessive privileges.\",\n\t\t\"zh\": \"审查角色权限并移除过多的权限。\",\n\t\t\"ja\": \"ロール権限を確認し、過剰な権限を削除します。\",\n\t\t\"de\": \"Überprüfen Sie Rollenberechtigungen und entfernen Sie übermäßige Berechtigungen.\",\n\t\t\"es\": \"Revise los permisos del rol y elimine los privilegios excesivos.\",\n\t\t\"fr\": \"Examinez les permissions du rôle et supprimez les privilèges excessifs.\",\n\t\t\"pt\": \"Revise as permissões da função e remova privilégios excessivos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::Role\"]\n}\n\nis_service_linked_role(policy_doc) if {\n\tstatements := object.get(policy_doc, \"Statement\", [])\n\tsome statement in statements\n\teffect := object.get(statement, \"Effect\", \"\")\n\teffect == \"Allow\"\n\n\tprincipal := object.get(statement, \"Principal\", {})\n\tservices := object.get(principal, \"Service\", [])\n\n\tsome service in services\n\tcontains(service, \".aliyuncs.com\")\n}\n\nhas_admin_access(resource) if {\n\tpolicies := helpers.get_property(resource, \"Policies\", [])\n\tsome policy_def in policies\n\tdoc := object.get(policy_def, \"PolicyDocument\", {})\n\n\tstatements := object.get(doc, \"Statement\", [])\n\tsome statement in statements\n\teffect := object.get(statement, \"Effect\", \"\")\n\teffect == \"Allow\"\n\n\tactions := object.get(statement, \"Action\", [])\n\tresources := object.get(statement, \"Resource\", [])\n\n\tis_wildcard(actions)\n\tis_wildcard(resources)\n}\n\nhas_admin_access(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tsome policy in system_policies\n\tpolicy == \"AdministratorAccess\"\n}\n\nhas_admin_access_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\thelpers.is_referencing(role_name_val, role_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tpolicy_name == \"AdministratorAccess\"\n}\n\nhas_admin_access_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\thelpers.is_get_att_referencing(role_name_val, role_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tpolicy_name == \"AdministratorAccess\"\n}\n\nhas_admin_access_via_attachment(role_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToRole\")\n\trole_name_val := helpers.get_property(resource, \"RoleName\", \"\")\n\trole_resource := helpers.resources_by_type(\"ALIYUN::RAM::Role\")[role_name]\n\tactual_name := helpers.get_property(role_resource, \"RoleName\", role_name)\n\trole_name_val == actual_name\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tpolicy_name == \"AdministratorAccess\"\n}\n\nis_wildcard(\"*\") := true\nis_wildcard([\"*\"]) := true\n\nis_wildcard(arr) if {\n\tis_array(arr)\n\tsome item in arr\n\titem == \"*\"\n}\n\ndeny contains result if {\n\tsome role_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::Role\")\n\n\tpolicy_doc := helpers.get_property(resource, \"AssumeRolePolicyDocument\", {})\n\tnot is_service_linked_role(policy_doc)\n\n\thas_admin_access(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": role_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyDocument\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome role_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::Role\")\n\n\tpolicy_doc := helpers.get_property(resource, \"AssumeRolePolicyDocument\", {})\n\tnot is_service_linked_role(policy_doc)\n\n\thas_admin_access_via_attachment(role_name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": role_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:ram-user-specified-permission-bound", Name: models.I18nString{"de": "RAM-Benutzer Angegebene Berechtigungsgrenze", "en": "RAM User Specified Permission Bound", "es": "Límite de Permiso Especificado del Usuario RAM", "fr": "Limite de Permission Spécifiée de l'Utilisateur RAM", "ja": "RAM ユーザー指定の権限バウンド", "pt": "Limite de Permissão Especificada do Usuário RAM", "zh": "RAM 用户未绑定指定的高危权限"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RAM-Benutzer keine angegebenen Hochrisiko-Berechtigungen gebunden haben.", "en": "Ensures RAM users do not have specified high-risk permissions bound.", "es": "Garantiza que los usuarios RAM no tengan permisos de alto riesgo especificados vinculados.", "fr": "Garantit que les utilisateurs RAM n'ont pas de permissions à haut risque spécifiées liées.", "ja": "RAM ユーザーに指定された高リスク権限がバインドされていないことを確認します。", "pt": "Garante que os usuários RAM não tenham permissões de alto risco especificadas vinculadas.", "zh": "确保 RAM 用户绑定的权限策略配置中，不包含规则入参指定的高危权限配置。"}, Reason: models.I18nString{"de": "Hochrisiko-Berechtigungen können bei Missbrauch erheblichen Schaden verursachen.", "en": "High-risk permissions can cause significant damage if misused.", "es": "Los permisos de alto riesgo pueden causar daños significativos si se usan mal.", "fr": "Les permissions à haut risque peuvent causer des dommages importants en cas d'abus.", "ja": "高リスク権限は誤用されると重大な損害を引き起こす可能性があります。", "pt": "Permissões de alto risco podem causar danos significativos se mal utilizadas.", "zh": "高危权限一旦被滥用可能造成重大损失。"}, Recommendation: models.I18nString{"de": "Überprüfen und beschränken Sie Benutzerberechtigungen auf das Notwendige.", "en": "Review and restrict user permissions to only what's necessary.", "es": "Revise y restrinja los permisos del usuario solo a lo necesario.", "fr": "Examinez et restreignez les permissions utilisateur uniquement à ce qui est nécessaire.", "ja": "ユーザー権限を確認し、必要なもののみに制限します。", "pt": "Revise e restrinja as permissões do usuário apenas ao necessário.", "zh": "审查并限制用户权限，仅授予必要的权限。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/ram-user-specified-permission-bound.rego", PackageName: "infraguard.rules.aliyun.ram_user_specified_permission_bound", Content: "package infraguard.rules.aliyun.ram_user_specified_permission_bound\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"ram-user-specified-permission-bound\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RAM User Specified Permission Bound\",\n\t\t\"zh\": \"RAM 用户未绑定指定的高危权限\",\n\t\t\"ja\": \"RAM ユーザー指定の権限バウンド\",\n\t\t\"de\": \"RAM-Benutzer Angegebene Berechtigungsgrenze\",\n\t\t\"es\": \"Límite de Permiso Especificado del Usuario RAM\",\n\t\t\"fr\": \"Limite de Permission Spécifiée de l'Utilisateur RAM\",\n\t\t\"pt\": \"Limite de Permissão Especificada do Usuário RAM\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RAM users do not have specified high-risk permissions bound.\",\n\t\t\"zh\": \"确保 RAM 用户绑定的权限策略配置中，不包含规则入参指定的高危权限配置。\",\n\t\t\"ja\": \"RAM ユーザーに指定された高リスク権限がバインドされていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RAM-Benutzer keine angegebenen Hochrisiko-Berechtigungen gebunden haben.\",\n\t\t\"es\": \"Garantiza que los usuarios RAM no tengan permisos de alto riesgo especificados vinculados.\",\n\t\t\"fr\": \"Garantit que les utilisateurs RAM n'ont pas de permissions à haut risque spécifiées liées.\",\n\t\t\"pt\": \"Garante que os usuários RAM não tenham permissões de alto risco especificadas vinculadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"High-risk permissions can cause significant damage if misused.\",\n\t\t\"zh\": \"高危权限一旦被滥用可能造成重大损失。\",\n\t\t\"ja\": \"高リスク権限は誤用されると重大な損害を引き起こす可能性があります。\",\n\t\t\"de\": \"Hochrisiko-Berechtigungen können bei Missbrauch erheblichen Schaden verursachen.\",\n\t\t\"es\": \"Los permisos de alto riesgo pueden causar daños significativos si se usan mal.\",\n\t\t\"fr\": \"Les permissions à haut risque peuvent causer des dommages importants en cas d'abus.\",\n\t\t\"pt\": \"Permissões de alto risco podem causar danos significativos se mal utilizadas.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Review and restrict user permissions to only what's necessary.\",\n\t\t\"zh\": \"审查并限制用户权限，仅授予必要的权限。\",\n\t\t\"ja\": \"ユーザー権限を確認し、必要なもののみに制限します。\",\n\t\t\"de\": \"Überprüfen und beschränken Sie Benutzerberechtigungen auf das Notwendige.\",\n\t\t\"es\": \"Revise y restrinja los permisos del usuario solo a lo necesario.\",\n\t\t\"fr\": \"Examinez et restreignez les permissions utilisateur uniquement à ce qui est nécessaire.\",\n\t\t\"pt\": \"Revise e restrinja as permissões do usuário apenas ao necessário.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\nhigh_risk_actions := [\n\t\"ecs:DeleteInstance\",\n\t\"ecs:StopInstance\",\n\t\"oss:DeleteBucket\",\n\t\"oss:DeleteObject\",\n\t\"rds:DeleteDBInstance\",\n\t\"kms:DeleteKey\",\n\t\"ram:DeleteUser\",\n\t\"ram:DeletePolicy\",\n]\n\nis_admin_policy_name(policy_name) if {\n\tpolicy_name == \"AdministratorAccess\"\n}\n\nis_admin_policy_name(policy_name) if {\n\tcontains(policy_name, \"FullAccess\")\n\tcontains(policy_name, \"Admin\")\n}\n\nhas_admin_system_policy(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tsystem_policies := object.get(policy_attachments, \"System\", [])\n\tsome policy in system_policies\n\tis_admin_policy_name(policy)\n}\n\nhas_admin_custom_policy(resource) if {\n\tpolicy_attachments := helpers.get_property(resource, \"PolicyAttachments\", {})\n\tcustom_policies := object.get(policy_attachments, \"Custom\", [])\n\tsome policy in custom_policies\n\tis_admin_policy_name(policy)\n}\n\nhas_admin_policy_via_attachment(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_referencing(user_name_val, user_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tis_admin_policy_name(policy_name)\n}\n\nhas_admin_policy_via_attachment(user_name) if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::AttachPolicyToUser\")\n\tuser_name_val := helpers.get_property(resource, \"UserName\", \"\")\n\thelpers.is_get_att_referencing(user_name_val, user_name)\n\tpolicy_name := helpers.get_property(resource, \"PolicyName\", \"\")\n\tis_admin_policy_name(policy_name)\n}\n\n# Get high risk actions from parameter or default\nget_high_risk_actions := actions if {\n\tactions := input.parameters.highRiskActions\n\tis_array(actions)\n} else := high_risk_actions\n\n# Check inline policies for high risk actions\nhas_inline_high_risk_permission(resource) if {\n\tpolicies := helpers.get_property(resource, \"Policies\", [])\n\tsome policy in policies\n\tdoc := object.get(policy, \"PolicyDocument\", {})\n\n\tstatements := object.get(doc, \"Statement\", [])\n\tsome statement in statements\n\teffect := object.get(statement, \"Effect\", \"\")\n\teffect == \"Allow\"\n\n\tactions := to_list(object.get(statement, \"Action\", []))\n\trequired_risks := get_high_risk_actions\n\n\tsome action in actions\n\tsome risk in required_risks\n\taction == risk\n}\n\nto_list(v) := v if is_array(v)\nto_list(v) := [v] if is_string(v)\n\ndeny contains result if {\n\tsome user_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\thas_inline_high_risk_permission(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_name,\n\t\t\"violation_path\": [\"Properties\", \"Policies\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome user_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\thas_admin_system_policy(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyAttachments\", \"System\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome user_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\thas_admin_custom_policy(resource)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_name,\n\t\t\"violation_path\": [\"Properties\", \"PolicyAttachments\", \"Custom\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\ndeny contains result if {\n\tsome user_name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\n\thas_admin_policy_via_attachment(user_name)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": user_name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instacne-delete-protection-enabled", Name: models.I18nString{"de": "RDS-Instanz-Löschschutz aktiviert", "en": "RDS Instance Deletion Protection Enabled", "es": "Protección contra Eliminación de Instancia RDS Habilitada", "fr": "Protection contre la Suppression d'Instance RDS Activée", "ja": "RDS インスタンスの削除保護が有効", "pt": "Proteção contra Exclusão de Instância RDS Habilitada", "zh": "RDS 实例开启删除保护"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RDS-Instanzen den Löschschutz aktiviert haben.", "en": "Ensures that RDS instances have deletion protection enabled.", "es": "Garantiza que las instancias RDS tengan protección contra eliminación habilitada.", "fr": "Garantit que les instances RDS ont la protection contre la suppression activée.", "ja": "RDS インスタンスで削除保護が有効になっていることを確認します。", "pt": "Garante que as instâncias RDS tenham proteção contra exclusão habilitada.", "zh": "确保 RDS 实例开启了删除保护。"}, Reason: models.I18nString{"de": "Wenn der Löschschutz nicht aktiviert ist, kann die RDS-Instanz versehentlich freigegeben werden, was zu Datenverlust führt.", "en": "If deletion protection is not enabled, the RDS instance may be released accidentally, causing data loss.", "es": "Si la protección contra eliminación no está habilitada, la instancia RDS puede ser liberada accidentalmente, causando pérdida de datos.", "fr": "Si la protection contre la suppression n'est pas activée, l'instance RDS peut être libérée accidentellement, causant une perte de données.", "ja": "削除保護が有効になっていない場合、RDS インスタンスが誤って解放され、データ損失が発生する可能性があります。", "pt": "Se a proteção contra exclusão não estiver habilitada, a instância RDS pode ser liberada acidentalmente, causando perda de dados.", "zh": "如果未开启删除保护，RDS 实例可能会被意外释放，导致数据丢失。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für die RDS-Instanz.", "en": "Enable deletion protection for the RDS instance.", "es": "Habilite protección contra eliminación para la instancia RDS.", "fr": "Activez la protection contre la suppression pour l'instance RDS.", "ja": "RDS インスタンスで削除保護を有効にします。", "pt": "Habilite proteção contra exclusão para a instância RDS.", "zh": "为 RDS 实例开启删除保护功能。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instacne-delete-protection-enabled.rego", PackageName: "infraguard.rules.aliyun.rds_instacne_delete_protection_enabled", Content: "package infraguard.rules.aliyun.rds_instacne_delete_protection_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"rds-instacne-delete-protection-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Deletion Protection Enabled\",\n\t\t\"zh\": \"RDS 实例开启删除保护\",\n\t\t\"ja\": \"RDS インスタンスの削除保護が有効\",\n\t\t\"de\": \"RDS-Instanz-Löschschutz aktiviert\",\n\t\t\"es\": \"Protección contra Eliminación de Instancia RDS Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression d'Instance RDS Activée\",\n\t\t\"pt\": \"Proteção contra Exclusão de Instância RDS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that RDS instances have deletion protection enabled.\",\n\t\t\"zh\": \"确保 RDS 实例开启了删除保护。\",\n\t\t\"ja\": \"RDS インスタンスで削除保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RDS-Instanzen den Löschschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias RDS tengan protección contra eliminación habilitada.\",\n\t\t\"fr\": \"Garantit que les instances RDS ont la protection contre la suppression activée.\",\n\t\t\"pt\": \"Garante que as instâncias RDS tenham proteção contra exclusão habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If deletion protection is not enabled, the RDS instance may be released accidentally, causing data loss.\",\n\t\t\"zh\": \"如果未开启删除保护，RDS 实例可能会被意外释放，导致数据丢失。\",\n\t\t\"ja\": \"削除保護が有効になっていない場合、RDS インスタンスが誤って解放され、データ損失が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Löschschutz nicht aktiviert ist, kann die RDS-Instanz versehentlich freigegeben werden, was zu Datenverlust führt.\",\n\t\t\"es\": \"Si la protección contra eliminación no está habilitada, la instancia RDS puede ser liberada accidentalmente, causando pérdida de datos.\",\n\t\t\"fr\": \"Si la protection contre la suppression n'est pas activée, l'instance RDS peut être libérée accidentellement, causant une perte de données.\",\n\t\t\"pt\": \"Se a proteção contra exclusão não estiver habilitada, a instância RDS pode ser liberada acidentalmente, causando perda de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for the RDS instance.\",\n\t\t\"zh\": \"为 RDS 实例开启删除保护功能。\",\n\t\t\"ja\": \"RDS インスタンスで削除保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für die RDS-Instanz.\",\n\t\t\"es\": \"Habilite protección contra eliminación para la instancia RDS.\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour l'instance RDS.\",\n\t\t\"pt\": \"Habilite proteção contra exclusão para a instância RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-enabled-auditing", Name: models.I18nString{"de": "RDS-Instanz-Überwachung aktiviert", "en": "RDS Instance Auditing Enabled", "es": "Auditoría de Instancia RDS Habilitada", "fr": "Audit d'Instance RDS Activé", "ja": "RDS インスタンスで監査が有効", "pt": "Auditoria de Instância RDS Habilitada", "zh": "RDS 实例开启 SQL 审计"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RDS-Instanzen SQL-Überwachung aktiviert haben.", "en": "Ensures RDS instances have SQL auditing enabled.", "es": "Garantiza que las instancias RDS tengan auditoría SQL habilitada.", "fr": "Garantit que les instances RDS ont l'audit SQL activé.", "ja": "RDS インスタンスで SQL 監査が有効になっていることを確認します。", "pt": "Garante que as instâncias RDS tenham auditoria SQL habilitada.", "zh": "确保 RDS 实例开启了 SQL 审计。"}, Reason: models.I18nString{"de": "SQL-Überwachung hilft dabei, Datenbankaktivitäten zu verfolgen und Sicherheitsvorfälle zu untersuchen.", "en": "SQL auditing helps track database activities and investigate security incidents.", "es": "La auditoría SQL ayuda a rastrear las actividades de la base de datos e investigar incidentes de seguridad.", "fr": "L'audit SQL aide à suivre les activités de la base de données et à enquêter sur les incidents de sécurité.", "ja": "SQL 監査は、データベース活動を追跡し、セキュリティインシデントを調査するのに役立ちます。", "pt": "A auditoria SQL ajuda a rastrear atividades do banco de dados e investigar incidentes de segurança.", "zh": "SQL 审计有助于跟踪数据库活动并调查安全事件。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie SQL Collector für die RDS-Instanz.", "en": "Enable SQL Collector for the RDS instance.", "es": "Habilite SQL Collector para la instancia RDS.", "fr": "Activez SQL Collector pour l'instance RDS.", "ja": "RDS インスタンスで SQL Collector を有効にします。", "pt": "Habilite SQL Collector para a instância RDS.", "zh": "为 RDS 实例开启 SQL 审计（SQL Collector）。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instance-enabled-auditing.rego", PackageName: "infraguard.rules.aliyun.rds_instance_enabled_auditing", Content: "package infraguard.rules.aliyun.rds_instance_enabled_auditing\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"rds-instance-enabled-auditing\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Auditing Enabled\",\n\t\t\"zh\": \"RDS 实例开启 SQL 审计\",\n\t\t\"ja\": \"RDS インスタンスで監査が有効\",\n\t\t\"de\": \"RDS-Instanz-Überwachung aktiviert\",\n\t\t\"es\": \"Auditoría de Instancia RDS Habilitada\",\n\t\t\"fr\": \"Audit d'Instance RDS Activé\",\n\t\t\"pt\": \"Auditoria de Instância RDS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RDS instances have SQL auditing enabled.\",\n\t\t\"zh\": \"确保 RDS 实例开启了 SQL 审计。\",\n\t\t\"ja\": \"RDS インスタンスで SQL 監査が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RDS-Instanzen SQL-Überwachung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias RDS tengan auditoría SQL habilitada.\",\n\t\t\"fr\": \"Garantit que les instances RDS ont l'audit SQL activé.\",\n\t\t\"pt\": \"Garante que as instâncias RDS tenham auditoria SQL habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"SQL auditing helps track database activities and investigate security incidents.\",\n\t\t\"zh\": \"SQL 审计有助于跟踪数据库活动并调查安全事件。\",\n\t\t\"ja\": \"SQL 監査は、データベース活動を追跡し、セキュリティインシデントを調査するのに役立ちます。\",\n\t\t\"de\": \"SQL-Überwachung hilft dabei, Datenbankaktivitäten zu verfolgen und Sicherheitsvorfälle zu untersuchen.\",\n\t\t\"es\": \"La auditoría SQL ayuda a rastrear las actividades de la base de datos e investigar incidentes de seguridad.\",\n\t\t\"fr\": \"L'audit SQL aide à suivre les activités de la base de données et à enquêter sur les incidents de sécurité.\",\n\t\t\"pt\": \"A auditoria SQL ajuda a rastrear atividades do banco de dados e investigar incidentes de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable SQL Collector for the RDS instance.\",\n\t\t\"zh\": \"为 RDS 实例开启 SQL 审计（SQL Collector）。\",\n\t\t\"ja\": \"RDS インスタンスで SQL Collector を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie SQL Collector für die RDS-Instanz.\",\n\t\t\"es\": \"Habilite SQL Collector para la instancia RDS.\",\n\t\t\"fr\": \"Activez SQL Collector pour l'instance RDS.\",\n\t\t\"pt\": \"Habilite SQL Collector para a instância RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\thelpers.get_property(resource, \"SQLCollectorStatus\", \"Disabled\") == \"Enable\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SQLCollectorStatus\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-enabled-disk-encryption", Name: models.I18nString{"de": "RDS-Instanz-Disk-Verschlüsselung aktiviert", "en": "RDS Instance Disk Encryption Enabled", "es": "Cifrado de Disco de Instancia RDS Habilitado", "fr": "Chiffrement de Disque d'Instance RDS Activé", "ja": "RDS インスタンスのディスク暗号化が有効", "pt": "Criptografia de Disco de Instância RDS Habilitada", "zh": "RDS 实例开启磁盘加密"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass RDS-Instanzen Disk-Verschlüsselung aktiviert haben.", "en": "Ensures RDS instances have disk encryption enabled.", "es": "Garantiza que las instancias RDS tengan cifrado de disco habilitado.", "fr": "Garantit que les instances RDS ont le chiffrement de disque activé.", "ja": "RDS インスタンスでディスク暗号化が有効になっていることを確認します。", "pt": "Garante que as instâncias RDS tenham criptografia de disco habilitada.", "zh": "确保 RDS 实例开启了磁盘加密。"}, Reason: models.I18nString{"de": "Disk-Verschlüsselung schützt den zugrundeliegenden Datenspeicher vor unbefugtem physischem Zugriff.", "en": "Disk encryption protects the underlying data storage from unauthorized physical access.", "es": "El cifrado de disco protege el almacenamiento de datos subyacente del acceso físico no autorizado.", "fr": "Le chiffrement de disque protège le stockage de données sous-jacent contre l'accès physique non autorisé.", "ja": "ディスク暗号化により、基盤となるデータストレージが不正な物理アクセスから保護されます。", "pt": "A criptografia de disco protege o armazenamento de dados subjacente contra acesso físico não autorizado.", "zh": "磁盘加密保护底层数据存储免受未经授权的物理访问。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Disk-Verschlüsselung für die RDS-Instanz.", "en": "Enable disk encryption for the RDS instance.", "es": "Habilite el cifrado de disco para la instancia RDS.", "fr": "Activez le chiffrement de disque pour l'instance RDS.", "ja": "RDS インスタンスでディスク暗号化を有効にします。", "pt": "Habilite criptografia de disco para a instância RDS.", "zh": "为 RDS 实例开启磁盘加密。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instance-enabled-disk-encryption.rego", PackageName: "infraguard.rules.aliyun.rds_instance_enabled_disk_encryption", Content: "package infraguard.rules.aliyun.rds_instance_enabled_disk_encryption\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"rds-instance-enabled-disk-encryption\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Disk Encryption Enabled\",\n\t\t\"zh\": \"RDS 实例开启磁盘加密\",\n\t\t\"ja\": \"RDS インスタンスのディスク暗号化が有効\",\n\t\t\"de\": \"RDS-Instanz-Disk-Verschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado de Disco de Instancia RDS Habilitado\",\n\t\t\"fr\": \"Chiffrement de Disque d'Instance RDS Activé\",\n\t\t\"pt\": \"Criptografia de Disco de Instância RDS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RDS instances have disk encryption enabled.\",\n\t\t\"zh\": \"确保 RDS 实例开启了磁盘加密。\",\n\t\t\"ja\": \"RDS インスタンスでディスク暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RDS-Instanzen Disk-Verschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias RDS tengan cifrado de disco habilitado.\",\n\t\t\"fr\": \"Garantit que les instances RDS ont le chiffrement de disque activé.\",\n\t\t\"pt\": \"Garante que as instâncias RDS tenham criptografia de disco habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Disk encryption protects the underlying data storage from unauthorized physical access.\",\n\t\t\"zh\": \"磁盘加密保护底层数据存储免受未经授权的物理访问。\",\n\t\t\"ja\": \"ディスク暗号化により、基盤となるデータストレージが不正な物理アクセスから保護されます。\",\n\t\t\"de\": \"Disk-Verschlüsselung schützt den zugrundeliegenden Datenspeicher vor unbefugtem physischem Zugriff.\",\n\t\t\"es\": \"El cifrado de disco protege el almacenamiento de datos subyacente del acceso físico no autorizado.\",\n\t\t\"fr\": \"Le chiffrement de disque protège le stockage de données sous-jacent contre l'accès physique non autorisé.\",\n\t\t\"pt\": \"A criptografia de disco protege o armazenamento de dados subjacente contra acesso físico não autorizado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable disk encryption for the RDS instance.\",\n\t\t\"zh\": \"为 RDS 实例开启磁盘加密。\",\n\t\t\"ja\": \"RDS インスタンスでディスク暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Disk-Verschlüsselung für die RDS-Instanz.\",\n\t\t\"es\": \"Habilite el cifrado de disco para la instancia RDS.\",\n\t\t\"fr\": \"Activez le chiffrement de disque pour l'instance RDS.\",\n\t\t\"pt\": \"Habilite criptografia de disco para a instância RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\t# EncryptionKey being set usually indicates disk encryption is enabled.\n\thelpers.has_property(resource, \"EncryptionKey\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EncryptionKey\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-enabled-log-backup", Name: models.I18nString{"de": "RDS-Instanz Log-Backup aktiviert", "en": "RDS Instance Log Backup Enabled", "es": "Backup de Log de Instancia RDS Habilitado", "fr": "Sauvegarde de Journal d'Instance RDS Activée", "ja": "RDS インスタンスでログバックアップが有効", "pt": "Backup de Log de Instância RDS Habilitado", "zh": "RDS 实例开启日志备份"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RDS-Instanzen Log-Backup aktiviert haben.", "en": "Ensures RDS instances have log backup enabled.", "es": "Garantiza que las instancias RDS tengan backup de log habilitado.", "fr": "Garantit que les instances RDS ont la sauvegarde de journal activée.", "ja": "RDS インスタンスでログバックアップが有効になっていることを確認します。", "pt": "Garante que as instâncias RDS tenham backup de log habilitado.", "zh": "确保 RDS 实例开启了日志备份。"}, Reason: models.I18nString{"de": "Log-Backups sind für die Point-in-Time-Wiederherstellung der Datenbank unerlässlich.", "en": "Log backups are essential for point-in-time recovery of the database.", "es": "Los backups de log son esenciales para la recuperación puntual de la base de datos.", "fr": "Les sauvegardes de journal sont essentielles pour la récupération ponctuelle de la base de données.", "ja": "ログバックアップは、データベースのポイントインタイムリカバリに不可欠です。", "pt": "Backups de log são essenciais para recuperação pontual do banco de dados.", "zh": "日志备份对于数据库的增量恢复（Point-in-time recovery）至关重要。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Log-Backup in der RDS-Backup-Richtlinie.", "en": "Enable log backup in the RDS backup policy.", "es": "Habilite backup de log en la política de backup RDS.", "fr": "Activez la sauvegarde de journal dans la politique de sauvegarde RDS.", "ja": "RDS バックアップポリシーでログバックアップを有効にします。", "pt": "Habilite backup de log na política de backup RDS.", "zh": "在 RDS 备份策略中开启日志备份。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instance-enabled-log-backup.rego", PackageName: "infraguard.rules.aliyun.rds_instance_enabled_log_backup", Content: "package infraguard.rules.aliyun.rds_instance_enabled_log_backup\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"rds-instance-enabled-log-backup\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Log Backup Enabled\",\n\t\t\"zh\": \"RDS 实例开启日志备份\",\n\t\t\"ja\": \"RDS インスタンスでログバックアップが有効\",\n\t\t\"de\": \"RDS-Instanz Log-Backup aktiviert\",\n\t\t\"es\": \"Backup de Log de Instancia RDS Habilitado\",\n\t\t\"fr\": \"Sauvegarde de Journal d'Instance RDS Activée\",\n\t\t\"pt\": \"Backup de Log de Instância RDS Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RDS instances have log backup enabled.\",\n\t\t\"zh\": \"确保 RDS 实例开启了日志备份。\",\n\t\t\"ja\": \"RDS インスタンスでログバックアップが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RDS-Instanzen Log-Backup aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias RDS tengan backup de log habilitado.\",\n\t\t\"fr\": \"Garantit que les instances RDS ont la sauvegarde de journal activée.\",\n\t\t\"pt\": \"Garante que as instâncias RDS tenham backup de log habilitado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Log backups are essential for point-in-time recovery of the database.\",\n\t\t\"zh\": \"日志备份对于数据库的增量恢复（Point-in-time recovery）至关重要。\",\n\t\t\"ja\": \"ログバックアップは、データベースのポイントインタイムリカバリに不可欠です。\",\n\t\t\"de\": \"Log-Backups sind für die Point-in-Time-Wiederherstellung der Datenbank unerlässlich.\",\n\t\t\"es\": \"Los backups de log son esenciales para la recuperación puntual de la base de datos.\",\n\t\t\"fr\": \"Les sauvegardes de journal sont essentielles pour la récupération ponctuelle de la base de données.\",\n\t\t\"pt\": \"Backups de log são essenciais para recuperação pontual do banco de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable log backup in the RDS backup policy.\",\n\t\t\"zh\": \"在 RDS 备份策略中开启日志备份。\",\n\t\t\"ja\": \"RDS バックアップポリシーでログバックアップを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Log-Backup in der RDS-Backup-Richtlinie.\",\n\t\t\"es\": \"Habilite backup de log en la política de backup RDS.\",\n\t\t\"fr\": \"Activez la sauvegarde de journal dans la politique de sauvegarde RDS.\",\n\t\t\"pt\": \"Habilite backup de log na política de backup RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"EnableBackupLog\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EnableBackupLog\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-enabled-ssl", Name: models.I18nString{"de": "RDS-Instanz SSL aktiviert", "en": "RDS Instance SSL Enabled", "es": "SSL de Instancia RDS Habilitado", "fr": "SSL d'Instance RDS Activé", "ja": "RDS インスタンスで SSL が有効", "pt": "SSL de Instância RDS Habilitado", "zh": "RDS 实例开启 SSL 加密"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass RDS-Instanzen SSL-Verschlüsselung aktiviert haben.", "en": "Ensures RDS instances have SSL encryption enabled.", "es": "Garantiza que las instancias RDS tengan cifrado SSL habilitado.", "fr": "Garantit que les instances RDS ont le chiffrement SSL activé.", "ja": "RDS インスタンスで SSL 暗号化が有効になっていることを確認します。", "pt": "Garante que as instâncias RDS tenham criptografia SSL habilitada.", "zh": "确保 RDS 实例开启了 SSL 加密。"}, Reason: models.I18nString{"de": "SSL-Verschlüsselung schützt Daten während der Übertragung vor Abhören und Manipulation.", "en": "SSL encryption protects data in transit from eavesdropping and tampering.", "es": "El cifrado SSL protege los datos en tránsito contra interceptación y manipulación.", "fr": "Le chiffrement SSL protège les données en transit contre l'écoute et la falsification.", "ja": "SSL 暗号化により、送信中のデータが盗聴や改ざんから保護されます。", "pt": "A criptografia SSL protege dados em trânsito contra interceptação e adulteração.", "zh": "SSL 加密可保护传输中的数据免受窃听和篡改。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie SSL für die RDS-Instanz.", "en": "Enable SSL for the RDS instance.", "es": "Habilite SSL para la instancia RDS.", "fr": "Activez SSL pour l'instance RDS.", "ja": "RDS インスタンスで SSL を有効にします。", "pt": "Habilite SSL para a instância RDS.", "zh": "为 RDS 实例开启 SSL 加密。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instance-enabled-ssl.rego", PackageName: "infraguard.rules.aliyun.rds_instance_enabled_ssl", Content: "package infraguard.rules.aliyun.rds_instance_enabled_ssl\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"rds-instance-enabled-ssl\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance SSL Enabled\",\n\t\t\"zh\": \"RDS 实例开启 SSL 加密\",\n\t\t\"ja\": \"RDS インスタンスで SSL が有効\",\n\t\t\"de\": \"RDS-Instanz SSL aktiviert\",\n\t\t\"es\": \"SSL de Instancia RDS Habilitado\",\n\t\t\"fr\": \"SSL d'Instance RDS Activé\",\n\t\t\"pt\": \"SSL de Instância RDS Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RDS instances have SSL encryption enabled.\",\n\t\t\"zh\": \"确保 RDS 实例开启了 SSL 加密。\",\n\t\t\"ja\": \"RDS インスタンスで SSL 暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RDS-Instanzen SSL-Verschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias RDS tengan cifrado SSL habilitado.\",\n\t\t\"fr\": \"Garantit que les instances RDS ont le chiffrement SSL activé.\",\n\t\t\"pt\": \"Garante que as instâncias RDS tenham criptografia SSL habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"SSL encryption protects data in transit from eavesdropping and tampering.\",\n\t\t\"zh\": \"SSL 加密可保护传输中的数据免受窃听和篡改。\",\n\t\t\"ja\": \"SSL 暗号化により、送信中のデータが盗聴や改ざんから保護されます。\",\n\t\t\"de\": \"SSL-Verschlüsselung schützt Daten während der Übertragung vor Abhören und Manipulation.\",\n\t\t\"es\": \"El cifrado SSL protege los datos en tránsito contra interceptación y manipulación.\",\n\t\t\"fr\": \"Le chiffrement SSL protège les données en transit contre l'écoute et la falsification.\",\n\t\t\"pt\": \"A criptografia SSL protege dados em trânsito contra interceptação e adulteração.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable SSL for the RDS instance.\",\n\t\t\"zh\": \"为 RDS 实例开启 SSL 加密。\",\n\t\t\"ja\": \"RDS インスタンスで SSL を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie SSL für die RDS-Instanz.\",\n\t\t\"es\": \"Habilite SSL para la instancia RDS.\",\n\t\t\"fr\": \"Activez SSL pour l'instance RDS.\",\n\t\t\"pt\": \"Habilite SSL para a instância RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\tssl := helpers.get_property(resource, \"SSLSetting\", \"Disabled\")\n\tssl != \"Disabled\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SSLSetting\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-enabled-tde-disk-encryption", Name: models.I18nString{"de": "RDS-Instanz TDE oder Festplattenverschlüsselung aktiviert", "en": "RDS Instance Enabled TDE or Disk Encryption", "es": "Instancia RDS TDE o Cifrado de Disco Habilitado", "fr": "Instance RDS TDE ou Chiffrement de Disque Activé", "ja": "RDS インスタンス TDE またはディスク暗号化が有効", "pt": "Instância RDS TDE ou Criptografia de Disco Habilitada", "zh": "RDS 实例开启 TDE 或者数据盘加密"}, Severity: "medium", Description: models.I18nString{"de": "RDS-Instanz sollte TDE (Transparent Data Encryption) oder Festplattenverschlüsselung aktiviert haben.", "en": "RDS instance should have TDE (Transparent Data Encryption) or disk encryption enabled.", "es": "La instancia RDS debe tener TDE (Cifrado Transparente de Datos) o cifrado de disco habilitado.", "fr": "L'instance RDS doit avoir TDE (Chiffrement Transparent des Données) ou le chiffrement de disque activé.", "ja": "RDS インスタンスで TDE（透過的データ暗号化）またはディスク暗号化を有効にする必要があります。", "pt": "A instância RDS deve ter TDE (Criptografia Transparente de Dados) ou criptografia de disco habilitada.", "zh": "RDS 实例开启 TDE 或者数据盘加密，视为合规。"}, Reason: models.I18nString{"de": "RDS-Instanz hat keine TDE oder Festplattenverschlüsselung aktiviert, was Daten Sicherheitsrisiken aussetzen kann.", "en": "RDS instance does not have TDE or disk encryption enabled, which may expose data to security risks.", "es": "La instancia RDS no tiene TDE o cifrado de disco habilitado, lo que puede exponer los datos a riesgos de seguridad.", "fr": "L'instance RDS n'a pas TDE ou le chiffrement de disque activé, ce qui peut exposer les données à des risques de sécurité.", "ja": "RDS インスタンスで TDE またはディスク暗号化が有効になっていないため、データがセキュリティリスクにさらされる可能性があります。", "pt": "A instância RDS não tem TDE ou criptografia de disco habilitada, o que pode expor os dados a riscos de segurança.", "zh": "RDS 实例未开启 TDE 或数据盘加密，可能导致数据面临安全风险。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie TDE, indem Sie EncryptionKey konfigurieren oder verwenden Sie verschlüsselte Speichertypen (cloud_essd, cloud_essd2, cloud_essd3) für die RDS-Instanz.", "en": "Enable TDE by configuring EncryptionKey or use encrypted storage types (cloud_essd, cloud_essd2, cloud_essd3) for the RDS instance.", "es": "Habilite TDE configurando EncryptionKey o use tipos de almacenamiento cifrados (cloud_essd, cloud_essd2, cloud_essd3) para la instancia RDS.", "fr": "Activez TDE en configurant EncryptionKey ou utilisez des types de stockage chiffrés (cloud_essd, cloud_essd2, cloud_essd3) pour l'instance RDS.", "ja": "EncryptionKey を設定して TDE を有効にするか、RDS インスタンスに暗号化ストレージタイプ（cloud_essd、cloud_essd2、cloud_essd3）を使用します。", "pt": "Habilite TDE configurando EncryptionKey ou use tipos de armazenamento criptografados (cloud_essd, cloud_essd2, cloud_essd3) para a instância RDS.", "zh": "通过配置 EncryptionKey 开启 TDE，或为 RDS 实例使用加密存储类型（cloud_essd、cloud_essd2、cloud_essd3）。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance", "ALIYUN::RDS::PrepayDBInstance"}, FilePath: "aliyun/rules/rds-instance-enabled-tde-disk-encryption.rego", PackageName: "infraguard.rules.aliyun.rds_instance_enabled_tde_disk_encryption", Content: "package infraguard.rules.aliyun.rds_instance_enabled_tde_disk_encryption\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"rds-instance-enabled-tde-disk-encryption\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Enabled TDE or Disk Encryption\",\n\t\t\"zh\": \"RDS 实例开启 TDE 或者数据盘加密\",\n\t\t\"ja\": \"RDS インスタンス TDE またはディスク暗号化が有効\",\n\t\t\"de\": \"RDS-Instanz TDE oder Festplattenverschlüsselung aktiviert\",\n\t\t\"es\": \"Instancia RDS TDE o Cifrado de Disco Habilitado\",\n\t\t\"fr\": \"Instance RDS TDE ou Chiffrement de Disque Activé\",\n\t\t\"pt\": \"Instância RDS TDE ou Criptografia de Disco Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"RDS instance should have TDE (Transparent Data Encryption) or disk encryption enabled.\",\n\t\t\"zh\": \"RDS 实例开启 TDE 或者数据盘加密，视为合规。\",\n\t\t\"ja\": \"RDS インスタンスで TDE（透過的データ暗号化）またはディスク暗号化を有効にする必要があります。\",\n\t\t\"de\": \"RDS-Instanz sollte TDE (Transparent Data Encryption) oder Festplattenverschlüsselung aktiviert haben.\",\n\t\t\"es\": \"La instancia RDS debe tener TDE (Cifrado Transparente de Datos) o cifrado de disco habilitado.\",\n\t\t\"fr\": \"L'instance RDS doit avoir TDE (Chiffrement Transparent des Données) ou le chiffrement de disque activé.\",\n\t\t\"pt\": \"A instância RDS deve ter TDE (Criptografia Transparente de Dados) ou criptografia de disco habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"RDS instance does not have TDE or disk encryption enabled, which may expose data to security risks.\",\n\t\t\"zh\": \"RDS 实例未开启 TDE 或数据盘加密，可能导致数据面临安全风险。\",\n\t\t\"ja\": \"RDS インスタンスで TDE またはディスク暗号化が有効になっていないため、データがセキュリティリスクにさらされる可能性があります。\",\n\t\t\"de\": \"RDS-Instanz hat keine TDE oder Festplattenverschlüsselung aktiviert, was Daten Sicherheitsrisiken aussetzen kann.\",\n\t\t\"es\": \"La instancia RDS no tiene TDE o cifrado de disco habilitado, lo que puede exponer los datos a riesgos de seguridad.\",\n\t\t\"fr\": \"L'instance RDS n'a pas TDE ou le chiffrement de disque activé, ce qui peut exposer les données à des risques de sécurité.\",\n\t\t\"pt\": \"A instância RDS não tem TDE ou criptografia de disco habilitada, o que pode expor os dados a riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable TDE by configuring EncryptionKey or use encrypted storage types (cloud_essd, cloud_essd2, cloud_essd3) for the RDS instance.\",\n\t\t\"zh\": \"通过配置 EncryptionKey 开启 TDE，或为 RDS 实例使用加密存储类型（cloud_essd、cloud_essd2、cloud_essd3）。\",\n\t\t\"ja\": \"EncryptionKey を設定して TDE を有効にするか、RDS インスタンスに暗号化ストレージタイプ（cloud_essd、cloud_essd2、cloud_essd3）を使用します。\",\n\t\t\"de\": \"Aktivieren Sie TDE, indem Sie EncryptionKey konfigurieren oder verwenden Sie verschlüsselte Speichertypen (cloud_essd, cloud_essd2, cloud_essd3) für die RDS-Instanz.\",\n\t\t\"es\": \"Habilite TDE configurando EncryptionKey o use tipos de almacenamiento cifrados (cloud_essd, cloud_essd2, cloud_essd3) para la instancia RDS.\",\n\t\t\"fr\": \"Activez TDE en configurant EncryptionKey ou utilisez des types de stockage chiffrés (cloud_essd, cloud_essd2, cloud_essd3) pour l'instance RDS.\",\n\t\t\"pt\": \"Habilite TDE configurando EncryptionKey ou use tipos de armazenamento criptografados (cloud_essd, cloud_essd2, cloud_essd3) para a instância RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\", \"ALIYUN::RDS::PrepayDBInstance\"]\n}\n\n# Encrypted storage types\nencrypted_storage_types := [\"cloud_essd\", \"cloud_essd2\", \"cloud_essd3\"]\n\n# Check if encryption is enabled (TDE via EncryptionKey or encrypted storage type)\nis_encryption_enabled(resource) if {\n\tresource.Properties.EncryptionKey != null\n}\n\nis_encryption_enabled(resource) if {\n\tresource.Properties.DBInstanceStorageType in encrypted_storage_types\n}\n\n# Generate deny for non-compliant RDS instance resources\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_encryption_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-expired-check", Name: models.I18nString{"de": "RDS Vorausbezahlte Instanz Ablaufprüfung", "en": "RDS Prepaid Instance Expiration Check", "es": "Verificación de Expiración de Instancia Prepaga RDS", "fr": "Vérification d'Expiration d'Instance Prépayée RDS", "ja": "RDS プリペイドインスタンスの有効期限チェック", "pt": "Verificação de Expiração de Instância Pré-paga RDS", "zh": "RDS 预付费实例到期检查"}, Severity: "high", Description: models.I18nString{"de": "Vorausbezahlte RDS-Instanzen sollten automatische Verlängerung aktiviert haben.", "en": "Prepaid RDS instances should have auto-renewal enabled.", "es": "Las instancias RDS prepagas deben tener renovación automática habilitada.", "fr": "Les instances RDS prépayées doivent avoir le renouvellement automatique activé.", "ja": "プリペイド RDS インスタンスは自動更新を有効にする必要があります。", "pt": "Instâncias RDS pré-pagas devem ter renovação automática habilitada.", "zh": "预付费 RDS 实例应开启自动续费，避免业务中断。"}, Reason: models.I18nString{"de": "Die vorausbezahlte RDS-Instanz hat keine automatische Verlängerung aktiviert.", "en": "The prepaid RDS instance does not have auto-renewal enabled.", "es": "La instancia RDS prepaga no tiene renovación automática habilitada.", "fr": "L'instance RDS prépayée n'a pas le renouvellement automatique activé.", "ja": "プリペイド RDS インスタンスで自動更新が有効になっていません。", "pt": "A instância RDS pré-paga não tem renovação automática habilitada.", "zh": "预付费 RDS 实例未开启自动续费。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Verlängerung für die vorausbezahlte RDS-Instanz, indem Sie AutoRenew auf true setzen.", "en": "Enable auto-renewal for the prepaid RDS instance by setting AutoRenew to true.", "es": "Habilite la renovación automática para la instancia RDS prepaga estableciendo AutoRenew en true.", "fr": "Activez le renouvellement automatique pour l'instance RDS prépayée en définissant AutoRenew sur true.", "ja": "AutoRenew を true に設定して、プリペイド RDS インスタンスで自動更新を有効にします。", "pt": "Habilite renovação automática para a instância RDS pré-paga definindo AutoRenew como true.", "zh": "通过将 AutoRenew 设置为 true 为预付费 RDS 实例开启自动续费。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instance-expired-check.rego", PackageName: "infraguard.rules.aliyun.rds_instance_expired_check", Content: "package infraguard.rules.aliyun.rds_instance_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"rds-instance-expired-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"RDS Prepaid Instance Expiration Check\",\n\t\t\"zh\": \"RDS 预付费实例到期检查\",\n\t\t\"ja\": \"RDS プリペイドインスタンスの有効期限チェック\",\n\t\t\"de\": \"RDS Vorausbezahlte Instanz Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Instancia Prepaga RDS\",\n\t\t\"fr\": \"Vérification d'Expiration d'Instance Prépayée RDS\",\n\t\t\"pt\": \"Verificação de Expiração de Instância Pré-paga RDS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Prepaid RDS instances should have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 RDS 实例应开启自动续费，避免业务中断。\",\n\t\t\"ja\": \"プリペイド RDS インスタンスは自動更新を有効にする必要があります。\",\n\t\t\"de\": \"Vorausbezahlte RDS-Instanzen sollten automatische Verlängerung aktiviert haben.\",\n\t\t\"es\": \"Las instancias RDS prepagas deben tener renovación automática habilitada.\",\n\t\t\"fr\": \"Les instances RDS prépayées doivent avoir le renouvellement automatique activé.\",\n\t\t\"pt\": \"Instâncias RDS pré-pagas devem ter renovação automática habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The prepaid RDS instance does not have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 RDS 实例未开启自动续费。\",\n\t\t\"ja\": \"プリペイド RDS インスタンスで自動更新が有効になっていません。\",\n\t\t\"de\": \"Die vorausbezahlte RDS-Instanz hat keine automatische Verlängerung aktiviert.\",\n\t\t\"es\": \"La instancia RDS prepaga no tiene renovación automática habilitada.\",\n\t\t\"fr\": \"L'instance RDS prépayée n'a pas le renouvellement automatique activé.\",\n\t\t\"pt\": \"A instância RDS pré-paga não tem renovação automática habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for the prepaid RDS instance by setting AutoRenew to true.\",\n\t\t\"zh\": \"通过将 AutoRenew 设置为 true 为预付费 RDS 实例开启自动续费。\",\n\t\t\"ja\": \"AutoRenew を true に設定して、プリペイド RDS インスタンスで自動更新を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die automatische Verlängerung für die vorausbezahlte RDS-Instanz, indem Sie AutoRenew auf true setzen.\",\n\t\t\"es\": \"Habilite la renovación automática para la instancia RDS prepaga estableciendo AutoRenew en true.\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour l'instance RDS prépayée en définissant AutoRenew sur true.\",\n\t\t\"pt\": \"Habilite renovação automática para a instância RDS pré-paga definindo AutoRenew como true.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_prepaid(resource) if {\n\thelpers.get_property(resource, \"PayType\", \"Postpaid\") == \"Prepaid\"\n}\n\n# RDS AutoRenew property name is AutoRenew\nis_auto_renew_enabled(resource) if {\n\tauto_renew := helpers.get_property(resource, \"AutoRenew\", false)\n\thelpers.is_true(auto_renew)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tis_prepaid(resource)\n\tnot is_auto_renew_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AutoRenew\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-has-guard-instance", Name: models.I18nString{"de": "RDS-Instanz hat Guard-Instanz", "en": "RDS Instance Has Guard Instance", "es": "La Instancia RDS Tiene Instancia de Guardia", "fr": "L'Instance RDS a une Instance de Garde", "ja": "RDS インスタンスにガードインスタンスがある", "pt": "A Instância RDS Tem Instância de Guarda", "zh": "RDS 关键实例配置灾备实例"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Produktions-RDS-Instanzen eine entsprechende Guard-Instanz (Notfallwiederherstellung) haben.", "en": "Ensures production RDS instances have a corresponding guard (disaster recovery) instance.", "es": "Garantiza que las instancias RDS de producción tengan una instancia de guardia (recuperación ante desastres) correspondiente.", "fr": "Garantit que les instances RDS de production ont une instance de garde (récupération après sinistre) correspondante.", "ja": "本番環境の RDS インスタンスに対応するガード（災害復旧）インスタンスがあることを確認します。", "pt": "Garante que as instâncias RDS de produção tenham uma instância de guarda (recuperação de desastres) correspondente.", "zh": "确保生产环境 RDS 实例配置了相应的灾备实例。"}, Reason: models.I18nString{"de": "Guard-Instanzen bieten Hochverfügbarkeit und Datenredundanz über Regionen hinweg.", "en": "Guard instances provide high availability and data redundancy across regions.", "es": "Las instancias de guardia proporcionan alta disponibilidad y redundancia de datos entre regiones.", "fr": "Les instances de garde offrent une haute disponibilité et une redondance des données entre les régions.", "ja": "ガードインスタンスは、リージョン全体で高可用性とデータ冗長性を提供します。", "pt": "As instâncias de guarda fornecem alta disponibilidade e redundância de dados entre regiões.", "zh": "灾备实例提供跨地域的高可用性和数据冗余。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie eine Guard-Instanz für die primäre RDS-Instanz.", "en": "Configure a guard instance for the primary RDS instance.", "es": "Configure una instancia de guardia para la instancia RDS principal.", "fr": "Configurez une instance de garde pour l'instance RDS principale.", "ja": "プライマリ RDS インスタンスのガードインスタンスを設定します。", "pt": "Configure uma instância de guarda para a instância RDS principal.", "zh": "为主要 RDS 实例配置灾备实例。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instance-has-guard-instance.rego", PackageName: "infraguard.rules.aliyun.rds_instance_has_guard_instance", Content: "package infraguard.rules.aliyun.rds_instance_has_guard_instance\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"rds-instance-has-guard-instance\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Has Guard Instance\",\n\t\t\"zh\": \"RDS 关键实例配置灾备实例\",\n\t\t\"ja\": \"RDS インスタンスにガードインスタンスがある\",\n\t\t\"de\": \"RDS-Instanz hat Guard-Instanz\",\n\t\t\"es\": \"La Instancia RDS Tiene Instancia de Guardia\",\n\t\t\"fr\": \"L'Instance RDS a une Instance de Garde\",\n\t\t\"pt\": \"A Instância RDS Tem Instância de Guarda\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures production RDS instances have a corresponding guard (disaster recovery) instance.\",\n\t\t\"zh\": \"确保生产环境 RDS 实例配置了相应的灾备实例。\",\n\t\t\"ja\": \"本番環境の RDS インスタンスに対応するガード（災害復旧）インスタンスがあることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Produktions-RDS-Instanzen eine entsprechende Guard-Instanz (Notfallwiederherstellung) haben.\",\n\t\t\"es\": \"Garantiza que las instancias RDS de producción tengan una instancia de guardia (recuperación ante desastres) correspondiente.\",\n\t\t\"fr\": \"Garantit que les instances RDS de production ont une instance de garde (récupération après sinistre) correspondante.\",\n\t\t\"pt\": \"Garante que as instâncias RDS de produção tenham uma instância de guarda (recuperação de desastres) correspondente.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Guard instances provide high availability and data redundancy across regions.\",\n\t\t\"zh\": \"灾备实例提供跨地域的高可用性和数据冗余。\",\n\t\t\"ja\": \"ガードインスタンスは、リージョン全体で高可用性とデータ冗長性を提供します。\",\n\t\t\"de\": \"Guard-Instanzen bieten Hochverfügbarkeit und Datenredundanz über Regionen hinweg.\",\n\t\t\"es\": \"Las instancias de guardia proporcionan alta disponibilidad y redundancia de datos entre regiones.\",\n\t\t\"fr\": \"Les instances de garde offrent une haute disponibilité et une redondance des données entre les régions.\",\n\t\t\"pt\": \"As instâncias de guarda fornecem alta disponibilidade e redundância de dados entre regiões.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a guard instance for the primary RDS instance.\",\n\t\t\"zh\": \"为主要 RDS 实例配置灾备实例。\",\n\t\t\"ja\": \"プライマリ RDS インスタンスのガードインスタンスを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie eine Guard-Instanz für die primäre RDS-Instanz.\",\n\t\t\"es\": \"Configure una instancia de guardia para la instancia RDS principal.\",\n\t\t\"fr\": \"Configurez une instance de garde pour l'instance RDS principale.\",\n\t\t\"pt\": \"Configure uma instância de guarda para a instância RDS principal.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\n# Cross-resource check: is there another RDS instance or DR resource linked?\n# Simplified for static check: check if it's a high availability category\nis_compliant(resource) if {\n\tcat := helpers.get_property(resource, \"Category\", \"\")\n\thelpers.includes([\"HighAvailability\", \"cluster\", \"AlwaysOn\", \"Finance\"], cat)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Category\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-maintain-time-check", Name: models.I18nString{"de": "RDS-Instanz Wartungsfenster-Prüfung", "en": "RDS Instance Maintenance Window Check", "es": "Verificación de Ventana de Mantenimiento de Instancia RDS", "fr": "Vérification de la Fenêtre de Maintenance de l'Instance RDS", "ja": "RDS インスタンスのメンテナンスウィンドウチェック", "pt": "Verificação de Janela de Manutenção de Instância RDS", "zh": "RDS 实例维护时间检测"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass die RDS-Instanz ein Wartungsfenster konfiguriert hat.", "en": "Ensures that the RDS instance has a maintenance window configured.", "es": "Garantiza que la instancia RDS tenga configurada una ventana de mantenimiento.", "fr": "Garantit que l'instance RDS a une fenêtre de maintenance configurée.", "ja": "RDS インスタンスにメンテナンスウィンドウが設定されていることを確認します。", "pt": "Garante que a instância RDS tenha uma janela de manutenção configurada.", "zh": "确保 RDS 实例配置了维护时间段。"}, Reason: models.I18nString{"de": "Die Konfiguration eines Wartungsfensters ermöglicht geplante Wartungen während der Nebenzeiten.", "en": "Configuring a maintenance window allows for planned maintenance during off-peak hours.", "es": "Configurar una ventana de mantenimiento permite realizar mantenimiento planificado durante las horas de menor actividad.", "fr": "La configuration d'une fenêtre de maintenance permet d'effectuer une maintenance planifiée pendant les heures creuses.", "ja": "メンテナンスウィンドウを設定することで、オフピーク時間帯に計画的なメンテナンスを行うことができます。", "pt": "Configurar uma janela de manutenção permite realizar manutenção planejada durante as horas de menor movimento.", "zh": "配置维护时间段允许在非高峰时段进行计划内维护。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie ein Wartungsfenster für die RDS-Instanz.", "en": "Configure a maintenance window for the RDS instance.", "es": "Configure una ventana de mantenimiento para la instancia RDS.", "fr": "Configurez une fenêtre de maintenance pour l'instance RDS.", "ja": "RDS インスタンスにメンテナンスウィンドウを設定します。", "pt": "Configure uma janela de manutenção para a instância RDS.", "zh": "为 RDS 实例配置维护时间段。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instance-maintain-time-check.rego", PackageName: "infraguard.rules.aliyun.rds_instance_maintain_time_check", Content: "package infraguard.rules.aliyun.rds_instance_maintain_time_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"rds-instance-maintain-time-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Maintenance Window Check\",\n\t\t\"zh\": \"RDS 实例维护时间检测\",\n\t\t\"ja\": \"RDS インスタンスのメンテナンスウィンドウチェック\",\n\t\t\"de\": \"RDS-Instanz Wartungsfenster-Prüfung\",\n\t\t\"es\": \"Verificación de Ventana de Mantenimiento de Instancia RDS\",\n\t\t\"fr\": \"Vérification de la Fenêtre de Maintenance de l'Instance RDS\",\n\t\t\"pt\": \"Verificação de Janela de Manutenção de Instância RDS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the RDS instance has a maintenance window configured.\",\n\t\t\"zh\": \"确保 RDS 实例配置了维护时间段。\",\n\t\t\"ja\": \"RDS インスタンスにメンテナンスウィンドウが設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die RDS-Instanz ein Wartungsfenster konfiguriert hat.\",\n\t\t\"es\": \"Garantiza que la instancia RDS tenga configurada una ventana de mantenimiento.\",\n\t\t\"fr\": \"Garantit que l'instance RDS a une fenêtre de maintenance configurée.\",\n\t\t\"pt\": \"Garante que a instância RDS tenha uma janela de manutenção configurada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Configuring a maintenance window allows for planned maintenance during off-peak hours.\",\n\t\t\"zh\": \"配置维护时间段允许在非高峰时段进行计划内维护。\",\n\t\t\"ja\": \"メンテナンスウィンドウを設定することで、オフピーク時間帯に計画的なメンテナンスを行うことができます。\",\n\t\t\"de\": \"Die Konfiguration eines Wartungsfensters ermöglicht geplante Wartungen während der Nebenzeiten.\",\n\t\t\"es\": \"Configurar una ventana de mantenimiento permite realizar mantenimiento planificado durante las horas de menor actividad.\",\n\t\t\"fr\": \"La configuration d'une fenêtre de maintenance permet d'effectuer une maintenance planifiée pendant les heures creuses.\",\n\t\t\"pt\": \"Configurar uma janela de manutenção permite realizar manutenção planejada durante as horas de menor movimento.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a maintenance window for the RDS instance.\",\n\t\t\"zh\": \"为 RDS 实例配置维护时间段。\",\n\t\t\"ja\": \"RDS インスタンスにメンテナンスウィンドウを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie ein Wartungsfenster für die RDS-Instanz.\",\n\t\t\"es\": \"Configure una ventana de mantenimiento para la instancia RDS.\",\n\t\t\"fr\": \"Configurez une fenêtre de maintenance pour l'instance RDS.\",\n\t\t\"pt\": \"Configure uma janela de manutenção para a instância RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot helpers.has_property(resource, \"MaintainTime\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"MaintainTime\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instance-storage-autoscale-enable", Name: models.I18nString{"de": "RDS-Speicher-Autoscale aktiviert", "en": "RDS Storage Autoscale Enabled", "es": "Autoescalado de Almacenamiento RDS Habilitado", "fr": "Mise à l'Échelle Automatique du Stockage RDS Activée", "ja": "RDS ストレージ自動スケールが有効", "pt": "Autoescala de Armazenamento RDS Habilitada", "zh": "RDS 开启存储自动扩容"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass RDS-Instanzen Speicher-Autoscale aktiviert haben, um Ausfallzeiten aufgrund voller Festplatten zu verhindern.", "en": "Ensures RDS instances have storage autoscale enabled to prevent downtime due to full disks.", "es": "Garantiza que las instancias RDS tengan autoescalado de almacenamiento habilitado para prevenir tiempo de inactividad debido a discos llenos.", "fr": "Garantit que les instances RDS ont la mise à l'échelle automatique du stockage activée pour éviter les temps d'arrêt dus aux disques pleins.", "ja": "RDS インスタンスでストレージ自動スケールが有効になっていることを確認し、ディスク満杯によるダウンタイムを防ぎます。", "pt": "Garante que as instâncias RDS tenham autoescala de armazenamento habilitada para prevenir tempo de inatividade devido a discos cheios.", "zh": "确保 RDS 实例开启了存储自动扩容，以防止因磁盘满载导致的服务中断。"}, Reason: models.I18nString{"de": "Automatische Skalierung stellt sicher, dass der Datenbank der Speicherplatz nicht ausgeht.", "en": "Automatic scaling ensures that the database doesn't run out of storage space.", "es": "El escalado automático garantiza que la base de datos no se quede sin espacio de almacenamiento.", "fr": "La mise à l'échelle automatique garantit que la base de données ne manque pas d'espace de stockage.", "ja": "自動スケーリングにより、データベースがストレージスペースを使い果たすことがなくなります。", "pt": "O escalonamento automático garante que o banco de dados não fique sem espaço de armazenamento.", "zh": "自动扩容确保数据库不会因存储空间耗尽而受限。"}, Recommendation: models.I18nString{"de": "Setzen Sie StorageAutoScale für die RDS-Instanz auf 'Enable'.", "en": "Set StorageAutoScale to 'Enable' for the RDS instance.", "es": "Establezca StorageAutoScale en 'Enable' para la instancia RDS.", "fr": "Définissez StorageAutoScale sur 'Enable' pour l'instance RDS.", "ja": "RDS インスタンスの StorageAutoScale を 'Enable' に設定します。", "pt": "Defina StorageAutoScale como 'Enable' para a instância RDS.", "zh": "为 RDS 实例将 StorageAutoScale 设置为 'Enable'。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instance-storage-autoscale-enable.rego", PackageName: "infraguard.rules.aliyun.rds_instance_storage_autoscale_enable", Content: "package infraguard.rules.aliyun.rds_instance_storage_autoscale_enable\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"rds-instance-storage-autoscale-enable\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"RDS Storage Autoscale Enabled\",\n\t\t\"zh\": \"RDS 开启存储自动扩容\",\n\t\t\"ja\": \"RDS ストレージ自動スケールが有効\",\n\t\t\"de\": \"RDS-Speicher-Autoscale aktiviert\",\n\t\t\"es\": \"Autoescalado de Almacenamiento RDS Habilitado\",\n\t\t\"fr\": \"Mise à l'Échelle Automatique du Stockage RDS Activée\",\n\t\t\"pt\": \"Autoescala de Armazenamento RDS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RDS instances have storage autoscale enabled to prevent downtime due to full disks.\",\n\t\t\"zh\": \"确保 RDS 实例开启了存储自动扩容，以防止因磁盘满载导致的服务中断。\",\n\t\t\"ja\": \"RDS インスタンスでストレージ自動スケールが有効になっていることを確認し、ディスク満杯によるダウンタイムを防ぎます。\",\n\t\t\"de\": \"Stellt sicher, dass RDS-Instanzen Speicher-Autoscale aktiviert haben, um Ausfallzeiten aufgrund voller Festplatten zu verhindern.\",\n\t\t\"es\": \"Garantiza que las instancias RDS tengan autoescalado de almacenamiento habilitado para prevenir tiempo de inactividad debido a discos llenos.\",\n\t\t\"fr\": \"Garantit que les instances RDS ont la mise à l'échelle automatique du stockage activée pour éviter les temps d'arrêt dus aux disques pleins.\",\n\t\t\"pt\": \"Garante que as instâncias RDS tenham autoescala de armazenamento habilitada para prevenir tempo de inatividade devido a discos cheios.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Automatic scaling ensures that the database doesn't run out of storage space.\",\n\t\t\"zh\": \"自动扩容确保数据库不会因存储空间耗尽而受限。\",\n\t\t\"ja\": \"自動スケーリングにより、データベースがストレージスペースを使い果たすことがなくなります。\",\n\t\t\"de\": \"Automatische Skalierung stellt sicher, dass der Datenbank der Speicherplatz nicht ausgeht.\",\n\t\t\"es\": \"El escalado automático garantiza que la base de datos no se quede sin espacio de almacenamiento.\",\n\t\t\"fr\": \"La mise à l'échelle automatique garantit que la base de données ne manque pas d'espace de stockage.\",\n\t\t\"pt\": \"O escalonamento automático garante que o banco de dados não fique sem espaço de armazenamento.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set StorageAutoScale to 'Enable' for the RDS instance.\",\n\t\t\"zh\": \"为 RDS 实例将 StorageAutoScale 设置为 'Enable'。\",\n\t\t\"ja\": \"RDS インスタンスの StorageAutoScale を 'Enable' に設定します。\",\n\t\t\"de\": \"Setzen Sie StorageAutoScale für die RDS-Instanz auf 'Enable'.\",\n\t\t\"es\": \"Establezca StorageAutoScale en 'Enable' para la instancia RDS.\",\n\t\t\"fr\": \"Définissez StorageAutoScale sur 'Enable' pour l'instance RDS.\",\n\t\t\"pt\": \"Defina StorageAutoScale como 'Enable' para a instância RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\thelpers.get_property(resource, \"StorageAutoScale\", \"Disable\") == \"Enable\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"StorageAutoScale\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-instances-in-vpc", Name: models.I18nString{"de": "RDS-Instanz in VPC", "en": "RDS Instance in VPC", "es": "Instancia RDS en VPC", "fr": "Instance RDS dans VPC", "ja": "VPC 内の RDS インスタンス", "pt": "Instância RDS em VPC", "zh": "RDS 实例在 VPC 内"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die RDS-Instanz innerhalb eines VPC bereitgestellt wird.", "en": "Ensures that the RDS instance is deployed within a VPC.", "es": "Garantiza que la instancia RDS se implemente dentro de un VPC.", "fr": "Garantit que l'instance RDS est déployée dans un VPC.", "ja": "RDS インスタンスが VPC 内に展開されていることを確認します。", "pt": "Garante que a instância RDS seja implantada dentro de um VPC.", "zh": "确保 RDS 实例部署在 VPC 内。"}, Reason: models.I18nString{"de": "Die Bereitstellung von RDS in einem VPC bietet bessere Netzwerkisolation und Sicherheit.", "en": "Deploying RDS in a VPC provides better network isolation and security.", "es": "Implementar RDS en un VPC proporciona mejor aislamiento de red y seguridad.", "fr": "Déployer RDS dans un VPC offre un meilleur isolement réseau et une meilleure sécurité.", "ja": "RDS を VPC に展開することで、より優れたネットワーク分離とセキュリティが提供されます。", "pt": "Implantar RDS em um VPC fornece melhor isolamento de rede e segurança.", "zh": "在 VPC 中部署 RDS 可提供更好的网络隔离和安全性。"}, Recommendation: models.I18nString{"de": "Stellen Sie die RDS-Instanz innerhalb eines VPC bereit.", "en": "Deploy the RDS instance within a VPC.", "es": "Implemente la instancia RDS dentro de un VPC.", "fr": "Déployez l'instance RDS dans un VPC.", "ja": "RDS インスタンスを VPC 内に展開します。", "pt": "Implante a instância RDS dentro de um VPC.", "zh": "将 RDS 实例部署在 VPC 内。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-instances-in-vpc.rego", PackageName: "infraguard.rules.aliyun.rds_instances_in_vpc", Content: "package infraguard.rules.aliyun.rds_instances_in_vpc\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"rds-instances-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance in VPC\",\n\t\t\"zh\": \"RDS 实例在 VPC 内\",\n\t\t\"ja\": \"VPC 内の RDS インスタンス\",\n\t\t\"de\": \"RDS-Instanz in VPC\",\n\t\t\"es\": \"Instancia RDS en VPC\",\n\t\t\"fr\": \"Instance RDS dans VPC\",\n\t\t\"pt\": \"Instância RDS em VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the RDS instance is deployed within a VPC.\",\n\t\t\"zh\": \"确保 RDS 实例部署在 VPC 内。\",\n\t\t\"ja\": \"RDS インスタンスが VPC 内に展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die RDS-Instanz innerhalb eines VPC bereitgestellt wird.\",\n\t\t\"es\": \"Garantiza que la instancia RDS se implemente dentro de un VPC.\",\n\t\t\"fr\": \"Garantit que l'instance RDS est déployée dans un VPC.\",\n\t\t\"pt\": \"Garante que a instância RDS seja implantada dentro de um VPC.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Deploying RDS in a VPC provides better network isolation and security.\",\n\t\t\"zh\": \"在 VPC 中部署 RDS 可提供更好的网络隔离和安全性。\",\n\t\t\"ja\": \"RDS を VPC に展開することで、より優れたネットワーク分離とセキュリティが提供されます。\",\n\t\t\"de\": \"Die Bereitstellung von RDS in einem VPC bietet bessere Netzwerkisolation und Sicherheit.\",\n\t\t\"es\": \"Implementar RDS en un VPC proporciona mejor aislamiento de red y seguridad.\",\n\t\t\"fr\": \"Déployer RDS dans un VPC offre un meilleur isolement réseau et une meilleure sécurité.\",\n\t\t\"pt\": \"Implantar RDS em um VPC fornece melhor isolamento de rede e segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy the RDS instance within a VPC.\",\n\t\t\"zh\": \"将 RDS 实例部署在 VPC 内。\",\n\t\t\"ja\": \"RDS インスタンスを VPC 内に展開します。\",\n\t\t\"de\": \"Stellen Sie die RDS-Instanz innerhalb eines VPC bereit.\",\n\t\t\"es\": \"Implemente la instancia RDS dentro de un VPC.\",\n\t\t\"fr\": \"Déployez l'instance RDS dans un VPC.\",\n\t\t\"pt\": \"Implante a instância RDS dentro de um VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot helpers.has_property(resource, \"VPCId\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VPCId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-multi-az-support", Name: models.I18nString{"de": "RDS-Instanz Multi-AZ-Bereitstellung", "en": "RDS Instance Multi-AZ Deployment", "es": "Despliegue Multi-AZ de Instancia RDS", "fr": "Déploiement Multi-AZ d'Instance RDS", "ja": "RDS インスタンスのマルチ AZ 展開", "pt": "Implantação Multi-AZ de Instância RDS", "zh": "RDS 实例多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "RDS-Instanzen sollten für hohe Verfügbarkeit und automatisches Failover in Multi-AZ-Konfiguration bereitgestellt werden.", "en": "RDS instances should be deployed in multi-AZ configuration for high availability and automatic failover.", "es": "Las instancias RDS deben implementarse en configuración multi-AZ para alta disponibilidad y conmutación por error automática.", "fr": "Les instances RDS doivent être déployées en configuration multi-AZ pour une haute disponibilité et un basculement automatique.", "ja": "RDS インスタンスは、高可用性と自動フェイルオーバーのためにマルチ AZ 構成で展開する必要があります。", "pt": "Instâncias RDS devem ser implantadas em configuração multi-AZ para alta disponibilidade e failover automático.", "zh": "RDS 实例应部署在多可用区配置中，以实现高可用性和自动故障转移。"}, Reason: models.I18nString{"de": "Die RDS-Instanz ist nicht in Multi-AZ-Konfiguration bereitgestellt, was die Verfügbarkeit bei Zonenausfällen beeinträchtigen kann.", "en": "The RDS instance is not deployed in multi-AZ configuration, which may affect availability during zone failures.", "es": "La instancia RDS no está implementada en configuración multi-AZ, lo que puede afectar la disponibilidad durante fallas de zona.", "fr": "L'instance RDS n'est pas déployée en configuration multi-AZ, ce qui peut affecter la disponibilité lors de pannes de zone.", "ja": "RDS インスタンスがマルチ AZ 構成で展開されていないため、ゾーン障害時に可用性に影響を与える可能性があります。", "pt": "A instância RDS não está implantada em configuração multi-AZ, o que pode afetar a disponibilidade durante falhas de zona.", "zh": "RDS 实例未部署在多可用区配置中，在可用区故障时可能影响可用性。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Multi-AZ-Bereitstellung, indem Sie MultiAZ beim Erstellen der Instanz auf true setzen.", "en": "Enable multi-AZ deployment by setting MultiAZ to true when creating the instance.", "es": "Habilite la implementación multi-AZ estableciendo MultiAZ en true al crear la instancia.", "fr": "Activez le déploiement multi-AZ en définissant MultiAZ sur true lors de la création de l'instance.", "ja": "インスタンス作成時に MultiAZ を true に設定して、マルチ AZ 展開を有効にします。", "pt": "Habilite implantação multi-AZ definindo MultiAZ como true ao criar a instância.", "zh": "在创建实例时通过将 MultiAZ 设置为 true 来启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-multi-az-support.rego", PackageName: "infraguard.rules.aliyun.rds_multi_az_support", Content: "package infraguard.rules.aliyun.rds_multi_az_support\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"rds-multi-az-support\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Multi-AZ Deployment\",\n\t\t\"zh\": \"RDS 实例多可用区部署\",\n\t\t\"ja\": \"RDS インスタンスのマルチ AZ 展開\",\n\t\t\"de\": \"RDS-Instanz Multi-AZ-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-AZ de Instancia RDS\",\n\t\t\"fr\": \"Déploiement Multi-AZ d'Instance RDS\",\n\t\t\"pt\": \"Implantação Multi-AZ de Instância RDS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"RDS instances should be deployed in multi-AZ configuration for high availability and automatic failover.\",\n\t\t\"zh\": \"RDS 实例应部署在多可用区配置中，以实现高可用性和自动故障转移。\",\n\t\t\"ja\": \"RDS インスタンスは、高可用性と自動フェイルオーバーのためにマルチ AZ 構成で展開する必要があります。\",\n\t\t\"de\": \"RDS-Instanzen sollten für hohe Verfügbarkeit und automatisches Failover in Multi-AZ-Konfiguration bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias RDS deben implementarse en configuración multi-AZ para alta disponibilidad y conmutación por error automática.\",\n\t\t\"fr\": \"Les instances RDS doivent être déployées en configuration multi-AZ pour une haute disponibilité et un basculement automatique.\",\n\t\t\"pt\": \"Instâncias RDS devem ser implantadas em configuração multi-AZ para alta disponibilidade e failover automático.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The RDS instance is not deployed in multi-AZ configuration, which may affect availability during zone failures.\",\n\t\t\"zh\": \"RDS 实例未部署在多可用区配置中，在可用区故障时可能影响可用性。\",\n\t\t\"ja\": \"RDS インスタンスがマルチ AZ 構成で展開されていないため、ゾーン障害時に可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Die RDS-Instanz ist nicht in Multi-AZ-Konfiguration bereitgestellt, was die Verfügbarkeit bei Zonenausfällen beeinträchtigen kann.\",\n\t\t\"es\": \"La instancia RDS no está implementada en configuración multi-AZ, lo que puede afectar la disponibilidad durante fallas de zona.\",\n\t\t\"fr\": \"L'instance RDS n'est pas déployée en configuration multi-AZ, ce qui peut affecter la disponibilité lors de pannes de zone.\",\n\t\t\"pt\": \"A instância RDS não está implantada em configuração multi-AZ, o que pode afetar a disponibilidade durante falhas de zona.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable multi-AZ deployment by setting MultiAZ to true when creating the instance.\",\n\t\t\"zh\": \"在创建实例时通过将 MultiAZ 设置为 true 来启用多可用区部署。\",\n\t\t\"ja\": \"インスタンス作成時に MultiAZ を true に設定して、マルチ AZ 展開を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Multi-AZ-Bereitstellung, indem Sie MultiAZ beim Erstellen der Instanz auf true setzen.\",\n\t\t\"es\": \"Habilite la implementación multi-AZ estableciendo MultiAZ en true al crear la instancia.\",\n\t\t\"fr\": \"Activez le déploiement multi-AZ en définissant MultiAZ sur true lors de la création de l'instance.\",\n\t\t\"pt\": \"Habilite implantação multi-AZ definindo MultiAZ como true ao criar a instância.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\n# Check if instance has multi-AZ enabled\nhas_multi_az_enabled(resource) if {\n\tmulti_az := helpers.get_property(resource, \"MultiAZ\", false)\n\tmulti_az == true\n}\n\n# Deny rule: RDS instances should have multi-AZ enabled\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot has_multi_az_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"MultiAZ\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-public-access-check", Name: models.I18nString{"de": "RDS-Instanz öffentlicher Zugriff Prüfung", "en": "RDS Instance Public Access Check", "es": "Verificación de Acceso Público de Instancia RDS", "fr": "Vérification d'Accès Public d'Instance RDS", "ja": "RDS インスタンスのパブリックアクセスチェック", "pt": "Verificação de Acesso Público de Instância RDS", "zh": "RDS 实例不配置公网地址"}, Severity: "high", Description: models.I18nString{"de": "RDS-Instanzen sollten nicht mit öffentlichen Netzwerkadressen konfiguriert werden. Öffentlicher Zugriff setzt Datenbanken potenziellen Sicherheitsbedrohungen aus dem Internet aus.", "en": "RDS instances should not be configured with public network addresses. Public access exposes databases to potential security threats from the internet.", "es": "Las instancias RDS no deben configurarse con direcciones de red públicas. El acceso público expone las bases de datos a posibles amenazas de seguridad de internet.", "fr": "Les instances RDS ne doivent pas être configurées avec des adresses réseau publiques. L'accès public expose les bases de données à des menaces de sécurité potentielles d'Internet.", "ja": "RDS インスタンスはパブリックネットワークアドレスで設定すべきではありません。パブリックアクセスにより、データベースがインターネットからの潜在的なセキュリティ脅威にさらされます。", "pt": "Instâncias RDS não devem ser configuradas com endereços de rede pública. O acesso público expõe bancos de dados a ameaças potenciais de segurança da internet.", "zh": "RDS 实例不应配置公网地址。公网访问会使数据库暴露于来自互联网的潜在安全威胁。"}, Reason: models.I18nString{"de": "Die RDS-Instanz ist mit öffentlichem Netzwerkzugriff konfiguriert, was die Datenbank Sicherheitsrisiken aus dem Internet aussetzt.", "en": "The RDS instance is configured with public network access, which exposes the database to security risks from the internet.", "es": "La instancia RDS está configurada con acceso a red pública, lo que expone la base de datos a riesgos de seguridad de internet.", "fr": "L'instance RDS est configurée avec un accès réseau public, ce qui expose la base de données aux risques de sécurité d'Internet.", "ja": "RDS インスタンスがパブリックネットワークアクセスで設定されているため、データベースがインターネットからのセキュリティリスクにさらされます。", "pt": "A instância RDS está configurada com acesso à rede pública, o que expõe o banco de dados a riscos de segurança da internet.", "zh": "RDS 实例配置了公网访问，使数据库暴露于来自互联网的安全风险。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie den öffentlichen Netzwerkzugriff für die RDS-Instanz, indem Sie AllocatePublicConnection auf false setzen oder es nicht konfigurieren.", "en": "Disable public network access for the RDS instance by setting AllocatePublicConnection to false or not configuring it.", "es": "Deshabilite el acceso a la red pública para la instancia RDS estableciendo AllocatePublicConnection en false o no configurándolo.", "fr": "Désactivez l'accès réseau public pour l'instance RDS en définissant AllocatePublicConnection sur false ou en ne le configurant pas.", "ja": "AllocatePublicConnection を false に設定するか、設定しないことで、RDS インスタンスのパブリックネットワークアクセスを無効にします。", "pt": "Desabilite o acesso à rede pública para a instância RDS definindo AllocatePublicConnection como false ou não configurando-o.", "zh": "通过将 AllocatePublicConnection 设置为 false 或不配置该属性，禁用 RDS 实例的公网访问。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-public-access-check.rego", PackageName: "infraguard.rules.aliyun.rds_public_access_check", Content: "package infraguard.rules.aliyun.rds_public_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"rds-public-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"RDS Instance Public Access Check\",\n\t\t\"zh\": \"RDS 实例不配置公网地址\",\n\t\t\"ja\": \"RDS インスタンスのパブリックアクセスチェック\",\n\t\t\"de\": \"RDS-Instanz öffentlicher Zugriff Prüfung\",\n\t\t\"es\": \"Verificación de Acceso Público de Instancia RDS\",\n\t\t\"fr\": \"Vérification d'Accès Public d'Instance RDS\",\n\t\t\"pt\": \"Verificação de Acesso Público de Instância RDS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"RDS instances should not be configured with public network addresses. Public access exposes databases to potential security threats from the internet.\",\n\t\t\"zh\": \"RDS 实例不应配置公网地址。公网访问会使数据库暴露于来自互联网的潜在安全威胁。\",\n\t\t\"ja\": \"RDS インスタンスはパブリックネットワークアドレスで設定すべきではありません。パブリックアクセスにより、データベースがインターネットからの潜在的なセキュリティ脅威にさらされます。\",\n\t\t\"de\": \"RDS-Instanzen sollten nicht mit öffentlichen Netzwerkadressen konfiguriert werden. Öffentlicher Zugriff setzt Datenbanken potenziellen Sicherheitsbedrohungen aus dem Internet aus.\",\n\t\t\"es\": \"Las instancias RDS no deben configurarse con direcciones de red públicas. El acceso público expone las bases de datos a posibles amenazas de seguridad de internet.\",\n\t\t\"fr\": \"Les instances RDS ne doivent pas être configurées avec des adresses réseau publiques. L'accès public expose les bases de données à des menaces de sécurité potentielles d'Internet.\",\n\t\t\"pt\": \"Instâncias RDS não devem ser configuradas com endereços de rede pública. O acesso público expõe bancos de dados a ameaças potenciais de segurança da internet.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The RDS instance is configured with public network access, which exposes the database to security risks from the internet.\",\n\t\t\"zh\": \"RDS 实例配置了公网访问，使数据库暴露于来自互联网的安全风险。\",\n\t\t\"ja\": \"RDS インスタンスがパブリックネットワークアクセスで設定されているため、データベースがインターネットからのセキュリティリスクにさらされます。\",\n\t\t\"de\": \"Die RDS-Instanz ist mit öffentlichem Netzwerkzugriff konfiguriert, was die Datenbank Sicherheitsrisiken aus dem Internet aussetzt.\",\n\t\t\"es\": \"La instancia RDS está configurada con acceso a red pública, lo que expone la base de datos a riesgos de seguridad de internet.\",\n\t\t\"fr\": \"L'instance RDS est configurée avec un accès réseau public, ce qui expose la base de données aux risques de sécurité d'Internet.\",\n\t\t\"pt\": \"A instância RDS está configurada com acesso à rede pública, o que expõe o banco de dados a riscos de segurança da internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable public network access for the RDS instance by setting AllocatePublicConnection to false or not configuring it.\",\n\t\t\"zh\": \"通过将 AllocatePublicConnection 设置为 false 或不配置该属性，禁用 RDS 实例的公网访问。\",\n\t\t\"ja\": \"AllocatePublicConnection を false に設定するか、設定しないことで、RDS インスタンスのパブリックネットワークアクセスを無効にします。\",\n\t\t\"de\": \"Deaktivieren Sie den öffentlichen Netzwerkzugriff für die RDS-Instanz, indem Sie AllocatePublicConnection auf false setzen oder es nicht konfigurieren.\",\n\t\t\"es\": \"Deshabilite el acceso a la red pública para la instancia RDS estableciendo AllocatePublicConnection en false o no configurándolo.\",\n\t\t\"fr\": \"Désactivez l'accès réseau public pour l'instance RDS en définissant AllocatePublicConnection sur false ou en ne le configurant pas.\",\n\t\t\"pt\": \"Desabilite o acesso à rede pública para a instância RDS definindo AllocatePublicConnection como false ou não configurando-o.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\thas_public_access(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AllocatePublicConnection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\nhas_public_access(resource) if {\n\tresource.Properties.AllocatePublicConnection == true\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-public-connection-and-any-ip-access-check", Name: models.I18nString{"de": "RDS öffentliche Verbindung und beliebige IP-Zugriff-Prüfung", "en": "RDS Public Connection and Any IP Access Check", "es": "Verificación de Conexión Pública y Acceso de Cualquier IP de RDS", "fr": "Vérification de Connexion Publique et d'Accès de N'importe Quelle IP RDS", "ja": "RDS のパブリック接続および任意の IP アクセスチェック", "pt": "Verificação de Conexão Pública e Acesso de Qualquer IP RDS", "zh": "开启公网 IP 的 RDS 实例白名单未对所有来源开放"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass RDS-Instanzen mit öffentlichen Verbindungen keine Whitelist haben, die für alle IPs geöffnet ist.", "en": "Ensures that RDS instances with public connections do not have a whitelist open to all IPs.", "es": "Garantiza que las instancias RDS con conexiones públicas no tengan una lista blanca abierta a todas las IPs.", "fr": "Garantit que les instances RDS avec connexions publiques n'ont pas de liste blanche ouverte à toutes les IPs.", "ja": "パブリック接続を持つ RDS インスタンスがすべての IP に開放されたホワイトリストを持っていないことを確認します。", "pt": "Garante que instâncias RDS com conexões públicas não tenham uma lista branca aberta para todos os IPs.", "zh": "确保开启公网 IP 的 RDS 实例白名单未设置为对所有来源 IP 开放。"}, Reason: models.I18nString{"de": "Eine offene Whitelist in Kombination mit einer öffentlichen Verbindung setzt die Datenbank dem Internet aus und schafft ein hohes Sicherheitsrisiko.", "en": "An open whitelist combined with a public connection exposes the database to the internet, creating a high security risk.", "es": "Una lista blanca abierta combinada con una conexión pública expone la base de datos a internet, creando un alto riesgo de seguridad.", "fr": "Une liste blanche ouverte combinée à une connexion publique expose la base de données à Internet, créant un risque de sécurité élevé.", "ja": "オープンホワイトリストとパブリック接続の組み合わせにより、データベースがインターネットに公開され、高いセキュリティリスクが生じます。", "pt": "Uma lista branca aberta combinada com uma conexão pública expõe o banco de dados à internet, criando um alto risco de segurança.", "zh": "公网连接配合开放白名单会将数据库暴露在互联网上，造成极高的安全风险。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie die öffentliche Verbindung oder beschränken Sie die IP-Whitelist für die RDS-Instanz.", "en": "Disable public connection or restrict the IP whitelist for the RDS instance.", "es": "Deshabilite la conexión pública o restrinja la lista blanca de IP para la instancia RDS.", "fr": "Désactivez la connexion publique ou restreignez la liste blanche IP pour l'instance RDS.", "ja": "RDS インスタンスのパブリック接続を無効にするか、IP ホワイトリストを制限します。", "pt": "Desabilite a conexão pública ou restrinja a lista branca de IP para a instância RDS.", "zh": "禁用 RDS 实例的公网连接或限制 IP 白名单。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-public-connection-and-any-ip-access-check.rego", PackageName: "infraguard.rules.aliyun.rds_public_connection_and_any_ip_access_check", Content: "package infraguard.rules.aliyun.rds_public_connection_and_any_ip_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"rds-public-connection-and-any-ip-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"RDS Public Connection and Any IP Access Check\",\n\t\t\"zh\": \"开启公网 IP 的 RDS 实例白名单未对所有来源开放\",\n\t\t\"ja\": \"RDS のパブリック接続および任意の IP アクセスチェック\",\n\t\t\"de\": \"RDS öffentliche Verbindung und beliebige IP-Zugriff-Prüfung\",\n\t\t\"es\": \"Verificación de Conexión Pública y Acceso de Cualquier IP de RDS\",\n\t\t\"fr\": \"Vérification de Connexion Publique et d'Accès de N'importe Quelle IP RDS\",\n\t\t\"pt\": \"Verificação de Conexão Pública e Acesso de Qualquer IP RDS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that RDS instances with public connections do not have a whitelist open to all IPs.\",\n\t\t\"zh\": \"确保开启公网 IP 的 RDS 实例白名单未设置为对所有来源 IP 开放。\",\n\t\t\"ja\": \"パブリック接続を持つ RDS インスタンスがすべての IP に開放されたホワイトリストを持っていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RDS-Instanzen mit öffentlichen Verbindungen keine Whitelist haben, die für alle IPs geöffnet ist.\",\n\t\t\"es\": \"Garantiza que las instancias RDS con conexiones públicas no tengan una lista blanca abierta a todas las IPs.\",\n\t\t\"fr\": \"Garantit que les instances RDS avec connexions publiques n'ont pas de liste blanche ouverte à toutes les IPs.\",\n\t\t\"pt\": \"Garante que instâncias RDS com conexões públicas não tenham uma lista branca aberta para todos os IPs.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"An open whitelist combined with a public connection exposes the database to the internet, creating a high security risk.\",\n\t\t\"zh\": \"公网连接配合开放白名单会将数据库暴露在互联网上，造成极高的安全风险。\",\n\t\t\"ja\": \"オープンホワイトリストとパブリック接続の組み合わせにより、データベースがインターネットに公開され、高いセキュリティリスクが生じます。\",\n\t\t\"de\": \"Eine offene Whitelist in Kombination mit einer öffentlichen Verbindung setzt die Datenbank dem Internet aus und schafft ein hohes Sicherheitsrisiko.\",\n\t\t\"es\": \"Una lista blanca abierta combinada con una conexión pública expone la base de datos a internet, creando un alto riesgo de seguridad.\",\n\t\t\"fr\": \"Une liste blanche ouverte combinée à une connexion publique expose la base de données à Internet, créant un risque de sécurité élevé.\",\n\t\t\"pt\": \"Uma lista branca aberta combinada com uma conexão pública expõe o banco de dados à internet, criando um alto risco de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable public connection or restrict the IP whitelist for the RDS instance.\",\n\t\t\"zh\": \"禁用 RDS 实例的公网连接或限制 IP 白名单。\",\n\t\t\"ja\": \"RDS インスタンスのパブリック接続を無効にするか、IP ホワイトリストを制限します。\",\n\t\t\"de\": \"Deaktivieren Sie die öffentliche Verbindung oder beschränken Sie die IP-Whitelist für die RDS-Instanz.\",\n\t\t\"es\": \"Deshabilite la conexión pública o restrinja la lista blanca de IP para la instancia RDS.\",\n\t\t\"fr\": \"Désactivez la connexion publique ou restreignez la liste blanche IP pour l'instance RDS.\",\n\t\t\"pt\": \"Desabilite a conexão pública ou restrinja a lista branca de IP para a instância RDS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\t# If public connection is not enabled, it's compliant\n\tnot helpers.is_true(helpers.get_property(resource, \"AllocatePublicConnection\", false))\n}\n\nis_compliant(resource) if {\n\t# If public connection is enabled, check the whitelist\n\thelpers.is_true(helpers.get_property(resource, \"AllocatePublicConnection\", false))\n\twhitelist_str := helpers.get_property(resource, \"SecurityIPList\", \"\")\n\twhitelist := split(whitelist_str, \",\")\n\tnot has_open_cidr(whitelist)\n}\n\nhas_open_cidr(whitelist) if {\n\tsome cidr in whitelist\n\thelpers.is_public_cidr(trim_space(cidr))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityIPList\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rds-white-list-internet-ip-access-check", Name: models.I18nString{"de": "RDS-Whitelist Internet-Einschränkung", "en": "RDS Whitelist Internet Restriction", "es": "Restricción de Internet de Lista Blanca RDS", "fr": "Restriction Internet de Liste Blanche RDS", "ja": "RDS ホワイトリストインターネット制限", "pt": "Restrição de Internet da Lista Branca RDS", "zh": "RDS 白名单禁用公网开放"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass RDS-Sicherheits-IP-Whitelists 0.0.0.0/0 nicht enthalten.", "en": "Ensures RDS security IP whitelists do not contain 0.0.0.0/0.", "es": "Garantiza que las listas blancas de IP de seguridad RDS no contengan 0.0.0.0/0.", "fr": "Garantit que les listes blanches d'IP de sécurité RDS ne contiennent pas 0.0.0.0/0.", "ja": "RDS セキュリティ IP ホワイトリストに 0.0.0.0/0 が含まれていないことを確認します。", "pt": "Garante que as listas brancas de IP de segurança RDS não contenham 0.0.0.0/0.", "zh": "确保 RDS 安全 IP 白名单中不包含 0.0.0.0/0。"}, Reason: models.I18nString{"de": "Das Zulassen von 0.0.0.0/0 in der Whitelist setzt die Datenbank dem gesamten öffentlichen Internetverkehr aus.", "en": "Allowing 0.0.0.0/0 in the whitelist exposes the database to all public internet traffic.", "es": "Permitir 0.0.0.0/0 en la lista blanca expone la base de datos a todo el tráfico público de Internet.", "fr": "Autoriser 0.0.0.0/0 dans la liste blanche expose la base de données à tout le trafic Internet public.", "ja": "ホワイトリストで 0.0.0.0/0 を許可すると、データベースがすべてのパブリックインターネットトラフィックにさらされます。", "pt": "Permitir 0.0.0.0/0 na lista branca expõe o banco de dados a todo o tráfego público da Internet.", "zh": "在白名单中允许 0.0.0.0/0 会使数据库暴露给所有的公网流量。"}, Recommendation: models.I18nString{"de": "Entfernen Sie 0.0.0.0/0 aus der RDS-Sicherheits-IP-Liste und verwenden Sie spezifische vertrauenswürdige IPs.", "en": "Remove 0.0.0.0/0 from the RDS security IP list and use specific trusted IPs.", "es": "Elimine 0.0.0.0/0 de la lista de IP de seguridad RDS y use IPs confiables específicas.", "fr": "Supprimez 0.0.0.0/0 de la liste d'IP de sécurité RDS et utilisez des IP de confiance spécifiques.", "ja": "RDS セキュリティ IP リストから 0.0.0.0/0 を削除し、特定の信頼できる IP を使用します。", "pt": "Remova 0.0.0.0/0 da lista de IP de segurança RDS e use IPs confiáveis específicos.", "zh": "从 RDS 安全 IP 列表中移除 0.0.0.0/0，并使用特定的可信 IP。"}, ResourceTypes: []string{"ALIYUN::RDS::DBInstance"}, FilePath: "aliyun/rules/rds-white-list-internet-ip-access-check.rego", PackageName: "infraguard.rules.aliyun.rds_white_list_internet_ip_access_check", Content: "package infraguard.rules.aliyun.rds_white_list_internet_ip_access_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"rds-white-list-internet-ip-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"RDS Whitelist Internet Restriction\",\n\t\t\"zh\": \"RDS 白名单禁用公网开放\",\n\t\t\"ja\": \"RDS ホワイトリストインターネット制限\",\n\t\t\"de\": \"RDS-Whitelist Internet-Einschränkung\",\n\t\t\"es\": \"Restricción de Internet de Lista Blanca RDS\",\n\t\t\"fr\": \"Restriction Internet de Liste Blanche RDS\",\n\t\t\"pt\": \"Restrição de Internet da Lista Branca RDS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures RDS security IP whitelists do not contain 0.0.0.0/0.\",\n\t\t\"zh\": \"确保 RDS 安全 IP 白名单中不包含 0.0.0.0/0。\",\n\t\t\"ja\": \"RDS セキュリティ IP ホワイトリストに 0.0.0.0/0 が含まれていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass RDS-Sicherheits-IP-Whitelists 0.0.0.0/0 nicht enthalten.\",\n\t\t\"es\": \"Garantiza que las listas blancas de IP de seguridad RDS no contengan 0.0.0.0/0.\",\n\t\t\"fr\": \"Garantit que les listes blanches d'IP de sécurité RDS ne contiennent pas 0.0.0.0/0.\",\n\t\t\"pt\": \"Garante que as listas brancas de IP de segurança RDS não contenham 0.0.0.0/0.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Allowing 0.0.0.0/0 in the whitelist exposes the database to all public internet traffic.\",\n\t\t\"zh\": \"在白名单中允许 0.0.0.0/0 会使数据库暴露给所有的公网流量。\",\n\t\t\"ja\": \"ホワイトリストで 0.0.0.0/0 を許可すると、データベースがすべてのパブリックインターネットトラフィックにさらされます。\",\n\t\t\"de\": \"Das Zulassen von 0.0.0.0/0 in der Whitelist setzt die Datenbank dem gesamten öffentlichen Internetverkehr aus.\",\n\t\t\"es\": \"Permitir 0.0.0.0/0 en la lista blanca expone la base de datos a todo el tráfico público de Internet.\",\n\t\t\"fr\": \"Autoriser 0.0.0.0/0 dans la liste blanche expose la base de données à tout le trafic Internet public.\",\n\t\t\"pt\": \"Permitir 0.0.0.0/0 na lista branca expõe o banco de dados a todo o tráfego público da Internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove 0.0.0.0/0 from the RDS security IP list and use specific trusted IPs.\",\n\t\t\"zh\": \"从 RDS 安全 IP 列表中移除 0.0.0.0/0，并使用特定的可信 IP。\",\n\t\t\"ja\": \"RDS セキュリティ IP リストから 0.0.0.0/0 を削除し、特定の信頼できる IP を使用します。\",\n\t\t\"de\": \"Entfernen Sie 0.0.0.0/0 aus der RDS-Sicherheits-IP-Liste und verwenden Sie spezifische vertrauenswürdige IPs.\",\n\t\t\"es\": \"Elimine 0.0.0.0/0 de la lista de IP de seguridad RDS y use IPs confiables específicas.\",\n\t\t\"fr\": \"Supprimez 0.0.0.0/0 de la liste d'IP de sécurité RDS et utilisez des IP de confiance spécifiques.\",\n\t\t\"pt\": \"Remova 0.0.0.0/0 da lista de IP de segurança RDS e use IPs confiáveis específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RDS::DBInstance\"]\n}\n\nis_compliant(resource) if {\n\twhitelist_str := helpers.get_property(resource, \"SecurityIPList\", \"\")\n\twhitelist := split(whitelist_str, \",\")\n\tnot has_public_ip(whitelist)\n}\n\nhas_public_ip(whitelist) if {\n\tsome ip in whitelist\n\thelpers.is_public_cidr(trim_space(ip))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RDS::DBInstance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityIPList\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-architecturetype-cluster-check", Name: models.I18nString{"de": "Redis-Architekturtyp Cluster-Prüfung", "en": "Redis Architecture Type Cluster Check", "es": "Verificación de Tipo de Arquitectura de Clúster Redis", "fr": "Vérification du Type d'Architecture de Cluster Redis", "ja": "Redis アーキテクチャタイプクラスタチェック", "pt": "Verificação de Tipo de Arquitetura de Cluster Redis", "zh": "使用集群版的 Redis 实例"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die Redis-Instanz den Cluster-Architekturtyp verwendet.", "en": "Ensures Redis instance uses cluster architecture type.", "es": "Garantiza que la instancia Redis use el tipo de arquitectura de clúster.", "fr": "Garantit que l'instance Redis utilise le type d'architecture de cluster.", "ja": "Redis インスタンスがクラスタアーキテクチャタイプを使用することを確認します。", "pt": "Garante que a instância Redis use o tipo de arquitetura de cluster.", "zh": "确保 Redis 实例的架构类型为集群版。"}, Reason: models.I18nString{"de": "Cluster-Architektur bietet bessere Skalierbarkeit und Hochverfügbarkeit.", "en": "Cluster architecture provides better scalability and high availability.", "es": "La arquitectura de clúster proporciona mejor escalabilidad y alta disponibilidad.", "fr": "L'architecture de cluster offre une meilleure scalabilité et une haute disponibilité.", "ja": "クラスタアーキテクチャは、より優れたスケーラビリティと高可用性を提供します。", "pt": "A arquitetura de cluster fornece melhor escalabilidade e alta disponibilidade.", "zh": "集群架构提供更好的可扩展性和高可用性。"}, Recommendation: models.I18nString{"de": "Verwenden Sie Cluster-Architektur für Redis-Instanz.", "en": "Use cluster architecture for Redis instance.", "es": "Use arquitectura de clúster para la instancia Redis.", "fr": "Utilisez l'architecture de cluster pour l'instance Redis.", "ja": "Redis インスタンスにクラスタアーキテクチャを使用します。", "pt": "Use arquitetura de cluster para a instância Redis.", "zh": "为 Redis 实例使用集群架构。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-architecturetype-cluster-check.rego", PackageName: "infraguard.rules.aliyun.redis_architecturetype_cluster_check", Content: "package infraguard.rules.aliyun.redis_architecturetype_cluster_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-architecturetype-cluster-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Architecture Type Cluster Check\",\n\t\t\"zh\": \"使用集群版的 Redis 实例\",\n\t\t\"ja\": \"Redis アーキテクチャタイプクラスタチェック\",\n\t\t\"de\": \"Redis-Architekturtyp Cluster-Prüfung\",\n\t\t\"es\": \"Verificación de Tipo de Arquitectura de Clúster Redis\",\n\t\t\"fr\": \"Vérification du Type d'Architecture de Cluster Redis\",\n\t\t\"pt\": \"Verificação de Tipo de Arquitetura de Cluster Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Redis instance uses cluster architecture type.\",\n\t\t\"zh\": \"确保 Redis 实例的架构类型为集群版。\",\n\t\t\"ja\": \"Redis インスタンスがクラスタアーキテクチャタイプを使用することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Redis-Instanz den Cluster-Architekturtyp verwendet.\",\n\t\t\"es\": \"Garantiza que la instancia Redis use el tipo de arquitectura de clúster.\",\n\t\t\"fr\": \"Garantit que l'instance Redis utilise le type d'architecture de cluster.\",\n\t\t\"pt\": \"Garante que a instância Redis use o tipo de arquitetura de cluster.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Cluster architecture provides better scalability and high availability.\",\n\t\t\"zh\": \"集群架构提供更好的可扩展性和高可用性。\",\n\t\t\"ja\": \"クラスタアーキテクチャは、より優れたスケーラビリティと高可用性を提供します。\",\n\t\t\"de\": \"Cluster-Architektur bietet bessere Skalierbarkeit und Hochverfügbarkeit.\",\n\t\t\"es\": \"La arquitectura de clúster proporciona mejor escalabilidad y alta disponibilidad.\",\n\t\t\"fr\": \"L'architecture de cluster offre une meilleure scalabilité et une haute disponibilité.\",\n\t\t\"pt\": \"A arquitetura de cluster fornece melhor escalabilidade e alta disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use cluster architecture for Redis instance.\",\n\t\t\"zh\": \"为 Redis 实例使用集群架构。\",\n\t\t\"ja\": \"Redis インスタンスにクラスタアーキテクチャを使用します。\",\n\t\t\"de\": \"Verwenden Sie Cluster-Architektur für Redis-Instanz.\",\n\t\t\"es\": \"Use arquitectura de clúster para la instancia Redis.\",\n\t\t\"fr\": \"Utilisez l'architecture de cluster pour l'instance Redis.\",\n\t\t\"pt\": \"Use arquitetura de cluster para a instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\tinstance_class := helpers.get_property(resource, \"InstanceClass\", \"\")\n\tcontains(instance_class, \"cluster\")\n}\n\nis_compliant(resource) if {\n\tshard_count := helpers.get_property(resource, \"ShardCount\", 1)\n\tshard_count >= 2\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ShardCount\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-backup-log-enabled", Name: models.I18nString{"de": "Redis-Instanz Log-Backup aktiviert", "en": "Redis Instance Backup Log Enabled", "es": "Backup de Log de Instancia Redis Habilitado", "fr": "Sauvegarde de Journal d'Instance Redis Activée", "ja": "Redis インスタンスでログバックアップが有効", "pt": "Backup de Log de Instância Redis Habilitado", "zh": "Redis 实例开启日志备份"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Log-Backup für die Redis-Instanz aktiviert ist.", "en": "Ensures that log backup is enabled for the Redis instance.", "es": "Garantiza que el backup de log esté habilitado para la instancia Redis.", "fr": "Garantit que la sauvegarde de journal est activée pour l'instance Redis.", "ja": "Redis インスタンスでログバックアップが有効になっていることを確認します。", "pt": "Garante que o backup de log esteja habilitado para a instância Redis.", "zh": "确保 Redis 实例开启了日志备份。"}, Reason: models.I18nString{"de": "Das Aktivieren von Log-Backup ermöglicht die Point-in-Time-Wiederherstellung der Datenbank.", "en": "Enabling log backup allows for point-in-time recovery of the database.", "es": "Habilitar el backup de log permite la recuperación puntual de la base de datos.", "fr": "Activer la sauvegarde de journal permet la récupération ponctuelle de la base de données.", "ja": "ログバックアップを有効にすることで、データベースのポイントインタイムリカバリが可能になります。", "pt": "Habilitar backup de log permite recuperação pontual do banco de dados.", "zh": "开启日志备份允许对数据库进行按时间点恢复。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Log-Backup für die Redis-Instanz.", "en": "Enable log backup for the Redis instance.", "es": "Habilite backup de log para la instancia Redis.", "fr": "Activez la sauvegarde de journal pour l'instance Redis.", "ja": "Redis インスタンスでログバックアップを有効にします。", "pt": "Habilite backup de log para a instância Redis.", "zh": "为 Redis 实例开启日志备份。"}, ResourceTypes: []string{"ALIYUN::Redis::DBInstance"}, FilePath: "aliyun/rules/redis-instance-backup-log-enabled.rego", PackageName: "infraguard.rules.aliyun.redis_instance_backup_log_enabled", Content: "package infraguard.rules.aliyun.redis_instance_backup_log_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"redis-instance-backup-log-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance Backup Log Enabled\",\n\t\t\"zh\": \"Redis 实例开启日志备份\",\n\t\t\"ja\": \"Redis インスタンスでログバックアップが有効\",\n\t\t\"de\": \"Redis-Instanz Log-Backup aktiviert\",\n\t\t\"es\": \"Backup de Log de Instancia Redis Habilitado\",\n\t\t\"fr\": \"Sauvegarde de Journal d'Instance Redis Activée\",\n\t\t\"pt\": \"Backup de Log de Instância Redis Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that log backup is enabled for the Redis instance.\",\n\t\t\"zh\": \"确保 Redis 实例开启了日志备份。\",\n\t\t\"ja\": \"Redis インスタンスでログバックアップが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Log-Backup für die Redis-Instanz aktiviert ist.\",\n\t\t\"es\": \"Garantiza que el backup de log esté habilitado para la instancia Redis.\",\n\t\t\"fr\": \"Garantit que la sauvegarde de journal est activée pour l'instance Redis.\",\n\t\t\"pt\": \"Garante que o backup de log esteja habilitado para a instância Redis.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Enabling log backup allows for point-in-time recovery of the database.\",\n\t\t\"zh\": \"开启日志备份允许对数据库进行按时间点恢复。\",\n\t\t\"ja\": \"ログバックアップを有効にすることで、データベースのポイントインタイムリカバリが可能になります。\",\n\t\t\"de\": \"Das Aktivieren von Log-Backup ermöglicht die Point-in-Time-Wiederherstellung der Datenbank.\",\n\t\t\"es\": \"Habilitar el backup de log permite la recuperación puntual de la base de datos.\",\n\t\t\"fr\": \"Activer la sauvegarde de journal permet la récupération ponctuelle de la base de données.\",\n\t\t\"pt\": \"Habilitar backup de log permite recuperação pontual do banco de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable log backup for the Redis instance.\",\n\t\t\"zh\": \"为 Redis 实例开启日志备份。\",\n\t\t\"ja\": \"Redis インスタンスでログバックアップを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Log-Backup für die Redis-Instanz.\",\n\t\t\"es\": \"Habilite backup de log para la instancia Redis.\",\n\t\t\"fr\": \"Activez la sauvegarde de journal pour l'instance Redis.\",\n\t\t\"pt\": \"Habilite backup de log para a instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::Redis::DBInstance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::Redis::DBInstance\")\n\n\t# Conceptual check\n\tnot helpers.get_property(resource, \"AppendOnly\", \"no\") == \"yes\"\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AppendOnly\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-backup-time-check", Name: models.I18nString{"de": "Redis-Instanz Backup-Fenster-Prüfung", "en": "Redis Instance Backup Window Check", "es": "Verificación de Ventana de Respaldo de Instancia Redis", "fr": "Vérification de la Fenêtre de Sauvegarde de l'Instance Redis", "ja": "Redis インスタンスのバックアップウィンドウチェック", "pt": "Verificação de Janela de Backup de Instância Redis", "zh": "Redis 实例备份时间检测"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass die Redis-Instanz ein Backup-Fenster konfiguriert hat.", "en": "Ensures that the Redis instance has a backup window configured.", "es": "Garantiza que la instancia Redis tenga configurada una ventana de respaldo.", "fr": "Garantit que l'instance Redis a une fenêtre de sauvegarde configurée.", "ja": "Redis インスタンスにバックアップウィンドウが設定されていることを確認します。", "pt": "Garante que a instância Redis tenha uma janela de backup configurada.", "zh": "确保 Redis 实例配置了备份时间段。"}, Reason: models.I18nString{"de": "Die Konfiguration eines Backup-Fensters stellt sicher, dass Backups während der Nebenzeiten durchgeführt werden.", "en": "Configuring a backup window ensures that backups are taken during off-peak hours.", "es": "Configurar una ventana de respaldo garantiza que los respaldos se realicen durante las horas de menor actividad.", "fr": "La configuration d'une fenêtre de sauvegarde garantit que les sauvegardes sont effectuées pendant les heures creuses.", "ja": "バックアップウィンドウを設定することで、オフピーク時間帯にバックアップが実行されることを確保します。", "pt": "Configurar uma janela de backup garante que os backups sejam feitos durante as horas de menor movimento.", "zh": "配置备份时间段可确保在非高峰时段进行备份。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie ein Backup-Fenster für die Redis-Instanz.", "en": "Configure a backup window for the Redis instance.", "es": "Configure una ventana de respaldo para la instancia Redis.", "fr": "Configurez une fenêtre de sauvegarde pour l'instance Redis.", "ja": "Redis インスタンスにバックアップウィンドウを設定します。", "pt": "Configure uma janela de backup para a instância Redis.", "zh": "为 Redis 实例配置备份时间段。"}, ResourceTypes: []string{"ALIYUN::Redis::DBInstance"}, FilePath: "aliyun/rules/redis-instance-backup-time-check.rego", PackageName: "infraguard.rules.aliyun.redis_instance_backup_time_check", Content: "package infraguard.rules.aliyun.redis_instance_backup_time_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"redis-instance-backup-time-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance Backup Window Check\",\n\t\t\"zh\": \"Redis 实例备份时间检测\",\n\t\t\"ja\": \"Redis インスタンスのバックアップウィンドウチェック\",\n\t\t\"de\": \"Redis-Instanz Backup-Fenster-Prüfung\",\n\t\t\"es\": \"Verificación de Ventana de Respaldo de Instancia Redis\",\n\t\t\"fr\": \"Vérification de la Fenêtre de Sauvegarde de l'Instance Redis\",\n\t\t\"pt\": \"Verificação de Janela de Backup de Instância Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the Redis instance has a backup window configured.\",\n\t\t\"zh\": \"确保 Redis 实例配置了备份时间段。\",\n\t\t\"ja\": \"Redis インスタンスにバックアップウィンドウが設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Redis-Instanz ein Backup-Fenster konfiguriert hat.\",\n\t\t\"es\": \"Garantiza que la instancia Redis tenga configurada una ventana de respaldo.\",\n\t\t\"fr\": \"Garantit que l'instance Redis a une fenêtre de sauvegarde configurée.\",\n\t\t\"pt\": \"Garante que a instância Redis tenha uma janela de backup configurada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Configuring a backup window ensures that backups are taken during off-peak hours.\",\n\t\t\"zh\": \"配置备份时间段可确保在非高峰时段进行备份。\",\n\t\t\"ja\": \"バックアップウィンドウを設定することで、オフピーク時間帯にバックアップが実行されることを確保します。\",\n\t\t\"de\": \"Die Konfiguration eines Backup-Fensters stellt sicher, dass Backups während der Nebenzeiten durchgeführt werden.\",\n\t\t\"es\": \"Configurar una ventana de respaldo garantiza que los respaldos se realicen durante las horas de menor actividad.\",\n\t\t\"fr\": \"La configuration d'une fenêtre de sauvegarde garantit que les sauvegardes sont effectuées pendant les heures creuses.\",\n\t\t\"pt\": \"Configurar uma janela de backup garante que os backups sejam feitos durante as horas de menor movimento.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a backup window for the Redis instance.\",\n\t\t\"zh\": \"为 Redis 实例配置备份时间段。\",\n\t\t\"ja\": \"Redis インスタンスにバックアップウィンドウを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie ein Backup-Fenster für die Redis-Instanz.\",\n\t\t\"es\": \"Configure una ventana de respaldo para la instancia Redis.\",\n\t\t\"fr\": \"Configurez une fenêtre de sauvegarde pour l'instance Redis.\",\n\t\t\"pt\": \"Configure uma janela de backup para a instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::Redis::DBInstance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::Redis::DBInstance\")\n\tnot helpers.has_property(resource, \"BackupTime\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"BackupTime\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-double-node-type", Name: models.I18nString{"de": "Redis-Instanz Doppelknotentyp", "en": "Redis Instance Double Node Type", "es": "Tipo de Nodo Doble de Instancia Redis", "fr": "Type de Nœud Double d'Instance Redis", "ja": "Redis インスタンスダブルノードタイプ", "pt": "Tipo de Nó Duplo de Instância Redis", "zh": "Redis 实例节点类型为双副本"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Redis-Instanz den Doppelknotentyp für Hochverfügbarkeit verwendet.", "en": "Ensures Redis instance uses double node type for high availability.", "es": "Garantiza que la instancia Redis use tipo de nodo doble para alta disponibilidad.", "fr": "Garantit que l'instance Redis utilise le type de nœud double pour une haute disponibilité.", "ja": "Redis インスタンスが高可用性のためにダブルノードタイプを使用していることを確認します。", "pt": "Garante que a instância Redis use tipo de nó duplo para alta disponibilidade.", "zh": "确保 Redis 实例使用双副本节点类型以确保高可用性。"}, Reason: models.I18nString{"de": "Doppelknotentyp bietet Hochverfügbarkeit durch Replikation.", "en": "Double node type provides high availability through replication.", "es": "El tipo de nodo doble proporciona alta disponibilidad mediante replicación.", "fr": "Le type de nœud double fournit une haute disponibilité grâce à la réplication.", "ja": "ダブルノードタイプは、レプリケーションを通じて高可用性を提供します。", "pt": "O tipo de nó duplo fornece alta disponibilidade através de replicação.", "zh": "双副本类型通过复制提供高可用性。"}, Recommendation: models.I18nString{"de": "Verwenden Sie den Doppelknotentyp für Redis-Instanz.", "en": "Use double node type for Redis instance.", "es": "Use tipo de nodo doble para la instancia Redis.", "fr": "Utilisez le type de nœud double pour l'instance Redis.", "ja": "Redis インスタンスにダブルノードタイプを使用します。", "pt": "Use tipo de nó duplo para a instância Redis.", "zh": "为 Redis 实例使用双副本节点类型。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-double-node-type.rego", PackageName: "infraguard.rules.aliyun.redis_instance_double_node_type", Content: "package infraguard.rules.aliyun.redis_instance_double_node_type\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-instance-double-node-type\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance Double Node Type\",\n\t\t\"zh\": \"Redis 实例节点类型为双副本\",\n\t\t\"ja\": \"Redis インスタンスダブルノードタイプ\",\n\t\t\"de\": \"Redis-Instanz Doppelknotentyp\",\n\t\t\"es\": \"Tipo de Nodo Doble de Instancia Redis\",\n\t\t\"fr\": \"Type de Nœud Double d'Instance Redis\",\n\t\t\"pt\": \"Tipo de Nó Duplo de Instância Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Redis instance uses double node type for high availability.\",\n\t\t\"zh\": \"确保 Redis 实例使用双副本节点类型以确保高可用性。\",\n\t\t\"ja\": \"Redis インスタンスが高可用性のためにダブルノードタイプを使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Redis-Instanz den Doppelknotentyp für Hochverfügbarkeit verwendet.\",\n\t\t\"es\": \"Garantiza que la instancia Redis use tipo de nodo doble para alta disponibilidad.\",\n\t\t\"fr\": \"Garantit que l'instance Redis utilise le type de nœud double pour une haute disponibilité.\",\n\t\t\"pt\": \"Garante que a instância Redis use tipo de nó duplo para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Double node type provides high availability through replication.\",\n\t\t\"zh\": \"双副本类型通过复制提供高可用性。\",\n\t\t\"ja\": \"ダブルノードタイプは、レプリケーションを通じて高可用性を提供します。\",\n\t\t\"de\": \"Doppelknotentyp bietet Hochverfügbarkeit durch Replikation.\",\n\t\t\"es\": \"El tipo de nodo doble proporciona alta disponibilidad mediante replicación.\",\n\t\t\"fr\": \"Le type de nœud double fournit une haute disponibilité grâce à la réplication.\",\n\t\t\"pt\": \"O tipo de nó duplo fornece alta disponibilidade através de replicação.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use double node type for Redis instance.\",\n\t\t\"zh\": \"为 Redis 实例使用双副本节点类型。\",\n\t\t\"ja\": \"Redis インスタンスにダブルノードタイプを使用します。\",\n\t\t\"de\": \"Verwenden Sie den Doppelknotentyp für Redis-Instanz.\",\n\t\t\"es\": \"Use tipo de nodo doble para la instancia Redis.\",\n\t\t\"fr\": \"Utilisez le type de nœud double pour l'instance Redis.\",\n\t\t\"pt\": \"Use tipo de nó duplo para a instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\tnode_type := helpers.get_property(resource, \"NodeType\", \"Double\")\n\tnode_type == \"Double\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"NodeType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-enabled-byok-tde", Name: models.I18nString{"de": "Redis-Instanz BYOK TDE aktiviert", "en": "Redis Instance BYOK TDE Enabled", "es": "TDE BYOK de Instancia Redis Habilitado", "fr": "TDE BYOK d'Instance Redis Activé", "ja": "Redis インスタンスで BYOK TDE が有効", "pt": "TDE BYOK de Instância Redis Habilitado", "zh": "Redis 实例开启 BYOK TDE 加密"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Redis-Instanzen Transparent Data Encryption (TDE) mit Bring Your Own Key (BYOK) aktiviert haben.", "en": "Ensures that Redis instances have Transparent Data Encryption (TDE) enabled using Bring Your Own Key (BYOK).", "es": "Garantiza que las instancias Redis tengan Transparent Data Encryption (TDE) habilitado usando Bring Your Own Key (BYOK).", "fr": "Garantit que les instances Redis ont Transparent Data Encryption (TDE) activé en utilisant Bring Your Own Key (BYOK).", "ja": "Redis インスタンスで Bring Your Own Key (BYOK) を使用して透過的データ暗号化（TDE）が有効になっていることを確認します。", "pt": "Garante que as instâncias Redis tenham Transparent Data Encryption (TDE) habilitado usando Bring Your Own Key (BYOK).", "zh": "确保 Redis 实例已使用自带密钥(BYOK)开启了透明数据加密(TDE)。"}, Reason: models.I18nString{"de": "TDE schützt ruhende Daten, und BYOK ermöglicht es Ihnen, die Kontrolle über die Verschlüsselungsschlüssel zu behalten.", "en": "TDE protects data at rest, and BYOK allows you to maintain control over the encryption keys.", "es": "TDE protege los datos en reposo, y BYOK le permite mantener el control sobre las claves de cifrado.", "fr": "TDE protège les données au repos, et BYOK vous permet de maintenir le contrôle sur les clés de chiffrement.", "ja": "TDE は保存データを保護し、BYOK により暗号化キーに対する制御を維持できます。", "pt": "TDE protege dados em repouso, e BYOK permite manter controle sobre as chaves de criptografia.", "zh": "TDE 可保护静态数据，而 BYOK 允许您保持对加密密钥的控制。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie TDE für die Redis-Instanz mit einem KMS-Schlüssel.", "en": "Enable TDE for the Redis instance using a KMS key.", "es": "Habilite TDE para la instancia Redis usando una clave KMS.", "fr": "Activez TDE pour l'instance Redis en utilisant une clé KMS.", "ja": "KMS キーを使用して Redis インスタンスで TDE を有効にします。", "pt": "Habilite TDE para a instância Redis usando uma chave KMS.", "zh": "使用 KMS 密钥为 Redis 实例开启 TDE。"}, ResourceTypes: []string{"ALIYUN::Redis::DBInstance"}, FilePath: "aliyun/rules/redis-instance-enabled-byok-tde.rego", PackageName: "infraguard.rules.aliyun.redis_instance_enabled_byok_tde", Content: "package infraguard.rules.aliyun.redis_instance_enabled_byok_tde\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"redis-instance-enabled-byok-tde\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance BYOK TDE Enabled\",\n\t\t\"zh\": \"Redis 实例开启 BYOK TDE 加密\",\n\t\t\"ja\": \"Redis インスタンスで BYOK TDE が有効\",\n\t\t\"de\": \"Redis-Instanz BYOK TDE aktiviert\",\n\t\t\"es\": \"TDE BYOK de Instancia Redis Habilitado\",\n\t\t\"fr\": \"TDE BYOK d'Instance Redis Activé\",\n\t\t\"pt\": \"TDE BYOK de Instância Redis Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Redis instances have Transparent Data Encryption (TDE) enabled using Bring Your Own Key (BYOK).\",\n\t\t\"zh\": \"确保 Redis 实例已使用自带密钥(BYOK)开启了透明数据加密(TDE)。\",\n\t\t\"ja\": \"Redis インスタンスで Bring Your Own Key (BYOK) を使用して透過的データ暗号化（TDE）が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Redis-Instanzen Transparent Data Encryption (TDE) mit Bring Your Own Key (BYOK) aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias Redis tengan Transparent Data Encryption (TDE) habilitado usando Bring Your Own Key (BYOK).\",\n\t\t\"fr\": \"Garantit que les instances Redis ont Transparent Data Encryption (TDE) activé en utilisant Bring Your Own Key (BYOK).\",\n\t\t\"pt\": \"Garante que as instâncias Redis tenham Transparent Data Encryption (TDE) habilitado usando Bring Your Own Key (BYOK).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"TDE protects data at rest, and BYOK allows you to maintain control over the encryption keys.\",\n\t\t\"zh\": \"TDE 可保护静态数据，而 BYOK 允许您保持对加密密钥的控制。\",\n\t\t\"ja\": \"TDE は保存データを保護し、BYOK により暗号化キーに対する制御を維持できます。\",\n\t\t\"de\": \"TDE schützt ruhende Daten, und BYOK ermöglicht es Ihnen, die Kontrolle über die Verschlüsselungsschlüssel zu behalten.\",\n\t\t\"es\": \"TDE protege los datos en reposo, y BYOK le permite mantener el control sobre las claves de cifrado.\",\n\t\t\"fr\": \"TDE protège les données au repos, et BYOK vous permet de maintenir le contrôle sur les clés de chiffrement.\",\n\t\t\"pt\": \"TDE protege dados em repouso, e BYOK permite manter controle sobre as chaves de criptografia.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable TDE for the Redis instance using a KMS key.\",\n\t\t\"zh\": \"使用 KMS 密钥为 Redis 实例开启 TDE。\",\n\t\t\"ja\": \"KMS キーを使用して Redis インスタンスで TDE を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie TDE für die Redis-Instanz mit einem KMS-Schlüssel.\",\n\t\t\"es\": \"Habilite TDE para la instancia Redis usando una clave KMS.\",\n\t\t\"fr\": \"Activez TDE pour l'instance Redis en utilisant une clé KMS.\",\n\t\t\"pt\": \"Habilite TDE para a instância Redis usando uma chave KMS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::Redis::DBInstance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::Redis::DBInstance\")\n\n\t# Conceptual check for TDE\n\tnot helpers.has_property(resource, \"TDEStatus\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-enabled-ssl", Name: models.I18nString{"de": "Redis-Instanz SSL aktiviert", "en": "Redis Instance SSL Enabled", "es": "SSL de Instancia Redis Habilitado", "fr": "SSL d'Instance Redis Activé", "ja": "Redis インスタンスで SSL が有効", "pt": "SSL de Instância Redis Habilitado", "zh": "Redis 实例开启 SSL 加密"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Redis-Instanzen SSL-Verschlüsselung aktiviert haben.", "en": "Ensures Redis instances have SSL encryption enabled.", "es": "Garantiza que las instancias Redis tengan cifrado SSL habilitado.", "fr": "Garantit que les instances Redis ont le chiffrement SSL activé.", "ja": "Redis インスタンスで SSL 暗号化が有効になっていることを確認します。", "pt": "Garante que as instâncias Redis tenham criptografia SSL habilitada.", "zh": "确保 Redis 实例开启了 SSL 加密。"}, Reason: models.I18nString{"de": "SSL-Verschlüsselung schützt Redis-Daten während der Übertragung vor Abfangen.", "en": "SSL encryption protects Redis data in transit from being intercepted.", "es": "El cifrado SSL protege los datos Redis en tránsito contra interceptación.", "fr": "Le chiffrement SSL protège les données Redis en transit contre l'interception.", "ja": "SSL 暗号化により、送信中の Redis データが傍受から保護されます。", "pt": "A criptografia SSL protege dados Redis em trânsito contra interceptação.", "zh": "SSL 加密保护传输中的 Redis 数据不被截获。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie SSL für die Redis-Instanz.", "en": "Enable SSL for the Redis instance.", "es": "Habilite SSL para la instancia Redis.", "fr": "Activez SSL pour l'instance Redis.", "ja": "Redis インスタンスで SSL を有効にします。", "pt": "Habilite SSL para a instância Redis.", "zh": "为 Redis 实例开启 SSL 加密。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-enabled-ssl.rego", PackageName: "infraguard.rules.aliyun.redis_instance_enabled_ssl", Content: "package infraguard.rules.aliyun.redis_instance_enabled_ssl\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"redis-instance-enabled-ssl\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance SSL Enabled\",\n\t\t\"zh\": \"Redis 实例开启 SSL 加密\",\n\t\t\"ja\": \"Redis インスタンスで SSL が有効\",\n\t\t\"de\": \"Redis-Instanz SSL aktiviert\",\n\t\t\"es\": \"SSL de Instancia Redis Habilitado\",\n\t\t\"fr\": \"SSL d'Instance Redis Activé\",\n\t\t\"pt\": \"SSL de Instância Redis Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Redis instances have SSL encryption enabled.\",\n\t\t\"zh\": \"确保 Redis 实例开启了 SSL 加密。\",\n\t\t\"ja\": \"Redis インスタンスで SSL 暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Redis-Instanzen SSL-Verschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias Redis tengan cifrado SSL habilitado.\",\n\t\t\"fr\": \"Garantit que les instances Redis ont le chiffrement SSL activé.\",\n\t\t\"pt\": \"Garante que as instâncias Redis tenham criptografia SSL habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"SSL encryption protects Redis data in transit from being intercepted.\",\n\t\t\"zh\": \"SSL 加密保护传输中的 Redis 数据不被截获。\",\n\t\t\"ja\": \"SSL 暗号化により、送信中の Redis データが傍受から保護されます。\",\n\t\t\"de\": \"SSL-Verschlüsselung schützt Redis-Daten während der Übertragung vor Abfangen.\",\n\t\t\"es\": \"El cifrado SSL protege los datos Redis en tránsito contra interceptación.\",\n\t\t\"fr\": \"Le chiffrement SSL protège les données Redis en transit contre l'interception.\",\n\t\t\"pt\": \"A criptografia SSL protege dados Redis em trânsito contra interceptação.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable SSL for the Redis instance.\",\n\t\t\"zh\": \"为 Redis 实例开启 SSL 加密。\",\n\t\t\"ja\": \"Redis インスタンスで SSL を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie SSL für die Redis-Instanz.\",\n\t\t\"es\": \"Habilite SSL para la instancia Redis.\",\n\t\t\"fr\": \"Activez SSL pour l'instance Redis.\",\n\t\t\"pt\": \"Habilite SSL para a instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\tssl := helpers.get_property(resource, \"SSLEnabled\", \"Disable\")\n\tssl == \"Enable\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SSLEnabled\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-expired-check", Name: models.I18nString{"de": "Redis Vorausbezahlte Instanz Ablaufprüfung", "en": "Redis Prepaid Instance Expiration Check", "es": "Verificación de Expiración de Instancia Prepaga Redis", "fr": "Vérification d'Expiration d'Instance Prépayée Redis", "ja": "Redis プリペイドインスタンスの有効期限チェック", "pt": "Verificação de Expiração de Instância Pré-paga Redis", "zh": "Redis 预付费实例到期检查"}, Severity: "high", Description: models.I18nString{"de": "Vorausbezahlte Redis-Instanzen sollten automatische Verlängerung aktiviert haben.", "en": "Prepaid Redis instances should have auto-renewal enabled.", "es": "Las instancias Redis prepagas deben tener renovación automática habilitada.", "fr": "Les instances Redis prépayées doivent avoir le renouvellement automatique activé.", "ja": "プリペイド Redis インスタンスは自動更新を有効にする必要があります。", "pt": "Instâncias Redis pré-pagas devem ter renovação automática habilitada.", "zh": "预付费 Redis 实例应开启自动续费，避免业务中断。"}, Reason: models.I18nString{"de": "Die vorausbezahlte Redis-Instanz hat keine automatische Verlängerung aktiviert.", "en": "The prepaid Redis instance does not have auto-renewal enabled.", "es": "La instancia Redis prepaga no tiene renovación automática habilitada.", "fr": "L'instance Redis prépayée n'a pas le renouvellement automatique activé.", "ja": "プリペイド Redis インスタンスで自動更新が有効になっていません。", "pt": "A instância Redis pré-paga não tem renovação automática habilitada.", "zh": "预付费 Redis 实例未开启自动续费。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die automatische Verlängerung für die vorausbezahlte Redis-Instanz, indem Sie AutoRenewDuration setzen.", "en": "Enable auto-renewal for the prepaid Redis instance by setting AutoRenewDuration.", "es": "Habilite la renovación automática para la instancia Redis prepaga estableciendo AutoRenewDuration.", "fr": "Activez le renouvellement automatique pour l'instance Redis prépayée en définissant AutoRenewDuration.", "ja": "AutoRenewDuration を設定して、プリペイド Redis インスタンスで自動更新を有効にします。", "pt": "Habilite renovação automática para a instância Redis pré-paga definindo AutoRenewDuration.", "zh": "通过设置 AutoRenewDuration 为预付费 Redis 实例开启自动续费。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-expired-check.rego", PackageName: "infraguard.rules.aliyun.redis_instance_expired_check", Content: "package infraguard.rules.aliyun.redis_instance_expired_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-instance-expired-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Redis Prepaid Instance Expiration Check\",\n\t\t\"zh\": \"Redis 预付费实例到期检查\",\n\t\t\"ja\": \"Redis プリペイドインスタンスの有効期限チェック\",\n\t\t\"de\": \"Redis Vorausbezahlte Instanz Ablaufprüfung\",\n\t\t\"es\": \"Verificación de Expiración de Instancia Prepaga Redis\",\n\t\t\"fr\": \"Vérification d'Expiration d'Instance Prépayée Redis\",\n\t\t\"pt\": \"Verificação de Expiração de Instância Pré-paga Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Prepaid Redis instances should have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 Redis 实例应开启自动续费，避免业务中断。\",\n\t\t\"ja\": \"プリペイド Redis インスタンスは自動更新を有効にする必要があります。\",\n\t\t\"de\": \"Vorausbezahlte Redis-Instanzen sollten automatische Verlängerung aktiviert haben.\",\n\t\t\"es\": \"Las instancias Redis prepagas deben tener renovación automática habilitada.\",\n\t\t\"fr\": \"Les instances Redis prépayées doivent avoir le renouvellement automatique activé.\",\n\t\t\"pt\": \"Instâncias Redis pré-pagas devem ter renovação automática habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The prepaid Redis instance does not have auto-renewal enabled.\",\n\t\t\"zh\": \"预付费 Redis 实例未开启自动续费。\",\n\t\t\"ja\": \"プリペイド Redis インスタンスで自動更新が有効になっていません。\",\n\t\t\"de\": \"Die vorausbezahlte Redis-Instanz hat keine automatische Verlängerung aktiviert.\",\n\t\t\"es\": \"La instancia Redis prepaga no tiene renovación automática habilitada.\",\n\t\t\"fr\": \"L'instance Redis prépayée n'a pas le renouvellement automatique activé.\",\n\t\t\"pt\": \"A instância Redis pré-paga não tem renovação automática habilitada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for the prepaid Redis instance by setting AutoRenewDuration.\",\n\t\t\"zh\": \"通过设置 AutoRenewDuration 为预付费 Redis 实例开启自动续费。\",\n\t\t\"ja\": \"AutoRenewDuration を設定して、プリペイド Redis インスタンスで自動更新を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die automatische Verlängerung für die vorausbezahlte Redis-Instanz, indem Sie AutoRenewDuration setzen.\",\n\t\t\"es\": \"Habilite la renovación automática para la instancia Redis prepaga estableciendo AutoRenewDuration.\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour l'instance Redis prépayée en définissant AutoRenewDuration.\",\n\t\t\"pt\": \"Habilite renovação automática para a instância Redis pré-paga definindo AutoRenewDuration.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_prepaid(resource) if {\n\thelpers.get_property(resource, \"ChargeType\", \"PostPaid\") == \"PrePaid\"\n}\n\n# Redis uses AutoRenewDuration for auto-renewal configuration\nis_auto_renew_enabled(resource) if {\n\tduration := helpers.get_property(resource, \"AutoRenewDuration\", 0)\n\tduration > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tis_prepaid(resource)\n\tnot is_auto_renew_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AutoRenewDuration\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-in-vpc", Name: models.I18nString{"de": "Redis-Instanz in VPC", "en": "Redis Instance in VPC", "es": "Instancia Redis en VPC", "fr": "Instance Redis dans VPC", "ja": "VPC 内の Redis インスタンス", "pt": "Instância Redis em VPC", "zh": "使用专有网络类型的 Redis 实例"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die Redis-Instanz in einem VPC bereitgestellt wird.", "en": "Ensures Redis instance is deployed in a VPC.", "es": "Garantiza que la instancia Redis se despliegue en una VPC.", "fr": "Garantit que l'instance Redis est déployée dans un VPC.", "ja": "Redis インスタンスが VPC に展開されていることを確認します。", "pt": "Garante que a instância Redis seja implantada em uma VPC.", "zh": "确保 Redis 实例部署在专有网络中。"}, Reason: models.I18nString{"de": "VPC bietet bessere Netzwerkisolation und Sicherheit.", "en": "VPC provides better network isolation and security.", "es": "VPC proporciona mejor aislamiento de red y seguridad.", "fr": "VPC offre une meilleure isolation réseau et sécurité.", "ja": "VPC はより優れたネットワーク分離とセキュリティを提供します。", "pt": "VPC fornece melhor isolamento de rede e segurança.", "zh": "VPC 提供更好的网络隔离和安全性。"}, Recommendation: models.I18nString{"de": "Stellen Sie die Redis-Instanz in einem VPC bereit.", "en": "Deploy Redis instance in a VPC.", "es": "Despliegue la instancia Redis en una VPC.", "fr": "Déployez l'instance Redis dans un VPC.", "ja": "VPC に Redis インスタンスを展開します。", "pt": "Implante a instância Redis em uma VPC.", "zh": "将 Redis 部署在专有网络中。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-in-vpc.rego", PackageName: "infraguard.rules.aliyun.redis_instance_in_vpc", Content: "package infraguard.rules.aliyun.redis_instance_in_vpc\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-instance-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance in VPC\",\n\t\t\"zh\": \"使用专有网络类型的 Redis 实例\",\n\t\t\"ja\": \"VPC 内の Redis インスタンス\",\n\t\t\"de\": \"Redis-Instanz in VPC\",\n\t\t\"es\": \"Instancia Redis en VPC\",\n\t\t\"fr\": \"Instance Redis dans VPC\",\n\t\t\"pt\": \"Instância Redis em VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Redis instance is deployed in a VPC.\",\n\t\t\"zh\": \"确保 Redis 实例部署在专有网络中。\",\n\t\t\"ja\": \"Redis インスタンスが VPC に展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Redis-Instanz in einem VPC bereitgestellt wird.\",\n\t\t\"es\": \"Garantiza que la instancia Redis se despliegue en una VPC.\",\n\t\t\"fr\": \"Garantit que l'instance Redis est déployée dans un VPC.\",\n\t\t\"pt\": \"Garante que a instância Redis seja implantada em uma VPC.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"VPC provides better network isolation and security.\",\n\t\t\"zh\": \"VPC 提供更好的网络隔离和安全性。\",\n\t\t\"ja\": \"VPC はより優れたネットワーク分離とセキュリティを提供します。\",\n\t\t\"de\": \"VPC bietet bessere Netzwerkisolation und Sicherheit.\",\n\t\t\"es\": \"VPC proporciona mejor aislamiento de red y seguridad.\",\n\t\t\"fr\": \"VPC offre une meilleure isolation réseau et sécurité.\",\n\t\t\"pt\": \"VPC fornece melhor isolamento de rede e segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Deploy Redis instance in a VPC.\",\n\t\t\"zh\": \"将 Redis 部署在专有网络中。\",\n\t\t\"ja\": \"VPC に Redis インスタンスを展開します。\",\n\t\t\"de\": \"Stellen Sie die Redis-Instanz in einem VPC bereit.\",\n\t\t\"es\": \"Despliegue la instancia Redis en una VPC.\",\n\t\t\"fr\": \"Déployez l'instance Redis dans un VPC.\",\n\t\t\"pt\": \"Implante a instância Redis em uma VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\tvpc_id := helpers.get_property(resource, \"VpcId\", \"\")\n\tvpc_id != \"\"\n}\n\nis_compliant(resource) if {\n\tvswitch_id := helpers.get_property(resource, \"VSwitchId\", \"\")\n\tvswitch_id != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-multi-zone", Name: models.I18nString{"de": "Redis-Instanz Multi-Zone-Bereitstellung", "en": "Redis Instance Multi-Zone Deployment", "es": "Despliegue Multi-zona de Instancia Redis", "fr": "Déploiement Multi-Zones d'Instance Redis", "ja": "Redis インスタンスのマルチゾーン展開", "pt": "Implantação Multi-zona de Instância Redis", "zh": "Redis 实例多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "Redis-Instanzen sollten für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen bereitgestellt werden.", "en": "Redis instances should be deployed across multiple availability zones for high availability.", "es": "Las instancias Redis deben implementarse en múltiples zonas de disponibilidad para alta disponibilidad.", "fr": "Les instances Redis doivent être déployées sur plusieurs zones de disponibilité pour une haute disponibilité.", "ja": "高可用性のために、Redis インスタンスは複数の可用性ゾーンに展開する必要があります。", "pt": "Instâncias Redis devem ser implantadas em múltiplas zonas de disponibilidade para alta disponibilidade.", "zh": "Redis 实例应部署在多个可用区。"}, Reason: models.I18nString{"de": "Die Redis-Instanz ist nicht mit einer sekundären Zone konfiguriert.", "en": "The Redis instance is not configured with a secondary zone.", "es": "La instancia Redis no está configurada con una zona secundaria.", "fr": "L'instance Redis n'est pas configurée avec une zone secondaire.", "ja": "Redis インスタンスにセカンダリゾーンが設定されていません。", "pt": "A instância Redis não está configurada com uma zona secundária.", "zh": "Redis 实例未配置备用可用区。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie SecondaryZoneId, um Multi-Zone-Bereitstellung zu aktivieren.", "en": "Configure SecondaryZoneId to enable multi-zone deployment.", "es": "Configure SecondaryZoneId para habilitar la implementación multi-zona.", "fr": "Configurez SecondaryZoneId pour activer le déploiement multi-zones.", "ja": "マルチゾーン展開を有効にするために SecondaryZoneId を設定します。", "pt": "Configure SecondaryZoneId para habilitar implantação multi-zona.", "zh": "配置 SecondaryZoneId 以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.redis_instance_multi_zone", Content: "package infraguard.rules.aliyun.redis_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"redis-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"Redis 实例多可用区部署\",\n\t\t\"ja\": \"Redis インスタンスのマルチゾーン展開\",\n\t\t\"de\": \"Redis-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-zona de Instancia Redis\",\n\t\t\"fr\": \"Déploiement Multi-Zones d'Instance Redis\",\n\t\t\"pt\": \"Implantação Multi-zona de Instância Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Redis instances should be deployed across multiple availability zones for high availability.\",\n\t\t\"zh\": \"Redis 实例应部署在多个可用区。\",\n\t\t\"ja\": \"高可用性のために、Redis インスタンスは複数の可用性ゾーンに展開する必要があります。\",\n\t\t\"de\": \"Redis-Instanzen sollten für hohe Verfügbarkeit über mehrere Verfügbarkeitszonen bereitgestellt werden.\",\n\t\t\"es\": \"Las instancias Redis deben implementarse en múltiples zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances Redis doivent être déployées sur plusieurs zones de disponibilité pour une haute disponibilité.\",\n\t\t\"pt\": \"Instâncias Redis devem ser implantadas em múltiplas zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The Redis instance is not configured with a secondary zone.\",\n\t\t\"zh\": \"Redis 实例未配置备用可用区。\",\n\t\t\"ja\": \"Redis インスタンスにセカンダリゾーンが設定されていません。\",\n\t\t\"de\": \"Die Redis-Instanz ist nicht mit einer sekundären Zone konfiguriert.\",\n\t\t\"es\": \"La instancia Redis no está configurada con una zona secundaria.\",\n\t\t\"fr\": \"L'instance Redis n'est pas configurée avec une zone secondaire.\",\n\t\t\"pt\": \"A instância Redis não está configurada com uma zona secundária.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure SecondaryZoneId to enable multi-zone deployment.\",\n\t\t\"zh\": \"配置 SecondaryZoneId 以启用多可用区部署。\",\n\t\t\"ja\": \"マルチゾーン展開を有効にするために SecondaryZoneId を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie SecondaryZoneId, um Multi-Zone-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure SecondaryZoneId para habilitar la implementación multi-zona.\",\n\t\t\"fr\": \"Configurez SecondaryZoneId pour activer le déploiement multi-zones.\",\n\t\t\"pt\": \"Configure SecondaryZoneId para habilitar implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\n# Check if instance is multi-zone\nis_multi_zone(resource) if {\n\t# Check if SecondaryZoneId is present and not empty\n\tobject.get(resource.Properties, \"SecondaryZoneId\", \"\") != \"\"\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecondaryZoneId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-no-public-ip", Name: models.I18nString{"de": "Redis-Instanz ohne öffentliche IP", "en": "Redis Instance No Public IP", "es": "Instancia Redis Sin IP Pública", "fr": "Instance Redis Sans IP Publique", "ja": "Redis インスタンスにパブリック IP なし", "pt": "Instância Redis Sem IP Público", "zh": "Redis 实例未设置公网 IP"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass der Redis-Instanz keine öffentliche IP zugewiesen ist.", "en": "Ensures Redis instance does not have public IP assigned.", "es": "Garantiza que la instancia Redis no tenga una IP pública asignada.", "fr": "Garantit que l'instance Redis n'a pas d'IP publique assignée.", "ja": "Redis インスタンスにパブリック IP が割り当てられていないことを確認します。", "pt": "Garante que a instância Redis não tenha IP público atribuído.", "zh": "确保 Redis 实例未设置公网 IP。"}, Reason: models.I18nString{"de": "Öffentliche IP setzt die Redis-Instanz Internetangriffen aus.", "en": "Public IP exposes Redis instance to internet attacks.", "es": "La IP pública expone la instancia Redis a ataques de internet.", "fr": "L'IP publique expose l'instance Redis aux attaques Internet.", "ja": "パブリック IP により、Redis インスタンスがインターネット攻撃にさらされます。", "pt": "O IP público expõe a instância Redis a ataques da internet.", "zh": "公网 IP 使 Redis 实例暴露于互联网攻击。"}, Recommendation: models.I18nString{"de": "Entfernen Sie die öffentliche IP von der Redis-Instanz.", "en": "Remove public IP from the Redis instance.", "es": "Elimine la IP pública de la instancia Redis.", "fr": "Supprimez l'IP publique de l'instance Redis.", "ja": "Redis インスタンスからパブリック IP を削除します。", "pt": "Remova o IP público da instância Redis.", "zh": "移除 Redis 实例的公网 IP。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-no-public-ip.rego", PackageName: "infraguard.rules.aliyun.redis_instance_no_public_ip", Content: "package infraguard.rules.aliyun.redis_instance_no_public_ip\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-instance-no-public-ip\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance No Public IP\",\n\t\t\"zh\": \"Redis 实例未设置公网 IP\",\n\t\t\"ja\": \"Redis インスタンスにパブリック IP なし\",\n\t\t\"de\": \"Redis-Instanz ohne öffentliche IP\",\n\t\t\"es\": \"Instancia Redis Sin IP Pública\",\n\t\t\"fr\": \"Instance Redis Sans IP Publique\",\n\t\t\"pt\": \"Instância Redis Sem IP Público\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Redis instance does not have public IP assigned.\",\n\t\t\"zh\": \"确保 Redis 实例未设置公网 IP。\",\n\t\t\"ja\": \"Redis インスタンスにパブリック IP が割り当てられていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der Redis-Instanz keine öffentliche IP zugewiesen ist.\",\n\t\t\"es\": \"Garantiza que la instancia Redis no tenga una IP pública asignada.\",\n\t\t\"fr\": \"Garantit que l'instance Redis n'a pas d'IP publique assignée.\",\n\t\t\"pt\": \"Garante que a instância Redis não tenha IP público atribuído.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Public IP exposes Redis instance to internet attacks.\",\n\t\t\"zh\": \"公网 IP 使 Redis 实例暴露于互联网攻击。\",\n\t\t\"ja\": \"パブリック IP により、Redis インスタンスがインターネット攻撃にさらされます。\",\n\t\t\"de\": \"Öffentliche IP setzt die Redis-Instanz Internetangriffen aus.\",\n\t\t\"es\": \"La IP pública expone la instancia Redis a ataques de internet.\",\n\t\t\"fr\": \"L'IP publique expose l'instance Redis aux attaques Internet.\",\n\t\t\"pt\": \"O IP público expõe a instância Redis a ataques da internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove public IP from the Redis instance.\",\n\t\t\"zh\": \"移除 Redis 实例的公网 IP。\",\n\t\t\"ja\": \"Redis インスタンスからパブリック IP を削除します。\",\n\t\t\"de\": \"Entfernen Sie die öffentliche IP von der Redis-Instanz.\",\n\t\t\"es\": \"Elimine la IP pública de la instancia Redis.\",\n\t\t\"fr\": \"Supprimez l'IP publique de l'instance Redis.\",\n\t\t\"pt\": \"Remova o IP público da instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\tconnections := helpers.get_property(resource, \"Connections\", {})\n\tobject.get(connections, \"PublicConnection\", null) == null\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Connections\", \"PublicConnection\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-open-auth-mode", Name: models.I18nString{"de": "Redis-Authentifizierungsmodus aktiviert", "en": "Redis Authentication Mode Enabled", "es": "Modo de Autenticación Redis Habilitado", "fr": "Mode d'Authentification Redis Activé", "ja": "Redis 認証モードが有効", "pt": "Modo de Autenticação Redis Habilitado", "zh": "Redis 强制开启认证模式"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Redis-Instanzen Authentifizierung erfordern und sich nicht im 'kein Passwort'-Modus befinden.", "en": "Ensures Redis instances require authentication and are not in 'no-password' mode.", "es": "Garantiza que las instancias Redis requieran autenticación y no estén en modo 'sin contraseña'.", "fr": "Garantit que les instances Redis nécessitent une authentification et ne sont pas en mode 'sans mot de passe'.", "ja": "Redis インスタンスが認証を必要とし、'パスワードなし'モードではないことを確認します。", "pt": "Garante que as instâncias Redis exijam autenticação e não estejam no modo 'sem senha'.", "zh": "确保 Redis 实例需要身份验证，且不处于'免密'模式。"}, Reason: models.I18nString{"de": "Das Deaktivieren der Authentifizierung ermöglicht es jedem mit Netzwerkzugriff, Ihre Redis-Daten zu lesen oder zu ändern.", "en": "Disabling authentication allows anyone with network access to read or modify your Redis data.", "es": "Deshabilitar la autenticación permite a cualquiera con acceso de red leer o modificar sus datos Redis.", "fr": "Désactiver l'authentification permet à quiconque ayant un accès réseau de lire ou modifier vos données Redis.", "ja": "認証を無効にすると、ネットワークアクセスを持つ誰でも Redis データを読み取りまたは変更できるようになります。", "pt": "Desabilitar a autenticação permite que qualquer pessoa com acesso à rede leia ou modifique seus dados Redis.", "zh": "禁用身份验证会允许任何拥有网络访问权限的人读取或修改您的 Redis 数据。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Passwortauthentifizierung für die Redis-Instanz.", "en": "Enable password authentication for the Redis instance.", "es": "Habilite la autenticación por contraseña para la instancia Redis.", "fr": "Activez l'authentification par mot de passe pour l'instance Redis.", "ja": "Redis インスタンスでパスワード認証を有効にします。", "pt": "Habilite a autenticação por senha para a instância Redis.", "zh": "为 Redis 实例启用密码身份验证。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-open-auth-mode.rego", PackageName: "infraguard.rules.aliyun.redis_instance_open_auth_mode", Content: "package infraguard.rules.aliyun.redis_instance_open_auth_mode\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"redis-instance-open-auth-mode\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Redis Authentication Mode Enabled\",\n\t\t\"zh\": \"Redis 强制开启认证模式\",\n\t\t\"ja\": \"Redis 認証モードが有効\",\n\t\t\"de\": \"Redis-Authentifizierungsmodus aktiviert\",\n\t\t\"es\": \"Modo de Autenticación Redis Habilitado\",\n\t\t\"fr\": \"Mode d'Authentification Redis Activé\",\n\t\t\"pt\": \"Modo de Autenticação Redis Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Redis instances require authentication and are not in 'no-password' mode.\",\n\t\t\"zh\": \"确保 Redis 实例需要身份验证，且不处于'免密'模式。\",\n\t\t\"ja\": \"Redis インスタンスが認証を必要とし、'パスワードなし'モードではないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Redis-Instanzen Authentifizierung erfordern und sich nicht im 'kein Passwort'-Modus befinden.\",\n\t\t\"es\": \"Garantiza que las instancias Redis requieran autenticación y no estén en modo 'sin contraseña'.\",\n\t\t\"fr\": \"Garantit que les instances Redis nécessitent une authentification et ne sont pas en mode 'sans mot de passe'.\",\n\t\t\"pt\": \"Garante que as instâncias Redis exijam autenticação e não estejam no modo 'sem senha'.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Disabling authentication allows anyone with network access to read or modify your Redis data.\",\n\t\t\"zh\": \"禁用身份验证会允许任何拥有网络访问权限的人读取或修改您的 Redis 数据。\",\n\t\t\"ja\": \"認証を無効にすると、ネットワークアクセスを持つ誰でも Redis データを読み取りまたは変更できるようになります。\",\n\t\t\"de\": \"Das Deaktivieren der Authentifizierung ermöglicht es jedem mit Netzwerkzugriff, Ihre Redis-Daten zu lesen oder zu ändern.\",\n\t\t\"es\": \"Deshabilitar la autenticación permite a cualquiera con acceso de red leer o modificar sus datos Redis.\",\n\t\t\"fr\": \"Désactiver l'authentification permet à quiconque ayant un accès réseau de lire ou modifier vos données Redis.\",\n\t\t\"pt\": \"Desabilitar a autenticação permite que qualquer pessoa com acesso à rede leia ou modifique seus dados Redis.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable password authentication for the Redis instance.\",\n\t\t\"zh\": \"为 Redis 实例启用密码身份验证。\",\n\t\t\"ja\": \"Redis インスタンスでパスワード認証を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Passwortauthentifizierung für die Redis-Instanz.\",\n\t\t\"es\": \"Habilite la autenticación por contraseña para la instancia Redis.\",\n\t\t\"fr\": \"Activez l'authentification par mot de passe pour l'instance Redis.\",\n\t\t\"pt\": \"Habilite a autenticação por senha para a instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\t# In ROS, password free mode is controlled by VpcPasswordFree\n\thelpers.is_false(helpers.get_property(resource, \"VpcPasswordFree\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcPasswordFree\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-release-protection", Name: models.I18nString{"de": "Redis-Instanz Freigabeschutz aktiviert", "en": "Redis Instance Release Protection Enabled", "es": "Protección contra Liberación de Instancia Redis Habilitada", "fr": "Protection contre la Libération d'Instance Redis Activée", "ja": "Redis インスタンスの解放保護が有効", "pt": "Proteção contra Liberação de Instância Redis Habilitada", "zh": "Redis 实例开启释放保护"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Redis-Instanzen Freigabeschutz aktiviert haben.", "en": "Ensures that Redis instances have release protection enabled.", "es": "Garantiza que las instancias Redis tengan protección contra liberación habilitada.", "fr": "Garantit que les instances Redis ont la protection contre la libération activée.", "ja": "Redis インスタンスで解放保護が有効になっていることを確認します。", "pt": "Garante que as instâncias Redis tenham proteção contra liberação habilitada.", "zh": "确保 Redis 实例开启了释放保护。"}, Reason: models.I18nString{"de": "Wenn der Freigabeschutz nicht aktiviert ist, kann die Redis-Instanz versehentlich freigegeben werden, was zu Dienstunterbrechungen führt.", "en": "If release protection is not enabled, the Redis instance may be released accidentally, causing service interruption.", "es": "Si la protección contra liberación no está habilitada, la instancia Redis puede ser liberada accidentalmente, causando interrupción del servicio.", "fr": "Si la protection contre la libération n'est pas activée, l'instance Redis peut être libérée accidentellement, causant une interruption de service.", "ja": "解放保護が有効になっていない場合、Redis インスタンスが誤って解放され、サービス中断が発生する可能性があります。", "pt": "Se a proteção contra liberação não estiver habilitada, a instância Redis pode ser liberada acidentalmente, causando interrupção do serviço.", "zh": "如果未开启释放保护，Redis 实例可能会被意外释放，导致业务中断。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Freigabeschutz für die Redis-Instanz.", "en": "Enable release protection for the Redis instance.", "es": "Habilite protección contra liberación para la instancia Redis.", "fr": "Activez la protection contre la libération pour l'instance Redis.", "ja": "Redis インスタンスで解放保護を有効にします。", "pt": "Habilite proteção contra liberação para a instância Redis.", "zh": "为 Redis 实例开启释放保护功能。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-release-protection.rego", PackageName: "infraguard.rules.aliyun.redis_instance_release_protection", Content: "package infraguard.rules.aliyun.redis_instance_release_protection\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-instance-release-protection\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance Release Protection Enabled\",\n\t\t\"zh\": \"Redis 实例开启释放保护\",\n\t\t\"ja\": \"Redis インスタンスの解放保護が有効\",\n\t\t\"de\": \"Redis-Instanz Freigabeschutz aktiviert\",\n\t\t\"es\": \"Protección contra Liberación de Instancia Redis Habilitada\",\n\t\t\"fr\": \"Protection contre la Libération d'Instance Redis Activée\",\n\t\t\"pt\": \"Proteção contra Liberação de Instância Redis Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Redis instances have release protection enabled.\",\n\t\t\"zh\": \"确保 Redis 实例开启了释放保护。\",\n\t\t\"ja\": \"Redis インスタンスで解放保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Redis-Instanzen Freigabeschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias Redis tengan protección contra liberación habilitada.\",\n\t\t\"fr\": \"Garantit que les instances Redis ont la protection contre la libération activée.\",\n\t\t\"pt\": \"Garante que as instâncias Redis tenham proteção contra liberação habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If release protection is not enabled, the Redis instance may be released accidentally, causing service interruption.\",\n\t\t\"zh\": \"如果未开启释放保护，Redis 实例可能会被意外释放，导致业务中断。\",\n\t\t\"ja\": \"解放保護が有効になっていない場合、Redis インスタンスが誤って解放され、サービス中断が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Freigabeschutz nicht aktiviert ist, kann die Redis-Instanz versehentlich freigegeben werden, was zu Dienstunterbrechungen führt.\",\n\t\t\"es\": \"Si la protección contra liberación no está habilitada, la instancia Redis puede ser liberada accidentalmente, causando interrupción del servicio.\",\n\t\t\"fr\": \"Si la protection contre la libération n'est pas activée, l'instance Redis peut être libérée accidentellement, causant une interruption de service.\",\n\t\t\"pt\": \"Se a proteção contra liberação não estiver habilitada, a instância Redis pode ser liberada acidentalmente, causando interrupção do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable release protection for the Redis instance.\",\n\t\t\"zh\": \"为 Redis 实例开启释放保护功能。\",\n\t\t\"ja\": \"Redis インスタンスで解放保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Freigabeschutz für die Redis-Instanz.\",\n\t\t\"es\": \"Habilite protección contra liberación para la instancia Redis.\",\n\t\t\"fr\": \"Activez la protection contre la libération pour l'instance Redis.\",\n\t\t\"pt\": \"Habilite proteção contra liberação para a instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-instance-tls-version-check", Name: models.I18nString{"de": "Redis-Instanz TLS-Versionsprüfung", "en": "Redis Instance TLS Version Check", "es": "Verificación de Versión TLS de Instancia Redis", "fr": "Vérification de Version TLS d'Instance Redis", "ja": "Redis インスタンス TLS バージョンチェック", "pt": "Verificação de Versão TLS de Instância Redis", "zh": "Redis 实例开启 SSL 并使用指定的 TLS 版本"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die Redis-Instanz SSL mit einer akzeptablen TLS-Version aktiviert hat.", "en": "Ensures Redis instance has SSL enabled with acceptable TLS version.", "es": "Garantiza que la instancia Redis tenga SSL habilitado con una versión TLS aceptable.", "fr": "Garantit que l'instance Redis a SSL activé avec une version TLS acceptable.", "ja": "Redis インスタンスで許容可能な TLS バージョンで SSL が有効になっていることを確認します。", "pt": "Garante que a instância Redis tenha SSL habilitado com uma versão TLS aceitável.", "zh": "确保 Redis 实例开启 SSL 且使用的 TLS 版本在可接受范围内。"}, Reason: models.I18nString{"de": "Die Verwendung starker TLS-Versionen gewährleistet sichere Kommunikation.", "en": "Using strong TLS versions ensures secure communication.", "es": "Usar versiones TLS fuertes garantiza una comunicación segura.", "fr": "L'utilisation de versions TLS fortes garantit une communication sécurisée.", "ja": "強力な TLS バージョンを使用することで、安全な通信が確保されます。", "pt": "Usar versões TLS fortes garante comunicação segura.", "zh": "使用强 TLS 版本确保通信安全。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie SSL mit empfohlener TLS-Version für Redis-Instanz.", "en": "Enable SSL with recommended TLS version for Redis instance.", "es": "Habilite SSL con la versión TLS recomendada para la instancia Redis.", "fr": "Activez SSL avec la version TLS recommandée pour l'instance Redis.", "ja": "Redis インスタンスで推奨 TLS バージョンで SSL を有効にします。", "pt": "Habilite SSL com a versão TLS recomendada para a instância Redis.", "zh": "为 Redis 实例启用 SSL 并使用推荐的 TLS 版本。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-instance-tls-version-check.rego", PackageName: "infraguard.rules.aliyun.redis_instance_tls_version_check", Content: "package infraguard.rules.aliyun.redis_instance_tls_version_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-instance-tls-version-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Instance TLS Version Check\",\n\t\t\"zh\": \"Redis 实例开启 SSL 并使用指定的 TLS 版本\",\n\t\t\"ja\": \"Redis インスタンス TLS バージョンチェック\",\n\t\t\"de\": \"Redis-Instanz TLS-Versionsprüfung\",\n\t\t\"es\": \"Verificación de Versión TLS de Instancia Redis\",\n\t\t\"fr\": \"Vérification de Version TLS d'Instance Redis\",\n\t\t\"pt\": \"Verificação de Versão TLS de Instância Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Redis instance has SSL enabled with acceptable TLS version.\",\n\t\t\"zh\": \"确保 Redis 实例开启 SSL 且使用的 TLS 版本在可接受范围内。\",\n\t\t\"ja\": \"Redis インスタンスで許容可能な TLS バージョンで SSL が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Redis-Instanz SSL mit einer akzeptablen TLS-Version aktiviert hat.\",\n\t\t\"es\": \"Garantiza que la instancia Redis tenga SSL habilitado con una versión TLS aceptable.\",\n\t\t\"fr\": \"Garantit que l'instance Redis a SSL activé avec une version TLS acceptable.\",\n\t\t\"pt\": \"Garante que a instância Redis tenha SSL habilitado com uma versão TLS aceitável.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using strong TLS versions ensures secure communication.\",\n\t\t\"zh\": \"使用强 TLS 版本确保通信安全。\",\n\t\t\"ja\": \"強力な TLS バージョンを使用することで、安全な通信が確保されます。\",\n\t\t\"de\": \"Die Verwendung starker TLS-Versionen gewährleistet sichere Kommunikation.\",\n\t\t\"es\": \"Usar versiones TLS fuertes garantiza una comunicación segura.\",\n\t\t\"fr\": \"L'utilisation de versions TLS fortes garantit une communication sécurisée.\",\n\t\t\"pt\": \"Usar versões TLS fortes garante comunicação segura.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable SSL with recommended TLS version for Redis instance.\",\n\t\t\"zh\": \"为 Redis 实例启用 SSL 并使用推荐的 TLS 版本。\",\n\t\t\"ja\": \"Redis インスタンスで推奨 TLS バージョンで SSL を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie SSL mit empfohlener TLS-Version für Redis-Instanz.\",\n\t\t\"es\": \"Habilite SSL con la versión TLS recomendada para la instancia Redis.\",\n\t\t\"fr\": \"Activez SSL avec la version TLS recommandée pour l'instance Redis.\",\n\t\t\"pt\": \"Habilite SSL com a versão TLS recomendada para a instância Redis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\tssl_enabled := helpers.get_property(resource, \"SSLEnabled\", \"Disable\")\n\tssl_enabled == \"Enable\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SSLEnabled\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-min-capacity-limit", Name: models.I18nString{"de": "Redis Mindestkapazitätsgrenze", "en": "Redis Min Capacity Limit", "es": "Límite de Capacidad Mínima de Redis", "fr": "Limite de Capacité Minimale Redis", "ja": "Redis 最小容量制限", "pt": "Limite de Capacidade Mínima do Redis", "zh": "Redis 实例满足指定内存容量要求"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die Redis-Instanz eine Speicherkapazität hat, die die Mindestanforderung erfüllt.", "en": "Ensures Redis instance has memory capacity meeting the minimum requirement.", "es": "Garantiza que la instancia Redis tenga capacidad de memoria que cumpla con el requisito mínimo.", "fr": "Garantit que l'instance Redis a une capacité mémoire répondant à l'exigence minimale.", "ja": "Redis インスタンスが最小要件を満たすメモリ容量を持っていることを確認します。", "pt": "Garante que a instância Redis tenha capacidade de memória que atenda ao requisito mínimo.", "zh": "确保 Redis 实例内存总量大于等于指定的参数值。"}, Reason: models.I18nString{"de": "Ausreichender Speicher stellt sicher, dass Redis die Arbeitslast bewältigen kann.", "en": "Adequate memory ensures Redis can handle the workload.", "es": "La memoria adecuada garantiza que Redis pueda manejar la carga de trabajo.", "fr": "Une mémoire adéquate garantit que Redis peut gérer la charge de travail.", "ja": "十分なメモリにより、Redis がワークロードを処理できることが保証されます。", "pt": "Memória adequada garante que o Redis possa lidar com a carga de trabalho.", "zh": "充足的内存确保 Redis 能够处理工作负载。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass die Redis-Instanz die mindestens erforderliche Speicherkapazität hat.", "en": "Ensure Redis instance has minimum required memory capacity.", "es": "Asegúrese de que la instancia Redis tenga la capacidad de memoria mínima requerida.", "fr": "Assurez-vous que l'instance Redis a la capacité mémoire minimale requise.", "ja": "Redis インスタンスが最小必要なメモリ容量を持っていることを確認します。", "pt": "Garanta que a instância Redis tenha a capacidade de memória mínima necessária.", "zh": "确保 Redis 实例满足最低内存容量要求。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-min-capacity-limit.rego", PackageName: "infraguard.rules.aliyun.redis_min_capacity_limit", Content: "package infraguard.rules.aliyun.redis_min_capacity_limit\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-min-capacity-limit\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Redis Min Capacity Limit\",\n\t\t\"zh\": \"Redis 实例满足指定内存容量要求\",\n\t\t\"ja\": \"Redis 最小容量制限\",\n\t\t\"de\": \"Redis Mindestkapazitätsgrenze\",\n\t\t\"es\": \"Límite de Capacidad Mínima de Redis\",\n\t\t\"fr\": \"Limite de Capacité Minimale Redis\",\n\t\t\"pt\": \"Limite de Capacidade Mínima do Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures Redis instance has memory capacity meeting the minimum requirement.\",\n\t\t\"zh\": \"确保 Redis 实例内存总量大于等于指定的参数值。\",\n\t\t\"ja\": \"Redis インスタンスが最小要件を満たすメモリ容量を持っていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Redis-Instanz eine Speicherkapazität hat, die die Mindestanforderung erfüllt.\",\n\t\t\"es\": \"Garantiza que la instancia Redis tenga capacidad de memoria que cumpla con el requisito mínimo.\",\n\t\t\"fr\": \"Garantit que l'instance Redis a une capacité mémoire répondant à l'exigence minimale.\",\n\t\t\"pt\": \"Garante que a instância Redis tenha capacidade de memória que atenda ao requisito mínimo.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Adequate memory ensures Redis can handle the workload.\",\n\t\t\"zh\": \"充足的内存确保 Redis 能够处理工作负载。\",\n\t\t\"ja\": \"十分なメモリにより、Redis がワークロードを処理できることが保証されます。\",\n\t\t\"de\": \"Ausreichender Speicher stellt sicher, dass Redis die Arbeitslast bewältigen kann.\",\n\t\t\"es\": \"La memoria adecuada garantiza que Redis pueda manejar la carga de trabajo.\",\n\t\t\"fr\": \"Une mémoire adéquate garantit que Redis peut gérer la charge de travail.\",\n\t\t\"pt\": \"Memória adequada garante que o Redis possa lidar com a carga de trabalho.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure Redis instance has minimum required memory capacity.\",\n\t\t\"zh\": \"确保 Redis 实例满足最低内存容量要求。\",\n\t\t\"ja\": \"Redis インスタンスが最小必要なメモリ容量を持っていることを確認します。\",\n\t\t\"de\": \"Stellen Sie sicher, dass die Redis-Instanz die mindestens erforderliche Speicherkapazität hat.\",\n\t\t\"es\": \"Asegúrese de que la instancia Redis tenga la capacidad de memoria mínima requerida.\",\n\t\t\"fr\": \"Assurez-vous que l'instance Redis a la capacité mémoire minimale requise.\",\n\t\t\"pt\": \"Garanta que a instância Redis tenha a capacidade de memória mínima necessária.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\tcapacity := helpers.get_property(resource, \"Capacity\", 1024)\n\tcapacity >= 1024\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Capacity\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:redis-public-and-any-ip-access-check", Name: models.I18nString{"de": "Redis öffentlicher und beliebiger IP-Zugriff-Prüfung", "en": "Redis Public and Any IP Access Check", "es": "Verificación de Acceso Público y de Cualquier IP de Redis", "fr": "Vérification d'Accès Public et de N'importe Quelle IP Redis", "ja": "Redis のパブリックおよび任意の IP アクセスチェック", "pt": "Verificação de Acesso Público e de Qualquer IP do Redis", "zh": "Redis 实例不开启公网或安全白名单不设置为允许任意来源访问"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass Redis-Instanzen keinen öffentlichen Zugriff aktiviert haben oder eine offene Whitelist haben.", "en": "Ensures that Redis instances do not have public access enabled or an open whitelist.", "es": "Garantiza que las instancias Redis no tengan acceso público habilitado o una lista blanca abierta.", "fr": "Garantit que les instances Redis n'ont pas d'accès public activé ou une liste blanche ouverte.", "ja": "Redis インスタンスでパブリックアクセスが有効になっていないか、オープンホワイトリストが設定されていないことを確認します。", "pt": "Garante que as instâncias Redis não tenham acesso público habilitado ou uma lista branca aberta.", "zh": "确保 Redis 实例未开启公网访问，或者白名单未设置为对所有 IP 开放。"}, Reason: models.I18nString{"de": "Öffentlicher Zugriff auf Redis ist ein schwerwiegendes Sicherheitsrisiko, da es häufig Ziel von Brute-Force-Angriffen und Datendiebstahl ist.", "en": "Public access to Redis is a severe security risk, as it is often targets for brute force attacks and data theft.", "es": "El acceso público a Redis es un riesgo de seguridad severo, ya que a menudo es objetivo de ataques de fuerza bruta y robo de datos.", "fr": "L'accès public à Redis est un risque de sécurité grave, car il est souvent la cible d'attaques par force brute et de vol de données.", "ja": "Redis へのパブリックアクセスは重大なセキュリティリスクであり、ブルートフォース攻撃やデータ窃取の標的となることがよくあります。", "pt": "O acesso público ao Redis é um risco de segurança severo, pois frequentemente é alvo de ataques de força bruta e roubo de dados.", "zh": "Redis 的公网访问是一个严重的安全风险，因为它经常成为暴力破解攻击和数据窃取的方目标。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie die öffentliche Verbindung für die Redis-Instanz und beschränken Sie den Zugriff über IP-Whitelists.", "en": "Disable public connection for the Redis instance and restrict access via IP whitelists.", "es": "Deshabilite la conexión pública para la instancia Redis y restrinja el acceso mediante listas blancas de IP.", "fr": "Désactivez la connexion publique pour l'instance Redis et restreignez l'accès via les listes blanches IP.", "ja": "Redis インスタンスのパブリック接続を無効にし、IP ホワイトリストを介してアクセスを制限します。", "pt": "Desabilite a conexão pública para a instância Redis e restrinja o acesso via listas brancas de IP.", "zh": "禁用 Redis 实例的公网连接，并通过 IP 白名单限制访问。"}, ResourceTypes: []string{"ALIYUN::REDIS::Instance"}, FilePath: "aliyun/rules/redis-public-and-any-ip-access-check.rego", PackageName: "infraguard.rules.aliyun.redis_public_and_any_ip_access_check", Content: "package infraguard.rules.aliyun.redis_public_and_any_ip_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"redis-public-and-any-ip-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Redis Public and Any IP Access Check\",\n\t\t\"zh\": \"Redis 实例不开启公网或安全白名单不设置为允许任意来源访问\",\n\t\t\"ja\": \"Redis のパブリックおよび任意の IP アクセスチェック\",\n\t\t\"de\": \"Redis öffentlicher und beliebiger IP-Zugriff-Prüfung\",\n\t\t\"es\": \"Verificación de Acceso Público y de Cualquier IP de Redis\",\n\t\t\"fr\": \"Vérification d'Accès Public et de N'importe Quelle IP Redis\",\n\t\t\"pt\": \"Verificação de Acesso Público e de Qualquer IP do Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Redis instances do not have public access enabled or an open whitelist.\",\n\t\t\"zh\": \"确保 Redis 实例未开启公网访问，或者白名单未设置为对所有 IP 开放。\",\n\t\t\"ja\": \"Redis インスタンスでパブリックアクセスが有効になっていないか、オープンホワイトリストが設定されていないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Redis-Instanzen keinen öffentlichen Zugriff aktiviert haben oder eine offene Whitelist haben.\",\n\t\t\"es\": \"Garantiza que las instancias Redis no tengan acceso público habilitado o una lista blanca abierta.\",\n\t\t\"fr\": \"Garantit que les instances Redis n'ont pas d'accès public activé ou une liste blanche ouverte.\",\n\t\t\"pt\": \"Garante que as instâncias Redis não tenham acesso público habilitado ou uma lista branca aberta.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Public access to Redis is a severe security risk, as it is often targets for brute force attacks and data theft.\",\n\t\t\"zh\": \"Redis 的公网访问是一个严重的安全风险，因为它经常成为暴力破解攻击和数据窃取的方目标。\",\n\t\t\"ja\": \"Redis へのパブリックアクセスは重大なセキュリティリスクであり、ブルートフォース攻撃やデータ窃取の標的となることがよくあります。\",\n\t\t\"de\": \"Öffentlicher Zugriff auf Redis ist ein schwerwiegendes Sicherheitsrisiko, da es häufig Ziel von Brute-Force-Angriffen und Datendiebstahl ist.\",\n\t\t\"es\": \"El acceso público a Redis es un riesgo de seguridad severo, ya que a menudo es objetivo de ataques de fuerza bruta y robo de datos.\",\n\t\t\"fr\": \"L'accès public à Redis est un risque de sécurité grave, car il est souvent la cible d'attaques par force brute et de vol de données.\",\n\t\t\"pt\": \"O acesso público ao Redis é um risco de segurança severo, pois frequentemente é alvo de ataques de força bruta e roubo de dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable public connection for the Redis instance and restrict access via IP whitelists.\",\n\t\t\"zh\": \"禁用 Redis 实例的公网连接，并通过 IP 白名单限制访问。\",\n\t\t\"ja\": \"Redis インスタンスのパブリック接続を無効にし、IP ホワイトリストを介してアクセスを制限します。\",\n\t\t\"de\": \"Deaktivieren Sie die öffentliche Verbindung für die Redis-Instanz und beschränken Sie den Zugriff über IP-Whitelists.\",\n\t\t\"es\": \"Deshabilite la conexión pública para la instancia Redis y restrinja el acceso mediante listas blancas de IP.\",\n\t\t\"fr\": \"Désactivez la connexion publique pour l'instance Redis et restreignez l'accès via les listes blanches IP.\",\n\t\t\"pt\": \"Desabilite a conexão pública para a instância Redis e restrinja o acesso via listas brancas de IP.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::REDIS::Instance\"]\n}\n\nis_compliant(resource) if {\n\t# Check Connections property\n\tconnections := helpers.get_property(resource, \"Connections\", {})\n\n\t# It is compliant if PublicConnection is NOT present\n\tobject.get(connections, \"PublicConnection\", null) == null\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::REDIS::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Connections\", \"PublicConnection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:rocketmq-v5-instance-multi-zone", Name: models.I18nString{"de": "RocketMQ 5.0 Instanz Multi-Zone-Bereitstellung", "en": "RocketMQ 5.0 Instance Multi-Zone Deployment", "es": "Despliegue Multi-Zona de Instancia RocketMQ 5.0", "fr": "Déploiement Multi-Zone d'Instance RocketMQ 5.0", "ja": "RocketMQ 5.0 インスタンスマルチゾーン展開", "pt": "Implantações Multi-Zona de Instância RocketMQ 5.0", "zh": "使用多可用区的消息队列 RocketMQ 5.0 版实例"}, Severity: "medium", Description: models.I18nString{"de": "RocketMQ 5.0-Instanzen sollten im Cluster-HA-Modus bereitgestellt werden, der Multi-Zone-Verfügbarkeit unterstützt.", "en": "RocketMQ 5.0 instances should be deployed in Cluster HA mode which supports multi-zone availability.", "es": "Las instancias RocketMQ 5.0 deben desplegarse en modo Cluster HA que admite disponibilidad multi-zona.", "fr": "Les instances RocketMQ 5.0 doivent être déployées en mode Cluster HA qui prend en charge la disponibilité multi-zone.", "ja": "RocketMQ 5.0 インスタンスは、マルチゾーン可用性をサポートする Cluster HA モードで展開する必要があります。", "pt": "As instâncias RocketMQ 5.0 devem ser implantadas no modo Cluster HA que suporta disponibilidade multi-zona.", "zh": "使用多可用区的消息队列 RocketMQ 5.0 版实例，视为合规。"}, Reason: models.I18nString{"de": "Die RocketMQ 5.0-Instanz ist nicht mit Cluster-HA-Modus konfiguriert.", "en": "The RocketMQ 5.0 instance is not configured with Cluster HA mode.", "es": "La instancia RocketMQ 5.0 no está configurada con modo Cluster HA.", "fr": "L'instance RocketMQ 5.0 n'est pas configurée en mode Cluster HA.", "ja": "RocketMQ 5.0 インスタンスが Cluster HA モードで設定されていません。", "pt": "A instância RocketMQ 5.0 não está configurada com modo Cluster HA.", "zh": "RocketMQ 5.0 实例未配置为高可用集群模式。"}, Recommendation: models.I18nString{"de": "Setzen Sie SubSeriesCode auf 'cluster_ha'.", "en": "Set SubSeriesCode to 'cluster_ha'.", "es": "Establezca SubSeriesCode en 'cluster_ha'.", "fr": "Définissez SubSeriesCode sur 'cluster_ha'.", "ja": "SubSeriesCode を 'cluster_ha' に設定します。", "pt": "Defina SubSeriesCode como 'cluster_ha'.", "zh": "将 SubSeriesCode 设置为'cluster_ha'。"}, ResourceTypes: []string{"ALIYUN::ROCKETMQ5::Instance"}, FilePath: "aliyun/rules/rocketmq-v5-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.rocketmq_v5_instance_multi_zone", Content: "package infraguard.rules.aliyun.rocketmq_v5_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"rocketmq-v5-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"RocketMQ 5.0 Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的消息队列 RocketMQ 5.0 版实例\",\n\t\t\"ja\": \"RocketMQ 5.0 インスタンスマルチゾーン展開\",\n\t\t\"de\": \"RocketMQ 5.0 Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Despliegue Multi-Zona de Instancia RocketMQ 5.0\",\n\t\t\"fr\": \"Déploiement Multi-Zone d'Instance RocketMQ 5.0\",\n\t\t\"pt\": \"Implantações Multi-Zona de Instância RocketMQ 5.0\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"RocketMQ 5.0 instances should be deployed in Cluster HA mode which supports multi-zone availability.\",\n\t\t\"zh\": \"使用多可用区的消息队列 RocketMQ 5.0 版实例，视为合规。\",\n\t\t\"ja\": \"RocketMQ 5.0 インスタンスは、マルチゾーン可用性をサポートする Cluster HA モードで展開する必要があります。\",\n\t\t\"de\": \"RocketMQ 5.0-Instanzen sollten im Cluster-HA-Modus bereitgestellt werden, der Multi-Zone-Verfügbarkeit unterstützt.\",\n\t\t\"es\": \"Las instancias RocketMQ 5.0 deben desplegarse en modo Cluster HA que admite disponibilidad multi-zona.\",\n\t\t\"fr\": \"Les instances RocketMQ 5.0 doivent être déployées en mode Cluster HA qui prend en charge la disponibilité multi-zone.\",\n\t\t\"pt\": \"As instâncias RocketMQ 5.0 devem ser implantadas no modo Cluster HA que suporta disponibilidade multi-zona.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The RocketMQ 5.0 instance is not configured with Cluster HA mode.\",\n\t\t\"zh\": \"RocketMQ 5.0 实例未配置为高可用集群模式。\",\n\t\t\"ja\": \"RocketMQ 5.0 インスタンスが Cluster HA モードで設定されていません。\",\n\t\t\"de\": \"Die RocketMQ 5.0-Instanz ist nicht mit Cluster-HA-Modus konfiguriert.\",\n\t\t\"es\": \"La instancia RocketMQ 5.0 no está configurada con modo Cluster HA.\",\n\t\t\"fr\": \"L'instance RocketMQ 5.0 n'est pas configurée en mode Cluster HA.\",\n\t\t\"pt\": \"A instância RocketMQ 5.0 não está configurada com modo Cluster HA.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set SubSeriesCode to 'cluster_ha'.\",\n\t\t\"zh\": \"将 SubSeriesCode 设置为'cluster_ha'。\",\n\t\t\"ja\": \"SubSeriesCode を 'cluster_ha' に設定します。\",\n\t\t\"de\": \"Setzen Sie SubSeriesCode auf 'cluster_ha'.\",\n\t\t\"es\": \"Establezca SubSeriesCode en 'cluster_ha'.\",\n\t\t\"fr\": \"Définissez SubSeriesCode sur 'cluster_ha'.\",\n\t\t\"pt\": \"Defina SubSeriesCode como 'cluster_ha'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ROCKETMQ5::Instance\"]\n}\n\n# Check if instance is multi-zone (cluster_ha)\nis_multi_zone(resource) if {\n\tresource.Properties.SubSeriesCode == \"cluster_ha\"\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SubSeriesCode\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:root-ak-check", Name: models.I18nString{"de": "Root-Benutzer AccessKey-Prüfung", "en": "Root User AccessKey Check", "es": "Verificación de AccessKey de Usuario Root", "fr": "Vérification de la Clé d'Accès Utilisateur Root", "ja": "ルートユーザー AccessKey チェック", "pt": "Verificação de AccessKey do Usuário Root", "zh": "主账号 AccessKey 检测"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass das Root-Konto keine aktiven AccessKeys hat.", "en": "Ensures that the root account does not have active AccessKeys.", "es": "Garantiza que la cuenta root no tenga AccessKeys activos.", "fr": "Garantit que le compte root n'a pas de clés d'accès actives.", "ja": "ルートアカウントにアクティブな AccessKey がないことを確認します。", "pt": "Garante que a conta root não possui AccessKeys ativos.", "zh": "确保主账号没有激活的 AccessKey。"}, Reason: models.I18nString{"de": "Die Verwendung von AccessKeys für das Root-Konto ist ein Sicherheitsrisiko. Stattdessen sollten IAM-Rollen oder RAM-Benutzer-AccessKeys verwendet werden.", "en": "Using AccessKeys for the root account is a security risk. IAM roles or RAM user AccessKeys should be used instead.", "es": "Usar AccessKeys para la cuenta root es un riesgo de seguridad. En su lugar, se deben usar roles IAM o AccessKeys de usuario RAM.", "fr": "Utiliser des clés d'accès pour le compte root est un risque de sécurité. Des rôles IAM ou des clés d'accès utilisateur RAM doivent être utilisés à la place.", "ja": "ルートアカウントに AccessKey を使用することはセキュリティリスクです。代わりに IAM ロールまたは RAM ユーザー AccessKey を使用する必要があります。", "pt": "Usar AccessKeys para a conta root é um risco de segurança. Em vez disso, devem ser usadas funções IAM ou AccessKeys de usuário RAM.", "zh": "为主账号使用 AccessKey 存在安全风险。应改为使用 RAM 角色或 RAM 用户 AccessKey。"}, Recommendation: models.I18nString{"de": "Löschen Sie alle mit dem Root-Konto verknüpften AccessKeys und verwenden Sie RAM-Benutzer oder Rollen.", "en": "Delete any AccessKeys associated with the root account and use RAM users or roles.", "es": "Elimine cualquier AccessKey asociado con la cuenta root y use usuarios o roles RAM.", "fr": "Supprimez toutes les clés d'accès associées au compte root et utilisez des utilisateurs ou des rôles RAM.", "ja": "ルートアカウントに関連付けられているすべての AccessKey を削除し、RAM ユーザーまたはロールを使用します。", "pt": "Exclua quaisquer AccessKeys associados à conta root e use usuários ou funções RAM.", "zh": "删除主账号的所有 AccessKey，并使用 RAM 用户或角色。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/root-ak-check.rego", PackageName: "infraguard.rules.aliyun.root_ak_check", Content: "package infraguard.rules.aliyun.root_ak_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"root-ak-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Root User AccessKey Check\",\n\t\t\"zh\": \"主账号 AccessKey 检测\",\n\t\t\"ja\": \"ルートユーザー AccessKey チェック\",\n\t\t\"de\": \"Root-Benutzer AccessKey-Prüfung\",\n\t\t\"es\": \"Verificación de AccessKey de Usuario Root\",\n\t\t\"fr\": \"Vérification de la Clé d'Accès Utilisateur Root\",\n\t\t\"pt\": \"Verificação de AccessKey do Usuário Root\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the root account does not have active AccessKeys.\",\n\t\t\"zh\": \"确保主账号没有激活的 AccessKey。\",\n\t\t\"ja\": \"ルートアカウントにアクティブな AccessKey がないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass das Root-Konto keine aktiven AccessKeys hat.\",\n\t\t\"es\": \"Garantiza que la cuenta root no tenga AccessKeys activos.\",\n\t\t\"fr\": \"Garantit que le compte root n'a pas de clés d'accès actives.\",\n\t\t\"pt\": \"Garante que a conta root não possui AccessKeys ativos.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using AccessKeys for the root account is a security risk. IAM roles or RAM user AccessKeys should be used instead.\",\n\t\t\"zh\": \"为主账号使用 AccessKey 存在安全风险。应改为使用 RAM 角色或 RAM 用户 AccessKey。\",\n\t\t\"ja\": \"ルートアカウントに AccessKey を使用することはセキュリティリスクです。代わりに IAM ロールまたは RAM ユーザー AccessKey を使用する必要があります。\",\n\t\t\"de\": \"Die Verwendung von AccessKeys für das Root-Konto ist ein Sicherheitsrisiko. Stattdessen sollten IAM-Rollen oder RAM-Benutzer-AccessKeys verwendet werden.\",\n\t\t\"es\": \"Usar AccessKeys para la cuenta root es un riesgo de seguridad. En su lugar, se deben usar roles IAM o AccessKeys de usuario RAM.\",\n\t\t\"fr\": \"Utiliser des clés d'accès pour le compte root est un risque de sécurité. Des rôles IAM ou des clés d'accès utilisateur RAM doivent être utilisés à la place.\",\n\t\t\"pt\": \"Usar AccessKeys para a conta root é um risco de segurança. Em vez disso, devem ser usadas funções IAM ou AccessKeys de usuário RAM.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Delete any AccessKeys associated with the root account and use RAM users or roles.\",\n\t\t\"zh\": \"删除主账号的所有 AccessKey，并使用 RAM 用户或角色。\",\n\t\t\"ja\": \"ルートアカウントに関連付けられているすべての AccessKey を削除し、RAM ユーザーまたはロールを使用します。\",\n\t\t\"de\": \"Löschen Sie alle mit dem Root-Konto verknüpften AccessKeys und verwenden Sie RAM-Benutzer oder Rollen.\",\n\t\t\"es\": \"Elimine cualquier AccessKey asociado con la cuenta root y use usuarios o roles RAM.\",\n\t\t\"fr\": \"Supprimez toutes les clés d'accès associées au compte root et utilisez des utilisateurs ou des rôles RAM.\",\n\t\t\"pt\": \"Exclua quaisquer AccessKeys associados à conta root e use usuários ou funções RAM.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\tname == \"root\"\n\thelpers.has_property(resource, \"AccessKey\") # Conceptual check\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AccessKey\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:root-has-specified-role", Name: models.I18nString{"de": "Root-Konto hat angegebene Rolle", "en": "Root Account Has Specified Role", "es": "La Cuenta Raíz Tiene Rol Especificado", "fr": "Le Compte Racine a un Rôle Spécifié", "ja": "ルートアカウントに指定されたロールがある", "pt": "A Conta Raiz Tem Função Especificada", "zh": "主账号具有指定的角色"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass das Root-Konto eine angegebene RAM-Rolle für Governance und Verwaltung hat.", "en": "Ensures that the root account has a specified RAM role for governance and management.", "es": "Garantiza que la cuenta raíz tenga un rol RAM especificado para gobernanza y gestión.", "fr": "Garantit que le compte racine a un rôle RAM spécifié pour la gouvernance et la gestion.", "ja": "ルートアカウントがガバナンスと管理のための指定された RAM ロールを持っていることを確認します。", "pt": "Garante que a conta raiz tenha uma função RAM especificada para governança e gerenciamento.", "zh": "确保主账号具有用于治理和管理的指定 RAM 角色。"}, Reason: models.I18nString{"de": "Spezifische Rollen sind erforderlich, damit Cloud-Governance- und Verwaltungstools korrekt funktionieren.", "en": "Specific roles are required for cloud governance and management tools to function correctly.", "es": "Se requieren roles específicos para que las herramientas de gobernanza y gestión en la nube funcionen correctamente.", "fr": "Des rôles spécifiques sont requis pour que les outils de gouvernance et de gestion cloud fonctionnent correctement.", "ja": "クラウドガバナンスと管理ツールが正常に機能するには、特定のロールが必要です。", "pt": "Funções específicas são necessárias para que as ferramentas de governança e gerenciamento em nuvem funcionem corretamente.", "zh": "云治理和管理工具需要特定的角色才能正常运行。"}, Recommendation: models.I18nString{"de": "Erstellen und weisen Sie die angegebene RAM-Rolle dem Root-Konto zu.", "en": "Create and assign the specified RAM role to the root account.", "es": "Cree y asigne el rol RAM especificado a la cuenta raíz.", "fr": "Créez et assignez le rôle RAM spécifié au compte racine.", "ja": "指定された RAM ロールを作成し、ルートアカウントに割り当てます。", "pt": "Crie e atribua a função RAM especificada à conta raiz.", "zh": "创建并为主账号分配指定的 RAM 角色。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/root-has-specified-role.rego", PackageName: "infraguard.rules.aliyun.root_has_specified_role", Content: "package infraguard.rules.aliyun.root_has_specified_role\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"root-has-specified-role\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"Root Account Has Specified Role\",\n\t\t\"zh\": \"主账号具有指定的角色\",\n\t\t\"ja\": \"ルートアカウントに指定されたロールがある\",\n\t\t\"de\": \"Root-Konto hat angegebene Rolle\",\n\t\t\"es\": \"La Cuenta Raíz Tiene Rol Especificado\",\n\t\t\"fr\": \"Le Compte Racine a un Rôle Spécifié\",\n\t\t\"pt\": \"A Conta Raiz Tem Função Especificada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the root account has a specified RAM role for governance and management.\",\n\t\t\"zh\": \"确保主账号具有用于治理和管理的指定 RAM 角色。\",\n\t\t\"ja\": \"ルートアカウントがガバナンスと管理のための指定された RAM ロールを持っていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass das Root-Konto eine angegebene RAM-Rolle für Governance und Verwaltung hat.\",\n\t\t\"es\": \"Garantiza que la cuenta raíz tenga un rol RAM especificado para gobernanza y gestión.\",\n\t\t\"fr\": \"Garantit que le compte racine a un rôle RAM spécifié pour la gouvernance et la gestion.\",\n\t\t\"pt\": \"Garante que a conta raiz tenha uma função RAM especificada para governança e gerenciamento.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Specific roles are required for cloud governance and management tools to function correctly.\",\n\t\t\"zh\": \"云治理和管理工具需要特定的角色才能正常运行。\",\n\t\t\"ja\": \"クラウドガバナンスと管理ツールが正常に機能するには、特定のロールが必要です。\",\n\t\t\"de\": \"Spezifische Rollen sind erforderlich, damit Cloud-Governance- und Verwaltungstools korrekt funktionieren.\",\n\t\t\"es\": \"Se requieren roles específicos para que las herramientas de gobernanza y gestión en la nube funcionen correctamente.\",\n\t\t\"fr\": \"Des rôles spécifiques sont requis pour que les outils de gouvernance et de gestion cloud fonctionnent correctement.\",\n\t\t\"pt\": \"Funções específicas são necessárias para que as ferramentas de governança e gerenciamento em nuvem funcionem corretamente.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Create and assign the specified RAM role to the root account.\",\n\t\t\"zh\": \"创建并为主账号分配指定的 RAM 角色。\",\n\t\t\"ja\": \"指定された RAM ロールを作成し、ルートアカウントに割り当てます。\",\n\t\t\"de\": \"Erstellen und weisen Sie die angegebene RAM-Rolle dem Root-Konto zu.\",\n\t\t\"es\": \"Cree y asigne el rol RAM especificado a la cuenta raíz.\",\n\t\t\"fr\": \"Créez et assignez le rôle RAM spécifié au compte racine.\",\n\t\t\"pt\": \"Crie e atribua a função RAM especificada à conta raiz.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\tname == \"root\"\n\tnot helpers.has_property(resource, \"SpecifiedRole\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:root-mfa-check", Name: models.I18nString{"de": "Root-Benutzer MFA-Prüfung", "en": "Root User MFA Check", "es": "Verificación de MFA de Usuario Root", "fr": "Vérification MFA Utilisateur Root", "ja": "ルートユーザー MFA チェック", "pt": "Verificação de MFA do Usuário Root", "zh": "主账号 MFA 检测"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass die Multi-Faktor-Authentifizierung (MFA) für das Root-Konto aktiviert ist.", "en": "Ensures that Multi-Factor Authentication (MFA) is enabled for the root account.", "es": "Garantiza que la autenticación multifactor (MFA) esté habilitada para la cuenta root.", "fr": "Garantit que l'authentification multifacteur (MFA) est activée pour le compte root.", "ja": "ルートアカウントで多要素認証（MFA）が有効になっていることを確認します。", "pt": "Garante que a autenticação multifator (MFA) está habilitada para a conta root.", "zh": "确保主账号已开启多因素认证(MFA)。"}, Reason: models.I18nString{"de": "MFA bietet eine zusätzliche Sicherheitsebene für das privilegierteste Konto in der Cloud-Umgebung.", "en": "MFA provides an extra layer of security for the most privileged account in the cloud environment.", "es": "MFA proporciona una capa adicional de seguridad para la cuenta con más privilegios en el entorno en la nube.", "fr": "MFA fournit une couche supplémentaire de sécurité pour le compte le plus privilégié dans l'environnement cloud.", "ja": "MFA は、クラウド環境で最も権限の高いアカウントに追加のセキュリティ層を提供します。", "pt": "O MFA fornece uma camada extra de segurança para a conta mais privilegiada no ambiente em nuvem.", "zh": "MFA 为云环境中最具特权的账号提供了额外的安全层。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie MFA für das Alibaba Cloud Root-Konto.", "en": "Enable MFA for the Alibaba Cloud root account.", "es": "Habilite MFA para la cuenta root de Alibaba Cloud.", "fr": "Activez MFA pour le compte root d'Alibaba Cloud.", "ja": "Alibaba Cloud ルートアカウントで MFA を有効にします。", "pt": "Habilite MFA para a conta root do Alibaba Cloud.", "zh": "为阿里云主账号开启 MFA。"}, ResourceTypes: []string{"ALIYUN::RAM::User"}, FilePath: "aliyun/rules/root-mfa-check.rego", PackageName: "infraguard.rules.aliyun.root_mfa_check", Content: "package infraguard.rules.aliyun.root_mfa_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"root-mfa-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Root User MFA Check\",\n\t\t\"zh\": \"主账号 MFA 检测\",\n\t\t\"ja\": \"ルートユーザー MFA チェック\",\n\t\t\"de\": \"Root-Benutzer MFA-Prüfung\",\n\t\t\"es\": \"Verificación de MFA de Usuario Root\",\n\t\t\"fr\": \"Vérification MFA Utilisateur Root\",\n\t\t\"pt\": \"Verificação de MFA do Usuário Root\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that Multi-Factor Authentication (MFA) is enabled for the root account.\",\n\t\t\"zh\": \"确保主账号已开启多因素认证(MFA)。\",\n\t\t\"ja\": \"ルートアカウントで多要素認証（MFA）が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Multi-Faktor-Authentifizierung (MFA) für das Root-Konto aktiviert ist.\",\n\t\t\"es\": \"Garantiza que la autenticación multifactor (MFA) esté habilitada para la cuenta root.\",\n\t\t\"fr\": \"Garantit que l'authentification multifacteur (MFA) est activée pour le compte root.\",\n\t\t\"pt\": \"Garante que a autenticação multifator (MFA) está habilitada para a conta root.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"MFA provides an extra layer of security for the most privileged account in the cloud environment.\",\n\t\t\"zh\": \"MFA 为云环境中最具特权的账号提供了额外的安全层。\",\n\t\t\"ja\": \"MFA は、クラウド環境で最も権限の高いアカウントに追加のセキュリティ層を提供します。\",\n\t\t\"de\": \"MFA bietet eine zusätzliche Sicherheitsebene für das privilegierteste Konto in der Cloud-Umgebung.\",\n\t\t\"es\": \"MFA proporciona una capa adicional de seguridad para la cuenta con más privilegios en el entorno en la nube.\",\n\t\t\"fr\": \"MFA fournit une couche supplémentaire de sécurité pour le compte le plus privilégié dans l'environnement cloud.\",\n\t\t\"pt\": \"O MFA fornece uma camada extra de segurança para a conta mais privilegiada no ambiente em nuvem.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable MFA for the Alibaba Cloud root account.\",\n\t\t\"zh\": \"为阿里云主账号开启 MFA。\",\n\t\t\"ja\": \"Alibaba Cloud ルートアカウントで MFA を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie MFA für das Alibaba Cloud Root-Konto.\",\n\t\t\"es\": \"Habilite MFA para la cuenta root de Alibaba Cloud.\",\n\t\t\"fr\": \"Activez MFA pour le compte root d'Alibaba Cloud.\",\n\t\t\"pt\": \"Habilite MFA para a conta root do Alibaba Cloud.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::RAM::User\"]\n}\n\n# Conceptual check for root MFA\n# In practice, this might be a placeholder or check a specific global configuration if available\ndeny contains result if {\n\t# This is a conceptual rule, let's assume we check if any user has MFA enabled\n\t# or if there's a specific flag. For now, it's a placeholder implementation.\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::RAM::User\")\n\tname == \"root\"\n\tnot helpers.get_property(resource, \"MFAEnabled\", false)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"MFAEnabled\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:security-center-version-check", Name: models.I18nString{"de": "Sicherheitszentrum Versionsprüfung", "en": "Security Center Version Check", "es": "Verificación de Versión del Centro de Seguridad", "fr": "Vérification de Version du Centre de Sécurité", "ja": "セキュリティセンターのバージョンチェック", "pt": "Verificação de Versão do Centro de Segurança", "zh": "云安全中心版本检测"}, Severity: "medium", Description: models.I18nString{"de": "Das Sicherheitszentrum sollte eine Version sein, die ausreichende Schutzfunktionen bietet.", "en": "Security Center should be at a version that provides sufficient protection features.", "es": "El Centro de Seguridad debe estar en una versión que proporcione funciones de protección suficientes.", "fr": "Le Centre de Sécurité doit être à une version qui fournit des fonctionnalités de protection suffisantes.", "ja": "セキュリティセンターは、十分な保護機能を提供するバージョンである必要があります。", "pt": "O Centro de Segurança deve estar em uma versão que forneça recursos de proteção suficientes.", "zh": "云安全中心版本满足要求，视为合规。"}, Reason: models.I18nString{"de": "Eine niedrigere Version des Sicherheitszentrums bietet möglicherweise keine erweiterten Bedrohungserkennungs- und Schutzfunktionen.", "en": "A lower version of Security Center may not provide advanced threat detection and protection capabilities.", "es": "Una versión inferior del Centro de Seguridad puede no proporcionar capacidades avanzadas de detección y protección de amenazas.", "fr": "Une version inférieure du Centre de Sécurité peut ne pas fournir de capacités avancées de détection et de protection contre les menaces.", "ja": "セキュリティセンターの低いバージョンでは、高度な脅威検出と保護機能が提供されない可能性があります。", "pt": "Uma versão inferior do Centro de Segurança pode não fornecer capacidades avançadas de detecção e proteção contra ameaças.", "zh": "较低版本的云安全中心可能无法提供先进的威胁检测和防御能力。"}, Recommendation: models.I18nString{"de": "Aktualisieren Sie das Sicherheitszentrum auf eine höhere Version (z. B. Enterprise oder Ultimate).", "en": "Upgrade Security Center to a higher version (e.g., Enterprise or Ultimate).", "es": "Actualice el Centro de Seguridad a una versión superior (por ejemplo, Enterprise o Ultimate).", "fr": "Mettez à niveau le Centre de Sécurité vers une version supérieure (par exemple, Enterprise ou Ultimate).", "ja": "セキュリティセンターをより高いバージョン（例：エンタープライズ版またはアルティメット版）にアップグレードします。", "pt": "Atualize o Centro de Segurança para uma versão superior (por exemplo, Enterprise ou Ultimate).", "zh": "将云安全中心升级到更高版本（如企业版或旗舰版）。"}, ResourceTypes: []string{"ALIYUN::ThreatDetection::Instance"}, FilePath: "aliyun/rules/security-center-version-check.rego", PackageName: "infraguard.rules.aliyun.security_center_version_check", Content: "package infraguard.rules.aliyun.security_center_version_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"security-center-version-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"Security Center Version Check\",\n\t\t\"zh\": \"云安全中心版本检测\",\n\t\t\"ja\": \"セキュリティセンターのバージョンチェック\",\n\t\t\"de\": \"Sicherheitszentrum Versionsprüfung\",\n\t\t\"es\": \"Verificación de Versión del Centro de Seguridad\",\n\t\t\"fr\": \"Vérification de Version du Centre de Sécurité\",\n\t\t\"pt\": \"Verificação de Versão do Centro de Segurança\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Security Center should be at a version that provides sufficient protection features.\",\n\t\t\"zh\": \"云安全中心版本满足要求，视为合规。\",\n\t\t\"ja\": \"セキュリティセンターは、十分な保護機能を提供するバージョンである必要があります。\",\n\t\t\"de\": \"Das Sicherheitszentrum sollte eine Version sein, die ausreichende Schutzfunktionen bietet.\",\n\t\t\"es\": \"El Centro de Seguridad debe estar en una versión que proporcione funciones de protección suficientes.\",\n\t\t\"fr\": \"Le Centre de Sécurité doit être à une version qui fournit des fonctionnalités de protection suffisantes.\",\n\t\t\"pt\": \"O Centro de Segurança deve estar em uma versão que forneça recursos de proteção suficientes.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"A lower version of Security Center may not provide advanced threat detection and protection capabilities.\",\n\t\t\"zh\": \"较低版本的云安全中心可能无法提供先进的威胁检测和防御能力。\",\n\t\t\"ja\": \"セキュリティセンターの低いバージョンでは、高度な脅威検出と保護機能が提供されない可能性があります。\",\n\t\t\"de\": \"Eine niedrigere Version des Sicherheitszentrums bietet möglicherweise keine erweiterten Bedrohungserkennungs- und Schutzfunktionen.\",\n\t\t\"es\": \"Una versión inferior del Centro de Seguridad puede no proporcionar capacidades avanzadas de detección y protección de amenazas.\",\n\t\t\"fr\": \"Une version inférieure du Centre de Sécurité peut ne pas fournir de capacités avancées de détection et de protection contre les menaces.\",\n\t\t\"pt\": \"Uma versão inferior do Centro de Segurança pode não fornecer capacidades avançadas de detecção e proteção contra ameaças.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Upgrade Security Center to a higher version (e.g., Enterprise or Ultimate).\",\n\t\t\"zh\": \"将云安全中心升级到更高版本（如企业版或旗舰版）。\",\n\t\t\"ja\": \"セキュリティセンターをより高いバージョン（例：エンタープライズ版またはアルティメット版）にアップグレードします。\",\n\t\t\"de\": \"Aktualisieren Sie das Sicherheitszentrum auf eine höhere Version (z. B. Enterprise oder Ultimate).\",\n\t\t\"es\": \"Actualice el Centro de Seguridad a una versión superior (por ejemplo, Enterprise o Ultimate).\",\n\t\t\"fr\": \"Mettez à niveau le Centre de Sécurité vers une version supérieure (par exemple, Enterprise ou Ultimate).\",\n\t\t\"pt\": \"Atualize o Centro de Segurança para uma versão superior (por exemplo, Enterprise ou Ultimate).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ThreatDetection::Instance\"]\n}\n\n# VersionCode values:\n# level2: Enterprise Edition\n# level3: Premium version\n# level7: Antivirus Edition\n# level8: Ultimate\n# level10: Purchase value-added services only\n\nis_compliant_version(resource) if {\n\tversion := helpers.get_property(resource, \"VersionCode\", \"\")\n\tversion == \"level3\" # Premium version\n}\n\nis_compliant_version(resource) if {\n\tversion := helpers.get_property(resource, \"VersionCode\", \"\")\n\tversion == \"level8\" # Ultimate\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_compliant_version(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VersionCode\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:sg-public-access-check", Name: models.I18nString{"de": "Sicherheitsgruppe Ingress gültig", "en": "Security Group Ingress Valid", "es": "Ingress de Grupo de Seguridad Válido", "fr": "Ingress du Groupe de Sécurité Valide", "ja": "セキュリティグループイングレスが有効", "pt": "Ingress de Grupo de Segurança Válido", "zh": "安全组入网设置有效"}, Severity: "high", Description: models.I18nString{"de": "Sicherheitsgruppen-Ingress-Regeln sollten nicht gleichzeitig alle Ports (-1/-1) von allen Quellen (0.0.0.0/0) erlauben.", "en": "Security group ingress rules should not allow all ports (-1/-1) from all sources (0.0.0.0/0) simultaneously.", "es": "Las reglas de ingreso del grupo de seguridad no deben permitir todos los puertos (-1/-1) desde todas las fuentes (0.0.0.0/0) simultáneamente.", "fr": "Les règles d'ingress du groupe de sécurité ne doivent pas autoriser tous les ports (-1/-1) depuis toutes les sources (0.0.0.0/0) simultanément.", "ja": "セキュリティグループのイングレスルールは、すべてのソース（0.0.0.0/0）からすべてのポート（-1/-1）を同時に許可すべきではありません。", "pt": "As regras de ingresso do grupo de segurança não devem permitir todas as portas (-1/-1) de todas as fontes (0.0.0.0/0) simultaneamente.", "zh": "安全组入方向授权策略为允许，当端口范围-1/-1 和授权对象 0.0.0.0/0 未同时出现，或者被优先级更高的授权策略拒绝，视为合规。"}, Reason: models.I18nString{"de": "Die Sicherheitsgruppe hat eine Ingress-Regel, die alle Ports von allen Quellen (0.0.0.0/0 mit Portbereich -1/-1) erlaubt, was ein kritisches Sicherheitsrisiko darstellt.", "en": "The security group has an ingress rule that allows all ports from all sources (0.0.0.0/0 with port range -1/-1), which poses a critical security risk.", "es": "El grupo de seguridad tiene una regla de ingreso que permite todos los puertos desde todas las fuentes (0.0.0.0/0 con rango de puertos -1/-1), lo que plantea un riesgo de seguridad crítico.", "fr": "Le groupe de sécurité a une règle d'ingress qui autorise tous les ports depuis toutes les sources (0.0.0.0/0 avec plage de ports -1/-1), ce qui pose un risque de sécurité critique.", "ja": "セキュリティグループに、すべてのソース（ポート範囲 -1/-1 の 0.0.0.0/0）からすべてのポートを許可するイングレスルールがあり、重大なセキュリティリスクをもたらします。", "pt": "O grupo de segurança tem uma regra de ingresso que permite todas as portas de todas as fontes (0.0.0.0/0 com intervalo de portas -1/-1), o que representa um risco de segurança crítico.", "zh": "安全组有一条入网规则同时允许所有端口（-1/-1）和所有来源（0.0.0.0/0），存在严重安全风险。"}, Recommendation: models.I18nString{"de": "Beschränken Sie entweder den Quell-IP-Bereich auf spezifische CIDR-Blöcke oder begrenzen Sie den Portbereich auf spezifische Ports basierend auf tatsächlichen Geschäftsanforderungen.", "en": "Either restrict the source IP range to specific CIDR blocks or limit the port range to specific ports based on actual business requirements.", "es": "Restrinja el rango de IP de origen a bloques CIDR específicos o limite el rango de puertos a puertos específicos según los requisitos comerciales reales.", "fr": "Restreignez soit la plage d'IP source à des blocs CIDR spécifiques, soit limitez la plage de ports à des ports spécifiques en fonction des exigences commerciales réelles.", "ja": "実際のビジネス要件に基づいて、ソース IP 範囲を特定の CIDR ブロックに制限するか、ポート範囲を特定のポートに制限します。", "pt": "Restrinja o intervalo de IP de origem a blocos CIDR específicos ou limite o intervalo de portas a portas específicas com base nos requisitos comerciais reais.", "zh": "根据实际业务需求，将来源 IP 范围限制为特定的 CIDR 块，或将端口范围限制为特定的端口。"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup", "ALIYUN::ECS::SecurityGroupIngress", "ALIYUN::ECS::SecurityGroupIngresses"}, FilePath: "aliyun/rules/sg-public-access-check.rego", PackageName: "infraguard.rules.aliyun.sg_public_access_check", Content: "package infraguard.rules.aliyun.sg_public_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata with i18n support\nrule_meta := {\n\t\"id\": \"sg-public-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Ingress Valid\",\n\t\t\"zh\": \"安全组入网设置有效\",\n\t\t\"ja\": \"セキュリティグループイングレスが有効\",\n\t\t\"de\": \"Sicherheitsgruppe Ingress gültig\",\n\t\t\"es\": \"Ingress de Grupo de Seguridad Válido\",\n\t\t\"fr\": \"Ingress du Groupe de Sécurité Valide\",\n\t\t\"pt\": \"Ingress de Grupo de Segurança Válido\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Security group ingress rules should not allow all ports (-1/-1) from all sources (0.0.0.0/0) simultaneously.\",\n\t\t\"zh\": \"安全组入方向授权策略为允许，当端口范围-1/-1 和授权对象 0.0.0.0/0 未同时出现，或者被优先级更高的授权策略拒绝，视为合规。\",\n\t\t\"ja\": \"セキュリティグループのイングレスルールは、すべてのソース（0.0.0.0/0）からすべてのポート（-1/-1）を同時に許可すべきではありません。\",\n\t\t\"de\": \"Sicherheitsgruppen-Ingress-Regeln sollten nicht gleichzeitig alle Ports (-1/-1) von allen Quellen (0.0.0.0/0) erlauben.\",\n\t\t\"es\": \"Las reglas de ingreso del grupo de seguridad no deben permitir todos los puertos (-1/-1) desde todas las fuentes (0.0.0.0/0) simultáneamente.\",\n\t\t\"fr\": \"Les règles d'ingress du groupe de sécurité ne doivent pas autoriser tous les ports (-1/-1) depuis toutes les sources (0.0.0.0/0) simultanément.\",\n\t\t\"pt\": \"As regras de ingresso do grupo de segurança não devem permitir todas as portas (-1/-1) de todas as fontes (0.0.0.0/0) simultaneamente.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The security group has an ingress rule that allows all ports from all sources (0.0.0.0/0 with port range -1/-1), which poses a critical security risk.\",\n\t\t\"zh\": \"安全组有一条入网规则同时允许所有端口（-1/-1）和所有来源（0.0.0.0/0），存在严重安全风险。\",\n\t\t\"ja\": \"セキュリティグループに、すべてのソース（ポート範囲 -1/-1 の 0.0.0.0/0）からすべてのポートを許可するイングレスルールがあり、重大なセキュリティリスクをもたらします。\",\n\t\t\"de\": \"Die Sicherheitsgruppe hat eine Ingress-Regel, die alle Ports von allen Quellen (0.0.0.0/0 mit Portbereich -1/-1) erlaubt, was ein kritisches Sicherheitsrisiko darstellt.\",\n\t\t\"es\": \"El grupo de seguridad tiene una regla de ingreso que permite todos los puertos desde todas las fuentes (0.0.0.0/0 con rango de puertos -1/-1), lo que plantea un riesgo de seguridad crítico.\",\n\t\t\"fr\": \"Le groupe de sécurité a une règle d'ingress qui autorise tous les ports depuis toutes les sources (0.0.0.0/0 avec plage de ports -1/-1), ce qui pose un risque de sécurité critique.\",\n\t\t\"pt\": \"O grupo de segurança tem uma regra de ingresso que permite todas as portas de todas as fontes (0.0.0.0/0 com intervalo de portas -1/-1), o que representa um risco de segurança crítico.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Either restrict the source IP range to specific CIDR blocks or limit the port range to specific ports based on actual business requirements.\",\n\t\t\"zh\": \"根据实际业务需求，将来源 IP 范围限制为特定的 CIDR 块，或将端口范围限制为特定的端口。\",\n\t\t\"ja\": \"実際のビジネス要件に基づいて、ソース IP 範囲を特定の CIDR ブロックに制限するか、ポート範囲を特定のポートに制限します。\",\n\t\t\"de\": \"Beschränken Sie entweder den Quell-IP-Bereich auf spezifische CIDR-Blöcke oder begrenzen Sie den Portbereich auf spezifische Ports basierend auf tatsächlichen Geschäftsanforderungen.\",\n\t\t\"es\": \"Restrinja el rango de IP de origen a bloques CIDR específicos o limite el rango de puertos a puertos específicos según los requisitos comerciales reales.\",\n\t\t\"fr\": \"Restreignez soit la plage d'IP source à des blocs CIDR spécifiques, soit limitez la plage de ports à des ports spécifiques en fonction des exigences commerciales réelles.\",\n\t\t\"pt\": \"Restrinja o intervalo de IP de origem a blocos CIDR específicos ou limite o intervalo de portas a portas específicas com base nos requisitos comerciais reais.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\", \"ALIYUN::ECS::SecurityGroupIngress\", \"ALIYUN::ECS::SecurityGroupIngresses\"]\n}\n\n# Check if an ingress rule is a public access rule (all ports from all sources)\nis_public_access(rule) if {\n\trule.PortRange == \"-1/-1\"\n\trule.SourceCidrIp == \"0.0.0.0/0\"\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n}\n\nis_public_access(rule) if {\n\trule.PortRange == \"-1/-1\"\n\trule.Ipv6SourceCidrIp == \"::/0\"\n\tobject.get(rule, \"Policy\", \"accept\") == \"accept\"\n}\n\n# Check SecurityGroup resource for ingress rules\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\tsome i, rule in resource.Properties.SecurityGroupIngress\n\tis_public_access(rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIngress\", format_int(i, 10)],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngress resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngress\")\n\tprops := resource.Properties\n\tingress_rule := {\n\t\t\"PortRange\": props.PortRange,\n\t\t\"SourceCidrIp\": object.get(props, \"SourceCidrIp\", \"\"),\n\t\t\"Ipv6SourceCidrIp\": object.get(props, \"Ipv6SourceCidrIp\", \"\"),\n\t\t\"Policy\": object.get(props, \"Policy\", \"accept\"),\n\t}\n\tis_public_access(ingress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n\n# Check SecurityGroupIngresses resource\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroupIngresses\")\n\tsome i, perm in resource.Properties.Permissions\n\tingress_rule := {\n\t\t\"PortRange\": perm.PortRange,\n\t\t\"SourceCidrIp\": object.get(perm, \"SourceCidrIp\", \"\"),\n\t\t\"Ipv6SourceCidrIp\": object.get(perm, \"Ipv6SourceCidrIp\", \"\"),\n\t\t\"Policy\": object.get(perm, \"Policy\", \"accept\"),\n\t}\n\tis_public_access(ingress_rule)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Permissions\", format_int(i, 10)],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:sg-risky-ports-check", Name: models.I18nString{"de": "Sicherheitsgruppe öffnet keine riskanten Ports für 0.0.0.0/0", "en": "Security group does not open risky ports to 0.0.0.0/0", "es": "El Grupo de Seguridad No Abre Puertos de Riesgo a 0.0.0.0/0", "fr": "Le Groupe de Sécurité N'ouvre Pas de Ports à Risque à 0.0.0.0/0", "ja": "セキュリティグループが 0.0.0.0/0 にリスクポートを開かない", "pt": "Grupo de Segurança Não Abre Portas de Risco para 0.0.0.0/0", "zh": "安全组不允许对全部网段开启风险端口"}, Severity: "high", Description: models.I18nString{"de": "Wenn die Quelle der Sicherheitsgruppen-Eingangsregel auf 0.0.0.0/0 gesetzt ist, sollte der Portbereich keine angegebenen riskanten Ports enthalten, was als konform gilt. Wenn die Quelle nicht 0.0.0.0/0 ist, ist es konform, auch wenn riskante Ports enthalten sind.", "en": "When security group ingress rule source is set to 0.0.0.0/0, the port range should not include specified risky ports, considered compliant. If source is not 0.0.0.0/0, it's compliant even if risky ports are included.", "es": "Cuando la fuente de la regla de entrada del grupo de seguridad se establece en 0.0.0.0/0, el rango de puertos no debe incluir puertos de riesgo especificados, considerado conforme. Si la fuente no es 0.0.0.0/0, es conforme incluso si se incluyen puertos de riesgo.", "fr": "Lorsque la source de la règle d'entrée du groupe de sécurité est définie sur 0.0.0.0/0, la plage de ports ne doit pas inclure de ports à risque spécifiés, considéré comme conforme. Si la source n'est pas 0.0.0.0/0, c'est conforme même si des ports à risque sont inclus.", "ja": "セキュリティグループのイングレスルールのソースが 0.0.0.0/0 に設定されている場合、ポート範囲に指定されたリスクポートが含まれていない場合、準拠と見なされます。ソースが 0.0.0.0/0 でない場合、ポート範囲に指定されたリスクポートが含まれていても準拠と見なされます。", "pt": "Quando a origem da regra de entrada do grupo de segurança é definida como 0.0.0.0/0, o intervalo de portas não deve incluir portas de risco especificadas, considerado conforme. Se a origem não for 0.0.0.0/0, é conforme mesmo que portas de risco sejam incluídas.", "zh": "当安全组入网网段设置为 0.0.0.0/0 时，端口范围不包含指定风险端口，视为合规。若入网网段未设置为 0.0.0.0/0 时，即使端口范围包含指定的风险端口，也视为合规。"}, Reason: models.I18nString{"de": "Sicherheitsgruppe öffnet riskante Ports für alle IP-Adressen (0.0.0.0/0)", "en": "Security group opens risky ports to all IP addresses (0.0.0.0/0)", "es": "El grupo de seguridad abre puertos de riesgo a todas las direcciones IP (0.0.0.0/0)", "fr": "Le groupe de sécurité ouvre des ports à risque à toutes les adresses IP (0.0.0.0/0)", "ja": "セキュリティグループがすべての IP アドレス（0.0.0.0/0）にリスクポートを開いています", "pt": "O grupo de segurança abre portas de risco para todos os endereços IP (0.0.0.0/0)", "zh": "安全组向所有 IP 地址(0.0.0.0/0)开放了风险端口"}, Recommendation: models.I18nString{"de": "Entfernen Sie riskante Portregeln aus den Sicherheitsgruppen-Eingangsregeln oder beschränken Sie den Quell-IP-Bereich", "en": "Remove risky port rules from security group ingress rules or restrict source IP range", "es": "Elimine las reglas de puertos de riesgo de las reglas de entrada del grupo de seguridad o restrinja el rango de IP de origen", "fr": "Supprimez les règles de ports à risque des règles d'entrée du groupe de sécurité ou restreignez la plage d'IP source", "ja": "セキュリティグループのイングレスルールからリスクポートルールを削除するか、ソース IP 範囲を制限します", "pt": "Remova as regras de portas de risco das regras de entrada do grupo de segurança ou restrinja o intervalo de IP de origem", "zh": "从安全组入站规则中删除风险端口规则，或限制源 IP 范围"}, ResourceTypes: []string{"ALIYUN::ECS::SecurityGroup"}, FilePath: "aliyun/rules/sg-risky-ports-check.rego", PackageName: "infraguard.rules.aliyun.sg_risky_ports_check", Content: "package infraguard.rules.aliyun.sg_risky_ports_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"sg-risky-ports-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Security group does not open risky ports to 0.0.0.0/0\",\n\t\t\"zh\": \"安全组不允许对全部网段开启风险端口\",\n\t\t\"ja\": \"セキュリティグループが 0.0.0.0/0 にリスクポートを開かない\",\n\t\t\"de\": \"Sicherheitsgruppe öffnet keine riskanten Ports für 0.0.0.0/0\",\n\t\t\"es\": \"El Grupo de Seguridad No Abre Puertos de Riesgo a 0.0.0.0/0\",\n\t\t\"fr\": \"Le Groupe de Sécurité N'ouvre Pas de Ports à Risque à 0.0.0.0/0\",\n\t\t\"pt\": \"Grupo de Segurança Não Abre Portas de Risco para 0.0.0.0/0\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"When security group ingress rule source is set to 0.0.0.0/0, the port range should not include specified risky ports, considered compliant. If source is not 0.0.0.0/0, it's compliant even if risky ports are included.\",\n\t\t\"zh\": \"当安全组入网网段设置为 0.0.0.0/0 时，端口范围不包含指定风险端口，视为合规。若入网网段未设置为 0.0.0.0/0 时，即使端口范围包含指定的风险端口，也视为合规。\",\n\t\t\"ja\": \"セキュリティグループのイングレスルールのソースが 0.0.0.0/0 に設定されている場合、ポート範囲に指定されたリスクポートが含まれていない場合、準拠と見なされます。ソースが 0.0.0.0/0 でない場合、ポート範囲に指定されたリスクポートが含まれていても準拠と見なされます。\",\n\t\t\"de\": \"Wenn die Quelle der Sicherheitsgruppen-Eingangsregel auf 0.0.0.0/0 gesetzt ist, sollte der Portbereich keine angegebenen riskanten Ports enthalten, was als konform gilt. Wenn die Quelle nicht 0.0.0.0/0 ist, ist es konform, auch wenn riskante Ports enthalten sind.\",\n\t\t\"es\": \"Cuando la fuente de la regla de entrada del grupo de seguridad se establece en 0.0.0.0/0, el rango de puertos no debe incluir puertos de riesgo especificados, considerado conforme. Si la fuente no es 0.0.0.0/0, es conforme incluso si se incluyen puertos de riesgo.\",\n\t\t\"fr\": \"Lorsque la source de la règle d'entrée du groupe de sécurité est définie sur 0.0.0.0/0, la plage de ports ne doit pas inclure de ports à risque spécifiés, considéré comme conforme. Si la source n'est pas 0.0.0.0/0, c'est conforme même si des ports à risque sont inclus.\",\n\t\t\"pt\": \"Quando a origem da regra de entrada do grupo de segurança é definida como 0.0.0.0/0, o intervalo de portas não deve incluir portas de risco especificadas, considerado conforme. Se a origem não for 0.0.0.0/0, é conforme mesmo que portas de risco sejam incluídas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Security group opens risky ports to all IP addresses (0.0.0.0/0)\",\n\t\t\"zh\": \"安全组向所有 IP 地址(0.0.0.0/0)开放了风险端口\",\n\t\t\"ja\": \"セキュリティグループがすべての IP アドレス（0.0.0.0/0）にリスクポートを開いています\",\n\t\t\"de\": \"Sicherheitsgruppe öffnet riskante Ports für alle IP-Adressen (0.0.0.0/0)\",\n\t\t\"es\": \"El grupo de seguridad abre puertos de riesgo a todas las direcciones IP (0.0.0.0/0)\",\n\t\t\"fr\": \"Le groupe de sécurité ouvre des ports à risque à toutes les adresses IP (0.0.0.0/0)\",\n\t\t\"pt\": \"O grupo de segurança abre portas de risco para todos os endereços IP (0.0.0.0/0)\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove risky port rules from security group ingress rules or restrict source IP range\",\n\t\t\"zh\": \"从安全组入站规则中删除风险端口规则，或限制源 IP 范围\",\n\t\t\"ja\": \"セキュリティグループのイングレスルールからリスクポートルールを削除するか、ソース IP 範囲を制限します\",\n\t\t\"de\": \"Entfernen Sie riskante Portregeln aus den Sicherheitsgruppen-Eingangsregeln oder beschränken Sie den Quell-IP-Bereich\",\n\t\t\"es\": \"Elimine las reglas de puertos de riesgo de las reglas de entrada del grupo de seguridad o restrinja el rango de IP de origen\",\n\t\t\"fr\": \"Supprimez les règles de ports à risque des règles d'entrée du groupe de sécurité ou restreignez la plage d'IP source\",\n\t\t\"pt\": \"Remova as regras de portas de risco das regras de entrada do grupo de segurança ou restrinja o intervalo de IP de origem\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::SecurityGroup\"]\n}\n\n# Risky port ranges to check (common sensitive ports)\n# Format: port ranges like \"22/22\", \"3389/3389\", \"0/65535\"\nis_risky_port(port_range) if {\n\t# Common risky ports: SSH (22), RDP (3389), Telnet (23), MySQL (3306), etc.\n\tport_range in [\n\t\t\"22/22\",\n\t\t\"23/23\",\n\t\t\"3389/3389\",\n\t\t\"3306/3306\",\n\t\t\"1433/1433\",\n\t\t\"5432/5432\",\n\t\t\"27017/27017\",\n\t\t\"6379/6379\",\n\t\t\"0/65535\",\n\t]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::SecurityGroup\")\n\n\t# Get ingress rules\n\tingress_rules := helpers.get_property(resource, \"SecurityGroupIngress\", [])\n\n\t# Check each rule\n\tsome rule in ingress_rules\n\tsource_cidr := object.get(rule, \"SourceCidrIp\", \"\")\n\tport_range := object.get(rule, \"PortRange\", \"\")\n\n\t# Only flag if source is 0.0.0.0/0 and port is risky\n\tsource_cidr == \"0.0.0.0/0\"\n\tis_risky_port(port_range)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityGroupIngress\", \"SourceCidrIp\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-acl-public-access-check", Name: models.I18nString{"de": "SLB ACL öffentlicher Zugriff-Prüfung", "en": "SLB ACL Public Access Check", "es": "Verificación de Acceso Público de ACL de SLB", "fr": "Vérification d'Accès Public ACL SLB", "ja": "SLB ACL のパブリックアクセスチェック", "pt": "Verificação de Acesso Público de ACL SLB", "zh": "CLB 访问控制列表不配置所有地址段"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass SLB ACLs 0.0.0.0/0 nicht enthalten, um uneingeschränkten öffentlichen Zugriff zu verhindern.", "en": "Ensures that SLB ACLs do not contain 0.0.0.0/0 to prevent unrestricted public access.", "es": "Garantiza que las ACL de SLB no contengan 0.0.0.0/0 para prevenir acceso público sin restricciones.", "fr": "Garantit que les ACL SLB ne contiennent pas 0.0.0.0/0 pour empêcher l'accès public sans restriction.", "ja": "SLB ACL に 0.0.0.0/0 が含まれていないことを確認し、無制限のパブリックアクセスを防ぎます。", "pt": "Garante que as ACLs SLB não contenham 0.0.0.0/0 para prevenir acesso público sem restrições.", "zh": "确保 CLB 访问控制列表中不包含 0.0.0.0/0，以防止无限制的公网访问。"}, Reason: models.I18nString{"de": "Das Zulassen von 0.0.0.0/0 in einer ACL umgeht die Sicherheitsvorteile der Zugriffskontrolle und kann Dienste Angriffen aussetzen.", "en": "Allowing 0.0.0.0/0 in an ACL bypasses the security benefits of access control, potentially exposing services to attacks.", "es": "Permitir 0.0.0.0/0 en una ACL omite los beneficios de seguridad del control de acceso, potencialmente exponiendo servicios a ataques.", "fr": "Autoriser 0.0.0.0/0 dans une ACL contourne les avantages de sécurité du contrôle d'accès, exposant potentiellement les services aux attaques.", "ja": "ACL で 0.0.0.0/0 を許可すると、アクセス制御のセキュリティ上の利点が回避され、サービスが攻撃にさらされる可能性があります。", "pt": "Permitir 0.0.0.0/0 em uma ACL ignora os benefícios de segurança do controle de acesso, potencialmente expondo serviços a ataques.", "zh": "在 ACL 中允许 0.0.0.0/0 会绕过访问控制的安全保障，使服务可能遭受攻击。"}, Recommendation: models.I18nString{"de": "Entfernen Sie 0.0.0.0/0 aus den SLB ACL-Einträgen und ersetzen Sie es durch spezifische IP-Bereiche.", "en": "Remove 0.0.0.0/0 from the SLB ACL entries and replace it with specific IP ranges.", "es": "Elimine 0.0.0.0/0 de las entradas de ACL de SLB y reemplácelo con rangos de IP específicos.", "fr": "Supprimez 0.0.0.0/0 des entrées ACL SLB et remplacez-le par des plages d'IP spécifiques.", "ja": "SLB ACL エントリから 0.0.0.0/0 を削除し、特定の IP 範囲に置き換えます。", "pt": "Remova 0.0.0.0/0 das entradas de ACL SLB e substitua por intervalos de IP específicos.", "zh": "从 CLB 访问控制列表条目中移除 0.0.0.0/0，并替换为特定的 IP 范围。"}, ResourceTypes: []string{"ALIYUN::SLB::AccessControl"}, FilePath: "aliyun/rules/slb-acl-public-access-check.rego", PackageName: "infraguard.rules.aliyun.slb_acl_public_access_check", Content: "package infraguard.rules.aliyun.slb_acl_public_access_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"slb-acl-public-access-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"SLB ACL Public Access Check\",\n\t\t\"zh\": \"CLB 访问控制列表不配置所有地址段\",\n\t\t\"ja\": \"SLB ACL のパブリックアクセスチェック\",\n\t\t\"de\": \"SLB ACL öffentlicher Zugriff-Prüfung\",\n\t\t\"es\": \"Verificación de Acceso Público de ACL de SLB\",\n\t\t\"fr\": \"Vérification d'Accès Public ACL SLB\",\n\t\t\"pt\": \"Verificação de Acesso Público de ACL SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that SLB ACLs do not contain 0.0.0.0/0 to prevent unrestricted public access.\",\n\t\t\"zh\": \"确保 CLB 访问控制列表中不包含 0.0.0.0/0，以防止无限制的公网访问。\",\n\t\t\"ja\": \"SLB ACL に 0.0.0.0/0 が含まれていないことを確認し、無制限のパブリックアクセスを防ぎます。\",\n\t\t\"de\": \"Stellt sicher, dass SLB ACLs 0.0.0.0/0 nicht enthalten, um uneingeschränkten öffentlichen Zugriff zu verhindern.\",\n\t\t\"es\": \"Garantiza que las ACL de SLB no contengan 0.0.0.0/0 para prevenir acceso público sin restricciones.\",\n\t\t\"fr\": \"Garantit que les ACL SLB ne contiennent pas 0.0.0.0/0 pour empêcher l'accès public sans restriction.\",\n\t\t\"pt\": \"Garante que as ACLs SLB não contenham 0.0.0.0/0 para prevenir acesso público sem restrições.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Allowing 0.0.0.0/0 in an ACL bypasses the security benefits of access control, potentially exposing services to attacks.\",\n\t\t\"zh\": \"在 ACL 中允许 0.0.0.0/0 会绕过访问控制的安全保障，使服务可能遭受攻击。\",\n\t\t\"ja\": \"ACL で 0.0.0.0/0 を許可すると、アクセス制御のセキュリティ上の利点が回避され、サービスが攻撃にさらされる可能性があります。\",\n\t\t\"de\": \"Das Zulassen von 0.0.0.0/0 in einer ACL umgeht die Sicherheitsvorteile der Zugriffskontrolle und kann Dienste Angriffen aussetzen.\",\n\t\t\"es\": \"Permitir 0.0.0.0/0 en una ACL omite los beneficios de seguridad del control de acceso, potencialmente exponiendo servicios a ataques.\",\n\t\t\"fr\": \"Autoriser 0.0.0.0/0 dans une ACL contourne les avantages de sécurité du contrôle d'accès, exposant potentiellement les services aux attaques.\",\n\t\t\"pt\": \"Permitir 0.0.0.0/0 em uma ACL ignora os benefícios de segurança do controle de acesso, potencialmente expondo serviços a ataques.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Remove 0.0.0.0/0 from the SLB ACL entries and replace it with specific IP ranges.\",\n\t\t\"zh\": \"从 CLB 访问控制列表条目中移除 0.0.0.0/0，并替换为特定的 IP 范围。\",\n\t\t\"ja\": \"SLB ACL エントリから 0.0.0.0/0 を削除し、特定の IP 範囲に置き換えます。\",\n\t\t\"de\": \"Entfernen Sie 0.0.0.0/0 aus den SLB ACL-Einträgen und ersetzen Sie es durch spezifische IP-Bereiche.\",\n\t\t\"es\": \"Elimine 0.0.0.0/0 de las entradas de ACL de SLB y reemplácelo con rangos de IP específicos.\",\n\t\t\"fr\": \"Supprimez 0.0.0.0/0 des entrées ACL SLB et remplacez-le par des plages d'IP spécifiques.\",\n\t\t\"pt\": \"Remova 0.0.0.0/0 das entradas de ACL SLB e substitua por intervalos de IP específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::AccessControl\"]\n}\n\nis_compliant(resource) if {\n\tentries := helpers.get_property(resource, \"AclEntries\", [])\n\tnot has_open_entry(entries)\n}\n\nhas_open_entry(entries) if {\n\tsome entry in entries\n\thelpers.is_public_cidr(entry.Entry)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::AccessControl\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AclEntries\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-all-listener-enabled-acl", Name: models.I18nString{"de": "SLB Alle Listener haben Zugriffskontrolle", "en": "SLB All Listeners Have Access Control", "es": "Todos los Oyentes SLB Tienen Control de Acceso", "fr": "Tous les Écouteurs SLB ont un Contrôle d'Accès", "ja": "SLB すべてのリスナーにアクセス制御がある", "pt": "Todos os Ouvintes SLB Têm Controle de Acesso", "zh": "SLB 实例所有运行中的监听都设置访问控制"}, Severity: "medium", Description: models.I18nString{"de": "Alle laufenden Listener von SLB-Instanzen sollten Zugriffssteuerungslisten (ACL) für die Sicherheit konfiguriert haben.", "en": "All running listeners of SLB instances should have access control lists (ACL) configured for security.", "es": "Todos los oyentes en ejecución de las instancias SLB deben tener listas de control de acceso (ACL) configuradas para seguridad.", "fr": "Tous les écouteurs en cours d'exécution des instances SLB doivent avoir des listes de contrôle d'accès (ACL) configurées pour la sécurité.", "ja": "SLB インスタンスのすべての実行中のリスナーは、セキュリティのためにアクセス制御リスト（ACL）を設定する必要があります。", "pt": "Todos os ouvintes em execução das instâncias SLB devem ter listas de controle de acesso (ACL) configuradas para segurança.", "zh": "SLB 实例所有运行中的监听都设置了访问控制，视为合规。"}, Reason: models.I18nString{"de": "Listener ohne ACL können uneingeschränkten Zugriff ermöglichen, was die Sicherheitsrisiken erhöht.", "en": "Listeners without ACL may allow unrestricted access, increasing security risks.", "es": "Los oyentes sin ACL pueden permitir acceso sin restricciones, aumentando los riesgos de seguridad.", "fr": "Les écouteurs sans ACL peuvent autoriser un accès sans restriction, augmentant les risques de sécurité.", "ja": "ACL のないリスナーは無制限のアクセスを許可する可能性があり、セキュリティリスクを増加させます。", "pt": "Ouvintes sem ACL podem permitir acesso irrestrito, aumentando os riscos de segurança.", "zh": "未设置访问控制的监听可能允许无限制的访问，增加安全风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie ACL für alle laufenden Listener auf SLB-Instanzen.", "en": "Configure ACL for all running listeners on SLB instances.", "es": "Configure ACL para todos los oyentes en ejecución en las instancias SLB.", "fr": "Configurez ACL pour tous les écouteurs en cours d'exécution sur les instances SLB.", "ja": "SLB インスタンスのすべての実行中のリスナーに ACL を設定します。", "pt": "Configure ACL para todos os ouvintes em execução nas instâncias SLB.", "zh": "为 SLB 实例的所有运行中监听配置访问控制列表。"}, ResourceTypes: []string{"ALIYUN::SLB::Listener"}, FilePath: "aliyun/rules/slb-all-listener-enabled-acl.rego", PackageName: "infraguard.rules.aliyun.slb_all_listener_enabled_acl", Content: "package infraguard.rules.aliyun.slb_all_listener_enabled_acl\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-all-listener-enabled-acl\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB All Listeners Have Access Control\",\n\t\t\"zh\": \"SLB 实例所有运行中的监听都设置访问控制\",\n\t\t\"ja\": \"SLB すべてのリスナーにアクセス制御がある\",\n\t\t\"de\": \"SLB Alle Listener haben Zugriffskontrolle\",\n\t\t\"es\": \"Todos los Oyentes SLB Tienen Control de Acceso\",\n\t\t\"fr\": \"Tous les Écouteurs SLB ont un Contrôle d'Accès\",\n\t\t\"pt\": \"Todos os Ouvintes SLB Têm Controle de Acesso\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"All running listeners of SLB instances should have access control lists (ACL) configured for security.\",\n\t\t\"zh\": \"SLB 实例所有运行中的监听都设置了访问控制，视为合规。\",\n\t\t\"ja\": \"SLB インスタンスのすべての実行中のリスナーは、セキュリティのためにアクセス制御リスト（ACL）を設定する必要があります。\",\n\t\t\"de\": \"Alle laufenden Listener von SLB-Instanzen sollten Zugriffssteuerungslisten (ACL) für die Sicherheit konfiguriert haben.\",\n\t\t\"es\": \"Todos los oyentes en ejecución de las instancias SLB deben tener listas de control de acceso (ACL) configuradas para seguridad.\",\n\t\t\"fr\": \"Tous les écouteurs en cours d'exécution des instances SLB doivent avoir des listes de contrôle d'accès (ACL) configurées pour la sécurité.\",\n\t\t\"pt\": \"Todos os ouvintes em execução das instâncias SLB devem ter listas de controle de acesso (ACL) configuradas para segurança.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Listeners without ACL may allow unrestricted access, increasing security risks.\",\n\t\t\"zh\": \"未设置访问控制的监听可能允许无限制的访问，增加安全风险。\",\n\t\t\"ja\": \"ACL のないリスナーは無制限のアクセスを許可する可能性があり、セキュリティリスクを増加させます。\",\n\t\t\"de\": \"Listener ohne ACL können uneingeschränkten Zugriff ermöglichen, was die Sicherheitsrisiken erhöht.\",\n\t\t\"es\": \"Los oyentes sin ACL pueden permitir acceso sin restricciones, aumentando los riesgos de seguridad.\",\n\t\t\"fr\": \"Les écouteurs sans ACL peuvent autoriser un accès sans restriction, augmentant les risques de sécurité.\",\n\t\t\"pt\": \"Ouvintes sem ACL podem permitir acesso irrestrito, aumentando os riscos de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure ACL for all running listeners on SLB instances.\",\n\t\t\"zh\": \"为 SLB 实例的所有运行中监听配置访问控制列表。\",\n\t\t\"ja\": \"SLB インスタンスのすべての実行中のリスナーに ACL を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie ACL für alle laufenden Listener auf SLB-Instanzen.\",\n\t\t\"es\": \"Configure ACL para todos los oyentes en ejecución en las instancias SLB.\",\n\t\t\"fr\": \"Configurez ACL pour tous les écouteurs en cours d'exécution sur les instances SLB.\",\n\t\t\"pt\": \"Configure ACL para todos os ouvintes em execução nas instâncias SLB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::Listener\"]\n}\n\nis_compliant(resource) if {\n\tacl_status := helpers.get_property(resource, \"AclStatus\", \"off\")\n\tacl_status == \"on\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AclStatus\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-all-listener-health-check-enabled", Name: models.I18nString{"de": "SLB Alle Listener Gesundheitsprüfung aktiviert", "en": "SLB All Listeners Health Check Enabled", "es": "Verificación de Salud de Todos los Listeners SLB Habilitada", "fr": "Vérification de Santé de Tous les Listeners SLB Activée", "ja": "SLB すべてのリスナーでヘルスチェックが有効", "pt": "Verificação de Saúde de Todos os Listeners SLB Habilitada", "zh": "SLB 所有监听开启健康检查"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass alle SLB-Listener Gesundheitsprüfungen aktiviert haben.", "en": "Ensures all SLB listeners have health checks enabled.", "es": "Garantiza que todos los listeners SLB tengan verificaciones de salud habilitadas.", "fr": "Garantit que tous les listeners SLB ont les vérifications de santé activées.", "ja": "すべての SLB リスナーでヘルスチェックが有効になっていることを確認します。", "pt": "Garante que todos os listeners SLB tenham verificações de saúde habilitadas.", "zh": "确保所有 SLB 监听均开启了健康检查。"}, Reason: models.I18nString{"de": "Gesundheitsprüfungen stellen sicher, dass Datenverkehr nur an gesunde Backend-Instanzen gesendet wird.", "en": "Health checks ensure that traffic is only sent to healthy backend instances.", "es": "Las verificaciones de salud garantizan que el tráfico solo se envíe a instancias backend saludables.", "fr": "Les vérifications de santé garantissent que le trafic n'est envoyé qu'aux instances backend saines.", "ja": "ヘルスチェックにより、トラフィックが正常なバックエンドインスタンスにのみ送信されることが保証されます。", "pt": "As verificações de saúde garantem que o tráfego seja enviado apenas para instâncias backend saudáveis.", "zh": "健康检查确保流量仅发送到健康的后端实例。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Gesundheitsprüfungen für alle SLB-Listener.", "en": "Enable health checks for all SLB listeners.", "es": "Habilite verificaciones de salud para todos los listeners SLB.", "fr": "Activez les vérifications de santé pour tous les listeners SLB.", "ja": "すべての SLB リスナーでヘルスチェックを有効にします。", "pt": "Habilite verificações de saúde para todos os listeners SLB.", "zh": "为所有 SLB 监听开启健康检查。"}, ResourceTypes: []string{"ALIYUN::SLB::Listener"}, FilePath: "aliyun/rules/slb-all-listener-health-check-enabled.rego", PackageName: "infraguard.rules.aliyun.slb_all_listener_health_check_enabled", Content: "package infraguard.rules.aliyun.slb_all_listener_health_check_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-all-listener-health-check-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"SLB All Listeners Health Check Enabled\",\n\t\t\"zh\": \"SLB 所有监听开启健康检查\",\n\t\t\"ja\": \"SLB すべてのリスナーでヘルスチェックが有効\",\n\t\t\"de\": \"SLB Alle Listener Gesundheitsprüfung aktiviert\",\n\t\t\"es\": \"Verificación de Salud de Todos los Listeners SLB Habilitada\",\n\t\t\"fr\": \"Vérification de Santé de Tous les Listeners SLB Activée\",\n\t\t\"pt\": \"Verificação de Saúde de Todos os Listeners SLB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures all SLB listeners have health checks enabled.\",\n\t\t\"zh\": \"确保所有 SLB 监听均开启了健康检查。\",\n\t\t\"ja\": \"すべての SLB リスナーでヘルスチェックが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass alle SLB-Listener Gesundheitsprüfungen aktiviert haben.\",\n\t\t\"es\": \"Garantiza que todos los listeners SLB tengan verificaciones de salud habilitadas.\",\n\t\t\"fr\": \"Garantit que tous les listeners SLB ont les vérifications de santé activées.\",\n\t\t\"pt\": \"Garante que todos os listeners SLB tenham verificações de saúde habilitadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Health checks ensure that traffic is only sent to healthy backend instances.\",\n\t\t\"zh\": \"健康检查确保流量仅发送到健康的后端实例。\",\n\t\t\"ja\": \"ヘルスチェックにより、トラフィックが正常なバックエンドインスタンスにのみ送信されることが保証されます。\",\n\t\t\"de\": \"Gesundheitsprüfungen stellen sicher, dass Datenverkehr nur an gesunde Backend-Instanzen gesendet wird.\",\n\t\t\"es\": \"Las verificaciones de salud garantizan que el tráfico solo se envíe a instancias backend saludables.\",\n\t\t\"fr\": \"Les vérifications de santé garantissent que le trafic n'est envoyé qu'aux instances backend saines.\",\n\t\t\"pt\": \"As verificações de saúde garantem que o tráfego seja enviado apenas para instâncias backend saudáveis.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable health checks for all SLB listeners.\",\n\t\t\"zh\": \"为所有 SLB 监听开启健康检查。\",\n\t\t\"ja\": \"すべての SLB リスナーでヘルスチェックを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Gesundheitsprüfungen für alle SLB-Listener.\",\n\t\t\"es\": \"Habilite verificaciones de salud para todos los listeners SLB.\",\n\t\t\"fr\": \"Activez les vérifications de santé pour tous les listeners SLB.\",\n\t\t\"pt\": \"Habilite verificações de saúde para todos os listeners SLB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::Listener\"]\n}\n\nis_compliant(resource) if {\n\t# HealthCheck is a map with Switch property\n\thc := helpers.get_property(resource, \"HealthCheck\", {})\n\tswitch_val := object.get(hc, \"Switch\", \"off\")\n\tswitch_val == \"on\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"HealthCheck\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-all-listener-http-disabled", Name: models.I18nString{"de": "SLB Alle Listener HTTP deaktiviert", "en": "SLB All Listeners HTTP Disabled", "es": "HTTP de Todos los Oyentes SLB Deshabilitado", "fr": "HTTP de Tous les Écouteurs SLB Désactivé", "ja": "SLB すべてのリスナー HTTP が無効", "pt": "HTTP de Todos os Ouvintes SLB Desabilitado", "zh": "SLB 禁用 HTTP 监听"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass keine SLB-Listener das unsichere HTTP-Protokoll verwenden.", "en": "Ensures no SLB listeners use the insecure HTTP protocol.", "es": "Garantiza que ningún oyente SLB use el protocolo HTTP inseguro.", "fr": "Garantit qu'aucun écouteur SLB n'utilise le protocole HTTP non sécurisé.", "ja": "SLB リスナーが安全でない HTTP プロトコルを使用していないことを確認します。", "pt": "Garante que nenhum ouvinte SLB use o protocolo HTTP inseguro.", "zh": "确保没有 SLB 监听使用不安全的 HTTP 协议。"}, Reason: models.I18nString{"de": "HTTP-Datenverkehr ist unverschlüsselt und anfällig für Abfangen.", "en": "HTTP traffic is unencrypted and vulnerable to interception.", "es": "El tráfico HTTP no está cifrado y es vulnerable a la interceptación.", "fr": "Le trafic HTTP n'est pas chiffré et vulnérable à l'interception.", "ja": "HTTP トラフィックは暗号化されておらず、傍受されやすいです。", "pt": "O tráfego HTTP não está criptografado e é vulnerável à interceptação.", "zh": "HTTP 流量未加密，容易被截获。"}, Recommendation: models.I18nString{"de": "Deaktivieren Sie HTTP-Listener und verwenden Sie stattdessen HTTPS.", "en": "Disable HTTP listeners and use HTTPS instead.", "es": "Deshabilite los oyentes HTTP y use HTTPS en su lugar.", "fr": "Désactivez les écouteurs HTTP et utilisez HTTPS à la place.", "ja": "HTTP リスナーを無効にし、代わりに HTTPS を使用します。", "pt": "Desabilite os ouvintes HTTP e use HTTPS em vez disso.", "zh": "禁用 HTTP 监听并改用 HTTPS。"}, ResourceTypes: []string{"ALIYUN::SLB::Listener"}, FilePath: "aliyun/rules/slb-all-listener-http-disabled.rego", PackageName: "infraguard.rules.aliyun.slb_all_listener_http_disabled", Content: "package infraguard.rules.aliyun.slb_all_listener_http_disabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-all-listener-http-disabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB All Listeners HTTP Disabled\",\n\t\t\"zh\": \"SLB 禁用 HTTP 监听\",\n\t\t\"ja\": \"SLB すべてのリスナー HTTP が無効\",\n\t\t\"de\": \"SLB Alle Listener HTTP deaktiviert\",\n\t\t\"es\": \"HTTP de Todos los Oyentes SLB Deshabilitado\",\n\t\t\"fr\": \"HTTP de Tous les Écouteurs SLB Désactivé\",\n\t\t\"pt\": \"HTTP de Todos os Ouvintes SLB Desabilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures no SLB listeners use the insecure HTTP protocol.\",\n\t\t\"zh\": \"确保没有 SLB 监听使用不安全的 HTTP 协议。\",\n\t\t\"ja\": \"SLB リスナーが安全でない HTTP プロトコルを使用していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass keine SLB-Listener das unsichere HTTP-Protokoll verwenden.\",\n\t\t\"es\": \"Garantiza que ningún oyente SLB use el protocolo HTTP inseguro.\",\n\t\t\"fr\": \"Garantit qu'aucun écouteur SLB n'utilise le protocole HTTP non sécurisé.\",\n\t\t\"pt\": \"Garante que nenhum ouvinte SLB use o protocolo HTTP inseguro.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"HTTP traffic is unencrypted and vulnerable to interception.\",\n\t\t\"zh\": \"HTTP 流量未加密，容易被截获。\",\n\t\t\"ja\": \"HTTP トラフィックは暗号化されておらず、傍受されやすいです。\",\n\t\t\"de\": \"HTTP-Datenverkehr ist unverschlüsselt und anfällig für Abfangen.\",\n\t\t\"es\": \"El tráfico HTTP no está cifrado y es vulnerable a la interceptación.\",\n\t\t\"fr\": \"Le trafic HTTP n'est pas chiffré et vulnérable à l'interception.\",\n\t\t\"pt\": \"O tráfego HTTP não está criptografado e é vulnerável à interceptação.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Disable HTTP listeners and use HTTPS instead.\",\n\t\t\"zh\": \"禁用 HTTP 监听并改用 HTTPS。\",\n\t\t\"ja\": \"HTTP リスナーを無効にし、代わりに HTTPS を使用します。\",\n\t\t\"de\": \"Deaktivieren Sie HTTP-Listener und verwenden Sie stattdessen HTTPS.\",\n\t\t\"es\": \"Deshabilite los oyentes HTTP y use HTTPS en su lugar.\",\n\t\t\"fr\": \"Désactivez les écouteurs HTTP et utilisez HTTPS à la place.\",\n\t\t\"pt\": \"Desabilite os ouvintes HTTP e use HTTPS em vez disso.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::Listener\"]\n}\n\nis_compliant(resource) if {\n\tprotocol := helpers.get_property(resource, \"Protocol\", \"\")\n\tprotocol != \"http\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Protocol\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-all-listener-http-redirect-https", Name: models.I18nString{"de": "SLB HTTP-Weiterleitung zu HTTPS aktiviert", "en": "SLB HTTP Redirect to HTTPS Enabled", "es": "Redirección HTTP a HTTPS de SLB Habilitada", "fr": "Redirection HTTP vers HTTPS SLB Activée", "ja": "SLB HTTP から HTTPS へのリダイレクトが有効", "pt": "Redirecionamento HTTP para HTTPS do SLB Habilitado", "zh": "SLB 监听强制跳转 HTTPS"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass SLB-HTTP-Listener so konfiguriert sind, dass Datenverkehr zu HTTPS weitergeleitet wird.", "en": "Ensures SLB HTTP listeners are configured to redirect traffic to HTTPS.", "es": "Garantiza que los oyentes HTTP de SLB estén configurados para redirigir el tráfico a HTTPS.", "fr": "Garantit que les écouteurs HTTP SLB sont configurés pour rediriger le trafic vers HTTPS.", "ja": "SLB HTTP リスナーが HTTPS にトラフィックをリダイレクトするように設定されていることを確認します。", "pt": "Garante que os ouvintes HTTP do SLB estejam configurados para redirecionar o tráfego para HTTPS.", "zh": "确保 SLB HTTP 监听已配置为将流量重定向至 HTTPS。"}, Reason: models.I18nString{"de": "Die Weiterleitung von HTTP zu HTTPS stellt sicher, dass alle Client-Kommunikation verschlüsselt ist.", "en": "Redirecting HTTP to HTTPS ensures all client communication is encrypted.", "es": "Redirigir HTTP a HTTPS garantiza que toda la comunicación del cliente esté cifrada.", "fr": "La redirection de HTTP vers HTTPS garantit que toute la communication client est chiffrée.", "ja": "HTTP を HTTPS にリダイレクトすることで、すべてのクライアント通信が暗号化されます。", "pt": "Redirecionar HTTP para HTTPS garante que toda a comunicação do cliente esteja criptografada.", "zh": "将 HTTP 重定向至 HTTPS 确保了所有客户端通信均经过加密。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die HTTP-zu-HTTPS-Weiterleitung für den SLB-Listener.", "en": "Enable HTTP-to-HTTPS redirection for the SLB listener.", "es": "Habilite la redirección HTTP a HTTPS para el oyente SLB.", "fr": "Activez la redirection HTTP vers HTTPS pour l'écouteur SLB.", "ja": "SLB リスナーの HTTP から HTTPS へのリダイレクトを有効にします。", "pt": "Habilite o redirecionamento HTTP para HTTPS para o ouvinte SLB.", "zh": "为 SLB 监听开启 HTTP 转 HTTPS 重定向。"}, ResourceTypes: []string{"ALIYUN::SLB::Listener"}, FilePath: "aliyun/rules/slb-all-listener-http-redirect-https.rego", PackageName: "infraguard.rules.aliyun.slb_all_listener_http_redirect_https", Content: "package infraguard.rules.aliyun.slb_all_listener_http_redirect_https\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-all-listener-http-redirect-https\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB HTTP Redirect to HTTPS Enabled\",\n\t\t\"zh\": \"SLB 监听强制跳转 HTTPS\",\n\t\t\"ja\": \"SLB HTTP から HTTPS へのリダイレクトが有効\",\n\t\t\"de\": \"SLB HTTP-Weiterleitung zu HTTPS aktiviert\",\n\t\t\"es\": \"Redirección HTTP a HTTPS de SLB Habilitada\",\n\t\t\"fr\": \"Redirection HTTP vers HTTPS SLB Activée\",\n\t\t\"pt\": \"Redirecionamento HTTP para HTTPS do SLB Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLB HTTP listeners are configured to redirect traffic to HTTPS.\",\n\t\t\"zh\": \"确保 SLB HTTP 监听已配置为将流量重定向至 HTTPS。\",\n\t\t\"ja\": \"SLB HTTP リスナーが HTTPS にトラフィックをリダイレクトするように設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-HTTP-Listener so konfiguriert sind, dass Datenverkehr zu HTTPS weitergeleitet wird.\",\n\t\t\"es\": \"Garantiza que los oyentes HTTP de SLB estén configurados para redirigir el tráfico a HTTPS.\",\n\t\t\"fr\": \"Garantit que les écouteurs HTTP SLB sont configurés pour rediriger le trafic vers HTTPS.\",\n\t\t\"pt\": \"Garante que os ouvintes HTTP do SLB estejam configurados para redirecionar o tráfego para HTTPS.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Redirecting HTTP to HTTPS ensures all client communication is encrypted.\",\n\t\t\"zh\": \"将 HTTP 重定向至 HTTPS 确保了所有客户端通信均经过加密。\",\n\t\t\"ja\": \"HTTP を HTTPS にリダイレクトすることで、すべてのクライアント通信が暗号化されます。\",\n\t\t\"de\": \"Die Weiterleitung von HTTP zu HTTPS stellt sicher, dass alle Client-Kommunikation verschlüsselt ist.\",\n\t\t\"es\": \"Redirigir HTTP a HTTPS garantiza que toda la comunicación del cliente esté cifrada.\",\n\t\t\"fr\": \"La redirection de HTTP vers HTTPS garantit que toute la communication client est chiffrée.\",\n\t\t\"pt\": \"Redirecionar HTTP para HTTPS garante que toda a comunicação do cliente esteja criptografada.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable HTTP-to-HTTPS redirection for the SLB listener.\",\n\t\t\"zh\": \"为 SLB 监听开启 HTTP 转 HTTPS 重定向。\",\n\t\t\"ja\": \"SLB リスナーの HTTP から HTTPS へのリダイレクトを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die HTTP-zu-HTTPS-Weiterleitung für den SLB-Listener.\",\n\t\t\"es\": \"Habilite la redirección HTTP a HTTPS para el oyente SLB.\",\n\t\t\"fr\": \"Activez la redirection HTTP vers HTTPS pour l'écouteur SLB.\",\n\t\t\"pt\": \"Habilite o redirecionamento HTTP para HTTPS para o ouvinte SLB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::Listener\"]\n}\n\nis_compliant(resource) if {\n\tprotocol := helpers.get_property(resource, \"Protocol\", \"\")\n\tprotocol != \"http\"\n}\n\nis_compliant(resource) if {\n\tprotocol := helpers.get_property(resource, \"Protocol\", \"\")\n\tprotocol == \"http\"\n\n\t# In ROS, check for HttpConfig.ListenerForward\n\thttp_config := helpers.get_property(resource, \"HttpConfig\", {})\n\tis_object(http_config)\n\thttp_config.ListenerForward == \"on\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"HttpConfig\", \"ListenerForward\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-all-listener-servers-multi-zone", Name: models.I18nString{"de": "SLB Multi-Zone mit Multi-Zone-Backend-Servern", "en": "SLB Multi-Zone with Multi-Zone Backend Servers", "es": "SLB Multi-zona con Servidores Backend Multi-zona", "fr": "SLB Multi-zones avec Serveurs Backend Multi-zones", "ja": "マルチゾーン SLB インスタンスとマルチゾーンバックエンドサーバー", "pt": "SLB Multi-zona com Servidores Backend Multi-zona", "zh": "使用多可用区 SLB 实例并为服务器组配置多个可用区资源"}, Severity: "high", Description: models.I18nString{"de": "SLB-Instanzen sollten Multi-Zone sein, und alle von Listenern verwendeten Servergruppen sollten Ressourcen aus mehreren Zonen hinzugefügt haben.", "en": "SLB instances should be multi-zone, and all server groups used by listeners should have resources added from multiple zones.", "es": "Las instancias SLB deben ser multi-zona, y todos los grupos de servidores utilizados por los listeners deben tener recursos agregados desde múltiples zonas.", "fr": "Les instances SLB doivent être multi-zones, et tous les groupes de serveurs utilisés par les listeners doivent avoir des ressources ajoutées depuis plusieurs zones.", "ja": "SLB インスタンスはマルチゾーンである必要があり、リスナーが使用するすべてのサーバーグループに複数のゾーンからのリソースが追加されている必要があります。", "pt": "Instâncias SLB devem ser multi-zona, e todos os grupos de servidores usados pelos listeners devem ter recursos adicionados de múltiplas zonas.", "zh": "SLB 实例为多可用区，并且 SLB 实例下所有监听使用的服务器组中添加了多个可用区的资源，视为合规。"}, Reason: models.I18nString{"de": "Einzelzonen-Bereitstellung oder Einzelzonen-Backend-Server mangelt es an hoher Verfügbarkeit und kann zu Dienstunterbrechungen während eines Zonenausfalls führen.", "en": "Single zone deployment or single zone backend servers lack high availability and may lead to service interruption during zone failure.", "es": "La implementación de zona única o servidores backend de zona única carecen de alta disponibilidad y pueden provocar interrupciones del servicio durante una falla de zona.", "fr": "Le déploiement en zone unique ou les serveurs backend en zone unique manquent de haute disponibilité et peuvent entraîner une interruption de service lors d'une panne de zone.", "ja": "単一ゾーン展開または単一ゾーンのバックエンドサーバーは高可用性に欠け、ゾーン障害時にサービス中断が発生する可能性があります。", "pt": "A implantação de zona única ou servidores backend de zona única carecem de alta disponibilidade e podem levar à interrupção do serviço durante falha de zona.", "zh": "单可用区部署或后端服务器仅位于单个可用区缺乏高可用性，可能在可用区故障时导致服务中断。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie SLB-Instanzen mit Master- und Slave-Zonen und stellen Sie sicher, dass Backend-Servergruppen Instanzen aus verschiedenen Verfügbarkeitszonen enthalten.", "en": "Configure SLB instances with master and slave zones, and ensure backend server groups include instances from different availability zones.", "es": "Configure instancias SLB con zonas maestra y esclava, y asegúrese de que los grupos de servidores backend incluyan instancias de diferentes zonas de disponibilidad.", "fr": "Configurez les instances SLB avec des zones maître et esclave, et assurez-vous que les groupes de serveurs backend incluent des instances de différentes zones de disponibilité.", "ja": "マスターゾーンとスレーブゾーンで SLB インスタンスを設定し、バックエンドサーバーグループに異なる可用性ゾーンからのインスタンスが含まれるようにします。", "pt": "Configure instâncias SLB com zonas mestre e escrava, e garanta que grupos de servidores backend incluam instâncias de diferentes zonas de disponibilidade.", "zh": "为 SLB 实例配置主备可用区，并确保后端服务器组包含来自不同可用区的实例。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-all-listener-servers-multi-zone.rego", PackageName: "infraguard.rules.aliyun.slb_all_listener_servers_multi_zone", Content: "package infraguard.rules.aliyun.slb_all_listener_servers_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"slb-all-listener-servers-multi-zone\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"SLB Multi-Zone with Multi-Zone Backend Servers\",\n\t\t\"zh\": \"使用多可用区 SLB 实例并为服务器组配置多个可用区资源\",\n\t\t\"ja\": \"マルチゾーン SLB インスタンスとマルチゾーンバックエンドサーバー\",\n\t\t\"de\": \"SLB Multi-Zone mit Multi-Zone-Backend-Servern\",\n\t\t\"es\": \"SLB Multi-zona con Servidores Backend Multi-zona\",\n\t\t\"fr\": \"SLB Multi-zones avec Serveurs Backend Multi-zones\",\n\t\t\"pt\": \"SLB Multi-zona com Servidores Backend Multi-zona\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"SLB instances should be multi-zone, and all server groups used by listeners should have resources added from multiple zones.\",\n\t\t\"zh\": \"SLB 实例为多可用区，并且 SLB 实例下所有监听使用的服务器组中添加了多个可用区的资源，视为合规。\",\n\t\t\"ja\": \"SLB インスタンスはマルチゾーンである必要があり、リスナーが使用するすべてのサーバーグループに複数のゾーンからのリソースが追加されている必要があります。\",\n\t\t\"de\": \"SLB-Instanzen sollten Multi-Zone sein, und alle von Listenern verwendeten Servergruppen sollten Ressourcen aus mehreren Zonen hinzugefügt haben.\",\n\t\t\"es\": \"Las instancias SLB deben ser multi-zona, y todos los grupos de servidores utilizados por los listeners deben tener recursos agregados desde múltiples zonas.\",\n\t\t\"fr\": \"Les instances SLB doivent être multi-zones, et tous les groupes de serveurs utilisés par les listeners doivent avoir des ressources ajoutées depuis plusieurs zones.\",\n\t\t\"pt\": \"Instâncias SLB devem ser multi-zona, e todos os grupos de servidores usados pelos listeners devem ter recursos adicionados de múltiplas zonas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Single zone deployment or single zone backend servers lack high availability and may lead to service interruption during zone failure.\",\n\t\t\"zh\": \"单可用区部署或后端服务器仅位于单个可用区缺乏高可用性，可能在可用区故障时导致服务中断。\",\n\t\t\"ja\": \"単一ゾーン展開または単一ゾーンのバックエンドサーバーは高可用性に欠け、ゾーン障害時にサービス中断が発生する可能性があります。\",\n\t\t\"de\": \"Einzelzonen-Bereitstellung oder Einzelzonen-Backend-Server mangelt es an hoher Verfügbarkeit und kann zu Dienstunterbrechungen während eines Zonenausfalls führen.\",\n\t\t\"es\": \"La implementación de zona única o servidores backend de zona única carecen de alta disponibilidad y pueden provocar interrupciones del servicio durante una falla de zona.\",\n\t\t\"fr\": \"Le déploiement en zone unique ou les serveurs backend en zone unique manquent de haute disponibilité et peuvent entraîner une interruption de service lors d'une panne de zone.\",\n\t\t\"pt\": \"A implantação de zona única ou servidores backend de zona única carecem de alta disponibilidade e podem levar à interrupção do serviço durante falha de zona.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure SLB instances with master and slave zones, and ensure backend server groups include instances from different availability zones.\",\n\t\t\"zh\": \"为 SLB 实例配置主备可用区，并确保后端服务器组包含来自不同可用区的实例。\",\n\t\t\"ja\": \"マスターゾーンとスレーブゾーンで SLB インスタンスを設定し、バックエンドサーバーグループに異なる可用性ゾーンからのインスタンスが含まれるようにします。\",\n\t\t\"de\": \"Konfigurieren Sie SLB-Instanzen mit Master- und Slave-Zonen und stellen Sie sicher, dass Backend-Servergruppen Instanzen aus verschiedenen Verfügbarkeitszonen enthalten.\",\n\t\t\"es\": \"Configure instancias SLB con zonas maestra y esclava, y asegúrese de que los grupos de servidores backend incluyan instancias de diferentes zonas de disponibilidad.\",\n\t\t\"fr\": \"Configurez les instances SLB avec des zones maître et esclave, et assurez-vous que les groupes de serveurs backend incluent des instances de différentes zones de disponibilité.\",\n\t\t\"pt\": \"Configure instâncias SLB com zonas mestre e escrava, e garanta que grupos de servidores backend incluam instâncias de diferentes zonas de disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\n# Check if SLB instance has slave zone configured\nis_multi_zone(resource) if {\n\thelpers.has_property(resource, \"SlaveZoneId\")\n\tslave_zone := resource.Properties.SlaveZoneId\n\tslave_zone != \"\"\n}\n\n# Deny rule: SLB instances should be multi-zone\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SlaveZoneId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-all-listenter-has-server", Name: models.I18nString{"de": "SLB alle Listener haben Backend-Server", "en": "SLB All Listeners Have Backend Servers", "es": "Todos los Oyentes SLB Tienen Servidores Backend", "fr": "Tous les Auditeurs SLB ont des Serveurs Backend", "ja": "SLB のすべてのリスナーにバックエンドサーバーがある", "pt": "Todos os Ouvintes SLB Têm Servidores Backend", "zh": "SLB 负载均衡的所有监听都至少添加了指定数量的后端服务器"}, Severity: "medium", Description: models.I18nString{"de": "Alle Listener von SLB-Instanzen sollten mindestens die angegebene Anzahl von Backend-Servern angehängt haben.", "en": "All listeners of SLB instances should have at least the specified number of backend servers attached.", "es": "Todos los oyentes de las instancias SLB deben tener al menos el número especificado de servidores backend adjuntos.", "fr": "Tous les auditeurs des instances SLB doivent avoir au moins le nombre spécifié de serveurs backend attachés.", "ja": "SLB インスタンスのすべてのリスナーには、少なくとも指定された数のバックエンドサーバーが接続されている必要があります。", "pt": "Todos os ouvintes das instâncias SLB devem ter pelo menos o número especificado de servidores backend anexados.", "zh": "SLB 负载均衡的所有监听都至少添加参数指定数量的后端服务器，视为合规。默认至少添加一台服务器视为合规。"}, Reason: models.I18nString{"de": "Listener ohne Backend-Server können keinen Datenverkehr weiterleiten, was zu Service-Unverfügbarkeit führt.", "en": "Listeners without backend servers cannot forward traffic, leading to service unavailability.", "es": "Los oyentes sin servidores backend no pueden reenviar tráfico, lo que lleva a la indisponibilidad del servicio.", "fr": "Les auditeurs sans serveurs backend ne peuvent pas transférer le trafic, ce qui entraîne l'indisponibilité du service.", "ja": "バックエンドサーバーがないリスナーはトラフィックを転送できず、サービスが利用できなくなります。", "pt": "Ouvintes sem servidores backend não podem encaminhar tráfego, levando à indisponibilidade do serviço.", "zh": "没有后端服务器的监听无法转发流量，导致服务不可用。"}, Recommendation: models.I18nString{"de": "Fügen Sie allen Listenern mindestens die mindestens erforderliche Anzahl von Backend-Servern hinzu.", "en": "Attach at least the minimum required number of backend servers to all listeners.", "es": "Adjunte al menos el número mínimo requerido de servidores backend a todos los oyentes.", "fr": "Attachez au moins le nombre minimum requis de serveurs backend à tous les auditeurs.", "ja": "すべてのリスナーに少なくとも最小限必要な数のバックエンドサーバーを接続します。", "pt": "Anexe pelo menos o número mínimo necessário de servidores backend a todos os ouvintes.", "zh": "为所有监听至少添加所需最小数量的后端服务器。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-all-listenter-has-server.rego", PackageName: "infraguard.rules.aliyun.slb_all_listenter_has_server", Content: "package infraguard.rules.aliyun.slb_all_listenter_has_server\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-all-listenter-has-server\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB All Listeners Have Backend Servers\",\n\t\t\"zh\": \"SLB 负载均衡的所有监听都至少添加了指定数量的后端服务器\",\n\t\t\"ja\": \"SLB のすべてのリスナーにバックエンドサーバーがある\",\n\t\t\"de\": \"SLB alle Listener haben Backend-Server\",\n\t\t\"es\": \"Todos los Oyentes SLB Tienen Servidores Backend\",\n\t\t\"fr\": \"Tous les Auditeurs SLB ont des Serveurs Backend\",\n\t\t\"pt\": \"Todos os Ouvintes SLB Têm Servidores Backend\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"All listeners of SLB instances should have at least the specified number of backend servers attached.\",\n\t\t\"zh\": \"SLB 负载均衡的所有监听都至少添加参数指定数量的后端服务器，视为合规。默认至少添加一台服务器视为合规。\",\n\t\t\"ja\": \"SLB インスタンスのすべてのリスナーには、少なくとも指定された数のバックエンドサーバーが接続されている必要があります。\",\n\t\t\"de\": \"Alle Listener von SLB-Instanzen sollten mindestens die angegebene Anzahl von Backend-Servern angehängt haben.\",\n\t\t\"es\": \"Todos los oyentes de las instancias SLB deben tener al menos el número especificado de servidores backend adjuntos.\",\n\t\t\"fr\": \"Tous les auditeurs des instances SLB doivent avoir au moins le nombre spécifié de serveurs backend attachés.\",\n\t\t\"pt\": \"Todos os ouvintes das instâncias SLB devem ter pelo menos o número especificado de servidores backend anexados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Listeners without backend servers cannot forward traffic, leading to service unavailability.\",\n\t\t\"zh\": \"没有后端服务器的监听无法转发流量，导致服务不可用。\",\n\t\t\"ja\": \"バックエンドサーバーがないリスナーはトラフィックを転送できず、サービスが利用できなくなります。\",\n\t\t\"de\": \"Listener ohne Backend-Server können keinen Datenverkehr weiterleiten, was zu Service-Unverfügbarkeit führt.\",\n\t\t\"es\": \"Los oyentes sin servidores backend no pueden reenviar tráfico, lo que lleva a la indisponibilidad del servicio.\",\n\t\t\"fr\": \"Les auditeurs sans serveurs backend ne peuvent pas transférer le trafic, ce qui entraîne l'indisponibilité du service.\",\n\t\t\"pt\": \"Ouvintes sem servidores backend não podem encaminhar tráfego, levando à indisponibilidade do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Attach at least the minimum required number of backend servers to all listeners.\",\n\t\t\"zh\": \"为所有监听至少添加所需最小数量的后端服务器。\",\n\t\t\"ja\": \"すべてのリスナーに少なくとも最小限必要な数のバックエンドサーバーを接続します。\",\n\t\t\"de\": \"Fügen Sie allen Listenern mindestens die mindestens erforderliche Anzahl von Backend-Servern hinzu.\",\n\t\t\"es\": \"Adjunte al menos el número mínimo requerido de servidores backend a todos los oyentes.\",\n\t\t\"fr\": \"Attachez au moins le nombre minimum requis de serveurs backend à tous les auditeurs.\",\n\t\t\"pt\": \"Anexe pelo menos o número mínimo necessário de servidores backend a todos os ouvintes.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Listeners\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-all-listenter-tls-policy-check", Name: models.I18nString{"de": "SLB Listener TLS-Richtlinien-Prüfung", "en": "SLB Listener TLS Policy Check", "es": "Verificación de Política TLS del Listener SLB", "fr": "Vérification de la Politique TLS du Listener SLB", "ja": "SLB リスナーの TLS ポリシーチェック", "pt": "Verificação de Política TLS do Listener SLB", "zh": "SLB 监听使用安全 TLS 策略"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass SLB HTTPS-Listener sichere TLS-Verschlüsselungsrichtlinien verwenden.", "en": "Ensures SLB HTTPS listeners use secure TLS cipher policies.", "es": "Garantiza que los listeners HTTPS de SLB usen políticas de cifrado TLS seguras.", "fr": "Garantit que les listeners HTTPS SLB utilisent des politiques de chiffrement TLS sécurisées.", "ja": "SLB HTTPS リスナーが安全な TLS 暗号化ポリシーを使用していることを確認します。", "pt": "Garante que os listeners HTTPS SLB usem políticas de criptografia TLS seguras.", "zh": "确保 SLB HTTPS 监听使用安全的 TLS 加密策略。"}, Reason: models.I18nString{"de": "Schwache Verschlüsselungssuiten können ausgenutzt werden, um abgefangenen Datenverkehr zu entschlüsseln.", "en": "Weak cipher suites can be exploited to decrypt intercepted traffic.", "es": "Las suites de cifrado débiles pueden ser explotadas para descifrar el tráfico interceptado.", "fr": "Les suites de chiffrement faibles peuvent être exploitées pour déchiffrer le trafic intercepté.", "ja": "弱い暗号スイートは、傍受されたトラフィックを復号化するために悪用される可能性があります。", "pt": "Suites de criptografia fracas podem ser exploradas para descriptografar tráfego interceptado.", "zh": "弱加密套件可能被利用来解密截获的流量。"}, Recommendation: models.I18nString{"de": "Verwenden Sie eine empfohlene TLS-Richtlinie wie 'tls_cipher_policy_1_2'.", "en": "Use a recommended TLS policy like 'tls_cipher_policy_1_2'.", "es": "Use una política TLS recomendada como 'tls_cipher_policy_1_2'.", "fr": "Utilisez une politique TLS recommandée comme 'tls_cipher_policy_1_2'.", "ja": "'tls_cipher_policy_1_2' などの推奨 TLS ポリシーを使用します。", "pt": "Use uma política TLS recomendada como 'tls_cipher_policy_1_2'.", "zh": "使用推荐的 TLS 策略，如 'tls_cipher_policy_1_2'。"}, ResourceTypes: []string{"ALIYUN::SLB::Listener"}, FilePath: "aliyun/rules/slb-all-listenter-tls-policy-check.rego", PackageName: "infraguard.rules.aliyun.slb_all_listenter_tls_policy_check", Content: "package infraguard.rules.aliyun.slb_all_listenter_tls_policy_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-all-listenter-tls-policy-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Listener TLS Policy Check\",\n\t\t\"zh\": \"SLB 监听使用安全 TLS 策略\",\n\t\t\"ja\": \"SLB リスナーの TLS ポリシーチェック\",\n\t\t\"de\": \"SLB Listener TLS-Richtlinien-Prüfung\",\n\t\t\"es\": \"Verificación de Política TLS del Listener SLB\",\n\t\t\"fr\": \"Vérification de la Politique TLS du Listener SLB\",\n\t\t\"pt\": \"Verificação de Política TLS do Listener SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLB HTTPS listeners use secure TLS cipher policies.\",\n\t\t\"zh\": \"确保 SLB HTTPS 监听使用安全的 TLS 加密策略。\",\n\t\t\"ja\": \"SLB HTTPS リスナーが安全な TLS 暗号化ポリシーを使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB HTTPS-Listener sichere TLS-Verschlüsselungsrichtlinien verwenden.\",\n\t\t\"es\": \"Garantiza que los listeners HTTPS de SLB usen políticas de cifrado TLS seguras.\",\n\t\t\"fr\": \"Garantit que les listeners HTTPS SLB utilisent des politiques de chiffrement TLS sécurisées.\",\n\t\t\"pt\": \"Garante que os listeners HTTPS SLB usem políticas de criptografia TLS seguras.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Weak cipher suites can be exploited to decrypt intercepted traffic.\",\n\t\t\"zh\": \"弱加密套件可能被利用来解密截获的流量。\",\n\t\t\"ja\": \"弱い暗号スイートは、傍受されたトラフィックを復号化するために悪用される可能性があります。\",\n\t\t\"de\": \"Schwache Verschlüsselungssuiten können ausgenutzt werden, um abgefangenen Datenverkehr zu entschlüsseln.\",\n\t\t\"es\": \"Las suites de cifrado débiles pueden ser explotadas para descifrar el tráfico interceptado.\",\n\t\t\"fr\": \"Les suites de chiffrement faibles peuvent être exploitées pour déchiffrer le trafic intercepté.\",\n\t\t\"pt\": \"Suites de criptografia fracas podem ser exploradas para descriptografar tráfego interceptado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use a recommended TLS policy like 'tls_cipher_policy_1_2'.\",\n\t\t\"zh\": \"使用推荐的 TLS 策略，如 'tls_cipher_policy_1_2'。\",\n\t\t\"ja\": \"'tls_cipher_policy_1_2' などの推奨 TLS ポリシーを使用します。\",\n\t\t\"de\": \"Verwenden Sie eine empfohlene TLS-Richtlinie wie 'tls_cipher_policy_1_2'.\",\n\t\t\"es\": \"Use una política TLS recomendada como 'tls_cipher_policy_1_2'.\",\n\t\t\"fr\": \"Utilisez une politique TLS recommandée comme 'tls_cipher_policy_1_2'.\",\n\t\t\"pt\": \"Use uma política TLS recomendada como 'tls_cipher_policy_1_2'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::Listener\"]\n}\n\nis_compliant(resource) if {\n\tprotocol := helpers.get_property(resource, \"Protocol\", \"\")\n\tprotocol != \"https\"\n}\n\nis_compliant(resource) if {\n\tprotocol := helpers.get_property(resource, \"Protocol\", \"\")\n\tprotocol == \"https\"\n\tpolicy := helpers.get_property(resource, \"TLSCipherPolicy\", \"\")\n\n\t# Example: must be 1.2 or higher\n\tpolicy != \"\"\n\tnot helpers.includes([\"tls_cipher_policy_1_0\", \"tls_cipher_policy_1_1\"], policy)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TLSCipherPolicy\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-backendserver-weight-check", Name: models.I18nString{"de": "SLB-Backend-Server-Gewichtsprüfung", "en": "SLB Backend Server Weight Check", "es": "Verificación de Peso del Servidor Backend SLB", "fr": "Vérification du Poids du Serveur Backend SLB", "ja": "SLB バックエンドサーバーの重みチェック", "pt": "Verificação de Peso do Servidor Backend SLB", "zh": "SLB 后端服务器权重配置核查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass SLB-Backend-Server vernünftige Gewichtskonfigurationen haben.", "en": "Ensures SLB backend servers have reasonable weight configurations.", "es": "Garantiza que los servidores backend SLB tengan configuraciones de peso razonables.", "fr": "Garantit que les serveurs backend SLB ont des configurations de poids raisonnables.", "ja": "SLB バックエンドサーバーに合理的な重み設定があることを確認します。", "pt": "Garante que os servidores backend SLB tenham configurações de peso razoáveis.", "zh": "确保 SLB 后端服务器具有合理的权重配置。"}, Reason: models.I18nString{"de": "Ungleichmäßige Gewichtsverteilung kann zu unausgewogenem Datenverkehr und potenzieller Überlastung führen.", "en": "Uneven weight distribution can lead to unbalanced traffic and potential overload.", "es": "La distribución desigual del peso puede provocar tráfico desequilibrado y sobrecarga potencial.", "fr": "Une distribution de poids inégale peut entraîner un trafic déséquilibré et une surcharge potentielle.", "ja": "不均一な重み分布により、トラフィックの不均衡や潜在的な過負荷が発生する可能性があります。", "pt": "A distribuição desigual de peso pode levar a tráfego desequilibrado e sobrecarga potencial.", "zh": "权重分配不均可能导致流量失衡和潜在的负载过载。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass die Gewichte der Backend-Server korrekt eingestellt sind.", "en": "Ensure backend server weights are set correctly.", "es": "Asegúrese de que los pesos de los servidores backend estén configurados correctamente.", "fr": "Assurez-vous que les poids des serveurs backend sont correctement définis.", "ja": "バックエンドサーバーの重みが正しく設定されていることを確認します。", "pt": "Garanta que os pesos dos servidores backend estejam configurados corretamente.", "zh": "确保后端服务器权重设置正确。"}, ResourceTypes: []string{"ALIYUN::SLB::BackendServerAttachment"}, FilePath: "aliyun/rules/slb-backendserver-weight-check.rego", PackageName: "infraguard.rules.aliyun.slb_backendserver_weight_check", Content: "package infraguard.rules.aliyun.slb_backendserver_weight_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-backendserver-weight-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"SLB Backend Server Weight Check\",\n\t\t\"zh\": \"SLB 后端服务器权重配置核查\",\n\t\t\"ja\": \"SLB バックエンドサーバーの重みチェック\",\n\t\t\"de\": \"SLB-Backend-Server-Gewichtsprüfung\",\n\t\t\"es\": \"Verificación de Peso del Servidor Backend SLB\",\n\t\t\"fr\": \"Vérification du Poids du Serveur Backend SLB\",\n\t\t\"pt\": \"Verificação de Peso do Servidor Backend SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLB backend servers have reasonable weight configurations.\",\n\t\t\"zh\": \"确保 SLB 后端服务器具有合理的权重配置。\",\n\t\t\"ja\": \"SLB バックエンドサーバーに合理的な重み設定があることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-Backend-Server vernünftige Gewichtskonfigurationen haben.\",\n\t\t\"es\": \"Garantiza que los servidores backend SLB tengan configuraciones de peso razonables.\",\n\t\t\"fr\": \"Garantit que les serveurs backend SLB ont des configurations de poids raisonnables.\",\n\t\t\"pt\": \"Garante que os servidores backend SLB tenham configurações de peso razoáveis.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Uneven weight distribution can lead to unbalanced traffic and potential overload.\",\n\t\t\"zh\": \"权重分配不均可能导致流量失衡和潜在的负载过载。\",\n\t\t\"ja\": \"不均一な重み分布により、トラフィックの不均衡や潜在的な過負荷が発生する可能性があります。\",\n\t\t\"de\": \"Ungleichmäßige Gewichtsverteilung kann zu unausgewogenem Datenverkehr und potenzieller Überlastung führen.\",\n\t\t\"es\": \"La distribución desigual del peso puede provocar tráfico desequilibrado y sobrecarga potencial.\",\n\t\t\"fr\": \"Une distribution de poids inégale peut entraîner un trafic déséquilibré et une surcharge potentielle.\",\n\t\t\"pt\": \"A distribuição desigual de peso pode levar a tráfego desequilibrado e sobrecarga potencial.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure backend server weights are set correctly.\",\n\t\t\"zh\": \"确保后端服务器权重设置正确。\",\n\t\t\"ja\": \"バックエンドサーバーの重みが正しく設定されていることを確認します。\",\n\t\t\"de\": \"Stellen Sie sicher, dass die Gewichte der Backend-Server korrekt eingestellt sind.\",\n\t\t\"es\": \"Asegúrese de que los pesos de los servidores backend estén configurados correctamente.\",\n\t\t\"fr\": \"Assurez-vous que les poids des serveurs backend sont correctement définis.\",\n\t\t\"pt\": \"Garanta que os pesos dos servidores backend estejam configurados corretamente.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::BackendServerAttachment\"]\n}\n\nis_compliant(resource) if {\n\tservers := helpers.get_property(resource, \"BackendServers\", [])\n\tsome server in servers\n\tweight := object.get(server, \"Weight\", 100)\n\tweight > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::BackendServerAttachment\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"BackendServers\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-default-server-group-multi-server", Name: models.I18nString{"de": "SLB-Standard-Servergruppe hat mehrere Server", "en": "SLB Default Server Group Has Multiple Servers", "es": "El Grupo de Servidores Predeterminado SLB Tiene Múltiples Servidores", "fr": "Le Groupe de Serveurs par Défaut SLB a Plusieurs Serveurs", "ja": "SLB デフォルトサーバーグループに複数のサーバーがある", "pt": "O Grupo de Servidores Padrão do SLB Tem Múltiplos Servidores", "zh": "SLB 实例默认服务器组包含至少两台服务器"}, Severity: "medium", Description: models.I18nString{"de": "Die Standard-Servergruppe von SLB-Instanzen sollte mindestens zwei Server haben, um einen Single Point of Failure zu vermeiden.", "en": "The default server group of SLB instances should have at least two servers to avoid single point of failure.", "es": "El grupo de servidores predeterminado de las instancias SLB debe tener al menos dos servidores para evitar un punto único de falla.", "fr": "Le groupe de serveurs par défaut des instances SLB doit avoir au moins deux serveurs pour éviter un point de défaillance unique.", "ja": "SLB インスタンスのデフォルトサーバーグループは、単一障害点を避けるために少なくとも 2 つのサーバーを持つ必要があります。", "pt": "O grupo de servidores padrão das instâncias SLB deve ter pelo menos dois servidores para evitar um ponto único de falha.", "zh": "SLB 实例的默认服务器组至少添加两台服务器，视为合规。"}, Reason: models.I18nString{"de": "Ein einzelner Backend-Server schafft einen Single Point of Failure und reduziert die Verfügbarkeit.", "en": "A single backend server creates a single point of failure and reduces availability.", "es": "Un solo servidor backend crea un punto único de falla y reduce la disponibilidad.", "fr": "Un seul serveur backend crée un point de défaillance unique et réduit la disponibilité.", "ja": "単一のバックエンドサーバーは単一障害点を作成し、可用性を低下させます。", "pt": "Um único servidor backend cria um ponto único de falha e reduz a disponibilidade.", "zh": "单一后端服务器创建单点故障并降低可用性。"}, Recommendation: models.I18nString{"de": "Fügen Sie mindestens zwei Server zur Standard-Servergruppe hinzu, um Hochverfügbarkeit zu gewährleisten.", "en": "Add at least two servers to the default server group for high availability.", "es": "Agregue al menos dos servidores al grupo de servidores predeterminado para alta disponibilidad.", "fr": "Ajoutez au moins deux serveurs au groupe de serveurs par défaut pour une haute disponibilité.", "ja": "高可用性のために、デフォルトサーバーグループに少なくとも 2 つのサーバーを追加します。", "pt": "Adicione pelo menos dois servidores ao grupo de servidores padrão para alta disponibilidade.", "zh": "为实现高可用性，在默认服务器组中至少添加两台服务器。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-default-server-group-multi-server.rego", PackageName: "infraguard.rules.aliyun.slb_default_server_group_multi_server", Content: "package infraguard.rules.aliyun.slb_default_server_group_multi_server\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-default-server-group-multi-server\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Default Server Group Has Multiple Servers\",\n\t\t\"zh\": \"SLB 实例默认服务器组包含至少两台服务器\",\n\t\t\"ja\": \"SLB デフォルトサーバーグループに複数のサーバーがある\",\n\t\t\"de\": \"SLB-Standard-Servergruppe hat mehrere Server\",\n\t\t\"es\": \"El Grupo de Servidores Predeterminado SLB Tiene Múltiples Servidores\",\n\t\t\"fr\": \"Le Groupe de Serveurs par Défaut SLB a Plusieurs Serveurs\",\n\t\t\"pt\": \"O Grupo de Servidores Padrão do SLB Tem Múltiplos Servidores\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"The default server group of SLB instances should have at least two servers to avoid single point of failure.\",\n\t\t\"zh\": \"SLB 实例的默认服务器组至少添加两台服务器，视为合规。\",\n\t\t\"ja\": \"SLB インスタンスのデフォルトサーバーグループは、単一障害点を避けるために少なくとも 2 つのサーバーを持つ必要があります。\",\n\t\t\"de\": \"Die Standard-Servergruppe von SLB-Instanzen sollte mindestens zwei Server haben, um einen Single Point of Failure zu vermeiden.\",\n\t\t\"es\": \"El grupo de servidores predeterminado de las instancias SLB debe tener al menos dos servidores para evitar un punto único de falla.\",\n\t\t\"fr\": \"Le groupe de serveurs par défaut des instances SLB doit avoir au moins deux serveurs pour éviter un point de défaillance unique.\",\n\t\t\"pt\": \"O grupo de servidores padrão das instâncias SLB deve ter pelo menos dois servidores para evitar um ponto único de falha.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"A single backend server creates a single point of failure and reduces availability.\",\n\t\t\"zh\": \"单一后端服务器创建单点故障并降低可用性。\",\n\t\t\"ja\": \"単一のバックエンドサーバーは単一障害点を作成し、可用性を低下させます。\",\n\t\t\"de\": \"Ein einzelner Backend-Server schafft einen Single Point of Failure und reduziert die Verfügbarkeit.\",\n\t\t\"es\": \"Un solo servidor backend crea un punto único de falla y reduce la disponibilidad.\",\n\t\t\"fr\": \"Un seul serveur backend crée un point de défaillance unique et réduit la disponibilité.\",\n\t\t\"pt\": \"Um único servidor backend cria um ponto único de falha e reduz a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add at least two servers to the default server group for high availability.\",\n\t\t\"zh\": \"为实现高可用性，在默认服务器组中至少添加两台服务器。\",\n\t\t\"ja\": \"高可用性のために、デフォルトサーバーグループに少なくとも 2 つのサーバーを追加します。\",\n\t\t\"de\": \"Fügen Sie mindestens zwei Server zur Standard-Servergruppe hinzu, um Hochverfügbarkeit zu gewährleisten.\",\n\t\t\"es\": \"Agregue al menos dos servidores al grupo de servidores predeterminado para alta disponibilidad.\",\n\t\t\"fr\": \"Ajoutez au moins deux serveurs au groupe de serveurs par défaut pour une haute disponibilité.\",\n\t\t\"pt\": \"Adicione pelo menos dois servidores ao grupo de servidores padrão para alta disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nhas_multiple_servers(resource) if {\n\tbackend_servers := helpers.get_property(resource, \"BackendServers\", [])\n\tcount(backend_servers) >= 2\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot has_multiple_servers(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"BackendServers\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-delete-protection-enabled", Name: models.I18nString{"de": "SLB-Instanz-Löschschutz aktiviert", "en": "SLB Instance Deletion Protection Enabled", "es": "Protección contra Eliminación de Instancia SLB Habilitada", "fr": "Protection contre la Suppression d'Instance SLB Activée", "ja": "SLB インスタンスの削除保護が有効", "pt": "Proteção contra Exclusão de Instância SLB Habilitada", "zh": "SLB 实例开启释放保护"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass SLB-Instanzen den Löschschutz aktiviert haben.", "en": "Ensures that SLB instances have deletion protection enabled.", "es": "Garantiza que las instancias SLB tengan protección contra eliminación habilitada.", "fr": "Garantit que les instances SLB ont la protection contre la suppression activée.", "ja": "SLB インスタンスで削除保護が有効になっていることを確認します。", "pt": "Garante que as instâncias SLB tenham proteção contra exclusão habilitada.", "zh": "确保 SLB 实例开启了释放保护。"}, Reason: models.I18nString{"de": "Wenn der Löschschutz nicht aktiviert ist, kann die SLB-Instanz versehentlich freigegeben werden, was zu Dienstunterbrechungen führt.", "en": "If deletion protection is not enabled, the SLB instance may be released accidentally, causing service interruption.", "es": "Si la protección contra eliminación no está habilitada, la instancia SLB puede ser liberada accidentalmente, causando interrupción del servicio.", "fr": "Si la protection contre la suppression n'est pas activée, l'instance SLB peut être libérée accidentellement, provoquant une interruption de service.", "ja": "削除保護が有効になっていない場合、SLB インスタンスが誤って解放され、サービス中断が発生する可能性があります。", "pt": "Se a proteção contra exclusão não estiver habilitada, a instância SLB pode ser liberada acidentalmente, causando interrupção do serviço.", "zh": "如果未开启释放保护，SLB 实例可能会被意外释放，导致业务中断。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Löschschutz für die SLB-Instanz.", "en": "Enable deletion protection for the SLB instance.", "es": "Habilite protección contra eliminación para la instancia SLB.", "fr": "Activez la protection contre la suppression pour l'instance SLB.", "ja": "SLB インスタンスで削除保護を有効にします。", "pt": "Habilite proteção contra exclusão para a instância SLB.", "zh": "为 SLB 实例开启释放保护功能。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-delete-protection-enabled.rego", PackageName: "infraguard.rules.aliyun.slb_delete_protection_enabled", Content: "package infraguard.rules.aliyun.slb_delete_protection_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"slb-delete-protection-enabled\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"SLB Instance Deletion Protection Enabled\",\n\t\t\"zh\": \"SLB 实例开启释放保护\",\n\t\t\"ja\": \"SLB インスタンスの削除保護が有効\",\n\t\t\"de\": \"SLB-Instanz-Löschschutz aktiviert\",\n\t\t\"es\": \"Protección contra Eliminación de Instancia SLB Habilitada\",\n\t\t\"fr\": \"Protection contre la Suppression d'Instance SLB Activée\",\n\t\t\"pt\": \"Proteção contra Exclusão de Instância SLB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that SLB instances have deletion protection enabled.\",\n\t\t\"zh\": \"确保 SLB 实例开启了释放保护。\",\n\t\t\"ja\": \"SLB インスタンスで削除保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-Instanzen den Löschschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias SLB tengan protección contra eliminación habilitada.\",\n\t\t\"fr\": \"Garantit que les instances SLB ont la protection contre la suppression activée.\",\n\t\t\"pt\": \"Garante que as instâncias SLB tenham proteção contra exclusão habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If deletion protection is not enabled, the SLB instance may be released accidentally, causing service interruption.\",\n\t\t\"zh\": \"如果未开启释放保护，SLB 实例可能会被意外释放，导致业务中断。\",\n\t\t\"ja\": \"削除保護が有効になっていない場合、SLB インスタンスが誤って解放され、サービス中断が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Löschschutz nicht aktiviert ist, kann die SLB-Instanz versehentlich freigegeben werden, was zu Dienstunterbrechungen führt.\",\n\t\t\"es\": \"Si la protección contra eliminación no está habilitada, la instancia SLB puede ser liberada accidentalmente, causando interrupción del servicio.\",\n\t\t\"fr\": \"Si la protection contre la suppression n'est pas activée, l'instance SLB peut être libérée accidentellement, provoquant une interruption de service.\",\n\t\t\"pt\": \"Se a proteção contra exclusão não estiver habilitada, a instância SLB pode ser liberada acidentalmente, causando interrupção do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable deletion protection for the SLB instance.\",\n\t\t\"zh\": \"为 SLB 实例开启释放保护功能。\",\n\t\t\"ja\": \"SLB インスタンスで削除保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Löschschutz für die SLB-Instanz.\",\n\t\t\"es\": \"Habilite protección contra eliminación para la instancia SLB.\",\n\t\t\"fr\": \"Activez la protection contre la suppression pour l'instance SLB.\",\n\t\t\"pt\": \"Habilite proteção contra exclusão para a instância SLB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"DeletionProtection\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DeletionProtection\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-instance-autorenewal-check", Name: models.I18nString{"de": "SLB-Instanz Auto-Verlängerungsprüfung", "en": "SLB Instance Auto-Renewal Check", "es": "Verificación de Renovación Automática de Instancia SLB", "fr": "Vérification de Renouvellement Automatique d'Instance SLB", "ja": "SLB インスタンス自動更新チェック", "pt": "Verificação de Renovação Automática de Instância SLB", "zh": "SLB 实例包年包月开启自动续费"}, Severity: "medium", Description: models.I18nString{"de": "Vorausbezahlte SLB-Instanzen sollten Auto-Verlängerung aktiviert haben, um Dienstunterbrechungen zu vermeiden.", "en": "Prepaid SLB instances should have auto-renewal enabled to avoid service interruption.", "es": "Las instancias SLB prepagadas deben tener renovación automática habilitada para evitar interrupciones del servicio.", "fr": "Les instances SLB prépayées doivent avoir le renouvellement automatique activé pour éviter les interruptions de service.", "ja": "プリペイド SLB インスタンスは、サービス中断を避けるために自動更新を有効にする必要があります。", "pt": "Instâncias SLB pré-pagas devem ter renovação automática habilitada para evitar interrupção do serviço.", "zh": "包年包月的 SLB 实例开启了自动续费，视为合规。"}, Reason: models.I18nString{"de": "SLB-Instanzen ohne Auto-Verlängerung können ablaufen und Dienstunterbrechungen verursachen.", "en": "SLB instances without auto-renewal may expire and cause service interruption.", "es": "Las instancias SLB sin renovación automática pueden expirar y causar interrupción del servicio.", "fr": "Les instances SLB sans renouvellement automatique peuvent expirer et causer une interruption de service.", "ja": "自動更新がない SLB インスタンスは期限切れになり、サービス中断を引き起こす可能性があります。", "pt": "Instâncias SLB sem renovação automática podem expirar e causar interrupção do serviço.", "zh": "未开启自动续费的 SLB 实例可能到期并导致服务中断。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Auto-Verlängerung für vorausbezahlte SLB-Instanzen.", "en": "Enable auto-renewal for prepaid SLB instances.", "es": "Habilite la renovación automática para instancias SLB prepagadas.", "fr": "Activez le renouvellement automatique pour les instances SLB prépayées.", "ja": "プリペイド SLB インスタンスの自動更新を有効にします。", "pt": "Habilite a renovação automática para instâncias SLB pré-pagas.", "zh": "为包年包月 SLB 实例开启自动续费。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-instance-autorenewal-check.rego", PackageName: "infraguard.rules.aliyun.slb_instance_autorenewal_check", Content: "package infraguard.rules.aliyun.slb_instance_autorenewal_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-instance-autorenewal-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Instance Auto-Renewal Check\",\n\t\t\"zh\": \"SLB 实例包年包月开启自动续费\",\n\t\t\"ja\": \"SLB インスタンス自動更新チェック\",\n\t\t\"de\": \"SLB-Instanz Auto-Verlängerungsprüfung\",\n\t\t\"es\": \"Verificación de Renovación Automática de Instancia SLB\",\n\t\t\"fr\": \"Vérification de Renouvellement Automatique d'Instance SLB\",\n\t\t\"pt\": \"Verificação de Renovação Automática de Instância SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Prepaid SLB instances should have auto-renewal enabled to avoid service interruption.\",\n\t\t\"zh\": \"包年包月的 SLB 实例开启了自动续费，视为合规。\",\n\t\t\"ja\": \"プリペイド SLB インスタンスは、サービス中断を避けるために自動更新を有効にする必要があります。\",\n\t\t\"de\": \"Vorausbezahlte SLB-Instanzen sollten Auto-Verlängerung aktiviert haben, um Dienstunterbrechungen zu vermeiden.\",\n\t\t\"es\": \"Las instancias SLB prepagadas deben tener renovación automática habilitada para evitar interrupciones del servicio.\",\n\t\t\"fr\": \"Les instances SLB prépayées doivent avoir le renouvellement automatique activé pour éviter les interruptions de service.\",\n\t\t\"pt\": \"Instâncias SLB pré-pagas devem ter renovação automática habilitada para evitar interrupção do serviço.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"SLB instances without auto-renewal may expire and cause service interruption.\",\n\t\t\"zh\": \"未开启自动续费的 SLB 实例可能到期并导致服务中断。\",\n\t\t\"ja\": \"自動更新がない SLB インスタンスは期限切れになり、サービス中断を引き起こす可能性があります。\",\n\t\t\"de\": \"SLB-Instanzen ohne Auto-Verlängerung können ablaufen und Dienstunterbrechungen verursachen.\",\n\t\t\"es\": \"Las instancias SLB sin renovación automática pueden expirar y causar interrupción del servicio.\",\n\t\t\"fr\": \"Les instances SLB sans renouvellement automatique peuvent expirer et causer une interruption de service.\",\n\t\t\"pt\": \"Instâncias SLB sem renovação automática podem expirar e causar interrupção do serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable auto-renewal for prepaid SLB instances.\",\n\t\t\"zh\": \"为包年包月 SLB 实例开启自动续费。\",\n\t\t\"ja\": \"プリペイド SLB インスタンスの自動更新を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Auto-Verlängerung für vorausbezahlte SLB-Instanzen.\",\n\t\t\"es\": \"Habilite la renovación automática para instancias SLB prepagadas.\",\n\t\t\"fr\": \"Activez le renouvellement automatique pour les instances SLB prépayées.\",\n\t\t\"pt\": \"Habilite a renovação automática para instâncias SLB pré-pagas.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nis_prepaid(resource) if {\n\tcharge_type := helpers.get_property(resource, \"InstanceChargeType\", \"\")\n\tcharge_type == \"Prepaid\"\n}\n\nhas_autorenewal(resource) if {\n\tauto_renew := helpers.get_property(resource, \"AutoRenew\", false)\n\tauto_renew == true\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tis_prepaid(resource)\n\tnot has_autorenewal(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AutoRenew\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-instance-default-server-group-multi-zone", Name: models.I18nString{"de": "SLB Standard-Server-Gruppe Multi-Zone", "en": "SLB Default Server Group Multi-Zone", "es": "Grupo de Servidores Predeterminado SLB Multi-Zona", "fr": "Groupe de Serveurs par Défaut SLB Multi-Zone", "ja": "SLB デフォルトサーバーグループのマルチゾーン", "pt": "Grupo de Servidores Padrão SLB Multi-Zona", "zh": "SLB 负载均衡默认服务器组添加多个可用区资源"}, Severity: "medium", Description: models.I18nString{"de": "Die Standard-Server-Gruppe von SLB-Instanzen sollte Ressourcen über mehrere Verfügbarkeitszonen verteilt haben.", "en": "The default server group of SLB instances should have resources distributed across multiple availability zones.", "es": "El grupo de servidores predeterminado de las instancias SLB debe tener recursos distribuidos en múltiples zonas de disponibilidad.", "fr": "Le groupe de serveurs par défaut des instances SLB doit avoir des ressources distribuées sur plusieurs zones de disponibilité.", "ja": "SLB インスタンスのデフォルトサーバーグループは、リソースを複数の可用性ゾーンに分散させる必要があります。", "pt": "O grupo de servidores padrão das instâncias SLB deve ter recursos distribuídos em múltiplas zonas de disponibilidade.", "zh": "SLB 负载均衡的默认服务器组挂载资源分布在多个可用区，视为合规。默认服务器组无挂载任何资源时不适用本规则，视为不适用。"}, Reason: models.I18nString{"de": "Einzelzonen-Backend-Server erstellen einen Single Point of Failure und reduzieren die Verfügbarkeit.", "en": "Single-zone backend servers create a single point of failure and reduce availability.", "es": "Los servidores backend de zona única crean un punto único de falla y reducen la disponibilidad.", "fr": "Les serveurs backend à zone unique créent un point de défaillance unique et réduisent la disponibilité.", "ja": "単一ゾーンのバックエンドサーバーは単一障害点を作成し、可用性を低下させます。", "pt": "Servidores backend de zona única criam um ponto único de falha e reduzem a disponibilidade.", "zh": "单可用区后端服务器创建单点故障并降低可用性。"}, Recommendation: models.I18nString{"de": "Verteilen Sie Backend-Server über mehrere Verfügbarkeitszonen für hohe Verfügbarkeit.", "en": "Distribute backend servers across multiple availability zones for high availability.", "es": "Distribuya los servidores backend en múltiples zonas de disponibilidad para alta disponibilidad.", "fr": "Répartissez les serveurs backend sur plusieurs zones de disponibilité pour une haute disponibilité.", "ja": "高可用性のために、バックエンドサーバーを複数の可用性ゾーンに分散します。", "pt": "Distribua servidores backend em múltiplas zonas de disponibilidade para alta disponibilidade.", "zh": "为实现高可用性，将后端服务器分布在多个可用区。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-instance-default-server-group-multi-zone.rego", PackageName: "infraguard.rules.aliyun.slb_instance_default_server_group_multi_zone", Content: "package infraguard.rules.aliyun.slb_instance_default_server_group_multi_zone\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-instance-default-server-group-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Default Server Group Multi-Zone\",\n\t\t\"zh\": \"SLB 负载均衡默认服务器组添加多个可用区资源\",\n\t\t\"ja\": \"SLB デフォルトサーバーグループのマルチゾーン\",\n\t\t\"de\": \"SLB Standard-Server-Gruppe Multi-Zone\",\n\t\t\"es\": \"Grupo de Servidores Predeterminado SLB Multi-Zona\",\n\t\t\"fr\": \"Groupe de Serveurs par Défaut SLB Multi-Zone\",\n\t\t\"pt\": \"Grupo de Servidores Padrão SLB Multi-Zona\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"The default server group of SLB instances should have resources distributed across multiple availability zones.\",\n\t\t\"zh\": \"SLB 负载均衡的默认服务器组挂载资源分布在多个可用区，视为合规。默认服务器组无挂载任何资源时不适用本规则，视为不适用。\",\n\t\t\"ja\": \"SLB インスタンスのデフォルトサーバーグループは、リソースを複数の可用性ゾーンに分散させる必要があります。\",\n\t\t\"de\": \"Die Standard-Server-Gruppe von SLB-Instanzen sollte Ressourcen über mehrere Verfügbarkeitszonen verteilt haben.\",\n\t\t\"es\": \"El grupo de servidores predeterminado de las instancias SLB debe tener recursos distribuidos en múltiples zonas de disponibilidad.\",\n\t\t\"fr\": \"Le groupe de serveurs par défaut des instances SLB doit avoir des ressources distribuées sur plusieurs zones de disponibilité.\",\n\t\t\"pt\": \"O grupo de servidores padrão das instâncias SLB deve ter recursos distribuídos em múltiplas zonas de disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Single-zone backend servers create a single point of failure and reduce availability.\",\n\t\t\"zh\": \"单可用区后端服务器创建单点故障并降低可用性。\",\n\t\t\"ja\": \"単一ゾーンのバックエンドサーバーは単一障害点を作成し、可用性を低下させます。\",\n\t\t\"de\": \"Einzelzonen-Backend-Server erstellen einen Single Point of Failure und reduzieren die Verfügbarkeit.\",\n\t\t\"es\": \"Los servidores backend de zona única crean un punto único de falla y reducen la disponibilidad.\",\n\t\t\"fr\": \"Les serveurs backend à zone unique créent un point de défaillance unique et réduisent la disponibilité.\",\n\t\t\"pt\": \"Servidores backend de zona única criam um ponto único de falha e reduzem a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Distribute backend servers across multiple availability zones for high availability.\",\n\t\t\"zh\": \"为实现高可用性，将后端服务器分布在多个可用区。\",\n\t\t\"ja\": \"高可用性のために、バックエンドサーバーを複数の可用性ゾーンに分散します。\",\n\t\t\"de\": \"Verteilen Sie Backend-Server über mehrere Verfügbarkeitszonen für hohe Verfügbarkeit.\",\n\t\t\"es\": \"Distribuya los servidores backend en múltiples zonas de disponibilidad para alta disponibilidad.\",\n\t\t\"fr\": \"Répartissez les serveurs backend sur plusieurs zones de disponibilité pour une haute disponibilité.\",\n\t\t\"pt\": \"Distribua servidores backend em múltiplas zonas de disponibilidade para alta disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nhas_multi_zone_servers(resource) if {\n\tbackend_servers := helpers.get_property(resource, \"BackendServers\", [])\n\n\t# Check if servers are in different zones\n\tcount(backend_servers) > 1\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tbackend_servers := helpers.get_property(resource, \"BackendServers\", [])\n\tcount(backend_servers) > 0\n\tnot has_multi_zone_servers(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"BackendServers\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-instance-loadbalancerspec-check", Name: models.I18nString{"de": "SLB-Instanz Spezifikationsprüfung", "en": "SLB Instance Spec Check", "es": "Verificación de Especificación de Instancia SLB", "fr": "Vérification de Spécification d'Instance SLB", "ja": "SLB インスタンス仕様チェック", "pt": "Verificação de Especificação de Instância SLB", "zh": "SLB 规格合规性检查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass SLB-Instanzen genehmigte Leistungsspezifikationen verwenden.", "en": "Ensures SLB instances use approved performance specifications.", "es": "Garantiza que las instancias SLB usen especificaciones de rendimiento aprobadas.", "fr": "Garantit que les instances SLB utilisent des spécifications de performance approuvées.", "ja": "SLB インスタンスが承認されたパフォーマンス仕様を使用していることを確認します。", "pt": "Garante que as instâncias SLB usem especificações de desempenho aprovadas.", "zh": "确保 SLB 实例使用批准的性能规格。"}, Reason: models.I18nString{"de": "Die Verwendung spezifischer Spezifikationen hilft bei der Kostenverwaltung und Leistungsstandardisierung.", "en": "Using specific specs helps in cost management and performance standardization.", "es": "Usar especificaciones específicas ayuda en la gestión de costos y la estandarización del rendimiento.", "fr": "L'utilisation de spécifications spécifiques aide à la gestion des coûts et à la standardisation des performances.", "ja": "特定の仕様を使用することで、コスト管理とパフォーマンスの標準化に役立ちます。", "pt": "Usar especificações específicas ajuda no gerenciamento de custos e padronização de desempenho.", "zh": "使用特定规格有助于成本管理和性能标准化。"}, Recommendation: models.I18nString{"de": "Verwenden Sie eine Spezifikation aus der genehmigten Liste (z. B. slb.s1.small).", "en": "Use a spec from the approved list (e.g., slb.s1.small).", "es": "Use una especificación de la lista aprobada (por ejemplo, slb.s1.small).", "fr": "Utilisez une spécification de la liste approuvée (par exemple, slb.s1.small).", "ja": "承認リストの仕様（例：slb.s1.small）を使用します。", "pt": "Use uma especificação da lista aprovada (por exemplo, slb.s1.small).", "zh": "使用批准列表中的规格（如 slb.s1.small）。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-instance-loadbalancerspec-check.rego", PackageName: "infraguard.rules.aliyun.slb_instance_loadbalancerspec_check", Content: "package infraguard.rules.aliyun.slb_instance_loadbalancerspec_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-instance-loadbalancerspec-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"SLB Instance Spec Check\",\n\t\t\"zh\": \"SLB 规格合规性检查\",\n\t\t\"ja\": \"SLB インスタンス仕様チェック\",\n\t\t\"de\": \"SLB-Instanz Spezifikationsprüfung\",\n\t\t\"es\": \"Verificación de Especificación de Instancia SLB\",\n\t\t\"fr\": \"Vérification de Spécification d'Instance SLB\",\n\t\t\"pt\": \"Verificação de Especificação de Instância SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLB instances use approved performance specifications.\",\n\t\t\"zh\": \"确保 SLB 实例使用批准的性能规格。\",\n\t\t\"ja\": \"SLB インスタンスが承認されたパフォーマンス仕様を使用していることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-Instanzen genehmigte Leistungsspezifikationen verwenden.\",\n\t\t\"es\": \"Garantiza que las instancias SLB usen especificaciones de rendimiento aprobadas.\",\n\t\t\"fr\": \"Garantit que les instances SLB utilisent des spécifications de performance approuvées.\",\n\t\t\"pt\": \"Garante que as instâncias SLB usem especificações de desempenho aprovadas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using specific specs helps in cost management and performance standardization.\",\n\t\t\"zh\": \"使用特定规格有助于成本管理和性能标准化。\",\n\t\t\"ja\": \"特定の仕様を使用することで、コスト管理とパフォーマンスの標準化に役立ちます。\",\n\t\t\"de\": \"Die Verwendung spezifischer Spezifikationen hilft bei der Kostenverwaltung und Leistungsstandardisierung.\",\n\t\t\"es\": \"Usar especificaciones específicas ayuda en la gestión de costos y la estandarización del rendimiento.\",\n\t\t\"fr\": \"L'utilisation de spécifications spécifiques aide à la gestion des coûts et à la standardisation des performances.\",\n\t\t\"pt\": \"Usar especificações específicas ajuda no gerenciamento de custos e padronização de desempenho.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use a spec from the approved list (e.g., slb.s1.small).\",\n\t\t\"zh\": \"使用批准列表中的规格（如 slb.s1.small）。\",\n\t\t\"ja\": \"承認リストの仕様（例：slb.s1.small）を使用します。\",\n\t\t\"de\": \"Verwenden Sie eine Spezifikation aus der genehmigten Liste (z. B. slb.s1.small).\",\n\t\t\"es\": \"Use una especificación de la lista aprobada (por ejemplo, slb.s1.small).\",\n\t\t\"fr\": \"Utilisez une spécification de la liste approuvée (par exemple, slb.s1.small).\",\n\t\t\"pt\": \"Use uma especificação da lista aprovada (por exemplo, slb.s1.small).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nallowed_specs := [\"slb.s1.small\", \"slb.s2.small\", \"slb.s3.small\"]\n\nis_compliant(resource) if {\n\tspec := helpers.get_property(resource, \"LoadBalancerSpec\", \"\")\n\thelpers.includes(allowed_specs, spec)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LoadBalancerSpec\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-instance-log-enabled", Name: models.I18nString{"de": "SLB-Instanz-Protokollierung aktiviert", "en": "SLB Instance Logging Enabled", "es": "Registro de Instancia SLB Habilitado", "fr": "Journalisation d'Instance SLB Activée", "ja": "SLB インスタンスでログ記録が有効", "pt": "Registro de Instância SLB Habilitado", "zh": "SLB 实例开启访问日志"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass Zugriffsprotokollierung für die SLB-Instanz aktiviert ist.", "en": "Ensures that access logging is enabled for the SLB instance.", "es": "Garantiza que el registro de acceso esté habilitado para la instancia SLB.", "fr": "Garantit que la journalisation d'accès est activée pour l'instance SLB.", "ja": "SLB インスタンスでアクセスログ記録が有効になっていることを確認します。", "pt": "Garante que o registro de acesso esteja habilitado para a instância SLB.", "zh": "确保 SLB 实例开启了访问日志。"}, Reason: models.I18nString{"de": "Zugriffsprotokolle sind unerlässlich für die Überwachung des Datenverkehrs und die Fehlerbehebung bei Verbindungs- und Sicherheitsproblemen.", "en": "Access logs are essential for auditing traffic and troubleshooting connectivity and security issues.", "es": "Los registros de acceso son esenciales para auditar el tráfico y solucionar problemas de conectividad y seguridad.", "fr": "Les journaux d'accès sont essentiels pour auditer le trafic et résoudre les problèmes de connectivité et de sécurité.", "ja": "アクセスログは、トラフィックの監査、接続とセキュリティの問題のトラブルシューティングに不可欠です。", "pt": "Os registros de acesso são essenciais para auditar tráfego e solucionar problemas de conectividade e segurança.", "zh": "访问日志对于审计流量以及排查连接和安全问题至关重要。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Zugriffsprotokollierung für die SLB-Instanz.", "en": "Enable access logging for the SLB instance.", "es": "Habilite el registro de acceso para la instancia SLB.", "fr": "Activez la journalisation d'accès pour l'instance SLB.", "ja": "SLB インスタンスでアクセスログ記録を有効にします。", "pt": "Habilite o registro de acesso para a instância SLB.", "zh": "为 SLB 实例开启访问日志。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-instance-log-enabled.rego", PackageName: "infraguard.rules.aliyun.slb_instance_log_enabled", Content: "package infraguard.rules.aliyun.slb_instance_log_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"slb-instance-log-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Instance Logging Enabled\",\n\t\t\"zh\": \"SLB 实例开启访问日志\",\n\t\t\"ja\": \"SLB インスタンスでログ記録が有効\",\n\t\t\"de\": \"SLB-Instanz-Protokollierung aktiviert\",\n\t\t\"es\": \"Registro de Instancia SLB Habilitado\",\n\t\t\"fr\": \"Journalisation d'Instance SLB Activée\",\n\t\t\"pt\": \"Registro de Instância SLB Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that access logging is enabled for the SLB instance.\",\n\t\t\"zh\": \"确保 SLB 实例开启了访问日志。\",\n\t\t\"ja\": \"SLB インスタンスでアクセスログ記録が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass Zugriffsprotokollierung für die SLB-Instanz aktiviert ist.\",\n\t\t\"es\": \"Garantiza que el registro de acceso esté habilitado para la instancia SLB.\",\n\t\t\"fr\": \"Garantit que la journalisation d'accès est activée pour l'instance SLB.\",\n\t\t\"pt\": \"Garante que o registro de acesso esteja habilitado para a instância SLB.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Access logs are essential for auditing traffic and troubleshooting connectivity and security issues.\",\n\t\t\"zh\": \"访问日志对于审计流量以及排查连接和安全问题至关重要。\",\n\t\t\"ja\": \"アクセスログは、トラフィックの監査、接続とセキュリティの問題のトラブルシューティングに不可欠です。\",\n\t\t\"de\": \"Zugriffsprotokolle sind unerlässlich für die Überwachung des Datenverkehrs und die Fehlerbehebung bei Verbindungs- und Sicherheitsproblemen.\",\n\t\t\"es\": \"Los registros de acceso son esenciales para auditar el tráfico y solucionar problemas de conectividad y seguridad.\",\n\t\t\"fr\": \"Les journaux d'accès sont essentiels pour auditer le trafic et résoudre les problèmes de connectivité et de sécurité.\",\n\t\t\"pt\": \"Os registros de acesso são essenciais para auditar tráfego e solucionar problemas de conectividade e segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable access logging for the SLB instance.\",\n\t\t\"zh\": \"为 SLB 实例开启访问日志。\",\n\t\t\"ja\": \"SLB インスタンスでアクセスログ記録を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Zugriffsprotokollierung für die SLB-Instanz.\",\n\t\t\"es\": \"Habilite el registro de acceso para la instancia SLB.\",\n\t\t\"fr\": \"Activez la journalisation d'accès pour l'instance SLB.\",\n\t\t\"pt\": \"Habilite o registro de acesso para a instância SLB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\n\t# Conceptual check for logging\n\tnot helpers.has_property(resource, \"AccessLog\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-instance-multi-zone", Name: models.I18nString{"de": "SLB-Instanz Multi-Zone-Bereitstellung", "en": "SLB Instance Multi-Zone Deployment", "es": "Implementación Multi-zona de Instancia SLB", "fr": "Déploiement Multi-zones de l'Instance SLB", "ja": "SLB インスタンスのマルチゾーン展開", "pt": "Implantação Multi-zona da Instância SLB", "zh": "SLB 实例多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "SLB-Instanzen sollten über mehrere Zonen hinweg bereitgestellt werden, indem sowohl Master- als auch Slave-Zonen für hohe Verfügbarkeit konfiguriert werden.", "en": "SLB instances should be deployed across multiple zones by configuring both master and slave zones for high availability.", "es": "Las instancias SLB deben implementarse en múltiples zonas configurando zonas maestra y esclava para alta disponibilidad.", "fr": "Les instances SLB doivent être déployées sur plusieurs zones en configurant à la fois les zones maître et esclave pour une haute disponibilité.", "ja": "SLB インスタンスは、高可用性のためにマスターゾーンとスレーブゾーンの両方を設定して、複数のゾーンに展開する必要があります。", "pt": "Instâncias SLB devem ser implantadas em múltiplas zonas configurando zonas mestre e escrava para alta disponibilidade.", "zh": "SLB 实例应通过配置主可用区和备可用区来部署在多个可用区，以实现高可用性。"}, Reason: models.I18nString{"de": "Die SLB-Instanz hat keine Slave-Zone konfiguriert, was die Verfügbarkeit während Zonenausfällen beeinträchtigen kann.", "en": "The SLB instance does not have a slave zone configured, which may affect availability during zone failures.", "es": "La instancia SLB no tiene una zona esclava configurada, lo que puede afectar la disponibilidad durante fallas de zona.", "fr": "L'instance SLB n'a pas de zone esclave configurée, ce qui peut affecter la disponibilité lors de pannes de zone.", "ja": "SLB インスタンスにスレーブゾーンが設定されていないため、ゾーン障害時に可用性に影響を与える可能性があります。", "pt": "A instância SLB não tem uma zona escrava configurada, o que pode afetar a disponibilidade durante falhas de zona.", "zh": "SLB 实例未配置备可用区，在可用区故障时可能影响可用性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie eine Slave-Zone, indem Sie die SlaveZoneId-Eigenschaft setzen, um Multi-Zone-Bereitstellung zu aktivieren.", "en": "Configure a slave zone by setting the SlaveZoneId property to enable multi-zone deployment.", "es": "Configure una zona esclava estableciendo la propiedad SlaveZoneId para habilitar la implementación multi-zona.", "fr": "Configurez une zone esclave en définissant la propriété SlaveZoneId pour activer le déploiement multi-zones.", "ja": "SlaveZoneId プロパティを設定してスレーブゾーンを設定し、マルチゾーン展開を有効にします。", "pt": "Configure uma zona escrava definindo a propriedade SlaveZoneId para habilitar a implantação multi-zona.", "zh": "通过设置 SlaveZoneId 属性配置备可用区，以启用多可用区部署。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-instance-multi-zone.rego", PackageName: "infraguard.rules.aliyun.slb_instance_multi_zone", Content: "package infraguard.rules.aliyun.slb_instance_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"slb-instance-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Instance Multi-Zone Deployment\",\n\t\t\"zh\": \"SLB 实例多可用区部署\",\n\t\t\"ja\": \"SLB インスタンスのマルチゾーン展開\",\n\t\t\"de\": \"SLB-Instanz Multi-Zone-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-zona de Instancia SLB\",\n\t\t\"fr\": \"Déploiement Multi-zones de l'Instance SLB\",\n\t\t\"pt\": \"Implantação Multi-zona da Instância SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"SLB instances should be deployed across multiple zones by configuring both master and slave zones for high availability.\",\n\t\t\"zh\": \"SLB 实例应通过配置主可用区和备可用区来部署在多个可用区，以实现高可用性。\",\n\t\t\"ja\": \"SLB インスタンスは、高可用性のためにマスターゾーンとスレーブゾーンの両方を設定して、複数のゾーンに展開する必要があります。\",\n\t\t\"de\": \"SLB-Instanzen sollten über mehrere Zonen hinweg bereitgestellt werden, indem sowohl Master- als auch Slave-Zonen für hohe Verfügbarkeit konfiguriert werden.\",\n\t\t\"es\": \"Las instancias SLB deben implementarse en múltiples zonas configurando zonas maestra y esclava para alta disponibilidad.\",\n\t\t\"fr\": \"Les instances SLB doivent être déployées sur plusieurs zones en configurant à la fois les zones maître et esclave pour une haute disponibilité.\",\n\t\t\"pt\": \"Instâncias SLB devem ser implantadas em múltiplas zonas configurando zonas mestre e escrava para alta disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The SLB instance does not have a slave zone configured, which may affect availability during zone failures.\",\n\t\t\"zh\": \"SLB 实例未配置备可用区，在可用区故障时可能影响可用性。\",\n\t\t\"ja\": \"SLB インスタンスにスレーブゾーンが設定されていないため、ゾーン障害時に可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Die SLB-Instanz hat keine Slave-Zone konfiguriert, was die Verfügbarkeit während Zonenausfällen beeinträchtigen kann.\",\n\t\t\"es\": \"La instancia SLB no tiene una zona esclava configurada, lo que puede afectar la disponibilidad durante fallas de zona.\",\n\t\t\"fr\": \"L'instance SLB n'a pas de zone esclave configurée, ce qui peut affecter la disponibilité lors de pannes de zone.\",\n\t\t\"pt\": \"A instância SLB não tem uma zona escrava configurada, o que pode afetar a disponibilidade durante falhas de zona.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure a slave zone by setting the SlaveZoneId property to enable multi-zone deployment.\",\n\t\t\"zh\": \"通过设置 SlaveZoneId 属性配置备可用区，以启用多可用区部署。\",\n\t\t\"ja\": \"SlaveZoneId プロパティを設定してスレーブゾーンを設定し、マルチゾーン展開を有効にします。\",\n\t\t\"de\": \"Konfigurieren Sie eine Slave-Zone, indem Sie die SlaveZoneId-Eigenschaft setzen, um Multi-Zone-Bereitstellung zu aktivieren.\",\n\t\t\"es\": \"Configure una zona esclava estableciendo la propiedad SlaveZoneId para habilitar la implementación multi-zona.\",\n\t\t\"fr\": \"Configurez une zone esclave en définissant la propriété SlaveZoneId pour activer le déploiement multi-zones.\",\n\t\t\"pt\": \"Configure uma zona escrava definindo a propriedade SlaveZoneId para habilitar a implantação multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\n# Check if instance has slave zone configured\nhas_slave_zone(resource) if {\n\thelpers.has_property(resource, \"SlaveZoneId\")\n\tslave_zone := resource.Properties.SlaveZoneId\n\tslave_zone != \"\"\n}\n\n# Deny rule: SLB instances should have slave zone configured\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot has_slave_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SlaveZoneId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-instance-spec-check", Name: models.I18nString{"de": "SLB-Instanz-Spezifikationsprüfung", "en": "SLB Instance Specification Check", "es": "Verificación de Especificación de Instancia SLB", "fr": "Vérification de Spécification d'Instance SLB", "ja": "SLB インスタンス仕様チェック", "pt": "Verificação de Especificação de Instância SLB", "zh": "SLB 实例规格满足要求"}, Severity: "medium", Description: models.I18nString{"de": "SLB-Instanz-Spezifikationen sollten die erforderlichen Leistungskriterien basierend auf der angegebenen Liste erfüllen.", "en": "SLB instance specifications should meet the required performance criteria based on the specified list.", "es": "Las especificaciones de instancia SLB deben cumplir con los criterios de rendimiento requeridos según la lista especificada.", "fr": "Les spécifications d'instance SLB doivent répondre aux critères de performance requis basés sur la liste spécifiée.", "ja": "SLB インスタンス仕様は、指定されたリストに基づいて必要なパフォーマンス基準を満たす必要があります。", "pt": "As especificações da instância SLB devem atender aos critérios de desempenho necessários com base na lista especificada.", "zh": "SLB 实例规格在指定的规格列表中，视为合规。"}, Reason: models.I18nString{"de": "Die Verwendung von SLB-Instanzen mit niedriger Spezifikation erfüllt möglicherweise nicht die Leistungsanforderungen und kann zu Engpässen führen.", "en": "Using low-specification SLB instances may not meet performance requirements and could lead to bottlenecks.", "es": "Usar instancias SLB de baja especificación puede no cumplir con los requisitos de rendimiento y podría llevar a cuellos de botella.", "fr": "L'utilisation d'instances SLB de faible spécification peut ne pas répondre aux exigences de performance et pourrait entraîner des goulots d'étranglement.", "ja": "低仕様の SLB インスタンスを使用すると、パフォーマンス要件を満たさない可能性があり、ボトルネックが発生する可能性があります。", "pt": "Usar instâncias SLB de baixa especificação pode não atender aos requisitos de desempenho e pode levar a gargalos.", "zh": "使用低规格 SLB 实例可能无法满足性能要求，可能导致瓶颈。"}, Recommendation: models.I18nString{"de": "Verwenden Sie SLB-Instanzen mit Spezifikationen, die Ihre Leistungsanforderungen erfüllen.", "en": "Use SLB instances with specifications that meet your performance requirements.", "es": "Use instancias SLB con especificaciones que cumplan con sus requisitos de rendimiento.", "fr": "Utilisez des instances SLB avec des spécifications qui répondent à vos exigences de performance.", "ja": "パフォーマンス要件を満たす仕様の SLB インスタンスを使用します。", "pt": "Use instâncias SLB com especificações que atendam aos seus requisitos de desempenho.", "zh": "使用满足性能要求的 SLB 实例规格。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-instance-spec-check.rego", PackageName: "infraguard.rules.aliyun.slb_instance_spec_check", Content: "package infraguard.rules.aliyun.slb_instance_spec_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-instance-spec-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Instance Specification Check\",\n\t\t\"zh\": \"SLB 实例规格满足要求\",\n\t\t\"ja\": \"SLB インスタンス仕様チェック\",\n\t\t\"de\": \"SLB-Instanz-Spezifikationsprüfung\",\n\t\t\"es\": \"Verificación de Especificación de Instancia SLB\",\n\t\t\"fr\": \"Vérification de Spécification d'Instance SLB\",\n\t\t\"pt\": \"Verificação de Especificação de Instância SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"SLB instance specifications should meet the required performance criteria based on the specified list.\",\n\t\t\"zh\": \"SLB 实例规格在指定的规格列表中，视为合规。\",\n\t\t\"ja\": \"SLB インスタンス仕様は、指定されたリストに基づいて必要なパフォーマンス基準を満たす必要があります。\",\n\t\t\"de\": \"SLB-Instanz-Spezifikationen sollten die erforderlichen Leistungskriterien basierend auf der angegebenen Liste erfüllen.\",\n\t\t\"es\": \"Las especificaciones de instancia SLB deben cumplir con los criterios de rendimiento requeridos según la lista especificada.\",\n\t\t\"fr\": \"Les spécifications d'instance SLB doivent répondre aux critères de performance requis basés sur la liste spécifiée.\",\n\t\t\"pt\": \"As especificações da instância SLB devem atender aos critérios de desempenho necessários com base na lista especificada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using low-specification SLB instances may not meet performance requirements and could lead to bottlenecks.\",\n\t\t\"zh\": \"使用低规格 SLB 实例可能无法满足性能要求，可能导致瓶颈。\",\n\t\t\"ja\": \"低仕様の SLB インスタンスを使用すると、パフォーマンス要件を満たさない可能性があり、ボトルネックが発生する可能性があります。\",\n\t\t\"de\": \"Die Verwendung von SLB-Instanzen mit niedriger Spezifikation erfüllt möglicherweise nicht die Leistungsanforderungen und kann zu Engpässen führen.\",\n\t\t\"es\": \"Usar instancias SLB de baja especificación puede no cumplir con los requisitos de rendimiento y podría llevar a cuellos de botella.\",\n\t\t\"fr\": \"L'utilisation d'instances SLB de faible spécification peut ne pas répondre aux exigences de performance et pourrait entraîner des goulots d'étranglement.\",\n\t\t\"pt\": \"Usar instâncias SLB de baixa especificação pode não atender aos requisitos de desempenho e pode levar a gargalos.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use SLB instances with specifications that meet your performance requirements.\",\n\t\t\"zh\": \"使用满足性能要求的 SLB 实例规格。\",\n\t\t\"ja\": \"パフォーマンス要件を満たす仕様の SLB インスタンスを使用します。\",\n\t\t\"de\": \"Verwenden Sie SLB-Instanzen mit Spezifikationen, die Ihre Leistungsanforderungen erfüllen.\",\n\t\t\"es\": \"Use instancias SLB con especificaciones que cumplan con sus requisitos de rendimiento.\",\n\t\t\"fr\": \"Utilisez des instances SLB avec des spécifications qui répondent à vos exigences de performance.\",\n\t\t\"pt\": \"Use instâncias SLB com especificações que atendam aos seus requisitos de desempenho.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\n# Allowed specifications (example)\nallowed_specs := {\n\t\"slb.s3.small\",\n\t\"slb.s3.medium\",\n\t\"slb.s3.large\",\n\t\"slb.s3.xlarge\",\n\t\"slb.s3.xxlarge\",\n}\n\nis_valid_spec(resource) if {\n\tspec := helpers.get_property(resource, \"LoadBalancerSpec\", \"\")\n\tspec == \"\"\n}\n\nis_valid_spec(resource) if {\n\tspec := helpers.get_property(resource, \"LoadBalancerSpec\", \"\")\n\tspec in allowed_specs\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot is_valid_spec(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LoadBalancerSpec\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-listener-https-enabled", Name: models.I18nString{"de": "SLB-Listener HTTPS aktiviert", "en": "SLB Listener HTTPS Enabled", "es": "HTTPS de Listener SLB Habilitado", "fr": "HTTPS du Listener SLB Activé", "ja": "SLB リスナーで HTTPS が有効", "pt": "HTTPS de Listener SLB Habilitado", "zh": "SLB 监听开启 HTTPS"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass SLB-Listener das HTTPS-Protokoll für sichere Kommunikation verwenden.", "en": "Ensures SLB listeners use HTTPS protocol for secure communication.", "es": "Garantiza que los listeners SLB usen el protocolo HTTPS para comunicación segura.", "fr": "Garantit que les listeners SLB utilisent le protocole HTTPS pour une communication sécurisée.", "ja": "SLB リスナーが安全な通信のために HTTPS プロトコルを使用することを確認します。", "pt": "Garante que os listeners SLB usem o protocolo HTTPS para comunicação segura.", "zh": "确保 SLB 监听使用 HTTPS 协议以保障通信安全。"}, Reason: models.I18nString{"de": "Das HTTP-Protokoll ist unsicher und anfällig für Abhören. HTTPS bietet Verschlüsselung.", "en": "HTTP protocol is insecure and prone to eavesdropping. HTTPS provides encryption.", "es": "El protocolo HTTP es inseguro y propenso a interceptación. HTTPS proporciona cifrado.", "fr": "Le protocole HTTP est non sécurisé et sujet à l'écoute. HTTPS fournit le chiffrement.", "ja": "HTTP プロトコルは安全ではなく、盗聴されやすいです。HTTPS は暗号化を提供します。", "pt": "O protocolo HTTP é inseguro e propenso a interceptação. HTTPS fornece criptografia.", "zh": "HTTP 协议不安全，容易被窃听。HTTPS 提供加密保障。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie SLB-Listener so, dass sie HTTPS anstelle von HTTP verwenden.", "en": "Configure SLB listeners to use HTTPS instead of HTTP.", "es": "Configure listeners SLB para usar HTTPS en lugar de HTTP.", "fr": "Configurez les listeners SLB pour utiliser HTTPS au lieu de HTTP.", "ja": "SLB リスナーを HTTP ではなく HTTPS を使用するように設定します。", "pt": "Configure listeners SLB para usar HTTPS em vez de HTTP.", "zh": "将 SLB 监听配置为使用 HTTPS 而非 HTTP。"}, ResourceTypes: []string{"ALIYUN::SLB::Listener"}, FilePath: "aliyun/rules/slb-listener-https-enabled.rego", PackageName: "infraguard.rules.aliyun.slb_listener_https_enabled", Content: "package infraguard.rules.aliyun.slb_listener_https_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-listener-https-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Listener HTTPS Enabled\",\n\t\t\"zh\": \"SLB 监听开启 HTTPS\",\n\t\t\"ja\": \"SLB リスナーで HTTPS が有効\",\n\t\t\"de\": \"SLB-Listener HTTPS aktiviert\",\n\t\t\"es\": \"HTTPS de Listener SLB Habilitado\",\n\t\t\"fr\": \"HTTPS du Listener SLB Activé\",\n\t\t\"pt\": \"HTTPS de Listener SLB Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLB listeners use HTTPS protocol for secure communication.\",\n\t\t\"zh\": \"确保 SLB 监听使用 HTTPS 协议以保障通信安全。\",\n\t\t\"ja\": \"SLB リスナーが安全な通信のために HTTPS プロトコルを使用することを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-Listener das HTTPS-Protokoll für sichere Kommunikation verwenden.\",\n\t\t\"es\": \"Garantiza que los listeners SLB usen el protocolo HTTPS para comunicación segura.\",\n\t\t\"fr\": \"Garantit que les listeners SLB utilisent le protocole HTTPS pour une communication sécurisée.\",\n\t\t\"pt\": \"Garante que os listeners SLB usem o protocolo HTTPS para comunicação segura.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"HTTP protocol is insecure and prone to eavesdropping. HTTPS provides encryption.\",\n\t\t\"zh\": \"HTTP 协议不安全，容易被窃听。HTTPS 提供加密保障。\",\n\t\t\"ja\": \"HTTP プロトコルは安全ではなく、盗聴されやすいです。HTTPS は暗号化を提供します。\",\n\t\t\"de\": \"Das HTTP-Protokoll ist unsicher und anfällig für Abhören. HTTPS bietet Verschlüsselung.\",\n\t\t\"es\": \"El protocolo HTTP es inseguro y propenso a interceptación. HTTPS proporciona cifrado.\",\n\t\t\"fr\": \"Le protocole HTTP est non sécurisé et sujet à l'écoute. HTTPS fournit le chiffrement.\",\n\t\t\"pt\": \"O protocolo HTTP é inseguro e propenso a interceptação. HTTPS fornece criptografia.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure SLB listeners to use HTTPS instead of HTTP.\",\n\t\t\"zh\": \"将 SLB 监听配置为使用 HTTPS 而非 HTTP。\",\n\t\t\"ja\": \"SLB リスナーを HTTP ではなく HTTPS を使用するように設定します。\",\n\t\t\"de\": \"Konfigurieren Sie SLB-Listener so, dass sie HTTPS anstelle von HTTP verwenden.\",\n\t\t\"es\": \"Configure listeners SLB para usar HTTPS en lugar de HTTP.\",\n\t\t\"fr\": \"Configurez les listeners SLB pour utiliser HTTPS au lieu de HTTP.\",\n\t\t\"pt\": \"Configure listeners SLB para usar HTTPS em vez de HTTP.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::Listener\"]\n}\n\nis_compliant(resource) if {\n\tprotocol := helpers.get_property(resource, \"Protocol\", \"\")\n\tprotocol == \"https\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Protocol\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-listener-risk-ports-check", Name: models.I18nString{"de": "SLB Listener Risiko-Ports-Prüfung", "en": "SLB Listener Risk Ports Check", "es": "Verificación de Puertos de Riesgo del Listener SLB", "fr": "Vérification des Ports à Risque du Listener SLB", "ja": "SLB リスナーのリスクポートチェック", "pt": "Verificação de Portas de Risco do Listener SLB", "zh": "SLB 监听禁用高风险端口"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass SLB-Listener keine Hochrisiko-Ports wie 22 oder 3389 freigeben.", "en": "Ensures SLB listeners do not expose high-risk ports like 22 or 3389.", "es": "Garantiza que los listeners SLB no expongan puertos de alto riesgo como 22 o 3389.", "fr": "Garantit que les listeners SLB n'exposent pas de ports à haut risque comme 22 ou 3389.", "ja": "SLB リスナーが 22 や 3389 などのリスクポートを公開していないことを確認します。", "pt": "Garante que os listeners SLB não exponham portas de alto risco como 22 ou 3389.", "zh": "确保 SLB 监听未暴露 22、3389 等高风险端口。"}, Reason: models.I18nString{"de": "Das Freigeben von Verwaltungsports über SLB an das Internet erhöht das Risiko unbefugten Zugriffs.", "en": "Exposing management ports to the internet via SLB increases the risk of unauthorized access.", "es": "Exponer puertos de administración a internet a través de SLB aumenta el riesgo de acceso no autorizado.", "fr": "Exposer les ports de gestion à Internet via SLB augmente le risque d'accès non autorisé.", "ja": "SLB を介して管理ポートをインターネットに公開すると、不正アクセスのリスクが増加します。", "pt": "Expor portas de gerenciamento à internet via SLB aumenta o risco de acesso não autorizado.", "zh": "通过 SLB 向互联网暴露管理端口会增加未经授权访问的风险。"}, Recommendation: models.I18nString{"de": "Verwenden Sie verschiedene Ports für öffentliche Dienste oder verwenden Sie ein VPN/Bastion Host für die Verwaltung.", "en": "Use different ports for public services or use a VPN/Bastion Host for management.", "es": "Use puertos diferentes para servicios públicos o use un VPN/Host Bastión para administración.", "fr": "Utilisez des ports différents pour les services publics ou utilisez un VPN/Hôte Bastion pour la gestion.", "ja": "パブリックサービスには異なるポートを使用するか、管理には VPN/バスティオンホストを使用します。", "pt": "Use portas diferentes para serviços públicos ou use VPN/Host Bastião para gerenciamento.", "zh": "为公共服务使用其他端口，或使用 VPN/堡垒机进行管理。"}, ResourceTypes: []string{"ALIYUN::SLB::Listener"}, FilePath: "aliyun/rules/slb-listener-risk-ports-check.rego", PackageName: "infraguard.rules.aliyun.slb_listener_risk_ports_check", Content: "package infraguard.rules.aliyun.slb_listener_risk_ports_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-listener-risk-ports-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"SLB Listener Risk Ports Check\",\n\t\t\"zh\": \"SLB 监听禁用高风险端口\",\n\t\t\"ja\": \"SLB リスナーのリスクポートチェック\",\n\t\t\"de\": \"SLB Listener Risiko-Ports-Prüfung\",\n\t\t\"es\": \"Verificación de Puertos de Riesgo del Listener SLB\",\n\t\t\"fr\": \"Vérification des Ports à Risque du Listener SLB\",\n\t\t\"pt\": \"Verificação de Portas de Risco do Listener SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLB listeners do not expose high-risk ports like 22 or 3389.\",\n\t\t\"zh\": \"确保 SLB 监听未暴露 22、3389 等高风险端口。\",\n\t\t\"ja\": \"SLB リスナーが 22 や 3389 などのリスクポートを公開していないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-Listener keine Hochrisiko-Ports wie 22 oder 3389 freigeben.\",\n\t\t\"es\": \"Garantiza que los listeners SLB no expongan puertos de alto riesgo como 22 o 3389.\",\n\t\t\"fr\": \"Garantit que les listeners SLB n'exposent pas de ports à haut risque comme 22 ou 3389.\",\n\t\t\"pt\": \"Garante que os listeners SLB não exponham portas de alto risco como 22 ou 3389.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Exposing management ports to the internet via SLB increases the risk of unauthorized access.\",\n\t\t\"zh\": \"通过 SLB 向互联网暴露管理端口会增加未经授权访问的风险。\",\n\t\t\"ja\": \"SLB を介して管理ポートをインターネットに公開すると、不正アクセスのリスクが増加します。\",\n\t\t\"de\": \"Das Freigeben von Verwaltungsports über SLB an das Internet erhöht das Risiko unbefugten Zugriffs.\",\n\t\t\"es\": \"Exponer puertos de administración a internet a través de SLB aumenta el riesgo de acceso no autorizado.\",\n\t\t\"fr\": \"Exposer les ports de gestion à Internet via SLB augmente le risque d'accès non autorisé.\",\n\t\t\"pt\": \"Expor portas de gerenciamento à internet via SLB aumenta o risco de acesso não autorizado.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use different ports for public services or use a VPN/Bastion Host for management.\",\n\t\t\"zh\": \"为公共服务使用其他端口，或使用 VPN/堡垒机进行管理。\",\n\t\t\"ja\": \"パブリックサービスには異なるポートを使用するか、管理には VPN/バスティオンホストを使用します。\",\n\t\t\"de\": \"Verwenden Sie verschiedene Ports für öffentliche Dienste oder verwenden Sie ein VPN/Bastion Host für die Verwaltung.\",\n\t\t\"es\": \"Use puertos diferentes para servicios públicos o use un VPN/Host Bastión para administración.\",\n\t\t\"fr\": \"Utilisez des ports différents pour les services publics ou utilisez un VPN/Hôte Bastion pour la gestion.\",\n\t\t\"pt\": \"Use portas diferentes para serviços públicos ou use VPN/Host Bastião para gerenciamento.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::Listener\"]\n}\n\nrisky_ports := [22, 3389, 3306, 6379]\n\nis_compliant(resource) if {\n\tport := helpers.get_property(resource, \"ListenerPort\", -1)\n\tnot helpers.includes(risky_ports, port)\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::Listener\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ListenerPort\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-loadbalancer-bandwidth-limit", Name: models.I18nString{"de": "SLB-Bandbreitenlimit", "en": "SLB Bandwidth Limit", "es": "Límite de Ancho de Banda SLB", "fr": "Limite de Bande Passante SLB", "ja": "SLB 帯域幅制限", "pt": "Limite de Largura de Banda SLB", "zh": "SLB 带宽上限核查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass die Bandbreite der SLB-Instanz einen angegebenen Maximalwert nicht überschreitet.", "en": "Ensures SLB instance bandwidth does not exceed a specified maximum value.", "es": "Garantiza que el ancho de banda de la instancia SLB no exceda un valor máximo especificado.", "fr": "Garantit que la bande passante de l'instance SLB ne dépasse pas une valeur maximale spécifiée.", "ja": "SLB インスタンスの帯域幅が指定された最大値を超えないことを確認します。", "pt": "Garante que a largura de banda da instância SLB não exceda um valor máximo especificado.", "zh": "确保 SLB 实例带宽不超过指定的最高值。"}, Reason: models.I18nString{"de": "Die Kontrolle der SLB-Bandbreite hilft bei der Verwaltung der Netzwerkkosten.", "en": "Controlling SLB bandwidth helps manage network costs.", "es": "Controlar el ancho de banda SLB ayuda a gestionar los costos de red.", "fr": "Le contrôle de la bande passante SLB aide à gérer les coûts réseau.", "ja": "SLB 帯域幅を制御することで、ネットワークコストの管理に役立ちます。", "pt": "Controlar a largura de banda do SLB ajuda a gerenciar os custos de rede.", "zh": "控制 SLB 带宽有助于管理网络成本。"}, Recommendation: models.I18nString{"de": "Setzen Sie die SLB-Bandbreite auf einen angemessenen Wert (z. B. bis zu 500 Mbps).", "en": "Set SLB bandwidth to a reasonable value (e.g., up to 500Mbps).", "es": "Establezca el ancho de banda SLB en un valor razonable (por ejemplo, hasta 500 Mbps).", "fr": "Définissez la bande passante SLB à une valeur raisonnable (par exemple, jusqu'à 500 Mbps).", "ja": "SLB 帯域幅を合理的な値（例：500Mbps まで）に設定します。", "pt": "Defina a largura de banda do SLB para um valor razoável (por exemplo, até 500 Mbps).", "zh": "将 SLB 带宽设置为合理的值（如不超过 500Mbps）。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-loadbalancer-bandwidth-limit.rego", PackageName: "infraguard.rules.aliyun.slb_loadbalancer_bandwidth_limit", Content: "package infraguard.rules.aliyun.slb_loadbalancer_bandwidth_limit\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-loadbalancer-bandwidth-limit\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"SLB Bandwidth Limit\",\n\t\t\"zh\": \"SLB 带宽上限核查\",\n\t\t\"ja\": \"SLB 帯域幅制限\",\n\t\t\"de\": \"SLB-Bandbreitenlimit\",\n\t\t\"es\": \"Límite de Ancho de Banda SLB\",\n\t\t\"fr\": \"Limite de Bande Passante SLB\",\n\t\t\"pt\": \"Limite de Largura de Banda SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLB instance bandwidth does not exceed a specified maximum value.\",\n\t\t\"zh\": \"确保 SLB 实例带宽不超过指定的最高值。\",\n\t\t\"ja\": \"SLB インスタンスの帯域幅が指定された最大値を超えないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Bandbreite der SLB-Instanz einen angegebenen Maximalwert nicht überschreitet.\",\n\t\t\"es\": \"Garantiza que el ancho de banda de la instancia SLB no exceda un valor máximo especificado.\",\n\t\t\"fr\": \"Garantit que la bande passante de l'instance SLB ne dépasse pas une valeur maximale spécifiée.\",\n\t\t\"pt\": \"Garante que a largura de banda da instância SLB não exceda um valor máximo especificado.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Controlling SLB bandwidth helps manage network costs.\",\n\t\t\"zh\": \"控制 SLB 带宽有助于管理网络成本。\",\n\t\t\"ja\": \"SLB 帯域幅を制御することで、ネットワークコストの管理に役立ちます。\",\n\t\t\"de\": \"Die Kontrolle der SLB-Bandbreite hilft bei der Verwaltung der Netzwerkkosten.\",\n\t\t\"es\": \"Controlar el ancho de banda SLB ayuda a gestionar los costos de red.\",\n\t\t\"fr\": \"Le contrôle de la bande passante SLB aide à gérer les coûts réseau.\",\n\t\t\"pt\": \"Controlar a largura de banda do SLB ajuda a gerenciar os custos de rede.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set SLB bandwidth to a reasonable value (e.g., up to 500Mbps).\",\n\t\t\"zh\": \"将 SLB 带宽设置为合理的值（如不超过 500Mbps）。\",\n\t\t\"ja\": \"SLB 帯域幅を合理的な値（例：500Mbps まで）に設定します。\",\n\t\t\"de\": \"Setzen Sie die SLB-Bandbreite auf einen angemessenen Wert (z. B. bis zu 500 Mbps).\",\n\t\t\"es\": \"Establezca el ancho de banda SLB en un valor razonable (por ejemplo, hasta 500 Mbps).\",\n\t\t\"fr\": \"Définissez la bande passante SLB à une valeur raisonnable (par exemple, jusqu'à 500 Mbps).\",\n\t\t\"pt\": \"Defina a largura de banda do SLB para um valor razoável (por exemplo, até 500 Mbps).\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nis_compliant(resource) if {\n\tbandwidth := helpers.get_property(resource, \"Bandwidth\", 1)\n\tbandwidth <= 500\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"Bandwidth\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-loadbalancer-in-vpc", Name: models.I18nString{"de": "SLB im VPC Prüfung", "en": "SLB in VPC Check", "es": "Verificación SLB en VPC", "fr": "Vérification SLB dans VPC", "ja": "VPC チェック内の SLB", "pt": "Verificação SLB em VPC", "zh": "强制 SLB 部署在 VPC 环境中"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass SLB-Instanzen innerhalb eines Virtual Private Cloud (VPC) bereitgestellt werden.", "en": "Ensures SLB instances are deployed within a Virtual Private Cloud (VPC).", "es": "Garantiza que las instancias SLB estén desplegadas dentro de una Virtual Private Cloud (VPC).", "fr": "Garantit que les instances SLB sont déployées dans un Virtual Private Cloud (VPC).", "ja": "SLB インスタンスが Virtual Private Cloud（VPC）内に展開されていることを確認します。", "pt": "Garante que as instâncias SLB estejam implantadas dentro de uma Virtual Private Cloud (VPC).", "zh": "确保 SLB 实例部署在专有网络（VPC）中。"}, Reason: models.I18nString{"de": "Das klassische Netzwerk ist veraltet und bietet weniger Sicherheit und Isolation als VPC.", "en": "Classic network is deprecated and offers less security and isolation than VPC.", "es": "La red clásica está deprecada y ofrece menos seguridad y aislamiento que VPC.", "fr": "Le réseau classique est déprécié et offre moins de sécurité et d'isolation que VPC.", "ja": "クラシックネットワークは非推奨であり、VPC よりもセキュリティと分離が少なくなります。", "pt": "A rede clássica está depreciada e oferece menos segurança e isolamento do que VPC.", "zh": "经典网络已弃用，其安全性和隔离性均不如 VPC。"}, Recommendation: models.I18nString{"de": "Erstellen Sie SLB-Instanzen innerhalb eines VPC.", "en": "Create SLB instances within a VPC.", "es": "Cree instancias SLB dentro de un VPC.", "fr": "Créez des instances SLB dans un VPC.", "ja": "VPC 内に SLB インスタンスを作成します。", "pt": "Crie instâncias SLB dentro de um VPC.", "zh": "在 VPC 内创建 SLB 实例。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-loadbalancer-in-vpc.rego", PackageName: "infraguard.rules.aliyun.slb_loadbalancer_in_vpc", Content: "package infraguard.rules.aliyun.slb_loadbalancer_in_vpc\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-loadbalancer-in-vpc\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB in VPC Check\",\n\t\t\"zh\": \"强制 SLB 部署在 VPC 环境中\",\n\t\t\"ja\": \"VPC チェック内の SLB\",\n\t\t\"de\": \"SLB im VPC Prüfung\",\n\t\t\"es\": \"Verificación SLB en VPC\",\n\t\t\"fr\": \"Vérification SLB dans VPC\",\n\t\t\"pt\": \"Verificação SLB em VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLB instances are deployed within a Virtual Private Cloud (VPC).\",\n\t\t\"zh\": \"确保 SLB 实例部署在专有网络（VPC）中。\",\n\t\t\"ja\": \"SLB インスタンスが Virtual Private Cloud（VPC）内に展開されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-Instanzen innerhalb eines Virtual Private Cloud (VPC) bereitgestellt werden.\",\n\t\t\"es\": \"Garantiza que las instancias SLB estén desplegadas dentro de una Virtual Private Cloud (VPC).\",\n\t\t\"fr\": \"Garantit que les instances SLB sont déployées dans un Virtual Private Cloud (VPC).\",\n\t\t\"pt\": \"Garante que as instâncias SLB estejam implantadas dentro de uma Virtual Private Cloud (VPC).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Classic network is deprecated and offers less security and isolation than VPC.\",\n\t\t\"zh\": \"经典网络已弃用，其安全性和隔离性均不如 VPC。\",\n\t\t\"ja\": \"クラシックネットワークは非推奨であり、VPC よりもセキュリティと分離が少なくなります。\",\n\t\t\"de\": \"Das klassische Netzwerk ist veraltet und bietet weniger Sicherheit und Isolation als VPC.\",\n\t\t\"es\": \"La red clásica está deprecada y ofrece menos seguridad y aislamiento que VPC.\",\n\t\t\"fr\": \"Le réseau classique est déprécié et offre moins de sécurité et d'isolation que VPC.\",\n\t\t\"pt\": \"A rede clássica está depreciada e oferece menos segurança e isolamento do que VPC.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Create SLB instances within a VPC.\",\n\t\t\"zh\": \"在 VPC 内创建 SLB 实例。\",\n\t\t\"ja\": \"VPC 内に SLB インスタンスを作成します。\",\n\t\t\"de\": \"Erstellen Sie SLB-Instanzen innerhalb eines VPC.\",\n\t\t\"es\": \"Cree instancias SLB dentro de un VPC.\",\n\t\t\"fr\": \"Créez des instances SLB dans un VPC.\",\n\t\t\"pt\": \"Crie instâncias SLB dentro de um VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nis_compliant(resource) if {\n\thelpers.has_property(resource, \"VpcId\")\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"VpcId\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-master-slave-server-group-multi-zone", Name: models.I18nString{"de": "SLB Master-Slave-Server-Gruppe Multi-Zone", "en": "SLB Master-Slave Server Group Multi-Zone", "es": "Grupo de Servidores Maestro-Esclavo SLB Multi-Zona", "fr": "Groupe de Serveurs Maître-Esclave SLB Multi-Zone", "ja": "SLB マスタースレーブサーバーグループのマルチゾーン", "pt": "Grupo de Servidores Mestre-Escravo SLB Multi-Zona", "zh": "SLB 负载均衡主备服务器组添加多个可用区资源"}, Severity: "medium", Description: models.I18nString{"de": "Die Master-Slave-Server-Gruppe von SLB-Instanzen sollte Ressourcen über mehrere Verfügbarkeitszonen verteilt haben.", "en": "The master-slave server group of SLB instances should have resources distributed across multiple availability zones.", "es": "El grupo de servidores maestro-esclavo de las instancias SLB debe tener recursos distribuidos en múltiples zonas de disponibilidad.", "fr": "Le groupe de serveurs maître-esclave des instances SLB doit avoir des ressources distribuées sur plusieurs zones de disponibilité.", "ja": "SLB インスタンスのマスタースレーブサーバーグループは、リソースを複数の可用性ゾーンに分散させる必要があります。", "pt": "O grupo de servidores mestre-escravo das instâncias SLB deve ter recursos distribuídos em múltiplas zonas de disponibilidade.", "zh": "SLB 负载均衡的主备服务器组挂载资源分布在多个可用区，视为合规。主备服务器组无挂载任何资源时不适用本规则，视为不适用。"}, Reason: models.I18nString{"de": "Einzelzonen-Master-Slave-Server erstellen einen Single Point of Failure und reduzieren die Verfügbarkeit.", "en": "Single-zone master-slave servers create a single point of failure and reduce availability.", "es": "Los servidores maestro-esclavo de zona única crean un punto único de falla y reducen la disponibilidad.", "fr": "Les serveurs maître-esclave à zone unique créent un point de défaillance unique et réduisent la disponibilité.", "ja": "単一ゾーンのマスタースレーブサーバーは単一障害点を作成し、可用性を低下させます。", "pt": "Servidores mestre-escravo de zona única criam um ponto único de falha e reduzem a disponibilidade.", "zh": "单可用区主备服务器创建单点故障并降低可用性。"}, Recommendation: models.I18nString{"de": "Verteilen Sie Master- und Slave-Server über verschiedene Verfügbarkeitszonen.", "en": "Distribute master and slave servers across different availability zones.", "es": "Distribuya los servidores maestro y esclavo en diferentes zonas de disponibilidad.", "fr": "Répartissez les serveurs maître et esclave sur différentes zones de disponibilité.", "ja": "マスターサーバーとスレーブサーバーを異なる可用性ゾーンに分散します。", "pt": "Distribua servidores mestre e escravo em diferentes zonas de disponibilidade.", "zh": "将主服务器和从服务器分布在不同的可用区。"}, ResourceTypes: []string{"ALIYUN::SLB::MasterSlaveServerGroup"}, FilePath: "aliyun/rules/slb-master-slave-server-group-multi-zone.rego", PackageName: "infraguard.rules.aliyun.slb_master_slave_server_group_multi_zone", Content: "package infraguard.rules.aliyun.slb_master_slave_server_group_multi_zone\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-master-slave-server-group-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Master-Slave Server Group Multi-Zone\",\n\t\t\"zh\": \"SLB 负载均衡主备服务器组添加多个可用区资源\",\n\t\t\"ja\": \"SLB マスタースレーブサーバーグループのマルチゾーン\",\n\t\t\"de\": \"SLB Master-Slave-Server-Gruppe Multi-Zone\",\n\t\t\"es\": \"Grupo de Servidores Maestro-Esclavo SLB Multi-Zona\",\n\t\t\"fr\": \"Groupe de Serveurs Maître-Esclave SLB Multi-Zone\",\n\t\t\"pt\": \"Grupo de Servidores Mestre-Escravo SLB Multi-Zona\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"The master-slave server group of SLB instances should have resources distributed across multiple availability zones.\",\n\t\t\"zh\": \"SLB 负载均衡的主备服务器组挂载资源分布在多个可用区，视为合规。主备服务器组无挂载任何资源时不适用本规则，视为不适用。\",\n\t\t\"ja\": \"SLB インスタンスのマスタースレーブサーバーグループは、リソースを複数の可用性ゾーンに分散させる必要があります。\",\n\t\t\"de\": \"Die Master-Slave-Server-Gruppe von SLB-Instanzen sollte Ressourcen über mehrere Verfügbarkeitszonen verteilt haben.\",\n\t\t\"es\": \"El grupo de servidores maestro-esclavo de las instancias SLB debe tener recursos distribuidos en múltiples zonas de disponibilidad.\",\n\t\t\"fr\": \"Le groupe de serveurs maître-esclave des instances SLB doit avoir des ressources distribuées sur plusieurs zones de disponibilité.\",\n\t\t\"pt\": \"O grupo de servidores mestre-escravo das instâncias SLB deve ter recursos distribuídos em múltiplas zonas de disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Single-zone master-slave servers create a single point of failure and reduce availability.\",\n\t\t\"zh\": \"单可用区主备服务器创建单点故障并降低可用性。\",\n\t\t\"ja\": \"単一ゾーンのマスタースレーブサーバーは単一障害点を作成し、可用性を低下させます。\",\n\t\t\"de\": \"Einzelzonen-Master-Slave-Server erstellen einen Single Point of Failure und reduzieren die Verfügbarkeit.\",\n\t\t\"es\": \"Los servidores maestro-esclavo de zona única crean un punto único de falla y reducen la disponibilidad.\",\n\t\t\"fr\": \"Les serveurs maître-esclave à zone unique créent un point de défaillance unique et réduisent la disponibilité.\",\n\t\t\"pt\": \"Servidores mestre-escravo de zona única criam um ponto único de falha e reduzem a disponibilidade.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Distribute master and slave servers across different availability zones.\",\n\t\t\"zh\": \"将主服务器和从服务器分布在不同的可用区。\",\n\t\t\"ja\": \"マスターサーバーとスレーブサーバーを異なる可用性ゾーンに分散します。\",\n\t\t\"de\": \"Verteilen Sie Master- und Slave-Server über verschiedene Verfügbarkeitszonen.\",\n\t\t\"es\": \"Distribuya los servidores maestro y esclavo en diferentes zonas de disponibilidad.\",\n\t\t\"fr\": \"Répartissez les serveurs maître et esclave sur différentes zones de disponibilité.\",\n\t\t\"pt\": \"Distribua servidores mestre e escravo em diferentes zonas de disponibilidade.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::MasterSlaveServerGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::MasterSlaveServerGroup\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-modify-protection-check", Name: models.I18nString{"de": "SLB Änderungsschutz aktiviert", "en": "SLB Modification Protection Enabled", "es": "Protección contra Modificación de SLB Habilitada", "fr": "Protection contre la Modification SLB Activée", "ja": "SLB 変更保護が有効", "pt": "Proteção contra Modificação de SLB Habilitada", "zh": "SLB 实例开启配置修改保护"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass SLB-Instanzen Änderungsschutz aktiviert haben.", "en": "Ensures that SLB instances have modification protection enabled.", "es": "Garantiza que las instancias SLB tengan protección contra modificación habilitada.", "fr": "Garantit que les instances SLB ont la protection contre la modification activée.", "ja": "SLB インスタンスで変更保護が有効になっていることを確認します。", "pt": "Garante que as instâncias SLB tenham proteção contra modificação habilitada.", "zh": "确保 SLB 实例开启了配置修改保护。"}, Reason: models.I18nString{"de": "Wenn der Änderungsschutz nicht aktiviert ist, kann die SLB-Konfiguration versehentlich geändert werden, was zu Dienstproblemen führt.", "en": "If modification protection is not enabled, the SLB configuration may be modified accidentally, causing service issues.", "es": "Si la protección contra modificación no está habilitada, la configuración SLB puede modificarse accidentalmente, causando problemas en el servicio.", "fr": "Si la protection contre la modification n'est pas activée, la configuration SLB peut être modifiée accidentellement, causant des problèmes de service.", "ja": "変更保護が有効になっていない場合、SLB 設定が誤って変更され、サービスに問題が発生する可能性があります。", "pt": "Se a proteção contra modificação não estiver habilitada, a configuração SLB pode ser modificada acidentalmente, causando problemas no serviço.", "zh": "如果未开启配置修改保护，SLB 配置可能会被意外修改，导致服务异常。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Änderungsschutz für die SLB-Instanz.", "en": "Enable modification protection for the SLB instance.", "es": "Habilite protección contra modificación para la instancia SLB.", "fr": "Activez la protection contre la modification pour l'instance SLB.", "ja": "SLB インスタンスで変更保護を有効にします。", "pt": "Habilite proteção contra modificação para a instância SLB.", "zh": "为 SLB 实例开启配置修改保护功能。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-modify-protection-check.rego", PackageName: "infraguard.rules.aliyun.slb_modify_protection_check", Content: "package infraguard.rules.aliyun.slb_modify_protection_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"slb-modify-protection-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"SLB Modification Protection Enabled\",\n\t\t\"zh\": \"SLB 实例开启配置修改保护\",\n\t\t\"ja\": \"SLB 変更保護が有効\",\n\t\t\"de\": \"SLB Änderungsschutz aktiviert\",\n\t\t\"es\": \"Protección contra Modificación de SLB Habilitada\",\n\t\t\"fr\": \"Protection contre la Modification SLB Activée\",\n\t\t\"pt\": \"Proteção contra Modificação de SLB Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that SLB instances have modification protection enabled.\",\n\t\t\"zh\": \"确保 SLB 实例开启了配置修改保护。\",\n\t\t\"ja\": \"SLB インスタンスで変更保護が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-Instanzen Änderungsschutz aktiviert haben.\",\n\t\t\"es\": \"Garantiza que las instancias SLB tengan protección contra modificación habilitada.\",\n\t\t\"fr\": \"Garantit que les instances SLB ont la protection contre la modification activée.\",\n\t\t\"pt\": \"Garante que as instâncias SLB tenham proteção contra modificação habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"If modification protection is not enabled, the SLB configuration may be modified accidentally, causing service issues.\",\n\t\t\"zh\": \"如果未开启配置修改保护，SLB 配置可能会被意外修改，导致服务异常。\",\n\t\t\"ja\": \"変更保護が有効になっていない場合、SLB 設定が誤って変更され、サービスに問題が発生する可能性があります。\",\n\t\t\"de\": \"Wenn der Änderungsschutz nicht aktiviert ist, kann die SLB-Konfiguration versehentlich geändert werden, was zu Dienstproblemen führt.\",\n\t\t\"es\": \"Si la protección contra modificación no está habilitada, la configuración SLB puede modificarse accidentalmente, causando problemas en el servicio.\",\n\t\t\"fr\": \"Si la protection contre la modification n'est pas activée, la configuration SLB peut être modifiée accidentellement, causant des problèmes de service.\",\n\t\t\"pt\": \"Se a proteção contra modificação não estiver habilitada, a configuração SLB pode ser modificada acidentalmente, causando problemas no serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable modification protection for the SLB instance.\",\n\t\t\"zh\": \"为 SLB 实例开启配置修改保护功能。\",\n\t\t\"ja\": \"SLB インスタンスで変更保護を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Änderungsschutz für die SLB-Instanz.\",\n\t\t\"es\": \"Habilite protección contra modificación para la instancia SLB.\",\n\t\t\"fr\": \"Activez la protection contre la modification pour l'instance SLB.\",\n\t\t\"pt\": \"Habilite proteção contra modificação para a instância SLB.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nis_compliant(resource) if {\n\thelpers.get_property(resource, \"ModificationProtectionStatus\", \"\") == \"ConsoleProtection\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ModificationProtectionStatus\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-no-public-ip", Name: models.I18nString{"de": "SLB-Instanz Keine öffentliche IP", "en": "SLB Instance No Public IP", "es": "Instancia SLB Sin IP Pública", "fr": "Instance SLB Sans IP Publique", "ja": "SLB インスタンスにパブリック IP がない", "pt": "Instância SLB Sem IP Público", "zh": "SLB 实例未开启公网访问"}, Severity: "medium", Description: models.I18nString{"de": "SLB-Instanzen sollten keine öffentlichen IP-Adressen haben, um die Angriffsfläche zu reduzieren.", "en": "SLB instances should not have public IP addresses to reduce attack surface.", "es": "Las instancias SLB no deben tener direcciones IP públicas para reducir la superficie de ataque.", "fr": "Les instances SLB ne doivent pas avoir d'adresses IP publiques pour réduire la surface d'attaque.", "ja": "SLB インスタンスは攻撃面を減らすためにパブリック IP アドレスを持つべきではありません。", "pt": "As instâncias SLB não devem ter endereços IP públicos para reduzir a superfície de ataque.", "zh": "SLB 实例网络类型为内网，视为合规。"}, Reason: models.I18nString{"de": "Öffentlich zugängliche SLB-Instanzen erhöhen die Angriffsfläche und können Dienste unerwünschtem Internetverkehr aussetzen.", "en": "Publicly accessible SLB instances increase the attack surface and may expose services to unwanted internet traffic.", "es": "Las instancias SLB accesibles públicamente aumentan la superficie de ataque y pueden exponer servicios a tráfico de Internet no deseado.", "fr": "Les instances SLB accessibles publiquement augmentent la surface d'attaque et peuvent exposer les services à un trafic Internet indésirable.", "ja": "パブリックアクセス可能な SLB インスタンスは攻撃面を増加させ、サービスを不要なインターネットトラフィックにさらす可能性があります。", "pt": "Instâncias SLB acessíveis publicamente aumentam a superfície de ataque e podem expor serviços a tráfego indesejado da Internet.", "zh": "可公开访问的 SLB 实例增加了攻击面，可能将服务暴露给非预期的互联网流量。"}, Recommendation: models.I18nString{"de": "Verwenden Sie intranetorientierte SLB-Instanzen für interne Dienste.", "en": "Use intranet-facing SLB instances for internal services.", "es": "Use instancias SLB orientadas a intranet para servicios internos.", "fr": "Utilisez des instances SLB orientées intranet pour les services internes.", "ja": "内部サービスにはイントラネット向け SLB インスタンスを使用します。", "pt": "Use instâncias SLB voltadas para intranet para serviços internos.", "zh": "对内部服务使用内网类型的 SLB 实例。"}, ResourceTypes: []string{"ALIYUN::SLB::LoadBalancer"}, FilePath: "aliyun/rules/slb-no-public-ip.rego", PackageName: "infraguard.rules.aliyun.slb_no_public_ip", Content: "package infraguard.rules.aliyun.slb_no_public_ip\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"slb-no-public-ip\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB Instance No Public IP\",\n\t\t\"zh\": \"SLB 实例未开启公网访问\",\n\t\t\"ja\": \"SLB インスタンスにパブリック IP がない\",\n\t\t\"de\": \"SLB-Instanz Keine öffentliche IP\",\n\t\t\"es\": \"Instancia SLB Sin IP Pública\",\n\t\t\"fr\": \"Instance SLB Sans IP Publique\",\n\t\t\"pt\": \"Instância SLB Sem IP Público\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"SLB instances should not have public IP addresses to reduce attack surface.\",\n\t\t\"zh\": \"SLB 实例网络类型为内网，视为合规。\",\n\t\t\"ja\": \"SLB インスタンスは攻撃面を減らすためにパブリック IP アドレスを持つべきではありません。\",\n\t\t\"de\": \"SLB-Instanzen sollten keine öffentlichen IP-Adressen haben, um die Angriffsfläche zu reduzieren.\",\n\t\t\"es\": \"Las instancias SLB no deben tener direcciones IP públicas para reducir la superficie de ataque.\",\n\t\t\"fr\": \"Les instances SLB ne doivent pas avoir d'adresses IP publiques pour réduire la surface d'attaque.\",\n\t\t\"pt\": \"As instâncias SLB não devem ter endereços IP públicos para reduzir a superfície de ataque.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Publicly accessible SLB instances increase the attack surface and may expose services to unwanted internet traffic.\",\n\t\t\"zh\": \"可公开访问的 SLB 实例增加了攻击面，可能将服务暴露给非预期的互联网流量。\",\n\t\t\"ja\": \"パブリックアクセス可能な SLB インスタンスは攻撃面を増加させ、サービスを不要なインターネットトラフィックにさらす可能性があります。\",\n\t\t\"de\": \"Öffentlich zugängliche SLB-Instanzen erhöhen die Angriffsfläche und können Dienste unerwünschtem Internetverkehr aussetzen.\",\n\t\t\"es\": \"Las instancias SLB accesibles públicamente aumentan la superficie de ataque y pueden exponer servicios a tráfico de Internet no deseado.\",\n\t\t\"fr\": \"Les instances SLB accessibles publiquement augmentent la surface d'attaque et peuvent exposer les services à un trafic Internet indésirable.\",\n\t\t\"pt\": \"Instâncias SLB acessíveis publicamente aumentam a superfície de ataque e podem expor serviços a tráfego indesejado da Internet.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Use intranet-facing SLB instances for internal services.\",\n\t\t\"zh\": \"对内部服务使用内网类型的 SLB 实例。\",\n\t\t\"ja\": \"内部サービスにはイントラネット向け SLB インスタンスを使用します。\",\n\t\t\"de\": \"Verwenden Sie intranetorientierte SLB-Instanzen für interne Dienste.\",\n\t\t\"es\": \"Use instancias SLB orientadas a intranet para servicios internos.\",\n\t\t\"fr\": \"Utilisez des instances SLB orientées intranet pour les services internes.\",\n\t\t\"pt\": \"Use instâncias SLB voltadas para intranet para serviços internos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::LoadBalancer\"]\n}\n\nis_internal(resource) if {\n\taddress_type := helpers.get_property(resource, \"AddressType\", \"\")\n\taddress_type == \"intranet\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::LoadBalancer\")\n\tnot is_internal(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"AddressType\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:slb-vserver-group-multi-zone", Name: models.I18nString{"de": "SLB VServer-Gruppe Multi-Zonen-Bereitstellung", "en": "SLB VServer Group Multi-Zone Deployment", "es": "Implementación Multi-Zona de Grupo de Servidor Virtual SLB", "fr": "Déploiement Multi-Zone du Groupe de Serveurs Virtuels SLB", "ja": "SLB 仮想サーバーグループマルチゾーン展開", "pt": "Implantação Multi-Zona do Grupo de Servidor Virtual SLB", "zh": "SLB 虚拟服务器组多可用区部署"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass SLB-VServer-Gruppen Instanzen aus mehreren Verfügbarkeitszonen enthalten.", "en": "Ensures that SLB virtual server groups contain instances from multiple availability zones.", "es": "Garantiza que los grupos de servidor virtual SLB contengan instancias de múltiples zonas de disponibilidad.", "fr": "Garantit que les groupes de serveurs virtuels SLB contiennent des instances de plusieurs zones de disponibilité.", "ja": "SLB 仮想サーバーグループに複数の可用性ゾーンからのインスタンスが含まれていることを確認します。", "pt": "Garante que os grupos de servidor virtual SLB contenham instâncias de múltiplas zonas de disponibilidade.", "zh": "确保 SLB 虚拟服务器组包含来自多个可用区的实例。"}, Reason: models.I18nString{"de": "Die Bereitstellung von Backend-Instanzen in mehreren Zonen gewährleistet hohe Verfügbarkeit für den Dienst.", "en": "Deploying backend instances in multiple zones ensures high availability for the service.", "es": "Implementar instancias backend en múltiples zonas garantiza alta disponibilidad para el servicio.", "fr": "Le déploiement d'instances backend dans plusieurs zones garantit une haute disponibilité pour le service.", "ja": "複数のゾーンにバックエンドインスタンスを展開することで、サービスの高可用性が確保されます。", "pt": "Implantar instâncias backend em múltiplas zonas garante alta disponibilidade para o serviço.", "zh": "在多个可用区部署后端实例可确保服务的高可用性。"}, Recommendation: models.I18nString{"de": "Fügen Sie Instanzen aus mindestens zwei verschiedenen Verfügbarkeitszonen zur VServer-Gruppe hinzu.", "en": "Add instances from at least two different availability zones to the virtual server group.", "es": "Agregue instancias de al menos dos zonas de disponibilidad diferentes al grupo de servidor virtual.", "fr": "Ajoutez des instances d'au moins deux zones de disponibilité différentes au groupe de serveurs virtuels.", "ja": "仮想サーバーグループに、少なくとも2つの異なる可用性ゾーンからのインスタンスを追加します。", "pt": "Adicione instâncias de pelo menos duas zonas de disponibilidade diferentes ao grupo de servidor virtual.", "zh": "向虚拟服务器组中添加来自至少两个不同可用区的实例。"}, ResourceTypes: []string{"ALIYUN::SLB::VServerGroup"}, FilePath: "aliyun/rules/slb-vserver-group-multi-zone.rego", PackageName: "infraguard.rules.aliyun.slb_vserver_group_multi_zone", Content: "package infraguard.rules.aliyun.slb_vserver_group_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"slb-vserver-group-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLB VServer Group Multi-Zone Deployment\",\n\t\t\"zh\": \"SLB 虚拟服务器组多可用区部署\",\n\t\t\"ja\": \"SLB 仮想サーバーグループマルチゾーン展開\",\n\t\t\"de\": \"SLB VServer-Gruppe Multi-Zonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona de Grupo de Servidor Virtual SLB\",\n\t\t\"fr\": \"Déploiement Multi-Zone du Groupe de Serveurs Virtuels SLB\",\n\t\t\"pt\": \"Implantação Multi-Zona do Grupo de Servidor Virtual SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that SLB virtual server groups contain instances from multiple availability zones.\",\n\t\t\"zh\": \"确保 SLB 虚拟服务器组包含来自多个可用区的实例。\",\n\t\t\"ja\": \"SLB 仮想サーバーグループに複数の可用性ゾーンからのインスタンスが含まれていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLB-VServer-Gruppen Instanzen aus mehreren Verfügbarkeitszonen enthalten.\",\n\t\t\"es\": \"Garantiza que los grupos de servidor virtual SLB contengan instancias de múltiples zonas de disponibilidad.\",\n\t\t\"fr\": \"Garantit que les groupes de serveurs virtuels SLB contiennent des instances de plusieurs zones de disponibilité.\",\n\t\t\"pt\": \"Garante que os grupos de servidor virtual SLB contenham instâncias de múltiplas zonas de disponibilidade.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Deploying backend instances in multiple zones ensures high availability for the service.\",\n\t\t\"zh\": \"在多个可用区部署后端实例可确保服务的高可用性。\",\n\t\t\"ja\": \"複数のゾーンにバックエンドインスタンスを展開することで、サービスの高可用性が確保されます。\",\n\t\t\"de\": \"Die Bereitstellung von Backend-Instanzen in mehreren Zonen gewährleistet hohe Verfügbarkeit für den Dienst.\",\n\t\t\"es\": \"Implementar instancias backend en múltiples zonas garantiza alta disponibilidad para el servicio.\",\n\t\t\"fr\": \"Le déploiement d'instances backend dans plusieurs zones garantit une haute disponibilité pour le service.\",\n\t\t\"pt\": \"Implantar instâncias backend em múltiplas zonas garante alta disponibilidade para o serviço.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add instances from at least two different availability zones to the virtual server group.\",\n\t\t\"zh\": \"向虚拟服务器组中添加来自至少两个不同可用区的实例。\",\n\t\t\"ja\": \"仮想サーバーグループに、少なくとも2つの異なる可用性ゾーンからのインスタンスを追加します。\",\n\t\t\"de\": \"Fügen Sie Instanzen aus mindestens zwei verschiedenen Verfügbarkeitszonen zur VServer-Gruppe hinzu.\",\n\t\t\"es\": \"Agregue instancias de al menos dos zonas de disponibilidad diferentes al grupo de servidor virtual.\",\n\t\t\"fr\": \"Ajoutez des instances d'au moins deux zones de disponibilité différentes au groupe de serveurs virtuels.\",\n\t\t\"pt\": \"Adicione instâncias de pelo menos duas zonas de disponibilidade diferentes ao grupo de servidor virtual.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLB::VServerGroup\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLB::VServerGroup\")\n\n\t# Conceptual check for multi-zone\n\tnot helpers.has_property(resource, \"BackendServers\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:sls-logstore-enabled-encrypt", Name: models.I18nString{"de": "SLS-Logstore Verschlüsselung aktiviert", "en": "SLS Logstore Encryption Enabled", "es": "Cifrado de Logstore SLS Habilitado", "fr": "Chiffrement du Logstore SLS Activé", "ja": "SLS ログストア暗号化が有効", "pt": "Criptografia do Logstore SLS Habilitada", "zh": "SLS 日志库开启数据加密"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass SLS-Logstores serverseitige Verschlüsselung aktiviert haben.", "en": "Ensures SLS Logstores have server-side encryption enabled.", "es": "Garantiza que los Logstores SLS tengan cifrado del lado del servidor habilitado.", "fr": "Garantit que les Logstores SLS ont le chiffrement côté serveur activé.", "ja": "SLS ログストアでサーバー側暗号化が有効になっていることを確認します。", "pt": "Garante que os Logstores SLS tenham criptografia do lado do servidor habilitada.", "zh": "确保 SLS 日志库开启了服务端加密。"}, Reason: models.I18nString{"de": "Verschlüsselung schützt ruhende sensible Protokolldaten.", "en": "Encryption protects sensitive log data at rest.", "es": "El cifrado protege los datos de registro sensibles en reposo.", "fr": "Le chiffrement protège les données de journal sensibles au repos.", "ja": "暗号化により、保存されている機密ログデータを保護します。", "pt": "A criptografia protege dados de log sensíveis em repouso.", "zh": "加密可以保护静态的敏感日志数据。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Verschlüsselung für den SLS-Logstore mit KMS.", "en": "Enable encryption for the SLS Logstore using KMS.", "es": "Habilite el cifrado para el Logstore SLS usando KMS.", "fr": "Activez le chiffrement pour le Logstore SLS en utilisant KMS.", "ja": "KMS を使用して SLS ログストアの暗号化を有効にします。", "pt": "Habilite a criptografia para o Logstore SLS usando KMS.", "zh": "使用 KMS 为 SLS 日志库启用加密。"}, ResourceTypes: []string{"ALIYUN::SLS::Logstore"}, FilePath: "aliyun/rules/sls-logstore-enabled-encrypt.rego", PackageName: "infraguard.rules.aliyun.sls_logstore_enabled_encrypt", Content: "package infraguard.rules.aliyun.sls_logstore_enabled_encrypt\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"sls-logstore-enabled-encrypt\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLS Logstore Encryption Enabled\",\n\t\t\"zh\": \"SLS 日志库开启数据加密\",\n\t\t\"ja\": \"SLS ログストア暗号化が有効\",\n\t\t\"de\": \"SLS-Logstore Verschlüsselung aktiviert\",\n\t\t\"es\": \"Cifrado de Logstore SLS Habilitado\",\n\t\t\"fr\": \"Chiffrement du Logstore SLS Activé\",\n\t\t\"pt\": \"Criptografia do Logstore SLS Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLS Logstores have server-side encryption enabled.\",\n\t\t\"zh\": \"确保 SLS 日志库开启了服务端加密。\",\n\t\t\"ja\": \"SLS ログストアでサーバー側暗号化が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLS-Logstores serverseitige Verschlüsselung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los Logstores SLS tengan cifrado del lado del servidor habilitado.\",\n\t\t\"fr\": \"Garantit que les Logstores SLS ont le chiffrement côté serveur activé.\",\n\t\t\"pt\": \"Garante que os Logstores SLS tenham criptografia do lado do servidor habilitada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Encryption protects sensitive log data at rest.\",\n\t\t\"zh\": \"加密可以保护静态的敏感日志数据。\",\n\t\t\"ja\": \"暗号化により、保存されている機密ログデータを保護します。\",\n\t\t\"de\": \"Verschlüsselung schützt ruhende sensible Protokolldaten.\",\n\t\t\"es\": \"El cifrado protege los datos de registro sensibles en reposo.\",\n\t\t\"fr\": \"Le chiffrement protège les données de journal sensibles au repos.\",\n\t\t\"pt\": \"A criptografia protege dados de log sensíveis em repouso.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable encryption for the SLS Logstore using KMS.\",\n\t\t\"zh\": \"使用 KMS 为 SLS 日志库启用加密。\",\n\t\t\"ja\": \"KMS を使用して SLS ログストアの暗号化を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Verschlüsselung für den SLS-Logstore mit KMS.\",\n\t\t\"es\": \"Habilite el cifrado para el Logstore SLS usando KMS.\",\n\t\t\"fr\": \"Activez le chiffrement pour le Logstore SLS en utilisant KMS.\",\n\t\t\"pt\": \"Habilite a criptografia para o Logstore SLS usando KMS.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLS::Logstore\"]\n}\n\nis_compliant(resource) if {\n\t# Check EncryptConf\n\tencrypt := helpers.get_property(resource, \"EncryptConf\", {})\n\tcount(encrypt) > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLS::Logstore\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EncryptConf\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:sls-logstore-encrypt-key-origin-check", Name: models.I18nString{"de": "SLS-Logstore Verschlüsselungsschlüssel-Herkunftsprüfung", "en": "SLS Logstore Encryption Key Origin Check", "es": "Verificación de Origen de Clave de Cifrado de Logstore SLS", "fr": "Vérification de l'Origine de la Clé de Chiffrement du Logstore SLS", "ja": "SLS ログストア暗号化キーオリジンチェック", "pt": "Verificação de Origem da Chave de Criptografia do Logstore SLS", "zh": "日志服务日志库加密使用的主密钥材料来源为用户自行导入"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass SLS-Logstores extern importiertes Schlüsselmaterial (BYOK) für die Verschlüsselung verwenden, was eine bessere Kontrolle über Verschlüsselungsschlüssel bietet.", "en": "Ensures SLS Logstores use externally imported key material (BYOK) for encryption, which provides better control over encryption keys.", "es": "Garantiza que los Logstores SLS usen material de clave importado externamente (BYOK) para el cifrado, lo que proporciona un mejor control sobre las claves de cifrado.", "fr": "Garantit que les Logstores SLS utilisent du matériel de clé importé externe (BYOK) pour le chiffrement, ce qui offre un meilleur contrôle sur les clés de chiffrement.", "ja": "SLS ログストアが暗号化に外部からインポートされたキー材料（BYOK）を使用していることを確認します。これにより、暗号化キーをより適切に制御できます。", "pt": "Garante que os Logstores SLS usem material de chave importado externamente (BYOK) para criptografia, o que fornece melhor controle sobre as chaves de criptografia.", "zh": "确保 SLS 日志库使用外部导入的密钥材料（BYOK）进行加密，以更好地控制加密密钥。"}, Reason: models.I18nString{"de": "Die Verwendung extern importierten Schlüsselmaterials bietet eine bessere Kontrolle über Verschlüsselungsschlüssel und verbessert die Sicherheitslage.", "en": "Using externally imported key material provides better control over encryption keys and enhances security posture.", "es": "Usar material de clave importado externamente proporciona un mejor control sobre las claves de cifrado y mejora la postura de seguridad.", "fr": "L'utilisation de matériel de clé importé externe offre un meilleur contrôle sur les clés de chiffrement et améliore la posture de sécurité.", "ja": "外部からインポートされたキー材料を使用することで、暗号化キーをより適切に制御し、セキュリティ体制を強化できます。", "pt": "Usar material de chave importado externamente fornece melhor controle sobre as chaves de criptografia e melhora a postura de segurança.", "zh": "使用外部导入的密钥材料可以更好地控制加密密钥并增强安全性。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie den Logstore, um BYOK-Verschlüsselung mit extern importiertem Schlüsselmaterial zu verwenden.", "en": "Configure the Logstore to use BYOK encryption with externally imported key material.", "es": "Configure el Logstore para usar cifrado BYOK con material de clave importado externamente.", "fr": "Configurez le Logstore pour utiliser le chiffrement BYOK avec du matériel de clé importé externe.", "ja": "外部からインポートされたキー材料で BYOK 暗号化を使用するようにログストアを設定します。", "pt": "Configure o Logstore para usar criptografia BYOK com material de chave importado externamente.", "zh": "配置日志库使用 BYOK 加密，导入外部密钥材料。"}, ResourceTypes: []string{"ALIYUN::SLS::Logstore"}, FilePath: "aliyun/rules/sls-logstore-encrypt-key-origin-check.rego", PackageName: "infraguard.rules.aliyun.sls_logstore_encrypt_key_origin_check", Content: "package infraguard.rules.aliyun.sls_logstore_encrypt_key_origin_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"sls-logstore-encrypt-key-origin-check\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLS Logstore Encryption Key Origin Check\",\n\t\t\"zh\": \"日志服务日志库加密使用的主密钥材料来源为用户自行导入\",\n\t\t\"ja\": \"SLS ログストア暗号化キーオリジンチェック\",\n\t\t\"de\": \"SLS-Logstore Verschlüsselungsschlüssel-Herkunftsprüfung\",\n\t\t\"es\": \"Verificación de Origen de Clave de Cifrado de Logstore SLS\",\n\t\t\"fr\": \"Vérification de l'Origine de la Clé de Chiffrement du Logstore SLS\",\n\t\t\"pt\": \"Verificação de Origem da Chave de Criptografia do Logstore SLS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLS Logstores use externally imported key material (BYOK) for encryption, which provides better control over encryption keys.\",\n\t\t\"zh\": \"确保 SLS 日志库使用外部导入的密钥材料（BYOK）进行加密，以更好地控制加密密钥。\",\n\t\t\"ja\": \"SLS ログストアが暗号化に外部からインポートされたキー材料（BYOK）を使用していることを確認します。これにより、暗号化キーをより適切に制御できます。\",\n\t\t\"de\": \"Stellt sicher, dass SLS-Logstores extern importiertes Schlüsselmaterial (BYOK) für die Verschlüsselung verwenden, was eine bessere Kontrolle über Verschlüsselungsschlüssel bietet.\",\n\t\t\"es\": \"Garantiza que los Logstores SLS usen material de clave importado externamente (BYOK) para el cifrado, lo que proporciona un mejor control sobre las claves de cifrado.\",\n\t\t\"fr\": \"Garantit que les Logstores SLS utilisent du matériel de clé importé externe (BYOK) pour le chiffrement, ce qui offre un meilleur contrôle sur les clés de chiffrement.\",\n\t\t\"pt\": \"Garante que os Logstores SLS usem material de chave importado externamente (BYOK) para criptografia, o que fornece melhor controle sobre as chaves de criptografia.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Using externally imported key material provides better control over encryption keys and enhances security posture.\",\n\t\t\"zh\": \"使用外部导入的密钥材料可以更好地控制加密密钥并增强安全性。\",\n\t\t\"ja\": \"外部からインポートされたキー材料を使用することで、暗号化キーをより適切に制御し、セキュリティ体制を強化できます。\",\n\t\t\"de\": \"Die Verwendung extern importierten Schlüsselmaterials bietet eine bessere Kontrolle über Verschlüsselungsschlüssel und verbessert die Sicherheitslage.\",\n\t\t\"es\": \"Usar material de clave importado externamente proporciona un mejor control sobre las claves de cifrado y mejora la postura de seguridad.\",\n\t\t\"fr\": \"L'utilisation de matériel de clé importé externe offre un meilleur contrôle sur les clés de chiffrement et améliore la posture de sécurité.\",\n\t\t\"pt\": \"Usar material de chave importado externamente fornece melhor controle sobre as chaves de criptografia e melhora a postura de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the Logstore to use BYOK encryption with externally imported key material.\",\n\t\t\"zh\": \"配置日志库使用 BYOK 加密，导入外部密钥材料。\",\n\t\t\"ja\": \"外部からインポートされたキー材料で BYOK 暗号化を使用するようにログストアを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie den Logstore, um BYOK-Verschlüsselung mit extern importiertem Schlüsselmaterial zu verwenden.\",\n\t\t\"es\": \"Configure el Logstore para usar cifrado BYOK con material de clave importado externamente.\",\n\t\t\"fr\": \"Configurez le Logstore pour utiliser le chiffrement BYOK avec du matériel de clé importé externe.\",\n\t\t\"pt\": \"Configure o Logstore para usar criptografia BYOK com material de chave importado externamente.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLS::Logstore\"]\n}\n\n# Check if encryption is enabled with BYOK (externally imported key)\nis_compliant(resource) if {\n\t# Direct access to nested properties\n\tencrypt := resource.Properties.EncryptConf\n\tencrypt != null\n\tencrypt.Enable == true\n\n\t# Check for BYOK configuration - UserCmkInfo with CmkKeyId indicates BYOK\n\tuser_cmk := encrypt.UserCmkInfo\n\tuser_cmk != null\n\tuser_cmk.CmkKeyId != \"\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLS::Logstore\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EncryptConf\", \"UserCmkInfo\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:sls-logstore-hot-ttl-check", Name: models.I18nString{"de": "SLS Logstore Smart Tier Storage aktiviert", "en": "SLS Logstore Smart Tier Storage Enabled", "es": "Almacenamiento de Nivel Inteligente de Logstore SLS Habilitado", "fr": "Stockage à Niveaux Intelligents de Logstore SLS Activé", "ja": "SLS ログストアスマートティアストレージが有効", "pt": "Armazenamento de Camada Inteligente do Logstore SLS Habilitado", "zh": "SLS 日志库开启智能冷热分层存储"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass SLS-Logstores intelligentes Hot/Cold-Tier-Speicher für die Kostenoptimierung aktiviert haben.", "en": "Ensures SLS Logstores have intelligent hot/cold tier storage enabled for cost optimization.", "es": "Garantiza que los Logstores SLS tengan almacenamiento inteligente de nivel caliente/frío habilitado para optimización de costos.", "fr": "Garantit que les Logstores SLS ont le stockage intelligent à niveaux chaud/froid activé pour l'optimisation des coûts.", "ja": "SLS ログストアでコスト最適化のためにインテリジェントなホット/コールドティアストレージが有効になっていることを確認します。", "pt": "Garante que os Logstores SLS tenham armazenamento inteligente de camada quente/fria habilitado para otimização de custos.", "zh": "确保 SLS 日志库开启了智能冷热分层存储功能以优化成本。"}, Reason: models.I18nString{"de": "Hot/Cold-Tier-Speicher hilft bei der Kostenoptimierung, indem weniger häufig aufgerufene Daten automatisch in günstigeren Speicher verschoben werden.", "en": "Hot/cold tier storage helps optimize costs by automatically moving less frequently accessed data to cheaper storage.", "es": "El almacenamiento de nivel caliente/frío ayuda a optimizar los costos al mover automáticamente los datos menos accedidos a un almacenamiento más barato.", "fr": "Le stockage à niveaux chaud/froid aide à optimiser les coûts en déplaçant automatiquement les données moins fréquemment consultées vers un stockage moins cher.", "ja": "ホット/コールドティアストレージは、アクセス頻度の低いデータを自動的により安価なストレージに移動することで、コストの最適化に役立ちます。", "pt": "O armazenamento de camada quente/fria ajuda a otimizar custos movendo automaticamente dados menos acessados para armazenamento mais barato.", "zh": "智能冷热分层存储通过将访问频率较低的数据自动移动到更便宜的存储层来帮助优化成本。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie intelligentes Hot/Cold-Tier-Speicher für den Logstore.", "en": "Enable intelligent hot/cold tier storage for the Logstore.", "es": "Habilite el almacenamiento inteligente de nivel caliente/frío para el Logstore.", "fr": "Activez le stockage intelligent à niveaux chaud/froid pour le Logstore.", "ja": "ログストアのインテリジェントなホット/コールドティアストレージを有効にします。", "pt": "Habilite o armazenamento inteligente de camada quente/fria para o Logstore.", "zh": "为日志库启用智能冷热分层存储功能。"}, ResourceTypes: []string{"ALIYUN::SLS::Logstore"}, FilePath: "aliyun/rules/sls-logstore-hot-ttl-check.rego", PackageName: "infraguard.rules.aliyun.sls_logstore_hot_ttl_check", Content: "package infraguard.rules.aliyun.sls_logstore_hot_ttl_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"sls-logstore-hot-ttl-check\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"SLS Logstore Smart Tier Storage Enabled\",\n\t\t\"zh\": \"SLS 日志库开启智能冷热分层存储\",\n\t\t\"ja\": \"SLS ログストアスマートティアストレージが有効\",\n\t\t\"de\": \"SLS Logstore Smart Tier Storage aktiviert\",\n\t\t\"es\": \"Almacenamiento de Nivel Inteligente de Logstore SLS Habilitado\",\n\t\t\"fr\": \"Stockage à Niveaux Intelligents de Logstore SLS Activé\",\n\t\t\"pt\": \"Armazenamento de Camada Inteligente do Logstore SLS Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures SLS Logstores have intelligent hot/cold tier storage enabled for cost optimization.\",\n\t\t\"zh\": \"确保 SLS 日志库开启了智能冷热分层存储功能以优化成本。\",\n\t\t\"ja\": \"SLS ログストアでコスト最適化のためにインテリジェントなホット/コールドティアストレージが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass SLS-Logstores intelligentes Hot/Cold-Tier-Speicher für die Kostenoptimierung aktiviert haben.\",\n\t\t\"es\": \"Garantiza que los Logstores SLS tengan almacenamiento inteligente de nivel caliente/frío habilitado para optimización de costos.\",\n\t\t\"fr\": \"Garantit que les Logstores SLS ont le stockage intelligent à niveaux chaud/froid activé pour l'optimisation des coûts.\",\n\t\t\"pt\": \"Garante que os Logstores SLS tenham armazenamento inteligente de camada quente/fria habilitado para otimização de custos.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Hot/cold tier storage helps optimize costs by automatically moving less frequently accessed data to cheaper storage.\",\n\t\t\"zh\": \"智能冷热分层存储通过将访问频率较低的数据自动移动到更便宜的存储层来帮助优化成本。\",\n\t\t\"ja\": \"ホット/コールドティアストレージは、アクセス頻度の低いデータを自動的により安価なストレージに移動することで、コストの最適化に役立ちます。\",\n\t\t\"de\": \"Hot/Cold-Tier-Speicher hilft bei der Kostenoptimierung, indem weniger häufig aufgerufene Daten automatisch in günstigeren Speicher verschoben werden.\",\n\t\t\"es\": \"El almacenamiento de nivel caliente/frío ayuda a optimizar los costos al mover automáticamente los datos menos accedidos a un almacenamiento más barato.\",\n\t\t\"fr\": \"Le stockage à niveaux chaud/froid aide à optimiser les coûts en déplaçant automatiquement les données moins fréquemment consultées vers un stockage moins cher.\",\n\t\t\"pt\": \"O armazenamento de camada quente/fria ajuda a otimizar custos movendo automaticamente dados menos acessados para armazenamento mais barato.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable intelligent hot/cold tier storage for the Logstore.\",\n\t\t\"zh\": \"为日志库启用智能冷热分层存储功能。\",\n\t\t\"ja\": \"ログストアのインテリジェントなホット/コールドティアストレージを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie intelligentes Hot/Cold-Tier-Speicher für den Logstore.\",\n\t\t\"es\": \"Habilite el almacenamiento inteligente de nivel caliente/frío para el Logstore.\",\n\t\t\"fr\": \"Activez le stockage intelligent à niveaux chaud/froid pour le Logstore.\",\n\t\t\"pt\": \"Habilite o armazenamento inteligente de camada quente/fria para o Logstore.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLS::Logstore\"]\n}\n\nis_compliant(resource) if {\n\t# Check TTL - hot storage enabled when TTL > 7 days\n\t# Standard tier with TTL > 7 days indicates hot storage is available\n\tttl := helpers.get_property(resource, \"TTL\", 0)\n\tttl > 7\n\n\t# Check that PreserveStorage is not true (if true, TTL is ignored)\n\tpreserve := helpers.get_property(resource, \"PreserveStorage\", false)\n\tpreserve != true\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLS::Logstore\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TTL\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:sls-project-multi-zone", Name: models.I18nString{"de": "SLS-Projekt Zonenredundanter Speicher", "en": "SLS Project Zone-Redundant Storage", "es": "Almacenamiento Redundante de Zona del Proyecto SLS", "fr": "Stockage Redondant par Zone du Projet SLS", "ja": "SLS プロジェクトゾーン冗長ストレージ", "pt": "Armazenamento Redundante de Zona do Projeto SLS", "zh": "SLS 项目使用同城冗余存储"}, Severity: "medium", Description: models.I18nString{"de": "SLS-Projekte sollten zonenredundanten Speicher (ZRS) für Hochverfügbarkeit und Datenbeständigkeit verwenden.", "en": "SLS projects should use zone-redundant storage (ZRS) for high availability and data durability.", "es": "Los proyectos SLS deben usar almacenamiento redundante de zona (ZRS) para alta disponibilidad y durabilidad de datos.", "fr": "Les projets SLS doivent utiliser un stockage redondant par zone (ZRS) pour une haute disponibilité et une durabilité des données.", "ja": "SLS プロジェクトは、高可用性とデータの耐久性のためにゾーン冗長ストレージ（ZRS）を使用する必要があります。", "pt": "Os projetos SLS devem usar armazenamento redundante de zona (ZRS) para alta disponibilidade e durabilidade dos dados.", "zh": "SLS 项目应使用同城冗余存储（ZRS）以实现高可用性和数据持久性。"}, Reason: models.I18nString{"de": "Das SLS-Projekt verwendet keinen zonenredundanten Speicher, was die Datenverfügbarkeit beeinträchtigen kann.", "en": "The SLS project does not use zone-redundant storage, which may affect data availability.", "es": "El proyecto SLS no usa almacenamiento redundante de zona, lo que puede afectar la disponibilidad de datos.", "fr": "Le projet SLS n'utilise pas de stockage redondant par zone, ce qui peut affecter la disponibilité des données.", "ja": "SLS プロジェクトがゾーン冗長ストレージを使用していないため、データの可用性に影響を与える可能性があります。", "pt": "O projeto SLS não usa armazenamento redundante de zona, o que pode afetar a disponibilidade dos dados.", "zh": "SLS 项目未使用同城冗余存储，可能影响数据可用性。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie zonenredundanten Speicher, indem Sie DataRedundancyType beim Erstellen des Projekts auf 'ZRS' setzen.", "en": "Enable zone-redundant storage by setting DataRedundancyType to 'ZRS' when creating the project.", "es": "Habilite el almacenamiento redundante de zona estableciendo DataRedundancyType en 'ZRS' al crear el proyecto.", "fr": "Activez le stockage redondant par zone en définissant DataRedundancyType sur 'ZRS' lors de la création du projet.", "ja": "プロジェクト作成時に DataRedundancyType を 'ZRS' に設定してゾーン冗長ストレージを有効にします。", "pt": "Habilite o armazenamento redundante de zona definindo DataRedundancyType como 'ZRS' ao criar o projeto.", "zh": "在创建项目时通过将 DataRedundancyType 设置为'ZRS'来启用同城冗余存储。"}, ResourceTypes: []string{"ALIYUN::SLS::Project"}, FilePath: "aliyun/rules/sls-project-multi-zone.rego", PackageName: "infraguard.rules.aliyun.sls_project_multi_zone", Content: "package infraguard.rules.aliyun.sls_project_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"sls-project-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"SLS Project Zone-Redundant Storage\",\n\t\t\"zh\": \"SLS 项目使用同城冗余存储\",\n\t\t\"ja\": \"SLS プロジェクトゾーン冗長ストレージ\",\n\t\t\"de\": \"SLS-Projekt Zonenredundanter Speicher\",\n\t\t\"es\": \"Almacenamiento Redundante de Zona del Proyecto SLS\",\n\t\t\"fr\": \"Stockage Redondant par Zone du Projet SLS\",\n\t\t\"pt\": \"Armazenamento Redundante de Zona do Projeto SLS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"SLS projects should use zone-redundant storage (ZRS) for high availability and data durability.\",\n\t\t\"zh\": \"SLS 项目应使用同城冗余存储（ZRS）以实现高可用性和数据持久性。\",\n\t\t\"ja\": \"SLS プロジェクトは、高可用性とデータの耐久性のためにゾーン冗長ストレージ（ZRS）を使用する必要があります。\",\n\t\t\"de\": \"SLS-Projekte sollten zonenredundanten Speicher (ZRS) für Hochverfügbarkeit und Datenbeständigkeit verwenden.\",\n\t\t\"es\": \"Los proyectos SLS deben usar almacenamiento redundante de zona (ZRS) para alta disponibilidad y durabilidad de datos.\",\n\t\t\"fr\": \"Les projets SLS doivent utiliser un stockage redondant par zone (ZRS) pour une haute disponibilité et une durabilité des données.\",\n\t\t\"pt\": \"Os projetos SLS devem usar armazenamento redundante de zona (ZRS) para alta disponibilidade e durabilidade dos dados.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The SLS project does not use zone-redundant storage, which may affect data availability.\",\n\t\t\"zh\": \"SLS 项目未使用同城冗余存储，可能影响数据可用性。\",\n\t\t\"ja\": \"SLS プロジェクトがゾーン冗長ストレージを使用していないため、データの可用性に影響を与える可能性があります。\",\n\t\t\"de\": \"Das SLS-Projekt verwendet keinen zonenredundanten Speicher, was die Datenverfügbarkeit beeinträchtigen kann.\",\n\t\t\"es\": \"El proyecto SLS no usa almacenamiento redundante de zona, lo que puede afectar la disponibilidad de datos.\",\n\t\t\"fr\": \"Le projet SLS n'utilise pas de stockage redondant par zone, ce qui peut affecter la disponibilité des données.\",\n\t\t\"pt\": \"O projeto SLS não usa armazenamento redundante de zona, o que pode afetar a disponibilidade dos dados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable zone-redundant storage by setting DataRedundancyType to 'ZRS' when creating the project.\",\n\t\t\"zh\": \"在创建项目时通过将 DataRedundancyType 设置为'ZRS'来启用同城冗余存储。\",\n\t\t\"ja\": \"プロジェクト作成時に DataRedundancyType を 'ZRS' に設定してゾーン冗長ストレージを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie zonenredundanten Speicher, indem Sie DataRedundancyType beim Erstellen des Projekts auf 'ZRS' setzen.\",\n\t\t\"es\": \"Habilite el almacenamiento redundante de zona estableciendo DataRedundancyType en 'ZRS' al crear el proyecto.\",\n\t\t\"fr\": \"Activez le stockage redondant par zone en définissant DataRedundancyType sur 'ZRS' lors de la création du projet.\",\n\t\t\"pt\": \"Habilite o armazenamento redundante de zona definindo DataRedundancyType como 'ZRS' ao criar o projeto.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::SLS::Project\"]\n}\n\n# Check if project has ZRS enabled\nhas_zrs_enabled(resource) if {\n\tredundancy_type := helpers.get_property(resource, \"DataRedundancyType\", \"LRS\")\n\tredundancy_type == \"ZRS\"\n}\n\n# Deny rule: SLS projects should have ZRS enabled\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::SLS::Project\")\n\tnot has_zrs_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DataRedundancyType\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:transit-router-vpc-attachment-multi-zone", Name: models.I18nString{"de": "Transit Router VPC-Anhang Multi-Zonen-Konfiguration", "en": "Transit Router VPC Attachment Multi-Zone Configuration", "es": "Configuración Multi-Zona de Conexión VPC del Enrutador de Tránsito", "fr": "Configuration Multi-Zone de Connexion VPC du Routeur de Transit", "ja": "トランジットルーター VPC アタッチメントマルチゾーン設定", "pt": "Configuração Multi-Zona de Anexo VPC do Roteador de Trânsito", "zh": "为转发路由器 VPC 连接设置多个可用区"}, Severity: "high", Description: models.I18nString{"de": "Transit Router VPC-Anhänge sollten mit vSwitches in mindestens zwei verschiedenen Verfügbarkeitszonen für regionsübergreifende Hochverfügbarkeit konfiguriert werden.", "en": "Transit Router VPC attachments should be configured with vSwitches in at least two different availability zones for cross-zone high availability.", "es": "Las conexiones VPC del enrutador de tránsito deben configurarse con vSwitches en al menos dos zonas de disponibilidad diferentes para alta disponibilidad entre zonas.", "fr": "Les connexions VPC du routeur de transit doivent être configurées avec des vSwitches dans au moins deux zones de disponibilité différentes pour une haute disponibilité inter-zones.", "ja": "トランジットルーター VPC アタッチメントは、クロスゾーン高可用性のために、少なくとも 2 つの異なる可用性ゾーンに vSwitch を設定する必要があります。", "pt": "Os anexos VPC do roteador de trânsito devem ser configurados com vSwitches em pelo menos duas zonas de disponibilidade diferentes para alta disponibilidade entre zonas.", "zh": "为转发路由器的 VPC 连接设置两个分布在不同可用区的交换机，保障产品跨可用区的高可用性，视为合规。"}, Reason: models.I18nString{"de": "Der Transit Router VPC-Anhang ist nur mit vSwitches in einer Verfügbarkeitszone konfiguriert, was einen Single Point of Failure schafft.", "en": "The Transit Router VPC attachment is configured with vSwitches in only one availability zone, creating a single point of failure.", "es": "La conexión VPC del enrutador de tránsito está configurada con vSwitches en solo una zona de disponibilidad, creando un punto único de falla.", "fr": "La connexion VPC du routeur de transit est configurée avec des vSwitches dans une seule zone de disponibilité, créant un point de défaillance unique.", "ja": "トランジットルーター VPC アタッチメントが 1 つの可用性ゾーンにのみ vSwitch で設定されているため、単一障害点が作成されます。", "pt": "O anexo VPC do roteador de trânsito está configurado com vSwitches em apenas uma zona de disponibilidade, criando um ponto único de falha.", "zh": "转发路由器 VPC 连接仅配置了一个可用区的交换机，存在单点故障风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie mindestens zwei vSwitches in verschiedenen Verfügbarkeitszonen in der Eigenschaft ZoneMappings.", "en": "Configure at least two vSwitches in different availability zones in the ZoneMappings property.", "es": "Configure al menos dos vSwitches en diferentes zonas de disponibilidad en la propiedad ZoneMappings.", "fr": "Configurez au moins deux vSwitches dans différentes zones de disponibilité dans la propriété ZoneMappings.", "ja": "ZoneMappings プロパティで、異なる可用性ゾーンに少なくとも 2 つの vSwitch を設定します。", "pt": "Configure pelo menos dois vSwitches em diferentes zonas de disponibilidade na propriedade ZoneMappings.", "zh": "在 ZoneMappings 属性中配置至少两个不同可用区的交换机。"}, ResourceTypes: []string{"ALIYUN::CEN::TransitRouterVpcAttachment"}, FilePath: "aliyun/rules/transit-router-vpc-attachment-multi-zone.rego", PackageName: "infraguard.rules.aliyun.transit_router_vpc_attachment_multi_zone", Content: "package infraguard.rules.aliyun.transit_router_vpc_attachment_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"transit-router-vpc-attachment-multi-zone\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Transit Router VPC Attachment Multi-Zone Configuration\",\n\t\t\"zh\": \"为转发路由器 VPC 连接设置多个可用区\",\n\t\t\"ja\": \"トランジットルーター VPC アタッチメントマルチゾーン設定\",\n\t\t\"de\": \"Transit Router VPC-Anhang Multi-Zonen-Konfiguration\",\n\t\t\"es\": \"Configuración Multi-Zona de Conexión VPC del Enrutador de Tránsito\",\n\t\t\"fr\": \"Configuration Multi-Zone de Connexion VPC du Routeur de Transit\",\n\t\t\"pt\": \"Configuração Multi-Zona de Anexo VPC do Roteador de Trânsito\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Transit Router VPC attachments should be configured with vSwitches in at least two different availability zones for cross-zone high availability.\",\n\t\t\"zh\": \"为转发路由器的 VPC 连接设置两个分布在不同可用区的交换机，保障产品跨可用区的高可用性，视为合规。\",\n\t\t\"ja\": \"トランジットルーター VPC アタッチメントは、クロスゾーン高可用性のために、少なくとも 2 つの異なる可用性ゾーンに vSwitch を設定する必要があります。\",\n\t\t\"de\": \"Transit Router VPC-Anhänge sollten mit vSwitches in mindestens zwei verschiedenen Verfügbarkeitszonen für regionsübergreifende Hochverfügbarkeit konfiguriert werden.\",\n\t\t\"es\": \"Las conexiones VPC del enrutador de tránsito deben configurarse con vSwitches en al menos dos zonas de disponibilidad diferentes para alta disponibilidad entre zonas.\",\n\t\t\"fr\": \"Les connexions VPC du routeur de transit doivent être configurées avec des vSwitches dans au moins deux zones de disponibilité différentes pour une haute disponibilité inter-zones.\",\n\t\t\"pt\": \"Os anexos VPC do roteador de trânsito devem ser configurados com vSwitches em pelo menos duas zonas de disponibilidade diferentes para alta disponibilidade entre zonas.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The Transit Router VPC attachment is configured with vSwitches in only one availability zone, creating a single point of failure.\",\n\t\t\"zh\": \"转发路由器 VPC 连接仅配置了一个可用区的交换机，存在单点故障风险。\",\n\t\t\"ja\": \"トランジットルーター VPC アタッチメントが 1 つの可用性ゾーンにのみ vSwitch で設定されているため、単一障害点が作成されます。\",\n\t\t\"de\": \"Der Transit Router VPC-Anhang ist nur mit vSwitches in einer Verfügbarkeitszone konfiguriert, was einen Single Point of Failure schafft.\",\n\t\t\"es\": \"La conexión VPC del enrutador de tránsito está configurada con vSwitches en solo una zona de disponibilidad, creando un punto único de falla.\",\n\t\t\"fr\": \"La connexion VPC du routeur de transit est configurée avec des vSwitches dans une seule zone de disponibilité, créant un point de défaillance unique.\",\n\t\t\"pt\": \"O anexo VPC do roteador de trânsito está configurado com vSwitches em apenas uma zona de disponibilidade, criando um ponto único de falha.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure at least two vSwitches in different availability zones in the ZoneMappings property.\",\n\t\t\"zh\": \"在 ZoneMappings 属性中配置至少两个不同可用区的交换机。\",\n\t\t\"ja\": \"ZoneMappings プロパティで、異なる可用性ゾーンに少なくとも 2 つの vSwitch を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie mindestens zwei vSwitches in verschiedenen Verfügbarkeitszonen in der Eigenschaft ZoneMappings.\",\n\t\t\"es\": \"Configure al menos dos vSwitches en diferentes zonas de disponibilidad en la propiedad ZoneMappings.\",\n\t\t\"fr\": \"Configurez au moins deux vSwitches dans différentes zones de disponibilité dans la propriété ZoneMappings.\",\n\t\t\"pt\": \"Configure pelo menos dois vSwitches em diferentes zonas de disponibilidade na propriedade ZoneMappings.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::CEN::TransitRouterVpcAttachment\"]\n}\n\n# Get unique zone IDs from zone mappings\nunique_zones(zone_mappings) := zones if {\n\tzones := {zone_id |\n\t\tsome mapping in zone_mappings\n\t\tzone_id := mapping.ZoneId\n\t}\n}\n\n# Check if attachment has multiple zones\nhas_multiple_zones(resource) if {\n\tzone_mappings := resource.Properties.ZoneMappings\n\tzones := unique_zones(zone_mappings)\n\tcount(zones) >= 2\n}\n\n# Deny rule: Transit Router VPC attachments must have vSwitches in multiple zones\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::CEN::TransitRouterVpcAttachment\")\n\tnot has_multiple_zones(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"ZoneMappings\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:tsdb-instance-security-ip-check", Name: models.I18nString{"de": "TSDB-Instanz erlaubt keinen IP-Zugriff", "en": "TSDB Instance Does Not Allow Any IP Access", "es": "La Instancia TSDB No Permite Acceso de Cualquier IP", "fr": "L'Instance TSDB N'autorise Pas l'Accès IP", "ja": "TSDB インスタンスが任意の IP アクセスを許可しない", "pt": "Instância TSDB Não Permite Acesso de Qualquer IP", "zh": "TSDB 实例安全白名单检测"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass TSDB-Instanzen keine Sicherheits-Whitelists haben, die alle IPs erlauben.", "en": "Ensures that TSDB instances do not have security whitelists that allow all IPs.", "es": "Garantiza que las instancias TSDB no tengan listas blancas de seguridad que permitan todas las IPs.", "fr": "Garantit que les instances TSDB n'ont pas de listes blanches de sécurité qui autorisent toutes les IP.", "ja": "TSDB インスタンスにすべての IP を許可するセキュリティホワイトリストがないことを確認します。", "pt": "Garante que as instâncias TSDB não tenham listas brancas de segurança que permitam todos os IPs.", "zh": "TSDB 实例没有开启任意 IP 访问，视为合规。"}, Reason: models.I18nString{"de": "TSDB-Instanz erlaubt Zugriff von jeder IP-Adresse, was ein Sicherheitsrisiko darstellt.", "en": "TSDB instance allows access from any IP address, which is a security risk.", "es": "La instancia TSDB permite el acceso desde cualquier dirección IP, lo cual es un riesgo de seguridad.", "fr": "L'instance TSDB autorise l'accès depuis n'importe quelle adresse IP, ce qui constitue un risque de sécurité.", "ja": "TSDB インスタンスが任意の IP アドレスからのアクセスを許可しており、セキュリティリスクがあります。", "pt": "A instância TSDB permite acesso de qualquer endereço IP, o que é um risco de segurança.", "zh": "TSDB 实例开启任意 IP 访问，存在安全风险。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die Sicherheits-Whitelist, um den Zugriff auf bestimmte IPs einzuschränken.", "en": "Configure security whitelist to restrict access to specific IPs.", "es": "Configure la lista blanca de seguridad para restringir el acceso a IPs específicas.", "fr": "Configurez la liste blanche de sécurité pour restreindre l'accès à des IP spécifiques.", "ja": "特定の IP へのアクセスを制限するためにセキュリティホワイトリストを設定します。", "pt": "Configure a lista branca de segurança para restringir o acesso a IPs específicos.", "zh": "请配置安全白名单以限制特定 IP 访问。"}, ResourceTypes: []string{"ALIYUN::TSDB::HiTSDBInstance"}, FilePath: "aliyun/rules/tsdb-instance-security-ip-check.rego", PackageName: "infraguard.rules.aliyun.tsdb_instance_security_ip_check", Content: "package infraguard.rules.aliyun.tsdb_instance_security_ip_check\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"tsdb-instance-security-ip-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"TSDB Instance Does Not Allow Any IP Access\",\n\t\t\"zh\": \"TSDB 实例安全白名单检测\",\n\t\t\"ja\": \"TSDB インスタンスが任意の IP アクセスを許可しない\",\n\t\t\"de\": \"TSDB-Instanz erlaubt keinen IP-Zugriff\",\n\t\t\"es\": \"La Instancia TSDB No Permite Acceso de Cualquier IP\",\n\t\t\"fr\": \"L'Instance TSDB N'autorise Pas l'Accès IP\",\n\t\t\"pt\": \"Instância TSDB Não Permite Acesso de Qualquer IP\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that TSDB instances do not have security whitelists that allow all IPs.\",\n\t\t\"zh\": \"TSDB 实例没有开启任意 IP 访问，视为合规。\",\n\t\t\"ja\": \"TSDB インスタンスにすべての IP を許可するセキュリティホワイトリストがないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass TSDB-Instanzen keine Sicherheits-Whitelists haben, die alle IPs erlauben.\",\n\t\t\"es\": \"Garantiza que las instancias TSDB no tengan listas blancas de seguridad que permitan todas las IPs.\",\n\t\t\"fr\": \"Garantit que les instances TSDB n'ont pas de listes blanches de sécurité qui autorisent toutes les IP.\",\n\t\t\"pt\": \"Garante que as instâncias TSDB não tenham listas brancas de segurança que permitam todos os IPs.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"TSDB instance allows access from any IP address, which is a security risk.\",\n\t\t\"zh\": \"TSDB 实例开启任意 IP 访问，存在安全风险。\",\n\t\t\"ja\": \"TSDB インスタンスが任意の IP アドレスからのアクセスを許可しており、セキュリティリスクがあります。\",\n\t\t\"de\": \"TSDB-Instanz erlaubt Zugriff von jeder IP-Adresse, was ein Sicherheitsrisiko darstellt.\",\n\t\t\"es\": \"La instancia TSDB permite el acceso desde cualquier dirección IP, lo cual es un riesgo de seguridad.\",\n\t\t\"fr\": \"L'instance TSDB autorise l'accès depuis n'importe quelle adresse IP, ce qui constitue un risque de sécurité.\",\n\t\t\"pt\": \"A instância TSDB permite acesso de qualquer endereço IP, o que é um risco de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure security whitelist to restrict access to specific IPs.\",\n\t\t\"zh\": \"请配置安全白名单以限制特定 IP 访问。\",\n\t\t\"ja\": \"特定の IP へのアクセスを制限するためにセキュリティホワイトリストを設定します。\",\n\t\t\"de\": \"Konfigurieren Sie die Sicherheits-Whitelist, um den Zugriff auf bestimmte IPs einzuschränken.\",\n\t\t\"es\": \"Configure la lista blanca de seguridad para restringir el acceso a IPs específicas.\",\n\t\t\"fr\": \"Configurez la liste blanche de sécurité pour restreindre l'accès à des IP spécifiques.\",\n\t\t\"pt\": \"Configure a lista branca de segurança para restringir o acesso a IPs específicos.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::TSDB::HiTSDBInstance\"]\n}\n\n# Check if whitelist allows any IP\nallows_any_ip(whitelist) if {\n\tcount(whitelist) == 1\n\twhitelist[0] == \"0.0.0.0/0\"\n}\n\nallows_any_ip(whitelist) if {\n\tcount(whitelist) == 1\n\twhitelist[0] == \"0.0.0.0\"\n}\n\nallows_any_ip(whitelist) := false if {\n\tcount(whitelist) != 1\n}\n\nallows_any_ip(whitelist) := false if {\n\tcount(whitelist) == 1\n\twhitelist[0] != \"0.0.0.0/0\"\n\twhitelist[0] != \"0.0.0.0\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::TSDB::HiTSDBInstance\")\n\n\twhitelist := resource.Properties.SecurityIpList\n\tallows_any_ip(whitelist)\n\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"SecurityIpList\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:use-waf-instance-for-security-protection", Name: models.I18nString{"de": "Verwenden Sie WAF für Sicherheitsschutz", "en": "Use WAF for Security Protection", "es": "Usar WAF para Protección de Seguridad", "fr": "Utiliser WAF pour la Protection de Sécurité", "ja": "セキュリティ保護に WAF を使用", "pt": "Usar WAF para Proteção de Segurança", "zh": "使用 WEB 防火墙对网站或 APP 进行安全防护"}, Severity: "high", Description: models.I18nString{"de": "Web Application Firewall (WAF) sollte verwendet werden, um Websites und Apps vor webbasierten Angriffen zu schützen.", "en": "WEB Application Firewall (WAF) should be used to protect websites and APPs from web-based attacks.", "es": "El Firewall de Aplicaciones Web (WAF) debe usarse para proteger sitios web y aplicaciones de ataques basados en web.", "fr": "Le Pare-feu d'Application Web (WAF) doit être utilisé pour protéger les sites web et les applications contre les attaques basées sur le web.", "ja": "Web アプリケーションファイアウォール（WAF）を使用して、Web サイトとアプリを Web ベースの攻撃から保護する必要があります。", "pt": "O Firewall de Aplicações Web (WAF) deve ser usado para proteger sites e aplicativos de ataques baseados na web.", "zh": "使用 WEB 防火墙对网站或 APP 进行安全防护，视为合规。"}, Reason: models.I18nString{"de": "Die ALB-Instanz hat WAF nicht aktiviert, wodurch Web-Assets anfällig für Angriffe sind.", "en": "The ALB instance does not have WAF enabled, leaving web assets vulnerable to attacks.", "es": "La instancia ALB no tiene WAF habilitado, dejando los activos web vulnerables a ataques.", "fr": "L'instance ALB n'a pas WAF activé, laissant les actifs web vulnérables aux attaques.", "ja": "ALB インスタンスで WAF が有効になっていないため、Web アセットが攻撃に対して脆弱になります。", "pt": "A instância ALB não tem WAF habilitado, deixando os ativos web vulneráveis a ataques.", "zh": "ALB 实例未启用 WAF 防护，使 Web 资产容易受到攻击。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie WAF für die ALB-Instanz, indem Sie LoadBalancerEdition auf 'StandardWithWaf' setzen.", "en": "Enable WAF for the ALB instance by setting LoadBalancerEdition to 'StandardWithWaf'.", "es": "Habilite WAF para la instancia ALB estableciendo LoadBalancerEdition en 'StandardWithWaf'.", "fr": "Activez WAF pour l'instance ALB en définissant LoadBalancerEdition sur 'StandardWithWaf'.", "ja": "LoadBalancerEdition を 'StandardWithWaf' に設定して、ALB インスタンスの WAF を有効にします。", "pt": "Habilite WAF para a instância ALB definindo LoadBalancerEdition como 'StandardWithWaf'.", "zh": "通过将 LoadBalancerEdition 设置为 'StandardWithWaf' 为 ALB 实例开启 WAF 防护。"}, ResourceTypes: []string{"ALIYUN::ALB::LoadBalancer"}, FilePath: "aliyun/rules/use-waf-instance-for-security-protection.rego", PackageName: "infraguard.rules.aliyun.use_waf_instance_for_security_protection", Content: "package infraguard.rules.aliyun.use_waf_instance_for_security_protection\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"use-waf-instance-for-security-protection\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"Use WAF for Security Protection\",\n\t\t\"zh\": \"使用 WEB 防火墙对网站或 APP 进行安全防护\",\n\t\t\"ja\": \"セキュリティ保護に WAF を使用\",\n\t\t\"de\": \"Verwenden Sie WAF für Sicherheitsschutz\",\n\t\t\"es\": \"Usar WAF para Protección de Seguridad\",\n\t\t\"fr\": \"Utiliser WAF pour la Protection de Sécurité\",\n\t\t\"pt\": \"Usar WAF para Proteção de Segurança\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"WEB Application Firewall (WAF) should be used to protect websites and APPs from web-based attacks.\",\n\t\t\"zh\": \"使用 WEB 防火墙对网站或 APP 进行安全防护，视为合规。\",\n\t\t\"ja\": \"Web アプリケーションファイアウォール（WAF）を使用して、Web サイトとアプリを Web ベースの攻撃から保護する必要があります。\",\n\t\t\"de\": \"Web Application Firewall (WAF) sollte verwendet werden, um Websites und Apps vor webbasierten Angriffen zu schützen.\",\n\t\t\"es\": \"El Firewall de Aplicaciones Web (WAF) debe usarse para proteger sitios web y aplicaciones de ataques basados en web.\",\n\t\t\"fr\": \"Le Pare-feu d'Application Web (WAF) doit être utilisé pour protéger les sites web et les applications contre les attaques basées sur le web.\",\n\t\t\"pt\": \"O Firewall de Aplicações Web (WAF) deve ser usado para proteger sites e aplicativos de ataques baseados na web.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The ALB instance does not have WAF enabled, leaving web assets vulnerable to attacks.\",\n\t\t\"zh\": \"ALB 实例未启用 WAF 防护，使 Web 资产容易受到攻击。\",\n\t\t\"ja\": \"ALB インスタンスで WAF が有効になっていないため、Web アセットが攻撃に対して脆弱になります。\",\n\t\t\"de\": \"Die ALB-Instanz hat WAF nicht aktiviert, wodurch Web-Assets anfällig für Angriffe sind.\",\n\t\t\"es\": \"La instancia ALB no tiene WAF habilitado, dejando los activos web vulnerables a ataques.\",\n\t\t\"fr\": \"L'instance ALB n'a pas WAF activé, laissant les actifs web vulnérables aux attaques.\",\n\t\t\"pt\": \"A instância ALB não tem WAF habilitado, deixando os ativos web vulneráveis a ataques.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable WAF for the ALB instance by setting LoadBalancerEdition to 'StandardWithWaf'.\",\n\t\t\"zh\": \"通过将 LoadBalancerEdition 设置为 'StandardWithWaf' 为 ALB 实例开启 WAF 防护。\",\n\t\t\"ja\": \"LoadBalancerEdition を 'StandardWithWaf' に設定して、ALB インスタンスの WAF を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie WAF für die ALB-Instanz, indem Sie LoadBalancerEdition auf 'StandardWithWaf' setzen.\",\n\t\t\"es\": \"Habilite WAF para la instancia ALB estableciendo LoadBalancerEdition en 'StandardWithWaf'.\",\n\t\t\"fr\": \"Activez WAF pour l'instance ALB en définissant LoadBalancerEdition sur 'StandardWithWaf'.\",\n\t\t\"pt\": \"Habilite WAF para a instância ALB definindo LoadBalancerEdition como 'StandardWithWaf'.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ALB::LoadBalancer\"]\n}\n\n# Check if ALB has WAF enabled via its edition\nis_waf_enabled(resource) if {\n\thelpers.get_property(resource, \"LoadBalancerEdition\", \"\") == \"StandardWithWaf\"\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_waf_enabled(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LoadBalancerEdition\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:vpc-flow-logs-enabled", Name: models.I18nString{"de": "VPC-Flussprotokolle aktiviert", "en": "VPC Flow Logs Enabled", "es": "Registros de Flujo VPC Habilitados", "fr": "Journaux de Flux VPC Activés", "ja": "VPC フローログが有効", "pt": "Logs de Fluxo VPC Habilitados", "zh": "VPC 开启流日志"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass VPC-Flussprotokolle für die Überwachung des Netzwerkverkehrs aktiviert sind.", "en": "Ensures VPC flow logs are enabled for monitoring network traffic.", "es": "Garantiza que los registros de flujo VPC estén habilitados para monitorear el tráfico de red.", "fr": "Garantit que les journaux de flux VPC sont activés pour surveiller le trafic réseau.", "ja": "ネットワークトラフィックを監視するために VPC フローログが有効になっていることを確認します。", "pt": "Garante que os logs de fluxo VPC estejam habilitados para monitorar tráfego de rede.", "zh": "确保 VPC 开启了流日志，以便监控网络流量。"}, Reason: models.I18nString{"de": "Flussprotokolle bieten Einblicke in Netzwerkverkehrsmuster und helfen bei Sicherheitsaudits.", "en": "Flow logs provide visibility into network traffic patterns and help in security auditing.", "es": "Los registros de flujo proporcionan visibilidad sobre los patrones de tráfico de red y ayudan en la auditoría de seguridad.", "fr": "Les journaux de flux fournissent une visibilité sur les modèles de trafic réseau et aident à l'audit de sécurité.", "ja": "フローログはネットワークトラフィックパターンの可視性を提供し、セキュリティ監査に役立ちます。", "pt": "Logs de fluxo fornecem visibilidade sobre padrões de tráfego de rede e ajudam na auditoria de segurança.", "zh": "流日志提供了网络流量模式的可见性，有助于安全审计。"}, Recommendation: models.I18nString{"de": "Fügen Sie die ALIYUN::VPC::FlowLog-Ressource hinzu, um Flussprotokolle für das VPC zu aktivieren.", "en": "Add ALIYUN::VPC::FlowLog resource to enable flow logs for the VPC.", "es": "Agregue el recurso ALIYUN::VPC::FlowLog para habilitar los registros de flujo para el VPC.", "fr": "Ajoutez la ressource ALIYUN::VPC::FlowLog pour activer les journaux de flux pour le VPC.", "ja": "ALIYUN::VPC::FlowLog リソースを追加して、VPC のフローログを有効にします。", "pt": "Adicione o recurso ALIYUN::VPC::FlowLog para habilitar logs de fluxo para o VPC.", "zh": "添加 ALIYUN::VPC::FlowLog 资源以为 VPC 开启流日志。"}, ResourceTypes: []string{"ALIYUN::ECS::VPC"}, FilePath: "aliyun/rules/vpc-flow-logs-enabled.rego", PackageName: "infraguard.rules.aliyun.vpc_flow_logs_enabled", Content: "package infraguard.rules.aliyun.vpc_flow_logs_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"vpc-flow-logs-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"VPC Flow Logs Enabled\",\n\t\t\"zh\": \"VPC 开启流日志\",\n\t\t\"ja\": \"VPC フローログが有効\",\n\t\t\"de\": \"VPC-Flussprotokolle aktiviert\",\n\t\t\"es\": \"Registros de Flujo VPC Habilitados\",\n\t\t\"fr\": \"Journaux de Flux VPC Activés\",\n\t\t\"pt\": \"Logs de Fluxo VPC Habilitados\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures VPC flow logs are enabled for monitoring network traffic.\",\n\t\t\"zh\": \"确保 VPC 开启了流日志，以便监控网络流量。\",\n\t\t\"ja\": \"ネットワークトラフィックを監視するために VPC フローログが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass VPC-Flussprotokolle für die Überwachung des Netzwerkverkehrs aktiviert sind.\",\n\t\t\"es\": \"Garantiza que los registros de flujo VPC estén habilitados para monitorear el tráfico de red.\",\n\t\t\"fr\": \"Garantit que les journaux de flux VPC sont activés pour surveiller le trafic réseau.\",\n\t\t\"pt\": \"Garante que os logs de fluxo VPC estejam habilitados para monitorar tráfego de rede.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Flow logs provide visibility into network traffic patterns and help in security auditing.\",\n\t\t\"zh\": \"流日志提供了网络流量模式的可见性，有助于安全审计。\",\n\t\t\"ja\": \"フローログはネットワークトラフィックパターンの可視性を提供し、セキュリティ監査に役立ちます。\",\n\t\t\"de\": \"Flussprotokolle bieten Einblicke in Netzwerkverkehrsmuster und helfen bei Sicherheitsaudits.\",\n\t\t\"es\": \"Los registros de flujo proporcionan visibilidad sobre los patrones de tráfico de red y ayudan en la auditoría de seguridad.\",\n\t\t\"fr\": \"Les journaux de flux fournissent une visibilité sur les modèles de trafic réseau et aident à l'audit de sécurité.\",\n\t\t\"pt\": \"Logs de fluxo fornecem visibilidade sobre padrões de tráfego de rede e ajudam na auditoria de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add ALIYUN::VPC::FlowLog resource to enable flow logs for the VPC.\",\n\t\t\"zh\": \"添加 ALIYUN::VPC::FlowLog 资源以为 VPC 开启流日志。\",\n\t\t\"ja\": \"ALIYUN::VPC::FlowLog リソースを追加して、VPC のフローログを有効にします。\",\n\t\t\"de\": \"Fügen Sie die ALIYUN::VPC::FlowLog-Ressource hinzu, um Flussprotokolle für das VPC zu aktivieren.\",\n\t\t\"es\": \"Agregue el recurso ALIYUN::VPC::FlowLog para habilitar los registros de flujo para el VPC.\",\n\t\t\"fr\": \"Ajoutez la ressource ALIYUN::VPC::FlowLog pour activer les journaux de flux pour le VPC.\",\n\t\t\"pt\": \"Adicione o recurso ALIYUN::VPC::FlowLog para habilitar logs de fluxo para o VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::VPC\"]\n}\n\n# Cross-resource check: is there a FlowLog resource for this VPC?\nhas_flow_log(vpc_id) if {\n\tsome name, res in helpers.resources_by_type(\"ALIYUN::VPC::FlowLog\")\n\thelpers.is_referencing(helpers.get_property(res, \"ResourceId\", \"\"), vpc_id)\n}\n\ndeny contains result if {\n\tsome vpc_id, resource in helpers.resources_by_type(\"ALIYUN::ECS::VPC\")\n\tnot has_flow_log(vpc_id)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": vpc_id,\n\t\t\"violation_path\": [],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:vpc-network-acl-not-empty", Name: models.I18nString{"de": "VPC-Netzwerk-ACL nicht leer", "en": "VPC Network ACL Not Empty", "es": "ACL de Red VPC No Vacío", "fr": "ACL de Réseau VPC Non Vide", "ja": "VPC ネットワーク ACL が空でない", "pt": "ACL de Rede VPC Não Vazio", "zh": "专有网络 ACL 不为空条目"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass VPC-Netzwerk-ACLs mindestens eine Regel konfiguriert haben.", "en": "Ensures VPC Network ACLs have at least one rule configured.", "es": "Garantiza que las ACL de red VPC tengan al menos una regla configurada.", "fr": "Garantit que les ACL de réseau VPC ont au moins une règle configurée.", "ja": "VPC ネットワーク ACL に少なくとも 1 つのルールが設定されていることを確認します。", "pt": "Garante que as ACLs de rede VPC tenham pelo menos uma regra configurada.", "zh": "确保 VPC 网络 ACL 至少配置了一条规则。"}, Reason: models.I18nString{"de": "Eine leere ACL bietet keine Sicherheitsfilterung, was zu unbeabsichtigtem Zugriff führen kann.", "en": "An empty ACL provides no security filtering, which might lead to unintended access.", "es": "Una ACL vacía no proporciona filtrado de seguridad, lo que podría provocar acceso no deseado.", "fr": "Une ACL vide ne fournit aucun filtrage de sécurité, ce qui peut entraîner un accès non intentionnel.", "ja": "空の ACL はセキュリティフィルタリングを提供しないため、意図しないアクセスにつながる可能性があります。", "pt": "Uma ACL vazia não fornece filtragem de segurança, o que pode levar a acesso não intencional.", "zh": "空的 ACL 不提供任何安全过滤，可能导致非预期的访问。"}, Recommendation: models.I18nString{"de": "Fügen Sie Ein- und Ausgangsregeln zur VPC-Netzwerk-ACL hinzu.", "en": "Add ingress and egress rules to the VPC Network ACL.", "es": "Agregue reglas de entrada y salida a la ACL de red VPC.", "fr": "Ajoutez des règles d'entrée et de sortie à l'ACL de réseau VPC.", "ja": "VPC ネットワーク ACL にイングレスとエグレスルールを追加します。", "pt": "Adicione regras de entrada e saída à ACL de rede VPC.", "zh": "为 VPC 网络 ACL 添加进方向和出方向规则。"}, ResourceTypes: []string{"ALIYUN::VPC::NetworkAcl"}, FilePath: "aliyun/rules/vpc-network-acl-not-empty.rego", PackageName: "infraguard.rules.aliyun.vpc_network_acl_not_empty", Content: "package infraguard.rules.aliyun.vpc_network_acl_not_empty\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"vpc-network-acl-not-empty\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"VPC Network ACL Not Empty\",\n\t\t\"zh\": \"专有网络 ACL 不为空条目\",\n\t\t\"ja\": \"VPC ネットワーク ACL が空でない\",\n\t\t\"de\": \"VPC-Netzwerk-ACL nicht leer\",\n\t\t\"es\": \"ACL de Red VPC No Vacío\",\n\t\t\"fr\": \"ACL de Réseau VPC Non Vide\",\n\t\t\"pt\": \"ACL de Rede VPC Não Vazio\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures VPC Network ACLs have at least one rule configured.\",\n\t\t\"zh\": \"确保 VPC 网络 ACL 至少配置了一条规则。\",\n\t\t\"ja\": \"VPC ネットワーク ACL に少なくとも 1 つのルールが設定されていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass VPC-Netzwerk-ACLs mindestens eine Regel konfiguriert haben.\",\n\t\t\"es\": \"Garantiza que las ACL de red VPC tengan al menos una regla configurada.\",\n\t\t\"fr\": \"Garantit que les ACL de réseau VPC ont au moins une règle configurée.\",\n\t\t\"pt\": \"Garante que as ACLs de rede VPC tenham pelo menos uma regra configurada.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"An empty ACL provides no security filtering, which might lead to unintended access.\",\n\t\t\"zh\": \"空的 ACL 不提供任何安全过滤，可能导致非预期的访问。\",\n\t\t\"ja\": \"空の ACL はセキュリティフィルタリングを提供しないため、意図しないアクセスにつながる可能性があります。\",\n\t\t\"de\": \"Eine leere ACL bietet keine Sicherheitsfilterung, was zu unbeabsichtigtem Zugriff führen kann.\",\n\t\t\"es\": \"Una ACL vacía no proporciona filtrado de seguridad, lo que podría provocar acceso no deseado.\",\n\t\t\"fr\": \"Une ACL vide ne fournit aucun filtrage de sécurité, ce qui peut entraîner un accès non intentionnel.\",\n\t\t\"pt\": \"Uma ACL vazia não fornece filtragem de segurança, o que pode levar a acesso não intencional.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Add ingress and egress rules to the VPC Network ACL.\",\n\t\t\"zh\": \"为 VPC 网络 ACL 添加进方向和出方向规则。\",\n\t\t\"ja\": \"VPC ネットワーク ACL にイングレスとエグレスルールを追加します。\",\n\t\t\"de\": \"Fügen Sie Ein- und Ausgangsregeln zur VPC-Netzwerk-ACL hinzu.\",\n\t\t\"es\": \"Agregue reglas de entrada y salida a la ACL de red VPC.\",\n\t\t\"fr\": \"Ajoutez des règles d'entrée et de sortie à l'ACL de réseau VPC.\",\n\t\t\"pt\": \"Adicione regras de entrada e saída à ACL de rede VPC.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::NetworkAcl\"]\n}\n\nis_compliant(resource) if {\n\tentries := helpers.get_property(resource, \"IngressAclEntries\", [])\n\tcount(entries) > 0\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::VPC::NetworkAcl\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"IngressAclEntries\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:vpc-network-acl-risky-ports-check", Name: models.I18nString{"de": "VPC-Netzwerk-ACL Risikoport-Prüfung", "en": "VPC Network ACL Risky Ports Check", "es": "Verificación de Puertos de Riesgo de ACL de Red VPC", "fr": "Vérification des Ports à Risque de l'ACL Réseau VPC", "ja": "VPC ネットワーク ACL リスクポートチェック", "pt": "Verificação de Portas de Risco da ACL de Rede VPC", "zh": "VPC 网络 ACL 禁用高风险端口"}, Severity: "high", Description: models.I18nString{"de": "Stellt sicher, dass VPC-Netzwerk-ACLs keinen uneingeschränkten Zugriff auf riskante Ports (22, 3389) erlauben.", "en": "Ensures VPC Network ACLs do not allow unrestricted access to risky ports (22, 3389).", "es": "Garantiza que las ACL de red VPC no permitan acceso sin restricciones a puertos de riesgo (22, 3389).", "fr": "Garantit que les ACL réseau VPC n'autorisent pas l'accès sans restriction aux ports à risque (22, 3389).", "ja": "VPC ネットワーク ACL がリスクポート（22、3389）への無制限アクセスを許可しないことを確認します。", "pt": "Garante que as ACLs de rede VPC não permitam acesso irrestrito a portas de risco (22, 3389).", "zh": "确保 VPC 网络 ACL 不允许对风险端口（22, 3389）的无限制访问。"}, Reason: models.I18nString{"de": "Das Öffnen von Verwaltungsports für alle IPs (0.0.0.0/0) schafft ein erhebliches Sicherheitsrisiko.", "en": "Opening management ports to all IPs (0.0.0.0/0) creates a significant security risk.", "es": "Abrir puertos de gestión a todas las IPs (0.0.0.0/0) crea un riesgo de seguridad significativo.", "fr": "L'ouverture des ports de gestion à toutes les IP (0.0.0.0/0) crée un risque de sécurité important.", "ja": "すべての IP（0.0.0.0/0）に管理ポートを開くことは、重大なセキュリティリスクを生み出します。", "pt": "Abrir portas de gerenciamento para todos os IPs (0.0.0.0/0) cria um risco de segurança significativo.", "zh": "向所有 IP（0.0.0.0/0）开放管理端口会造成重大的安全风险。"}, Recommendation: models.I18nString{"de": "Beschränken Sie den Zugriff auf die Ports 22 und 3389 auf spezifische vertrauenswürdige IP-Bereiche.", "en": "Restrict access to ports 22 and 3389 to specific trusted IP ranges.", "es": "Restrinja el acceso a los puertos 22 y 3389 a rangos de IP específicos de confianza.", "fr": "Restreignez l'accès aux ports 22 et 3389 à des plages d'IP spécifiques de confiance.", "ja": "ポート 22 と 3389 へのアクセスを特定の信頼できる IP 範囲に制限します。", "pt": "Restrinja o acesso às portas 22 e 3389 a intervalos de IP específicos confiáveis.", "zh": "将对 22 和 3389 端口的访问限制在特定的可信 IP 范围内。"}, ResourceTypes: []string{"ALIYUN::VPC::NetworkAcl"}, FilePath: "aliyun/rules/vpc-network-acl-risky-ports-check.rego", PackageName: "infraguard.rules.aliyun.vpc_network_acl_risky_ports_check", Content: "package infraguard.rules.aliyun.vpc_network_acl_risky_ports_check\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"vpc-network-acl-risky-ports-check\",\n\t\"severity\": \"high\",\n\t\"name\": {\n\t\t\"en\": \"VPC Network ACL Risky Ports Check\",\n\t\t\"zh\": \"VPC 网络 ACL 禁用高风险端口\",\n\t\t\"ja\": \"VPC ネットワーク ACL リスクポートチェック\",\n\t\t\"de\": \"VPC-Netzwerk-ACL Risikoport-Prüfung\",\n\t\t\"es\": \"Verificación de Puertos de Riesgo de ACL de Red VPC\",\n\t\t\"fr\": \"Vérification des Ports à Risque de l'ACL Réseau VPC\",\n\t\t\"pt\": \"Verificação de Portas de Risco da ACL de Rede VPC\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures VPC Network ACLs do not allow unrestricted access to risky ports (22, 3389).\",\n\t\t\"zh\": \"确保 VPC 网络 ACL 不允许对风险端口（22, 3389）的无限制访问。\",\n\t\t\"ja\": \"VPC ネットワーク ACL がリスクポート（22、3389）への無制限アクセスを許可しないことを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass VPC-Netzwerk-ACLs keinen uneingeschränkten Zugriff auf riskante Ports (22, 3389) erlauben.\",\n\t\t\"es\": \"Garantiza que las ACL de red VPC no permitan acceso sin restricciones a puertos de riesgo (22, 3389).\",\n\t\t\"fr\": \"Garantit que les ACL réseau VPC n'autorisent pas l'accès sans restriction aux ports à risque (22, 3389).\",\n\t\t\"pt\": \"Garante que as ACLs de rede VPC não permitam acesso irrestrito a portas de risco (22, 3389).\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Opening management ports to all IPs (0.0.0.0/0) creates a significant security risk.\",\n\t\t\"zh\": \"向所有 IP（0.0.0.0/0）开放管理端口会造成重大的安全风险。\",\n\t\t\"ja\": \"すべての IP（0.0.0.0/0）に管理ポートを開くことは、重大なセキュリティリスクを生み出します。\",\n\t\t\"de\": \"Das Öffnen von Verwaltungsports für alle IPs (0.0.0.0/0) schafft ein erhebliches Sicherheitsrisiko.\",\n\t\t\"es\": \"Abrir puertos de gestión a todas las IPs (0.0.0.0/0) crea un riesgo de seguridad significativo.\",\n\t\t\"fr\": \"L'ouverture des ports de gestion à toutes les IP (0.0.0.0/0) crée un risque de sécurité important.\",\n\t\t\"pt\": \"Abrir portas de gerenciamento para todos os IPs (0.0.0.0/0) cria um risco de segurança significativo.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Restrict access to ports 22 and 3389 to specific trusted IP ranges.\",\n\t\t\"zh\": \"将对 22 和 3389 端口的访问限制在特定的可信 IP 范围内。\",\n\t\t\"ja\": \"ポート 22 と 3389 へのアクセスを特定の信頼できる IP 範囲に制限します。\",\n\t\t\"de\": \"Beschränken Sie den Zugriff auf die Ports 22 und 3389 auf spezifische vertrauenswürdige IP-Bereiche.\",\n\t\t\"es\": \"Restrinja el acceso a los puertos 22 y 3389 a rangos de IP específicos de confianza.\",\n\t\t\"fr\": \"Restreignez l'accès aux ports 22 et 3389 à des plages d'IP spécifiques de confiance.\",\n\t\t\"pt\": \"Restrinja o acesso às portas 22 e 3389 a intervalos de IP específicos confiáveis.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::NetworkAcl\"]\n}\n\nrisky_ports := [22, 3389]\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::VPC::NetworkAcl\")\n\tentries := helpers.get_property(resource, \"IngressAclEntries\", [])\n\tsome entry in entries\n\tentry.Policy == \"accept\"\n\thelpers.is_public_cidr(entry.SourceCidrIp)\n\tport_is_risky(entry.Port, risky_ports)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"IngressAclEntries\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n\nport_is_risky(port, _) if {\n\tport == \"all\"\n}\n\nport_is_risky(port, target_ports) if {\n\tis_number(port)\n\tport in target_ports\n}\n\nport_is_risky(port, target_ports) if {\n\tis_string(port)\n\tparts := split(port, \"/\")\n\tcount(parts) == 2\n\tstart := to_number(parts[0])\n\tend := to_number(parts[1])\n\tsome p in target_ports\n\tp >= start\n\tp <= end\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:vpn-connection-master-slave-established", Name: models.I18nString{"de": "VPN-Verbindung Dual-Tunnel eingerichtet", "en": "VPN Connection Dual Tunnel Established", "es": "Conexión VPN Túnel Dual Establecido", "fr": "Connexion VPN Tunnel Double Établi", "ja": "VPN 接続デュアルトンネル確立", "pt": "Conexão VPN Túnel Duplo Estabelecido", "zh": "双隧道 VPN 网关主备隧道都已建立连接"}, Severity: "medium", Description: models.I18nString{"de": "Verwenden Sie ein Dual-Tunnel-VPN-Gateway und beide Master- und Slave-Tunnel sind mit dem Peer eingerichtet.", "en": "Use dual-tunnel VPN gateway and both master and slave tunnels are established with the peer.", "es": "Use una puerta de enlace VPN de túnel dual y ambos túneles maestro y esclavo están establecidos con el par.", "fr": "Utilisez une passerelle VPN à tunnel double et les tunnels maître et esclave sont établis avec le pair.", "ja": "デュアルトンネル VPN ゲートウェイを使用し、マスターとスレーブの両方のトンネルがピアと確立されています。", "pt": "Use um gateway VPN de túnel duplo e ambos os túneis mestre e escravo estão estabelecidos com o par.", "zh": "使用双隧道的 VPN 网关同时主备隧道都已和对端建立连接。"}, Reason: models.I18nString{"de": "Die VPN-Verbindung hat keine Dual-Tunnel-Konfiguration.", "en": "The VPN connection does not have dual tunnels configured.", "es": "La conexión VPN no tiene túneles duales configurados.", "fr": "La connexion VPN n'a pas de tunnels doubles configurés.", "ja": "VPN 接続にデュアルトンネルが設定されていません。", "pt": "A conexão VPN não tem túneis duplos configurados.", "zh": "VPN 连接未配置双隧道。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie die VPN-Verbindung mit Master- und Slave-Tunneln unter Verwendung von TunnelOptionsSpecification.", "en": "Configure the VPN connection with both master and slave tunnels using TunnelOptionsSpecification.", "es": "Configure la conexión VPN con túneles maestro y esclavo usando TunnelOptionsSpecification.", "fr": "Configurez la connexion VPN avec les tunnels maître et esclave en utilisant TunnelOptionsSpecification.", "ja": "TunnelOptionsSpecification を使用して、マスターとスレーブの両方のトンネルで VPN 接続を設定します。", "pt": "Configure a conexão VPN com túneis mestre e escravo usando TunnelOptionsSpecification.", "zh": "使用 TunnelOptionsSpecification 配置 VPN 连接的主备隧道。"}, ResourceTypes: []string{"ALIYUN::VPC::VpnConnection"}, FilePath: "aliyun/rules/vpn-connection-master-slave-established.rego", PackageName: "infraguard.rules.aliyun.vpn_connection_master_slave_established", Content: "package infraguard.rules.aliyun.vpn_connection_master_slave_established\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\nrule_meta := {\n\t\"id\": \"vpn-connection-master-slave-established\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"VPN Connection Dual Tunnel Established\",\n\t\t\"zh\": \"双隧道 VPN 网关主备隧道都已建立连接\",\n\t\t\"ja\": \"VPN 接続デュアルトンネル確立\",\n\t\t\"de\": \"VPN-Verbindung Dual-Tunnel eingerichtet\",\n\t\t\"es\": \"Conexión VPN Túnel Dual Establecido\",\n\t\t\"fr\": \"Connexion VPN Tunnel Double Établi\",\n\t\t\"pt\": \"Conexão VPN Túnel Duplo Estabelecido\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Use dual-tunnel VPN gateway and both master and slave tunnels are established with the peer.\",\n\t\t\"zh\": \"使用双隧道的 VPN 网关同时主备隧道都已和对端建立连接。\",\n\t\t\"ja\": \"デュアルトンネル VPN ゲートウェイを使用し、マスターとスレーブの両方のトンネルがピアと確立されています。\",\n\t\t\"de\": \"Verwenden Sie ein Dual-Tunnel-VPN-Gateway und beide Master- und Slave-Tunnel sind mit dem Peer eingerichtet.\",\n\t\t\"es\": \"Use una puerta de enlace VPN de túnel dual y ambos túneles maestro y esclavo están establecidos con el par.\",\n\t\t\"fr\": \"Utilisez une passerelle VPN à tunnel double et les tunnels maître et esclave sont établis avec le pair.\",\n\t\t\"pt\": \"Use um gateway VPN de túnel duplo e ambos os túneis mestre e escravo estão estabelecidos com o par.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The VPN connection does not have dual tunnels configured.\",\n\t\t\"zh\": \"VPN 连接未配置双隧道。\",\n\t\t\"ja\": \"VPN 接続にデュアルトンネルが設定されていません。\",\n\t\t\"de\": \"Die VPN-Verbindung hat keine Dual-Tunnel-Konfiguration.\",\n\t\t\"es\": \"La conexión VPN no tiene túneles duales configurados.\",\n\t\t\"fr\": \"La connexion VPN n'a pas de tunnels doubles configurés.\",\n\t\t\"pt\": \"A conexão VPN não tem túneis duplos configurados.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure the VPN connection with both master and slave tunnels using TunnelOptionsSpecification.\",\n\t\t\"zh\": \"使用 TunnelOptionsSpecification 配置 VPN 连接的主备隧道。\",\n\t\t\"ja\": \"TunnelOptionsSpecification を使用して、マスターとスレーブの両方のトンネルで VPN 接続を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie die VPN-Verbindung mit Master- und Slave-Tunneln unter Verwendung von TunnelOptionsSpecification.\",\n\t\t\"es\": \"Configure la conexión VPN con túneles maestro y esclavo usando TunnelOptionsSpecification.\",\n\t\t\"fr\": \"Configurez la connexion VPN avec les tunnels maître et esclave en utilisant TunnelOptionsSpecification.\",\n\t\t\"pt\": \"Configure a conexão VPN com túneis mestre e escravo usando TunnelOptionsSpecification.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::VpnConnection\"]\n}\n\n# Check if VPN connection has dual tunnels configured\nis_dual_tunnel(resource) if {\n\tcount(object.get(resource.Properties, \"TunnelOptionsSpecification\", [])) >= 2\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_dual_tunnel(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"TunnelOptionsSpecification\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:vpn-gateway-enabled-ssl-vpn", Name: models.I18nString{"de": "VPN-Gateway SSL-VPN aktiviert", "en": "VPN Gateway SSL-VPN Enabled", "es": "SSL-VPN de Puerta de Enlace VPN Habilitado", "fr": "SSL-VPN de Passerelle VPN Activé", "ja": "VPN ゲートウェイ SSL-VPN が有効", "pt": "SSL-VPN do Gateway VPN Habilitado", "zh": "VPN 网关开启 SSL-VPN"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass das VPN-Gateway SSL-VPN für sicheren Client-Zugriff aktiviert hat.", "en": "Ensures the VPN gateway has SSL-VPN enabled for secure client access.", "es": "Garantiza que la puerta de enlace VPN tenga SSL-VPN habilitado para acceso seguro del cliente.", "fr": "Garantit que la passerelle VPN a SSL-VPN activé pour un accès client sécurisé.", "ja": "VPN ゲートウェイでクライアントアクセスを安全にするために SSL-VPN が有効になっていることを確認します。", "pt": "Garante que o gateway VPN tenha SSL-VPN habilitado para acesso seguro do cliente.", "zh": "确保 VPN 网关开启了 SSL-VPN，以便客户端安全访问。"}, Reason: models.I18nString{"de": "SSL-VPN bietet eine sichere Möglichkeit für Remote-Benutzer, auf interne Netzwerkressourcen zuzugreifen.", "en": "SSL-VPN provides a secure way for remote users to access internal network resources.", "es": "SSL-VPN proporciona una forma segura para que los usuarios remotos accedan a los recursos de red internos.", "fr": "SSL-VPN fournit un moyen sécurisé pour les utilisateurs distants d'accéder aux ressources réseau internes.", "ja": "SSL-VPN は、リモートユーザーが内部ネットワークリソースにアクセスするための安全な方法を提供します。", "pt": "SSL-VPN fornece uma maneira segura para usuários remotos acessarem recursos de rede internos.", "zh": "SSL-VPN 为远程用户访问内部网络资源提供了一种安全的方式。"}, Recommendation: models.I18nString{"de": "Setzen Sie EnableSsl für das VPN-Gateway auf 'true'.", "en": "Set EnableSsl to 'true' for the VPN Gateway.", "es": "Establezca EnableSsl en 'true' para la puerta de enlace VPN.", "fr": "Définissez EnableSsl sur 'true' pour la passerelle VPN.", "ja": "VPN ゲートウェイの EnableSsl を 'true' に設定します。", "pt": "Defina EnableSsl como 'true' para o Gateway VPN.", "zh": "为 VPN 网关将 EnableSsl 设置为 'true'。"}, ResourceTypes: []string{"ALIYUN::VPC::VpnGateway"}, FilePath: "aliyun/rules/vpn-gateway-enabled-ssl-vpn.rego", PackageName: "infraguard.rules.aliyun.vpn_gateway_enabled_ssl_vpn", Content: "package infraguard.rules.aliyun.vpn_gateway_enabled_ssl_vpn\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"vpn-gateway-enabled-ssl-vpn\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"VPN Gateway SSL-VPN Enabled\",\n\t\t\"zh\": \"VPN 网关开启 SSL-VPN\",\n\t\t\"ja\": \"VPN ゲートウェイ SSL-VPN が有効\",\n\t\t\"de\": \"VPN-Gateway SSL-VPN aktiviert\",\n\t\t\"es\": \"SSL-VPN de Puerta de Enlace VPN Habilitado\",\n\t\t\"fr\": \"SSL-VPN de Passerelle VPN Activé\",\n\t\t\"pt\": \"SSL-VPN do Gateway VPN Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures the VPN gateway has SSL-VPN enabled for secure client access.\",\n\t\t\"zh\": \"确保 VPN 网关开启了 SSL-VPN，以便客户端安全访问。\",\n\t\t\"ja\": \"VPN ゲートウェイでクライアントアクセスを安全にするために SSL-VPN が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass das VPN-Gateway SSL-VPN für sicheren Client-Zugriff aktiviert hat.\",\n\t\t\"es\": \"Garantiza que la puerta de enlace VPN tenga SSL-VPN habilitado para acceso seguro del cliente.\",\n\t\t\"fr\": \"Garantit que la passerelle VPN a SSL-VPN activé pour un accès client sécurisé.\",\n\t\t\"pt\": \"Garante que o gateway VPN tenha SSL-VPN habilitado para acesso seguro do cliente.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"SSL-VPN provides a secure way for remote users to access internal network resources.\",\n\t\t\"zh\": \"SSL-VPN 为远程用户访问内部网络资源提供了一种安全的方式。\",\n\t\t\"ja\": \"SSL-VPN は、リモートユーザーが内部ネットワークリソースにアクセスするための安全な方法を提供します。\",\n\t\t\"de\": \"SSL-VPN bietet eine sichere Möglichkeit für Remote-Benutzer, auf interne Netzwerkressourcen zuzugreifen.\",\n\t\t\"es\": \"SSL-VPN proporciona una forma segura para que los usuarios remotos accedan a los recursos de red internos.\",\n\t\t\"fr\": \"SSL-VPN fournit un moyen sécurisé pour les utilisateurs distants d'accéder aux ressources réseau internes.\",\n\t\t\"pt\": \"SSL-VPN fornece uma maneira segura para usuários remotos acessarem recursos de rede internos.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Set EnableSsl to 'true' for the VPN Gateway.\",\n\t\t\"zh\": \"为 VPN 网关将 EnableSsl 设置为 'true'。\",\n\t\t\"ja\": \"VPN ゲートウェイの EnableSsl を 'true' に設定します。\",\n\t\t\"de\": \"Setzen Sie EnableSsl für das VPN-Gateway auf 'true'.\",\n\t\t\"es\": \"Establezca EnableSsl en 'true' para la puerta de enlace VPN.\",\n\t\t\"fr\": \"Définissez EnableSsl sur 'true' pour la passerelle VPN.\",\n\t\t\"pt\": \"Defina EnableSsl como 'true' para o Gateway VPN.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::VpnGateway\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"EnableSsl\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::VPC::VpnGateway\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"EnableSsl\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:vpn-gateway-multi-zone", Name: models.I18nString{"de": "VPN-Gateway Multi-Zonen-Bereitstellung", "en": "VPN Gateway Multi-Zone Deployment", "es": "Implementación Multi-Zona de Puerta de Enlace VPN", "fr": "Déploiement Multi-Zone de la Passerelle VPN", "ja": "VPN ゲートウェイマルチゾーン展開", "pt": "Implantação Multi-Zona do Gateway VPN", "zh": "使用多可用区的 VPN 网关"}, Severity: "medium", Description: models.I18nString{"de": "VPN-Gateways sollten mit einem Disaster-Recovery-VSwitch konfiguriert werden, um Multi-Zonen-Verfügbarkeit zu unterstützen.", "en": "VPN Gateways should be configured with a disaster recovery VSwitch to support multi-zone availability.", "es": "Las puertas de enlace VPN deben configurarse con un VSwitch de recuperación ante desastres para admitir disponibilidad multi-zona.", "fr": "Les passerelles VPN doivent être configurées avec un VSwitch de récupération d'urgence pour prendre en charge la disponibilité multi-zone.", "ja": "VPN ゲートウェイは、マルチゾーン可用性をサポートするために災害復旧 VSwitch で構成する必要があります。", "pt": "Os gateways VPN devem ser configurados com um VSwitch de recuperação de desastres para suportar disponibilidade multi-zona.", "zh": "为 VPN 网关设置两个交换机，保障产品跨可用区的高可用性，视为合规。"}, Reason: models.I18nString{"de": "Das VPN-Gateway ist nicht mit einem Disaster-Recovery-VSwitch konfiguriert.", "en": "The VPN Gateway is not configured with a disaster recovery VSwitch.", "es": "La puerta de enlace VPN no está configurada con un VSwitch de recuperación ante desastres.", "fr": "La passerelle VPN n'est pas configurée avec un VSwitch de récupération d'urgence.", "ja": "VPN ゲートウェイが災害復旧 VSwitch で構成されていません。", "pt": "O gateway VPN não está configurado com um VSwitch de recuperação de desastres.", "zh": "VPN 网关未配置容灾交换机。"}, Recommendation: models.I18nString{"de": "Konfigurieren Sie DisasterRecoveryVSwitchId, um den Dual-Tunnel/Multi-Zonen-Modus zu aktivieren.", "en": "Configure DisasterRecoveryVSwitchId to enable dual-tunnel/multi-zone mode.", "es": "Configure DisasterRecoveryVSwitchId para habilitar el modo de túnel dual/multi-zona.", "fr": "Configurez DisasterRecoveryVSwitchId pour activer le mode tunnel double/multi-zone.", "ja": "デュアルトンネル/マルチゾーンモードを有効にするために DisasterRecoveryVSwitchId を設定します。", "pt": "Configure DisasterRecoveryVSwitchId para habilitar o modo de túnel duplo/multi-zona.", "zh": "配置 DisasterRecoveryVSwitchId 以启用双隧道/多可用区模式。"}, ResourceTypes: []string{"ALIYUN::VPC::VpnGateway"}, FilePath: "aliyun/rules/vpn-gateway-multi-zone.rego", PackageName: "infraguard.rules.aliyun.vpn_gateway_multi_zone", Content: "package infraguard.rules.aliyun.vpn_gateway_multi_zone\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"vpn-gateway-multi-zone\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"VPN Gateway Multi-Zone Deployment\",\n\t\t\"zh\": \"使用多可用区的 VPN 网关\",\n\t\t\"ja\": \"VPN ゲートウェイマルチゾーン展開\",\n\t\t\"de\": \"VPN-Gateway Multi-Zonen-Bereitstellung\",\n\t\t\"es\": \"Implementación Multi-Zona de Puerta de Enlace VPN\",\n\t\t\"fr\": \"Déploiement Multi-Zone de la Passerelle VPN\",\n\t\t\"pt\": \"Implantação Multi-Zona do Gateway VPN\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"VPN Gateways should be configured with a disaster recovery VSwitch to support multi-zone availability.\",\n\t\t\"zh\": \"为 VPN 网关设置两个交换机，保障产品跨可用区的高可用性，视为合规。\",\n\t\t\"ja\": \"VPN ゲートウェイは、マルチゾーン可用性をサポートするために災害復旧 VSwitch で構成する必要があります。\",\n\t\t\"de\": \"VPN-Gateways sollten mit einem Disaster-Recovery-VSwitch konfiguriert werden, um Multi-Zonen-Verfügbarkeit zu unterstützen.\",\n\t\t\"es\": \"Las puertas de enlace VPN deben configurarse con un VSwitch de recuperación ante desastres para admitir disponibilidad multi-zona.\",\n\t\t\"fr\": \"Les passerelles VPN doivent être configurées avec un VSwitch de récupération d'urgence pour prendre en charge la disponibilité multi-zone.\",\n\t\t\"pt\": \"Os gateways VPN devem ser configurados com um VSwitch de recuperação de desastres para suportar disponibilidade multi-zona.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"The VPN Gateway is not configured with a disaster recovery VSwitch.\",\n\t\t\"zh\": \"VPN 网关未配置容灾交换机。\",\n\t\t\"ja\": \"VPN ゲートウェイが災害復旧 VSwitch で構成されていません。\",\n\t\t\"de\": \"Das VPN-Gateway ist nicht mit einem Disaster-Recovery-VSwitch konfiguriert.\",\n\t\t\"es\": \"La puerta de enlace VPN no está configurada con un VSwitch de recuperación ante desastres.\",\n\t\t\"fr\": \"La passerelle VPN n'est pas configurée avec un VSwitch de récupération d'urgence.\",\n\t\t\"pt\": \"O gateway VPN não está configurado com um VSwitch de recuperação de desastres.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Configure DisasterRecoveryVSwitchId to enable dual-tunnel/multi-zone mode.\",\n\t\t\"zh\": \"配置 DisasterRecoveryVSwitchId 以启用双隧道/多可用区模式。\",\n\t\t\"ja\": \"デュアルトンネル/マルチゾーンモードを有効にするために DisasterRecoveryVSwitchId を設定します。\",\n\t\t\"de\": \"Konfigurieren Sie DisasterRecoveryVSwitchId, um den Dual-Tunnel/Multi-Zonen-Modus zu aktivieren.\",\n\t\t\"es\": \"Configure DisasterRecoveryVSwitchId para habilitar el modo de túnel dual/multi-zona.\",\n\t\t\"fr\": \"Configurez DisasterRecoveryVSwitchId pour activer le mode tunnel double/multi-zone.\",\n\t\t\"pt\": \"Configure DisasterRecoveryVSwitchId para habilitar o modo de túnel duplo/multi-zona.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::VpnGateway\"]\n}\n\n# Check if instance is multi-zone\nis_multi_zone(resource) if {\n\t# Check if DisasterRecoveryVSwitchId is present and not empty\n\tobject.get(resource.Properties, \"DisasterRecoveryVSwitchId\", \"\") != \"\"\n}\n\n# Deny rule\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types(rule_meta.resource_types)\n\tnot is_multi_zone(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"DisasterRecoveryVSwitchId\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:vpn-ipsec-connection-health-check-open", Name: models.I18nString{"de": "VPN IPsec Health Check aktiviert", "en": "VPN IPsec Health Check Enabled", "es": "Verificación de Salud IPsec VPN Habilitada", "fr": "Vérification de Santé IPsec VPN Activée", "ja": "VPN IPsec ヘルスチェックが有効", "pt": "Verificação de Integridade IPsec VPN Habilitada", "zh": "VPN IPsec 连接开启健康检查"}, Severity: "low", Description: models.I18nString{"de": "Stellt sicher, dass VPN-IPsec-Verbindungen Health Checks aktiviert haben, um Tunnelausfälle zu erkennen.", "en": "Ensures VPN IPsec connections have health checks enabled to detect tunnel failures.", "es": "Garantiza que las conexiones VPN IPsec tengan verificaciones de salud habilitadas para detectar fallas del túnel.", "fr": "Garantit que les connexions VPN IPsec ont des vérifications de santé activées pour détecter les défaillances du tunnel.", "ja": "VPN IPsec 接続でトンネル障害を検出するためにヘルスチェックが有効になっていることを確認します。", "pt": "Garante que as conexões VPN IPsec tenham verificações de integridade habilitadas para detectar falhas do túnel.", "zh": "确保 VPN IPsec 连接开启了健康检查，以便及时发现隧道故障。"}, Reason: models.I18nString{"de": "Health Checks ermöglichen automatisches Failover und proaktive Überwachung der VPN-Stabilität.", "en": "Health checks enable automatic failover and proactive monitoring of VPN stability.", "es": "Las verificaciones de salud permiten la conmutación por error automática y el monitoreo proactivo de la estabilidad VPN.", "fr": "Les vérifications de santé permettent le basculement automatique et la surveillance proactive de la stabilité VPN.", "ja": "ヘルスチェックにより、VPN の安定性の自動フェイルオーバーとプロアクティブな監視が可能になります。", "pt": "As verificações de integridade permitem failover automático e monitoramento proativo da estabilidade VPN.", "zh": "健康检查支持 VPN 稳定性的自动故障转移和主动监控。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie Health Checks für die IPsec-Verbindung.", "en": "Enable health checks for the IPsec connection.", "es": "Habilite las verificaciones de salud para la conexión IPsec.", "fr": "Activez les vérifications de santé pour la connexion IPsec.", "ja": "IPsec 接続のヘルスチェックを有効にします。", "pt": "Habilite verificações de integridade para a conexão IPsec.", "zh": "为 IPsec 连接开启健康检查。"}, ResourceTypes: []string{"ALIYUN::VPC::VpnConnection"}, FilePath: "aliyun/rules/vpn-ipsec-connection-health-check-open.rego", PackageName: "infraguard.rules.aliyun.vpn_ipsec_connection_health_check_open", Content: "package infraguard.rules.aliyun.vpn_ipsec_connection_health_check_open\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"vpn-ipsec-connection-health-check-open\",\n\t\"severity\": \"low\",\n\t\"name\": {\n\t\t\"en\": \"VPN IPsec Health Check Enabled\",\n\t\t\"zh\": \"VPN IPsec 连接开启健康检查\",\n\t\t\"ja\": \"VPN IPsec ヘルスチェックが有効\",\n\t\t\"de\": \"VPN IPsec Health Check aktiviert\",\n\t\t\"es\": \"Verificación de Salud IPsec VPN Habilitada\",\n\t\t\"fr\": \"Vérification de Santé IPsec VPN Activée\",\n\t\t\"pt\": \"Verificação de Integridade IPsec VPN Habilitada\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures VPN IPsec connections have health checks enabled to detect tunnel failures.\",\n\t\t\"zh\": \"确保 VPN IPsec 连接开启了健康检查，以便及时发现隧道故障。\",\n\t\t\"ja\": \"VPN IPsec 接続でトンネル障害を検出するためにヘルスチェックが有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass VPN-IPsec-Verbindungen Health Checks aktiviert haben, um Tunnelausfälle zu erkennen.\",\n\t\t\"es\": \"Garantiza que las conexiones VPN IPsec tengan verificaciones de salud habilitadas para detectar fallas del túnel.\",\n\t\t\"fr\": \"Garantit que les connexions VPN IPsec ont des vérifications de santé activées pour détecter les défaillances du tunnel.\",\n\t\t\"pt\": \"Garante que as conexões VPN IPsec tenham verificações de integridade habilitadas para detectar falhas do túnel.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Health checks enable automatic failover and proactive monitoring of VPN stability.\",\n\t\t\"zh\": \"健康检查支持 VPN 稳定性的自动故障转移和主动监控。\",\n\t\t\"ja\": \"ヘルスチェックにより、VPN の安定性の自動フェイルオーバーとプロアクティブな監視が可能になります。\",\n\t\t\"de\": \"Health Checks ermöglichen automatisches Failover und proaktive Überwachung der VPN-Stabilität.\",\n\t\t\"es\": \"Las verificaciones de salud permiten la conmutación por error automática y el monitoreo proactivo de la estabilidad VPN.\",\n\t\t\"fr\": \"Les vérifications de santé permettent le basculement automatique et la surveillance proactive de la stabilité VPN.\",\n\t\t\"pt\": \"As verificações de integridade permitem failover automático e monitoramento proativo da estabilidade VPN.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable health checks for the IPsec connection.\",\n\t\t\"zh\": \"为 IPsec 连接开启健康检查。\",\n\t\t\"ja\": \"IPsec 接続のヘルスチェックを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie Health Checks für die IPsec-Verbindung.\",\n\t\t\"es\": \"Habilite las verificaciones de salud para la conexión IPsec.\",\n\t\t\"fr\": \"Activez les vérifications de santé pour la connexion IPsec.\",\n\t\t\"pt\": \"Habilite verificações de integridade para a conexão IPsec.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::VPC::VpnConnection\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"HealthCheckConfig\", {}).Enable)\n}\n\n# Note: Properties might vary between IpsecConnection and IpsecServer in ROS.\n# Assuming ALIYUN::VPC::IpsecConnection for most tunnel checks.\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::VPC::VpnConnection\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"HealthCheckConfig\", \"Enable\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:vswitch-available-ip-count", Name: models.I18nString{"de": "VSwitch Verfügbare IP-Anzahlprüfung", "en": "VSwitch Available IP Count Check", "es": "Verificación de Conteo de IP Disponibles de VSwitch", "fr": "Vérification du Nombre d'IP Disponibles VSwitch", "ja": "VSwitch 利用可能 IP 数チェック", "pt": "Verificação de Contagem de IP Disponível do VSwitch", "zh": "VSwitch 可用 IP 数量检测"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass der VSwitch eine ausreichende Anzahl verfügbarer IP-Adressen hat.", "en": "Ensures that the VSwitch has a sufficient number of available IP addresses.", "es": "Garantiza que el VSwitch tenga un número suficiente de direcciones IP disponibles.", "fr": "Garantit que le VSwitch a un nombre suffisant d'adresses IP disponibles.", "ja": "VSwitch に十分な数の利用可能な IP アドレスがあることを確認します。", "pt": "Garante que o VSwitch tenha um número suficiente de endereços IP disponíveis.", "zh": "确保 VSwitch 具有足够数量的可用 IP 地址。"}, Reason: models.I18nString{"de": "Das Ausgehen verfügbarer IP-Adressen verhindert die Erstellung neuer Ressourcen im VSwitch.", "en": "Running out of available IP addresses prevents new resources from being created in the VSwitch.", "es": "Agotar las direcciones IP disponibles impide crear nuevos recursos en el VSwitch.", "fr": "L'épuisement des adresses IP disponibles empêche la création de nouvelles ressources dans le VSwitch.", "ja": "利用可能な IP アドレスが不足すると、VSwitch で新しいリソースを作成できなくなります。", "pt": "Esgotar os endereços IP disponíveis impede a criação de novos recursos no VSwitch.", "zh": "可用 IP 地址耗尽将阻止在 VSwitch 中创建新资源。"}, Recommendation: models.I18nString{"de": "Stellen Sie sicher, dass der VSwitch genügend verfügbare IP-Adressen hat oder erstellen Sie einen größeren VSwitch.", "en": "Ensure that the VSwitch has enough available IP addresses or create a larger VSwitch.", "es": "Asegúrese de que el VSwitch tenga suficientes direcciones IP disponibles o cree un VSwitch más grande.", "fr": "Assurez-vous que le VSwitch a suffisamment d'adresses IP disponibles ou créez un VSwitch plus grand.", "ja": "VSwitch に十分な利用可能な IP アドレスがあることを確認するか、より大きな VSwitch を作成します。", "pt": "Garanta que o VSwitch tenha endereços IP disponíveis suficientes ou crie um VSwitch maior.", "zh": "确保 VSwitch 具有足够的可用 IP 地址，或创建一个更大的 VSwitch。"}, ResourceTypes: []string{"ALIYUN::ECS::VSwitch"}, FilePath: "aliyun/rules/vswitch-available-ip-count.rego", PackageName: "infraguard.rules.aliyun.vswitch_available_ip_count", Content: "package infraguard.rules.aliyun.vswitch_available_ip_count\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"vswitch-available-ip-count\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"VSwitch Available IP Count Check\",\n\t\t\"zh\": \"VSwitch 可用 IP 数量检测\",\n\t\t\"ja\": \"VSwitch 利用可能 IP 数チェック\",\n\t\t\"de\": \"VSwitch Verfügbare IP-Anzahlprüfung\",\n\t\t\"es\": \"Verificación de Conteo de IP Disponibles de VSwitch\",\n\t\t\"fr\": \"Vérification du Nombre d'IP Disponibles VSwitch\",\n\t\t\"pt\": \"Verificação de Contagem de IP Disponível do VSwitch\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that the VSwitch has a sufficient number of available IP addresses.\",\n\t\t\"zh\": \"确保 VSwitch 具有足够数量的可用 IP 地址。\",\n\t\t\"ja\": \"VSwitch に十分な数の利用可能な IP アドレスがあることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass der VSwitch eine ausreichende Anzahl verfügbarer IP-Adressen hat.\",\n\t\t\"es\": \"Garantiza que el VSwitch tenga un número suficiente de direcciones IP disponibles.\",\n\t\t\"fr\": \"Garantit que le VSwitch a un nombre suffisant d'adresses IP disponibles.\",\n\t\t\"pt\": \"Garante que o VSwitch tenha um número suficiente de endereços IP disponíveis.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Running out of available IP addresses prevents new resources from being created in the VSwitch.\",\n\t\t\"zh\": \"可用 IP 地址耗尽将阻止在 VSwitch 中创建新资源。\",\n\t\t\"ja\": \"利用可能な IP アドレスが不足すると、VSwitch で新しいリソースを作成できなくなります。\",\n\t\t\"de\": \"Das Ausgehen verfügbarer IP-Adressen verhindert die Erstellung neuer Ressourcen im VSwitch.\",\n\t\t\"es\": \"Agotar las direcciones IP disponibles impide crear nuevos recursos en el VSwitch.\",\n\t\t\"fr\": \"L'épuisement des adresses IP disponibles empêche la création de nouvelles ressources dans le VSwitch.\",\n\t\t\"pt\": \"Esgotar os endereços IP disponíveis impede a criação de novos recursos no VSwitch.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Ensure that the VSwitch has enough available IP addresses or create a larger VSwitch.\",\n\t\t\"zh\": \"确保 VSwitch 具有足够的可用 IP 地址，或创建一个更大的 VSwitch。\",\n\t\t\"ja\": \"VSwitch に十分な利用可能な IP アドレスがあることを確認するか、より大きな VSwitch を作成します。\",\n\t\t\"de\": \"Stellen Sie sicher, dass der VSwitch genügend verfügbare IP-Adressen hat oder erstellen Sie einen größeren VSwitch.\",\n\t\t\"es\": \"Asegúrese de que el VSwitch tenga suficientes direcciones IP disponibles o cree un VSwitch más grande.\",\n\t\t\"fr\": \"Assurez-vous que le VSwitch a suffisamment d'adresses IP disponibles ou créez un VSwitch plus grand.\",\n\t\t\"pt\": \"Garanta que o VSwitch tenha endereços IP disponíveis suficientes ou crie um VSwitch maior.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::ECS::VSwitch\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::ECS::VSwitch\")\n\n\t# Conceptual check for available IPs\n\t# Since it's runtime info, in template we might check CIDR size\n\tcidr := helpers.get_property(resource, \"CidrBlock\", \"\")\n\n\t# This is a bit complex to calculate accurately in Rego without helpers,\n\t# but we can detect very small subnets.\n\tendswith(cidr, \"/29\") # Example: Too small\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"CidrBlock\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:waf-instance-logging-enabled", Name: models.I18nString{"de": "WAF-Instanz Protokollierung aktiviert", "en": "WAF Instance Logging Enabled", "es": "Registro de Instancia WAF Habilitado", "fr": "Journalisation d'Instance WAF Activée", "ja": "WAF インスタンスログが有効", "pt": "Registro de Instância WAF Habilitado", "zh": "WAF 实例开启日志"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die Protokollierung für die WAF-Instanz für die Überwachung und Sicherheitsanalyse aktiviert ist.", "en": "Ensures that logging is enabled for the WAF instance for auditing and security analysis.", "es": "Garantiza que el registro esté habilitado para la instancia WAF para auditoría y análisis de seguridad.", "fr": "Garantit que la journalisation est activée pour l'instance WAF pour l'audit et l'analyse de sécurité.", "ja": "監査とセキュリティ分析のために WAF インスタンスでログ記録が有効になっていることを確認します。", "pt": "Garante que o registro esteja habilitado para a instância WAF para auditoria e análise de segurança.", "zh": "确保 WAF 实例开启了日志，以便进行审计和安全分析。"}, Reason: models.I18nString{"de": "WAF-Protokolle liefern wichtige Informationen über Web-Angriffe und Verkehrsmuster.", "en": "WAF logs provide critical information about web attacks and traffic patterns.", "es": "Los registros WAF proporcionan información crítica sobre ataques web y patrones de tráfico.", "fr": "Les journaux WAF fournissent des informations critiques sur les attaques Web et les modèles de trafic.", "ja": "WAF ログは、Web 攻撃とトラフィックパターンに関する重要な情報を提供します。", "pt": "Os registros WAF fornecem informações críticas sobre ataques web e padrões de tráfego.", "zh": "WAF 日志提供了关于 Web 攻击和流量模式的关键信息。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie die Protokollierung für die WAF-Instanz.", "en": "Enable logging for the WAF instance.", "es": "Habilite el registro para la instancia WAF.", "fr": "Activez la journalisation pour l'instance WAF.", "ja": "WAF インスタンスのログ記録を有効にします。", "pt": "Habilite o registro para a instância WAF.", "zh": "为 WAF 实例开启日志。"}, ResourceTypes: []string{"ALIYUN::WAF3::Instance", "ALIYUN::WAF::Instance"}, FilePath: "aliyun/rules/waf-instance-logging-enabled.rego", PackageName: "infraguard.rules.aliyun.waf_instance_logging_enabled", Content: "package infraguard.rules.aliyun.waf_instance_logging_enabled\n\nimport rego.v1\n\nimport data.infraguard.helpers\n\n# Rule metadata\nrule_meta := {\n\t\"id\": \"waf-instance-logging-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"WAF Instance Logging Enabled\",\n\t\t\"zh\": \"WAF 实例开启日志\",\n\t\t\"ja\": \"WAF インスタンスログが有効\",\n\t\t\"de\": \"WAF-Instanz Protokollierung aktiviert\",\n\t\t\"es\": \"Registro de Instancia WAF Habilitado\",\n\t\t\"fr\": \"Journalisation d'Instance WAF Activée\",\n\t\t\"pt\": \"Registro de Instância WAF Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that logging is enabled for the WAF instance for auditing and security analysis.\",\n\t\t\"zh\": \"确保 WAF 实例开启了日志，以便进行审计和安全分析。\",\n\t\t\"ja\": \"監査とセキュリティ分析のために WAF インスタンスでログ記録が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Protokollierung für die WAF-Instanz für die Überwachung und Sicherheitsanalyse aktiviert ist.\",\n\t\t\"es\": \"Garantiza que el registro esté habilitado para la instancia WAF para auditoría y análisis de seguridad.\",\n\t\t\"fr\": \"Garantit que la journalisation est activée pour l'instance WAF pour l'audit et l'analyse de sécurité.\",\n\t\t\"pt\": \"Garante que o registro esteja habilitado para a instância WAF para auditoria e análise de segurança.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"WAF logs provide critical information about web attacks and traffic patterns.\",\n\t\t\"zh\": \"WAF 日志提供了关于 Web 攻击和流量模式的关键信息。\",\n\t\t\"ja\": \"WAF ログは、Web 攻撃とトラフィックパターンに関する重要な情報を提供します。\",\n\t\t\"de\": \"WAF-Protokolle liefern wichtige Informationen über Web-Angriffe und Verkehrsmuster.\",\n\t\t\"es\": \"Los registros WAF proporcionan información crítica sobre ataques web y patrones de tráfico.\",\n\t\t\"fr\": \"Les journaux WAF fournissent des informations critiques sur les attaques Web et les modèles de trafic.\",\n\t\t\"pt\": \"Os registros WAF fornecem informações críticas sobre ataques web e padrões de tráfego.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable logging for the WAF instance.\",\n\t\t\"zh\": \"为 WAF 实例开启日志。\",\n\t\t\"ja\": \"WAF インスタンスのログ記録を有効にします。\",\n\t\t\"de\": \"Aktivieren Sie die Protokollierung für die WAF-Instanz.\",\n\t\t\"es\": \"Habilite el registro para la instancia WAF.\",\n\t\t\"fr\": \"Activez la journalisation pour l'instance WAF.\",\n\t\t\"pt\": \"Habilite o registro para a instância WAF.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::WAF3::Instance\", \"ALIYUN::WAF::Instance\"]\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_types([\"ALIYUN::WAF::Instance\", \"ALIYUN::WAF3::Instance\"])\n\n\t# Conceptual check for logging\n\tnot helpers.has_property(resource, \"LogConfig\")\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\"],\n\t\t\"meta\": {\n\t\t\t\"severity\": rule_meta.severity,\n\t\t\t\"reason\": rule_meta.reason,\n\t\t\t\"recommendation\": rule_meta.recommendation,\n\t\t},\n\t}\n}\n"})
	addRule(&models.Rule{ID: "rule:aliyun:waf3-defense-resource-logging-enabled", Name: models.I18nString{"de": "WAF 3.0 Protokollierung aktiviert", "en": "WAF 3.0 Logging Enabled", "es": "Registro de WAF 3.0 Habilitado", "fr": "Journalisation WAF 3.0 Activée", "ja": "WAF 3.0 ログ記録が有効", "pt": "Registro do WAF 3.0 Habilitado", "zh": "WAF 3.0 防护资源开启日志审计"}, Severity: "medium", Description: models.I18nString{"de": "Stellt sicher, dass die Protokollierung für von WAF 3.0 geschützte Ressourcen aktiviert ist.", "en": "Ensures that logging is enabled for resources protected by WAF 3.0.", "es": "Garantiza que el registro esté habilitado para los recursos protegidos por WAF 3.0.", "fr": "Garantit que la journalisation est activée pour les ressources protégées par WAF 3.0.", "ja": "WAF 3.0 で保護されているリソースでログ記録が有効になっていることを確認します。", "pt": "Garante que o registro esteja habilitado para recursos protegidos pelo WAF 3.0.", "zh": "确保 WAF 3.0 防护的资源已开启日志审计。"}, Reason: models.I18nString{"de": "Die Protokollierung ist entscheidend für die Verfolgung von Web-Angriffen und Sicherheitsvorfällen.", "en": "Logging is critical for tracking web attacks and security incidents.", "es": "El registro es crítico para rastrear ataques web e incidentes de seguridad.", "fr": "La journalisation est essentielle pour suivre les attaques Web et les incidents de sécurité.", "ja": "ログ記録は、Web 攻撃とセキュリティインシデントを追跡するために重要です。", "pt": "O registro é crítico para rastrear ataques web e incidentes de segurança.", "zh": "日志记录对于追踪网络攻击和安全事件至关重要。"}, Recommendation: models.I18nString{"de": "Aktivieren Sie den Log-Service für die WAF 3.0-Instanz.", "en": "Enable log service for the WAF 3.0 instance.", "es": "Habilite el servicio de registro para la instancia WAF 3.0.", "fr": "Activez le service de journalisation pour l'instance WAF 3.0.", "ja": "WAF 3.0 インスタンスのログサービスを有効にします。", "pt": "Habilite o serviço de registro para a instância WAF 3.0.", "zh": "为 WAF 3.0 实例开启日志服务。"}, ResourceTypes: []string{"ALIYUN::WAF3::Instance"}, FilePath: "aliyun/rules/waf3-defense-resource-logging-enabled.rego", PackageName: "infraguard.rules.aliyun.waf3_defense_resource_logging_enabled", Content: "package infraguard.rules.aliyun.waf3_defense_resource_logging_enabled\n\nimport data.infraguard.helpers\nimport rego.v1\n\nrule_meta := {\n\t\"id\": \"waf3-defense-resource-logging-enabled\",\n\t\"severity\": \"medium\",\n\t\"name\": {\n\t\t\"en\": \"WAF 3.0 Logging Enabled\",\n\t\t\"zh\": \"WAF 3.0 防护资源开启日志审计\",\n\t\t\"ja\": \"WAF 3.0 ログ記録が有効\",\n\t\t\"de\": \"WAF 3.0 Protokollierung aktiviert\",\n\t\t\"es\": \"Registro de WAF 3.0 Habilitado\",\n\t\t\"fr\": \"Journalisation WAF 3.0 Activée\",\n\t\t\"pt\": \"Registro do WAF 3.0 Habilitado\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Ensures that logging is enabled for resources protected by WAF 3.0.\",\n\t\t\"zh\": \"确保 WAF 3.0 防护的资源已开启日志审计。\",\n\t\t\"ja\": \"WAF 3.0 で保護されているリソースでログ記録が有効になっていることを確認します。\",\n\t\t\"de\": \"Stellt sicher, dass die Protokollierung für von WAF 3.0 geschützte Ressourcen aktiviert ist.\",\n\t\t\"es\": \"Garantiza que el registro esté habilitado para los recursos protegidos por WAF 3.0.\",\n\t\t\"fr\": \"Garantit que la journalisation est activée pour les ressources protégées par WAF 3.0.\",\n\t\t\"pt\": \"Garante que o registro esteja habilitado para recursos protegidos pelo WAF 3.0.\"\n\t},\n\t\"reason\": {\n\t\t\"en\": \"Logging is critical for tracking web attacks and security incidents.\",\n\t\t\"zh\": \"日志记录对于追踪网络攻击和安全事件至关重要。\",\n\t\t\"ja\": \"ログ記録は、Web 攻撃とセキュリティインシデントを追跡するために重要です。\",\n\t\t\"de\": \"Die Protokollierung ist entscheidend für die Verfolgung von Web-Angriffen und Sicherheitsvorfällen.\",\n\t\t\"es\": \"El registro es crítico para rastrear ataques web e incidentes de seguridad.\",\n\t\t\"fr\": \"La journalisation est essentielle pour suivre les attaques Web et les incidents de sécurité.\",\n\t\t\"pt\": \"O registro é crítico para rastrear ataques web e incidentes de segurança.\"\n\t},\n\t\"recommendation\": {\n\t\t\"en\": \"Enable log service for the WAF 3.0 instance.\",\n\t\t\"zh\": \"为 WAF 3.0 实例开启日志服务。\",\n\t\t\"ja\": \"WAF 3.0 インスタンスのログサービスを有効にします。\",\n\t\t\"de\": \"Aktivieren Sie den Log-Service für die WAF 3.0-Instanz.\",\n\t\t\"es\": \"Habilite el servicio de registro para la instancia WAF 3.0.\",\n\t\t\"fr\": \"Activez le service de journalisation pour l'instance WAF 3.0.\",\n\t\t\"pt\": \"Habilite o serviço de registro para a instância WAF 3.0.\"\n\t},\n\t\"resource_types\": [\"ALIYUN::WAF3::Instance\"]\n}\n\nis_compliant(resource) if {\n\thelpers.is_true(helpers.get_property(resource, \"LogService\", false))\n}\n\ndeny contains result if {\n\tsome name, resource in helpers.resources_by_type(\"ALIYUN::WAF3::Instance\")\n\tnot is_compliant(resource)\n\tresult := {\n\t\t\"id\": rule_meta.id,\n\t\t\"resource_id\": name,\n\t\t\"violation_path\": [\"Properties\", \"LogService\"],\n\t\t\"meta\": {\"severity\": rule_meta.severity, \"reason\": rule_meta.reason, \"recommendation\": rule_meta.recommendation},\n\t}\n}\n"})

	addPack(&models.Pack{ID: "pack:aliyun:accesskey-permission-governance-best-practice", Name: models.I18nString{"de": "AccessKey- und Berechtigungs-Governance Best Practices", "en": "AccessKey and Permission Governance Best Practice", "es": "Mejores Prácticas de Gobernanza de AccessKey y Permisos", "fr": "Meilleures Pratiques de Gouvernance des AccessKey et des Permissions", "ja": "AccessKey および権限ガバナンスのベストプラクティス", "pt": "Melhores Práticas de Governança de AccessKey e Permissões", "zh": "AccessKey 及权限治理最佳实践"}, Description: models.I18nString{"de": "Best Practices für AccessKey- und Berechtigungs-Governance", "en": "Best practices for AccessKey and permission governance", "es": "Mejores prácticas para la gobernanza de AccessKey y permisos", "fr": "Meilleures pratiques pour la gouvernance des AccessKey et des permissions", "ja": "AccessKey および権限ガバナンスのベストプラクティス", "pt": "Melhores práticas para governança de AccessKey e permissões", "zh": "AccessKey 及权限治理最佳实践"}, RuleIDs: []string{"rule:aliyun:ack-cluster-rrsa-enabled", "rule:aliyun:actiontrail-trail-intact-enabled", "rule:aliyun:ecs-instance-ram-role-attached", "rule:aliyun:fc-service-bind-role", "rule:aliyun:ram-password-policy-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-activated-ak-quantity-check", "rule:aliyun:ram-user-ak-create-date-expired-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-last-login-expired-check", "rule:aliyun:ram-user-login-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:root-ak-check", "rule:aliyun:root-mfa-check"}, FilePath: "aliyun/packs/accesskey-permission-governance-best-practice.rego", PackageName: "infraguard.packs.aliyun.accesskey_permission_governance_best_practice", Content: "package infraguard.packs.aliyun.accesskey_permission_governance_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"accesskey-permission-governance-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"AccessKey and Permission Governance Best Practice\",\n\t\t\"zh\": \"AccessKey 及权限治理最佳实践\",\n\t\t\"ja\": \"AccessKey および権限ガバナンスのベストプラクティス\",\n\t\t\"de\": \"AccessKey- und Berechtigungs-Governance Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Gobernanza de AccessKey y Permisos\",\n\t\t\"fr\": \"Meilleures Pratiques de Gouvernance des AccessKey et des Permissions\",\n\t\t\"pt\": \"Melhores Práticas de Governança de AccessKey e Permissões\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for AccessKey and permission governance\",\n\t\t\"zh\": \"AccessKey 及权限治理最佳实践\",\n\t\t\"ja\": \"AccessKey および権限ガバナンスのベストプラクティス\",\n\t\t\"de\": \"Best Practices für AccessKey- und Berechtigungs-Governance\",\n\t\t\"es\": \"Mejores prácticas para la gobernanza de AccessKey y permisos\",\n\t\t\"fr\": \"Meilleures pratiques pour la gouvernance des AccessKey et des permissions\",\n\t\t\"pt\": \"Melhores práticas para governança de AccessKey e permissões\"\n\t},\n\t\"rules\": [\n\t\t\"ack-cluster-rrsa-enabled\",\n\t\t\"actiontrail-trail-intact-enabled\",\n\t\t\"ecs-instance-ram-role-attached\",\n\t\t\"fc-service-bind-role\",\n\t\t\"ram-password-policy-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-activated-ak-quantity-check\",\n\t\t\"ram-user-ak-create-date-expired-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-last-login-expired-check\",\n\t\t\"ram-user-login-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"root-ak-check\",\n\t\t\"root-mfa-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:ai-model-training-architecture-best-practice", Name: models.I18nString{"de": "KI-Modelltrainingsarchitektur Best Practices", "en": "AI Model Training Architecture Best Practice", "es": "Mejores Prácticas de Arquitectura de Entrenamiento de Modelos de IA", "fr": "Meilleures Pratiques d'Architecture d'Entraînement de Modèles d'IA", "ja": "AI モデル訓練アーキテクチャのベストプラクティス", "pt": "Melhores Práticas de Arquitetura de Treinamento de Modelos de IA", "zh": "AI 模型训练架构检测最佳实践"}, Description: models.I18nString{"de": "Best Practices für KI-Modelltrainingsarchitekturen, die ACK, ECS, NAS, OSS, VPC und andere Ressourcen abdecken.", "en": "Best practices for AI model training architecture, covering ACK, ECS, NAS, OSS, VPC, and other resources.", "es": "Mejores prácticas para la arquitectura de entrenamiento de modelos de IA, que cubre ACK, ECS, NAS, OSS, VPC y otros recursos.", "fr": "Meilleures pratiques pour l'architecture d'entraînement de modèles d'IA, couvrant ACK, ECS, NAS, OSS, VPC et d'autres ressources.", "ja": "AI モデル訓練アーキテクチャのベストプラクティス。ACK、ECS、NAS、OSS、VPC などのリソースをカバーします。", "pt": "Melhores práticas para arquitetura de treinamento de modelos de IA, cobrindo ACK, ECS, NAS, OSS, VPC e outros recursos.", "zh": "AI 模型训练架构最佳实践,涵盖 ACK、ECS、NAS、OSS、VPC 等资源。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-encryption-enabled", "rule:aliyun:ack-cluster-supported-version", "rule:aliyun:ack-cluster-upgrade-latest-version", "rule:aliyun:cr-instance-multi-zone", "rule:aliyun:cr-repository-immutablity-enable", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-disk-encrypted", "rule:aliyun:ecs-instance-image-expired-check", "rule:aliyun:ecs-instance-not-bind-key-pair", "rule:aliyun:ecs-instance-ram-role-attached", "rule:aliyun:kms-key-delete-protection-enabled", "rule:aliyun:kms-key-rotation-enabled", "rule:aliyun:kms-secret-rotation-enabled", "rule:aliyun:nas-filesystem-encrypt-type-check", "rule:aliyun:nas-filesystem-mount-target-access-group-check", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-bucket-tls-version-check", "rule:aliyun:oss-default-encryption-kms", "rule:aliyun:pai-eas-instances-multi-zone", "rule:aliyun:sls-project-multi-zone", "rule:aliyun:vpc-flow-logs-enabled", "rule:aliyun:vswitch-available-ip-count"}, FilePath: "aliyun/packs/ai-model-training-architecture-best-practice.rego", PackageName: "infraguard.packs.aliyun.ai_model_training_architecture_best_practice", Content: "package infraguard.packs.aliyun.ai_model_training_architecture_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"ai-model-training-architecture-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"AI Model Training Architecture Best Practice\",\n\t\t\"zh\": \"AI 模型训练架构检测最佳实践\",\n\t\t\"ja\": \"AI モデル訓練アーキテクチャのベストプラクティス\",\n\t\t\"de\": \"KI-Modelltrainingsarchitektur Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Arquitectura de Entrenamiento de Modelos de IA\",\n\t\t\"fr\": \"Meilleures Pratiques d'Architecture d'Entraînement de Modèles d'IA\",\n\t\t\"pt\": \"Melhores Práticas de Arquitetura de Treinamento de Modelos de IA\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for AI model training architecture, covering ACK, ECS, NAS, OSS, VPC, and other resources.\",\n\t\t\"zh\": \"AI 模型训练架构最佳实践,涵盖 ACK、ECS、NAS、OSS、VPC 等资源。\",\n\t\t\"ja\": \"AI モデル訓練アーキテクチャのベストプラクティス。ACK、ECS、NAS、OSS、VPC などのリソースをカバーします。\",\n\t\t\"de\": \"Best Practices für KI-Modelltrainingsarchitekturen, die ACK, ECS, NAS, OSS, VPC und andere Ressourcen abdecken.\",\n\t\t\"es\": \"Mejores prácticas para la arquitectura de entrenamiento de modelos de IA, que cubre ACK, ECS, NAS, OSS, VPC y otros recursos.\",\n\t\t\"fr\": \"Meilleures pratiques pour l'architecture d'entraînement de modèles d'IA, couvrant ACK, ECS, NAS, OSS, VPC et d'autres ressources.\",\n\t\t\"pt\": \"Melhores práticas para arquitetura de treinamento de modelos de IA, cobrindo ACK, ECS, NAS, OSS, VPC e outros recursos.\"\n\t},\n\t\"rules\": [\n\t\t\"ack-cluster-encryption-enabled\",\n\t\t\"ack-cluster-supported-version\",\n\t\t\"ack-cluster-upgrade-latest-version\",\n\t\t\"cr-instance-multi-zone\",\n\t\t# \"cr-instance-public-access-check\",  # Commented: ROS CR::Instance does not support PublicNetworkAccess property,\n\t\t\"cr-repository-immutablity-enable\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-disk-encrypted\",\n\t\t\"ecs-instance-image-expired-check\",\n\t\t# \"ecs-instance-monitor-enabled\",  # Commented: ROS ECS::Instance does not support CloudMonitorFlags property,\n\t\t\"ecs-instance-not-bind-key-pair\",\n\t\t\"ecs-instance-ram-role-attached\",\n\t\t# \"ecs-instance-status-no-stopped\",  # Commented: ROS ECS::Instance does not support Status property,\n\t\t\"kms-key-delete-protection-enabled\",\n\t\t\"kms-key-rotation-enabled\",\n\t\t\"kms-secret-rotation-enabled\",\n\t\t# \"nas-filesystem-access-point-enabled-ram\",  # Commented: ROS does not support ALIYUN::NAS::AccessPoint resource type,\n\t\t# \"nas-filesystem-access-point-root-directory-check\",  # Commented: ROS does not support ALIYUN::NAS::AccessPoint resource type,\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t\"nas-filesystem-encrypt-type-check\",\n\t\t\"nas-filesystem-mount-target-access-group-check\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t# \"oss-bucket-remote-replication\",  # Commented: ROS template does not support ReplicationConfiguration,\n\t\t\"oss-bucket-tls-version-check\",\n\t\t\"oss-default-encryption-kms\",\n\t\t\"pai-eas-instances-multi-zone\",\n\t\t\"sls-project-multi-zone\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t# \"vpc-secondary-cidr-route-check\",\n\t\t\"vswitch-available-ip-count\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:aliyun-platform-security-best-practice", Name: models.I18nString{"de": "Alibaba Cloud Plattform-Sicherheit Best Practices", "en": "Aliyun Platform Security Best Practice", "es": "Mejores Prácticas de Seguridad de la Plataforma Aliyun", "fr": "Meilleures Pratiques de Sécurité de la Plateforme Aliyun", "ja": "Alibaba Cloud プラットフォームセキュリティのベストプラクティス", "pt": "Melhores Práticas de Segurança da Plataforma Aliyun", "zh": "阿里云平台安全最佳实践"}, Description: models.I18nString{"de": "Best Practices für Alibaba Cloud Plattform-Sicherheit", "en": "Best practices for Aliyun platform security", "es": "Mejores prácticas para la seguridad de la plataforma Aliyun", "fr": "Meilleures pratiques pour la sécurité de la plateforme Aliyun", "ja": "Alibaba Cloud プラットフォームセキュリティのベストプラクティス", "pt": "Melhores práticas para segurança da plataforma Aliyun", "zh": "阿里云平台安全最佳实践"}, RuleIDs: []string{"rule:aliyun:api-gateway-api-internet-request-https", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-instance-login-use-keypair", "rule:aliyun:ecs-instances-in-vpc", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:mongodb-public-and-any-ip-access-check", "rule:aliyun:oss-bucket-anonymous-prohibited", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:polardb-cluster-enabled-ssl", "rule:aliyun:polardb-public-and-any-ip-access-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-public-access-check", "rule:aliyun:redis-instance-backup-log-enabled", "rule:aliyun:redis-instance-enabled-ssl", "rule:aliyun:redis-public-and-any-ip-access-check", "rule:aliyun:root-ak-check", "rule:aliyun:root-mfa-check", "rule:aliyun:slb-acl-public-access-check", "rule:aliyun:slb-listener-https-enabled", "rule:aliyun:slb-listener-risk-ports-check", "rule:aliyun:vpc-network-acl-risky-ports-check"}, FilePath: "aliyun/packs/aliyun-platform-security-best-practice.rego", PackageName: "infraguard.packs.aliyun.aliyun_platform_security_best_practice", Content: "package infraguard.packs.aliyun.aliyun_platform_security_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"aliyun-platform-security-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Aliyun Platform Security Best Practice\",\n\t\t\"zh\": \"阿里云平台安全最佳实践\",\n\t\t\"ja\": \"Alibaba Cloud プラットフォームセキュリティのベストプラクティス\",\n\t\t\"de\": \"Alibaba Cloud Plattform-Sicherheit Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Seguridad de la Plataforma Aliyun\",\n\t\t\"fr\": \"Meilleures Pratiques de Sécurité de la Plateforme Aliyun\",\n\t\t\"pt\": \"Melhores Práticas de Segurança da Plataforma Aliyun\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for Aliyun platform security\",\n\t\t\"zh\": \"阿里云平台安全最佳实践\",\n\t\t\"ja\": \"Alibaba Cloud プラットフォームセキュリティのベストプラクティス\",\n\t\t\"de\": \"Best Practices für Alibaba Cloud Plattform-Sicherheit\",\n\t\t\"es\": \"Mejores prácticas para la seguridad de la plataforma Aliyun\",\n\t\t\"fr\": \"Meilleures pratiques pour la sécurité de la plateforme Aliyun\",\n\t\t\"pt\": \"Melhores práticas para segurança da plataforma Aliyun\"\n\t},\n\t\"rules\": [\n\t\t\"api-gateway-api-internet-request-https\",\n\t\t# \"cdn-domain-https-enabled\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t\"ecs-instance-login-use-keypair\",\n\t\t\"ecs-instances-in-vpc\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t# \"mongodb-instance-backup-log-enabled\",  # Commented: ROS does not support ALIYUN::MongoDB::DBInstance resource type,\n\t\t\"mongodb-public-and-any-ip-access-check\",\n\t\t\"oss-bucket-anonymous-prohibited\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"polardb-cluster-enabled-ssl\",\n\t\t# \"polardb-cluster-log-backup-retention\",  # ROS does not support LogBackupRetentionPeriod property,\n\t\t\"polardb-public-and-any-ip-access-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t# \"rds-instance-tls-version-check\",\n\t\t\"rds-public-access-check\",\n\t\t\"redis-instance-backup-log-enabled\",\n\t\t\"redis-instance-enabled-ssl\",\n\t\t\"redis-public-and-any-ip-access-check\",\n\t\t\"root-ak-check\",\n\t\t\"root-mfa-check\",\n\t\t\"slb-acl-public-access-check\",\n\t\t\"slb-listener-https-enabled\",\n\t\t\"slb-listener-risk-ports-check\",\n\t\t\"vpc-network-acl-risky-ports-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:aliyun-well-architected-security-pillar-best-practice", Name: models.I18nString{"de": "Alibaba Cloud Well-Architected Sicherheitssäule Best Practices", "en": "Aliyun Well-Architected Security Pillar Best Practice", "es": "Mejores Prácticas del Pilar de Seguridad de Arquitectura Bien Diseñada de Aliyun", "fr": "Meilleures Pratiques du Pilier de Sécurité de l'Architecture Bien Conçue d'Aliyun", "ja": "Alibaba Cloud ウェルアーキテクチャセキュリティのベストプラクティス", "pt": "Melhores Práticas do Pilar de Segurança de Arquitetura Bem Projetada do Aliyun", "zh": "阿里云卓越架构安全支柱最佳实践"}, Description: models.I18nString{"de": "Best Practices für die Alibaba Cloud Well-Architected Sicherheitssäule", "en": "Best practices for Aliyun well-architected security pillar", "es": "Mejores prácticas para el pilar de seguridad de arquitectura bien diseñada de Aliyun", "fr": "Meilleures pratiques pour le pilier de sécurité de l'architecture bien conçue d'Aliyun", "ja": "Alibaba Cloud ウェルアーキテクチャセキュリティのベストプラクティス", "pt": "Melhores práticas para o pilar de segurança de arquitetura bem projetada do Aliyun", "zh": "阿里云卓越架构安全支柱最佳实践"}, RuleIDs: []string{"rule:aliyun:actiontrail-trail-intact-enabled", "rule:aliyun:api-gateway-group-enabled-ssl", "rule:aliyun:ecs-disk-idle-check", "rule:aliyun:ecs-in-use-disk-encrypted", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-instance-ram-role-attached", "rule:aliyun:ecs-instances-in-vpc", "rule:aliyun:ecs-running-instance-no-public-ip", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:ecs-security-group-white-list-port-check", "rule:aliyun:elasticsearch-instance-enabled-data-node-encryption", "rule:aliyun:ess-scaling-configuration-enabled-internet-check", "rule:aliyun:fc-service-internet-access-disable", "rule:aliyun:fc-service-vpc-binding", "rule:aliyun:kms-key-rotation-enabled", "rule:aliyun:kms-secret-rotation-enabled", "rule:aliyun:nas-filesystem-encrypt-type-check", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-bucket-policy-no-any-anonymous", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-server-side-encryption-enabled", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-encryption-byok-check", "rule:aliyun:ram-group-has-member-check", "rule:aliyun:ram-password-policy-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-ak-create-date-expired-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-group-membership-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:ram-user-no-product-admin-access", "rule:aliyun:rds-public-connection-and-any-ip-access-check", "rule:aliyun:root-ak-check", "rule:aliyun:root-mfa-check", "rule:aliyun:security-center-version-check", "rule:aliyun:slb-instance-log-enabled", "rule:aliyun:slb-listener-https-enabled", "rule:aliyun:vpc-flow-logs-enabled", "rule:aliyun:waf-instance-logging-enabled"}, FilePath: "aliyun/packs/aliyun-well-architected-security-pillar-best-practice.rego", PackageName: "infraguard.packs.aliyun.aliyun_well_architected_security_pillar_best_practice", Content: "package infraguard.packs.aliyun.aliyun_well_architected_security_pillar_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"aliyun-well-architected-security-pillar-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Aliyun Well-Architected Security Pillar Best Practice\",\n\t\t\"zh\": \"阿里云卓越架构安全支柱最佳实践\",\n\t\t\"ja\": \"Alibaba Cloud ウェルアーキテクチャセキュリティのベストプラクティス\",\n\t\t\"de\": \"Alibaba Cloud Well-Architected Sicherheitssäule Best Practices\",\n\t\t\"es\": \"Mejores Prácticas del Pilar de Seguridad de Arquitectura Bien Diseñada de Aliyun\",\n\t\t\"fr\": \"Meilleures Pratiques du Pilier de Sécurité de l'Architecture Bien Conçue d'Aliyun\",\n\t\t\"pt\": \"Melhores Práticas do Pilar de Segurança de Arquitetura Bem Projetada do Aliyun\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for Aliyun well-architected security pillar\",\n\t\t\"zh\": \"阿里云卓越架构安全支柱最佳实践\",\n\t\t\"ja\": \"Alibaba Cloud ウェルアーキテクチャセキュリティのベストプラクティス\",\n\t\t\"de\": \"Best Practices für die Alibaba Cloud Well-Architected Sicherheitssäule\",\n\t\t\"es\": \"Mejores prácticas para el pilar de seguridad de arquitectura bien diseñada de Aliyun\",\n\t\t\"fr\": \"Meilleures pratiques pour le pilier de sécurité de l'architecture bien conçue d'Aliyun\",\n\t\t\"pt\": \"Melhores práticas para o pilar de segurança de arquitetura bem projetada do Aliyun\"\n\t},\n\t\"rules\": [\n\t\t\"actiontrail-trail-intact-enabled\",\n\t\t# \"adb-cluster-maintain-time-check\",  # Commented: ROS ADB::DBCluster does not support MaintainTime property,\n\t\t# \"adb-public-access-check\",  # Commented: ROS ADB::DBCluster does not support PublicEndpoint property,\n\t\t# \"api-gateway-group-domain-access-waf-or-waf3\",  # Commented: ROS ApiGateway::Group does not support PassthroughWaf property,\n\t\t\"api-gateway-group-enabled-ssl\",\n\t\t\"ecs-disk-idle-check\",\n\t\t\"ecs-in-use-disk-encrypted\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t\"ecs-instance-ram-role-attached\",\n\t\t# \"ecs-instance-status-no-stopped\",  # Commented: ROS ECS::Instance does not support Status property,\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t\"ecs-instances-in-vpc\",\n\t\t\"ecs-running-instance-no-public-ip\",\n\t\t# \"ecs-security-group-not-used\",  # Commented: ROS ECS::SecurityGroup does not support Used property,\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"ecs-security-group-white-list-port-check\",\n\t\t\"elasticsearch-instance-enabled-data-node-encryption\",\n\t\t# \"elasticsearch-instance-in-vpc\",  # Commented: ROS ALIYUN::ElasticSearch::Instance requires VSwitchId (all instances are in VPC),\n\t\t\"ess-scaling-configuration-enabled-internet-check\",\n\t\t\"fc-service-internet-access-disable\",\n\t\t\"fc-service-vpc-binding\",\n\t\t# \"kms-key-origin-not-external\",  # Commented: ROS KMS::Key does not support Origin property,\n\t\t\"kms-key-rotation-enabled\",\n\t\t# \"kms-key-state-not-pending-deletion\",  # Commented: ROS KMS::Key does not support KeyState property (runtime state only),\n\t\t\"kms-secret-rotation-enabled\",\n\t\t\"nas-filesystem-encrypt-type-check\",\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t\"oss-bucket-policy-no-any-anonymous\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-server-side-encryption-enabled\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-encryption-byok-check\",\n\t\t# \"ots-instance-all-table-encrypted\",  # ROS template does not support SSESpecification property,\n\t\t\"ram-group-has-member-check\",\n\t\t\"ram-password-policy-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-ak-create-date-expired-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-group-membership-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"ram-user-no-product-admin-access\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t# \"rds-instance-sql-collector-retention\",  # Commented: ROS RDS::DBInstance does not support SQLCollectorRetention property,\n\t\t\"rds-public-connection-and-any-ip-access-check\",\n\t\t\"root-ak-check\",\n\t\t\"root-mfa-check\",\n\t\t\"security-center-version-check\",\n\t\t\"slb-instance-log-enabled\",\n\t\t\"slb-listener-https-enabled\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t\"waf-instance-logging-enabled\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:change-management-best-practice", Name: models.I18nString{"de": "Änderungsmanagement Best Practices", "en": "Change Management Best Practice", "es": "Mejores Prácticas de Gestión de Cambios", "fr": "Meilleures Pratiques de Gestion des Changements", "ja": "変更管理のベストプラクティス", "pt": "Melhores Práticas de Gestão de Mudanças", "zh": "变更管理最佳实践"}, Description: models.I18nString{"de": "Aus der Perspektive des Änderungsmanagements die Stabilität von Cloud-Ressourcen erkennen, um potenzielle Probleme im Voraus zu identifizieren und die Stabilität und Betriebseffizienz zu verbessern.", "en": "From the change management dimension, detect the stability of cloud resources to help identify potential issues in advance and improve stability and operational efficiency.", "es": "Desde la dimensión de gestión de cambios, detectar la estabilidad de los recursos en la nube para ayudar a identificar problemas potenciales con anticipación y mejorar la estabilidad y la eficiencia operativa.", "fr": "Depuis la dimension de gestion des changements, détecter la stabilité des ressources cloud pour aider à identifier les problèmes potentiels à l'avance et améliorer la stabilité et l'efficacité opérationnelle.", "ja": "変更管理の観点から、クラウドリソースの安定性を検出し、潜在的な問題を事前に特定し、安定性と運用効率を向上させます。", "pt": "Da dimensão de gestão de mudanças, detectar a estabilidade dos recursos em nuvem para ajudar a identificar problemas potenciais com antecedência e melhorar a estabilidade e a eficiência operacional.", "zh": "从变更管理维度,对云上资源的稳定性做检测,有助于提前发现隐患,提升稳定性和运维效率。"}, RuleIDs: []string{"rule:aliyun:ecs-snapshot-policy-timepoints-check", "rule:aliyun:ecs-snapshot-retention-days", "rule:aliyun:polardb-cluster-maintain-time-check", "rule:aliyun:rds-instance-maintain-time-check", "rule:aliyun:redis-instance-backup-time-check"}, FilePath: "aliyun/packs/change-management-best-practice.rego", PackageName: "infraguard.packs.aliyun.change_management_best_practice", Content: "package infraguard.packs.aliyun.change_management_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"change-management-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Change Management Best Practice\",\n\t\t\"zh\": \"变更管理最佳实践\",\n\t\t\"ja\": \"変更管理のベストプラクティス\",\n\t\t\"de\": \"Änderungsmanagement Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Gestión de Cambios\",\n\t\t\"fr\": \"Meilleures Pratiques de Gestion des Changements\",\n\t\t\"pt\": \"Melhores Práticas de Gestão de Mudanças\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"From the change management dimension, detect the stability of cloud resources to help identify potential issues in advance and improve stability and operational efficiency.\",\n\t\t\"zh\": \"从变更管理维度,对云上资源的稳定性做检测,有助于提前发现隐患,提升稳定性和运维效率。\",\n\t\t\"ja\": \"変更管理の観点から、クラウドリソースの安定性を検出し、潜在的な問題を事前に特定し、安定性と運用効率を向上させます。\",\n\t\t\"de\": \"Aus der Perspektive des Änderungsmanagements die Stabilität von Cloud-Ressourcen erkennen, um potenzielle Probleme im Voraus zu identifizieren und die Stabilität und Betriebseffizienz zu verbessern.\",\n\t\t\"es\": \"Desde la dimensión de gestión de cambios, detectar la estabilidad de los recursos en la nube para ayudar a identificar problemas potenciales con anticipación y mejorar la estabilidad y la eficiencia operativa.\",\n\t\t\"fr\": \"Depuis la dimension de gestion des changements, détecter la stabilité des ressources cloud pour aider à identifier les problèmes potentiels à l'avance et améliorer la stabilité et l'efficacité opérationnelle.\",\n\t\t\"pt\": \"Da dimensão de gestão de mudanças, detectar a estabilidade dos recursos em nuvem para ajudar a identificar problemas potenciais com antecedência e melhorar a estabilidade e a eficiência operacional.\"\n\t},\n\t\"rules\": [\n\t\t# \"adb-cluster-maintain-time-check\",  # Commented: ROS ADB::DBCluster does not support MaintainTime property,\n\t\t\"ecs-snapshot-policy-timepoints-check\",\n\t\t\"ecs-snapshot-retention-days\",\n\t\t\"polardb-cluster-maintain-time-check\",\n\t\t\"rds-instance-maintain-time-check\",\n\t\t\"redis-instance-backup-time-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:china-gmp-annex-compliance", Name: models.I18nString{"de": "China GMP Anhang Compliance", "en": "China GMP Annex Compliance", "es": "Cumplimiento del Anexo GMP de China", "fr": "Conformité à l'Annexe GMP de Chine", "ja": "中国 GMP 附属書コンプライアンス", "pt": "Conformidade com o Anexo GMP da China", "zh": "中国 GMP 附录合规包"}, Description: models.I18nString{"de": "Compliance-Paket für pharmazeutische, biotechnologische und Medizinprodukteunternehmen, die Cloud-Dienste nutzen und die China GMP Anhang-Standards erfüllen müssen. Dieses Paket bietet Zuordnungen zwischen Standardanforderungen und Alibaba Cloud Produkteinstellungen.", "en": "Compliance pack for pharmaceutical, biotechnology and medical device companies using cloud services that need to meet China GMP Annex standards. This pack provides mappings between standard requirements and Alibaba Cloud product settings.", "es": "Paquete de cumplimiento para empresas farmacéuticas, biotecnológicas y de dispositivos médicos que utilizan servicios en la nube y necesitan cumplir con los estándares del Anexo GMP de China. Este paquete proporciona mapeos entre los requisitos estándar y la configuración de productos de Alibaba Cloud.", "fr": "Pack de conformité pour les entreprises pharmaceutiques, biotechnologiques et de dispositifs médicaux utilisant des services cloud qui doivent répondre aux normes de l'Annexe GMP de Chine. Ce pack fournit des correspondances entre les exigences standard et les paramètres des produits Alibaba Cloud.", "ja": "中国 GMP 附属書基準を満たす必要があるクラウドサービスを使用する製薬、バイオテクノロジー、医療機器企業向けのコンプライアンスパック。このパックは、標準要件と Alibaba Cloud 製品設定の間のマッピングを提供します。", "pt": "Pacote de conformidade para empresas farmacêuticas, de biotecnologia e de dispositivos médicos que usam serviços em nuvem e precisam atender aos padrões do Anexo GMP da China. Este pacote fornece mapeamentos entre os requisitos padrão e as configurações de produtos do Alibaba Cloud.", "zh": "在制药、生物技术和医疗器械领域中使用计算机化系统的企业和组织，在用云过程需要满足中国 GMP 附录标准。本合规包模板提供了标准细则与阿里云的产品设置的对应关系。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-rrsa-enabled", "rule:aliyun:alb-instance-multi-zone", "rule:aliyun:alb-server-group-multi-zone", "rule:aliyun:api-gateway-api-internet-request-https", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-in-use-disk-encrypted", "rule:aliyun:ecs-instance-deletion-protection-enabled", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-instance-ram-role-attached", "rule:aliyun:ecs-snapshot-retention-days", "rule:aliyun:eip-attached", "rule:aliyun:elasticsearch-instance-enabled-data-node-encryption", "rule:aliyun:ess-scaling-group-attach-multi-switch", "rule:aliyun:fc-function-custom-domain-and-tls-enable", "rule:aliyun:fc-service-bind-role", "rule:aliyun:hbase-cluster-deletion-protection", "rule:aliyun:mongodb-instance-log-audit", "rule:aliyun:mongodb-instance-multi-zone", "rule:aliyun:mongodb-instance-release-protection", "rule:aliyun:mse-cluster-config-auth-enabled", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-policy-no-any-anonymous", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-delete-protection-enabled", "rule:aliyun:polardb-cluster-enabled-ssl", "rule:aliyun:polardb-cluster-enabled-tde", "rule:aliyun:polardb-cluster-multi-zone", "rule:aliyun:privatelink-servier-endpoint-multi-zone", "rule:aliyun:ram-user-ak-create-date-expired-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-last-login-expired-check", "rule:aliyun:ram-user-login-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:rds-instacne-delete-protection-enabled", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-instance-enabled-ssl", "rule:aliyun:rds-multi-az-support", "rule:aliyun:redis-instance-backup-log-enabled", "rule:aliyun:redis-instance-enabled-byok-tde", "rule:aliyun:redis-instance-enabled-ssl", "rule:aliyun:redis-instance-multi-zone", "rule:aliyun:redis-instance-release-protection", "rule:aliyun:slb-delete-protection-enabled", "rule:aliyun:slb-instance-log-enabled", "rule:aliyun:slb-instance-multi-zone", "rule:aliyun:slb-vserver-group-multi-zone", "rule:aliyun:sls-logstore-enabled-encrypt", "rule:aliyun:waf-instance-logging-enabled"}, FilePath: "aliyun/packs/china-gmp-annex-compliance.rego", PackageName: "infraguard.packs.aliyun.china_gmp_annex_compliance", Content: "package infraguard.packs.aliyun.china_gmp_annex_compliance\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"china-gmp-annex-compliance\",\n\t\"name\": {\n\t\t\"en\": \"China GMP Annex Compliance\",\n\t\t\"zh\": \"中国 GMP 附录合规包\",\n\t\t\"ja\": \"中国 GMP 附属書コンプライアンス\",\n\t\t\"de\": \"China GMP Anhang Compliance\",\n\t\t\"es\": \"Cumplimiento del Anexo GMP de China\",\n\t\t\"fr\": \"Conformité à l'Annexe GMP de Chine\",\n\t\t\"pt\": \"Conformidade com o Anexo GMP da China\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for pharmaceutical, biotechnology and medical device companies using cloud services that need to meet China GMP Annex standards. This pack provides mappings between standard requirements and Alibaba Cloud product settings.\",\n\t\t\"zh\": \"在制药、生物技术和医疗器械领域中使用计算机化系统的企业和组织，在用云过程需要满足中国 GMP 附录标准。本合规包模板提供了标准细则与阿里云的产品设置的对应关系。\",\n\t\t\"ja\": \"中国 GMP 附属書基準を満たす必要があるクラウドサービスを使用する製薬、バイオテクノロジー、医療機器企業向けのコンプライアンスパック。このパックは、標準要件と Alibaba Cloud 製品設定の間のマッピングを提供します。\",\n\t\t\"de\": \"Compliance-Paket für pharmazeutische, biotechnologische und Medizinprodukteunternehmen, die Cloud-Dienste nutzen und die China GMP Anhang-Standards erfüllen müssen. Dieses Paket bietet Zuordnungen zwischen Standardanforderungen und Alibaba Cloud Produkteinstellungen.\",\n\t\t\"es\": \"Paquete de cumplimiento para empresas farmacéuticas, biotecnológicas y de dispositivos médicos que utilizan servicios en la nube y necesitan cumplir con los estándares del Anexo GMP de China. Este paquete proporciona mapeos entre los requisitos estándar y la configuración de productos de Alibaba Cloud.\",\n\t\t\"fr\": \"Pack de conformité pour les entreprises pharmaceutiques, biotechnologiques et de dispositifs médicaux utilisant des services cloud qui doivent répondre aux normes de l'Annexe GMP de Chine. Ce pack fournit des correspondances entre les exigences standard et les paramètres des produits Alibaba Cloud.\",\n\t\t\"pt\": \"Pacote de conformidade para empresas farmacêuticas, de biotecnologia e de dispositivos médicos que usam serviços em nuvem e precisam atender aos padrões do Anexo GMP da China. Este pacote fornece mapeamentos entre os requisitos padrão e as configurações de produtos do Alibaba Cloud.\"\n\t},\n\t\"rules\": [\n\t\t\"ack-cluster-rrsa-enabled\",\n\t\t# \"adb-cluster-audit-log-enabled\",  # Commented: ROS ADB::DBCluster does not support AuditLog property,\n\t\t# \"adb-cluster-log-backup-enabled\",\n\t\t\"alb-instance-multi-zone\",\n\t\t\"alb-server-group-multi-zone\",\n\t\t\"api-gateway-api-internet-request-https\",\n\t\t# \"cdn-domain-tls13-enabled\",\n\t\t# \"dts-instance-migration-job-ssl-enabled\",\n\t\t# \"dts-instance-sync-job-ssl-enabled\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-in-use-disk-encrypted\",\n\t\t\"ecs-instance-deletion-protection-enabled\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t# \"ecs-instance-monitor-enabled\",  # Commented: ROS ECS::Instance does not support CloudMonitorFlags property,\n\t\t\"ecs-instance-ram-role-attached\",\n\t\t# \"ecs-instance-status-no-stopped\",  # Commented: ROS ECS::Instance does not support Status property,\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t# \"ecs-security-group-not-used\",  # Commented: ROS ECS::SecurityGroup does not support Used property,\n\t\t\"ecs-snapshot-retention-days\",\n\t\t\"eip-attached\",\n\t\t\"elasticsearch-instance-enabled-data-node-encryption\",\n\t\t# \"elasticsearch-instance-snapshot-enabled\",  # Commented: ROS does not support AutoSnapshot property for ALIYUN::ElasticSearch::Instance,\n\t\t# \"elasticsearch-instance-used-https-protocol\",  # Commented: ROS ALIYUN::ElasticSearch::Instance does not support Protocol property,\n\t\t\"ess-scaling-group-attach-multi-switch\",\n\t\t\"fc-function-custom-domain-and-tls-enable\",\n\t\t\"fc-service-bind-role\",\n\t\t\"hbase-cluster-deletion-protection\",\n\t\t# \"mongodb-instance-backup-log-enabled\",  # Commented: ROS does not support ALIYUN::MongoDB::DBInstance resource type,\n\t\t\"mongodb-instance-log-audit\",\n\t\t\"mongodb-instance-multi-zone\",\n\t\t\"mongodb-instance-release-protection\",\n\t\t\"mse-cluster-config-auth-enabled\",\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t# \"oceanbase-instance-enabled-backup\",  # Commented: ROS does not support ALIYUN::OceanBase::DBInstance resource type,\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-policy-no-any-anonymous\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-zrs-enabled\",\n\t\t\"polardb-cluster-delete-protection-enabled\",\n\t\t\"polardb-cluster-enabled-ssl\",\n\t\t\"polardb-cluster-enabled-tde\",\n\t\t# \"polardb-cluster-log-backup-retention\",  # ROS does not support LogBackupRetentionPeriod property,\n\t\t\"polardb-cluster-multi-zone\",\n\t\t\"privatelink-servier-endpoint-multi-zone\",\n\t\t\"ram-user-ak-create-date-expired-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-last-login-expired-check\",\n\t\t\"ram-user-login-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"rds-instacne-delete-protection-enabled\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t\"rds-instance-enabled-ssl\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t# \"rds-instance-sql-collector-retention\",  # Commented: ROS RDS::DBInstance does not support SQLCollectorRetention property,\n\t\t\"rds-multi-az-support\",\n\t\t\"redis-instance-backup-log-enabled\",\n\t\t# \"redis-instance-enabled-audit-log\",  # Commented: ROS ALIYUN::REDIS::Instance does not support AuditLogConfig property,\n\t\t\"redis-instance-enabled-byok-tde\",\n\t\t\"redis-instance-enabled-ssl\",\n\t\t\"redis-instance-multi-zone\",\n\t\t\"redis-instance-release-protection\",\n\t\t\"slb-delete-protection-enabled\",\n\t\t\"slb-instance-log-enabled\",\n\t\t\"slb-instance-multi-zone\",\n\t\t\"slb-vserver-group-multi-zone\",\n\t\t\"sls-logstore-enabled-encrypt\",\n\t\t# \"vpn-ipsec-connection-encrypt-enable\",\n\t\t\"waf-instance-logging-enabled\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:cloud-governance-center-compliance-practice", Name: models.I18nString{"de": "Cloud-Governance-Center-Compliance-Praxis", "en": "Cloud Governance Center Compliance Practice", "es": "Práctica de Cumplimiento del Centro de Gobernanza en la Nube", "fr": "Pratique de Conformité du Centre de Gouvernance Cloud", "ja": "クラウドガバナンスセンターコンプライアンス実践", "pt": "Prática de Conformidade do Centro de Governança em Nuvem", "zh": "云治理中心合规实践"}, Description: models.I18nString{"de": "Compliance-Praktiken für das Cloud-Governance-Center", "en": "Compliance practices for cloud governance center", "es": "Prácticas de cumplimiento para el centro de gobernanza en la nube", "fr": "Pratiques de conformité pour le centre de gouvernance cloud", "ja": "クラウドガバナンスセンターのコンプライアンス実践", "pt": "Práticas de conformidade para o centro de governança em nuvem", "zh": "云治理中心合规实践"}, RuleIDs: []string{"rule:aliyun:ecs-disk-encrypted", "rule:aliyun:ecs-instance-deletion-protection-enabled", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-server-side-encryption-enabled", "rule:aliyun:ram-password-policy-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-last-login-expired-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:rds-instances-in-vpc", "rule:aliyun:rds-public-access-check", "rule:aliyun:root-ak-check", "rule:aliyun:root-has-specified-role", "rule:aliyun:root-mfa-check", "rule:aliyun:sg-public-access-check", "rule:aliyun:slb-delete-protection-enabled", "rule:aliyun:slb-listener-https-enabled"}, FilePath: "aliyun/packs/cloud-governance-center-compliance-practice.rego", PackageName: "infraguard.packs.aliyun.cloud_governance_center_compliance_practice", Content: "package infraguard.packs.aliyun.cloud_governance_center_compliance_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"cloud-governance-center-compliance-practice\",\n\t\"name\": {\n\t\t\"en\": \"Cloud Governance Center Compliance Practice\",\n\t\t\"zh\": \"云治理中心合规实践\",\n\t\t\"ja\": \"クラウドガバナンスセンターコンプライアンス実践\",\n\t\t\"de\": \"Cloud-Governance-Center-Compliance-Praxis\",\n\t\t\"es\": \"Práctica de Cumplimiento del Centro de Gobernanza en la Nube\",\n\t\t\"fr\": \"Pratique de Conformité du Centre de Gouvernance Cloud\",\n\t\t\"pt\": \"Prática de Conformidade do Centro de Governança em Nuvem\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance practices for cloud governance center\",\n\t\t\"zh\": \"云治理中心合规实践\",\n\t\t\"ja\": \"クラウドガバナンスセンターのコンプライアンス実践\",\n\t\t\"de\": \"Compliance-Praktiken für das Cloud-Governance-Center\",\n\t\t\"es\": \"Prácticas de cumplimiento para el centro de gobernanza en la nube\",\n\t\t\"fr\": \"Pratiques de conformité pour le centre de gouvernance cloud\",\n\t\t\"pt\": \"Práticas de conformidade para o centro de governança em nuvem\"\n\t},\n\t\"rules\": [\n\t\t# \"contains-tag\",  # Commented: Some resources like ACTIONTRAIL::Trail do not support Tags property,\n\t\t\"ecs-disk-encrypted\",\n\t\t\"ecs-instance-deletion-protection-enabled\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-server-side-encryption-enabled\",\n\t\t\"ram-password-policy-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-last-login-expired-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t\"rds-instances-in-vpc\",\n\t\t\"rds-public-access-check\",\n\t\t# \"required-tags\",  # Commented: Some resources like ACTIONTRAIL::Trail do not support Tags property,\n\t\t# \"resource-region-limit\",\n\t\t\"root-ak-check\",\n\t\t\"root-has-specified-role\",\n\t\t\"root-mfa-check\",\n\t\t\"sg-public-access-check\",\n\t\t\"slb-delete-protection-enabled\",\n\t\t\"slb-listener-https-enabled\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:database-compliance-management-best-practice", Name: models.I18nString{"de": "Datenbank-Compliance-Management Best Practices", "en": "Database Compliance Management Best Practice", "es": "Mejores Prácticas de Gestión de Cumplimiento de Bases de Datos", "fr": "Meilleures Pratiques de Gestion de la Conformité des Bases de Données", "ja": "データベースコンプライアンス管理のベストプラクティス", "pt": "Melhores Práticas de Gestão de Conformidade de Banco de Dados", "zh": "数据库合规管理最佳实践"}, Description: models.I18nString{"de": "Best Practices für das Datenbank-Compliance-Management", "en": "Best practices for database compliance management", "es": "Mejores prácticas para la gestión de cumplimiento de bases de datos", "fr": "Meilleures pratiques pour la gestion de la conformité des bases de données", "ja": "データベースコンプライアンス管理のベストプラクティス", "pt": "Melhores práticas para gestão de conformidade de banco de dados", "zh": "数据库合规管理最佳实践"}, RuleIDs: []string{"rule:aliyun:hbase-cluster-deletion-protection", "rule:aliyun:hbase-cluster-expired-check", "rule:aliyun:hbase-cluster-in-vpc", "rule:aliyun:hbase-cluster-type-check", "rule:aliyun:mongodb-cluster-expired-check", "rule:aliyun:mongodb-instance-log-audit", "rule:aliyun:mongodb-instance-release-protection", "rule:aliyun:mongodb-public-access-check", "rule:aliyun:polardb-cluster-expired-check", "rule:aliyun:rds-instance-enabled-auditing", "rule:aliyun:rds-instance-enabled-ssl", "rule:aliyun:rds-instance-expired-check", "rule:aliyun:rds-instances-in-vpc", "rule:aliyun:rds-multi-az-support", "rule:aliyun:rds-public-access-check", "rule:aliyun:redis-instance-expired-check", "rule:aliyun:redis-instance-release-protection"}, FilePath: "aliyun/packs/database-compliance-management-best-practice.rego", PackageName: "infraguard.packs.aliyun.database_compliance_management_best_practice", Content: "package infraguard.packs.aliyun.database_compliance_management_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"database-compliance-management-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Database Compliance Management Best Practice\",\n\t\t\"zh\": \"数据库合规管理最佳实践\",\n\t\t\"ja\": \"データベースコンプライアンス管理のベストプラクティス\",\n\t\t\"de\": \"Datenbank-Compliance-Management Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Gestión de Cumplimiento de Bases de Datos\",\n\t\t\"fr\": \"Meilleures Pratiques de Gestion de la Conformité des Bases de Données\",\n\t\t\"pt\": \"Melhores Práticas de Gestão de Conformidade de Banco de Dados\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for database compliance management\",\n\t\t\"zh\": \"数据库合规管理最佳实践\",\n\t\t\"ja\": \"データベースコンプライアンス管理のベストプラクティス\",\n\t\t\"de\": \"Best Practices für das Datenbank-Compliance-Management\",\n\t\t\"es\": \"Mejores prácticas para la gestión de cumplimiento de bases de datos\",\n\t\t\"fr\": \"Meilleures pratiques pour la gestion de la conformité des bases de données\",\n\t\t\"pt\": \"Melhores práticas para gestão de conformidade de banco de dados\"\n\t},\n\t\"rules\": [\n\t\t\"hbase-cluster-deletion-protection\",\n\t\t\"hbase-cluster-expired-check\",\n\t\t# \"hbase-cluster-ha-check\",\n\t\t\"hbase-cluster-in-vpc\",\n\t\t\"hbase-cluster-type-check\",\n\t\t\"mongodb-cluster-expired-check\",\n\t\t# \"mongodb-instance-in-vpc\",\n\t\t# \"mongodb-instance-lock-mode\",\n\t\t\"mongodb-instance-log-audit\",\n\t\t\"mongodb-instance-release-protection\",\n\t\t\"mongodb-public-access-check\",\n\t\t# \"polardb-cluster-category-normal\",\n\t\t\"polardb-cluster-expired-check\",\n\t\t# \"polardb-dbcluster-in-vpc\",\n\t\t# \"polardb-public-access-check\",\n\t\t# \"rds-high-availability-category\",\n\t\t\"rds-instance-enabled-auditing\",\n\t\t# \"rds-instance-enabled-safety-security-ip\",\n\t\t# \"rds-instance-enabled-security-ip-list\",\n\t\t\"rds-instance-enabled-ssl\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t\"rds-instance-expired-check\",\n\t\t# \"rds-instance-sql-collector-retention\",  # Commented: ROS RDS::DBInstance does not support SQLCollectorRetention property,\n\t\t\"rds-instances-in-vpc\",\n\t\t\"rds-multi-az-support\",\n\t\t\"rds-public-access-check\",\n\t\t# \"redis-architecturetype-cluster-check\",\n\t\t# \"redis-instance-disable-risk-commands\",\n\t\t\"redis-instance-expired-check\",\n\t\t# \"redis-instance-in-vpc\",\n\t\t\"redis-instance-release-protection\",\n\t\t# \"redis-public-access-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:ecs-compliance-management-best-practice", Name: models.I18nString{"de": "ECS-Compliance-Management Best Practices", "en": "ECS Compliance Management Best Practice", "es": "Mejores Prácticas de Gestión de Cumplimiento de ECS", "fr": "Meilleures Pratiques de Gestion de la Conformité ECS", "ja": "ECS コンプライアンス管理のベストプラクティス", "pt": "Melhores Práticas de Gestão de Conformidade ECS", "zh": "ECS 合规管理最佳实践"}, Description: models.I18nString{"de": "Best Practices für das ECS-Compliance-Management", "en": "Best practices for ECS compliance management", "es": "Mejores prácticas para la gestión de cumplimiento de ECS", "fr": "Meilleures pratiques pour la gestion de la conformité ECS", "ja": "ECS コンプライアンス管理のベストプラクティス", "pt": "Melhores práticas para gestão de conformidade ECS", "zh": "ECS 合规管理最佳实践"}, RuleIDs: []string{"rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-disk-encrypted", "rule:aliyun:ecs-instance-attached-security-group", "rule:aliyun:ecs-instance-deletion-protection-enabled", "rule:aliyun:ecs-instance-expired-check", "rule:aliyun:ecs-instances-in-vpc", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:ecs-snapshot-retention-days", "rule:aliyun:sg-public-access-check"}, FilePath: "aliyun/packs/ecs-compliance-management-best-practice.rego", PackageName: "infraguard.packs.aliyun.ecs_compliance_management_best_practice", Content: "package infraguard.packs.aliyun.ecs_compliance_management_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"ecs-compliance-management-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"ECS Compliance Management Best Practice\",\n\t\t\"zh\": \"ECS 合规管理最佳实践\",\n\t\t\"ja\": \"ECS コンプライアンス管理のベストプラクティス\",\n\t\t\"de\": \"ECS-Compliance-Management Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Gestión de Cumplimiento de ECS\",\n\t\t\"fr\": \"Meilleures Pratiques de Gestion de la Conformité ECS\",\n\t\t\"pt\": \"Melhores Práticas de Gestão de Conformidade ECS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for ECS compliance management\",\n\t\t\"zh\": \"ECS 合规管理最佳实践\",\n\t\t\"ja\": \"ECS コンプライアンス管理のベストプラクティス\",\n\t\t\"de\": \"Best Practices für das ECS-Compliance-Management\",\n\t\t\"es\": \"Mejores prácticas para la gestión de cumplimiento de ECS\",\n\t\t\"fr\": \"Meilleures pratiques pour la gestion de la conformité ECS\",\n\t\t\"pt\": \"Melhores práticas para gestão de conformidade ECS\"\n\t},\n\t\"rules\": [\n\t\t# \"ecs-all-enabled-security-protection\",\n\t\t# \"ecs-all-updated-security-vul\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-disk-encrypted\",\n\t\t# \"ecs-disk-in-use\",\n\t\t# \"ecs-disk-no-lock\",  # Removed: Status is a runtime attribute, cannot be checked in templates,\n\t\t# \"ecs-disk-retain-auto-snapshot\",\n\t\t\"ecs-instance-attached-security-group\",\n\t\t\"ecs-instance-deletion-protection-enabled\",\n\t\t\"ecs-instance-expired-check\",\n\t\t# \"ecs-instance-imageId-check\",\n\t\t# \"ecs-instance-no-lock\",\n\t\t# \"ecs-instance-status-no-stopped\",  # Commented: ROS ECS::Instance does not support Status property,\n\t\t\"ecs-instances-in-vpc\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"ecs-snapshot-retention-days\",\n\t\t# \"ess-group-health-check\",\n\t\t\"sg-public-access-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:generative-ai-compliance-best-practice", Name: models.I18nString{"de": "Generative KI-Compliance Best Practices", "en": "Generative AI Compliance Best Practice", "es": "Mejores Prácticas de Cumplimiento de IA Generativa", "fr": "Meilleures Pratiques de Conformité pour l'IA Générative", "ja": "生成 AI コンプライアンスのベストプラクティス", "pt": "Melhores Práticas de Conformidade de IA Generativa", "zh": "生成式 AI 合规最佳实践"}, Description: models.I18nString{"de": "Dieses Compliance-Paket soll Ihnen helfen, potenzielle Compliance-Risiken in den Bereichen Sicherheit und Stabilität von Bailian, PAI-Plattform und ihren abhängigen Kernprodukten (wie ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute usw.) umfassend zu erkennen und zu verwalten.", "en": "This compliance pack aims to help you comprehensively detect and manage potential compliance risks in security and stability aspects of Bailian, PAI platform, and their dependent core products (such as ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute, etc.).", "es": "Este paquete de cumplimiento tiene como objetivo ayudarle a detectar y gestionar de manera integral los riesgos potenciales de cumplimiento en los aspectos de seguridad y estabilidad de Bailian, la plataforma PAI y sus productos principales dependientes (como ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute, etc.).", "fr": "Ce pack de conformité vise à vous aider à détecter et gérer de manière exhaustive les risques potentiels de conformité dans les aspects de sécurité et de stabilité de Bailian, de la plateforme PAI et de leurs produits principaux dépendants (tels que ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute, etc.).", "ja": "このコンプライアンスパックは、Bailian、PAI プラットフォーム、およびそれらに依存するコア製品（ACK、ACR、OSS、NAS、KMS、SLS、MaxCompute など）のセキュリティと安定性の側面における潜在的なコンプライアンスリスクを包括的に検出および管理するのに役立ちます。", "pt": "Este pacote de conformidade visa ajudá-lo a detectar e gerenciar de forma abrangente os riscos potenciais de conformidade nos aspectos de segurança e estabilidade da plataforma Bailian, PAI e seus produtos principais dependentes (como ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute, etc.).", "zh": "本合规包旨在帮助您全面检测和管理百炼、人工智能平台 PAI 以及其依赖的核心产品(如 ACK、ACR、OSS、NAS、KMS、SLS、MaxCompute 等)在安全与稳定性方面的潜在合规风险。"}, RuleIDs: []string{"rule:aliyun:cr-repository-immutablity-enable", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-disk-encrypted", "rule:aliyun:kms-key-delete-protection-enabled", "rule:aliyun:kms-key-rotation-enabled", "rule:aliyun:kms-secret-rotation-enabled", "rule:aliyun:maxcompute-project-encryption-enabled", "rule:aliyun:maxcompute-project-ip-whitelist-enabled", "rule:aliyun:nas-filesystem-encrypt-type-check", "rule:aliyun:nas-filesystem-mount-target-access-group-check", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-default-encryption-kms", "rule:aliyun:pai-eas-instances-multi-zone"}, FilePath: "aliyun/packs/generative-ai-compliance-best-practice.rego", PackageName: "infraguard.packs.aliyun.generative_ai_compliance_best_practice", Content: "package infraguard.packs.aliyun.generative_ai_compliance_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"generative-ai-compliance-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Generative AI Compliance Best Practice\",\n\t\t\"zh\": \"生成式 AI 合规最佳实践\",\n\t\t\"ja\": \"生成 AI コンプライアンスのベストプラクティス\",\n\t\t\"de\": \"Generative KI-Compliance Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Cumplimiento de IA Generativa\",\n\t\t\"fr\": \"Meilleures Pratiques de Conformité pour l'IA Générative\",\n\t\t\"pt\": \"Melhores Práticas de Conformidade de IA Generativa\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"This compliance pack aims to help you comprehensively detect and manage potential compliance risks in security and stability aspects of Bailian, PAI platform, and their dependent core products (such as ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute, etc.).\",\n\t\t\"zh\": \"本合规包旨在帮助您全面检测和管理百炼、人工智能平台 PAI 以及其依赖的核心产品(如 ACK、ACR、OSS、NAS、KMS、SLS、MaxCompute 等)在安全与稳定性方面的潜在合规风险。\",\n\t\t\"ja\": \"このコンプライアンスパックは、Bailian、PAI プラットフォーム、およびそれらに依存するコア製品（ACK、ACR、OSS、NAS、KMS、SLS、MaxCompute など）のセキュリティと安定性の側面における潜在的なコンプライアンスリスクを包括的に検出および管理するのに役立ちます。\",\n\t\t\"de\": \"Dieses Compliance-Paket soll Ihnen helfen, potenzielle Compliance-Risiken in den Bereichen Sicherheit und Stabilität von Bailian, PAI-Plattform und ihren abhängigen Kernprodukten (wie ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute usw.) umfassend zu erkennen und zu verwalten.\",\n\t\t\"es\": \"Este paquete de cumplimiento tiene como objetivo ayudarle a detectar y gestionar de manera integral los riesgos potenciales de cumplimiento en los aspectos de seguridad y estabilidad de Bailian, la plataforma PAI y sus productos principales dependientes (como ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute, etc.).\",\n\t\t\"fr\": \"Ce pack de conformité vise à vous aider à détecter et gérer de manière exhaustive les risques potentiels de conformité dans les aspects de sécurité et de stabilité de Bailian, de la plateforme PAI et de leurs produits principaux dépendants (tels que ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute, etc.).\",\n\t\t\"pt\": \"Este pacote de conformidade visa ajudá-lo a detectar e gerenciar de forma abrangente os riscos potenciais de conformidade nos aspectos de segurança e estabilidade da plataforma Bailian, PAI e seus produtos principais dependentes (como ACK, ACR, OSS, NAS, KMS, SLS, MaxCompute, etc.).\"\n\t},\n\t\"rules\": [\n\t\t# \"cr-instance-public-access-check\",  # Commented: ROS CR::Instance does not support PublicNetworkAccess property,\n\t\t\"cr-repository-immutablity-enable\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-disk-encrypted\",\n\t\t\"kms-key-delete-protection-enabled\",\n\t\t\"kms-key-rotation-enabled\",\n\t\t\"kms-secret-rotation-enabled\",\n\t\t\"maxcompute-project-encryption-enabled\",\n\t\t\"maxcompute-project-ip-whitelist-enabled\",\n\t\t# \"maxcompute-project-multi-zone\",\n\t\t# \"nas-filesystem-access-point-enabled-ram\",  # Commented: ROS does not support ALIYUN::NAS::AccessPoint resource type,\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t\"nas-filesystem-encrypt-type-check\",\n\t\t\"nas-filesystem-mount-target-access-group-check\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t# \"oss-bucket-remote-replication\",  # ROS template does not support replication configuration,\n\t\t# \"oss-bucket-tls-version-check\",  # ROS template does not support TLS version configuration,\n\t\t\"oss-default-encryption-kms\",\n\t\t\"pai-eas-instances-multi-zone\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:gxp-eu-annex11-compliance", Name: models.I18nString{"de": "GxP EU Anhang 11 Compliance", "en": "GxP EU Annex 11 Compliance", "es": "Cumplimiento del Anexo 11 GxP de la UE", "fr": "Conformité à l'Annexe 11 GxP de l'UE", "ja": "GxP EU 附属書 11 コンプライアンス", "pt": "Conformidade com o Anexo 11 GxP da UE", "zh": "GxP 欧盟附录 11 标准合规包"}, Description: models.I18nString{"de": "Compliance-Paket für pharmazeutische, biotechnologische und Medizinprodukteunternehmen, die Cloud-Dienste nutzen und die GxP EU Anhang 11-Standards erfüllen müssen. Dieses Paket bietet Zuordnungen zwischen Standardanforderungen und Alibaba Cloud Produkteinstellungen.", "en": "Compliance pack for pharmaceutical, biotechnology and medical device companies using cloud services that need to meet GxP EU Annex 11 standards. This pack provides mappings between standard requirements and Alibaba Cloud product settings.", "es": "Paquete de cumplimiento para empresas farmacéuticas, biotecnológicas y de dispositivos médicos que utilizan servicios en la nube y necesitan cumplir con los estándares del Anexo 11 GxP de la UE. Este paquete proporciona mapeos entre los requisitos estándar y la configuración de productos de Alibaba Cloud.", "fr": "Pack de conformité pour les entreprises pharmaceutiques, biotechnologiques et de dispositifs médicaux utilisant des services cloud qui doivent répondre aux normes de l'Annexe 11 GxP de l'UE. Ce pack fournit des correspondances entre les exigences standard et les paramètres des produits Alibaba Cloud.", "ja": "GxP EU 附属書 11 基準を満たす必要があるクラウドサービスを使用する製薬、バイオテクノロジー、医療機器企業向けのコンプライアンスパック。このパックは、標準要件と Alibaba Cloud 製品設定の間のマッピングを提供します。", "pt": "Pacote de conformidade para empresas farmacêuticas, de biotecnologia e de dispositivos médicos que usam serviços em nuvem e precisam atender aos padrões do Anexo 11 GxP da UE. Este pacote fornece mapeamentos entre os requisitos padrão e as configurações de produtos do Alibaba Cloud.", "zh": "在制药、生物技术和医疗器械领域中使用计算机化系统的企业和组织，在用云过程需要满足 GxP 欧盟标准。本合规包模板提供了标准细则与阿里云的产品设置的对应关系。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-rrsa-enabled", "rule:aliyun:alb-instance-multi-zone", "rule:aliyun:alb-server-group-multi-zone", "rule:aliyun:api-gateway-api-internet-request-https", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-in-use-disk-encrypted", "rule:aliyun:ecs-instance-deletion-protection-enabled", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-instance-ram-role-attached", "rule:aliyun:ecs-snapshot-retention-days", "rule:aliyun:eip-attached", "rule:aliyun:elasticsearch-instance-enabled-data-node-encryption", "rule:aliyun:ess-scaling-group-attach-multi-switch", "rule:aliyun:fc-function-custom-domain-and-tls-enable", "rule:aliyun:fc-service-bind-role", "rule:aliyun:hbase-cluster-deletion-protection", "rule:aliyun:mongodb-instance-log-audit", "rule:aliyun:mongodb-instance-multi-zone", "rule:aliyun:mongodb-instance-release-protection", "rule:aliyun:mse-cluster-config-auth-enabled", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-policy-no-any-anonymous", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-delete-protection-enabled", "rule:aliyun:polardb-cluster-enabled-ssl", "rule:aliyun:polardb-cluster-enabled-tde", "rule:aliyun:polardb-cluster-multi-zone", "rule:aliyun:privatelink-servier-endpoint-multi-zone", "rule:aliyun:ram-user-ak-create-date-expired-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-last-login-expired-check", "rule:aliyun:ram-user-login-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:rds-instacne-delete-protection-enabled", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-instance-enabled-ssl", "rule:aliyun:rds-multi-az-support", "rule:aliyun:redis-instance-backup-log-enabled", "rule:aliyun:redis-instance-enabled-byok-tde", "rule:aliyun:redis-instance-enabled-ssl", "rule:aliyun:redis-instance-multi-zone", "rule:aliyun:redis-instance-release-protection", "rule:aliyun:slb-delete-protection-enabled", "rule:aliyun:slb-instance-log-enabled", "rule:aliyun:slb-instance-multi-zone", "rule:aliyun:slb-vserver-group-multi-zone", "rule:aliyun:sls-logstore-enabled-encrypt", "rule:aliyun:waf-instance-logging-enabled"}, FilePath: "aliyun/packs/gxp-eu-annex11-compliance.rego", PackageName: "infraguard.packs.aliyun.gxp_eu_annex11_compliance", Content: "package infraguard.packs.aliyun.gxp_eu_annex11_compliance\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"gxp-eu-annex11-compliance\",\n\t\"name\": {\n\t\t\"en\": \"GxP EU Annex 11 Compliance\",\n\t\t\"zh\": \"GxP 欧盟附录 11 标准合规包\",\n\t\t\"ja\": \"GxP EU 附属書 11 コンプライアンス\",\n\t\t\"de\": \"GxP EU Anhang 11 Compliance\",\n\t\t\"es\": \"Cumplimiento del Anexo 11 GxP de la UE\",\n\t\t\"fr\": \"Conformité à l'Annexe 11 GxP de l'UE\",\n\t\t\"pt\": \"Conformidade com o Anexo 11 GxP da UE\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for pharmaceutical, biotechnology and medical device companies using cloud services that need to meet GxP EU Annex 11 standards. This pack provides mappings between standard requirements and Alibaba Cloud product settings.\",\n\t\t\"zh\": \"在制药、生物技术和医疗器械领域中使用计算机化系统的企业和组织，在用云过程需要满足 GxP 欧盟标准。本合规包模板提供了标准细则与阿里云的产品设置的对应关系。\",\n\t\t\"ja\": \"GxP EU 附属書 11 基準を満たす必要があるクラウドサービスを使用する製薬、バイオテクノロジー、医療機器企業向けのコンプライアンスパック。このパックは、標準要件と Alibaba Cloud 製品設定の間のマッピングを提供します。\",\n\t\t\"de\": \"Compliance-Paket für pharmazeutische, biotechnologische und Medizinprodukteunternehmen, die Cloud-Dienste nutzen und die GxP EU Anhang 11-Standards erfüllen müssen. Dieses Paket bietet Zuordnungen zwischen Standardanforderungen und Alibaba Cloud Produkteinstellungen.\",\n\t\t\"es\": \"Paquete de cumplimiento para empresas farmacéuticas, biotecnológicas y de dispositivos médicos que utilizan servicios en la nube y necesitan cumplir con los estándares del Anexo 11 GxP de la UE. Este paquete proporciona mapeos entre los requisitos estándar y la configuración de productos de Alibaba Cloud.\",\n\t\t\"fr\": \"Pack de conformité pour les entreprises pharmaceutiques, biotechnologiques et de dispositifs médicaux utilisant des services cloud qui doivent répondre aux normes de l'Annexe 11 GxP de l'UE. Ce pack fournit des correspondances entre les exigences standard et les paramètres des produits Alibaba Cloud.\",\n\t\t\"pt\": \"Pacote de conformidade para empresas farmacêuticas, de biotecnologia e de dispositivos médicos que usam serviços em nuvem e precisam atender aos padrões do Anexo 11 GxP da UE. Este pacote fornece mapeamentos entre os requisitos padrão e as configurações de produtos do Alibaba Cloud.\"\n\t},\n\t\"rules\": [\n\t\t\"ack-cluster-rrsa-enabled\",\n\t\t# \"adb-cluster-audit-log-enabled\",  # Commented: ROS ADB::DBCluster does not support AuditLog property,\n\t\t# \"adb-cluster-log-backup-enabled\",\n\t\t\"alb-instance-multi-zone\",\n\t\t\"alb-server-group-multi-zone\",\n\t\t\"api-gateway-api-internet-request-https\",\n\t\t# \"cdn-domain-tls13-enabled\",\n\t\t# \"dts-instance-migration-job-ssl-enabled\",\n\t\t# \"dts-instance-sync-job-ssl-enabled\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-in-use-disk-encrypted\",\n\t\t\"ecs-instance-deletion-protection-enabled\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t# \"ecs-instance-monitor-enabled\",  # Commented: ROS ECS::Instance does not support CloudMonitorFlags property,\n\t\t\"ecs-instance-ram-role-attached\",\n\t\t# \"ecs-instance-status-no-stopped\",  # Commented: ROS ECS::Instance does not support Status property,\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t# \"ecs-security-group-not-used\",  # Commented: ROS ECS::SecurityGroup does not support Used property,\n\t\t\"ecs-snapshot-retention-days\",\n\t\t\"eip-attached\",\n\t\t\"elasticsearch-instance-enabled-data-node-encryption\",\n\t\t# \"elasticsearch-instance-snapshot-enabled\",  # Commented: ROS does not support AutoSnapshot property for ALIYUN::ElasticSearch::Instance,\n\t\t# \"elasticsearch-instance-used-https-protocol\",  # Commented: ROS ALIYUN::ElasticSearch::Instance does not support Protocol property,\n\t\t\"ess-scaling-group-attach-multi-switch\",\n\t\t\"fc-function-custom-domain-and-tls-enable\",\n\t\t\"fc-service-bind-role\",\n\t\t\"hbase-cluster-deletion-protection\",\n\t\t# \"mongodb-instance-backup-log-enabled\",  # Commented: ROS does not support ALIYUN::MongoDB::DBInstance resource type,\n\t\t\"mongodb-instance-log-audit\",\n\t\t\"mongodb-instance-multi-zone\",\n\t\t\"mongodb-instance-release-protection\",\n\t\t\"mse-cluster-config-auth-enabled\",\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t# \"oceanbase-instance-enabled-backup\",  # Commented: ROS does not support ALIYUN::OceanBase::DBInstance resource type,\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-policy-no-any-anonymous\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-zrs-enabled\",\n\t\t\"polardb-cluster-delete-protection-enabled\",\n\t\t\"polardb-cluster-enabled-ssl\",\n\t\t\"polardb-cluster-enabled-tde\",\n\t\t# \"polardb-cluster-log-backup-retention\",  # ROS does not support LogBackupRetentionPeriod property,\n\t\t\"polardb-cluster-multi-zone\",\n\t\t\"privatelink-servier-endpoint-multi-zone\",\n\t\t\"ram-user-ak-create-date-expired-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-last-login-expired-check\",\n\t\t\"ram-user-login-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"rds-instacne-delete-protection-enabled\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t\"rds-instance-enabled-ssl\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t# \"rds-instance-sql-collector-retention\",  # Commented: ROS RDS::DBInstance does not support SQLCollectorRetention property,\n\t\t\"rds-multi-az-support\",\n\t\t\"redis-instance-backup-log-enabled\",\n\t\t# \"redis-instance-enabled-audit-log\",  # Commented: ROS ALIYUN::REDIS::Instance does not support AuditLogConfig property,\n\t\t\"redis-instance-enabled-byok-tde\",\n\t\t\"redis-instance-enabled-ssl\",\n\t\t\"redis-instance-multi-zone\",\n\t\t\"redis-instance-release-protection\",\n\t\t\"slb-delete-protection-enabled\",\n\t\t\"slb-instance-log-enabled\",\n\t\t\"slb-instance-multi-zone\",\n\t\t\"slb-vserver-group-multi-zone\",\n\t\t\"sls-logstore-enabled-encrypt\",\n\t\t# \"vpn-ipsec-connection-encrypt-enable\",\n\t\t\"waf-instance-logging-enabled\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:iso-27001-compliance", Name: models.I18nString{"de": "ISO-27001 Sicherheitsmanagementsstandard Compliance", "en": "ISO-27001 Security Management Standard Compliance", "es": "Cumplimiento del Estándar de Gestión de Seguridad ISO-27001", "fr": "Conformité à la Norme de Gestion de la Sécurité ISO-27001", "ja": "ISO-27001 セキュリティ管理標準コンプライアンス", "pt": "Conformidade com o Padrão de Gestão de Segurança ISO-27001", "zh": "ISO-27001 安全管理标准合规包"}, Description: models.I18nString{"de": "Compliance-Paket für den ISO-27001 Informationssicherheitsmanagementsystem-Standard. Dieses Paket hilft Organisationen zu überprüfen, ob ihre Cloud-Ressourcen die ISO-27001 Sicherheitsanforderungen erfüllen.", "en": "Compliance pack for ISO-27001 Information Security Management System standard. This pack helps organizations verify their cloud resources meet ISO-27001 security requirements.", "es": "Paquete de cumplimiento para el estándar ISO-27001 del Sistema de Gestión de Seguridad de la Información. Este paquete ayuda a las organizaciones a verificar que sus recursos en la nube cumplan con los requisitos de seguridad ISO-27001.", "fr": "Pack de conformité pour la norme ISO-27001 du Système de Gestion de la Sécurité de l'Information. Ce pack aide les organisations à vérifier que leurs ressources cloud répondent aux exigences de sécurité ISO-27001.", "ja": "ISO-27001 情報セキュリティマネジメントシステム標準のコンプライアンスパック。このパックは、組織がクラウドリソースが ISO-27001 セキュリティ要件を満たしていることを確認するのに役立ちます。", "pt": "Pacote de conformidade para o padrão ISO-27001 do Sistema de Gestão de Segurança da Informação. Este pacote ajuda as organizações a verificar se seus recursos em nuvem atendem aos requisitos de segurança ISO-27001.", "zh": "ISO-27001 信息安全管理体系标准合规包。本合规包帮助组织验证其云资源是否符合 ISO-27001 安全要求。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-node-multi-zone", "rule:aliyun:ack-cluster-public-endpoint-check", "rule:aliyun:alb-all-listener-health-check-enabled", "rule:aliyun:alb-instance-multi-zone", "rule:aliyun:ecs-available-disk-encrypted", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-in-use-disk-encrypted", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-running-instance-no-public-ip", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:ecs-snapshot-policy-timepoints-check", "rule:aliyun:elasticsearch-instance-enabled-data-node-encryption", "rule:aliyun:ess-scaling-group-attach-multi-switch", "rule:aliyun:fc-function-custom-domain-and-tls-enable", "rule:aliyun:fc-service-internet-access-disable", "rule:aliyun:fc-service-vpc-binding", "rule:aliyun:kms-key-rotation-enabled", "rule:aliyun:kms-secret-rotation-enabled", "rule:aliyun:maxcompute-project-encryption-enabled", "rule:aliyun:nas-filesystem-encrypt-type-check", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-default-encryption-kms", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-delete-protection-enabled", "rule:aliyun:polardb-cluster-enabled-ssl", "rule:aliyun:polardb-cluster-enabled-tde", "rule:aliyun:polardb-cluster-maintain-time-check", "rule:aliyun:polardb-cluster-multi-zone", "rule:aliyun:ram-group-has-member-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-ak-create-date-expired-check", "rule:aliyun:ram-user-login-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:ram-user-no-policy-check", "rule:aliyun:ram-user-no-policy-check", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-instance-maintain-time-check", "rule:aliyun:rds-multi-az-support", "rule:aliyun:rds-public-access-check", "rule:aliyun:redis-instance-backup-log-enabled", "rule:aliyun:slb-delete-protection-enabled", "rule:aliyun:slb-instance-log-enabled", "rule:aliyun:slb-listener-https-enabled", "rule:aliyun:vpc-flow-logs-enabled", "rule:aliyun:vswitch-available-ip-count"}, FilePath: "aliyun/packs/iso-27001-compliance.rego", PackageName: "infraguard.packs.aliyun.iso_27001_compliance", Content: "package infraguard.packs.aliyun.iso_27001_compliance\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"iso-27001-compliance\",\n\t\"name\": {\n\t\t\"en\": \"ISO-27001 Security Management Standard Compliance\",\n\t\t\"zh\": \"ISO-27001 安全管理标准合规包\",\n\t\t\"ja\": \"ISO-27001 セキュリティ管理標準コンプライアンス\",\n\t\t\"de\": \"ISO-27001 Sicherheitsmanagementsstandard Compliance\",\n\t\t\"es\": \"Cumplimiento del Estándar de Gestión de Seguridad ISO-27001\",\n\t\t\"fr\": \"Conformité à la Norme de Gestion de la Sécurité ISO-27001\",\n\t\t\"pt\": \"Conformidade com o Padrão de Gestão de Segurança ISO-27001\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for ISO-27001 Information Security Management System standard. This pack helps organizations verify their cloud resources meet ISO-27001 security requirements.\",\n\t\t\"zh\": \"ISO-27001 信息安全管理体系标准合规包。本合规包帮助组织验证其云资源是否符合 ISO-27001 安全要求。\",\n\t\t\"ja\": \"ISO-27001 情報セキュリティマネジメントシステム標準のコンプライアンスパック。このパックは、組織がクラウドリソースが ISO-27001 セキュリティ要件を満たしていることを確認するのに役立ちます。\",\n\t\t\"de\": \"Compliance-Paket für den ISO-27001 Informationssicherheitsmanagementsystem-Standard. Dieses Paket hilft Organisationen zu überprüfen, ob ihre Cloud-Ressourcen die ISO-27001 Sicherheitsanforderungen erfüllen.\",\n\t\t\"es\": \"Paquete de cumplimiento para el estándar ISO-27001 del Sistema de Gestión de Seguridad de la Información. Este paquete ayuda a las organizaciones a verificar que sus recursos en la nube cumplan con los requisitos de seguridad ISO-27001.\",\n\t\t\"fr\": \"Pack de conformité pour la norme ISO-27001 du Système de Gestion de la Sécurité de l'Information. Ce pack aide les organisations à vérifier que leurs ressources cloud répondent aux exigences de sécurité ISO-27001.\",\n\t\t\"pt\": \"Pacote de conformidade para o padrão ISO-27001 do Sistema de Gestão de Segurança da Informação. Este pacote ajuda as organizações a verificar se seus recursos em nuvem atendem aos requisitos de segurança ISO-27001.\"\n\t},\n\t\"rules\": [\n\t\t# \"ack-cluster-deletion-protection-enabled\",\n\t\t# \"ack-cluster-node-monitorenabled\",\n\t\t\"ack-cluster-node-multi-zone\",\n\t\t\"ack-cluster-public-endpoint-check\",\n\t\t# \"adb-cluster-log-backup-enabled\",\n\t\t# \"adb-public-access-check\",  # Commented: ROS ADB::DBCluster does not support PublicEndpoint property,\n\t\t\"alb-all-listener-health-check-enabled\",\n\t\t\"alb-instance-multi-zone\",\n\t\t# \"api-gateway-group-log-enabled\",\n\t\t# \"cdn-domain-tls13-enabled\",\n\t\t# \"dts-instance-sync-job-ssl-enabled\",\n\t\t\"ecs-available-disk-encrypted\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-in-use-disk-encrypted\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t# \"ecs-instance-meta-data-mode-check\",\n\t\t# \"ecs-instance-monitor-enabled\",  # Commented: ROS ECS::Instance does not support CloudMonitorFlags property,\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t\"ecs-running-instance-no-public-ip\",\n\t\t# \"ecs-running-instances-in-vpc\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"ecs-snapshot-policy-timepoints-check\",\n\t\t\"elasticsearch-instance-enabled-data-node-encryption\",\n\t\t# \"elasticsearch-instance-enabled-public-check\",\n\t\t# \"ess-group-health-check\",\n\t\t\"ess-scaling-group-attach-multi-switch\",\n\t\t\"fc-function-custom-domain-and-tls-enable\",\n\t\t# \"fc-function-settings-check\",\n\t\t\"fc-service-internet-access-disable\",\n\t\t\"fc-service-vpc-binding\",\n\t\t\"kms-key-rotation-enabled\",\n\t\t# \"kms-key-state-not-pending-deletion\",  # Commented: ROS KMS::Key does not support KeyState property (runtime state only),\n\t\t# \"kms-secret-last-rotation-date-check\",\n\t\t\"kms-secret-rotation-enabled\",\n\t\t\"maxcompute-project-encryption-enabled\",\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t\"nas-filesystem-encrypt-type-check\",\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-default-encryption-kms\",\n\t\t\"oss-zrs-enabled\",\n\t\t# \"ots-instance-all-table-encrypted\",  # ROS template does not support SSESpecification property,\n\t\t# \"polardb-cluster-address-no-public\",\n\t\t\"polardb-cluster-delete-protection-enabled\",\n\t\t# \"polardb-cluster-enabled-auditing\",  # ROS does not support SQLCollectorStatus property,\n\t\t\"polardb-cluster-enabled-ssl\",\n\t\t\"polardb-cluster-enabled-tde\",\n\t\t# \"polardb-cluster-level-one-backup-retention\",\n\t\t# \"polardb-cluster-log-backup-retention\",  # ROS does not support LogBackupRetentionPeriod property,\n\t\t\"polardb-cluster-maintain-time-check\",\n\t\t\"polardb-cluster-multi-zone\",\n\t\t# \"polardb-public-access-check\",\n\t\t\"ram-group-has-member-check\",\n\t\t# \"ram-group-in-use-check\",\n\t\t# \"ram-policy-in-use-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-ak-create-date-expired-check\",\n\t\t\"ram-user-login-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"ram-user-no-policy-check\",\n\t\t\"ram-user-no-policy-check\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t\"rds-instance-maintain-time-check\",\n\t\t\"rds-multi-az-support\",\n\t\t\"rds-public-access-check\",\n\t\t\"redis-instance-backup-log-enabled\",\n\t\t# \"resource-group-default-used-check\",\n\t\t# \"resources-inherit-resourcegroup-from-ecs-instance\",\n\t\t# \"slb-aliyun-certificate-required\",\n\t\t\"slb-delete-protection-enabled\",\n\t\t\"slb-instance-log-enabled\",\n\t\t\"slb-listener-https-enabled\",\n\t\t# \"ssl-certificate-expired-check\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t# \"vpn-ipsec-connection-status-check\",\n\t\t\"vswitch-available-ip-count\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:mlps-level-2-pre-check-compliance-pack", Name: models.I18nString{"de": "MLPS Level 2 Vorprüfung Compliance-Paket", "en": "MLPS Level 2 Pre-check Compliance Pack", "es": "Paquete de Cumplimiento de Verificación Previa MLPS Nivel 2", "fr": "Pack de Conformité de Vérification Préalable MLPS Niveau 2", "ja": "MLPS レベル 2 事前チェックコンプライアンスパック", "pt": "Pacote de Conformidade de Verificação Prévia MLPS Nível 2", "zh": "等保二级预检合规包"}, Description: models.I18nString{"de": "Compliance-Paket für MLPS Level 2 Vorprüfung", "en": "Compliance pack for MLPS level 2 pre-check", "es": "Paquete de cumplimiento para verificación previa MLPS nivel 2", "fr": "Pack de conformité pour vérification préalable MLPS niveau 2", "ja": "MLPS レベル 2 事前チェック用のコンプライアンスパック", "pt": "Pacote de conformidade para verificação prévia MLPS nível 2", "zh": "等保二级预检合规包"}, RuleIDs: []string{"rule:aliyun:actiontrail-trail-intact-enabled", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:eip-bandwidth-limit", "rule:aliyun:elasticsearch-public-and-any-ip-access-check", "rule:aliyun:oss-bucket-authorize-specified-ip", "rule:aliyun:oss-bucket-policy-no-any-anonymous", "rule:aliyun:ram-group-has-member-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-last-login-expired-check", "rule:aliyun:ram-user-login-check", "rule:aliyun:ram-user-no-policy-check", "rule:aliyun:rds-instance-enabled-auditing", "rule:aliyun:rds-public-connection-and-any-ip-access-check", "rule:aliyun:redis-instance-open-auth-mode", "rule:aliyun:security-center-version-check", "rule:aliyun:sg-public-access-check", "rule:aliyun:slb-acl-public-access-check", "rule:aliyun:slb-loadbalancer-bandwidth-limit", "rule:aliyun:use-waf-instance-for-security-protection", "rule:aliyun:vpc-flow-logs-enabled", "rule:aliyun:vpc-network-acl-risky-ports-check"}, FilePath: "aliyun/packs/mlps-level-2-pre-check-compliance-pack.rego", PackageName: "infraguard.packs.aliyun.mlps_level_2_pre_check_compliance_pack", Content: "package infraguard.packs.aliyun.mlps_level_2_pre_check_compliance_pack\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"mlps-level-2-pre-check-compliance-pack\",\n\t\"name\": {\n\t\t\"en\": \"MLPS Level 2 Pre-check Compliance Pack\",\n\t\t\"zh\": \"等保二级预检合规包\",\n\t\t\"ja\": \"MLPS レベル 2 事前チェックコンプライアンスパック\",\n\t\t\"de\": \"MLPS Level 2 Vorprüfung Compliance-Paket\",\n\t\t\"es\": \"Paquete de Cumplimiento de Verificación Previa MLPS Nivel 2\",\n\t\t\"fr\": \"Pack de Conformité de Vérification Préalable MLPS Niveau 2\",\n\t\t\"pt\": \"Pacote de Conformidade de Verificação Prévia MLPS Nível 2\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for MLPS level 2 pre-check\",\n\t\t\"zh\": \"等保二级预检合规包\",\n\t\t\"ja\": \"MLPS レベル 2 事前チェック用のコンプライアンスパック\",\n\t\t\"de\": \"Compliance-Paket für MLPS Level 2 Vorprüfung\",\n\t\t\"es\": \"Paquete de cumplimiento para verificación previa MLPS nivel 2\",\n\t\t\"fr\": \"Pack de conformité pour vérification préalable MLPS niveau 2\",\n\t\t\"pt\": \"Pacote de conformidade para verificação prévia MLPS nível 2\"\n\t},\n\t\"rules\": [\n\t\t\"actiontrail-trail-intact-enabled\",\n\t\t# \"adb-cluster-audit-log-enabled\",  # Commented: ROS ADB::DBCluster does not support AuditLog property,\n\t\t# \"alb-all-listener-enabled-acl\",  # Commented: ROS ALB::Listener does not support AclConfig property,\n\t\t# \"cen-cross-region-bandwidth-check\",\n\t\t# \"cr-instance-any-ip-access-check\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"eip-bandwidth-limit\",\n\t\t\"elasticsearch-public-and-any-ip-access-check\",\n\t\t# \"nat-risk-ports-check\",\n\t\t# \"natgateway-snat-eip-bandwidth-check\",\n\t\t\"oss-bucket-authorize-specified-ip\",\n\t\t\"oss-bucket-policy-no-any-anonymous\",\n\t\t\"ram-group-has-member-check\",\n\t\t# \"ram-password-max-age-check\",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,\n\t\t# \"ram-password-max-login-attemps-check\",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,\n\t\t# \"ram-password-require-char-check\",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,\n\t\t# \"ram-policy-in-use-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-last-login-expired-check\",\n\t\t\"ram-user-login-check\",\n\t\t\"ram-user-no-policy-check\",\n\t\t\"rds-instance-enabled-auditing\",\n\t\t\"rds-public-connection-and-any-ip-access-check\",\n\t\t\"redis-instance-open-auth-mode\",\n\t\t# \"security-center-defense-config-check\",\n\t\t\"security-center-version-check\",\n\t\t\"sg-public-access-check\",\n\t\t\"slb-acl-public-access-check\",\n\t\t# \"slb-all-listener-enabled-acl\",\n\t\t\"slb-loadbalancer-bandwidth-limit\",\n\t\t# \"use-cloud-fire-wall-for-security-protection\",\n\t\t# \"use-ddos-instance-for-security-protection\",\n\t\t\"use-waf-instance-for-security-protection\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t\"vpc-network-acl-risky-ports-check\",\n\t\t# \"waf3-instance-enabled-specified-defense-rules\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:mlps-level-3-pre-check-compliance-pack", Name: models.I18nString{"de": "MLPS Level 3 Vorprüfung Compliance-Paket", "en": "MLPS Level 3 Pre-check Compliance Pack", "es": "Paquete de Cumplimiento de Verificación Previa MLPS Nivel 3", "fr": "Pack de Conformité de Vérification Préalable MLPS Niveau 3", "ja": "MLPS レベル 3 事前チェックコンプライアンスパック", "pt": "Pacote de Conformidade de Verificação Prévia MLPS Nível 3", "zh": "等保三级预检合规包"}, Description: models.I18nString{"de": "Compliance-Paket für MLPS Level 3 Vorprüfungsanforderungen für Alibaba Cloud Ressourcen.", "en": "Compliance pack for MLPS level 3 pre-check requirements on Aliyun resources.", "es": "Paquete de cumplimiento para requisitos de verificación previa MLPS nivel 3 en recursos de Aliyun.", "fr": "Pack de conformité pour les exigences de vérification préalable MLPS niveau 3 sur les ressources Aliyun.", "ja": "Alibaba Cloud リソースに対する MLPS レベル 3 事前チェック要件のコンプライアンスパック。", "pt": "Pacote de conformidade para requisitos de verificação prévia MLPS nível 3 em recursos do Aliyun.", "zh": "基于等保三级的部分要求，对阿里云上资源的合规性做检测。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-encryption-enabled", "rule:aliyun:ack-cluster-node-multi-zone", "rule:aliyun:ack-cluster-public-endpoint-check", "rule:aliyun:actiontrail-trail-intact-enabled", "rule:aliyun:alb-instance-multi-zone", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-in-use-disk-encrypted", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-instances-in-vpc", "rule:aliyun:ecs-running-instance-no-public-ip", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:eip-bandwidth-limit", "rule:aliyun:elasticsearch-instance-multi-zone", "rule:aliyun:elasticsearch-public-and-any-ip-access-check", "rule:aliyun:firewall-asset-open-protect", "rule:aliyun:mongodb-instance-multi-zone", "rule:aliyun:nas-filesystem-mount-target-access-group-check", "rule:aliyun:oss-bucket-authorize-specified-ip", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-bucket-policy-no-any-anonymous", "rule:aliyun:oss-bucket-policy-outside-organization-check", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-default-encryption-kms", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-enabled-ssl", "rule:aliyun:polardb-cluster-enabled-tde", "rule:aliyun:polardb-cluster-multi-zone", "rule:aliyun:polardb-public-and-any-ip-access-check", "rule:aliyun:ram-group-has-member-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-last-login-expired-check", "rule:aliyun:ram-user-login-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:ram-user-no-policy-check", "rule:aliyun:rds-instance-enabled-auditing", "rule:aliyun:rds-instance-enabled-disk-encryption", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-instance-has-guard-instance", "rule:aliyun:rds-instances-in-vpc", "rule:aliyun:rds-multi-az-support", "rule:aliyun:rds-public-connection-and-any-ip-access-check", "rule:aliyun:redis-instance-multi-zone", "rule:aliyun:redis-instance-open-auth-mode", "rule:aliyun:redis-public-and-any-ip-access-check", "rule:aliyun:root-mfa-check", "rule:aliyun:security-center-version-check", "rule:aliyun:sg-public-access-check", "rule:aliyun:slb-acl-public-access-check", "rule:aliyun:slb-all-listener-servers-multi-zone", "rule:aliyun:slb-all-listenter-tls-policy-check", "rule:aliyun:slb-listener-risk-ports-check", "rule:aliyun:slb-loadbalancer-bandwidth-limit", "rule:aliyun:sls-logstore-enabled-encrypt", "rule:aliyun:use-waf-instance-for-security-protection", "rule:aliyun:vpc-flow-logs-enabled", "rule:aliyun:vpc-network-acl-risky-ports-check"}, FilePath: "aliyun/packs/mlps-level-3-pre-check-compliance-pack.rego", PackageName: "infraguard.packs.aliyun.mlps_level_3_pre_check_compliance_pack", Content: "package infraguard.packs.aliyun.mlps_level_3_pre_check_compliance_pack\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"mlps-level-3-pre-check-compliance-pack\",\n\t\"name\": {\n\t\t\"en\": \"MLPS Level 3 Pre-check Compliance Pack\",\n\t\t\"zh\": \"等保三级预检合规包\",\n\t\t\"ja\": \"MLPS レベル 3 事前チェックコンプライアンスパック\",\n\t\t\"de\": \"MLPS Level 3 Vorprüfung Compliance-Paket\",\n\t\t\"es\": \"Paquete de Cumplimiento de Verificación Previa MLPS Nivel 3\",\n\t\t\"fr\": \"Pack de Conformité de Vérification Préalable MLPS Niveau 3\",\n\t\t\"pt\": \"Pacote de Conformidade de Verificação Prévia MLPS Nível 3\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for MLPS level 3 pre-check requirements on Aliyun resources.\",\n\t\t\"zh\": \"基于等保三级的部分要求，对阿里云上资源的合规性做检测。\",\n\t\t\"ja\": \"Alibaba Cloud リソースに対する MLPS レベル 3 事前チェック要件のコンプライアンスパック。\",\n\t\t\"de\": \"Compliance-Paket für MLPS Level 3 Vorprüfungsanforderungen für Alibaba Cloud Ressourcen.\",\n\t\t\"es\": \"Paquete de cumplimiento para requisitos de verificación previa MLPS nivel 3 en recursos de Aliyun.\",\n\t\t\"fr\": \"Pack de conformité pour les exigences de vérification préalable MLPS niveau 3 sur les ressources Aliyun.\",\n\t\t\"pt\": \"Pacote de conformidade para requisitos de verificação prévia MLPS nível 3 em recursos do Aliyun.\"\n\t},\n\t\"rules\": [\n\t\t\"ack-cluster-encryption-enabled\",\n\t\t\"ack-cluster-node-multi-zone\",\n\t\t\"ack-cluster-public-endpoint-check\",\n\t\t\"actiontrail-trail-intact-enabled\",\n\t\t# \"adb-cluster-audit-log-enabled\",  # Commented: ROS ADB::DBCluster does not support AuditLog property,\n\t\t# \"alb-all-listener-enabled-acl\",  # Commented: ROS ALB::Listener does not support AclConfig property,\n\t\t\"alb-instance-multi-zone\",\n\t\t# \"api-gateway-group-https-policy-check\",\n\t\t# \"cdn-domain-tls13-enabled\",\n\t\t# \"cen-cross-region-bandwidth-check\",\n\t\t# \"cr-instance-any-ip-access-check\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-in-use-disk-encrypted\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t\"ecs-instances-in-vpc\",\n\t\t\"ecs-running-instance-no-public-ip\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"eip-bandwidth-limit\",\n\t\t\"elasticsearch-instance-multi-zone\",\n\t\t# \"elasticsearch-instance-snapshot-enabled\",  # Commented: ROS does not support AutoSnapshot property for ALIYUN::ElasticSearch::Instance,\n\t\t\"elasticsearch-public-and-any-ip-access-check\",\n\t\t\"firewall-asset-open-protect\",\n\t\t# \"mongodb-instance-backup-log-enabled\",  # Commented: ROS does not support ALIYUN::MongoDB::DBInstance resource type,\n\t\t\"mongodb-instance-multi-zone\",\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t\"nas-filesystem-mount-target-access-group-check\",\n\t\t# \"nat-risk-ports-check\",\n\t\t# \"natgateway-snat-eip-bandwidth-check\",\n\t\t\"oss-bucket-authorize-specified-ip\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t\"oss-bucket-policy-no-any-anonymous\",\n\t\t\"oss-bucket-policy-outside-organization-check\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t# \"oss-bucket-referer-enabled\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-default-encryption-kms\",\n\t\t\"oss-zrs-enabled\",\n\t\t\"polardb-cluster-enabled-ssl\",\n\t\t\"polardb-cluster-enabled-tde\",\n\t\t# \"polardb-cluster-level-two-backup-retention\",\n\t\t\"polardb-cluster-multi-zone\",\n\t\t\"polardb-public-and-any-ip-access-check\",\n\t\t\"ram-group-has-member-check\",\n\t\t# \"ram-password-max-age-check\",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,\n\t\t# \"ram-password-max-login-attemps-check\",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,\n\t\t# \"ram-password-require-char-check\",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,\n\t\t# \"ram-policy-in-use-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-last-login-expired-check\",\n\t\t\"ram-user-login-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"ram-user-no-policy-check\",\n\t\t\"rds-instance-enabled-auditing\",\n\t\t\"rds-instance-enabled-disk-encryption\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t\"rds-instance-has-guard-instance\",\n\t\t# \"rds-instance-tls-version-check\",\n\t\t\"rds-instances-in-vpc\",\n\t\t\"rds-multi-az-support\",\n\t\t\"rds-public-connection-and-any-ip-access-check\",\n\t\t# \"redis-instance-enabled-tde\",\n\t\t# \"redis-instance-in-vpc\",\n\t\t\"redis-instance-multi-zone\",\n\t\t\"redis-instance-open-auth-mode\",\n\t\t\"redis-public-and-any-ip-access-check\",\n\t\t\"root-mfa-check\",\n\t\t# \"security-center-defense-config-check\",\n\t\t# \"security-center-notice-config-check\",\n\t\t\"security-center-version-check\",\n\t\t\"sg-public-access-check\",\n\t\t\"slb-acl-public-access-check\",\n\t\t# \"slb-all-listener-enabled-acl\",\n\t\t\"slb-all-listener-servers-multi-zone\",\n\t\t\"slb-all-listenter-tls-policy-check\",\n\t\t\"slb-listener-risk-ports-check\",\n\t\t\"slb-loadbalancer-bandwidth-limit\",\n\t\t# \"slb-no-public-ip\",\n\t\t\"sls-logstore-enabled-encrypt\",\n\t\t# \"use-cloud-fire-wall-for-security-protection\",\n\t\t# \"use-ddos-instance-for-security-protection\",\n\t\t\"use-waf-instance-for-security-protection\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t\"vpc-network-acl-risky-ports-check\",\n\t\t# \"waf3-instance-enabled-specified-defense-rules\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:multi-zone-architecture-best-practice", Name: models.I18nString{"de": "Multi-Zone-Architektur Best Practices", "en": "Multi-zone Architecture Best Practice", "es": "Mejores Prácticas de Arquitectura Multi-zona", "fr": "Meilleures Pratiques d'Architecture Multi-zones", "ja": "マルチゾーンアーキテクチャのベストプラクティス", "pt": "Melhores Práticas de Arquitetura Multi-zona", "zh": "多可用区架构最佳实践"}, Description: models.I18nString{"de": "Best Practices für hochverfügbare Architekturen von Produkten wie relationalen Datenbanken, NoSQL-Datenbanken und Load Balancern, um Disaster-Recovery-Fähigkeiten auf Verfügbarkeitszonenebene aufzubauen und Service-Verfügbarkeit und Datenzuverlässigkeit sicherzustellen.", "en": "Best practices for high availability architecture of products such as relational databases, NoSQL databases, and load balancers to build availability zone-level disaster recovery capabilities and ensure service availability and data reliability.", "es": "Mejores prácticas para arquitecturas de alta disponibilidad de productos como bases de datos relacionales, bases de datos NoSQL y equilibradores de carga para construir capacidades de recuperación ante desastres a nivel de zona de disponibilidad y garantizar la disponibilidad del servicio y la confiabilidad de los datos.", "fr": "Meilleures pratiques pour les architectures haute disponibilité de produits tels que les bases de données relationnelles, les bases de données NoSQL et les équilibreurs de charge afin de construire des capacités de récupération d'urgence au niveau de la zone de disponibilité et garantir la disponibilité du service et la fiabilité des données.", "ja": "リレーショナルデータベース、NoSQL データベース、ロードバランサーなどの製品の高可用性アーキテクチャのベストプラクティス。可用性ゾーンレベルの災害復旧機能を構築し、サービスの可用性とデータの信頼性を確保します。", "pt": "Melhores práticas para arquitetura de alta disponibilidade de produtos como bancos de dados relacionais, bancos de dados NoSQL e balanceadores de carga para construir capacidades de recuperação de desastres em nível de zona de disponibilidade e garantir disponibilidade de serviço e confiabilidade de dados.", "zh": "关系型数据库、NoSQL 数据库、负载均衡等产品高可用架构最佳实践，构建可用区级别的容灾能力，保障服务可用性和数据可靠性。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-node-multi-zone", "rule:aliyun:acs-cluster-node-multi-zone", "rule:aliyun:adb-cluster-multi-zone", "rule:aliyun:alb-instance-multi-zone", "rule:aliyun:alb-server-group-multi-zone", "rule:aliyun:apigateway-instance-multi-zone", "rule:aliyun:bastionhost-instance-spec-check", "rule:aliyun:cdn-domain-multiple-origin-servers", "rule:aliyun:clickhouse-dbcluster-multi-zone", "rule:aliyun:cr-instance-multi-zone", "rule:aliyun:dcdn-domain-multiple-origin-servers", "rule:aliyun:ecs-disk-regional-auto-check", "rule:aliyun:elasticsearch-instance-multi-zone", "rule:aliyun:ess-scaling-group-attach-multi-switch", "rule:aliyun:gpdb-instance-multi-zone", "rule:aliyun:gwlb-loadbalancer-multi-zone", "rule:aliyun:hbase-cluster-multi-zone", "rule:aliyun:kafka-instance-multi-zone", "rule:aliyun:kms-instance-multi-zone", "rule:aliyun:lindorm-instance-multi-zone", "rule:aliyun:mongodb-instance-multi-zone", "rule:aliyun:mse-cluster-multi-availability-area-architecture-check", "rule:aliyun:mse-gateway-multi-availability-area-architecture-check", "rule:aliyun:nlb-loadbalancer-multi-zone", "rule:aliyun:nlb-server-group-multi-zone", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-multi-zone", "rule:aliyun:polardb-x2-instance-multi-zone", "rule:aliyun:privatelink-server-endpoint-multi-zone", "rule:aliyun:rds-multi-az-support", "rule:aliyun:redis-instance-multi-zone", "rule:aliyun:rocketmq-v5-instance-multi-zone", "rule:aliyun:slb-all-listener-servers-multi-zone", "rule:aliyun:slb-instance-multi-zone", "rule:aliyun:sls-project-multi-zone", "rule:aliyun:transit-router-vpc-attachment-multi-zone", "rule:aliyun:vpn-connection-master-slave-established", "rule:aliyun:vpn-gateway-multi-zone"}, FilePath: "aliyun/packs/multi-zone-architecture-best-practice.rego", PackageName: "infraguard.packs.aliyun.multi_zone_architecture_best_practice", Content: "package infraguard.packs.aliyun.multi_zone_architecture_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"multi-zone-architecture-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Multi-zone Architecture Best Practice\",\n\t\t\"zh\": \"多可用区架构最佳实践\",\n\t\t\"ja\": \"マルチゾーンアーキテクチャのベストプラクティス\",\n\t\t\"de\": \"Multi-Zone-Architektur Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Arquitectura Multi-zona\",\n\t\t\"fr\": \"Meilleures Pratiques d'Architecture Multi-zones\",\n\t\t\"pt\": \"Melhores Práticas de Arquitetura Multi-zona\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for high availability architecture of products such as relational databases, NoSQL databases, and load balancers to build availability zone-level disaster recovery capabilities and ensure service availability and data reliability.\",\n\t\t\"zh\": \"关系型数据库、NoSQL 数据库、负载均衡等产品高可用架构最佳实践，构建可用区级别的容灾能力，保障服务可用性和数据可靠性。\",\n\t\t\"ja\": \"リレーショナルデータベース、NoSQL データベース、ロードバランサーなどの製品の高可用性アーキテクチャのベストプラクティス。可用性ゾーンレベルの災害復旧機能を構築し、サービスの可用性とデータの信頼性を確保します。\",\n\t\t\"de\": \"Best Practices für hochverfügbare Architekturen von Produkten wie relationalen Datenbanken, NoSQL-Datenbanken und Load Balancern, um Disaster-Recovery-Fähigkeiten auf Verfügbarkeitszonenebene aufzubauen und Service-Verfügbarkeit und Datenzuverlässigkeit sicherzustellen.\",\n\t\t\"es\": \"Mejores prácticas para arquitecturas de alta disponibilidad de productos como bases de datos relacionales, bases de datos NoSQL y equilibradores de carga para construir capacidades de recuperación ante desastres a nivel de zona de disponibilidad y garantizar la disponibilidad del servicio y la confiabilidad de los datos.\",\n\t\t\"fr\": \"Meilleures pratiques pour les architectures haute disponibilité de produits tels que les bases de données relationnelles, les bases de données NoSQL et les équilibreurs de charge afin de construire des capacités de récupération d'urgence au niveau de la zone de disponibilité et garantir la disponibilité du service et la fiabilité des données.\",\n\t\t\"pt\": \"Melhores práticas para arquitetura de alta disponibilidade de produtos como bancos de dados relacionais, bancos de dados NoSQL e balanceadores de carga para construir capacidades de recuperação de desastres em nível de zona de disponibilidade e garantir disponibilidade de serviço e confiabilidade de dados.\"\n\t},\n\t\"rules\": [\n\t\t\"ack-cluster-node-multi-zone\",\n\t\t\"acs-cluster-node-multi-zone\",\n\t\t\"adb-cluster-multi-zone\",\n\t\t\"alb-instance-multi-zone\",\n\t\t\"alb-server-group-multi-zone\",\n\t\t\"apigateway-instance-multi-zone\",\n\t\t\"bastionhost-instance-spec-check\",\n\t\t\"cdn-domain-multiple-origin-servers\",\n\t\t\"clickhouse-dbcluster-multi-zone\",\n\t\t\"cr-instance-multi-zone\",\n\t\t# \"csg-gateway-multi-zone\",\n\t\t\"dcdn-domain-multiple-origin-servers\",\n\t\t\"ecs-disk-regional-auto-check\",\n\t\t\"elasticsearch-instance-multi-zone\",\n\t\t\"ess-scaling-group-attach-multi-switch\",\n\t\t# \"expressconnect-physicalconnection-multi-zone\",\n\t\t\"gpdb-instance-multi-zone\",\n\t\t\"gwlb-loadbalancer-multi-zone\",\n\t\t\"hbase-cluster-multi-zone\",\n\t\t\"kafka-instance-multi-zone\",\n\t\t\"kms-instance-multi-zone\",\n\t\t\"lindorm-instance-multi-zone\",\n\t\t# \"maxcompute-project-multi-zone\",\n\t\t\"mongodb-instance-multi-zone\",\n\t\t\"mse-cluster-multi-availability-area-architecture-check\",\n\t\t\"mse-gateway-multi-availability-area-architecture-check\",\n\t\t\"nlb-loadbalancer-multi-zone\",\n\t\t\"nlb-server-group-multi-zone\",\n\t\t\"oss-zrs-enabled\",\n\t\t# \"ots-instance-multi-zone\",\n\t\t\"polardb-cluster-multi-zone\",\n\t\t\"polardb-x2-instance-multi-zone\",\n\t\t\"privatelink-server-endpoint-multi-zone\",\n\t\t\"rds-multi-az-support\",\n\t\t# \"realtimecompute-vvpinstance-multi-zone\",\n\t\t\"redis-instance-multi-zone\",\n\t\t\"rocketmq-v5-instance-multi-zone\",\n\t\t\"slb-all-listener-servers-multi-zone\",\n\t\t\"slb-instance-multi-zone\",\n\t\t\"sls-project-multi-zone\",\n\t\t\"transit-router-vpc-attachment-multi-zone\",\n\t\t\"vpn-connection-master-slave-established\",\n\t\t\"vpn-gateway-multi-zone\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:network-data-security-best-practice", Name: models.I18nString{"de": "Netzwerk- und Datensicherheit Best Practices", "en": "Network and Data Security Best Practice", "es": "Mejores Prácticas de Seguridad de Red y Datos", "fr": "Meilleures Pratiques de Sécurité Réseau et Données", "ja": "ネットワークおよびデータセキュリティのベストプラクティス", "pt": "Melhores Práticas de Segurança de Rede e Dados", "zh": "网络及数据安全最佳实践"}, Description: models.I18nString{"de": "Best Practices für Netzwerk- und Datensicherheit, einschließlich ECS-Instanz-Sicherheit, OSS-Bucket-Verschlüsselung und Zugriffskontrolle, RDS-Instanz-Sicherheitskonfigurationen.", "en": "Best practices for network and data security including ECS instance security, OSS bucket encryption and access control, RDS instance security configurations.", "es": "Mejores prácticas para la seguridad de red y datos, incluyendo seguridad de instancias ECS, cifrado y control de acceso de buckets OSS, configuraciones de seguridad de instancias RDS.", "fr": "Meilleures pratiques pour la sécurité réseau et des données, incluant la sécurité des instances ECS, le chiffrement et le contrôle d'accès des buckets OSS, les configurations de sécurité des instances RDS.", "ja": "ECS インスタンスセキュリティ、OSS バケットの暗号化とアクセス制御、RDS インスタンスのセキュリティ設定を含む、ネットワークおよびデータセキュリティのベストプラクティス。", "pt": "Melhores práticas para segurança de rede e dados, incluindo segurança de instâncias ECS, criptografia e controle de acesso de buckets OSS, configurações de segurança de instâncias RDS.", "zh": "网络及数据安全最佳实践，包括 ECS 实例安全、OSS 存储空间加密和访问控制、RDS 实例安全配置。"}, RuleIDs: []string{"rule:aliyun:ecs-in-use-disk-encrypted", "rule:aliyun:ecs-instances-in-vpc", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-server-side-encryption-enabled", "rule:aliyun:oss-encryption-byok-check", "rule:aliyun:rds-public-access-check"}, FilePath: "aliyun/packs/network-data-security-best-practice.rego", PackageName: "infraguard.packs.aliyun.network_data_security_best_practice", Content: "# Network and Data Security Best Practice Pack\n# Best practices for network and data security including encryption, access control, and secure configurations.\npackage infraguard.packs.aliyun.network_data_security_best_practice\n\nimport rego.v1\n\n# Pack metadata with i18n support\npack_meta := {\n\t\"id\": \"network-data-security-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Network and Data Security Best Practice\",\n\t\t\"zh\": \"网络及数据安全最佳实践\",\n\t\t\"ja\": \"ネットワークおよびデータセキュリティのベストプラクティス\",\n\t\t\"de\": \"Netzwerk- und Datensicherheit Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Seguridad de Red y Datos\",\n\t\t\"fr\": \"Meilleures Pratiques de Sécurité Réseau et Données\",\n\t\t\"pt\": \"Melhores Práticas de Segurança de Rede e Dados\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for network and data security including ECS instance security, OSS bucket encryption and access control, RDS instance security configurations.\",\n\t\t\"zh\": \"网络及数据安全最佳实践，包括 ECS 实例安全、OSS 存储空间加密和访问控制、RDS 实例安全配置。\",\n\t\t\"ja\": \"ECS インスタンスセキュリティ、OSS バケットの暗号化とアクセス制御、RDS インスタンスのセキュリティ設定を含む、ネットワークおよびデータセキュリティのベストプラクティス。\",\n\t\t\"de\": \"Best Practices für Netzwerk- und Datensicherheit, einschließlich ECS-Instanz-Sicherheit, OSS-Bucket-Verschlüsselung und Zugriffskontrolle, RDS-Instanz-Sicherheitskonfigurationen.\",\n\t\t\"es\": \"Mejores prácticas para la seguridad de red y datos, incluyendo seguridad de instancias ECS, cifrado y control de acceso de buckets OSS, configuraciones de seguridad de instancias RDS.\",\n\t\t\"fr\": \"Meilleures pratiques pour la sécurité réseau et des données, incluant la sécurité des instances ECS, le chiffrement et le contrôle d'accès des buckets OSS, les configurations de sécurité des instances RDS.\",\n\t\t\"pt\": \"Melhores práticas para segurança de rede e dados, incluindo segurança de instâncias ECS, criptografia e controle de acesso de buckets OSS, configurações de segurança de instâncias RDS.\"\n\t},\n\t\"rules\": [\n\t\t\"ecs-in-use-disk-encrypted\",\n\t\t\"ecs-instances-in-vpc\",\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-server-side-encryption-enabled\",\n\t\t\"oss-encryption-byok-check\",\n\t\t\"rds-public-access-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:nist800-53-compliance", Name: models.I18nString{"de": "NIST 800-53 Compliance", "en": "NIST 800-53 Compliance", "es": "Cumplimiento NIST 800-53", "fr": "Conformité NIST 800-53", "ja": "NIST 800-53 コンプライアンス", "pt": "Conformidade NIST 800-53", "zh": "NIST800-53 合规包"}, Description: models.I18nString{"de": "Compliance-Paket für NIST 800-53 Sicherheits- und Datenschutzkontrollen. Dieses Paket hilft Organisationen zu überprüfen, ob ihre Cloud-Ressourcen die NIST 800-53 Sicherheitskontrollanforderungen erfüllen.", "en": "Compliance pack for NIST 800-53 Security and Privacy Controls. This pack helps organizations verify their cloud resources meet NIST 800-53 security control requirements.", "es": "Paquete de cumplimiento para los Controles de Seguridad y Privacidad NIST 800-53. Este paquete ayuda a las organizaciones a verificar que sus recursos en la nube cumplan con los requisitos de control de seguridad NIST 800-53.", "fr": "Pack de conformité pour les Contrôles de Sécurité et de Confidentialité NIST 800-53. Ce pack aide les organisations à vérifier que leurs ressources cloud répondent aux exigences de contrôle de sécurité NIST 800-53.", "ja": "NIST 800-53 セキュリティおよびプライバシー制御のコンプライアンスパック。このパックは、組織がクラウドリソースが NIST 800-53 セキュリティ制御要件を満たしていることを確認するのに役立ちます。", "pt": "Pacote de conformidade para Controles de Segurança e Privacidade NIST 800-53. Este pacote ajuda as organizações a verificar se seus recursos em nuvem atendem aos requisitos de controle de segurança NIST 800-53.", "zh": "NIST 800-53 安全与隐私控制合规包。本合规包帮助组织验证其云资源是否符合 NIST 800-53 安全控制要求。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-encryption-enabled", "rule:aliyun:ack-cluster-public-endpoint-check", "rule:aliyun:ack-cluster-supported-version", "rule:aliyun:ack-cluster-upgrade-latest-version", "rule:aliyun:alb-instance-multi-zone", "rule:aliyun:api-gateway-group-enabled-ssl", "rule:aliyun:cr-repository-immutablity-enable", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-in-use-disk-encrypted", "rule:aliyun:ecs-instance-not-bind-key-pair", "rule:aliyun:ecs-instance-ram-role-attached", "rule:aliyun:ecs-security-group-white-list-port-check", "rule:aliyun:eip-attached", "rule:aliyun:elasticsearch-instance-enabled-data-node-encryption", "rule:aliyun:elasticsearch-public-and-any-ip-access-check", "rule:aliyun:ess-scaling-configuration-enabled-internet-check", "rule:aliyun:ess-scaling-group-attach-multi-switch", "rule:aliyun:fc-service-internet-access-disable", "rule:aliyun:fc-service-vpc-binding", "rule:aliyun:firewall-asset-open-protect", "rule:aliyun:kms-secret-rotation-enabled", "rule:aliyun:mongodb-instance-log-audit", "rule:aliyun:nas-filesystem-encrypt-type-check", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-bucket-policy-no-any-anonymous", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-server-side-encryption-enabled", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-default-encryption-kms", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-multi-zone", "rule:aliyun:ram-group-has-member-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:rds-instance-enabled-disk-encryption", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-multi-az-support", "rule:aliyun:rds-public-connection-and-any-ip-access-check", "rule:aliyun:redis-instance-backup-log-enabled", "rule:aliyun:slb-all-listener-servers-multi-zone", "rule:aliyun:slb-all-listenter-tls-policy-check", "rule:aliyun:slb-instance-log-enabled", "rule:aliyun:slb-listener-https-enabled", "rule:aliyun:vpc-flow-logs-enabled", "rule:aliyun:vpc-network-acl-risky-ports-check"}, FilePath: "aliyun/packs/nist800-53-compliance.rego", PackageName: "infraguard.packs.aliyun.nist800_53_compliance", Content: "package infraguard.packs.aliyun.nist800_53_compliance\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"nist800-53-compliance\",\n\t\"name\": {\n\t\t\"en\": \"NIST 800-53 Compliance\",\n\t\t\"zh\": \"NIST800-53 合规包\",\n\t\t\"ja\": \"NIST 800-53 コンプライアンス\",\n\t\t\"de\": \"NIST 800-53 Compliance\",\n\t\t\"es\": \"Cumplimiento NIST 800-53\",\n\t\t\"fr\": \"Conformité NIST 800-53\",\n\t\t\"pt\": \"Conformidade NIST 800-53\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for NIST 800-53 Security and Privacy Controls. This pack helps organizations verify their cloud resources meet NIST 800-53 security control requirements.\",\n\t\t\"zh\": \"NIST 800-53 安全与隐私控制合规包。本合规包帮助组织验证其云资源是否符合 NIST 800-53 安全控制要求。\",\n\t\t\"ja\": \"NIST 800-53 セキュリティおよびプライバシー制御のコンプライアンスパック。このパックは、組織がクラウドリソースが NIST 800-53 セキュリティ制御要件を満たしていることを確認するのに役立ちます。\",\n\t\t\"de\": \"Compliance-Paket für NIST 800-53 Sicherheits- und Datenschutzkontrollen. Dieses Paket hilft Organisationen zu überprüfen, ob ihre Cloud-Ressourcen die NIST 800-53 Sicherheitskontrollanforderungen erfüllen.\",\n\t\t\"es\": \"Paquete de cumplimiento para los Controles de Seguridad y Privacidad NIST 800-53. Este paquete ayuda a las organizaciones a verificar que sus recursos en la nube cumplan con los requisitos de control de seguridad NIST 800-53.\",\n\t\t\"fr\": \"Pack de conformité pour les Contrôles de Sécurité et de Confidentialité NIST 800-53. Ce pack aide les organisations à vérifier que leurs ressources cloud répondent aux exigences de contrôle de sécurité NIST 800-53.\",\n\t\t\"pt\": \"Pacote de conformidade para Controles de Segurança e Privacidade NIST 800-53. Este pacote ajuda as organizações a verificar se seus recursos em nuvem atendem aos requisitos de controle de segurança NIST 800-53.\"\n\t},\n\t\"rules\": [\n\t\t# \"ack-cluster-control-plane-log-enable\",\n\t\t\"ack-cluster-encryption-enabled\",\n\t\t\"ack-cluster-public-endpoint-check\",\n\t\t\"ack-cluster-supported-version\",\n\t\t\"ack-cluster-upgrade-latest-version\",\n\t\t# \"adb-cluster-audit-log-enabled\",  # Commented: ROS ADB::DBCluster does not support AuditLog property,\n\t\t# \"adb-cluster-log-backup-enabled\",\n\t\t# \"adb-cluster-maintain-time-check\",  # Commented: ROS ADB::DBCluster does not support MaintainTime property,\n\t\t# \"adb-public-access-check\",  # Commented: ROS ADB::DBCluster does not support PublicEndpoint property,\n\t\t\"alb-instance-multi-zone\",\n\t\t# \"api-gateway-group-domain-access-waf-or-waf3\",  # Commented: ROS ApiGateway::Group does not support PassthroughWaf property,\n\t\t\"api-gateway-group-enabled-ssl\",\n\t\t# \"api-gateway-group-log-enabled\",\n\t\t# \"api-group-custom-trace-enabled\",\n\t\t# \"cdn-domain-https-enabled\",\n\t\t# \"cdn-domain-tls13-enabled\",\n\t\t# \"cr-repository-image-scanning-enabled\",\n\t\t\"cr-repository-immutablity-enable\",\n\t\t# \"dts-instance-migration-job-ssl-enabled\",\n\t\t# \"eci-containergroup-environment-no-specified-keys\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t# \"ecs-disk-in-use\",\n\t\t\"ecs-in-use-disk-encrypted\",\n\t\t# \"ecs-instance-meta-data-mode-check\",\n\t\t# \"ecs-instance-monitor-enabled\",  # Commented: ROS ECS::Instance does not support CloudMonitorFlags property,\n\t\t\"ecs-instance-not-bind-key-pair\",\n\t\t\"ecs-instance-ram-role-attached\",\n\t\t# \"ecs-instance-status-no-stopped\",  # Commented: ROS ECS::Instance does not support Status property,\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t# \"ecs-security-group-not-used\",  # Commented: ROS ECS::SecurityGroup does not support Used property,\n\t\t\"ecs-security-group-white-list-port-check\",\n\t\t\"eip-attached\",\n\t\t\"elasticsearch-instance-enabled-data-node-encryption\",\n\t\t# \"elasticsearch-instance-used-https-protocol\",  # Commented: ROS ALIYUN::ElasticSearch::Instance does not support Protocol property,\n\t\t\"elasticsearch-public-and-any-ip-access-check\",\n\t\t# \"ess-group-health-check\",\n\t\t\"ess-scaling-configuration-enabled-internet-check\",\n\t\t\"ess-scaling-group-attach-multi-switch\",\n\t\t# \"fc-function-settings-check\",\n\t\t\"fc-service-internet-access-disable\",\n\t\t# \"fc-service-log-enable\",\n\t\t\"fc-service-vpc-binding\",\n\t\t\"firewall-asset-open-protect\",\n\t\t# \"kms-key-origin-not-external\",  # Commented: ROS KMS::Key does not support Origin property,\n\t\t# \"kms-key-state-not-pending-deletion\",  # Commented: ROS KMS::Key does not support KeyState property (runtime state only),\n\t\t# \"kms-secret-last-rotation-date-check\",\n\t\t\"kms-secret-rotation-enabled\",\n\t\t# \"mongodb-instance-backup-log-enabled\",  # Commented: ROS does not support ALIYUN::MongoDB::DBInstance resource type,\n\t\t\"mongodb-instance-log-audit\",\n\t\t# \"nas-filesystem-access-point-enabled-ram\",  # Commented: ROS does not support ALIYUN::NAS::AccessPoint resource type,\n\t\t# \"nas-filesystem-access-point-root-directory-check\",  # Commented: ROS does not support ALIYUN::NAS::AccessPoint resource type,\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t\"nas-filesystem-encrypt-type-check\",\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t\"oss-bucket-policy-no-any-anonymous\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-server-side-encryption-enabled\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-default-encryption-kms\",\n\t\t\"oss-zrs-enabled\",\n\t\t# \"ots-instance-all-table-encrypted\",  # ROS template does not support SSESpecification property,\n\t\t# \"polardb-cluster-enabled-auditing\",  # ROS does not support SQLCollectorStatus property,\n\t\t# \"polardb-cluster-level-one-backup-retention\",\n\t\t\"polardb-cluster-multi-zone\",\n\t\t# \"polardb-dbversion-status-check\",\n\t\t\"ram-group-has-member-check\",\n\t\t# \"ram-group-in-use-check\",\n\t\t# \"ram-policy-in-use-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"rds-instance-enabled-disk-encryption\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t# \"rds-instance-sql-collector-retention\",  # Commented: ROS RDS::DBInstance does not support SQLCollectorRetention property,\n\t\t\"rds-multi-az-support\",\n\t\t\"rds-public-connection-and-any-ip-access-check\",\n\t\t\"redis-instance-backup-log-enabled\",\n\t\t# \"redis-instance-upgrade-latest-version\",\n\t\t\"slb-all-listener-servers-multi-zone\",\n\t\t\"slb-all-listenter-tls-policy-check\",\n\t\t\"slb-instance-log-enabled\",\n\t\t\"slb-listener-https-enabled\",\n\t\t# \"ssl-certificate-expired-check\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t\"vpc-network-acl-risky-ports-check\",\n\t\t# \"vpc-network-acl-unused-check\",\n\t\t# \"vpc-routetable-destination-cidr-check\",  # ROS does not support ALIYUN::VPC::RouteEntry resource type,\n\t\t# \"vpn-ipsec-connection-status-check\",\n\t\t# \"waf3-instance-enabled-specified-defense-rules\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:oceanbase-best-practice", Name: models.I18nString{"de": "OceanBase Best Practices", "en": "OceanBase Best Practice", "es": "Mejores Prácticas de OceanBase", "fr": "Meilleures Pratiques OceanBase", "ja": "OceanBase のベストプラクティス", "pt": "Melhores Práticas do OceanBase", "zh": "OceanBase 最佳实践"}, Description: models.I18nString{"de": "Kontinuierliche Überprüfung der OceanBase-Compliance basierend auf Sicherheitspraktiken.", "en": "Continuously check OceanBase compliance based on security practices.", "es": "Verificar continuamente el cumplimiento de OceanBase basándose en prácticas de seguridad.", "fr": "Vérifier continuellement la conformité d'OceanBase sur la base des pratiques de sécurité.", "ja": "セキュリティ実践に基づいて OceanBase のコンプライアンスを継続的にチェックします。", "pt": "Verificar continuamente a conformidade do OceanBase com base em práticas de segurança.", "zh": "基于安全实践持续检查 OceanBase 的合规性。"}, RuleIDs: []string(nil), FilePath: "aliyun/packs/oceanbase-best-practice.rego", PackageName: "infraguard.packs.aliyun.oceanbase_best_practice", Content: "package infraguard.packs.aliyun.oceanbase_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"oceanbase-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"OceanBase Best Practice\",\n\t\t\"zh\": \"OceanBase 最佳实践\",\n\t\t\"ja\": \"OceanBase のベストプラクティス\",\n\t\t\"de\": \"OceanBase Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de OceanBase\",\n\t\t\"fr\": \"Meilleures Pratiques OceanBase\",\n\t\t\"pt\": \"Melhores Práticas do OceanBase\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Continuously check OceanBase compliance based on security practices.\",\n\t\t\"zh\": \"基于安全实践持续检查 OceanBase 的合规性。\",\n\t\t\"ja\": \"セキュリティ実践に基づいて OceanBase のコンプライアンスを継続的にチェックします。\",\n\t\t\"de\": \"Kontinuierliche Überprüfung der OceanBase-Compliance basierend auf Sicherheitspraktiken.\",\n\t\t\"es\": \"Verificar continuamente el cumplimiento de OceanBase basándose en prácticas de seguridad.\",\n\t\t\"fr\": \"Vérifier continuellement la conformité d'OceanBase sur la base des pratiques de sécurité.\",\n\t\t\"pt\": \"Verificar continuamente a conformidade do OceanBase com base em práticas de segurança.\"\n\t},\n\t\"rules\": []\n\t# \"oceanbase-instance-enabled-backup\",  # Commented: ROS does not support ALIYUN::OceanBase::DBInstance resource type\n\t# \"oceanbase-instance-enabled-ssl\",\n\t# \"oceanbase-instance-enabled-sql-diagnosis\",\n\t# \"oceanbase-tenant-security-ip-check\",\n\t# \"oceanbase-tenant-enabled-encryption\",\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:oss-compliance-management-best-practice", Name: models.I18nString{"de": "OSS-Compliance-Management Best Practices", "en": "OSS Compliance Management Best Practice", "es": "Mejores Prácticas de Gestión de Cumplimiento de OSS", "fr": "Meilleures Pratiques de Gestion de la Conformité OSS", "ja": "OSS コンプライアンス管理のベストプラクティス", "pt": "Melhores Práticas de Gestão de Conformidade OSS", "zh": "OSS 合规管理最佳实践"}, Description: models.I18nString{"de": "Best Practices für das OSS-Bucket-Compliance-Management, einschließlich Zugriffskontrolle, Verschlüsselung, Protokollierung, Versionskontrolle und Sicherheitsrichtlinien.", "en": "Best practices for OSS bucket compliance management, covering access control, encryption, logging, versioning, and security policies.", "es": "Mejores prácticas para la gestión de cumplimiento de buckets OSS, que cubre control de acceso, cifrado, registro, control de versiones y políticas de seguridad.", "fr": "Meilleures pratiques pour la gestion de la conformité des buckets OSS, couvrant le contrôle d'accès, le chiffrement, l'enregistrement, le contrôle de version et les politiques de sécurité.", "ja": "アクセス制御、暗号化、ログ、バージョン管理、セキュリティポリシーをカバーする OSS バケットコンプライアンス管理のベストプラクティス。", "pt": "Melhores práticas para gestão de conformidade de buckets OSS, cobrindo controle de acesso, criptografia, registro, controle de versão e políticas de segurança.", "zh": "OSS 存储空间合规管理最佳实践,涵盖访问控制、加密、日志、版本控制和安全策略。"}, RuleIDs: []string{"rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-policy-no-any-anonymous", "rule:aliyun:oss-bucket-policy-outside-organization-check", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-referer-limit", "rule:aliyun:oss-bucket-server-side-encryption-enabled", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-zrs-enabled"}, FilePath: "aliyun/packs/oss-compliance-management-best-practice.rego", PackageName: "infraguard.packs.aliyun.oss_compliance_management_best_practice", Content: "package infraguard.packs.aliyun.oss_compliance_management_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"oss-compliance-management-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"OSS Compliance Management Best Practice\",\n\t\t\"zh\": \"OSS 合规管理最佳实践\",\n\t\t\"ja\": \"OSS コンプライアンス管理のベストプラクティス\",\n\t\t\"de\": \"OSS-Compliance-Management Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Gestión de Cumplimiento de OSS\",\n\t\t\"fr\": \"Meilleures Pratiques de Gestion de la Conformité OSS\",\n\t\t\"pt\": \"Melhores Práticas de Gestão de Conformidade OSS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for OSS bucket compliance management, covering access control, encryption, logging, versioning, and security policies.\",\n\t\t\"zh\": \"OSS 存储空间合规管理最佳实践,涵盖访问控制、加密、日志、版本控制和安全策略。\",\n\t\t\"ja\": \"アクセス制御、暗号化、ログ、バージョン管理、セキュリティポリシーをカバーする OSS バケットコンプライアンス管理のベストプラクティス。\",\n\t\t\"de\": \"Best Practices für das OSS-Bucket-Compliance-Management, einschließlich Zugriffskontrolle, Verschlüsselung, Protokollierung, Versionskontrolle und Sicherheitsrichtlinien.\",\n\t\t\"es\": \"Mejores prácticas para la gestión de cumplimiento de buckets OSS, que cubre control de acceso, cifrado, registro, control de versiones y políticas de seguridad.\",\n\t\t\"fr\": \"Meilleures pratiques pour la gestion de la conformité des buckets OSS, couvrant le contrôle d'accès, le chiffrement, l'enregistrement, le contrôle de version et les politiques de sécurité.\",\n\t\t\"pt\": \"Melhores práticas para gestão de conformidade de buckets OSS, cobrindo controle de acesso, criptografia, registro, controle de versão e políticas de segurança.\"\n\t},\n\t\"rules\": [\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-policy-no-any-anonymous\",\n\t\t\"oss-bucket-policy-outside-organization-check\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-referer-limit\",\n\t\t\"oss-bucket-server-side-encryption-enabled\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-zrs-enabled\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:pci-dss-compliance", Name: models.I18nString{"de": "PCI-DSS Datensicherheitsstandard Compliance", "en": "PCI-DSS Data Security Standard Compliance", "es": "Cumplimiento del Estándar de Seguridad de Datos PCI-DSS", "fr": "Conformité à la Norme de Sécurité des Données PCI-DSS", "ja": "PCI-DSS データセキュリティ標準コンプライアンス", "pt": "Conformidade com o Padrão de Segurança de Dados PCI-DSS", "zh": "PCI-DSS 数据安全标准合规包"}, Description: models.I18nString{"de": "Compliance-Paket für den Payment Card Industry Data Security Standard (PCI-DSS). Dieses Paket hilft Organisationen zu überprüfen, ob ihre Cloud-Ressourcen die PCI-DSS-Anforderungen zum Schutz von Karteninhaberdaten erfüllen.", "en": "Compliance pack for Payment Card Industry Data Security Standard (PCI-DSS). This pack helps organizations verify their cloud resources meet PCI-DSS requirements for protecting cardholder data.", "es": "Paquete de cumplimiento para el Estándar de Seguridad de Datos de la Industria de Tarjetas de Pago (PCI-DSS). Este paquete ayuda a las organizaciones a verificar que sus recursos en la nube cumplan con los requisitos PCI-DSS para proteger los datos de los titulares de tarjetas.", "fr": "Pack de conformité pour la Norme de Sécurité des Données de l'Industrie des Cartes de Paiement (PCI-DSS). Ce pack aide les organisations à vérifier que leurs ressources cloud répondent aux exigences PCI-DSS pour protéger les données des titulaires de cartes.", "ja": "決済カード業界データセキュリティ標準（PCI-DSS）のコンプライアンスパック。このパックは、組織がクラウドリソースがカード所有者データを保護するための PCI-DSS 要件を満たしていることを確認するのに役立ちます。", "pt": "Pacote de conformidade para o Padrão de Segurança de Dados da Indústria de Cartões de Pagamento (PCI-DSS). Este pacote ajuda as organizações a verificar se seus recursos em nuvem atendem aos requisitos PCI-DSS para proteger dados de portadores de cartão.", "zh": "支付卡行业数据安全标准(PCI-DSS)合规包。本合规包帮助组织验证其云资源是否符合 PCI-DSS 保护持卡人数据的要求。"}, RuleIDs: []string{"rule:aliyun:api-gateway-api-internet-request-https", "rule:aliyun:ecs-disk-encrypted", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:ecs-security-group-white-list-port-check", "rule:aliyun:ecs-snapshot-retention-days", "rule:aliyun:fc-function-custom-domain-and-tls-enable", "rule:aliyun:kms-key-delete-protection-enabled", "rule:aliyun:kms-key-rotation-enabled", "rule:aliyun:kms-secret-rotation-enabled", "rule:aliyun:oss-bucket-anonymous-prohibited", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-bucket-server-side-encryption-enabled", "rule:aliyun:oss-encryption-byok-check", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-enabled-tde", "rule:aliyun:polardb-cluster-maintain-time-check", "rule:aliyun:polardb-public-and-any-ip-access-check", "rule:aliyun:ram-group-has-member-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-ak-create-date-expired-check", "rule:aliyun:ram-user-ak-used-expired-check", "rule:aliyun:ram-user-group-membership-check", "rule:aliyun:ram-user-last-login-expired-check", "rule:aliyun:ram-user-login-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:rds-instance-enabled-auditing", "rule:aliyun:rds-instance-enabled-disk-encryption", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-instance-maintain-time-check", "rule:aliyun:rds-public-connection-and-any-ip-access-check", "rule:aliyun:sg-public-access-check", "rule:aliyun:slb-all-listenter-tls-policy-check", "rule:aliyun:sls-logstore-enabled-encrypt", "rule:aliyun:vpc-flow-logs-enabled", "rule:aliyun:waf-instance-logging-enabled"}, FilePath: "aliyun/packs/pci-dss-compliance.rego", PackageName: "infraguard.packs.aliyun.pci_dss_compliance", Content: "package infraguard.packs.aliyun.pci_dss_compliance\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"pci-dss-compliance\",\n\t\"name\": {\n\t\t\"en\": \"PCI-DSS Data Security Standard Compliance\",\n\t\t\"zh\": \"PCI-DSS 数据安全标准合规包\",\n\t\t\"ja\": \"PCI-DSS データセキュリティ標準コンプライアンス\",\n\t\t\"de\": \"PCI-DSS Datensicherheitsstandard Compliance\",\n\t\t\"es\": \"Cumplimiento del Estándar de Seguridad de Datos PCI-DSS\",\n\t\t\"fr\": \"Conformité à la Norme de Sécurité des Données PCI-DSS\",\n\t\t\"pt\": \"Conformidade com o Padrão de Segurança de Dados PCI-DSS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for Payment Card Industry Data Security Standard (PCI-DSS). This pack helps organizations verify their cloud resources meet PCI-DSS requirements for protecting cardholder data.\",\n\t\t\"zh\": \"支付卡行业数据安全标准(PCI-DSS)合规包。本合规包帮助组织验证其云资源是否符合 PCI-DSS 保护持卡人数据的要求。\",\n\t\t\"ja\": \"決済カード業界データセキュリティ標準（PCI-DSS）のコンプライアンスパック。このパックは、組織がクラウドリソースがカード所有者データを保護するための PCI-DSS 要件を満たしていることを確認するのに役立ちます。\",\n\t\t\"de\": \"Compliance-Paket für den Payment Card Industry Data Security Standard (PCI-DSS). Dieses Paket hilft Organisationen zu überprüfen, ob ihre Cloud-Ressourcen die PCI-DSS-Anforderungen zum Schutz von Karteninhaberdaten erfüllen.\",\n\t\t\"es\": \"Paquete de cumplimiento para el Estándar de Seguridad de Datos de la Industria de Tarjetas de Pago (PCI-DSS). Este paquete ayuda a las organizaciones a verificar que sus recursos en la nube cumplan con los requisitos PCI-DSS para proteger los datos de los titulares de tarjetas.\",\n\t\t\"fr\": \"Pack de conformité pour la Norme de Sécurité des Données de l'Industrie des Cartes de Paiement (PCI-DSS). Ce pack aide les organisations à vérifier que leurs ressources cloud répondent aux exigences PCI-DSS pour protéger les données des titulaires de cartes.\",\n\t\t\"pt\": \"Pacote de conformidade para o Padrão de Segurança de Dados da Indústria de Cartões de Pagamento (PCI-DSS). Este pacote ajuda as organizações a verificar se seus recursos em nuvem atendem aos requisitos PCI-DSS para proteger dados de portadores de cartão.\"\n\t},\n\t\"rules\": [\n\t\t\"api-gateway-api-internet-request-https\",\n\t\t# \"api-gateway-group-domain-access-waf\",\n\t\t# \"cdn-domain-https-enabled\",\n\t\t\"ecs-disk-encrypted\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t# \"ecs-instance-monitor-enabled\",  # Commented: ROS ECS::Instance does not support CloudMonitorFlags property,\n\t\t# \"ecs-instance-no-public-ip\",\n\t\t# \"ecs-instance-os-name-check\",\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"ecs-security-group-white-list-port-check\",\n\t\t\"ecs-snapshot-retention-days\",\n\t\t# \"elasticsearch-instance-used-https-protocol\",  # Commented: ROS ALIYUN::ElasticSearch::Instance does not support Protocol property,\n\t\t\"fc-function-custom-domain-and-tls-enable\",\n\t\t\"kms-key-delete-protection-enabled\",\n\t\t\"kms-key-rotation-enabled\",\n\t\t\"kms-secret-rotation-enabled\",\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t\"oss-bucket-anonymous-prohibited\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t\"oss-bucket-server-side-encryption-enabled\",\n\t\t\"oss-encryption-byok-check\",\n\t\t\"oss-zrs-enabled\",\n\t\t# \"polardb-cluster-default-time-zone-not-system\",\n\t\t# \"polardb-cluster-enabled-auditing\",  # ROS does not support SQLCollectorStatus property,\n\t\t\"polardb-cluster-enabled-tde\",\n\t\t# \"polardb-cluster-level-one-backup-retention\",\n\t\t# \"polardb-cluster-log-backup-retention\",  # ROS does not support LogBackupRetentionPeriod property,\n\t\t\"polardb-cluster-maintain-time-check\",\n\t\t\"polardb-public-and-any-ip-access-check\",\n\t\t\"ram-group-has-member-check\",\n\t\t# \"ram-policy-in-use-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-ak-create-date-expired-check\",\n\t\t\"ram-user-ak-used-expired-check\",\n\t\t\"ram-user-group-membership-check\",\n\t\t\"ram-user-last-login-expired-check\",\n\t\t\"ram-user-login-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t# \"ram-user-no-has-specified-policy\",\n\t\t\"rds-instance-enabled-auditing\",\n\t\t# \"rds-instance-enabled-byok-tde\",\n\t\t\"rds-instance-enabled-disk-encryption\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t\"rds-instance-maintain-time-check\",\n\t\t# \"rds-instance-sql-collector-retention\",  # Commented: ROS RDS::DBInstance does not support SQLCollectorRetention property,\n\t\t\"rds-public-connection-and-any-ip-access-check\",\n\t\t# \"redis-instance-enabled-tde\",\n\t\t\"sg-public-access-check\",\n\t\t\"slb-all-listenter-tls-policy-check\",\n\t\t\"sls-logstore-enabled-encrypt\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t# \"waf-domain-enabled-specified-protection-module\",\n\t\t\"waf-instance-logging-enabled\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:polardb-application-best-practice", Name: models.I18nString{"de": "PolarDB-Anwendung Best Practices", "en": "PolarDB Application Best Practice", "es": "Mejores Prácticas de Aplicación PolarDB", "fr": "Meilleures Pratiques d'Application PolarDB", "ja": "PolarDB アプリケーションのベストプラクティス", "pt": "Melhores Práticas de Aplicação PolarDB", "zh": "PolarDB 应用最佳实践"}, Description: models.I18nString{"de": "Best Practices für die PolarDB-Cluster-Konfiguration, einschließlich Sicherheit, Backup, Versionsverwaltung und Betriebseinstellungen.", "en": "Best practices for PolarDB cluster configuration, covering security, backup, version management, and operational settings.", "es": "Mejores prácticas para la configuración de clústeres PolarDB, que cubre seguridad, respaldo, gestión de versiones y configuraciones operativas.", "fr": "Meilleures pratiques pour la configuration des clusters PolarDB, couvrant la sécurité, la sauvegarde, la gestion des versions et les configurations opérationnelles.", "ja": "セキュリティ、バックアップ、バージョン管理、運用設定をカバーする PolarDB クラスタ設定のベストプラクティス。", "pt": "Melhores práticas para configuração de cluster PolarDB, cobrindo segurança, backup, gerenciamento de versão e configurações operacionais.", "zh": "PolarDB 集群配置最佳实践,涵盖安全、备份、版本管理和运维设置。"}, RuleIDs: []string{"rule:aliyun:polardb-cluster-delete-protection-enabled", "rule:aliyun:polardb-cluster-expired-check", "rule:aliyun:polardb-cluster-maintain-time-check", "rule:aliyun:polardb-public-and-any-ip-access-check"}, FilePath: "aliyun/packs/polardb-application-best-practice.rego", PackageName: "infraguard.packs.aliyun.polardb_application_best_practice", Content: "package infraguard.packs.aliyun.polardb_application_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"polardb-application-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"PolarDB Application Best Practice\",\n\t\t\"zh\": \"PolarDB 应用最佳实践\",\n\t\t\"ja\": \"PolarDB アプリケーションのベストプラクティス\",\n\t\t\"de\": \"PolarDB-Anwendung Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Aplicación PolarDB\",\n\t\t\"fr\": \"Meilleures Pratiques d'Application PolarDB\",\n\t\t\"pt\": \"Melhores Práticas de Aplicação PolarDB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for PolarDB cluster configuration, covering security, backup, version management, and operational settings.\",\n\t\t\"zh\": \"PolarDB 集群配置最佳实践,涵盖安全、备份、版本管理和运维设置。\",\n\t\t\"ja\": \"セキュリティ、バックアップ、バージョン管理、運用設定をカバーする PolarDB クラスタ設定のベストプラクティス。\",\n\t\t\"de\": \"Best Practices für die PolarDB-Cluster-Konfiguration, einschließlich Sicherheit, Backup, Versionsverwaltung und Betriebseinstellungen.\",\n\t\t\"es\": \"Mejores prácticas para la configuración de clústeres PolarDB, que cubre seguridad, respaldo, gestión de versiones y configuraciones operativas.\",\n\t\t\"fr\": \"Meilleures pratiques pour la configuration des clusters PolarDB, couvrant la sécurité, la sauvegarde, la gestion des versions et les configurations opérationnelles.\",\n\t\t\"pt\": \"Melhores práticas para configuração de cluster PolarDB, cobrindo segurança, backup, gerenciamento de versão e configurações operacionais.\"\n\t},\n\t\"rules\": [\n\t\t# \"polardb-cluster-category-normal\",\n\t\t# \"polardb-cluster-default-time-zone-not-system\",\n\t\t\"polardb-cluster-delete-protection-enabled\",\n\t\t# \"polardb-cluster-enabled-auditing\",  # ROS does not support SQLCollectorStatus property,\n\t\t\"polardb-cluster-expired-check\",\n\t\t# \"polardb-cluster-level-two-backup-retention\",\n\t\t# \"polardb-cluster-log-backup-retention\",  # ROS does not support LogBackupRetentionPeriod property,\n\t\t\"polardb-cluster-maintain-time-check\",\n\t\t\"polardb-public-and-any-ip-access-check\",\n\t\t# \"polardb-revision-version-used-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:quick-start-compliance-pack", Name: models.I18nString{"de": "Schnellstart-Compliance-Paket", "en": "Quick Start Compliance Pack", "es": "Paquete de Cumplimiento de Inicio Rápido", "fr": "Pack de Conformité de Démarrage Rapide", "ja": "クイックスタートコンプライアンスパック", "pt": "Pacote de Conformidade de Início Rápido", "zh": "快速体验合规包"}, Description: models.I18nString{"de": "Ein Schnellstart-Compliance-Paket, das grundlegende Sicherheits-Best-Practices für ECS, OSS, RAM und RDS abdeckt.", "en": "A quick start compliance pack covering basic security best practices for ECS, OSS, RAM, and RDS.", "es": "Un paquete de cumplimiento de inicio rápido que cubre las mejores prácticas básicas de seguridad para ECS, OSS, RAM y RDS.", "fr": "Un pack de conformité de démarrage rapide couvrant les meilleures pratiques de sécurité de base pour ECS, OSS, RAM et RDS.", "ja": "ECS、OSS、RAM、RDS の基本的なセキュリティベストプラクティスをカバーするクイックスタートコンプライアンスパック。", "pt": "Um pacote de conformidade de início rápido cobrindo práticas básicas de segurança para ECS, OSS, RAM e RDS.", "zh": "快速体验合规包,涵盖 ECS、OSS、RAM 和 RDS 的基本安全最佳实践。"}, RuleIDs: []string{"rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-activated-ak-quantity-check", "rule:aliyun:rds-public-connection-and-any-ip-access-check"}, FilePath: "aliyun/packs/quick-start-compliance-pack.rego", PackageName: "infraguard.packs.aliyun.quick_start_compliance_pack", Content: "package infraguard.packs.aliyun.quick_start_compliance_pack\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"quick-start-compliance-pack\",\n\t\"name\": {\n\t\t\"en\": \"Quick Start Compliance Pack\",\n\t\t\"zh\": \"快速体验合规包\",\n\t\t\"ja\": \"クイックスタートコンプライアンスパック\",\n\t\t\"de\": \"Schnellstart-Compliance-Paket\",\n\t\t\"es\": \"Paquete de Cumplimiento de Inicio Rápido\",\n\t\t\"fr\": \"Pack de Conformité de Démarrage Rapide\",\n\t\t\"pt\": \"Pacote de Conformidade de Início Rápido\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"A quick start compliance pack covering basic security best practices for ECS, OSS, RAM, and RDS.\",\n\t\t\"zh\": \"快速体验合规包,涵盖 ECS、OSS、RAM 和 RDS 的基本安全最佳实践。\",\n\t\t\"ja\": \"ECS、OSS、RAM、RDS の基本的なセキュリティベストプラクティスをカバーするクイックスタートコンプライアンスパック。\",\n\t\t\"de\": \"Ein Schnellstart-Compliance-Paket, das grundlegende Sicherheits-Best-Practices für ECS, OSS, RAM und RDS abdeckt.\",\n\t\t\"es\": \"Un paquete de cumplimiento de inicio rápido que cubre las mejores prácticas básicas de seguridad para ECS, OSS, RAM y RDS.\",\n\t\t\"fr\": \"Un pack de conformité de démarrage rapide couvrant les meilleures pratiques de sécurité de base pour ECS, OSS, RAM et RDS.\",\n\t\t\"pt\": \"Um pacote de conformidade de início rápido cobrindo práticas básicas de segurança para ECS, OSS, RAM e RDS.\"\n\t},\n\t\"rules\": [\n\t\t# \"ecs-instance-no-public-ip\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-activated-ak-quantity-check\",\n\t\t# \"ram-user-ak-create-date-expired-check-v2\",\n\t\t# \"ram-user-mfa-check-v2\",\n\t\t\"rds-public-connection-and-any-ip-access-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:redis-application-best-practice", Name: models.I18nString{"de": "Redis-Anwendung Best Practices", "en": "Redis Application Best Practice", "es": "Mejores Prácticas de Aplicación Redis", "fr": "Meilleures Pratiques d'Application Redis", "ja": "Redis アプリケーションのベストプラクティス", "pt": "Melhores Práticas de Aplicação Redis", "zh": "Redis 应用最佳实践"}, Description: models.I18nString{"de": "Best Practices für die Redis-Instanz-Konfiguration, einschließlich Hochverfügbarkeit, Sicherheit, Backup, Leistung und Betriebseinstellungen.", "en": "Best practices for Redis instance configuration, covering high availability, security, backup, performance, and operational settings.", "es": "Mejores prácticas para la configuración de instancias Redis, que cubre alta disponibilidad, seguridad, respaldo, rendimiento y configuraciones operativas.", "fr": "Meilleures pratiques pour la configuration des instances Redis, couvrant la haute disponibilité, la sécurité, la sauvegarde, les performances et les configurations opérationnelles.", "ja": "高可用性、セキュリティ、バックアップ、パフォーマンス、運用設定をカバーする Redis インスタンス設定のベストプラクティス。", "pt": "Melhores práticas para configuração de instâncias Redis, cobrindo alta disponibilidade, segurança, backup, desempenho e configurações operacionais.", "zh": "Redis 实例配置最佳实践,涵盖高可用、安全、备份、性能和运维设置。"}, RuleIDs: []string{"rule:aliyun:redis-instance-backup-log-enabled", "rule:aliyun:redis-instance-backup-time-check", "rule:aliyun:redis-instance-enabled-byok-tde", "rule:aliyun:redis-instance-enabled-ssl", "rule:aliyun:redis-instance-expired-check", "rule:aliyun:redis-instance-multi-zone", "rule:aliyun:redis-instance-release-protection", "rule:aliyun:redis-public-and-any-ip-access-check"}, FilePath: "aliyun/packs/redis-application-best-practice.rego", PackageName: "infraguard.packs.aliyun.redis_application_best_practice", Content: "package infraguard.packs.aliyun.redis_application_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"redis-application-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Redis Application Best Practice\",\n\t\t\"zh\": \"Redis 应用最佳实践\",\n\t\t\"ja\": \"Redis アプリケーションのベストプラクティス\",\n\t\t\"de\": \"Redis-Anwendung Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Aplicación Redis\",\n\t\t\"fr\": \"Meilleures Pratiques d'Application Redis\",\n\t\t\"pt\": \"Melhores Práticas de Aplicação Redis\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for Redis instance configuration, covering high availability, security, backup, performance, and operational settings.\",\n\t\t\"zh\": \"Redis 实例配置最佳实践,涵盖高可用、安全、备份、性能和运维设置。\",\n\t\t\"ja\": \"高可用性、セキュリティ、バックアップ、パフォーマンス、運用設定をカバーする Redis インスタンス設定のベストプラクティス。\",\n\t\t\"de\": \"Best Practices für die Redis-Instanz-Konfiguration, einschließlich Hochverfügbarkeit, Sicherheit, Backup, Leistung und Betriebseinstellungen.\",\n\t\t\"es\": \"Mejores prácticas para la configuración de instancias Redis, que cubre alta disponibilidad, seguridad, respaldo, rendimiento y configuraciones operativas.\",\n\t\t\"fr\": \"Meilleures pratiques pour la configuration des instances Redis, couvrant la haute disponibilité, la sécurité, la sauvegarde, les performances et les configurations opérationnelles.\",\n\t\t\"pt\": \"Melhores práticas para configuração de instâncias Redis, cobrindo alta disponibilidade, segurança, backup, desempenho e configurações operacionais.\"\n\t},\n\t\"rules\": [\n\t\t# \"redis-instance-audit-log-retention\",\n\t\t\"redis-instance-backup-log-enabled\",\n\t\t\"redis-instance-backup-time-check\",\n\t\t# \"redis-instance-disable-risk-commands\",\n\t\t# \"redis-instance-double-node-type\",\n\t\t# \"redis-instance-enabled-audit-log\",  # Commented: ROS ALIYUN::REDIS::Instance does not support AuditLogConfig property,\n\t\t\"redis-instance-enabled-byok-tde\",\n\t\t\"redis-instance-enabled-ssl\",\n\t\t\"redis-instance-expired-check\",\n\t\t\"redis-instance-multi-zone\",\n\t\t\"redis-instance-release-protection\",\n\t\t# \"redis-instance-upgrade-latest-version\",\n\t\t# \"redis-min-bandwidth-limit\",\n\t\t# \"redis-min-capacity-limit\",\n\t\t# \"redis-min-qps-limit\",\n\t\t\"redis-public-and-any-ip-access-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:resource-backup-best-practice", Name: models.I18nString{"de": "Ressourcen-Backup Best Practices", "en": "Resource Backup Best Practice", "es": "Mejores Prácticas de Respaldo de Recursos", "fr": "Meilleures Pratiques de Sauvegarde des Ressources", "ja": "リソースバックアップのベストプラクティス", "pt": "Melhores Práticas de Backup de Recursos", "zh": "资源备份功能开启最佳实践"}, Description: models.I18nString{"de": "Best Practices zur Aktivierung von Backup-Funktionen für Cloud-Ressourcen, um Datenschutz und Disaster Recovery sicherzustellen.", "en": "Best practices for enabling backup features on cloud resources to ensure data protection and disaster recovery.", "es": "Mejores prácticas para habilitar funciones de respaldo en recursos en la nube para garantizar la protección de datos y la recuperación ante desastres.", "fr": "Meilleures pratiques pour activer les fonctions de sauvegarde sur les ressources cloud afin d'assurer la protection des données et la récupération d'urgence.", "ja": "データ保護と災害復旧を確保するために、クラウドリソースでバックアップ機能を有効にするベストプラクティス。", "pt": "Melhores práticas para habilitar recursos de backup em recursos em nuvem para garantir proteção de dados e recuperação de desastres.", "zh": "为云资源开启备份功能的最佳实践,确保数据保护和灾难恢复。"}, RuleIDs: []string{"rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:redis-instance-backup-log-enabled"}, FilePath: "aliyun/packs/resource-backup-best-practice.rego", PackageName: "infraguard.packs.aliyun.resource_backup_best_practice", Content: "package infraguard.packs.aliyun.resource_backup_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"resource-backup-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Resource Backup Best Practice\",\n\t\t\"zh\": \"资源备份功能开启最佳实践\",\n\t\t\"ja\": \"リソースバックアップのベストプラクティス\",\n\t\t\"de\": \"Ressourcen-Backup Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Respaldo de Recursos\",\n\t\t\"fr\": \"Meilleures Pratiques de Sauvegarde des Ressources\",\n\t\t\"pt\": \"Melhores Práticas de Backup de Recursos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for enabling backup features on cloud resources to ensure data protection and disaster recovery.\",\n\t\t\"zh\": \"为云资源开启备份功能的最佳实践,确保数据保护和灾难恢复。\",\n\t\t\"ja\": \"データ保護と災害復旧を確保するために、クラウドリソースでバックアップ機能を有効にするベストプラクティス。\",\n\t\t\"de\": \"Best Practices zur Aktivierung von Backup-Funktionen für Cloud-Ressourcen, um Datenschutz und Disaster Recovery sicherzustellen.\",\n\t\t\"es\": \"Mejores prácticas para habilitar funciones de respaldo en recursos en la nube para garantizar la protección de datos y la recuperación ante desastres.\",\n\t\t\"fr\": \"Meilleures pratiques pour activer les fonctions de sauvegarde sur les ressources cloud afin d'assurer la protection des données et la récupération d'urgence.\",\n\t\t\"pt\": \"Melhores práticas para habilitar recursos de backup em recursos em nuvem para garantir proteção de dados e recuperação de desastres.\"\n\t},\n\t\"rules\": [\n\t\t# \"adb-cluster-log-backup-enabled\",\n\t\t# \"eci-container-group-volumn-mounts\",\n\t\t# \"ecs-instance-backup-enable\",\n\t\t# \"elasticsearch-instance-snapshot-enabled\",  # Commented: ROS does not support AutoSnapshot property for ALIYUN::ElasticSearch::Instance,\n\t\t# \"gpdb-has-backup-set\",\n\t\t# \"hologram-instance-remote-backup-enable\",\n\t\t# \"mongodb-instance-backup-log-enabled\",  # Commented: ROS does not support ALIYUN::MongoDB::DBInstance resource type,\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t# \"ots-instance-remote-replication\",\n\t\t# \"polardb-cluster-level-two-backup-retention\",\n\t\t# \"polardb-cluster-log-backup-retention\",  # ROS does not support LogBackupRetentionPeriod property,\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t\"redis-instance-backup-log-enabled\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:resource-expiration-notification-best-practice", Name: models.I18nString{"de": "Ressourcen-Ablaufbenachrichtigung Best Practices", "en": "Resource Expiration Notification Best Practice", "es": "Mejores Prácticas de Notificación de Expiración de Recursos", "fr": "Meilleures Pratiques de Notification d'Expiration des Ressources", "ja": "リソース有効期限通知のベストプラクティス", "pt": "Melhores Práticas de Notificação de Expiração de Recursos", "zh": "资源到期提醒最佳实践"}, Description: models.I18nString{"de": "Erkennt Stabilitätsrisiken im Zusammenhang mit dem Ablauf von Ressourcen und hilft, versteckte Gefahren im Voraus zu entdecken und die Stabilität und Betriebseffizienz zu verbessern.", "en": "Detects stability risks related to resource expiration, helping to discover hidden dangers in advance and improve stability and operational efficiency.", "es": "Detecta riesgos de estabilidad relacionados con la expiración de recursos, ayudando a descubrir peligros ocultos con anticipación y mejorar la estabilidad y la eficiencia operativa.", "fr": "Détecte les risques de stabilité liés à l'expiration des ressources, aidant à découvrir les dangers cachés à l'avance et à améliorer la stabilité et l'efficacité opérationnelle.", "ja": "リソースの有効期限に関連する安定性リスクを検出し、潜在的な問題を事前に発見し、安定性と運用効率を向上させます。", "pt": "Detecta riscos de estabilidade relacionados à expiração de recursos, ajudando a descobrir perigos ocultos com antecedência e melhorar a estabilidade e a eficiência operacional.", "zh": "从到期风险维度，对云上资源的稳定性做检测，有助于提前发现隐患，提升稳定性和运维效率。"}, RuleIDs: []string{"rule:aliyun:bastionhost-instance-expired-check", "rule:aliyun:ecs-instance-expired-check", "rule:aliyun:hbase-cluster-expired-check", "rule:aliyun:mongodb-cluster-expired-check", "rule:aliyun:polardb-cluster-expired-check", "rule:aliyun:rds-instance-expired-check", "rule:aliyun:redis-instance-expired-check"}, FilePath: "aliyun/packs/resource-expiration-notification-best-practice.rego", PackageName: "infraguard.packs.aliyun.resource_expiration_notification_best_practice", Content: "package infraguard.packs.aliyun.resource_expiration_notification_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"resource-expiration-notification-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Resource Expiration Notification Best Practice\",\n\t\t\"zh\": \"资源到期提醒最佳实践\",\n\t\t\"ja\": \"リソース有効期限通知のベストプラクティス\",\n\t\t\"de\": \"Ressourcen-Ablaufbenachrichtigung Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Notificación de Expiración de Recursos\",\n\t\t\"fr\": \"Meilleures Pratiques de Notification d'Expiration des Ressources\",\n\t\t\"pt\": \"Melhores Práticas de Notificação de Expiração de Recursos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Detects stability risks related to resource expiration, helping to discover hidden dangers in advance and improve stability and operational efficiency.\",\n\t\t\"zh\": \"从到期风险维度，对云上资源的稳定性做检测，有助于提前发现隐患，提升稳定性和运维效率。\",\n\t\t\"ja\": \"リソースの有効期限に関連する安定性リスクを検出し、潜在的な問題を事前に発見し、安定性と運用効率を向上させます。\",\n\t\t\"de\": \"Erkennt Stabilitätsrisiken im Zusammenhang mit dem Ablauf von Ressourcen und hilft, versteckte Gefahren im Voraus zu entdecken und die Stabilität und Betriebseffizienz zu verbessern.\",\n\t\t\"es\": \"Detecta riesgos de estabilidad relacionados con la expiración de recursos, ayudando a descubrir peligros ocultos con anticipación y mejorar la estabilidad y la eficiencia operativa.\",\n\t\t\"fr\": \"Détecte les risques de stabilité liés à l'expiration des ressources, aidant à découvrir les dangers cachés à l'avance et à améliorer la stabilité et l'efficacité opérationnelle.\",\n\t\t\"pt\": \"Detecta riscos de estabilidade relacionados à expiração de recursos, ajudando a descobrir perigos ocultos com antecedência e melhorar a estabilidade e a eficiência operacional.\"\n\t},\n\t\"rules\": [\n\t\t# \"adb-cluster-expired-check\",\n\t\t\"bastionhost-instance-expired-check\",\n\t\t\"ecs-instance-expired-check\",\n\t\t# \"eip-address-expired-check\",\n\t\t\"hbase-cluster-expired-check\",\n\t\t\"mongodb-cluster-expired-check\",\n\t\t\"polardb-cluster-expired-check\",\n\t\t# \"polardb-x1-instance-expired-check\",\n\t\t# \"polardb-x2-instance-expired-check\",\n\t\t\"rds-instance-expired-check\",\n\t\t\"redis-instance-expired-check\",\n\t\t# \"slb-instance-expired-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:resource-idle-detection-best-practice", Name: models.I18nString{"de": "Ressourcen-Leerlauf-Erkennung Best Practices", "en": "Resource Idle Detection Best Practice", "es": "Mejores Prácticas de Detección de Recursos Inactivos", "fr": "Meilleures Pratiques de Détection des Ressources Inactives", "ja": "リソースアイドル検出のベストプラクティス", "pt": "Melhores Práticas de Detecção de Recursos Inativos", "zh": "资源空闲检测最佳实践"}, Description: models.I18nString{"de": "Erkennung gängiger Cloud-Ressourcen, die nach dem Kauf im Leerlauf sind, einschließlich EIP, gemeinsam genutzter Bandbreite, VPC, VPN und anderen Cloud-Produkten. Leerlaufende Ressourcen führen zu Unternehmenskostenverschwendung und sollten rechtzeitig identifiziert und verwaltet werden.", "en": "Detect common cloud resources that are idle after purchase, involving EIP, shared bandwidth, VPC, VPN and other cloud products. Idle resources lead to enterprise cost waste and should be identified and managed in time.", "es": "Detecta recursos en la nube comunes que están inactivos después de la compra, involucrando EIP, ancho de banda compartido, VPC, VPN y otros productos en la nube. Los recursos inactivos conducen al desperdicio de costos empresariales y deben identificarse y gestionarse a tiempo.", "fr": "Détecte les ressources cloud courantes qui sont inactives après l'achat, impliquant EIP, bande passante partagée, VPC, VPN et d'autres produits cloud. Les ressources inactives entraînent un gaspillage des coûts d'entreprise et doivent être identifiées et gérées à temps.", "ja": "購入後にアイドル状態になっている一般的なクラウドリソースを検出します。EIP、共有帯域幅、VPC、VPN などのクラウド製品が含まれます。アイドルリソースは企業のコスト浪費につながるため、適時に特定して管理する必要があります。", "pt": "Detecta recursos em nuvem comuns que estão inativos após a compra, envolvendo EIP, largura de banda compartilhada, VPC, VPN e outros produtos em nuvem. Recursos inativos levam ao desperdício de custos empresariais e devem ser identificados e gerenciados a tempo.", "zh": "检测常见的云资源在购买以后是否被闲置，涉及弹性公网 IP、共享带宽、VPC、VPN 等云产品。资源购买后未启用会导致企业成本的浪费，建议及时发现并治理。"}, RuleIDs: []string{"rule:aliyun:ecs-disk-idle-check"}, FilePath: "aliyun/packs/resource-idle-detection-best-practice.rego", PackageName: "infraguard.packs.aliyun.resource_idle_detection_best_practice", Content: "# Resource Idle Detection Best Practice Pack\n# Detect common cloud resources that are idle after purchase, involving EIP, shared bandwidth, VPC, VPN, etc.\n# Idle resources lead to cost waste and should be identified and managed in time.\npackage infraguard.packs.aliyun.resource_idle_detection_best_practice\n\nimport rego.v1\n\n# Pack metadata with i18n support\npack_meta := {\n\t\"id\": \"resource-idle-detection-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Resource Idle Detection Best Practice\",\n\t\t\"zh\": \"资源空闲检测最佳实践\",\n\t\t\"ja\": \"リソースアイドル検出のベストプラクティス\",\n\t\t\"de\": \"Ressourcen-Leerlauf-Erkennung Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Detección de Recursos Inactivos\",\n\t\t\"fr\": \"Meilleures Pratiques de Détection des Ressources Inactives\",\n\t\t\"pt\": \"Melhores Práticas de Detecção de Recursos Inativos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Detect common cloud resources that are idle after purchase, involving EIP, shared bandwidth, VPC, VPN and other cloud products. Idle resources lead to enterprise cost waste and should be identified and managed in time.\",\n\t\t\"zh\": \"检测常见的云资源在购买以后是否被闲置，涉及弹性公网 IP、共享带宽、VPC、VPN 等云产品。资源购买后未启用会导致企业成本的浪费，建议及时发现并治理。\",\n\t\t\"ja\": \"購入後にアイドル状態になっている一般的なクラウドリソースを検出します。EIP、共有帯域幅、VPC、VPN などのクラウド製品が含まれます。アイドルリソースは企業のコスト浪費につながるため、適時に特定して管理する必要があります。\",\n\t\t\"de\": \"Erkennung gängiger Cloud-Ressourcen, die nach dem Kauf im Leerlauf sind, einschließlich EIP, gemeinsam genutzter Bandbreite, VPC, VPN und anderen Cloud-Produkten. Leerlaufende Ressourcen führen zu Unternehmenskostenverschwendung und sollten rechtzeitig identifiziert und verwaltet werden.\",\n\t\t\"es\": \"Detecta recursos en la nube comunes que están inactivos después de la compra, involucrando EIP, ancho de banda compartido, VPC, VPN y otros productos en la nube. Los recursos inactivos conducen al desperdicio de costos empresariales y deben identificarse y gestionarse a tiempo.\",\n\t\t\"fr\": \"Détecte les ressources cloud courantes qui sont inactives après l'achat, impliquant EIP, bande passante partagée, VPC, VPN et d'autres produits cloud. Les ressources inactives entraînent un gaspillage des coûts d'entreprise et doivent être identifiées et gérées à temps.\",\n\t\t\"pt\": \"Detecta recursos em nuvem comuns que estão inativos após a compra, envolvendo EIP, largura de banda compartilhada, VPC, VPN e outros produtos em nuvem. Recursos inativos levam ao desperdício de custos empresariais e devem ser identificados e gerenciados a tempo.\"\n\t},\n\t\"rules\": [\"ecs-disk-idle-check\"]\n\t# \"ecs-instance-status-no-stopped\",  # Commented: ROS ECS::Instance does not support Status property\n\t# \"eip-idle-check\",\n\t# \"nas-filesystem-idle-check\",\n\t# \"internet-natgateway-idle-check\",\n\t# \"intranet-natgateway-idle-check\",\n\t# \"slb-instance-idle-check\",\n\t# \"vpn-gateway-idle-check\"\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:resource-protection-best-practice", Name: models.I18nString{"de": "Ressourcenschutz Best Practices", "en": "Resource Protection Best Practice", "es": "Mejores Prácticas de Protección de Recursos", "fr": "Meilleures Pratiques de Protection des Ressources", "ja": "リソース保護のベストプラクティス", "pt": "Melhores Práticas de Proteção de Recursos", "zh": "资源开启保护最佳实践"}, Description: models.I18nString{"de": "Best Practices zur Aktivierung von Schutzfunktionen für Cloud-Ressourcen, um versehentliches Löschen oder Ändern zu verhindern.", "en": "Best practices for enabling protection features on cloud resources to prevent accidental deletion or modification.", "es": "Mejores prácticas para habilitar funciones de protección en recursos en la nube para prevenir eliminación o modificación accidental.", "fr": "Meilleures pratiques pour activer les fonctions de protection sur les ressources cloud afin de prévenir la suppression ou la modification accidentelle.", "ja": "誤削除や変更を防ぐために、クラウドリソースで保護機能を有効にするベストプラクティス。", "pt": "Melhores práticas para habilitar recursos de proteção em recursos em nuvem para prevenir exclusão ou modificação acidental.", "zh": "为云资源开启保护功能的最佳实践,防止意外删除或修改。"}, RuleIDs: []string{"rule:aliyun:alb-delete-protection-enabled", "rule:aliyun:ecs-instance-deletion-protection-enabled", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:eip-delete-protection-enabled", "rule:aliyun:hbase-cluster-deletion-protection", "rule:aliyun:kms-key-delete-protection-enabled", "rule:aliyun:mongodb-instance-release-protection", "rule:aliyun:natgateway-delete-protection-enabled", "rule:aliyun:polardb-cluster-delete-protection-enabled", "rule:aliyun:rds-instacne-delete-protection-enabled", "rule:aliyun:redis-instance-release-protection", "rule:aliyun:slb-delete-protection-enabled", "rule:aliyun:slb-modify-protection-check"}, FilePath: "aliyun/packs/resource-protection-best-practice.rego", PackageName: "infraguard.packs.aliyun.resource_protection_best_practice", Content: "package infraguard.packs.aliyun.resource_protection_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"resource-protection-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Resource Protection Best Practice\",\n\t\t\"zh\": \"资源开启保护最佳实践\",\n\t\t\"ja\": \"リソース保護のベストプラクティス\",\n\t\t\"de\": \"Ressourcenschutz Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Protección de Recursos\",\n\t\t\"fr\": \"Meilleures Pratiques de Protection des Ressources\",\n\t\t\"pt\": \"Melhores Práticas de Proteção de Recursos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for enabling protection features on cloud resources to prevent accidental deletion or modification.\",\n\t\t\"zh\": \"为云资源开启保护功能的最佳实践,防止意外删除或修改。\",\n\t\t\"ja\": \"誤削除や変更を防ぐために、クラウドリソースで保護機能を有効にするベストプラクティス。\",\n\t\t\"de\": \"Best Practices zur Aktivierung von Schutzfunktionen für Cloud-Ressourcen, um versehentliches Löschen oder Ändern zu verhindern.\",\n\t\t\"es\": \"Mejores prácticas para habilitar funciones de protección en recursos en la nube para prevenir eliminación o modificación accidental.\",\n\t\t\"fr\": \"Meilleures pratiques pour activer les fonctions de protection sur les ressources cloud afin de prévenir la suppression ou la modification accidentelle.\",\n\t\t\"pt\": \"Melhores práticas para habilitar recursos de proteção em recursos em nuvem para prevenir exclusão ou modificação acidental.\"\n\t},\n\t\"rules\": [\n\t\t# \"ack-cluster-deletion-protection-enabled\",\n\t\t\"alb-delete-protection-enabled\",\n\t\t\"ecs-instance-deletion-protection-enabled\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t\"eip-delete-protection-enabled\",\n\t\t\"hbase-cluster-deletion-protection\",\n\t\t\"kms-key-delete-protection-enabled\",\n\t\t\"mongodb-instance-release-protection\",\n\t\t\"natgateway-delete-protection-enabled\",\n\t\t\"polardb-cluster-delete-protection-enabled\",\n\t\t\"rds-instacne-delete-protection-enabled\",\n\t\t\"redis-instance-release-protection\",\n\t\t\"slb-delete-protection-enabled\",\n\t\t\"slb-modify-protection-check\",\n\t\t# \"waf-domain-enabled-specified-protection-mode\",\n\t\t# \"waf-domain-enabled-specified-protection-module\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:resource-public-access-detection-best-practice", Name: models.I18nString{"de": "Ressourcen-Öffentlicher-Zugriff-Erkennung Best Practices", "en": "Resource Public Access Detection Best Practice", "es": "Mejores Prácticas de Detección de Acceso Público a Recursos", "fr": "Meilleures Pratiques de Détection d'Accès Public aux Ressources", "ja": "リソースパブリックアクセス検出のベストプラクティス", "pt": "Melhores Práticas de Detecção de Acesso Público a Recursos", "zh": "资源开启公网检测最佳实践"}, Description: models.I18nString{"de": "Best Practices zur Erkennung und Verwaltung des öffentlichen Zugriffs auf Cloud-Ressourcen, um Sicherheit zu gewährleisten.", "en": "Best practices for detecting and managing public access to cloud resources to ensure security.", "es": "Mejores prácticas para detectar y gestionar el acceso público a recursos en la nube para garantizar la seguridad.", "fr": "Meilleures pratiques pour détecter et gérer l'accès public aux ressources cloud afin de garantir la sécurité.", "ja": "セキュリティを確保するために、クラウドリソースへのパブリックアクセスを検出および管理するベストプラクティス。", "pt": "Melhores práticas para detectar e gerenciar acesso público a recursos em nuvem para garantir segurança.", "zh": "检测和管理云资源公网访问的最佳实践,确保安全性。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-public-endpoint-check", "rule:aliyun:cr-repository-type-private", "rule:aliyun:ecs-running-instance-no-public-ip", "rule:aliyun:elasticsearch-public-and-any-ip-access-check", "rule:aliyun:emr-cluster-master-public-access-check", "rule:aliyun:mongodb-public-and-any-ip-access-check", "rule:aliyun:mse-cluster-config-auth-enabled", "rule:aliyun:polardb-public-and-any-ip-access-check", "rule:aliyun:rds-public-access-check", "rule:aliyun:redis-public-and-any-ip-access-check", "rule:aliyun:sg-public-access-check"}, FilePath: "aliyun/packs/resource-public-access-detection-best-practice.rego", PackageName: "infraguard.packs.aliyun.resource_public_access_detection_best_practice", Content: "package infraguard.packs.aliyun.resource_public_access_detection_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"resource-public-access-detection-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Resource Public Access Detection Best Practice\",\n\t\t\"zh\": \"资源开启公网检测最佳实践\",\n\t\t\"ja\": \"リソースパブリックアクセス検出のベストプラクティス\",\n\t\t\"de\": \"Ressourcen-Öffentlicher-Zugriff-Erkennung Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Detección de Acceso Público a Recursos\",\n\t\t\"fr\": \"Meilleures Pratiques de Détection d'Accès Public aux Ressources\",\n\t\t\"pt\": \"Melhores Práticas de Detecção de Acesso Público a Recursos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for detecting and managing public access to cloud resources to ensure security.\",\n\t\t\"zh\": \"检测和管理云资源公网访问的最佳实践,确保安全性。\",\n\t\t\"ja\": \"セキュリティを確保するために、クラウドリソースへのパブリックアクセスを検出および管理するベストプラクティス。\",\n\t\t\"de\": \"Best Practices zur Erkennung und Verwaltung des öffentlichen Zugriffs auf Cloud-Ressourcen, um Sicherheit zu gewährleisten.\",\n\t\t\"es\": \"Mejores prácticas para detectar y gestionar el acceso público a recursos en la nube para garantizar la seguridad.\",\n\t\t\"fr\": \"Meilleures pratiques pour détecter et gérer l'accès public aux ressources cloud afin de garantir la sécurité.\",\n\t\t\"pt\": \"Melhores práticas para detectar e gerenciar acesso público a recursos em nuvem para garantir segurança.\"\n\t},\n\t\"rules\": [\n\t\t\"ack-cluster-public-endpoint-check\",\n\t\t# \"adb-public-access-check\",  # Commented: ROS ADB::DBCluster does not support PublicEndpoint property,\n\t\t# \"apigateway-ipv4-public-access-check\",\n\t\t# \"apigateway-ipv6-public-access-check\",\n\t\t# \"cr-instance-public-access-check\",  # Commented: ROS CR::Instance does not support PublicNetworkAccess property,\n\t\t\"cr-repository-type-private\",\n\t\t\"ecs-running-instance-no-public-ip\",\n\t\t\"elasticsearch-public-and-any-ip-access-check\",\n\t\t\"emr-cluster-master-public-access-check\",\n\t\t# \"hbase-public-access-check\",\n\t\t# \"kafka-instance-public-access-check\",\n\t\t# \"lindorm-instance-public-access-check\",\n\t\t\"mongodb-public-and-any-ip-access-check\",\n\t\t\"mse-cluster-config-auth-enabled\",\n\t\t# \"nas-access-group-public-access-check\",\n\t\t# \"oceanbase-public-and-any-ip-access-check\",\n\t\t# \"ots-instance-network-not-normal\",\n\t\t\"polardb-public-and-any-ip-access-check\",\n\t\t\"rds-public-access-check\",\n\t\t\"redis-public-and-any-ip-access-check\",\n\t\t\"sg-public-access-check\",\n\t\t# \"tsdb-instance-public-access-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:resource-stability-best-practice", Name: models.I18nString{"de": "Ressourcenstabilität Best Practices", "en": "Resource Stability Best Practice", "es": "Mejores Prácticas de Estabilidad de Recursos", "fr": "Meilleures Pratiques de Stabilité des Ressources", "ja": "リソース安定性のベストプラクティス", "pt": "Melhores Práticas de Estabilidade de Recursos", "zh": "资源稳定性最佳实践"}, Description: models.I18nString{"de": "Erkennung der Ressourcenstabilität aus sechs Dimensionen: Hochverfügbarkeitsarchitektur, Kapazitätsschutz, Änderungsmanagement, Monitoring-Management, Backup-Management und Fehlerisolierung, was hilft, Risiken im Voraus zu identifizieren und die Stabilität und Betriebseffizienz zu verbessern.", "en": "Detect resource stability from six dimensions: high availability architecture, capacity protection, change management, monitoring management, backup management, and fault isolation, which helps to identify risks in advance and improve stability and O&M efficiency.", "es": "Detectar la estabilidad de los recursos desde seis dimensiones: arquitectura de alta disponibilidad, protección de capacidad, gestión de cambios, gestión de monitoreo, gestión de respaldo y aislamiento de fallas, lo que ayuda a identificar riesgos con anticipación y mejorar la estabilidad y la eficiencia operativa.", "fr": "Détecter la stabilité des ressources à partir de six dimensions : architecture haute disponibilité, protection de capacité, gestion des changements, gestion de la surveillance, gestion de la sauvegarde et isolation des pannes, ce qui aide à identifier les risques à l'avance et à améliorer la stabilité et l'efficacité opérationnelle.", "ja": "高可用性アーキテクチャ、容量保護、変更管理、監視管理、バックアップ管理、障害分離の6つの次元からリソースの安定性を検出し、リスクを事前に特定し、安定性と運用効率を向上させます。", "pt": "Detectar estabilidade de recursos a partir de seis dimensões: arquitetura de alta disponibilidade, proteção de capacidade, gestão de mudanças, gestão de monitoramento, gestão de backup e isolamento de falhas, o que ajuda a identificar riscos com antecedência e melhorar a estabilidade e a eficiência operacional.", "zh": "从高可用基础架构、容量保护、变更管理、监控管理、备份管理、故障隔离六大维度对云上资源的稳定性做检测，有助于提前发现隐患，提升稳定性和运维效率。"}, RuleIDs: []string{"rule:aliyun:ack-cluster-upgrade-latest-version", "rule:aliyun:alb-all-listener-health-check-enabled", "rule:aliyun:alb-all-listenter-has-server", "rule:aliyun:alb-delete-protection-enabled", "rule:aliyun:bastionhost-instance-expired-check", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-instance-deletion-protection-enabled", "rule:aliyun:ecs-instance-expired-check", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:ecs-snapshot-policy-timepoints-check", "rule:aliyun:eip-delete-protection-enabled", "rule:aliyun:elasticsearch-instance-multi-zone", "rule:aliyun:elasticsearch-public-and-any-ip-access-check", "rule:aliyun:mongodb-cluster-expired-check", "rule:aliyun:mongodb-instance-multi-zone", "rule:aliyun:mongodb-instance-release-protection", "rule:aliyun:mongodb-public-access-check", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-delete-protection-enabled", "rule:aliyun:polardb-cluster-expired-check", "rule:aliyun:polardb-cluster-maintain-time-check", "rule:aliyun:polardb-cluster-multi-zone", "rule:aliyun:rds-instacne-delete-protection-enabled", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-instance-expired-check", "rule:aliyun:rds-instance-maintain-time-check", "rule:aliyun:rds-multi-az-support", "rule:aliyun:rds-public-access-check", "rule:aliyun:redis-instance-backup-log-enabled", "rule:aliyun:redis-instance-backup-time-check", "rule:aliyun:redis-instance-expired-check", "rule:aliyun:redis-instance-multi-zone", "rule:aliyun:redis-instance-release-protection", "rule:aliyun:slb-all-listener-health-check-enabled", "rule:aliyun:slb-all-listener-servers-multi-zone", "rule:aliyun:slb-delete-protection-enabled", "rule:aliyun:slb-instance-multi-zone"}, FilePath: "aliyun/packs/resource-stability-best-practice.rego", PackageName: "infraguard.packs.aliyun.resource_stability_best_practice", Content: "# Resource Stability Best Practice Pack\n# Detect resource stability from six dimensions: high availability, capacity protection,\n# change management, monitoring, backup, and fault isolation.\npackage infraguard.packs.aliyun.resource_stability_best_practice\n\nimport rego.v1\n\n# Pack metadata with i18n support\npack_meta := {\n\t\"id\": \"resource-stability-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Resource Stability Best Practice\",\n\t\t\"zh\": \"资源稳定性最佳实践\",\n\t\t\"ja\": \"リソース安定性のベストプラクティス\",\n\t\t\"de\": \"Ressourcenstabilität Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Estabilidad de Recursos\",\n\t\t\"fr\": \"Meilleures Pratiques de Stabilité des Ressources\",\n\t\t\"pt\": \"Melhores Práticas de Estabilidade de Recursos\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Detect resource stability from six dimensions: high availability architecture, capacity protection, change management, monitoring management, backup management, and fault isolation, which helps to identify risks in advance and improve stability and O&M efficiency.\",\n\t\t\"zh\": \"从高可用基础架构、容量保护、变更管理、监控管理、备份管理、故障隔离六大维度对云上资源的稳定性做检测，有助于提前发现隐患，提升稳定性和运维效率。\",\n\t\t\"ja\": \"高可用性アーキテクチャ、容量保護、変更管理、監視管理、バックアップ管理、障害分離の6つの次元からリソースの安定性を検出し、リスクを事前に特定し、安定性と運用効率を向上させます。\",\n\t\t\"de\": \"Erkennung der Ressourcenstabilität aus sechs Dimensionen: Hochverfügbarkeitsarchitektur, Kapazitätsschutz, Änderungsmanagement, Monitoring-Management, Backup-Management und Fehlerisolierung, was hilft, Risiken im Voraus zu identifizieren und die Stabilität und Betriebseffizienz zu verbessern.\",\n\t\t\"es\": \"Detectar la estabilidad de los recursos desde seis dimensiones: arquitectura de alta disponibilidad, protección de capacidad, gestión de cambios, gestión de monitoreo, gestión de respaldo y aislamiento de fallas, lo que ayuda a identificar riesgos con anticipación y mejorar la estabilidad y la eficiencia operativa.\",\n\t\t\"fr\": \"Détecter la stabilité des ressources à partir de six dimensions : architecture haute disponibilité, protection de capacité, gestion des changements, gestion de la surveillance, gestion de la sauvegarde et isolation des pannes, ce qui aide à identifier les risques à l'avance et à améliorer la stabilité et l'efficacité opérationnelle.\",\n\t\t\"pt\": \"Detectar estabilidade de recursos a partir de seis dimensões: arquitetura de alta disponibilidade, proteção de capacidade, gestão de mudanças, gestão de monitoramento, gestão de backup e isolamento de falhas, o que ajuda a identificar riscos com antecedência e melhorar a estabilidade e a eficiência operacional.\"\n\t},\n\t\"rules\": [\n\t\t# \"ack-cluster-deletion-protection-enabled\",\n\t\t# \"ack-cluster-spec-check\",\n\t\t\"ack-cluster-upgrade-latest-version\",\n\t\t# \"adb-cluster-expired-check\",\n\t\t# \"adb-cluster-log-backup-enabled\",\n\t\t# \"adb-cluster-maintain-time-check\",  # Commented: ROS ADB::DBCluster does not support MaintainTime property,\n\t\t\"alb-all-listener-health-check-enabled\",\n\t\t\"alb-all-listenter-has-server\",\n\t\t\"alb-delete-protection-enabled\",\n\t\t\"bastionhost-instance-expired-check\",\n\t\t# \"cbwp-bandwidth-package-expired-check\",\n\t\t# \"cdn-domain-enabled-cache\",\n\t\t# \"cdn-domain-oss-source-check\",\n\t\t# \"cen-all-vbr-health-check-enabled\",\n\t\t# \"cen-bandwidth-package-expired-check\",\n\t\t# \"cen-cross-region-bandwidth-check\",\n\t\t# \"ddoscoo-instance-expired-check\",\n\t\t# \"eci-container-group-volumn-mounts\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-instance-deletion-protection-enabled\",\n\t\t\"ecs-instance-expired-check\",\n\t\t# \"ecs-instance-os-name-check\",\n\t\t# \"ecs-instance-status-no-stopped\",  # Commented: ROS ECS::Instance does not support Status property,\n\t\t# \"ecs-instance-type-family-not-deprecated\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"ecs-snapshot-policy-timepoints-check\",\n\t\t# \"eip-address-expired-check\",\n\t\t\"eip-delete-protection-enabled\",\n\t\t# \"elasticsearch-instance-enabled-kibana-public-check\",\n\t\t\"elasticsearch-instance-multi-zone\",\n\t\t# \"elasticsearch-instance-node-not-use-specified-spec\",\n\t\t# \"elasticsearch-instance-snapshot-enabled\",  # Commented: ROS does not support AutoSnapshot property for ALIYUN::ElasticSearch::Instance,\n\t\t# \"elasticsearch-instance-version-not-deprecated\",\n\t\t\"elasticsearch-public-and-any-ip-access-check\",\n\t\t# \"kafka-instance-public-access-check\",\n\t\t\"mongodb-cluster-expired-check\",\n\t\t# \"mongodb-instance-backup-log-enabled\",  # Commented: ROS does not support ALIYUN::MongoDB::DBInstance resource type,\n\t\t# \"mongodb-instance-class-not-shared\",\n\t\t# \"mongodb-instance-multi-node\",\n\t\t\"mongodb-instance-multi-zone\",\n\t\t\"mongodb-instance-release-protection\",\n\t\t\"mongodb-public-access-check\",\n\t\t# \"natgateway-eip-used-check\",\n\t\t# \"natgateway-snat-eip-bandwidth-check\",\n\t\t# \"ons-instance-type-check\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-zrs-enabled\",\n\t\t# \"polardb-cluster-category-normal\",\n\t\t\"polardb-cluster-delete-protection-enabled\",\n\t\t\"polardb-cluster-expired-check\",\n\t\t# \"polardb-cluster-level-two-backup-retention\",\n\t\t\"polardb-cluster-maintain-time-check\",\n\t\t\"polardb-cluster-multi-zone\",\n\t\t# \"polardb-dbversion-status-check\",\n\t\t# \"polardb-public-access-check\",\n\t\t# \"polardb-x1-instance-expired-check\",\n\t\t# \"polardb-x2-instance-expired-check\",\n\t\t\"rds-instacne-delete-protection-enabled\",\n\t\t# \"rds-instance-category-check\",\n\t\t# \"rds-instance-class-type-check\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t# \"rds-instance-enabled-security-ip-list\",\n\t\t\"rds-instance-expired-check\",\n\t\t\"rds-instance-maintain-time-check\",\n\t\t# \"rds-instance-sql-collector-retention\",  # Commented: ROS RDS::DBInstance does not support SQLCollectorRetention property,\n\t\t\"rds-multi-az-support\",\n\t\t\"rds-public-access-check\",\n\t\t# \"redis-architecturetype-cluster-check\",\n\t\t\"redis-instance-backup-log-enabled\",\n\t\t\"redis-instance-backup-time-check\",\n\t\t# \"redis-instance-disable-risk-commands\",\n\t\t# \"redis-instance-edition-type-check\",\n\t\t\"redis-instance-expired-check\",\n\t\t\"redis-instance-multi-zone\",\n\t\t\"redis-instance-release-protection\",\n\t\t# \"redis-instance-upgrade-latest-version\",\n\t\t# \"redis-public-access-check\",\n\t\t# \"region-vswitch-no-crossed-cidr\",\n\t\t\"slb-all-listener-health-check-enabled\",\n\t\t\"slb-all-listener-servers-multi-zone\",\n\t\t\"slb-delete-protection-enabled\",\n\t\t# \"slb-instance-expired-check\",\n\t\t\"slb-instance-multi-zone\",\n\t\t# \"slb-instance-spec-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:rmit-financial-standard-compliance-pack", Name: models.I18nString{"de": "RMiT Finanzstandard-Compliance-Paket", "en": "RMiT Financial Standard Compliance Pack", "es": "Paquete de Cumplimiento del Estándar Financiero RMiT", "fr": "Pack de Conformité à la Norme Financière RMiT", "ja": "RMiT 金融標準コンプライアンスパック", "pt": "Pacote de Conformidade com Padrão Financeiro RMiT", "zh": "RMiT 金融标准检查合规包"}, Description: models.I18nString{"de": "Compliance-Paket für RMiT-Finanzstandards", "en": "Compliance pack for RMiT financial standards", "es": "Paquete de cumplimiento para estándares financieros RMiT", "fr": "Pack de conformité pour les normes financières RMiT", "ja": "RMiT 金融標準のコンプライアンスパック", "pt": "Pacote de conformidade para padrões financeiros RMiT", "zh": "RMiT 金融标准检查合规包"}, RuleIDs: []string{"rule:aliyun:actiontrail-enabled", "rule:aliyun:actiontrail-trail-intact-enabled", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-disk-encrypted", "rule:aliyun:ecs-instances-in-vpc", "rule:aliyun:kms-key-rotation-enabled", "rule:aliyun:oss-bucket-anonymous-prohibited", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-bucket-server-side-encryption-enabled", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-default-encryption-kms", "rule:aliyun:oss-encryption-byok-check", "rule:aliyun:ram-group-has-member-check", "rule:aliyun:ram-password-policy-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-group-membership-check", "rule:aliyun:ram-user-last-login-expired-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:ram-user-no-policy-check", "rule:aliyun:rds-multi-az-support", "rule:aliyun:rds-public-access-check", "rule:aliyun:root-ak-check", "rule:aliyun:sg-public-access-check", "rule:aliyun:slb-delete-protection-enabled", "rule:aliyun:slb-listener-https-enabled", "rule:aliyun:vpc-flow-logs-enabled", "rule:aliyun:waf-instance-logging-enabled"}, FilePath: "aliyun/packs/rmit-financial-standard-compliance-pack.rego", PackageName: "infraguard.packs.aliyun.rmit_financial_standard_compliance_pack", Content: "package infraguard.packs.aliyun.rmit_financial_standard_compliance_pack\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"rmit-financial-standard-compliance-pack\",\n\t\"name\": {\n\t\t\"en\": \"RMiT Financial Standard Compliance Pack\",\n\t\t\"zh\": \"RMiT 金融标准检查合规包\",\n\t\t\"ja\": \"RMiT 金融標準コンプライアンスパック\",\n\t\t\"de\": \"RMiT Finanzstandard-Compliance-Paket\",\n\t\t\"es\": \"Paquete de Cumplimiento del Estándar Financiero RMiT\",\n\t\t\"fr\": \"Pack de Conformité à la Norme Financière RMiT\",\n\t\t\"pt\": \"Pacote de Conformidade com Padrão Financeiro RMiT\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for RMiT financial standards\",\n\t\t\"zh\": \"RMiT 金融标准检查合规包\",\n\t\t\"ja\": \"RMiT 金融標準のコンプライアンスパック\",\n\t\t\"de\": \"Compliance-Paket für RMiT-Finanzstandards\",\n\t\t\"es\": \"Paquete de cumplimiento para estándares financieros RMiT\",\n\t\t\"fr\": \"Pack de conformité pour les normes financières RMiT\",\n\t\t\"pt\": \"Pacote de conformidade para padrões financeiros RMiT\"\n\t},\n\t\"rules\": [\n\t\t\"actiontrail-enabled\",\n\t\t\"actiontrail-trail-intact-enabled\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-disk-encrypted\",\n\t\t# \"ecs-instance-no-public-ip\",\n\t\t\"ecs-instances-in-vpc\",\n\t\t# \"elasticsearch-instance-in-vpc\",  # Commented: ROS ALIYUN::ElasticSearch::Instance requires VSwitchId (all instances are in VPC),\n\t\t\"kms-key-rotation-enabled\",\n\t\t\"oss-bucket-anonymous-prohibited\",\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t\"oss-bucket-server-side-encryption-enabled\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-default-encryption-kms\",\n\t\t\"oss-encryption-byok-check\",\n\t\t\"ram-group-has-member-check\",\n\t\t\"ram-password-policy-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t\"ram-user-group-membership-check\",\n\t\t\"ram-user-last-login-expired-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"ram-user-no-policy-check\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t\"rds-multi-az-support\",\n\t\t\"rds-public-access-check\",\n\t\t\"root-ak-check\",\n\t\t\"sg-public-access-check\",\n\t\t\"slb-delete-protection-enabled\",\n\t\t\"slb-listener-https-enabled\",\n\t\t# \"slb-server-certificate-expired\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t# \"vpn-ipsec-connection-status-check\",\n\t\t\"waf-instance-logging-enabled\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:ros-best-practice", Name: models.I18nString{"de": "ROS Best Practices Paket", "en": "ROS Best Practice Pack", "es": "Paquete de Mejores Prácticas ROS", "fr": "Pack de Meilleures Pratiques ROS", "ja": "ROS ベストプラクティスパック", "pt": "Pacote de Melhores Práticas ROS", "zh": "ROS 最佳实践合规包"}, Description: models.I18nString{"de": "Ein Compliance-Paket, das ROS-Vorlagen-Best-Practices abdeckt, einschließlich Metadaten-Konfiguration und Schutz sensibler Parameter.", "en": "A compliance pack covering ROS template best practices, including metadata configuration and sensitive parameter protection.", "es": "Un paquete de cumplimiento que cubre las mejores prácticas de plantillas ROS, incluyendo configuración de metadatos y protección de parámetros sensibles.", "fr": "Un pack de conformité couvrant les meilleures pratiques des modèles ROS, incluant la configuration des métadonnées et la protection des paramètres sensibles.", "ja": "メタデータ設定や機密パラメータ保護を含む ROS テンプレートのベストプラクティスをカバーするコンプライアンスパック。", "pt": "Um pacote de conformidade cobrindo as melhores práticas de templates ROS, incluindo configuração de metadados e proteção de parâmetros sensíveis.", "zh": "涵盖 ROS 模板最佳实践的合规包，包括元数据配置和敏感参数保护等。"}, RuleIDs: []string{"rule:aliyun:metadata-ros-composer-check", "rule:aliyun:parameter-sensitive-noecho-check"}, FilePath: "aliyun/packs/ros-best-practice.rego", PackageName: "infraguard.packs.aliyun.ros_best_practice", Content: "package infraguard.packs.aliyun.ros_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"ros-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"ROS Best Practice Pack\",\n\t\t\"zh\": \"ROS 最佳实践合规包\",\n\t\t\"ja\": \"ROS ベストプラクティスパック\",\n\t\t\"de\": \"ROS Best Practices Paket\",\n\t\t\"es\": \"Paquete de Mejores Prácticas ROS\",\n\t\t\"fr\": \"Pack de Meilleures Pratiques ROS\",\n\t\t\"pt\": \"Pacote de Melhores Práticas ROS\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"A compliance pack covering ROS template best practices, including metadata configuration and sensitive parameter protection.\",\n\t\t\"zh\": \"涵盖 ROS 模板最佳实践的合规包，包括元数据配置和敏感参数保护等。\",\n\t\t\"ja\": \"メタデータ設定や機密パラメータ保護を含む ROS テンプレートのベストプラクティスをカバーするコンプライアンスパック。\",\n\t\t\"de\": \"Ein Compliance-Paket, das ROS-Vorlagen-Best-Practices abdeckt, einschließlich Metadaten-Konfiguration und Schutz sensibler Parameter.\",\n\t\t\"es\": \"Un paquete de cumplimiento que cubre las mejores prácticas de plantillas ROS, incluyendo configuración de metadatos y protección de parámetros sensibles.\",\n\t\t\"fr\": \"Un pack de conformité couvrant les meilleures pratiques des modèles ROS, incluant la configuration des métadonnées et la protection des paramètres sensibles.\",\n\t\t\"pt\": \"Um pacote de conformidade cobrindo as melhores práticas de templates ROS, incluindo configuração de metadados e proteção de parâmetros sensíveis.\"\n\t},\n\t\"rules\": [\n\t\t\"metadata-ros-composer-check\",\n\t\t\"parameter-sensitive-noecho-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:security-group-best-practice", Name: models.I18nString{"de": "Sicherheitsgruppe Best Practices", "en": "Security Group Best Practice", "es": "Mejores Prácticas de Grupo de Seguridad", "fr": "Meilleures Pratiques de Groupe de Sécurité", "ja": "セキュリティグループのベストプラクティス", "pt": "Melhores Práticas de Grupo de Segurança", "zh": "安全组最佳实践"}, Description: models.I18nString{"de": "Kontinuierliche Überprüfung der Sicherheitsgruppen-Regeln auf Compliance, um Sicherheitsrisiken zu reduzieren.", "en": "Continuously check security group rules for compliance to reduce security risks.", "es": "Verificar continuamente las reglas del grupo de seguridad para cumplimiento y reducir los riesgos de seguridad.", "fr": "Vérifier continuellement les règles du groupe de sécurité pour la conformité et réduire les risques de sécurité.", "ja": "セキュリティリスクを低減するために、セキュリティグループルールのコンプライアンスを継続的にチェックします。", "pt": "Verificar continuamente as regras do grupo de segurança para conformidade e reduzir riscos de segurança.", "zh": "持续检查安全组规则的合规性，降低安全风险。"}, RuleIDs: []string{"rule:aliyun:ecs-instance-attached-security-group", "rule:aliyun:ecs-security-group-egress-not-all-access", "rule:aliyun:ecs-security-group-not-internet-cidr-access", "rule:aliyun:ecs-security-group-not-open-all-port", "rule:aliyun:ecs-security-group-not-open-all-protocol", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:ecs-security-group-white-list-port-check", "rule:aliyun:sg-public-access-check"}, FilePath: "aliyun/packs/security-group-best-practice.rego", PackageName: "infraguard.packs.aliyun.security_group_best_practice", Content: "# Security Group Best Practice Pack\n# A collection of rules for checking security group compliance to reduce security risks.\npackage infraguard.packs.aliyun.security_group_best_practice\n\nimport rego.v1\n\n# Pack metadata with i18n support\npack_meta := {\n\t\"id\": \"security-group-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Best Practice\",\n\t\t\"zh\": \"安全组最佳实践\",\n\t\t\"ja\": \"セキュリティグループのベストプラクティス\",\n\t\t\"de\": \"Sicherheitsgruppe Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Grupo de Seguridad\",\n\t\t\"fr\": \"Meilleures Pratiques de Groupe de Sécurité\",\n\t\t\"pt\": \"Melhores Práticas de Grupo de Segurança\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Continuously check security group rules for compliance to reduce security risks.\",\n\t\t\"zh\": \"持续检查安全组规则的合规性，降低安全风险。\",\n\t\t\"ja\": \"セキュリティリスクを低減するために、セキュリティグループルールのコンプライアンスを継続的にチェックします。\",\n\t\t\"de\": \"Kontinuierliche Überprüfung der Sicherheitsgruppen-Regeln auf Compliance, um Sicherheitsrisiken zu reduzieren.\",\n\t\t\"es\": \"Verificar continuamente las reglas del grupo de seguridad para cumplimiento y reducir los riesgos de seguridad.\",\n\t\t\"fr\": \"Vérifier continuellement les règles du groupe de sécurité pour la conformité et réduire les risques de sécurité.\",\n\t\t\"pt\": \"Verificar continuamente as regras do grupo de segurança para conformidade e reduzir riscos de segurança.\"\n\t},\n\t\"rules\": [\n\t\t\"ecs-instance-attached-security-group\",\n\t\t\"ecs-security-group-egress-not-all-access\",\n\t\t\"ecs-security-group-not-internet-cidr-access\",\n\t\t\"ecs-security-group-not-open-all-port\",\n\t\t\"ecs-security-group-not-open-all-protocol\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"ecs-security-group-white-list-port-check\",\n\t\t\"sg-public-access-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:security-group-best-practice-v2", Name: models.I18nString{"de": "Sicherheitsgruppe Best Practices", "en": "Security Group Best Practice", "es": "Mejores Prácticas de Grupo de Seguridad", "fr": "Meilleures Pratiques de Groupe de Sécurité", "ja": "セキュリティグループのベストプラクティス", "pt": "Melhores Práticas de Grupo de Segurança", "zh": "安全组最佳实践"}, Description: models.I18nString{"de": "Best Practices für die ECS-Sicherheitsgruppen-Konfiguration, um Netzwerksicherheit und Zugriffskontrolle sicherzustellen. Enthält Prüfungen für riskante Ports, Zugriffsbeschränkungen und Sicherheitsgruppen-Einstellungen.", "en": "Best practices for ECS security group configuration to ensure network security and access control. Includes checks for risky ports, access restrictions, and security group settings.", "es": "Mejores prácticas para la configuración de grupos de seguridad ECS para garantizar la seguridad de la red y el control de acceso. Incluye verificaciones de puertos riesgosos, restricciones de acceso y configuraciones de grupos de seguridad.", "fr": "Meilleures pratiques pour la configuration des groupes de sécurité ECS afin d'assurer la sécurité du réseau et le contrôle d'accès. Inclut les vérifications des ports à risque, les restrictions d'accès et les configurations des groupes de sécurité.", "ja": "ネットワークセキュリティとアクセス制御を確保するための ECS セキュリティグループ設定のベストプラクティス。リスクのあるポート、アクセス制限、セキュリティグループ設定のチェックが含まれます。", "pt": "Melhores práticas para configuração de grupo de segurança ECS para garantir segurança de rede e controle de acesso. Inclui verificações de portas de risco, restrições de acesso e configurações de grupo de segurança.", "zh": "ECS 安全组配置最佳实践，确保网络安全和访问控制。包括危险端口检查、访问限制和安全组设置检查。"}, RuleIDs: []string{"rule:aliyun:ecs-instance-attached-security-group", "rule:aliyun:ecs-security-group-egress-not-all-access", "rule:aliyun:ecs-security-group-not-internet-cidr-access", "rule:aliyun:ecs-security-group-not-open-all-port", "rule:aliyun:ecs-security-group-not-open-all-protocol", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:ecs-security-group-white-list-port-check", "rule:aliyun:sg-public-access-check"}, FilePath: "aliyun/packs/security-group-best-practice-v2.rego", PackageName: "infraguard.packs.aliyun.security_group_best_practice_v2", Content: "package infraguard.packs.aliyun.security_group_best_practice_v2\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"security-group-best-practice-v2\",\n\t\"name\": {\n\t\t\"en\": \"Security Group Best Practice\",\n\t\t\"zh\": \"安全组最佳实践\",\n\t\t\"ja\": \"セキュリティグループのベストプラクティス\",\n\t\t\"de\": \"Sicherheitsgruppe Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Grupo de Seguridad\",\n\t\t\"fr\": \"Meilleures Pratiques de Groupe de Sécurité\",\n\t\t\"pt\": \"Melhores Práticas de Grupo de Segurança\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for ECS security group configuration to ensure network security and access control. Includes checks for risky ports, access restrictions, and security group settings.\",\n\t\t\"zh\": \"ECS 安全组配置最佳实践，确保网络安全和访问控制。包括危险端口检查、访问限制和安全组设置检查。\",\n\t\t\"ja\": \"ネットワークセキュリティとアクセス制御を確保するための ECS セキュリティグループ設定のベストプラクティス。リスクのあるポート、アクセス制限、セキュリティグループ設定のチェックが含まれます。\",\n\t\t\"de\": \"Best Practices für die ECS-Sicherheitsgruppen-Konfiguration, um Netzwerksicherheit und Zugriffskontrolle sicherzustellen. Enthält Prüfungen für riskante Ports, Zugriffsbeschränkungen und Sicherheitsgruppen-Einstellungen.\",\n\t\t\"es\": \"Mejores prácticas para la configuración de grupos de seguridad ECS para garantizar la seguridad de la red y el control de acceso. Incluye verificaciones de puertos riesgosos, restricciones de acceso y configuraciones de grupos de seguridad.\",\n\t\t\"fr\": \"Meilleures pratiques pour la configuration des groupes de sécurité ECS afin d'assurer la sécurité du réseau et le contrôle d'accès. Inclut les vérifications des ports à risque, les restrictions d'accès et les configurations des groupes de sécurité.\",\n\t\t\"pt\": \"Melhores práticas para configuração de grupo de segurança ECS para garantir segurança de rede e controle de acesso. Inclui verificações de portas de risco, restrições de acesso e configurações de grupo de segurança.\"\n\t},\n\t\"rules\": [\n\t\t\"ecs-instance-attached-security-group\",\n\t\t\"ecs-security-group-egress-not-all-access\",\n\t\t\"ecs-security-group-not-internet-cidr-access\",\n\t\t\"ecs-security-group-not-open-all-port\",\n\t\t\"ecs-security-group-not-open-all-protocol\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"ecs-security-group-white-list-port-check\",\n\t\t\"sg-public-access-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:slb-application-best-practice", Name: models.I18nString{"de": "SLB-Anwendung Best Practices", "en": "SLB Application Best Practice", "es": "Mejores Prácticas de Aplicación SLB", "fr": "Meilleures Pratiques d'Application SLB", "ja": "SLB アプリケーションのベストプラクティス", "pt": "Melhores Práticas de Aplicação SLB", "zh": "负载均衡应用最佳实践"}, Description: models.I18nString{"de": "Best Practices für SLB- und ALB-Konfiguration, einschließlich Hochverfügbarkeit, Sicherheit, Health Checks und Betriebseinstellungen.", "en": "Best practices for SLB and ALB configuration, covering high availability, security, health checks, and operational settings.", "es": "Mejores prácticas para la configuración de SLB y ALB, que cubren alta disponibilidad, seguridad, verificaciones de salud y configuraciones operativas.", "fr": "Meilleures pratiques pour la configuration SLB et ALB, couvrant la haute disponibilité, la sécurité, les contrôles de santé et les paramètres opérationnels.", "ja": "高可用性、セキュリティ、ヘルスチェック、運用設定をカバーする SLB および ALB 設定のベストプラクティス。", "pt": "Melhores práticas para configuração SLB e ALB, cobrindo alta disponibilidade, segurança, verificações de saúde e configurações operacionais.", "zh": "SLB 和 ALB 配置最佳实践,涵盖高可用、安全、健康检查和运维设置。"}, RuleIDs: []string{"rule:aliyun:alb-address-type-check", "rule:aliyun:alb-all-listener-health-check-enabled", "rule:aliyun:slb-acl-public-access-check", "rule:aliyun:slb-all-listener-health-check-enabled", "rule:aliyun:slb-all-listener-servers-multi-zone", "rule:aliyun:slb-all-listenter-tls-policy-check", "rule:aliyun:slb-delete-protection-enabled", "rule:aliyun:slb-instance-loadbalancerspec-check", "rule:aliyun:slb-instance-multi-zone", "rule:aliyun:slb-listener-https-enabled", "rule:aliyun:slb-modify-protection-check"}, FilePath: "aliyun/packs/slb-application-best-practice.rego", PackageName: "infraguard.packs.aliyun.slb_application_best_practice", Content: "package infraguard.packs.aliyun.slb_application_best_practice\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"slb-application-best-practice\",\n\t\"name\": {\n\t\t\"en\": \"SLB Application Best Practice\",\n\t\t\"zh\": \"负载均衡应用最佳实践\",\n\t\t\"ja\": \"SLB アプリケーションのベストプラクティス\",\n\t\t\"de\": \"SLB-Anwendung Best Practices\",\n\t\t\"es\": \"Mejores Prácticas de Aplicación SLB\",\n\t\t\"fr\": \"Meilleures Pratiques d'Application SLB\",\n\t\t\"pt\": \"Melhores Práticas de Aplicação SLB\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Best practices for SLB and ALB configuration, covering high availability, security, health checks, and operational settings.\",\n\t\t\"zh\": \"SLB 和 ALB 配置最佳实践,涵盖高可用、安全、健康检查和运维设置。\",\n\t\t\"ja\": \"高可用性、セキュリティ、ヘルスチェック、運用設定をカバーする SLB および ALB 設定のベストプラクティス。\",\n\t\t\"de\": \"Best Practices für SLB- und ALB-Konfiguration, einschließlich Hochverfügbarkeit, Sicherheit, Health Checks und Betriebseinstellungen.\",\n\t\t\"es\": \"Mejores prácticas para la configuración de SLB y ALB, que cubren alta disponibilidad, seguridad, verificaciones de salud y configuraciones operativas.\",\n\t\t\"fr\": \"Meilleures pratiques pour la configuration SLB et ALB, couvrant la haute disponibilité, la sécurité, les contrôles de santé et les paramètres opérationnels.\",\n\t\t\"pt\": \"Melhores práticas para configuração SLB e ALB, cobrindo alta disponibilidade, segurança, verificações de saúde e configurações operacionais.\"\n\t},\n\t\"rules\": [\n\t\t# \"alb-acl-has-specified-ip\",\n\t\t\"alb-address-type-check\",\n\t\t# \"alb-all-listener-enabled-acl\",  # Commented: ROS ALB::Listener does not support AclConfig property,\n\t\t\"alb-all-listener-health-check-enabled\",\n\t\t# \"alb-instance-idle-check\",\n\t\t# \"slb-acl-has-specified-ip\",\n\t\t\"slb-acl-public-access-check\",\n\t\t\"slb-all-listener-health-check-enabled\",\n\t\t\"slb-all-listener-servers-multi-zone\",\n\t\t\"slb-all-listenter-tls-policy-check\",\n\t\t\"slb-delete-protection-enabled\",\n\t\t# \"slb-instance-autorenewal-check\",\n\t\t# \"slb-instance-expired-check\",\n\t\t# \"slb-instance-idle-check\",\n\t\t# \"slb-instance-listener-count-check\",\n\t\t\"slb-instance-loadbalancerspec-check\",\n\t\t\"slb-instance-multi-zone\",\n\t\t# \"slb-listener-connection-drain-enabled\",\n\t\t# \"slb-listener-gzip-enabled\",\n\t\t# \"slb-listener-health-check-interval-check\",\n\t\t# \"slb-listener-health-check-threshold-check\",\n\t\t# \"slb-listener-health-check-timeout-check\",\n\t\t# \"slb-listener-http2-enabled\",\n\t\t\"slb-listener-https-enabled\",\n\t\t\"slb-modify-protection-check\"\n\t]\n}\n"})
	addPack(&models.Pack{ID: "pack:aliyun:soc2-audit-compliance", Name: models.I18nString{"de": "SOC 2 Audit-Standard Compliance", "en": "SOC 2 Audit Standard Compliance", "es": "Cumplimiento del Estándar de Auditoría SOC 2", "fr": "Conformité à la Norme d'Audit SOC 2", "ja": "SOC 2 監査標準コンプライアンス", "pt": "Conformidade com Padrão de Auditoria SOC 2", "zh": "SOC2 审计标准实践合规包"}, Description: models.I18nString{"de": "Compliance-Paket für SOC 2 (Service Organization Control 2) Audit-Standards. Dieses Paket hilft Organisationen zu überprüfen, ob ihre Cloud-Ressourcen die SOC 2 Vertrauensprinzipien für Sicherheit, Verfügbarkeit und Vertraulichkeit erfüllen.", "en": "Compliance pack for SOC 2 (Service Organization Control 2) audit standards. This pack helps organizations verify their cloud resources meet SOC 2 trust principles for security, availability, and confidentiality.", "es": "Paquete de cumplimiento para los estándares de auditoría SOC 2 (Service Organization Control 2). Este paquete ayuda a las organizaciones a verificar que sus recursos en la nube cumplan con los principios de confianza SOC 2 para seguridad, disponibilidad y confidencialidad.", "fr": "Pack de conformité pour les normes d'audit SOC 2 (Service Organization Control 2). Ce pack aide les organisations à vérifier que leurs ressources cloud répondent aux principes de confiance SOC 2 pour la sécurité, la disponibilité et la confidentialité.", "ja": "SOC 2（サービス組織制御 2）監査標準のコンプライアンスパック。このパックは、組織がクラウドリソースがセキュリティ、可用性、機密性に関する SOC 2 信頼原則を満たしていることを確認するのに役立ちます。", "pt": "Pacote de conformidade para padrões de auditoria SOC 2 (Service Organization Control 2). Este pacote ajuda as organizações a verificar se seus recursos em nuvem atendem aos princípios de confiança SOC 2 para segurança, disponibilidade e confidencialidade.", "zh": "SOC 2(服务组织控制 2)审计标准合规包。本合规包帮助组织验证其云资源是否符合 SOC 2 安全性、可用性和保密性信任原则。"}, RuleIDs: []string{"rule:aliyun:api-gateway-group-enabled-ssl", "rule:aliyun:ecs-disk-auto-snapshot-policy", "rule:aliyun:ecs-disk-encrypted", "rule:aliyun:ecs-instance-enabled-security-protection", "rule:aliyun:ecs-instance-ram-role-attached", "rule:aliyun:ecs-running-instance-no-public-ip", "rule:aliyun:ecs-security-group-risky-ports-check-with-protocol", "rule:aliyun:ecs-security-group-white-list-port-check", "rule:aliyun:eip-attached", "rule:aliyun:elasticsearch-instance-enabled-data-node-encryption", "rule:aliyun:ess-scaling-configuration-enabled-internet-check", "rule:aliyun:fc-service-internet-access-disable", "rule:aliyun:fc-service-vpc-binding", "rule:aliyun:firewall-asset-open-protect", "rule:aliyun:kms-key-delete-protection-enabled", "rule:aliyun:kms-secret-rotation-enabled", "rule:aliyun:nas-filesystem-encrypt-type-check", "rule:aliyun:oss-bucket-logging-enabled", "rule:aliyun:oss-bucket-only-https-enabled", "rule:aliyun:oss-bucket-public-read-prohibited", "rule:aliyun:oss-bucket-public-write-prohibited", "rule:aliyun:oss-bucket-server-side-encryption-enabled", "rule:aliyun:oss-bucket-versioning-enabled", "rule:aliyun:oss-zrs-enabled", "rule:aliyun:polardb-cluster-delete-protection-enabled", "rule:aliyun:polardb-cluster-enabled-ssl", "rule:aliyun:polardb-cluster-enabled-tde", "rule:aliyun:ram-group-has-member-check", "rule:aliyun:ram-policy-no-statements-with-admin-access-check", "rule:aliyun:ram-user-ak-create-date-expired-check", "rule:aliyun:ram-user-group-membership-check", "rule:aliyun:ram-user-login-check", "rule:aliyun:ram-user-mfa-check", "rule:aliyun:ram-user-no-policy-check", "rule:aliyun:rds-instacne-delete-protection-enabled", "rule:aliyun:rds-instance-enabled-log-backup", "rule:aliyun:rds-public-access-check", "rule:aliyun:redis-instance-enabled-ssl", "rule:aliyun:slb-all-listenter-tls-policy-check", "rule:aliyun:slb-instance-log-enabled", "rule:aliyun:slb-listener-https-enabled", "rule:aliyun:vpc-flow-logs-enabled"}, FilePath: "aliyun/packs/soc2-audit-compliance.rego", PackageName: "infraguard.packs.aliyun.soc2_audit_compliance", Content: "package infraguard.packs.aliyun.soc2_audit_compliance\n\nimport rego.v1\n\npack_meta := {\n\t\"id\": \"soc2-audit-compliance\",\n\t\"name\": {\n\t\t\"en\": \"SOC 2 Audit Standard Compliance\",\n\t\t\"zh\": \"SOC2 审计标准实践合规包\",\n\t\t\"ja\": \"SOC 2 監査標準コンプライアンス\",\n\t\t\"de\": \"SOC 2 Audit-Standard Compliance\",\n\t\t\"es\": \"Cumplimiento del Estándar de Auditoría SOC 2\",\n\t\t\"fr\": \"Conformité à la Norme d'Audit SOC 2\",\n\t\t\"pt\": \"Conformidade com Padrão de Auditoria SOC 2\"\n\t},\n\t\"description\": {\n\t\t\"en\": \"Compliance pack for SOC 2 (Service Organization Control 2) audit standards. This pack helps organizations verify their cloud resources meet SOC 2 trust principles for security, availability, and confidentiality.\",\n\t\t\"zh\": \"SOC 2(服务组织控制 2)审计标准合规包。本合规包帮助组织验证其云资源是否符合 SOC 2 安全性、可用性和保密性信任原则。\",\n\t\t\"ja\": \"SOC 2（サービス組織制御 2）監査標準のコンプライアンスパック。このパックは、組織がクラウドリソースがセキュリティ、可用性、機密性に関する SOC 2 信頼原則を満たしていることを確認するのに役立ちます。\",\n\t\t\"de\": \"Compliance-Paket für SOC 2 (Service Organization Control 2) Audit-Standards. Dieses Paket hilft Organisationen zu überprüfen, ob ihre Cloud-Ressourcen die SOC 2 Vertrauensprinzipien für Sicherheit, Verfügbarkeit und Vertraulichkeit erfüllen.\",\n\t\t\"es\": \"Paquete de cumplimiento para los estándares de auditoría SOC 2 (Service Organization Control 2). Este paquete ayuda a las organizaciones a verificar que sus recursos en la nube cumplan con los principios de confianza SOC 2 para seguridad, disponibilidad y confidencialidad.\",\n\t\t\"fr\": \"Pack de conformité pour les normes d'audit SOC 2 (Service Organization Control 2). Ce pack aide les organisations à vérifier que leurs ressources cloud répondent aux principes de confiance SOC 2 pour la sécurité, la disponibilité et la confidentialité.\",\n\t\t\"pt\": \"Pacote de conformidade para padrões de auditoria SOC 2 (Service Organization Control 2). Este pacote ajuda as organizações a verificar se seus recursos em nuvem atendem aos princípios de confiança SOC 2 para segurança, disponibilidade e confidencialidade.\"\n\t},\n\t\"rules\": [\n\t\t# \"ack-cluster-node-monitorenabled\",\n\t\t# \"ack-cluster-ram-authenticator-enabled\",\n\t\t# \"ack-running-cluster-node-monitorenabled\",\n\t\t# \"adb-cluster-audit-log-enabled\",  # Commented: ROS ADB::DBCluster does not support AuditLog property,\n\t\t# \"adb-cluster-log-backup-enabled\",\n\t\t# \"adb-public-access-check\",  # Commented: ROS ADB::DBCluster does not support PublicEndpoint property,\n\t\t# \"alb-http-drop-invalid-header-enabled\",\n\t\t# \"api-gateway-api-auth-required\",\n\t\t# \"api-gateway-group-domain-access-waf-or-waf3\",  # Commented: ROS ApiGateway::Group does not support PassthroughWaf property,\n\t\t\"api-gateway-group-enabled-ssl\",\n\t\t# \"api-gateway-group-log-enabled\",\n\t\t# \"cdn-domain-tls13-enabled\",\n\t\t# \"cr-instance-public-access-check\",  # Commented: ROS CR::Instance does not support PublicNetworkAccess property,\n\t\t# \"dts-instance-sync-job-ssl-enabled\",\n\t\t\"ecs-disk-auto-snapshot-policy\",\n\t\t\"ecs-disk-encrypted\",\n\t\t\"ecs-instance-enabled-security-protection\",\n\t\t# \"ecs-instance-monitor-enabled\",  # Commented: ROS ECS::Instance does not support CloudMonitorFlags property,\n\t\t# \"ecs-instance-no-public-ip\",\n\t\t\"ecs-instance-ram-role-attached\",\n\t\t# \"ecs-instance-updated-security-vul\",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,\n\t\t\"ecs-running-instance-no-public-ip\",\n\t\t# \"ecs-running-instances-in-vpc\",\n\t\t\"ecs-security-group-risky-ports-check-with-protocol\",\n\t\t\"ecs-security-group-white-list-port-check\",\n\t\t\"eip-attached\",\n\t\t\"elasticsearch-instance-enabled-data-node-encryption\",\n\t\t# \"elasticsearch-instance-enabled-public-check\",\n\t\t# \"elasticsearch-instance-used-https-protocol\",  # Commented: ROS ALIYUN::ElasticSearch::Instance does not support Protocol property,\n\t\t\"ess-scaling-configuration-enabled-internet-check\",\n\t\t# \"fc-function-settings-check\",\n\t\t\"fc-service-internet-access-disable\",\n\t\t\"fc-service-vpc-binding\",\n\t\t\"firewall-asset-open-protect\",\n\t\t\"kms-key-delete-protection-enabled\",\n\t\t# \"kms-key-state-not-pending-deletion\",  # Commented: ROS KMS::Key does not support KeyState property (runtime state only),\n\t\t# \"kms-secret-last-rotation-date-check\",\n\t\t\"kms-secret-rotation-enabled\",\n\t\t# \"nas-filesystem-enable-backup-plan\",\n\t\t\"nas-filesystem-encrypt-type-check\",\n\t\t# \"nat-risk-ports-check\",\n\t\t\"oss-bucket-logging-enabled\",\n\t\t\"oss-bucket-only-https-enabled\",\n\t\t\"oss-bucket-public-read-prohibited\",\n\t\t\"oss-bucket-public-write-prohibited\",\n\t\t\"oss-bucket-server-side-encryption-enabled\",\n\t\t\"oss-bucket-versioning-enabled\",\n\t\t\"oss-zrs-enabled\",\n\t\t# \"polardb-cluster-address-no-public\",\n\t\t\"polardb-cluster-delete-protection-enabled\",\n\t\t# \"polardb-cluster-enabled-auditing\",  # ROS does not support SQLCollectorStatus property,\n\t\t\"polardb-cluster-enabled-ssl\",\n\t\t\"polardb-cluster-enabled-tde\",\n\t\t# \"polardb-cluster-level-one-backup-retention\",\n\t\t# \"polardb-public-access-check\",\n\t\t\"ram-group-has-member-check\",\n\t\t# \"ram-group-in-use-check\",\n\t\t# \"ram-policy-in-use-check\",\n\t\t\"ram-policy-no-statements-with-admin-access-check\",\n\t\t# \"ram-user-active-ak-check\",\n\t\t\"ram-user-ak-create-date-expired-check\",\n\t\t\"ram-user-group-membership-check\",\n\t\t\"ram-user-login-check\",\n\t\t\"ram-user-mfa-check\",\n\t\t\"ram-user-no-policy-check\",\n\t\t\"rds-instacne-delete-protection-enabled\",\n\t\t\"rds-instance-enabled-log-backup\",\n\t\t# \"rds-instance-enabled-tde\",\n\t\t\"rds-public-access-check\",\n\t\t\"redis-instance-enabled-ssl\",\n\t\t# \"slb-aliyun-certificate-required\",\n\t\t\"slb-all-listenter-tls-policy-check\",\n\t\t\"slb-instance-log-enabled\",\n\t\t\"slb-listener-https-enabled\",\n\t\t# \"slb-no-public-ip\",\n\t\t# \"ssl-certificate-expired-check\",\n\t\t\"vpc-flow-logs-enabled\",\n\t\t# \"waf3-instance-enabled-specified-defense-rules\"\n\t]\n}\n"})
}

func addRule(r *models.Rule) {
	EmbeddedIndex.Rules[r.ID] = r
	EmbeddedIndex.RuleList = append(EmbeddedIndex.RuleList, r)
}

func addPack(p *models.Pack) {
	EmbeddedIndex.Packs[p.ID] = p
	EmbeddedIndex.PackList = append(EmbeddedIndex.PackList, p)
}
