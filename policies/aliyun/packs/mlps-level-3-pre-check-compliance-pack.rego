package infraguard.packs.aliyun.mlps_level_3_pre_check_compliance_pack

import rego.v1

pack_meta := {
	"id": "mlps-level-3-pre-check-compliance-pack",
	"name": {
		"en": "MLPS Level 3 Pre-check Compliance Pack",
		"zh": "等保三级预检合规包",
		"ja": "MLPS レベル 3 事前チェックコンプライアンスパック",
		"de": "MLPS Level 3 Vorprüfung Compliance-Paket",
		"es": "Paquete de Cumplimiento de Verificación Previa MLPS Nivel 3",
		"fr": "Pack de Conformité de Vérification Préalable MLPS Niveau 3",
		"pt": "Pacote de Conformidade de Verificação Prévia MLPS Nível 3"
	},
	"description": {
		"en": "Compliance pack for MLPS level 3 pre-check requirements on Aliyun resources.",
		"zh": "基于等保三级的部分要求，对阿里云上资源的合规性做检测。",
		"ja": "Alibaba Cloud リソースに対する MLPS レベル 3 事前チェック要件のコンプライアンスパック。",
		"de": "Compliance-Paket für MLPS Level 3 Vorprüfungsanforderungen für Alibaba Cloud Ressourcen.",
		"es": "Paquete de cumplimiento para requisitos de verificación previa MLPS nivel 3 en recursos de Aliyun.",
		"fr": "Pack de conformité pour les exigences de vérification préalable MLPS niveau 3 sur les ressources Aliyun.",
		"pt": "Pacote de conformidade para requisitos de verificação prévia MLPS nível 3 em recursos do Aliyun."
	},
	"rules": [
		"ack-cluster-encryption-enabled",
		"ack-cluster-node-multi-zone",
		"ack-cluster-public-endpoint-check",
		"actiontrail-trail-intact-enabled",
		# "adb-cluster-audit-log-enabled",  # Commented: ROS ADB::DBCluster does not support AuditLog property,
		# "alb-all-listener-enabled-acl",  # Commented: ROS ALB::Listener does not support AclConfig property,
		"alb-instance-multi-zone",
		# "api-gateway-group-https-policy-check",
		# "cdn-domain-tls13-enabled",
		# "cen-cross-region-bandwidth-check",
		# "cr-instance-any-ip-access-check",
		"ecs-disk-auto-snapshot-policy",
		"ecs-in-use-disk-encrypted",
		"ecs-instance-enabled-security-protection",
		# "ecs-instance-updated-security-vul",  # Commented: ROS ECS::Instance does not support Vulnerabilities property,
		"ecs-instances-in-vpc",
		"ecs-running-instance-no-public-ip",
		"ecs-security-group-risky-ports-check-with-protocol",
		"eip-bandwidth-limit",
		"elasticsearch-instance-multi-zone",
		# "elasticsearch-instance-snapshot-enabled",  # Commented: ROS does not support AutoSnapshot property for ALIYUN::ElasticSearch::Instance,
		"elasticsearch-public-and-any-ip-access-check",
		"firewall-asset-open-protect",
		# "mongodb-instance-backup-log-enabled",  # Commented: ROS does not support ALIYUN::MongoDB::DBInstance resource type,
		"mongodb-instance-multi-zone",
		# "nas-filesystem-enable-backup-plan",
		"nas-filesystem-mount-target-access-group-check",
		# "nat-risk-ports-check",
		# "natgateway-snat-eip-bandwidth-check",
		"oss-bucket-authorize-specified-ip",
		"oss-bucket-only-https-enabled",
		"oss-bucket-policy-no-any-anonymous",
		"oss-bucket-policy-outside-organization-check",
		"oss-bucket-public-read-prohibited",
		# "oss-bucket-referer-enabled",
		"oss-bucket-versioning-enabled",
		"oss-default-encryption-kms",
		"oss-zrs-enabled",
		"polardb-cluster-enabled-ssl",
		"polardb-cluster-enabled-tde",
		# "polardb-cluster-level-two-backup-retention",
		"polardb-cluster-multi-zone",
		"polardb-public-and-any-ip-access-check",
		"ram-group-has-member-check",
		# "ram-password-max-age-check",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,
		# "ram-password-max-login-attemps-check",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,
		# "ram-password-require-char-check",  # Commented: ROS does not support ALIYUN::RAM::PasswordPolicy resource type,
		# "ram-policy-in-use-check",
		"ram-policy-no-statements-with-admin-access-check",
		"ram-user-ak-used-expired-check",
		"ram-user-last-login-expired-check",
		"ram-user-login-check",
		"ram-user-mfa-check",
		"ram-user-no-policy-check",
		"rds-instance-enabled-auditing",
		"rds-instance-enabled-disk-encryption",
		"rds-instance-enabled-log-backup",
		"rds-instance-has-guard-instance",
		# "rds-instance-tls-version-check",
		"rds-instances-in-vpc",
		"rds-multi-az-support",
		"rds-public-connection-and-any-ip-access-check",
		# "redis-instance-enabled-tde",
		# "redis-instance-in-vpc",
		"redis-instance-multi-zone",
		"redis-instance-open-auth-mode",
		"redis-public-and-any-ip-access-check",
		"root-mfa-check",
		# "security-center-defense-config-check",
		# "security-center-notice-config-check",
		"security-center-version-check",
		"sg-public-access-check",
		"slb-acl-public-access-check",
		# "slb-all-listener-enabled-acl",
		"slb-all-listener-servers-multi-zone",
		"slb-all-listenter-tls-policy-check",
		"slb-listener-risk-ports-check",
		"slb-loadbalancer-bandwidth-limit",
		# "slb-no-public-ip",
		"sls-logstore-enabled-encrypt",
		# "use-cloud-fire-wall-for-security-protection",
		# "use-ddos-instance-for-security-protection",
		"use-waf-instance-for-security-protection",
		"vpc-flow-logs-enabled",
		"vpc-network-acl-risky-ports-check",
		# "waf3-instance-enabled-specified-defense-rules"
	]
}
