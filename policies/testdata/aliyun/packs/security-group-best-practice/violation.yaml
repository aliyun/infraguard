ROSTemplateFormatVersion: '2015-09-01'
Description: Violation - Security group not following best practices

Resources:
  # Violation: Security group with multiple issues
  SecurityGroup:
    Type: ALIYUN::ECS::SecurityGroup
    Properties:
      SecurityGroupName: insecure-sg
      # Missing description
      # Using normal type (not enterprise)
      SecurityGroupIngress:
        # Violation: All ports open from public
        - IpProtocol: tcp
          PortRange: -1/-1
          SourceCidrIp: 0.0.0.0/0

  # Violation: ECS instance without security group
  ECSInstance:
    Type: ALIYUN::ECS::Instance
    Properties:
      InstanceType: ecs.c6.large
      ImageId: centos_7
      VpcId: vpc-bp1qg7z02222222222
      VSwitchId: vsw-bp1g7z02222222222

