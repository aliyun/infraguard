ROSTemplateFormatVersion: '2015-09-01'
Description: Violation - Resource Public Access Detection Best Practice

Resources:
  # Note: Most public access configurations are runtime settings not exposed in ROS templates.
  # This violation template includes resources that would violate public access rules
  # if public access is enabled post-deployment.
  
  # Resources that may have public access (public access must be restricted post-deployment)
  ECSInstance:
    Type: ALIYUN::ECS::Instance
    Properties:
      InstanceType: ecs.g6.large
      ImageId: centos_7
      VpcId: vpc-test123
      VSwitchId: vsw-test123

  # Violation: CR Repository with public type
  CRRepository:
    Type: ALIYUN::CR::Repository
    Properties:
      RepoName: public-repo
      RepoNamespace: test-namespace
      RepoType: PUBLIC
      Summary: Public repository
      InstanceId: cri-12345678

  # Resources that may have public access enabled
  RDSInstance:
    Type: ALIYUN::RDS::DBInstance
    Properties:
      Engine: MySQL
      EngineVersion: '8.0'
      DBInstanceClass: mysql.n2.small.1
      DBInstanceStorage: 20
      SecurityIPList: '127.0.0.1'

  MongoDBInstance:
    Type: ALIYUN::MONGODB::Instance
    Properties:
      DBInstanceClass: dds.mongo.mid
      DBInstanceStorage: 20
      EngineVersion: '4.0'

  RedisInstance:
    Type: ALIYUN::REDIS::Instance
    Properties:
      InstanceClass: redis.master.small.default
      EngineVersion: '5.0'
