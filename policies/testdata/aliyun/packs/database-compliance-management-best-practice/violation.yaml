ROSTemplateFormatVersion: '2015-09-01'
Description: Violation - Database Compliance Management Best Practice

Resources:
  # Violation: RDS instance with public access
  RDSInstance:
    Type: ALIYUN::RDS::DBInstance
    Properties:
      Engine: MySQL
      EngineVersion: '8.0'
      DBInstanceClass: mysql.n2.small.1
      DBInstanceStorage: 20
      AllocatePublicConnection: true
      SecurityIPList: '0.0.0.0/0'

  # Note: Most database compliance checks are runtime configurations not exposed in ROS templates.
  # This violation template includes resources that would violate database rules
  # if configurations are not set properly post-deployment.
  
  # Resources that may violate database rules
  MongoDBInstance:
    Type: ALIYUN::MONGODB::Instance
    Properties:
      DBInstanceClass: dds.mongo.mid
      DBInstanceStorage: 20
      EngineVersion: '4.0'

  RedisInstance:
    Type: ALIYUN::REDIS::Instance
    Properties:
      EngineVersion: '5.0'
      InstanceClass: redis.master.small.default
      Capacity: 1

  PolarDBCluster:
    Type: ALIYUN::POLARDB::DBCluster
    Properties:
      DBType: MySQL
      DBVersion: '8.0'
      DBNodeClass: polar.mysql.x4.large
      DBNodeNum: 2
      PayType: Postpaid
